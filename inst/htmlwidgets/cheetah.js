/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/cheetah-grid/dist/cheetahGrid.es5.js":
/*!***********************************************************!*\
  !*** ./node_modules/cheetah-grid/dist/cheetahGrid.es5.js ***!
  \***********************************************************/
/***/ ((module, exports, __webpack_require__) => {

/* module decorator */ module = __webpack_require__.nmd(module);
var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*! Cheetah Grid v1.16.0 | license MIT */
(function(){
"use strict";

function set(target, property, value, receiver) { if (typeof Reflect !== "undefined" && Reflect.set) { set = Reflect.set; } else { set = function set(target, property, value, receiver) { var base = _superPropBase(target, property); var desc; if (base) { desc = Object.getOwnPropertyDescriptor(base, property); if (desc.set) { desc.set.call(receiver, value); return true; } else if (!desc.writable) { return false; } } desc = Object.getOwnPropertyDescriptor(receiver, property); if (desc) { if (!desc.writable) { return false; } desc.value = value; Object.defineProperty(receiver, property, desc); } else { _defineProperty(receiver, property, value); } return true; }; } return set(target, property, value, receiver); }

function _set(target, property, value, receiver, isStrict) { var s = set(target, property, value, receiver || target); if (!s && isStrict) { throw new Error('failed to set property'); } return value; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

(function (window) {
  (function webpackUniversalModuleDefinition(root, factory) {
    if (( false ? 0 : _typeof(exports)) === 'object' && ( false ? 0 : _typeof(module)) === 'object') module.exports = factory();else if (true) !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
		__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
		(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
		__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));else {}
  })(window, function () {
    return (
      /******/
      function (modules) {
        // webpackBootstrap

        /******/
        // The module cache

        /******/
        var installedModules = {};
        /******/

        /******/
        // The require function

        /******/

        function __nested_webpack_require_6786__(moduleId) {
          /******/

          /******/
          // Check if module is in cache

          /******/
          if (installedModules[moduleId]) {
            /******/
            return installedModules[moduleId].exports;
            /******/
          }
          /******/
          // Create a new module (and put it into the cache)

          /******/


          var module = installedModules[moduleId] = {
            /******/
            i: moduleId,

            /******/
            l: false,

            /******/
            exports: {}
            /******/

          };
          /******/

          /******/
          // Execute the module function

          /******/

          modules[moduleId].call(module.exports, module, module.exports, __nested_webpack_require_6786__);
          /******/

          /******/
          // Flag the module as loaded

          /******/

          module.l = true;
          /******/

          /******/
          // Return the exports of the module

          /******/

          return module.exports;
          /******/
        }
        /******/

        /******/

        /******/
        // expose the modules object (__webpack_modules__)

        /******/


        __nested_webpack_require_6786__.m = modules;
        /******/

        /******/
        // expose the module cache

        /******/

        __nested_webpack_require_6786__.c = installedModules;
        /******/

        /******/
        // define getter function for harmony exports

        /******/

        __nested_webpack_require_6786__.d = function (exports, name, getter) {
          /******/
          if (!__nested_webpack_require_6786__.o(exports, name)) {
            /******/
            Object.defineProperty(exports, name, {
              enumerable: true,
              get: getter
            });
            /******/
          }
          /******/

        };
        /******/

        /******/
        // define __esModule on exports

        /******/


        __nested_webpack_require_6786__.r = function (exports) {
          /******/
          if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {
            /******/
            Object.defineProperty(exports, Symbol.toStringTag, {
              value: 'Module'
            });
            /******/
          }
          /******/


          Object.defineProperty(exports, '__esModule', {
            value: true
          });
          /******/
        };
        /******/

        /******/
        // create a fake namespace object

        /******/
        // mode & 1: value is a module id, require it

        /******/
        // mode & 2: merge all properties of value into the ns

        /******/
        // mode & 4: return value when already ns object

        /******/
        // mode & 8|1: behave like require

        /******/


        __nested_webpack_require_6786__.t = function (value, mode) {
          /******/
          if (mode & 1) value = __nested_webpack_require_6786__(value);
          /******/

          if (mode & 8) return value;
          /******/

          if (mode & 4 && _typeof(value) === 'object' && value && value.__esModule) return value;
          /******/

          var ns = Object.create(null);
          /******/

          __nested_webpack_require_6786__.r(ns);
          /******/


          Object.defineProperty(ns, 'default', {
            enumerable: true,
            value: value
          });
          /******/

          if (mode & 2 && typeof value != 'string') for (var key in value) {
            __nested_webpack_require_6786__.d(ns, key, function (key) {
              return value[key];
            }.bind(null, key));
          }
          /******/

          return ns;
          /******/
        };
        /******/

        /******/
        // getDefaultExport function for compatibility with non-harmony modules

        /******/


        __nested_webpack_require_6786__.n = function (module) {
          /******/
          var getter = module && module.__esModule ?
          /******/
          function getDefault() {
            return module['default'];
          } :
          /******/
          function getModuleExports() {
            return module;
          };
          /******/

          __nested_webpack_require_6786__.d(getter, 'a', getter);
          /******/


          return getter;
          /******/
        };
        /******/

        /******/
        // Object.prototype.hasOwnProperty.call

        /******/


        __nested_webpack_require_6786__.o = function (object, property) {
          return Object.prototype.hasOwnProperty.call(object, property);
        };
        /******/

        /******/
        // __webpack_public_path__

        /******/


        __nested_webpack_require_6786__.p = "";
        /******/

        /******/

        /******/
        // Load entry module and return exports

        /******/

        return __nested_webpack_require_6786__(__nested_webpack_require_6786__.s = "./main.js");
        /******/
      }(
      /************************************************************************/

      /******/
      {
        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/action/internal/InlineInputElement.css":
        /*!**************************************************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/columns/action/internal/InlineInputElement.css ***!
          \**************************************************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsColumnsActionInternalInlineInputElementCss(module, __nested_webpack_exports__, __nested_webpack_require_12751__) {
          "use strict";

          __nested_webpack_require_12751__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_12751__(
          /*! ../../../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_12751__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, ".cheetah-grid__inline-input::-ms-clear{visibility:hidden}.cheetah-grid__inline-input{position:absolute;-webkit-box-sizing:border-box;box-sizing:border-box}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/action/internal/InlineMenuElement.css":
        /*!*************************************************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/columns/action/internal/InlineMenuElement.css ***!
          \*************************************************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsColumnsActionInternalInlineMenuElementCss(module, __nested_webpack_exports__, __nested_webpack_require_14857__) {
          "use strict";

          __nested_webpack_require_14857__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_14857__(
          /*! ../../../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_14857__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, ".cheetah-grid__inline-menu{position:absolute;color:rgba(0,0,0,.87);-webkit-box-sizing:content-box;box-sizing:content-box;margin:-1px auto auto -1px;padding:8px 0;background-color:#fafafa;list-style-type:none;border-radius:2px;max-height:calc(100vh - 40px);overflow-y:auto}.cheetah-grid__inline-menu--hidden{-webkit-transform:scale(.9);transform:scale(.9);-webkit-box-shadow:none;box-shadow:none;opacity:0;pointer-events:none;-webkit-transition:all 50ms ease-out;transition:all 50ms ease-out}.cheetah-grid__inline-menu--hidden *{pointer-events:none}.cheetah-grid__inline-menu--shown{-webkit-transform:translateY(-7px);transform:translateY(-7px);-webkit-box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);opacity:1;-webkit-transition:all .15s ease-out;transition:all .15s ease-out}.cheetah-grid__inline-menu__menu-item{height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;outline:none;cursor:pointer;position:relative;overflow:hidden;padding:0 16px}.cheetah-grid__inline-menu__menu-item--empty{color:rgba(0,0,0,.38)}.cheetah-grid__inline-menu__menu-item:before{content:\"\";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background-color:#000;opacity:0;pointer-events:none;-webkit-transition:opacity 15ms linear;transition:opacity 15ms linear}.cheetah-grid__inline-menu__menu-item:hover:before,.cheetah-grid__inline-menu__menu-item[data-select]:before{opacity:.04}.cheetah-grid__inline-menu__menu-item:focus:before{opacity:.12}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/action/internal/SmallDialogInputElement.css":
        /*!*******************************************************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/columns/action/internal/SmallDialogInputElement.css ***!
          \*******************************************************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsColumnsActionInternalSmallDialogInputElementCss(module, __nested_webpack_exports__, __nested_webpack_require_18619__) {
          "use strict";

          __nested_webpack_require_18619__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_18619__(
          /*! ../../../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_18619__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, ".cheetah-grid__small-dialog-input__input::-ms-clear{visibility:hidden}@-webkit-keyframes cheetah-grid__small-dialog-input--hidden-animation{0%{opacity:1}99%{opacity:1}to{opacity:0}}@keyframes cheetah-grid__small-dialog-input--hidden-animation{0%{opacity:1}99%{opacity:1}to{opacity:0}}.cheetah-grid__small-dialog-input{position:absolute;-webkit-box-sizing:content-box;box-sizing:content-box;margin:-1px auto auto -1px;border-radius:3px;background-color:#fafafa;-webkit-transition:padding .15s ease-out,-webkit-box-shadow .15s ease-out;transition:padding .15s ease-out,-webkit-box-shadow .15s ease-out;transition:padding .15s ease-out,box-shadow .15s ease-out;transition:padding .15s ease-out,box-shadow .15s ease-out,-webkit-box-shadow .15s ease-out}.cheetah-grid__small-dialog-input--hidden{-webkit-box-shadow:none;box-shadow:none;padding:0;pointer-events:none;-webkit-animation:cheetah-grid__small-dialog-input--hidden-animation .15s ease-out;animation:cheetah-grid__small-dialog-input--hidden-animation .15s ease-out;opacity:0}.cheetah-grid__small-dialog-input--shown{-webkit-box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);padding:8px 24px}.cheetah-grid__small-dialog-input__input{width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:3px 2px 0 4px;border:none;border-bottom:1px solid rgba(0,0,0,.87);outline:none;background-color:transparent;-webkit-transition:all .3s ease-out;transition:all .3s ease-out}.cheetah-grid__small-dialog-input__input:focus{border-bottom:1px solid #2196f3;-webkit-box-shadow:0 1px 0 0 #2196f3;box-shadow:0 1px 0 0 #2196f3}.cheetah-grid__small-dialog-input:after{content:\"\";font-family:Roboto;font-size:12px;font-size:.75rem;min-height:1em;line-height:1;display:block;width:100%;padding-top:8px}.cheetah-grid__small-dialog-input.helper-text--right-justified:after{text-align:right}.cheetah-grid__small-dialog-input[data-helper-text]:after{content:attr(data-helper-text);color:rgba(0,0,0,.87)}.cheetah-grid__small-dialog-input[data-error-message] input{border-bottom:1px solid #ff1744;-webkit-box-shadow:0 1px 0 0 #ff1744;box-shadow:0 1px 0 0 #ff1744}.cheetah-grid__small-dialog-input[data-error-message]:after{content:attr(data-error-message);color:#ff1744;text-align:left}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/message/internal/ErrorMessageElement.css":
        /*!****************************************************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/columns/message/internal/ErrorMessageElement.css ***!
          \****************************************************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsColumnsMessageInternalErrorMessageElementCss(module, __nested_webpack_exports__, __nested_webpack_require_22967__) {
          "use strict";

          __nested_webpack_require_22967__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_22967__(
          /*! ../../../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_22967__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, ".cheetah-grid__error-message-element{border-top:1px solid #ff1744;color:#ff1744}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/message/internal/MessageElement.css":
        /*!***********************************************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/columns/message/internal/MessageElement.css ***!
          \***********************************************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsColumnsMessageInternalMessageElementCss(module, __nested_webpack_exports__, __nested_webpack_require_24988__) {
          "use strict";

          __nested_webpack_require_24988__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_24988__(
          /*! ../../../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_24988__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, ".cheetah-grid__message-element{position:absolute;margin-top:-2px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:0 0 3px 3px;background-color:hsla(0,0%,98%,.85);padding:8px 2px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-top:1px solid rgba(0,0,0,.87);color:rgba(0,0,0,.87)}.cheetah-grid__message-element--hidden{display:none}.cheetah-grid__message-element--shown{display:block}.cheetah-grid__message-element__message{font-family:Roboto;font-size:12px;font-size:.75rem;min-height:1em;line-height:1;display:block;width:100%}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/message/internal/WarningMessageElement.css":
        /*!******************************************************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/columns/message/internal/WarningMessageElement.css ***!
          \******************************************************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsColumnsMessageInternalWarningMessageElementCss(module, __nested_webpack_exports__, __nested_webpack_require_27572__) {
          "use strict";

          __nested_webpack_require_27572__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_27572__(
          /*! ../../../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_27572__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, ".cheetah-grid__warning-message-element{border-top:1px solid #dd2c00;color:#dd2c00}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/internal/style.css":
        /*!**********************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/internal/style.css ***!
          \**********************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsInternalStyleCss(module, __nested_webpack_exports__, __nested_webpack_require_29472__) {
          "use strict";

          __nested_webpack_require_29472__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_29472__(
          /*! ../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_29472__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, ".cheetah-grid .grid-scrollable{height:100%;width:100%;position:absolute;overflow:scroll}.cheetah-grid .grid-scroll-end-point{opacity:0;position:relative}.cheetah-grid{position:relative;width:100%;height:100%}.cheetah-grid>canvas{position:absolute;width:0;height:0}.cheetah-grid .grid-focus-control{position:relative!important;width:1px;height:1px;opacity:0;padding:0;margin:0;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none;max-width:0;max-height:0;float:none!important}.cheetah-grid input.grid-focus-control::-ms-clear{visibility:hidden}.cheetah-grid input.grid-focus-control.composition{opacity:1;max-width:none;max-height:none}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/tooltip/internal/TooltipElement.css":
        /*!***************************************************************************************************************************************************!*\
          !*** ../node_modules/css-loader/dist/cjs.js??ref--5-1!../node_modules/postcss-loader/src??ref--5-2!../src/js/tooltip/internal/TooltipElement.css ***!
          \***************************************************************************************************************************************************/

        /*! exports provided: default */

        /*! ModuleConcatenation bailout: Module uses module.id */

        /***/
        function node_modulesCssLoaderDistCjsJsNode_modulesPostcssLoaderSrcIndexJsSrcJsTooltipInternalTooltipElementCss(module, __nested_webpack_exports__, __nested_webpack_require_32022__) {
          "use strict";

          __nested_webpack_require_32022__.r(__nested_webpack_exports__);
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_32022__(
          /*! ../../../../node_modules/css-loader/dist/runtime/api.js */
          "../node_modules/css-loader/dist/runtime/api.js");
          /* harmony import */


          var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__nested_webpack_require_32022__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__); // Imports


          var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(false); // Module


          ___CSS_LOADER_EXPORT___.push([module.i, "@-webkit-keyframes cheetah-grid__tooltip-element--shown-animation{0%{opacity:0;-webkit-transform:scale(.8) translateX(-60%);transform:scale(.8) translateX(-60%)}to{opacity:1;-webkit-transform:scale(1) translateX(-50%);transform:scale(1) translateX(-50%)}}@keyframes cheetah-grid__tooltip-element--shown-animation{0%{opacity:0;-webkit-transform:scale(.8) translateX(-60%);transform:scale(.8) translateX(-60%)}to{opacity:1;-webkit-transform:scale(1) translateX(-50%);transform:scale(1) translateX(-50%)}}.cheetah-grid__tooltip-element{position:absolute;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:3px;background-color:#232f34;padding:8px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#fff}.cheetah-grid__tooltip-element--hidden{opacity:0;-webkit-transform:translateX(-50%);transform:translateX(-50%);-webkit-transition:opacity 75ms linear;transition:opacity 75ms linear}.cheetah-grid__tooltip-element--shown{opacity:1;-webkit-transform:translateX(-50%);transform:translateX(-50%);-webkit-animation:cheetah-grid__tooltip-element--shown-animation .15s ease-out;animation:cheetah-grid__tooltip-element--shown-animation .15s ease-out}.cheetah-grid__tooltip-element__content{font-family:Roboto;font-size:12px;font-size:.75rem;min-height:1em;line-height:1;width:100%;display:block;white-space:pre-wrap;margin:0;-webkit-box-sizing:border-box;box-sizing:border-box}", ""]); // Exports

          /* harmony default export */


          __nested_webpack_exports__["default"] = ___CSS_LOADER_EXPORT___;
          /***/
        },

        /***/
        "../node_modules/css-loader/dist/runtime/api.js":
        /*!******************************************************!*\
          !*** ../node_modules/css-loader/dist/runtime/api.js ***!
          \******************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function node_modulesCssLoaderDistRuntimeApiJs(module, exports, __webpack_require__) {
          "use strict";
          /*
            MIT License http://www.opensource.org/licenses/mit-license.php
            Author Tobias Koppers @sokra
          */
          // css base code, injected by the css-loader
          // eslint-disable-next-line func-names

          module.exports = function (useSourceMap) {
            var list = []; // return the list of modules as css string

            list.toString = function toString() {
              return this.map(function (item) {
                var content = cssWithMappingToString(item, useSourceMap);

                if (item[2]) {
                  return "@media ".concat(item[2], " {").concat(content, "}");
                }

                return content;
              }).join('');
            }; // import a list of modules into the list
            // eslint-disable-next-line func-names


            list.i = function (modules, mediaQuery, dedupe) {
              if (typeof modules === 'string') {
                // eslint-disable-next-line no-param-reassign
                modules = [[null, modules, '']];
              }

              var alreadyImportedModules = {};

              if (dedupe) {
                for (var i = 0; i < this.length; i++) {
                  // eslint-disable-next-line prefer-destructuring
                  var id = this[i][0];

                  if (id != null) {
                    alreadyImportedModules[id] = true;
                  }
                }
              }

              for (var _i = 0; _i < modules.length; _i++) {
                var item = [].concat(modules[_i]);

                if (dedupe && alreadyImportedModules[item[0]]) {
                  // eslint-disable-next-line no-continue
                  continue;
                }

                if (mediaQuery) {
                  if (!item[2]) {
                    item[2] = mediaQuery;
                  } else {
                    item[2] = "".concat(mediaQuery, " and ").concat(item[2]);
                  }
                }

                list.push(item);
              }
            };

            return list;
          };

          function cssWithMappingToString(item, useSourceMap) {
            var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring

            var cssMapping = item[3];

            if (!cssMapping) {
              return content;
            }

            if (useSourceMap && typeof btoa === 'function') {
              var sourceMapping = toComment(cssMapping);
              var sourceURLs = cssMapping.sources.map(function (source) {
                return "/*# sourceURL=".concat(cssMapping.sourceRoot || '').concat(source, " */");
              });
              return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
            }

            return [content].join('\n');
          } // Adapted from convert-source-map (MIT)


          function toComment(sourceMap) {
            // eslint-disable-next-line no-undef
            var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
            var data = "sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);
            return "/*# ".concat(data, " */");
          }
          /***/

        },

        /***/
        "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":
        /*!*****************************************************************************!*\
          !*** ../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js ***!
          \*****************************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function node_modulesStyleLoaderDistRuntimeInjectStylesIntoStyleTagJs(module, exports, __nested_webpack_require_38831__) {
          "use strict";

          var isOldIE = function isOldIE() {
            var memo;
            return function memorize() {
              if (typeof memo === 'undefined') {
                // Test for IE <= 9 as proposed by Browserhacks
                // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805
                // Tests for existence of standard globals is to allow style-loader
                // to operate correctly into non-standard environments
                // @see https://github.com/webpack-contrib/style-loader/issues/177
                memo = Boolean(window && document && document.all && !window.atob);
              }

              return memo;
            };
          }();

          var getTarget = function getTarget() {
            var memo = {};
            return function memorize(target) {
              if (typeof memo[target] === 'undefined') {
                var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself

                if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {
                  try {
                    // This will throw an exception if access to iframe is blocked
                    // due to cross-origin restrictions
                    styleTarget = styleTarget.contentDocument.head;
                  } catch (e) {
                    // istanbul ignore next
                    styleTarget = null;
                  }
                }

                memo[target] = styleTarget;
              }

              return memo[target];
            };
          }();

          var stylesInDom = [];

          function getIndexByIdentifier(identifier) {
            var result = -1;

            for (var i = 0; i < stylesInDom.length; i++) {
              if (stylesInDom[i].identifier === identifier) {
                result = i;
                break;
              }
            }

            return result;
          }

          function modulesToDom(list, options) {
            var idCountMap = {};
            var identifiers = [];

            for (var i = 0; i < list.length; i++) {
              var item = list[i];
              var id = options.base ? item[0] + options.base : item[0];
              var count = idCountMap[id] || 0;
              var identifier = "".concat(id, " ").concat(count);
              idCountMap[id] = count + 1;
              var index = getIndexByIdentifier(identifier);
              var obj = {
                css: item[1],
                media: item[2],
                sourceMap: item[3]
              };

              if (index !== -1) {
                stylesInDom[index].references++;
                stylesInDom[index].updater(obj);
              } else {
                stylesInDom.push({
                  identifier: identifier,
                  updater: addStyle(obj, options),
                  references: 1
                });
              }

              identifiers.push(identifier);
            }

            return identifiers;
          }

          function insertStyleElement(options) {
            var style = document.createElement('style');
            var attributes = options.attributes || {};

            if (typeof attributes.nonce === 'undefined') {
              var nonce =  true ? __nested_webpack_require_38831__.nc : 0;

              if (nonce) {
                attributes.nonce = nonce;
              }
            }

            Object.keys(attributes).forEach(function (key) {
              style.setAttribute(key, attributes[key]);
            });

            if (typeof options.insert === 'function') {
              options.insert(style);
            } else {
              var target = getTarget(options.insert || 'head');

              if (!target) {
                throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");
              }

              target.appendChild(style);
            }

            return style;
          }

          function removeStyleElement(style) {
            // istanbul ignore if
            if (style.parentNode === null) {
              return false;
            }

            style.parentNode.removeChild(style);
          }
          /* istanbul ignore next  */


          var replaceText = function replaceText() {
            var textStore = [];
            return function replace(index, replacement) {
              textStore[index] = replacement;
              return textStore.filter(Boolean).join('\n');
            };
          }();

          function applyToSingletonTag(style, index, remove, obj) {
            var css = remove ? '' : obj.media ? "@media ".concat(obj.media, " {").concat(obj.css, "}") : obj.css; // For old IE

            /* istanbul ignore if  */

            if (style.styleSheet) {
              style.styleSheet.cssText = replaceText(index, css);
            } else {
              var cssNode = document.createTextNode(css);
              var childNodes = style.childNodes;

              if (childNodes[index]) {
                style.removeChild(childNodes[index]);
              }

              if (childNodes.length) {
                style.insertBefore(cssNode, childNodes[index]);
              } else {
                style.appendChild(cssNode);
              }
            }
          }

          function applyToTag(style, options, obj) {
            var css = obj.css;
            var media = obj.media;
            var sourceMap = obj.sourceMap;

            if (media) {
              style.setAttribute('media', media);
            } else {
              style.removeAttribute('media');
            }

            if (sourceMap && typeof btoa !== 'undefined') {
              css += "\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), " */");
            } // For old IE

            /* istanbul ignore if  */


            if (style.styleSheet) {
              style.styleSheet.cssText = css;
            } else {
              while (style.firstChild) {
                style.removeChild(style.firstChild);
              }

              style.appendChild(document.createTextNode(css));
            }
          }

          var singleton = null;
          var singletonCounter = 0;

          function addStyle(obj, options) {
            var style;
            var update;
            var remove;

            if (options.singleton) {
              var styleIndex = singletonCounter++;
              style = singleton || (singleton = insertStyleElement(options));
              update = applyToSingletonTag.bind(null, style, styleIndex, false);
              remove = applyToSingletonTag.bind(null, style, styleIndex, true);
            } else {
              style = insertStyleElement(options);
              update = applyToTag.bind(null, style, options);

              remove = function remove() {
                removeStyleElement(style);
              };
            }

            update(obj);
            return function updateStyle(newObj) {
              if (newObj) {
                if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {
                  return;
                }

                update(obj = newObj);
              } else {
                remove();
              }
            };
          }

          module.exports = function (list, options) {
            options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>
            // tags it will allow on a page

            if (!options.singleton && typeof options.singleton !== 'boolean') {
              options.singleton = isOldIE();
            }

            list = list || [];
            var lastIdentifiers = modulesToDom(list, options);
            return function update(newList) {
              newList = newList || [];

              if (Object.prototype.toString.call(newList) !== '[object Array]') {
                return;
              }

              for (var i = 0; i < lastIdentifiers.length; i++) {
                var identifier = lastIdentifiers[i];
                var index = getIndexByIdentifier(identifier);
                stylesInDom[index].references--;
              }

              var newLastIdentifiers = modulesToDom(newList, options);

              for (var _i = 0; _i < lastIdentifiers.length; _i++) {
                var _identifier = lastIdentifiers[_i];

                var _index = getIndexByIdentifier(_identifier);

                if (stylesInDom[_index].references === 0) {
                  stylesInDom[_index].updater();

                  stylesInDom.splice(_index, 1);
                }
              }

              lastIdentifiers = newLastIdentifiers;
            };
          };
          /***/

        },

        /***/
        "../node_modules/webpack/buildin/global.js":
        /*!*************************************************!*\
          !*** ../node_modules/webpack/buildin/global.js ***!
          \*************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function node_modulesWebpackBuildinGlobalJs(module, exports) {
          var g; // This works in non-strict mode

          g = function () {
            return this;
          }();

          try {
            // This works if eval is allowed (see CSP)
            g = g || new Function("return this")();
          } catch (e) {
            // This works if the window reference is available
            if (_typeof(window) === "object") g = window;
          } // g can still be undefined, but nothing to do about it...
          // We return undefined, instead of nothing here, so it's
          // easier to handle this case. if(!global) { ...}


          module.exports = g;
          /***/
        },

        /***/
        "../src/js/columns/action/internal/InlineInputElement.css":
        /*!****************************************************************!*\
          !*** ../src/js/columns/action/internal/InlineInputElement.css ***!
          \****************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsColumnsActionInternalInlineInputElementCss(module, exports, __nested_webpack_require_49454__) {
          var api = __nested_webpack_require_49454__(
          /*! ../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_49454__(
          /*! !../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../node_modules/postcss-loader/src??ref--5-2!./InlineInputElement.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/action/internal/InlineInputElement.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "../src/js/columns/action/internal/InlineMenuElement.css":
        /*!***************************************************************!*\
          !*** ../src/js/columns/action/internal/InlineMenuElement.css ***!
          \***************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsColumnsActionInternalInlineMenuElementCss(module, exports, __nested_webpack_require_50991__) {
          var api = __nested_webpack_require_50991__(
          /*! ../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_50991__(
          /*! !../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../node_modules/postcss-loader/src??ref--5-2!./InlineMenuElement.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/action/internal/InlineMenuElement.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "../src/js/columns/action/internal/SmallDialogInputElement.css":
        /*!*********************************************************************!*\
          !*** ../src/js/columns/action/internal/SmallDialogInputElement.css ***!
          \*********************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsColumnsActionInternalSmallDialogInputElementCss(module, exports, __nested_webpack_require_52556__) {
          var api = __nested_webpack_require_52556__(
          /*! ../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_52556__(
          /*! !../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../node_modules/postcss-loader/src??ref--5-2!./SmallDialogInputElement.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/action/internal/SmallDialogInputElement.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "../src/js/columns/message/internal/ErrorMessageElement.css":
        /*!******************************************************************!*\
          !*** ../src/js/columns/message/internal/ErrorMessageElement.css ***!
          \******************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsColumnsMessageInternalErrorMessageElementCss(module, exports, __nested_webpack_require_54118__) {
          var api = __nested_webpack_require_54118__(
          /*! ../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_54118__(
          /*! !../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../node_modules/postcss-loader/src??ref--5-2!./ErrorMessageElement.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/message/internal/ErrorMessageElement.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "../src/js/columns/message/internal/MessageElement.css":
        /*!*************************************************************!*\
          !*** ../src/js/columns/message/internal/MessageElement.css ***!
          \*************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsColumnsMessageInternalMessageElementCss(module, exports, __nested_webpack_require_55648__) {
          var api = __nested_webpack_require_55648__(
          /*! ../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_55648__(
          /*! !../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../node_modules/postcss-loader/src??ref--5-2!./MessageElement.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/message/internal/MessageElement.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "../src/js/columns/message/internal/WarningMessageElement.css":
        /*!********************************************************************!*\
          !*** ../src/js/columns/message/internal/WarningMessageElement.css ***!
          \********************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsColumnsMessageInternalWarningMessageElementCss(module, exports, __nested_webpack_require_57203__) {
          var api = __nested_webpack_require_57203__(
          /*! ../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_57203__(
          /*! !../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../node_modules/postcss-loader/src??ref--5-2!./WarningMessageElement.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/columns/message/internal/WarningMessageElement.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "../src/js/internal/style.css":
        /*!************************************!*\
          !*** ../src/js/internal/style.css ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsInternalStyleCss(module, exports, __nested_webpack_require_58614__) {
          var api = __nested_webpack_require_58614__(
          /*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_58614__(
          /*! !../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../node_modules/postcss-loader/src??ref--5-2!./style.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/internal/style.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "../src/js/tooltip/internal/TooltipElement.css":
        /*!*****************************************************!*\
          !*** ../src/js/tooltip/internal/TooltipElement.css ***!
          \*****************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function srcJsTooltipInternalTooltipElementCss(module, exports, __nested_webpack_require_60043__) {
          var api = __nested_webpack_require_60043__(
          /*! ../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */
          "../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");

          var content = __nested_webpack_require_60043__(
          /*! !../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../node_modules/postcss-loader/src??ref--5-2!./TooltipElement.css */
          "../node_modules/css-loader/dist/cjs.js?!../node_modules/postcss-loader/src/index.js?!../src/js/tooltip/internal/TooltipElement.css");

          content = content.__esModule ? content.default : content;

          if (typeof content === 'string') {
            content = [[module.i, content, '']];
          }

          var options = {};
          options.insert = "head";
          options.singleton = false;
          var update = api(content, options);
          module.exports = content.locals || {};
          /***/
        },

        /***/
        "./GridCanvasHelper.js":
        /*!*****************************!*\
          !*** ./GridCanvasHelper.js ***!
          \*****************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function GridCanvasHelperJs(module, exports, __nested_webpack_require_61392__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.GridCanvasHelper = void 0;

          var calc = __importStar(__nested_webpack_require_61392__(
          /*! ./internal/calc */
          "./internal/calc.js"));

          var canvashelper = __importStar(__nested_webpack_require_61392__(
          /*! ./tools/canvashelper */
          "./tools/canvashelper.js"));

          var fonts = __importStar(__nested_webpack_require_61392__(
          /*! ./internal/fonts */
          "./internal/fonts.js"));

          var inlineUtils = __importStar(__nested_webpack_require_61392__(
          /*! ./element/inlines */
          "./element/inlines.js"));

          var themes = __importStar(__nested_webpack_require_61392__(
          /*! ./themes */
          "./themes.js"));

          var canvases_1 = __nested_webpack_require_61392__(
          /*! ./internal/canvases */
          "./internal/canvases.js");

          var utils_1 = __nested_webpack_require_61392__(
          /*! ./internal/utils */
          "./internal/utils.js");

          var InlineDrawer_1 = __nested_webpack_require_61392__(
          /*! ./element/InlineDrawer */
          "./element/InlineDrawer.js");

          var Rect_1 = __nested_webpack_require_61392__(
          /*! ./internal/Rect */
          "./internal/Rect.js");

          var color_1 = __nested_webpack_require_61392__(
          /*! ./internal/color */
          "./internal/color.js");

          var _toBoxArray = utils_1.style.toBoxArray;
          var INLINE_ELLIPSIS = inlineUtils.of("\u2026");
          var TEXT_OFFSET = 2;
          var CHECKBOX_OFFSET = TEXT_OFFSET + 1;

          function invalidateCell(context, grid) {
            var col = context.col,
                row = context.row;
            grid.invalidateCell(col, row);
          }

          function _getStyleProperty(color, col, row, grid, context) {
            return (0, utils_1.getOrApply)(color, {
              col: col,
              row: row,
              grid: grid,
              context: context
            });
          }

          function getFont(font, col, row, grid, context) {
            if (font == null) {
              return undefined;
            }

            return (0, utils_1.getOrApply)(font, {
              col: col,
              row: row,
              grid: grid,
              context: context
            });
          }

          function _getThemeValue(grid) {
            for (var _len = arguments.length, names = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
              names[_key - 1] = arguments[_key];
            }

            var gridThemeValue = (0, utils_1.getChainSafe).apply(void 0, [grid.theme].concat(names));

            if (gridThemeValue == null) {
              // use default theme
              return (0, utils_1.getChainSafe).apply(void 0, [themes.getDefault()].concat(names));
            }

            if (typeof gridThemeValue !== "function") {
              return gridThemeValue;
            }

            var defaultThemeValue; // eslint-disable-next-line @typescript-eslint/no-explicit-any

            return function (args) {
              var value = gridThemeValue(args);

              if (value != null) {
                // use grid theme
                return value;
              } // use default theme


              defaultThemeValue = defaultThemeValue || (0, utils_1.getChainSafe).apply(void 0, [themes.getDefault()].concat(names));
              return (0, utils_1.getOrApply)(defaultThemeValue, args); // eslint-disable-next-line @typescript-eslint/no-explicit-any
            };
          }

          function _testFontLoad(font, value, context, grid) {
            if (font) {
              if (!fonts.check(font, value)) {
                fonts.load(font, value, function () {
                  return invalidateCell(context, grid);
                });
                return false;
              }
            }

            return true;
          }

          function drawInlines(ctx, inlines, rect, offset, offsetTop, offsetBottom, col, row, grid) {
            function drawInline(inline, offsetLeft, offsetRight) {
              if (inline.canDraw()) {
                ctx.save();

                try {
                  ctx.fillStyle = _getStyleProperty(inline.color() || ctx.fillStyle, col, row, grid, ctx);
                  ctx.font = inline.font() || ctx.font;
                  inline.draw({
                    ctx: ctx,
                    canvashelper: canvashelper,
                    rect: rect,
                    offset: offset,
                    offsetLeft: offsetLeft,
                    offsetRight: offsetRight,
                    offsetTop: offsetTop,
                    offsetBottom: offsetBottom
                  });
                } finally {
                  ctx.restore();
                }
              } else {
                inline.onReady(function () {
                  return grid.invalidateCell(col, row);
                }); //noop
              }
            }

            if (inlines.length === 1) {
              //1件の場合は幅計算が不要なため分岐
              var inline = inlines[0];
              drawInline(inline, 0, 0);
            } else {
              var inlineWidths = inlines.map(function (inline) {
                return (inline.width({
                  ctx: ctx
                }) || 0) - 0;
              });
              var offsetRight = inlineWidths.reduce(function (a, b) {
                return a + b;
              });
              var offsetLeft = 0;
              inlines.forEach(function (inline, index) {
                var inlineWidth = inlineWidths[index];
                offsetRight -= inlineWidth;
                drawInline(inline, offsetLeft, offsetRight);
                offsetLeft += inlineWidth;
              });
            }
          }

          function buildInlines(icons, inline) {
            return inlineUtils.buildInlines(icons, inline || "");
          }

          function inlineToString(inline) {
            return inlineUtils.string(inline);
          }

          function getOverflowInline(textOverflow) {
            if (!isAllowOverflow(textOverflow) || textOverflow === "ellipsis") {
              return INLINE_ELLIPSIS;
            }

            textOverflow = textOverflow.trim();

            if (textOverflow.length === 1) {
              return inlineUtils.of(textOverflow[0]);
            }

            return INLINE_ELLIPSIS;
          }

          function isAllowOverflow(textOverflow) {
            return Boolean(textOverflow && textOverflow !== "clip" && typeof textOverflow === "string");
          }

          function getOverflowInlinesIndex(ctx, inlines, width) {
            var maxWidth = width - 3;
            /*buffer*/

            var lineWidth = 0;

            for (var i = 0; i < inlines.length; i++) {
              var inline = inlines[i];
              var inlineWidth = (inline.width({
                ctx: ctx
              }) || 0) - 0;

              if (lineWidth + inlineWidth > maxWidth) {
                return {
                  index: i,
                  lineWidth: lineWidth,
                  remWidth: maxWidth - lineWidth
                };
              }

              lineWidth += inlineWidth;
            }

            return null;
          }

          function isOverflowInlines(ctx, inlines, width) {
            return !!getOverflowInlinesIndex(ctx, inlines, width);
          }

          function breakWidthInlines(ctx, inlines, width) {
            var indexData = getOverflowInlinesIndex(ctx, inlines, width);

            if (!indexData) {
              return {
                beforeInlines: inlines,
                overflow: false,
                afterInlines: []
              };
            }

            var index = indexData.index,
                remWidth = indexData.remWidth;
            var inline = inlines[index];
            var beforeInlines = inlines.slice(0, index);
            var afterInlines = [];

            if (inline.canBreak()) {
              var _inline$breakWord = inline.breakWord(ctx, remWidth),
                  before = _inline$breakWord.before,
                  after = _inline$breakWord.after;

              if (!before && !beforeInlines.length) {
                var _inline$breakAll = inline.breakAll(ctx, remWidth);

                before = _inline$breakAll.before;
                after = _inline$breakAll.after;
              }

              if (!before && !beforeInlines.length) {
                // Always return one char
                var _inline$splitIndex = inline.splitIndex(1);

                before = _inline$splitIndex.before;
                after = _inline$splitIndex.after;
              }

              if (before) {
                beforeInlines.push(before);
              }

              if (after) {
                afterInlines.push(after);
              }

              afterInlines.push.apply(afterInlines, _toConsumableArray(inlines.slice(index + 1)));
            } else {
              if (!beforeInlines.length) {
                // Always return one char
                beforeInlines.push(inline);
              }

              afterInlines.push.apply(afterInlines, _toConsumableArray(inlines.slice(beforeInlines.length)));
            }

            return {
              beforeInlines: beforeInlines,
              overflow: true,
              afterInlines: afterInlines
            };
          }

          function truncateInlines(ctx, inlines, width, option) {
            var indexData = getOverflowInlinesIndex(ctx, inlines, width);

            if (!indexData) {
              return {
                inlines: inlines,
                overflow: false
              };
            }

            var index = indexData.index,
                lineWidth = indexData.lineWidth;
            var inline = inlines[index];
            var overflowInline = getOverflowInline(option);
            var ellipsisWidth = overflowInline.width({
              ctx: ctx
            });
            var remWidth = width - lineWidth - ellipsisWidth;
            var result = inlines.slice(0, index);

            if (inline.canBreak()) {
              var _inline$breakAll2 = inline.breakAll(ctx, remWidth),
                  before = _inline$breakAll2.before;

              if (before) {
                result.push(before);
              }
            }

            result.push(overflowInline);
            return {
              inlines: result,
              overflow: true
            };
          }

          function _inlineRect(grid, ctx, inline, drawRect, col, row, _ref) {
            var offset = _ref.offset,
                color = _ref.color,
                textAlign = _ref.textAlign,
                textBaseline = _ref.textBaseline,
                font = _ref.font,
                textOverflow = _ref.textOverflow,
                icons = _ref.icons,
                trailingIcon = _ref.trailingIcon;
            //文字style
            ctx.fillStyle = _getStyleProperty(color || ctx.fillStyle, col, row, grid, ctx);
            ctx.textAlign = textAlign;
            ctx.textBaseline = textBaseline;
            ctx.font = font || ctx.font;
            var inlines = buildInlines(icons, inline);
            var trailingIconInline = trailingIcon ? inlineUtils.iconOf(trailingIcon) : null;
            var inlineDrawRect = drawRect;
            var width = drawRect.width;
            var trailingIconWidth = 0;

            if (trailingIconInline) {
              trailingIconWidth = trailingIconInline.width({
                ctx: ctx
              });
              width -= trailingIconWidth;
              inlineDrawRect = new Rect_1.Rect(drawRect.left, drawRect.top, width, drawRect.height);
            }

            if (isAllowOverflow(textOverflow) && isOverflowInlines(ctx, inlines, width)) {
              var _truncateInlines = truncateInlines(ctx, inlines, width, textOverflow),
                  truncInlines = _truncateInlines.inlines,
                  overflow = _truncateInlines.overflow;

              inlines = truncInlines;
              grid.setCellOverflowText(col, row, overflow && inlineToString(inline));
            } else {
              grid.setCellOverflowText(col, row, false);
            }

            drawInlines(ctx, inlines, inlineDrawRect, offset, 0, 0, col, row, grid);

            if (trailingIconInline) {
              // Draw trailing icon
              var sumWidth = 0;
              inlines.forEach(function (inline) {
                sumWidth += inline.width({
                  ctx: ctx
                });
              });
              var baseRect = new Rect_1.Rect(drawRect.left, drawRect.top, drawRect.width, drawRect.height);
              var trailingIconRect = baseRect.copy();

              if (width < sumWidth) {
                trailingIconRect.left = trailingIconRect.right - trailingIconWidth - offset;
              } else {
                trailingIconRect.left += sumWidth;
              }

              trailingIconRect.right = baseRect.right;
              drawInlines(ctx, [trailingIconInline], trailingIconRect, offset, 0, 0, col, row, grid);
            }
          } // eslint-disable-next-line complexity


          function _multiInlineRect(grid, ctx, multiInlines, drawRect, col, row, _ref2) {
            var offset = _ref2.offset,
                color = _ref2.color,
                textAlign = _ref2.textAlign,
                textBaseline = _ref2.textBaseline,
                font = _ref2.font,
                lineHeight = _ref2.lineHeight,
                autoWrapText = _ref2.autoWrapText,
                lineClamp = _ref2.lineClamp,
                textOverflow = _ref2.textOverflow,
                icons = _ref2.icons,
                trailingIcon = _ref2.trailingIcon;
            //文字style
            ctx.fillStyle = _getStyleProperty(color || ctx.fillStyle, col, row, grid, ctx);
            ctx.textAlign = textAlign;
            ctx.textBaseline = textBaseline;
            ctx.font = font || ctx.font;

            if (lineClamp === "auto") {
              var rectHeight = drawRect.height - offset * 2 - 2;
              /*offset added by Inline#draw*/

              lineClamp = Math.max(Math.floor(rectHeight / lineHeight), 1);
            }

            var trailingIconInline = trailingIcon ? inlineUtils.iconOf(trailingIcon) : null;
            var width = drawRect.width;
            var trailingIconWidth = 0;

            if (trailingIconInline) {
              trailingIconWidth = trailingIconInline.width({
                ctx: ctx
              });
              width -= trailingIconWidth;
            }

            var buildedMultiInlines;

            if (autoWrapText || lineClamp > 0 || isAllowOverflow(textOverflow)) {
              buildedMultiInlines = [];
              var procLineClamp = lineClamp > 0 ? function (inlines, hasNext) {
                if (buildedMultiInlines.length + 1 >= lineClamp) {
                  if (inlines.length === 0 && hasNext) {
                    buildedMultiInlines.push([getOverflowInline(textOverflow)]);
                    grid.setCellOverflowText(col, row, multiInlines.map(inlineToString).join("\n"));
                  } else {
                    var _truncateInlines2 = truncateInlines(ctx, inlines, width, textOverflow),
                        truncInlines = _truncateInlines2.inlines,
                        overflow = _truncateInlines2.overflow;

                    buildedMultiInlines.push(hasNext && !overflow ? truncInlines.concat([getOverflowInline(textOverflow)]) : truncInlines);

                    if (overflow || hasNext) {
                      grid.setCellOverflowText(col, row, multiInlines.map(inlineToString).join("\n"));
                    }
                  }

                  return false;
                }

                return true;
              } : function () {
                return true;
              };
              var procLine = autoWrapText ? function (inlines, hasNext) {
                if (!procLineClamp(inlines, hasNext)) {
                  return false;
                }

                while (inlines.length) {
                  if (!procLineClamp(inlines, hasNext)) {
                    return false;
                  }

                  var _breakWidthInlines = breakWidthInlines(ctx, inlines, width),
                      beforeInlines = _breakWidthInlines.beforeInlines,
                      afterInlines = _breakWidthInlines.afterInlines;

                  buildedMultiInlines.push(beforeInlines);
                  inlines = afterInlines;
                }

                return true;
              } : isAllowOverflow(textOverflow) ? function (inlines, hasNext) {
                if (!procLineClamp(inlines, hasNext)) {
                  return false;
                }

                var _truncateInlines3 = truncateInlines(ctx, inlines, width, textOverflow),
                    truncInlines = _truncateInlines3.inlines,
                    overflow = _truncateInlines3.overflow;

                buildedMultiInlines.push(truncInlines);

                if (overflow) {
                  grid.setCellOverflowText(col, row, multiInlines.map(inlineToString).join("\n"));
                }

                return true;
              } : function (inlines, hasNext) {
                if (!procLineClamp(inlines, hasNext)) {
                  return false;
                }

                buildedMultiInlines.push(inlines);
                return true;
              };
              grid.setCellOverflowText(col, row, false);

              for (var lineRow = 0; lineRow < multiInlines.length; lineRow++) {
                var inline = multiInlines[lineRow];
                var buildedInline = buildInlines(lineRow === 0 ? icons : undefined, inline);

                if (!procLine(buildedInline, lineRow + 1 < multiInlines.length)) {
                  break;
                }
              }
            } else {
              grid.setCellOverflowText(col, row, false);
              buildedMultiInlines = multiInlines.map(function (inline, lineRow) {
                return buildInlines(lineRow === 0 ? icons : undefined, inline);
              });
            }

            var paddingTop = 0;
            var paddingBottom = lineHeight * (buildedMultiInlines.length - 1);

            if (ctx.textBaseline === "top" || ctx.textBaseline === "hanging") {
              var em = (0, canvases_1.getFontSize)(ctx, ctx.font).height;
              var pad = (lineHeight - em) / 2;
              paddingTop += pad;
              paddingBottom -= pad;
            } else if (ctx.textBaseline === "bottom" || ctx.textBaseline === "alphabetic" || ctx.textBaseline === "ideographic") {
              var _em = (0, canvases_1.getFontSize)(ctx, ctx.font).height;

              var _pad = (lineHeight - _em) / 2;

              paddingTop -= _pad;
              paddingBottom += _pad;
            }

            buildedMultiInlines.forEach(function (buildedInline) {
              drawInlines(ctx, buildedInline, drawRect, offset, paddingTop, paddingBottom, col, row, grid);
              paddingTop += lineHeight;
              paddingBottom -= lineHeight;
            });

            if (trailingIconInline) {
              // Draw trailing icon
              var maxWidth = 0;
              buildedMultiInlines.forEach(function (buildedInline) {
                var sumWidth = 0;
                buildedInline.forEach(function (inline) {
                  sumWidth += inline.width({
                    ctx: ctx
                  });
                });
                maxWidth = Math.max(maxWidth, sumWidth);
              });
              var baseRect = new Rect_1.Rect(drawRect.left, drawRect.top, drawRect.width, drawRect.height);
              var trailingIconRect = baseRect.copy();

              if (width < maxWidth) {
                trailingIconRect.left = trailingIconRect.right - trailingIconWidth - offset;
              } else {
                trailingIconRect.left += maxWidth;
              }

              trailingIconRect.right = baseRect.right;
              drawInlines(ctx, [trailingIconInline], trailingIconRect, offset, 0, 0, col, row, grid);
            }
          }

          function calcElapsedColor(startColor, endColor, elapsedTime) {
            var startColorRGB = (0, color_1.colorToRGB)(startColor);
            var endColorRGB = (0, color_1.colorToRGB)(endColor);

            var getRGB = function getRGB(colorName) {
              var start = startColorRGB[colorName];
              var end = endColorRGB[colorName];

              if (elapsedTime >= 1) {
                return end;
              }

              if (elapsedTime <= 0) {
                return start;
              }

              var diff = start - end;
              return Math.ceil(start - diff * elapsedTime);
            };

            return "rgb(".concat(getRGB("r"), ", ").concat(getRGB("g"), ", ").concat(getRGB("b"), ")");
          }

          function drawCheckbox(ctx, rect, col, row, check, helper, _ref3) {
            var _ref3$animElapsedTime = _ref3.animElapsedTime,
                animElapsedTime = _ref3$animElapsedTime === void 0 ? 1 : _ref3$animElapsedTime,
                _ref3$uncheckBgColor = _ref3.uncheckBgColor,
                uncheckBgColor = _ref3$uncheckBgColor === void 0 ? helper.theme.checkbox.uncheckBgColor : _ref3$uncheckBgColor,
                _ref3$checkBgColor = _ref3.checkBgColor,
                checkBgColor = _ref3$checkBgColor === void 0 ? helper.theme.checkbox.checkBgColor : _ref3$checkBgColor,
                _ref3$borderColor = _ref3.borderColor,
                borderColor = _ref3$borderColor === void 0 ? helper.theme.checkbox.borderColor : _ref3$borderColor,
                _ref3$textAlign = _ref3.textAlign,
                textAlign = _ref3$textAlign === void 0 ? "center" : _ref3$textAlign,
                _ref3$textBaseline = _ref3.textBaseline,
                textBaseline = _ref3$textBaseline === void 0 ? "middle" : _ref3$textBaseline;
            var positionOpt = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : {};
            var boxWidth = canvashelper.measureCheckbox(ctx).width;
            ctx.textAlign = textAlign;
            ctx.textBaseline = textBaseline;
            var pos = (0, canvases_1.calcStartPosition)(ctx, rect, boxWidth + 1
            /*罫線分+1*/
            , boxWidth + 1
            /*罫線分+1*/
            , positionOpt);
            uncheckBgColor = helper.getColor(uncheckBgColor, col, row, ctx);
            checkBgColor = helper.getColor(checkBgColor, col, row, ctx);
            borderColor = helper.getColor(borderColor, col, row, ctx);

            if (0 < animElapsedTime && animElapsedTime < 1) {
              uncheckBgColor = check ? uncheckBgColor : calcElapsedColor(checkBgColor, uncheckBgColor, animElapsedTime);
              checkBgColor = check ? calcElapsedColor(uncheckBgColor, checkBgColor, animElapsedTime) : checkBgColor;
            }

            canvashelper.drawCheckbox(ctx, pos.x, pos.y, check ? animElapsedTime : false, {
              uncheckBgColor: uncheckBgColor,
              checkBgColor: checkBgColor,
              borderColor: borderColor
            });
          }

          function drawRadioButton(ctx, rect, col, row, check, helper, _ref4) {
            var _ref4$animElapsedTime = _ref4.animElapsedTime,
                animElapsedTime = _ref4$animElapsedTime === void 0 ? 1 : _ref4$animElapsedTime,
                _ref4$checkColor = _ref4.checkColor,
                checkColor = _ref4$checkColor === void 0 ? helper.theme.radioButton.checkColor : _ref4$checkColor,
                _ref4$uncheckBorderCo = _ref4.uncheckBorderColor,
                uncheckBorderColor = _ref4$uncheckBorderCo === void 0 ? helper.theme.radioButton.uncheckBorderColor : _ref4$uncheckBorderCo,
                _ref4$checkBorderColo = _ref4.checkBorderColor,
                checkBorderColor = _ref4$checkBorderColo === void 0 ? helper.theme.radioButton.checkBorderColor : _ref4$checkBorderColo,
                _ref4$uncheckBgColor = _ref4.uncheckBgColor,
                uncheckBgColor = _ref4$uncheckBgColor === void 0 ? helper.theme.radioButton.uncheckBgColor : _ref4$uncheckBgColor,
                _ref4$checkBgColor = _ref4.checkBgColor,
                checkBgColor = _ref4$checkBgColor === void 0 ? helper.theme.radioButton.checkBgColor : _ref4$checkBgColor,
                _ref4$textAlign = _ref4.textAlign,
                textAlign = _ref4$textAlign === void 0 ? "center" : _ref4$textAlign,
                _ref4$textBaseline = _ref4.textBaseline,
                textBaseline = _ref4$textBaseline === void 0 ? "middle" : _ref4$textBaseline;
            var positionOpt = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : {};
            var boxWidth = canvashelper.measureRadioButton(ctx).width;
            ctx.textAlign = textAlign;
            ctx.textBaseline = textBaseline;
            var pos = (0, canvases_1.calcStartPosition)(ctx, rect, boxWidth + 1
            /*罫線分+1*/
            , boxWidth + 1
            /*罫線分+1*/
            , positionOpt);
            checkColor = helper.getColor(checkColor, col, row, ctx);
            uncheckBorderColor = helper.getColor(uncheckBorderColor, col, row, ctx);
            checkBorderColor = helper.getColor(checkBorderColor, col, row, ctx);
            uncheckBgColor = helper.getColor(uncheckBgColor, col, row, ctx);
            checkBgColor = helper.getColor(checkBgColor, col, row, ctx);
            var borderColor = check ? checkBorderColor : uncheckBorderColor;
            var bgColor = check ? checkBgColor : uncheckBgColor;

            if (0 < animElapsedTime && animElapsedTime < 1) {
              borderColor = check ? calcElapsedColor(uncheckBorderColor, checkBorderColor, animElapsedTime) : calcElapsedColor(checkBorderColor, uncheckBorderColor, animElapsedTime);
              bgColor = check ? calcElapsedColor(uncheckBgColor, checkBgColor, animElapsedTime) : calcElapsedColor(checkBgColor, uncheckBgColor, animElapsedTime);
            }

            canvashelper.drawRadioButton(ctx, pos.x, pos.y, check ? animElapsedTime : 1 - animElapsedTime, {
              checkColor: checkColor,
              borderColor: borderColor,
              bgColor: bgColor
            });
          }

          var ThemeResolver = /*#__PURE__*/function () {
            function ThemeResolver(grid) {
              _classCallCheck(this, ThemeResolver);

              this._checkbox = null;
              this._radioButton = null;
              this._button = null;
              this._tree = null;
              this._header = null;
              this._messages = null;
              this._indicators = null;
              this._grid = grid;
            }

            _createClass(ThemeResolver, [{
              key: "getThemeValue",
              value: function getThemeValue() {
                for (var _len2 = arguments.length, name = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
                  name[_key2] = arguments[_key2];
                }

                return _getThemeValue.apply(void 0, [this._grid].concat(name));
              }
            }, {
              key: "font",
              get: function get() {
                return _getThemeValue(this._grid, "font");
              }
            }, {
              key: "underlayBackgroundColor",
              get: function get() {
                return _getThemeValue(this._grid, "underlayBackgroundColor");
              } // color

            }, {
              key: "color",
              get: function get() {
                return _getThemeValue(this._grid, "color");
              }
            }, {
              key: "frozenRowsColor",
              get: function get() {
                return _getThemeValue(this._grid, "frozenRowsColor");
              } // background

            }, {
              key: "defaultBgColor",
              get: function get() {
                return _getThemeValue(this._grid, "defaultBgColor");
              }
            }, {
              key: "frozenRowsBgColor",
              get: function get() {
                return _getThemeValue(this._grid, "frozenRowsBgColor");
              }
            }, {
              key: "selectionBgColor",
              get: function get() {
                return _getThemeValue(this._grid, "selectionBgColor");
              }
            }, {
              key: "highlightBgColor",
              get: function get() {
                return _getThemeValue(this._grid, "highlightBgColor");
              } // border

            }, {
              key: "borderColor",
              get: function get() {
                return _getThemeValue(this._grid, "borderColor");
              }
            }, {
              key: "frozenRowsBorderColor",
              get: function get() {
                return _getThemeValue(this._grid, "frozenRowsBorderColor");
              }
            }, {
              key: "highlightBorderColor",
              get: function get() {
                return _getThemeValue(this._grid, "highlightBorderColor");
              }
            }, {
              key: "checkbox",
              get: function get() {
                var grid = this._grid;
                return this._checkbox || (this._checkbox = {
                  get uncheckBgColor() {
                    return getCheckboxProp("uncheckBgColor");
                  },

                  get checkBgColor() {
                    return getCheckboxProp("checkBgColor");
                  },

                  get borderColor() {
                    return getCheckboxProp("borderColor");
                  }

                });

                function getCheckboxProp(prop) {
                  return _getThemeValue(grid, "checkbox", prop);
                }
              }
            }, {
              key: "radioButton",
              get: function get() {
                var grid = this._grid;
                return this._radioButton || (this._radioButton = {
                  get checkColor() {
                    return getRadioButtonProp("checkColor");
                  },

                  get uncheckBorderColor() {
                    return getRadioButtonProp("uncheckBorderColor");
                  },

                  get checkBorderColor() {
                    return getRadioButtonProp("checkBorderColor");
                  },

                  get uncheckBgColor() {
                    return getRadioButtonProp("uncheckBgColor");
                  },

                  get checkBgColor() {
                    return getRadioButtonProp("checkBgColor");
                  }

                });

                function getRadioButtonProp(prop) {
                  return _getThemeValue(grid, "radioButton", prop);
                }
              }
            }, {
              key: "button",
              get: function get() {
                var grid = this._grid;
                return this._button || (this._button = {
                  get color() {
                    return getButtonProp("color");
                  },

                  get bgColor() {
                    return getButtonProp("bgColor");
                  }

                });

                function getButtonProp(prop) {
                  return _getThemeValue(grid, "button", prop);
                }
              }
            }, {
              key: "tree",
              get: function get() {
                var grid = this._grid;
                return this._tree || (this._tree = {
                  get lineStyle() {
                    return getTreeProp("lineStyle");
                  },

                  get lineColor() {
                    return getTreeProp("lineColor");
                  },

                  get lineWidth() {
                    return getTreeProp("lineWidth");
                  },

                  get treeIcon() {
                    return getTreeProp("treeIcon");
                  }

                });

                function getTreeProp(prop) {
                  return _getThemeValue(grid, "tree", prop);
                }
              }
            }, {
              key: "header",
              get: function get() {
                var grid = this._grid;
                return this._header || (this._header = {
                  get sortArrowColor() {
                    return _getThemeValue(grid, "header", "sortArrowColor");
                  }

                });
              }
            }, {
              key: "messages",
              get: function get() {
                var grid = this._grid;
                return this._messages || (this._messages = {
                  get infoBgColor() {
                    return getMessageProp("infoBgColor");
                  },

                  get errorBgColor() {
                    return getMessageProp("errorBgColor");
                  },

                  get warnBgColor() {
                    return getMessageProp("warnBgColor");
                  },

                  get boxWidth() {
                    return getMessageProp("boxWidth");
                  },

                  get markHeight() {
                    return getMessageProp("markHeight");
                  }

                });

                function getMessageProp(prop) {
                  return _getThemeValue(grid, "messages", prop);
                }
              }
            }, {
              key: "indicators",
              get: function get() {
                var grid = this._grid;
                return this._indicators || (this._indicators = {
                  get topLeftColor() {
                    return getIndicatorsProp("topLeftColor");
                  },

                  get topLeftSize() {
                    return getIndicatorsProp("topLeftSize");
                  },

                  get topRightColor() {
                    return getIndicatorsProp("topRightColor");
                  },

                  get topRightSize() {
                    return getIndicatorsProp("topRightSize");
                  },

                  get bottomRightColor() {
                    return getIndicatorsProp("bottomRightColor");
                  },

                  get bottomRightSize() {
                    return getIndicatorsProp("bottomRightSize");
                  },

                  get bottomLeftColor() {
                    return getIndicatorsProp("bottomLeftColor");
                  },

                  get bottomLeftSize() {
                    return getIndicatorsProp("bottomLeftSize");
                  }

                });

                function getIndicatorsProp(prop) {
                  return _getThemeValue(grid, "indicators", prop);
                }
              }
            }]);

            return ThemeResolver;
          }();

          function strokeRect(ctx, color, left, top, width, height) {
            if (!Array.isArray(color)) {
              if (color) {
                ctx.strokeStyle = color;
                ctx.strokeRect(left, top, width, height);
              }
            } else {
              var borderColors = _toBoxArray(color);

              canvashelper.strokeColorsRect(ctx, borderColors, left, top, width, height);
            }
          }

          function getPaddedRect(rect, padding, font, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          helper, context) {
            if (!padding) {
              return rect;
            }

            var _helper$toBoxPixelArr = helper.toBoxPixelArray(padding, context, font),
                pTop = _helper$toBoxPixelArr[0],
                pRight = _helper$toBoxPixelArr[1],
                pBottom = _helper$toBoxPixelArr[2],
                pLeft = _helper$toBoxPixelArr[3];

            var left = rect.left + pLeft;
            var top = rect.top + pTop;
            var width = rect.width - pRight - pLeft;
            var height = rect.height - pTop - pBottom;
            return new Rect_1.Rect(left, top, width, height);
          }

          var GridCanvasHelper = /*#__PURE__*/function () {
            function GridCanvasHelper(grid) {
              _classCallCheck(this, GridCanvasHelper);

              this._grid = grid;
              this._theme = new ThemeResolver(grid);
            }

            _createClass(GridCanvasHelper, [{
              key: "createCalculator",
              value: function createCalculator(context, font) {
                return {
                  calcWidth: function calcWidth(width) {
                    return calc.toPx(width, {
                      get full() {
                        var rect = context.getRect();
                        return rect.width;
                      },

                      get em() {
                        return (0, canvases_1.getFontSize)(context.getContext(), font).width;
                      }

                    });
                  },
                  calcHeight: function calcHeight(height) {
                    return calc.toPx(height, {
                      get full() {
                        var rect = context.getRect();
                        return rect.height;
                      },

                      get em() {
                        return (0, canvases_1.getFontSize)(context.getContext(), font).height;
                      }

                    });
                  }
                };
              }
            }, {
              key: "getColor",
              value: function getColor(color, col, row, ctx) {
                return _getStyleProperty(color, col, row, this._grid, ctx);
              }
            }, {
              key: "getStyleProperty",
              value: function getStyleProperty(style, col, row, ctx) {
                return _getStyleProperty(style, col, row, this._grid, ctx);
              }
            }, {
              key: "toBoxArray",
              value: function toBoxArray(obj) {
                return _toBoxArray(obj);
              }
            }, {
              key: "toBoxPixelArray",
              value: function toBoxPixelArray(value, context, font) {
                if (typeof value === "string" || Array.isArray(value)) {
                  var calculator = this.createCalculator(context, font);

                  var box = _toBoxArray(value);

                  return [calculator.calcHeight(box[0]), calculator.calcWidth(box[1]), calculator.calcHeight(box[2]), calculator.calcWidth(box[3])];
                }

                return _toBoxArray(value);
              }
            }, {
              key: "theme",
              get: function get() {
                return this._theme;
              }
            }, {
              key: "drawWithClip",
              value: function drawWithClip(context, draw) {
                var drawRect = context.getDrawRect();

                if (!drawRect) {
                  return;
                }

                var ctx = context.getContext();
                ctx.save();

                try {
                  ctx.beginPath();
                  ctx.rect(drawRect.left, drawRect.top, drawRect.width, drawRect.height); //clip

                  ctx.clip();
                  draw(ctx);
                } finally {
                  ctx.restore();
                }
              }
            }, {
              key: "drawBorderWithClip",
              value: function drawBorderWithClip(context, draw) {
                var drawRect = context.getDrawRect();

                if (!drawRect) {
                  return;
                }

                var rect = context.getRect();
                var ctx = context.getContext();
                ctx.save();

                try {
                  //罫線用clip
                  ctx.beginPath();
                  var clipLeft = drawRect.left;
                  var clipWidth = drawRect.width;

                  if (drawRect.left === rect.left) {
                    clipLeft += -1;
                    clipWidth += 1;
                  }

                  var clipTop = drawRect.top;
                  var clipHeight = drawRect.height;

                  if (drawRect.top === rect.top) {
                    clipTop += -1;
                    clipHeight += 1;
                  }

                  ctx.rect(clipLeft, clipTop, clipWidth, clipHeight);
                  ctx.clip();
                  draw(ctx);
                } finally {
                  ctx.restore();
                }
              }
            }, {
              key: "text",
              value: function text(_text, context) {
                var _this = this;

                var _ref5 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                    padding = _ref5.padding,
                    _ref5$offset = _ref5.offset,
                    offset = _ref5$offset === void 0 ? TEXT_OFFSET : _ref5$offset,
                    color = _ref5.color,
                    _ref5$textAlign = _ref5.textAlign,
                    textAlign = _ref5$textAlign === void 0 ? "left" : _ref5$textAlign,
                    _ref5$textBaseline = _ref5.textBaseline,
                    textBaseline = _ref5$textBaseline === void 0 ? "middle" : _ref5$textBaseline,
                    font = _ref5.font,
                    _ref5$textOverflow = _ref5.textOverflow,
                    textOverflow = _ref5$textOverflow === void 0 ? "clip" : _ref5$textOverflow,
                    icons = _ref5.icons,
                    trailingIcon = _ref5.trailingIcon;

                var col = context.col,
                    row = context.row;

                if (!color) {
                  color = this.theme.color;

                  // header color
                  var isFrozenCell = this._grid.isFrozenCell(col, row);

                  if (isFrozenCell && isFrozenCell.row) {
                    color = this.theme.frozenRowsColor;
                  }
                }

                this.drawWithClip(context, function (ctx) {
                  font = getFont(font, context.col, context.row, _this._grid, ctx);
                  var rect = getPaddedRect(context.getRect(), padding, font, _this, context);

                  _inlineRect(_this._grid, ctx, _text, rect, col, row, {
                    offset: offset,
                    color: color,
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    font: font,
                    textOverflow: textOverflow,
                    icons: icons,
                    trailingIcon: trailingIcon
                  });
                });
              }
            }, {
              key: "multilineText",
              value: function multilineText(lines, context) {
                var _this2 = this;

                var _ref6 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                    padding = _ref6.padding,
                    _ref6$offset = _ref6.offset,
                    offset = _ref6$offset === void 0 ? TEXT_OFFSET : _ref6$offset,
                    color = _ref6.color,
                    _ref6$textAlign = _ref6.textAlign,
                    textAlign = _ref6$textAlign === void 0 ? "left" : _ref6$textAlign,
                    _ref6$textBaseline = _ref6.textBaseline,
                    textBaseline = _ref6$textBaseline === void 0 ? "middle" : _ref6$textBaseline,
                    font = _ref6.font,
                    _ref6$lineHeight = _ref6.lineHeight,
                    lineHeight = _ref6$lineHeight === void 0 ? "1em" : _ref6$lineHeight,
                    _ref6$autoWrapText = _ref6.autoWrapText,
                    autoWrapText = _ref6$autoWrapText === void 0 ? false : _ref6$autoWrapText,
                    _ref6$lineClamp = _ref6.lineClamp,
                    lineClamp = _ref6$lineClamp === void 0 ? 0 : _ref6$lineClamp,
                    _ref6$textOverflow = _ref6.textOverflow,
                    textOverflow = _ref6$textOverflow === void 0 ? "clip" : _ref6$textOverflow,
                    icons = _ref6.icons,
                    trailingIcon = _ref6.trailingIcon;

                var col = context.col,
                    row = context.row;

                if (!color) {
                  color = this.theme.color;

                  // header color
                  var isFrozenCell = this._grid.isFrozenCell(col, row);

                  if (isFrozenCell && isFrozenCell.row) {
                    color = this.theme.frozenRowsColor;
                  }
                }

                this.drawWithClip(context, function (ctx) {
                  font = getFont(font, context.col, context.row, _this2._grid, ctx);
                  var rect = getPaddedRect(context.getRect(), padding, font, _this2, context);

                  var calculator = _this2.createCalculator(context, font);

                  lineHeight = calculator.calcHeight(lineHeight);

                  _multiInlineRect(_this2._grid, ctx, lines, rect, col, row, {
                    offset: offset,
                    color: color,
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    font: font,
                    lineHeight: lineHeight,
                    autoWrapText: autoWrapText,
                    lineClamp: lineClamp,
                    textOverflow: textOverflow,
                    icons: icons,
                    trailingIcon: trailingIcon
                  });
                });
              }
            }, {
              key: "fillText",
              value: function fillText(text, x, y, context) {
                var _ref7 = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {},
                    color = _ref7.color,
                    _ref7$textAlign = _ref7.textAlign,
                    textAlign = _ref7$textAlign === void 0 ? "left" : _ref7$textAlign,
                    _ref7$textBaseline = _ref7.textBaseline,
                    textBaseline = _ref7$textBaseline === void 0 ? "top" : _ref7$textBaseline,
                    font = _ref7.font;

                var col = context.col,
                    row = context.row;

                if (!color) {
                  color = this.theme.color;

                  // header color
                  var isFrozenCell = this._grid.isFrozenCell(col, row);

                  if (isFrozenCell && isFrozenCell.row) {
                    color = this.theme.frozenRowsColor;
                  }
                }

                var ctx = context.getContext();
                ctx.save();

                try {
                  font = getFont(font, context.col, context.row, this._grid, ctx);
                  ctx.fillStyle = _getStyleProperty(color, col, row, this._grid, ctx);
                  ctx.textAlign = textAlign;
                  ctx.textBaseline = textBaseline;
                  ctx.font = font || ctx.font;
                  ctx.fillText(text, x, y);
                } finally {
                  ctx.restore();
                }
              }
            }, {
              key: "fillCell",
              value: function fillCell(context) {
                var _this3 = this;

                var _ref8 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
                    _ref8$fillColor = _ref8.fillColor,
                    fillColor = _ref8$fillColor === void 0 ? this.theme.defaultBgColor : _ref8$fillColor;

                var rect = context.getRect();
                this.drawWithClip(context, function (ctx) {
                  var col = context.col,
                      row = context.row;
                  ctx.fillStyle = _getStyleProperty(fillColor, col, row, _this3._grid, ctx);
                  ctx.beginPath();
                  ctx.rect(rect.left, rect.top, rect.width, rect.height);
                  ctx.fill();
                });
              }
            }, {
              key: "fillCellWithState",
              value: function fillCellWithState(context) {
                var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
                option.fillColor = this.getFillColorState(context, option);
                this.fillCell(context, option);
              }
            }, {
              key: "fillRect",
              value: function fillRect(rect, context) {
                var _ref9 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                    _ref9$fillColor = _ref9.fillColor,
                    fillColor = _ref9$fillColor === void 0 ? this.theme.defaultBgColor : _ref9$fillColor;

                var ctx = context.getContext();
                ctx.save();

                try {
                  var col = context.col,
                      row = context.row;
                  ctx.fillStyle = _getStyleProperty(fillColor, col, row, this._grid, ctx);
                  ctx.beginPath();
                  ctx.rect(rect.left, rect.top, rect.width, rect.height);
                  ctx.fill();
                } finally {
                  ctx.restore();
                }
              }
            }, {
              key: "fillRectWithState",
              value: function fillRectWithState(rect, context) {
                var option = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
                option.fillColor = this.getFillColorState(context, option);
                this.fillRect(rect, context, option);
              }
            }, {
              key: "getFillColorState",
              value: function getFillColorState(context) {
                var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
                var sel = context.getSelection();
                var col = context.col,
                    row = context.row;

                if (!(0, utils_1.cellEquals)(sel.select, context) && (0, utils_1.cellInRange)(sel.range, col, row)) {
                  return this.theme.selectionBgColor;
                }

                if (option.fillColor) {
                  return option.fillColor;
                }

                if ((0, utils_1.cellEquals)(sel.select, context)) {
                  return this.theme.highlightBgColor;
                }

                var isFrozenCell = this._grid.isFrozenCell(col, row);

                if (isFrozenCell && isFrozenCell.row) {
                  return this.theme.frozenRowsBgColor;
                }

                return this.theme.defaultBgColor;
              }
            }, {
              key: "border",
              value: function border(context) {
                var _this4 = this;

                var _ref10 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
                    _ref10$borderColor = _ref10.borderColor,
                    borderColor = _ref10$borderColor === void 0 ? this.theme.borderColor : _ref10$borderColor,
                    _ref10$lineWidth = _ref10.lineWidth,
                    lineWidth = _ref10$lineWidth === void 0 ? 1 : _ref10$lineWidth;

                var rect = context.getRect();
                this.drawBorderWithClip(context, function (ctx) {
                  var col = context.col,
                      row = context.row;

                  var borderColors = _getStyleProperty(borderColor, col, row, _this4._grid, ctx);

                  if (lineWidth === 1) {
                    ctx.lineWidth = 1;
                    strokeRect(ctx, borderColors, rect.left - 0.5, rect.top - 0.5, rect.width, rect.height);
                  } else if (lineWidth === 2) {
                    ctx.lineWidth = 2;
                    strokeRect(ctx, borderColors, rect.left, rect.top, rect.width - 1, rect.height - 1);
                  } else {
                    ctx.lineWidth = lineWidth;
                    var startOffset = lineWidth / 2 - 1;
                    strokeRect(ctx, borderColors, rect.left + startOffset, rect.top + startOffset, rect.width - lineWidth + 1, rect.height - lineWidth + 1);
                  }
                });
              } // Unused in main

            }, {
              key: "borderWithState",
              value: function borderWithState(context) {
                var _this5 = this;

                var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
                var rect = context.getRect();
                var sel = context.getSelection();
                var col = context.col,
                    row = context.row; //罫線

                if ((0, utils_1.cellEquals)(sel.select, context)) {
                  option.borderColor = this.theme.highlightBorderColor;
                  option.lineWidth = 2;
                  this.border(context, option);
                } else {
                  // header color
                  var isFrozenCell = this._grid.isFrozenCell(col, row);

                  if (isFrozenCell === null || isFrozenCell === void 0 ? void 0 : isFrozenCell.row) {
                    option.borderColor = this.theme.frozenRowsBorderColor;
                  }

                  option.lineWidth = 1;
                  this.border(context, option); //追加処理

                  var _sel = this._grid.selection.select;

                  if (_sel.col + 1 === col && _sel.row === row) {
                    //右が選択されている
                    this.drawBorderWithClip(context, function (ctx) {
                      var borderColors = _toBoxArray(_getStyleProperty(_this5.theme.highlightBorderColor, _sel.col, _sel.row, _this5._grid, ctx));

                      ctx.lineWidth = 1;
                      ctx.strokeStyle = borderColors[1] || ctx.strokeStyle;
                      ctx.beginPath();
                      ctx.moveTo(rect.left - 0.5, rect.top);
                      ctx.lineTo(rect.left - 0.5, rect.bottom);
                      ctx.stroke();
                    });
                  } else if (_sel.col === col && _sel.row + 1 === row) {
                    //上が選択されている
                    this.drawBorderWithClip(context, function (ctx) {
                      var borderColors = _toBoxArray(_getStyleProperty(_this5.theme.highlightBorderColor, _sel.col, _sel.row, _this5._grid, ctx));

                      ctx.lineWidth = 1;
                      ctx.strokeStyle = borderColors[0] || ctx.strokeStyle;
                      ctx.beginPath();
                      ctx.moveTo(rect.left, rect.top - 0.5);
                      ctx.lineTo(rect.right, rect.top - 0.5);
                      ctx.stroke();
                    });
                  }
                }
              }
            }, {
              key: "buildCheckBoxInline",
              value: function buildCheckBoxInline(check, context) {
                var option = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
                // eslint-disable-next-line @typescript-eslint/no-this-alias
                var self = this;
                var ctx = context.getContext();
                var boxWidth = canvashelper.measureCheckbox(ctx).width;
                return new InlineDrawer_1.InlineDrawer({
                  draw: draw,
                  width: boxWidth + 3,
                  height: boxWidth + 1,
                  color: undefined
                });

                function draw(_ref11) {
                  var ctx = _ref11.ctx,
                      rect = _ref11.rect,
                      offset = _ref11.offset,
                      offsetLeft = _ref11.offsetLeft,
                      offsetRight = _ref11.offsetRight,
                      offsetTop = _ref11.offsetTop,
                      offsetBottom = _ref11.offsetBottom;
                  var col = context.col,
                      row = context.row;
                  drawCheckbox(ctx, rect, col, row, check, self, option, {
                    offset: offset + (CHECKBOX_OFFSET - TEXT_OFFSET),
                    padding: {
                      left: offsetLeft + (CHECKBOX_OFFSET - TEXT_OFFSET),
                      right: offsetRight,
                      top: offsetTop,
                      bottom: offsetBottom
                    }
                  });
                }
              }
            }, {
              key: "checkbox",
              value: function checkbox(check, context) {
                var _this6 = this;

                var _ref12 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                    padding = _ref12.padding,
                    animElapsedTime = _ref12.animElapsedTime,
                    _ref12$offset = _ref12.offset,
                    offset = _ref12$offset === void 0 ? CHECKBOX_OFFSET : _ref12$offset,
                    uncheckBgColor = _ref12.uncheckBgColor,
                    checkBgColor = _ref12.checkBgColor,
                    borderColor = _ref12.borderColor,
                    textAlign = _ref12.textAlign,
                    textBaseline = _ref12.textBaseline;

                this.drawWithClip(context, function (ctx) {
                  var col = context.col,
                      row = context.row;
                  drawCheckbox(ctx, getPaddedRect(context.getRect(), padding, undefined
                  /* font */
                  , _this6, context), col, row, check, _this6, {
                    animElapsedTime: animElapsedTime,
                    uncheckBgColor: uncheckBgColor,
                    checkBgColor: checkBgColor,
                    borderColor: borderColor,
                    textAlign: textAlign,
                    textBaseline: textBaseline
                  }, {
                    offset: offset,
                    padding: {
                      left: CHECKBOX_OFFSET - TEXT_OFFSET
                    }
                  });
                });
              }
            }, {
              key: "radioButton",
              value: function radioButton(check, context) {
                var _this7 = this;

                var _ref13 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                    padding = _ref13.padding,
                    animElapsedTime = _ref13.animElapsedTime,
                    _ref13$offset = _ref13.offset,
                    offset = _ref13$offset === void 0 ? CHECKBOX_OFFSET : _ref13$offset,
                    checkColor = _ref13.checkColor,
                    uncheckBorderColor = _ref13.uncheckBorderColor,
                    checkBorderColor = _ref13.checkBorderColor,
                    uncheckBgColor = _ref13.uncheckBgColor,
                    checkBgColor = _ref13.checkBgColor,
                    textAlign = _ref13.textAlign,
                    textBaseline = _ref13.textBaseline;

                this.drawWithClip(context, function (ctx) {
                  var col = context.col,
                      row = context.row;
                  drawRadioButton(ctx, getPaddedRect(context.getRect(), padding, undefined
                  /* font */
                  , _this7, context), col, row, check, _this7, {
                    animElapsedTime: animElapsedTime,
                    checkColor: checkColor,
                    uncheckBorderColor: uncheckBorderColor,
                    checkBorderColor: checkBorderColor,
                    uncheckBgColor: uncheckBgColor,
                    checkBgColor: checkBgColor,
                    textAlign: textAlign,
                    textBaseline: textBaseline
                  }, {
                    offset: offset,
                    padding: {
                      left: CHECKBOX_OFFSET - TEXT_OFFSET
                    }
                  });
                });
              }
            }, {
              key: "button",
              value: function button(caption, context) {
                var _this8 = this;

                var _ref14 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                    _ref14$bgColor = _ref14.bgColor,
                    bgColor = _ref14$bgColor === void 0 ? this.theme.button.bgColor : _ref14$bgColor,
                    padding = _ref14.padding,
                    _ref14$offset = _ref14.offset,
                    offset = _ref14$offset === void 0 ? TEXT_OFFSET : _ref14$offset,
                    _ref14$color = _ref14.color,
                    color = _ref14$color === void 0 ? this.theme.button.color : _ref14$color,
                    _ref14$textAlign = _ref14.textAlign,
                    textAlign = _ref14$textAlign === void 0 ? "center" : _ref14$textAlign,
                    _ref14$textBaseline = _ref14.textBaseline,
                    textBaseline = _ref14$textBaseline === void 0 ? "middle" : _ref14$textBaseline,
                    shadow = _ref14.shadow,
                    font = _ref14.font,
                    _ref14$textOverflow = _ref14.textOverflow,
                    textOverflow = _ref14$textOverflow === void 0 ? "clip" : _ref14$textOverflow,
                    icons = _ref14.icons;

                var rect = context.getRect();
                this.drawWithClip(context, function (ctx) {
                  font = getFont(font, context.col, context.row, _this8._grid, ctx);
                  var col = context.col,
                      row = context.row;

                  var _getPaddedRect = getPaddedRect(rect, padding || rect.height / 8, font, _this8, context),
                      left = _getPaddedRect.left,
                      top = _getPaddedRect.top,
                      width = _getPaddedRect.width,
                      height = _getPaddedRect.height;

                  bgColor = _getStyleProperty(bgColor, context.col, context.row, _this8._grid, ctx);
                  canvashelper.drawButton(ctx, left, top, width, height, {
                    bgColor: bgColor,
                    radius: rect.height / 8,
                    // offset,
                    shadow: shadow
                  });

                  _inlineRect(_this8._grid, ctx, caption, new Rect_1.Rect(left, top, width, height), col, row, {
                    offset: offset,
                    color: color,
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    font: font,
                    textOverflow: textOverflow,
                    icons: icons
                  });
                });
              }
            }, {
              key: "testFontLoad",
              value: function testFontLoad(font, value, context) {
                return _testFontLoad(font, value, context, this._grid);
              }
            }]);

            return GridCanvasHelper;
          }();

          exports.GridCanvasHelper = GridCanvasHelper;
          /***/
        },

        /***/
        "./ListGrid.js":
        /*!*********************!*\
          !*** ./ListGrid.js ***!
          \*********************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function ListGridJs(module, exports, __nested_webpack_require_126191__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          var _a;

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ListGrid = void 0;

          var icons = __importStar(__nested_webpack_require_126191__(
          /*! ./internal/icons */
          "./internal/icons.js"));

          var themes = __importStar(__nested_webpack_require_126191__(
          /*! ./themes */
          "./themes.js"));

          var data_1 = __nested_webpack_require_126191__(
          /*! ./data */
          "./data.js");

          var layout_map_1 = __nested_webpack_require_126191__(
          /*! ./list-grid/layout-map */
          "./list-grid/layout-map/index.js");

          var MessageHandler_1 = __nested_webpack_require_126191__(
          /*! ./columns/message/MessageHandler */
          "./columns/message/MessageHandler.js");

          var utils_1 = __nested_webpack_require_126191__(
          /*! ./internal/utils */
          "./internal/utils.js");

          var style_1 = __nested_webpack_require_126191__(
          /*! ./columns/style */
          "./columns/style.js");

          var DrawGrid_1 = __nested_webpack_require_126191__(
          /*! ./core/DrawGrid */
          "./core/DrawGrid.js");

          var GridCanvasHelper_1 = __nested_webpack_require_126191__(
          /*! ./GridCanvasHelper */
          "./GridCanvasHelper.js");

          var style_2 = __nested_webpack_require_126191__(
          /*! ./header/style */
          "./header/style.js");

          var LG_EVENT_TYPE_1 = __nested_webpack_require_126191__(
          /*! ./list-grid/LG_EVENT_TYPE */
          "./list-grid/LG_EVENT_TYPE.js");

          var Rect_1 = __nested_webpack_require_126191__(
          /*! ./internal/Rect */
          "./internal/Rect.js");

          var TooltipHandler_1 = __nested_webpack_require_126191__(
          /*! ./tooltip/TooltipHandler */
          "./tooltip/TooltipHandler.js"); //protected symbol


          var symbolManager_1 = __nested_webpack_require_126191__(
          /*! ./internal/symbolManager */
          "./internal/symbolManager.js");

          var paste_utils_1 = __nested_webpack_require_126191__(
          /*! ./internal/paste-utils */
          "./internal/paste-utils.js");
          /** @private */


          var _ = (0, symbolManager_1.getProtectedSymbol)(); //private methods

          /** @private */


          function _getCellRange(grid, col, row) {
            return grid[_].layoutMap.getCellRange(col, row);
          }
          /** @private */


          function _updateRect(grid, col, row, context) {
            context.setRectFilter(function (rect) {
              var left = rect.left,
                  right = rect.right,
                  top = rect.top,
                  bottom = rect.bottom;

              var _getCellRange2 = _getCellRange(grid, col, row),
                  _getCellRange2$start = _getCellRange2.start,
                  startCol = _getCellRange2$start.col,
                  startRow = _getCellRange2$start.row,
                  _getCellRange2$end = _getCellRange2.end,
                  endCol = _getCellRange2$end.col,
                  endRow = _getCellRange2$end.row;

              for (var c = col - 1; c >= startCol; c--) {
                left -= grid.getColWidth(c);
              }

              for (var _c2 = col + 1; _c2 <= endCol; _c2++) {
                right += grid.getColWidth(_c2);
              }

              for (var r = row - 1; r >= startRow; r--) {
                top -= grid.getRowHeight(r);
              }

              for (var _r = row + 1; _r <= endRow; _r++) {
                bottom += grid.getRowHeight(_r);
              }

              return Rect_1.Rect.bounds(left, top, right, bottom);
            });
          }
          /** @private */


          function _getCellValue(grid, col, row) {
            if (row < grid[_].layoutMap.headerRowCount) {
              var _grid$_$layoutMap$get = grid[_].layoutMap.getHeader(col, row),
                  caption = _grid$_$layoutMap$get.caption;

              return typeof caption === "function" ? caption() : caption;
            } else {
              var _grid$_$layoutMap$get2 = grid[_].layoutMap.getBody(col, row),
                  field = _grid$_$layoutMap$get2.field;

              return _getField(grid, field, row);
            }
          }
          /** @private */


          function _setCellValue(grid, col, row, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          value) {
            if (row < grid[_].layoutMap.headerRowCount) {
              // nop
              return false;
            } else {
              var _grid$_$layoutMap$get3 = grid[_].layoutMap.getBody(col, row),
                  field = _grid$_$layoutMap$get3.field;

              if (field == null) {
                return false;
              }

              var index = _getRecordIndexByRow(grid, row);

              return grid[_].dataSource.setField(index, field, value);
            }
          }
          /** @private */


          function _getCellMessage(grid, col, row) {
            if (row < grid[_].layoutMap.headerRowCount) {
              return null;
            } else {
              var _grid$_$layoutMap$get4 = grid[_].layoutMap.getBody(col, row),
                  message = _grid$_$layoutMap$get4.message;

              if (!message) {
                return null;
              }

              if (!Array.isArray(message)) {
                return _getField(grid, message, row);
              }

              var promises = [];

              for (var index = 0; index < message.length; index++) {
                var msg = _getField(grid, message[index], row);

                if ((0, utils_1.isPromise)(msg)) {
                  promises.push(msg);
                } else if ((0, MessageHandler_1.hasMessage)(msg)) {
                  return msg;
                }
              }

              if (!promises.length) {
                return null;
              }

              return new Promise(function (resolve, reject) {
                promises.forEach(function (p) {
                  p.then(function (msg) {
                    if ((0, MessageHandler_1.hasMessage)(msg)) {
                      resolve(msg);
                    }
                  }, reject);
                });
              });
            }
          }

          function _getCellIcon0(grid, icon, row) {
            if (Array.isArray(icon)) {
              return icon.map(function (i) {
                return _getCellIcon0(grid, i, row);
              });
            }

            if (!utils_1.obj.isObject(icon) || typeof icon === "function") {
              return _getField(grid, icon, row);
            } // eslint-disable-next-line @typescript-eslint/no-explicit-any


            var retIcon = {}; // eslint-disable-next-line @typescript-eslint/no-explicit-any

            var iconOpt = icon;
            icons.iconPropKeys.forEach(function (k) {
              if (iconOpt[k]) {
                var f = _getField(grid, iconOpt[k], row);

                if (f != null) {
                  retIcon[k] = f;
                } else {
                  if (!_hasField(grid, iconOpt[k], row)) {
                    retIcon[k] = iconOpt[k];
                  }
                }
              }
            });
            return retIcon;
          }
          /** @private */


          function _getCellIcon(grid, col, row) {
            if (row < grid[_].layoutMap.headerRowCount) {
              var _grid$_$layoutMap$get5 = grid[_].layoutMap.getHeader(col, row),
                  headerIcon = _grid$_$layoutMap$get5.headerIcon;

              if (headerIcon == null) {
                return null;
              }

              return headerIcon;
            } else {
              var _grid$_$layoutMap$get6 = grid[_].layoutMap.getBody(col, row),
                  icon = _grid$_$layoutMap$get6.icon;

              if (icon == null) {
                return null;
              }

              return _getCellIcon0(grid, icon, row);
            }
          }
          /** @private */


          function _getField(grid, field, row) {
            if (field == null) {
              return null;
            }

            if (row < grid[_].layoutMap.headerRowCount) {
              return null;
            } else {
              var index = _getRecordIndexByRow(grid, row);

              return grid[_].dataSource.getField(index, field);
            }
          }
          /** @private */


          function _hasField(grid, field, row) {
            if (field == null) {
              return false;
            }

            if (row < grid[_].layoutMap.headerRowCount) {
              return false;
            } else {
              var index = _getRecordIndexByRow(grid, row);

              return grid[_].dataSource.hasField(index, field);
            }
          }
          /** @private */


          function _onDrawValue(grid, cellValue, context, _ref15, style, draw) {
            var col = _ref15.col,
                row = _ref15.row;
            var helper = grid[_].gridCanvasHelper;

            var drawCellBg = function drawCellBg() {
              var _ref16 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
                  bgColor = _ref16.bgColor;

              var fillOpt = {
                fillColor: bgColor
              }; //cell全体を描画

              helper.fillCellWithState(context, fillOpt);
            };

            var drawCellBorder = function drawCellBorder() {
              if (context.col === grid.frozenColCount - 1) {
                //固定列罫線
                var rect = context.getRect();
                helper.drawWithClip(context, function (ctx) {
                  var borderColor = context.row >= grid.frozenRowCount ? helper.theme.borderColor : helper.theme.frozenRowsBorderColor;
                  var borderColors = helper.toBoxArray(helper.getColor(borderColor, context.col, context.row, ctx));

                  if (borderColors[1]) {
                    ctx.lineWidth = 1;
                    ctx.strokeStyle = borderColors[1];
                    ctx.beginPath();
                    ctx.moveTo(rect.right - 2.5, rect.top);
                    ctx.lineTo(rect.right - 2.5, rect.bottom);
                    ctx.stroke();
                  }
                });
              }

              _borderWithState(grid, helper, context);
            };

            var drawCellBase = function drawCellBase() {
              var _ref17 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
                  bgColor = _ref17.bgColor;

              drawCellBg({
                bgColor: bgColor
              });
              drawCellBorder();
            };

            var info = {
              getRecord: function getRecord() {
                return grid.getRowRecord(row);
              },
              getIcon: function getIcon() {
                return _getCellIcon(grid, col, row);
              },
              getMessage: function getMessage() {
                return _getCellMessage(grid, col, row);
              },
              messageHandler: grid[_].messageHandler,
              style: style,
              drawCellBase: drawCellBase,
              drawCellBg: drawCellBg,
              drawCellBorder: drawCellBorder
            };
            return draw(cellValue, info, context, grid);
          }
          /** @private */


          function _borderWithState(grid, helper, context) {
            var col = context.col,
                row = context.row;
            var sel = grid.selection.select;
            var layoutMap = grid[_].layoutMap;
            var rect = context.getRect();
            var option = {};
            var selRecordIndex = layoutMap.getRecordIndexByRow(sel.row);
            var selId = layoutMap.getCellId(sel.col, sel.row);

            function isSelectCell(col, row) {
              if (col === sel.col && row === sel.row) {
                return true;
              }

              return selId != null && layoutMap.getCellId(col, row) === selId && layoutMap.getRecordIndexByRow(row) === selRecordIndex;
            } //罫線


            if (isSelectCell(col, row)) {
              option.borderColor = helper.theme.highlightBorderColor;
              option.lineWidth = 2;
              helper.border(context, option);
            } else {
              option.lineWidth = 1; // header color

              var isFrozenCell = grid.isFrozenCell(col, row);

              if (isFrozenCell === null || isFrozenCell === void 0 ? void 0 : isFrozenCell.row) {
                option.borderColor = helper.theme.frozenRowsBorderColor;
              }

              helper.border(context, option); //追加処理

              if (col > 0 && isSelectCell(col - 1, row)) {
                //右が選択されている
                helper.drawBorderWithClip(context, function (ctx) {
                  var borderColors = helper.toBoxArray(helper.getColor(helper.theme.highlightBorderColor, sel.col, sel.row, ctx));

                  if (borderColors[1]) {
                    ctx.lineWidth = 1;
                    ctx.strokeStyle = borderColors[1];
                    ctx.beginPath();
                    ctx.moveTo(rect.left - 0.5, rect.top);
                    ctx.lineTo(rect.left - 0.5, rect.bottom);
                    ctx.stroke();
                  }
                });
              } else if (row > 0 && isSelectCell(col, row - 1)) {
                //上が選択されている
                helper.drawBorderWithClip(context, function (ctx) {
                  var borderColors = helper.toBoxArray(helper.getColor(helper.theme.highlightBorderColor, sel.col, sel.row, ctx));

                  if (borderColors[0]) {
                    ctx.lineWidth = 1;
                    ctx.strokeStyle = borderColors[0];
                    ctx.beginPath();
                    ctx.moveTo(rect.left, rect.top - 0.5);
                    ctx.lineTo(rect.right, rect.top - 0.5);
                    ctx.stroke();
                  }
                });
              }
            }
          }
          /** @private */


          function _refreshHeader(grid) {
            var _b;

            var protectedSpace = grid[_];

            if (protectedSpace.headerEvents) {
              protectedSpace.headerEvents.forEach(function (id) {
                return grid.unlisten(id);
              });
            }

            var headerEvents = grid[_].headerEvents = [];
            headerEvents.forEach(function (id) {
              return grid.unlisten(id);
            });
            var layoutMap;

            if (protectedSpace.layout && (!Array.isArray(protectedSpace.layout) || protectedSpace.layout.length > 0)) {
              layoutMap = protectedSpace.layoutMap = new layout_map_1.MultiLayoutMap(protectedSpace.layout);
            } else {
              layoutMap = protectedSpace.layoutMap = new layout_map_1.SimpleHeaderLayoutMap((_b = protectedSpace.header) !== null && _b !== void 0 ? _b : []);
            }

            layoutMap.headerObjects.forEach(function (cell) {
              var ids = cell.headerType.bindGridEvent(grid, cell.id);
              headerEvents.push.apply(headerEvents, _toConsumableArray(ids));

              if (cell.style) {
                if (cell.style instanceof style_2.BaseStyle) {
                  var id = cell.style.listen(style_2.BaseStyle.EVENT_TYPE.CHANGE_STYLE, function () {
                    grid.invalidate();
                  });
                  headerEvents.push(id);
                }
              }

              if (cell.action) {
                var _ids = cell.action.bindGridEvent(grid, cell.id);

                headerEvents.push.apply(headerEvents, _toConsumableArray(_ids));
              }
            });
            layoutMap.columnObjects.forEach(function (col) {
              if (col.action) {
                var ids = col.action.bindGridEvent(grid, col.id);
                headerEvents.push.apply(headerEvents, _toConsumableArray(ids));
              }

              if (col.columnType) {
                var _ids2 = col.columnType.bindGridEvent(grid, col.id);

                headerEvents.push.apply(headerEvents, _toConsumableArray(_ids2));
              }

              if (col.style) {
                if (col.style instanceof style_1.BaseStyle) {
                  var id = col.style.listen(style_1.BaseStyle.EVENT_TYPE.CHANGE_STYLE, function () {
                    grid.invalidate();
                  });
                  headerEvents.push(id);
                }
              }
            });

            for (var col = 0; col < layoutMap.columnWidths.length; col++) {
              var column = layoutMap.columnWidths[col];
              var width = column.width,
                  minWidth = column.minWidth,
                  maxWidth = column.maxWidth;

              if (width && (typeof width === "string" || width > 0)) {
                grid.setColWidth(col, width);
              } else {
                grid.setColWidth(col, null);
              }

              if (minWidth && (typeof minWidth === "string" || minWidth > 0)) {
                grid.setMinColWidth(col, minWidth);
              } else {
                grid.setMinColWidth(col, null);
              }

              if (maxWidth && (typeof maxWidth === "string" || maxWidth > 0)) {
                grid.setMaxColWidth(col, maxWidth);
              } else {
                grid.setMaxColWidth(col, null);
              }
            }

            var headerRowHeight = grid[_].headerRowHeight;

            for (var row = 0; row < layoutMap.headerRowCount; row++) {
              var height = Array.isArray(headerRowHeight) ? headerRowHeight[row] : headerRowHeight;

              if (height && height > 0) {
                grid.setRowHeight(row, height);
              } else {
                grid.setRowHeight(row, null);
              }
            }

            grid.colCount = layoutMap.colCount;

            _refreshRowCount(grid);

            grid.frozenRowCount = layoutMap.headerRowCount;
          }
          /** @private */


          function _refreshRowCount(grid) {
            var layoutMap = grid[_].layoutMap;
            grid.rowCount = grid[_].dataSource.length * layoutMap.bodyRowCount + layoutMap.headerRowCount;
          }
          /** @private */


          function _tryWithUpdateDataSource(grid, fn) {
            var dataSourceEventIds = grid[_].dataSourceEventIds;

            if (dataSourceEventIds) {
              dataSourceEventIds.forEach(function (id) {
                return grid[_].handler.off(id);
              });
            }

            fn(grid);
            grid[_].dataSourceEventIds = [grid[_].handler.on(grid[_].dataSource, data_1.DataSource.EVENT_TYPE.UPDATED_LENGTH, function () {
              _refreshRowCount(grid);

              grid.invalidate();
            }), grid[_].handler.on(grid[_].dataSource, data_1.DataSource.EVENT_TYPE.UPDATED_ORDER, function () {
              grid.invalidate();
            })];
          }
          /** @private */


          function _setRecords(grid) {
            var records = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

            _tryWithUpdateDataSource(grid, function () {
              grid[_].records = records;
              var newDataSource = grid[_].dataSource = data_1.CachedDataSource.ofArray(records);
              grid.addDisposable(newDataSource);
            });
          }
          /** @private */


          function _setDataSource(grid, dataSource) {
            _tryWithUpdateDataSource(grid, function () {
              if (dataSource) {
                if (dataSource instanceof data_1.DataSource) {
                  grid[_].dataSource = dataSource;
                } else {
                  var newDataSource = grid[_].dataSource = new data_1.CachedDataSource(dataSource);
                  grid.addDisposable(newDataSource);
                }
              } else {
                grid[_].dataSource = data_1.DataSource.EMPTY;
              }

              grid[_].records = null;
            });
          }
          /** @private */


          function _getRecordIndexByRow(grid, row) {
            var layoutMap = grid[_].layoutMap;
            return layoutMap.getRecordIndexByRow(row);
          }
          /** @private */


          function _onRangePaste(text) {
            var _this9 = this;

            var test = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {
              return true;
            };

            var _b;

            var layoutMap = this[_].layoutMap;
            var selectionRange = this.selection.range;

            var _this$getCellRange = this.getCellRange(selectionRange.start.col, selectionRange.start.row),
                start = _this$getCellRange.start;

            var _this$getCellRange2 = this.getCellRange(selectionRange.end.col, selectionRange.end.row),
                end = _this$getCellRange2.end;

            var values = (0, paste_utils_1.parsePasteRangeBoxValues)(text, {
              trimOnPaste: this.trimOnPaste
            });
            var pasteRowCount = Math.min(Math.max(end.row - start.row + 1, values.rowCount), this.rowCount - start.row);
            var pasteColCount = Math.min(Math.max(end.col - start.col + 1, values.colCount), this.colCount - start.col);
            var hasEditable = false;
            var actionColumnsBox = [];

            for (var bodyRow = 0; bodyRow < layoutMap.bodyRowCount; bodyRow++) {
              var actionColumnsRow = [];
              actionColumnsBox.push(actionColumnsRow);

              for (var offsetCol = 0; offsetCol < pasteColCount; offsetCol++) {
                var body = layoutMap.getBody(start.col + offsetCol, bodyRow + layoutMap.headerRowCount);
                actionColumnsRow[offsetCol] = body;

                if (!hasEditable && ((_b = body.action) === null || _b === void 0 ? void 0 : _b.editable)) {
                  hasEditable = true;
                }
              }
            }

            if (!hasEditable) {
              return;
            }

            var startRow = layoutMap.getRecordStartRowByRecordIndex(layoutMap.getRecordIndexByRow(start.row));
            var startRowOffset = start.row - startRow;
            var rejectedDetail = [];

            var addRejectedDetail = function addRejectedDetail(cell, record, define, pasteValue) {
              rejectedDetail.push({
                col: cell.col,
                row: cell.row,
                record: record,
                define: define,
                pasteValue: pasteValue
              });
            };

            var timeout = null;

            var processRejected = function processRejected() {
              if (timeout) clearTimeout(timeout);
              timeout = setTimeout(function () {
                if (rejectedDetail.length > 0) {
                  _this9.fireListeners(LG_EVENT_TYPE_1.LG_EVENT_TYPE.REJECTED_PASTE_VALUES, {
                    detail: rejectedDetail
                  });

                  rejectedDetail = [];
                }
              }, 100);
            };

            var _reject = addRejectedDetail;
            var duplicate = {};
            var actionRow = startRowOffset;
            var valuesRow = 0;

            for (var offsetRow = 0; offsetRow < pasteRowCount; offsetRow++) {
              var valuesCol = 0;

              var _loop = function _loop(_offsetCol) {
                var _actionColumnsBox$act = actionColumnsBox[actionRow][_offsetCol],
                    action = _actionColumnsBox$act.action,
                    id = _actionColumnsBox$act.id,
                    define = _actionColumnsBox$act.define;

                if (!duplicate[id] && (action === null || action === void 0 ? void 0 : action.editable)) {
                  duplicate[id] = true;
                  var col = start.col + _offsetCol;
                  var row = start.row + offsetRow;
                  var cellValue = values.getCellValue(valuesCol, valuesRow);
                  (0, utils_1.then)(_this9.getRowRecord(row), function (record) {
                    (0, utils_1.then)(_getCellValue(_this9, col, row), function (oldValue) {
                      if (test({
                        grid: _this9,
                        record: record,
                        col: col,
                        row: row,
                        value: cellValue,
                        oldValue: oldValue
                      })) {
                        action.onPasteCellRangeBox(_this9, {
                          col: col,
                          row: row
                        }, cellValue, {
                          reject: function reject() {
                            _reject({
                              col: col,
                              row: row
                            }, record, define, cellValue);
                          }
                        });
                      }
                    });
                  });
                }

                valuesCol++;

                if (valuesCol >= values.colCount) {
                  valuesCol = 0;
                }
              };

              for (var _offsetCol = 0; _offsetCol < pasteColCount; _offsetCol++) {
                _loop(_offsetCol);
              }

              actionRow++;

              if (actionRow >= layoutMap.bodyRowCount) {
                actionRow = 0;
                duplicate = {};
              }

              valuesRow++;

              if (valuesRow >= values.rowCount) {
                valuesRow = 0;
              }
            }

            var newEnd = {
              col: start.col + pasteColCount - 1,
              row: start.row + pasteRowCount - 1
            };
            this.selection.range = {
              start: start,
              end: newEnd
            };
            this.invalidateCellRange(this.selection.range);
            processRejected();

            _reject = function _reject(cell, record, define, pasteValue) {
              addRejectedDetail(cell, record, define, pasteValue);
              processRejected();
            };
          }
          /** @private */


          function _onRangeDelete() {
            var _this10 = this;

            var _b;

            var layoutMap = this[_].layoutMap;
            var selectionRange = this.selection.range;

            var _this$getCellRange3 = this.getCellRange(selectionRange.start.col, selectionRange.start.row),
                start = _this$getCellRange3.start;

            var _this$getCellRange4 = this.getCellRange(selectionRange.end.col, selectionRange.end.row),
                end = _this$getCellRange4.end;

            var deleteRowCount = Math.min(end.row - start.row + 1, this.rowCount - start.row);
            var deleteColCount = Math.min(end.col - start.col + 1, this.colCount - start.col);
            var hasEditable = false;
            var actionColumnsBox = [];

            for (var bodyRow = 0; bodyRow < layoutMap.bodyRowCount; bodyRow++) {
              var actionColumnsRow = [];
              actionColumnsBox.push(actionColumnsRow);

              for (var offsetCol = 0; offsetCol < deleteColCount; offsetCol++) {
                var body = layoutMap.getBody(start.col + offsetCol, bodyRow + layoutMap.headerRowCount);
                actionColumnsRow[offsetCol] = body;

                if (!hasEditable && ((_b = body.action) === null || _b === void 0 ? void 0 : _b.editable)) {
                  hasEditable = true;
                }
              }
            }

            if (!hasEditable) {
              return;
            }

            var startRow = layoutMap.getRecordStartRowByRecordIndex(layoutMap.getRecordIndexByRow(start.row));
            var startRowOffset = start.row - startRow;
            var duplicate = {};
            var actionRow = startRowOffset;

            for (var offsetRow = 0; offsetRow < deleteRowCount; offsetRow++) {
              var _loop2 = function _loop2(_offsetCol2) {
                var _actionColumnsBox$act2 = actionColumnsBox[actionRow][_offsetCol2],
                    action = _actionColumnsBox$act2.action,
                    id = _actionColumnsBox$act2.id;

                if (!duplicate[id] && (action === null || action === void 0 ? void 0 : action.editable)) {
                  duplicate[id] = true;
                  var col = start.col + _offsetCol2;
                  var row = start.row + offsetRow;
                  (0, utils_1.then)(_this10.getRowRecord(row), function (_record) {
                    (0, utils_1.then)(_getCellValue(_this10, col, row), function (_oldValue) {
                      action.onDeleteCellRangeBox(_this10, {
                        col: col,
                        row: row
                      });
                    });
                  });
                }
              };

              for (var _offsetCol2 = 0; _offsetCol2 < deleteColCount; _offsetCol2++) {
                _loop2(_offsetCol2);
              }

              actionRow++;

              if (actionRow >= layoutMap.bodyRowCount) {
                actionRow = 0;
                duplicate = {};
              }
            }

            this.invalidateCellRange(selectionRange);
          }
          /**
           * ListGrid
           * @classdesc cheetahGrid.ListGrid
           * @memberof cheetahGrid
           */


          var ListGrid = /*#__PURE__*/function (_DrawGrid_1$DrawGrid) {
            _inherits(ListGrid, _DrawGrid_1$DrawGrid);

            var _super = _createSuper(ListGrid);

            /**
             * constructor
             *
             * @constructor
             * @param options Constructor options
             */
            function ListGrid() {
              var _this11;

              var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, ListGrid);

              var _b;

              _this11 = _super.call(this, (0, utils_1.omit)(options, ["colCount", "rowCount", "frozenRowCount"]));
              _this11[_a] = _this11[_];
              _this11.disabled = false;
              _this11.readOnly = false;
              var protectedSpace = _this11[_];
              protectedSpace.header = options.header || [];
              protectedSpace.layout = options.layout || [];
              protectedSpace.headerRowHeight = options.headerRowHeight || [];

              if (options.dataSource) {
                _setDataSource(_assertThisInitialized(_this11), options.dataSource);
              } else {
                _setRecords(_assertThisInitialized(_this11), options.records);
              }

              protectedSpace.allowRangePaste = (_b = options.allowRangePaste) !== null && _b !== void 0 ? _b : false;

              _refreshHeader(_assertThisInitialized(_this11));

              protectedSpace.sortState = {
                col: -1,
                row: -1,
                order: undefined
              };
              protectedSpace.gridCanvasHelper = new GridCanvasHelper_1.GridCanvasHelper(_assertThisInitialized(_this11));
              protectedSpace.theme = themes.of(options.theme);
              protectedSpace.messageHandler = new MessageHandler_1.MessageHandler(_assertThisInitialized(_this11), function (col, row) {
                return _getCellMessage(_assertThisInitialized(_this11), col, row);
              });
              protectedSpace.tooltipHandler = new TooltipHandler_1.TooltipHandler(_assertThisInitialized(_this11));

              _this11.invalidate();

              protectedSpace.handler.on(window, "resize", function () {
                _this11.updateSize();

                _this11.updateScroll();

                _this11.invalidate();
              });
              return _this11;
            }
            /**
             * Dispose the grid instance.
             * @returns {void}
             */


            _createClass(ListGrid, [{
              key: "dispose",
              value: function dispose() {
                var protectedSpace = this[_];
                protectedSpace.messageHandler.dispose();
                protectedSpace.tooltipHandler.dispose();

                _get(_getPrototypeOf(ListGrid.prototype), "dispose", this).call(this);
              }
              /**
               * Gets the define of the header.
               */

            }, {
              key: "header",
              get: function get() {
                return this[_].header;
              }
              /**
               * Sets the define of the header with the given data.
               * <pre>
               * column options
               * -----
               * caption: header caption
               * field: field name
               * width: column width
               * minWidth: column min width
               * maxWidth: column max width
               * icon: icon definition
               * message: message key name
               * columnType: column type
               * action: column action
               * style: column style
               * headerType: header type
               * headerStyle: header style
               * headerAction: header action
               * headerField: header field name
               * headerIcon: header icon definition
               * sort: define sort setting
               * -----
               *
               * multiline header
               * -----
               * caption: header caption
               * columns: columns define
               * -----
               * </pre>
               */
              ,
              set: function set(header) {
                this[_].header = header;

                _refreshHeader(this);
              }
              /**
               * Gets the define of the layout.
               */

            }, {
              key: "layout",
              get: function get() {
                return this[_].layout;
              }
              /**
               * Sets the define of the layout with the given data.
               */
              ,
              set: function set(layout) {
                this[_].layout = layout;

                _refreshHeader(this);
              }
              /**
               * Gets the define of the headerRowHeight.
               */

            }, {
              key: "headerRowHeight",
              get: function get() {
                return this[_].headerRowHeight;
              }
              /**
               * Sets the define of the headerRowHeight with the given data.
               */
              ,
              set: function set(headerRowHeight) {
                this[_].headerRowHeight = headerRowHeight || [];

                _refreshHeader(this);
              }
              /**
               * Get the row count per record
               */

            }, {
              key: "recordRowCount",
              get: function get() {
                return this[_].layoutMap.bodyRowCount;
              }
              /**
               * Get the records.
               */

            }, {
              key: "records",
              get: function get() {
                return this[_].records || null;
              }
              /**
               * Set the records from given
               */
              ,
              set: function set(records) {
                if (records == null) {
                  return;
                }

                _setRecords(this, records);

                _refreshRowCount(this);

                this.invalidate();
              }
              /**
               * Get the data source.
               */

            }, {
              key: "dataSource",
              get: function get() {
                return this[_].dataSource;
              }
              /**
               * Set the data source from given
               */
              ,
              set: function set(dataSource) {
                _setDataSource(this, dataSource);

                _refreshRowCount(this);

                this.invalidate();
              }
              /**
               * Get the theme.
               */

            }, {
              key: "theme",
              get: function get() {
                return this[_].theme;
              }
              /**
               * Set the theme from given
               */
              ,
              set: function set(theme) {
                this[_].theme = themes.of(theme);
                this.invalidate();
              }
              /**
               * If set to true to allow pasting of ranges.
               */

            }, {
              key: "allowRangePaste",
              get: function get() {
                return this[_].allowRangePaste;
              },
              set: function set(allowRangePaste) {
                this[_].allowRangePaste = allowRangePaste;
              }
              /**
               * Get the font definition as a string.
               * @override
               */

            }, {
              key: "font",
              get: function get() {
                return _get(_getPrototypeOf(ListGrid.prototype), "font", this) || this[_].gridCanvasHelper.theme.font;
              }
              /**
               * Set the font definition with the given string.
               * @override
               */
              ,
              set: function set(font) {
                _set(_getPrototypeOf(ListGrid.prototype), "font", font, this, true);
              }
              /**
               * Get the background color of the underlay.
               * @override
               */

            }, {
              key: "underlayBackgroundColor",
              get: function get() {
                return _get(_getPrototypeOf(ListGrid.prototype), "underlayBackgroundColor", this) || this[_].gridCanvasHelper.theme.underlayBackgroundColor;
              }
              /**
               * Set the background color of the underlay.
               * @override
               */
              ,
              set: function set(underlayBackgroundColor) {
                _set(_getPrototypeOf(ListGrid.prototype), "underlayBackgroundColor", underlayBackgroundColor, this, true);
              }
              /**
               * Get the sort state.
               */

            }, {
              key: "sortState",
              get: function get() {
                return this[_].sortState;
              }
              /**
               * Sets the sort state.
               * If `null` to set, the sort state is initialized.
               */
              ,
              set: function set(sortState) {
                var oldState = this.sortState;
                var oldField;

                if (oldState.col >= 0 && oldState.row >= 0) {
                  oldField = this.getHeaderField(oldState.col, oldState.row);
                }

                var newState = this[_].sortState = sortState != null ? sortState : {
                  col: -1,
                  row: -1,
                  order: undefined
                };
                var newField;

                if (newState.col >= 0 && newState.row >= 0) {
                  newField = this.getHeaderField(newState.col, newState.row);
                } // bind header value


                if (oldField != null && oldField !== newField) {
                  this.setHeaderValue(oldState.col, oldState.row, undefined);
                }

                if (newField != null) {
                  this.setHeaderValue(newState.col, newState.row, newState.order);
                }
              }
              /**
               * Get the header values.
               */

            }, {
              key: "headerValues",
              get: function get() {
                return this[_].headerValues || (this[_].headerValues = new Map());
              }
              /**
               * Sets the header values.
               */
              ,
              set: function set(headerValues) {
                this[_].headerValues = headerValues || new Map();
              }
              /**
               * Get the field of the given column index.
               * @param  {number} col The column index.
               * @param  {number} row The row index.
               * @return {*} The field object.
               */

            }, {
              key: "getField",
              value: function getField(col, row) {
                return this[_].layoutMap.getBody(col, row !== null && row !== void 0 ? row : this[_].layoutMap.headerRowCount).field;
              }
              /**
               * Get the column define of the given column index.
               * @param  {number} col The column index.
               * @param  {number} row The row index.
               * @return {*} The column define object.
               */

            }, {
              key: "getColumnDefine",
              value: function getColumnDefine(col, row) {
                return this[_].layoutMap.getBody(col, row !== null && row !== void 0 ? row : this[_].layoutMap.headerRowCount).define;
              }
            }, {
              key: "getColumnType",
              value: function getColumnType(col, row) {
                return this[_].layoutMap.getBody(col, row).columnType;
              }
            }, {
              key: "getColumnAction",
              value: function getColumnAction(col, row) {
                return this[_].layoutMap.getBody(col, row).action;
              }
              /**
               * Get the header field of the given header cell.
               * @param  {number} col The column index.
               * @param  {number} row The header row index.
               * @return {*} The field object.
               */
              // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "getHeaderField",
              value: function getHeaderField(col, row) {
                var hd = this[_].layoutMap.getHeader(col, row);

                return hd.field;
              }
              /**
               * Get the header define of the given header cell.
               * @param  {number} col The column index.
               * @param  {number} row The header row index.
               * @return {*} The header define object.
               */

            }, {
              key: "getHeaderDefine",
              value: function getHeaderDefine(col, row) {
                var hd = this[_].layoutMap.getHeader(col, row);

                return hd.define;
              }
              /**
               * Get the record of the given row index.
               * @param  {number} row The row index.
               * @return {object} The record.
               */

            }, {
              key: "getRowRecord",
              value: function getRowRecord(row) {
                if (row < this[_].layoutMap.headerRowCount) {
                  // eslint-disable-next-line @typescript-eslint/no-explicit-any
                  return undefined;
                } else {
                  return this[_].dataSource.get(_getRecordIndexByRow(this, row));
                }
              }
              /**
               * Get the record index of the given row index.
               * @param  {number} row The row index.
               */

            }, {
              key: "getRecordIndexByRow",
              value: function getRecordIndexByRow(row) {
                return _getRecordIndexByRow(this, row);
              }
              /**
               * Gets the row index starting at the given record index.
               * @param  {number} index The record index.
               */

            }, {
              key: "getRecordStartRowByRecordIndex",
              value: function getRecordStartRowByRecordIndex(index) {
                return this[_].layoutMap.getRecordStartRowByRecordIndex(index);
              }
              /**
               * Get the column index of the given field.
               * @param  {*} field The field.
               * @return {number} The column index.
               * @deprecated use `getCellRangeByField` instead
               */

            }, {
              key: "getColumnIndexByField",
              value: function getColumnIndexByField(field) {
                var _b;

                var range = this.getCellRangeByField(field, 0);
                return (_b = range === null || range === void 0 ? void 0 : range.start.col) !== null && _b !== void 0 ? _b : null;
              }
              /**
               * Get the column index of the given field.
               * @param  {*} field The field.
               * @param  {number} index The record index
               * @return {number} The column index.
               */

            }, {
              key: "getCellRangeByField",
              value: function getCellRangeByField(field, index) {
                var layoutMap = this[_].layoutMap;
                var colObj = layoutMap.columnObjects.find(function (col) {
                  return col.field === field;
                });

                if (colObj) {
                  var layoutRange = layoutMap.getBodyLayoutRangeById(colObj.id);
                  var startRow = layoutMap.getRecordStartRowByRecordIndex(index);
                  return {
                    start: {
                      col: layoutRange.start.col,
                      row: startRow + layoutRange.start.row
                    },
                    end: {
                      col: layoutRange.end.col,
                      row: startRow + layoutRange.end.row
                    }
                  };
                }

                return null;
              }
              /**
               * Focus the cell.
               * @param  {*} field The field.
               * @param  {number} index The record index
               * @return {void}
               */

            }, {
              key: "focusGridCell",
              value: function focusGridCell(field, index) {
                var _b;

                var _this$selection$range = this.selection.range,
                    _this$selection$range2 = _this$selection$range.start,
                    startCol = _this$selection$range2.col,
                    startRow = _this$selection$range2.row,
                    _this$selection$range3 = _this$selection$range.end,
                    endCol = _this$selection$range3.col,
                    endRow = _this$selection$range3.row;
                var newFocus = (_b = this.getCellRangeByField(field, index)) === null || _b === void 0 ? void 0 : _b.start;

                if (newFocus == null) {
                  return;
                }

                this.focusCell(newFocus.col, newFocus.row);
                this.selection.select = newFocus;
                this.invalidateGridRect(startCol, startRow, endCol, endRow);
                this.invalidateCell(newFocus.col, newFocus.row);
              }
              /**
               * Scroll to where cell is visible.
               * @param  {*} field The field.
               * @param  {number} index The record index
               * @return {void}
               */

            }, {
              key: "makeVisibleGridCell",
              value: function makeVisibleGridCell(field, index) {
                var _b, _c, _d;

                var cell = (_b = this.getCellRangeByField(field, index)) === null || _b === void 0 ? void 0 : _b.start;
                this.makeVisibleCell((_c = cell === null || cell === void 0 ? void 0 : cell.col) !== null && _c !== void 0 ? _c : 0, (_d = cell === null || cell === void 0 ? void 0 : cell.row) !== null && _d !== void 0 ? _d : this[_].layoutMap.headerRowCount);
              }
            }, {
              key: "getGridCanvasHelper",
              value: function getGridCanvasHelper() {
                return this[_].gridCanvasHelper;
              }
              /**
               * Get cell range information for a given cell.
               * @param {number} col column index of the cell
               * @param {number} row row index of the cell
               * @returns {object} cell range info
               */

            }, {
              key: "getCellRange",
              value: function getCellRange(col, row) {
                return _getCellRange(this, col, row);
              }
              /**
               * Get header range information for a given cell.
               * @param {number} col column index of the cell
               * @param {number} row row index of the cell
               * @returns {object} cell range info
               * @deprecated use `getCellRange` instead
               */

            }, {
              key: "getHeaderCellRange",
              value: function getHeaderCellRange(col, row) {
                return this.getCellRange(col, row);
              }
            }, {
              key: "getCopyCellValue",
              value: function getCopyCellValue(col, row, range) {
                var cellRange = _getCellRange(this, col, row);

                var startCol = range ? Math.max(range.start.col, cellRange.start.col) : cellRange.start.col;
                var startRow = range ? Math.max(range.start.row, cellRange.start.row) : cellRange.start.row;

                if (startCol !== col || startRow !== row) {
                  return "";
                }

                var value = _getCellValue(this, col, row);

                if (row < this[_].layoutMap.headerRowCount) {
                  var headerData = this[_].layoutMap.getHeader(col, row);

                  return headerData.headerType.getCopyCellValue(value, this, {
                    col: col,
                    row: row
                  });
                }

                var columnData = this[_].layoutMap.getBody(col, row);

                return columnData.columnType.getCopyCellValue(value, this, {
                  col: col,
                  row: row
                });
              }
            }, {
              key: "onDrawCell",
              value: function onDrawCell(col, row, context) {
                var layoutMap = this[_].layoutMap;
                var draw;
                var style;

                if (row < layoutMap.headerRowCount) {
                  var hd = layoutMap.getHeader(col, row);
                  draw = hd.headerType.onDrawCell;
                  style = hd.style;

                  _updateRect(this, col, row, context);
                } else {
                  var column = layoutMap.getBody(col, row);
                  draw = column.columnType.onDrawCell;
                  style = column.style;

                  _updateRect(this, col, row, context);
                }

                var cellValue = _getCellValue(this, col, row);

                if (this.rowCount <= row) {
                  // Depending on the FilterDataSource, the rowCount may be reduced.
                  return undefined;
                }

                return _onDrawValue(this, cellValue, context, {
                  col: col,
                  row: row
                }, style, draw);
              }
            }, {
              key: "doGetCellValue",
              value: function doGetCellValue(col, row, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              valueCallback) {
                if (row < this[_].layoutMap.headerRowCount) {
                  // nop
                  return false;
                } else {
                  var value = _getCellValue(this, col, row);

                  if ((0, utils_1.isPromise)(value)) {
                    //遅延中は無視
                    return false;
                  }

                  valueCallback(value);
                }

                return true;
              }
            }, {
              key: "doChangeValue",
              value: function doChangeValue(col, row, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              changeValueCallback) {
                var _this12 = this;

                if (row < this[_].layoutMap.headerRowCount) {
                  // nop
                  return false;
                } else {
                  var record = this.getRowRecord(row);

                  if ((0, utils_1.isPromise)(record)) {
                    //遅延中は無視
                    return false;
                  }

                  var before = _getCellValue(this, col, row);

                  if ((0, utils_1.isPromise)(before)) {
                    //遅延中は無視
                    return false;
                  }

                  var after = changeValueCallback(before);

                  if (after === undefined) {
                    return false;
                  }

                  var _this$_$layoutMap$get = this[_].layoutMap.getBody(col, row),
                      field = _this$_$layoutMap$get.field;

                  this.fireListeners(LG_EVENT_TYPE_1.LG_EVENT_TYPE.BEFORE_CHANGE_VALUE, {
                    col: col,
                    row: row,
                    record: record,
                    field: field,
                    value: after,
                    oldValue: before
                  });
                  return (0, utils_1.then)(_setCellValue(this, col, row, after), function (ret) {
                    if (ret) {
                      var _this12$_$layoutMap$g = _this12[_].layoutMap.getBody(col, row),
                          _field2 = _this12$_$layoutMap$g.field;

                      _this12.fireListeners(LG_EVENT_TYPE_1.LG_EVENT_TYPE.CHANGED_VALUE, {
                        col: col,
                        row: row,
                        record: record,
                        field: _field2,
                        value: after,
                        oldValue: before
                      });
                    }

                    return ret;
                  });
                }
              }
            }, {
              key: "doSetPasteValue",
              value: function doSetPasteValue(text, test) {
                _onRangePaste.call(this, text, test);
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "getHeaderValue",
              value: function getHeaderValue(col, row) {
                var field = this.getHeaderField(col, row);
                return this.headerValues.get(field);
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "setHeaderValue",
              value: function setHeaderValue(col, row, newValue) {
                var field = this.getHeaderField(col, row);
                var oldValue = this.headerValues.get(field);
                this.headerValues.set(field, newValue);
                this.fireListeners(LG_EVENT_TYPE_1.LG_EVENT_TYPE.CHANGED_HEADER_VALUE, {
                  col: col,
                  row: row,
                  field: field,
                  value: newValue,
                  oldValue: oldValue
                });
              }
            }, {
              key: "getLayoutCellId",
              value: function getLayoutCellId(col, row) {
                return this[_].layoutMap.getCellId(col, row);
              }
            }, {
              key: "bindEventsInternal",
              value: function bindEventsInternal() {
                var _this13 = this;

                var grid = this;
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.SELECTED_CELL, function (e) {
                  var range = _getCellRange(_this13, e.col, e.row);

                  var _range$start = range.start,
                      startCol = _range$start.col,
                      startRow = _range$start.row,
                      _range$end = range.end,
                      endCol = _range$end.col,
                      endRow = _range$end.row;

                  if (startCol !== endCol || startRow !== endRow) {
                    _this13.invalidateCellRange(range);
                  }
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.PASTE_CELL, function (e) {
                  if (!_this13[_].allowRangePaste) {
                    return;
                  }

                  var _this13$selection$ran = _this13.selection.range,
                      start = _this13$selection$ran.start,
                      end = _this13$selection$ran.end;

                  if (!e.multi && (0, utils_1.cellEquals)(start, end)) {
                    return;
                  }

                  var layoutMap = _this13[_].layoutMap;

                  if (start.row < layoutMap.headerRowCount) {
                    return;
                  }

                  utils_1.event.cancel(e.event);

                  _onRangePaste.call(_this13, e.normalizeValue);
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.DELETE_CELL, function (e) {
                  var start = _this13.selection.range.start;
                  var layoutMap = _this13[_].layoutMap;

                  if (start.row < layoutMap.headerRowCount) {
                    return;
                  }

                  utils_1.event.cancel(e.event);

                  _onRangeDelete.call(_this13);
                });
              }
            }, {
              key: "getMoveLeftColByKeyDownInternal",
              value: function getMoveLeftColByKeyDownInternal(_ref18) {
                var col = _ref18.col,
                    row = _ref18.row;

                var _getCellRange3 = _getCellRange(this, col, row),
                    startCol = _getCellRange3.start.col;

                col = startCol;
                return _get(_getPrototypeOf(ListGrid.prototype), "getMoveLeftColByKeyDownInternal", this).call(this, {
                  col: col,
                  row: row
                });
              }
            }, {
              key: "getMoveRightColByKeyDownInternal",
              value: function getMoveRightColByKeyDownInternal(_ref19) {
                var col = _ref19.col,
                    row = _ref19.row;

                var _getCellRange4 = _getCellRange(this, col, row),
                    endCol = _getCellRange4.end.col;

                col = endCol;
                return _get(_getPrototypeOf(ListGrid.prototype), "getMoveRightColByKeyDownInternal", this).call(this, {
                  col: col,
                  row: row
                });
              }
            }, {
              key: "getMoveUpRowByKeyDownInternal",
              value: function getMoveUpRowByKeyDownInternal(_ref20) {
                var col = _ref20.col,
                    row = _ref20.row;

                var _getCellRange5 = _getCellRange(this, col, row),
                    startRow = _getCellRange5.start.row;

                row = startRow;
                return _get(_getPrototypeOf(ListGrid.prototype), "getMoveUpRowByKeyDownInternal", this).call(this, {
                  col: col,
                  row: row
                });
              }
            }, {
              key: "getMoveDownRowByKeyDownInternal",
              value: function getMoveDownRowByKeyDownInternal(_ref21) {
                var col = _ref21.col,
                    row = _ref21.row;

                var _getCellRange6 = _getCellRange(this, col, row),
                    endRow = _getCellRange6.end.row;

                row = endRow;
                return _get(_getPrototypeOf(ListGrid.prototype), "getMoveDownRowByKeyDownInternal", this).call(this, {
                  col: col,
                  row: row
                });
              }
            }, {
              key: "getOffsetInvalidateCells",
              value: function getOffsetInvalidateCells() {
                return 1;
              }
            }, {
              key: "getCopyRangeInternal",
              value: function getCopyRangeInternal(range) {
                var _this$getCellRange5 = this.getCellRange(range.start.col, range.start.row),
                    start = _this$getCellRange5.start;

                var _this$getCellRange6 = this.getCellRange(range.end.col, range.end.row),
                    end = _this$getCellRange6.end;

                return {
                  start: start,
                  end: end
                };
              }
            }, {
              key: "fireListeners",
              value: function fireListeners(type) {
                var _get2;

                for (var _len3 = arguments.length, event = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
                  event[_key3 - 1] = arguments[_key3];
                }

                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                return (_get2 = _get(_getPrototypeOf(ListGrid.prototype), "fireListeners", this)).call.apply(_get2, [this, type].concat(event));
              }
            }], [{
              key: "EVENT_TYPE",
              get: function get() {
                return LG_EVENT_TYPE_1.LG_EVENT_TYPE;
              }
            }]);

            return ListGrid;
          }(DrawGrid_1.DrawGrid);

          exports.ListGrid = ListGrid;
          _a = _;
          /***/
        },

        /***/
        "./columns.js":
        /*!********************!*\
          !*** ./columns.js ***!
          \********************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsJs(module, exports, __nested_webpack_require_189310__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.style = exports.type = exports.action = void 0;

          var action = __importStar(__nested_webpack_require_189310__(
          /*! ./columns/action */
          "./columns/action.js"));

          exports.action = action;

          var style = __importStar(__nested_webpack_require_189310__(
          /*! ./columns/style */
          "./columns/style.js"));

          exports.style = style;

          var type = __importStar(__nested_webpack_require_189310__(
          /*! ./columns/type */
          "./columns/type.js"));

          exports.type = type;
          /***/
        },

        /***/
        "./columns/action.js":
        /*!***************************!*\
          !*** ./columns/action.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionJs(module, exports, __nested_webpack_require_191753__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.of = exports.InlineMenuEditor = exports.InlineInputEditor = exports.SmallDialogInputEditor = exports.ButtonAction = exports.RadioEditor = exports.CheckEditor = exports.Action = exports.Editor = exports.BaseAction = exports.ACTIONS = void 0;

          var Action_1 = __nested_webpack_require_191753__(
          /*! ./action/Action */
          "./columns/action/Action.js");

          Object.defineProperty(exports, "Action", {
            enumerable: true,
            get: function get() {
              return Action_1.Action;
            }
          });

          var BaseAction_1 = __nested_webpack_require_191753__(
          /*! ./action/BaseAction */
          "./columns/action/BaseAction.js");

          Object.defineProperty(exports, "BaseAction", {
            enumerable: true,
            get: function get() {
              return BaseAction_1.BaseAction;
            }
          });

          var ButtonAction_1 = __nested_webpack_require_191753__(
          /*! ./action/ButtonAction */
          "./columns/action/ButtonAction.js");

          Object.defineProperty(exports, "ButtonAction", {
            enumerable: true,
            get: function get() {
              return ButtonAction_1.ButtonAction;
            }
          });

          var CheckEditor_1 = __nested_webpack_require_191753__(
          /*! ./action/CheckEditor */
          "./columns/action/CheckEditor.js");

          Object.defineProperty(exports, "CheckEditor", {
            enumerable: true,
            get: function get() {
              return CheckEditor_1.CheckEditor;
            }
          });

          var Editor_1 = __nested_webpack_require_191753__(
          /*! ./action/Editor */
          "./columns/action/Editor.js");

          Object.defineProperty(exports, "Editor", {
            enumerable: true,
            get: function get() {
              return Editor_1.Editor;
            }
          });

          var InlineInputEditor_1 = __nested_webpack_require_191753__(
          /*! ./action/InlineInputEditor */
          "./columns/action/InlineInputEditor.js");

          Object.defineProperty(exports, "InlineInputEditor", {
            enumerable: true,
            get: function get() {
              return InlineInputEditor_1.InlineInputEditor;
            }
          });

          var InlineMenuEditor_1 = __nested_webpack_require_191753__(
          /*! ./action/InlineMenuEditor */
          "./columns/action/InlineMenuEditor.js");

          Object.defineProperty(exports, "InlineMenuEditor", {
            enumerable: true,
            get: function get() {
              return InlineMenuEditor_1.InlineMenuEditor;
            }
          });

          var RadioEditor_1 = __nested_webpack_require_191753__(
          /*! ./action/RadioEditor */
          "./columns/action/RadioEditor.js");

          Object.defineProperty(exports, "RadioEditor", {
            enumerable: true,
            get: function get() {
              return RadioEditor_1.RadioEditor;
            }
          });

          var SmallDialogInputEditor_1 = __nested_webpack_require_191753__(
          /*! ./action/SmallDialogInputEditor */
          "./columns/action/SmallDialogInputEditor.js");

          Object.defineProperty(exports, "SmallDialogInputEditor", {
            enumerable: true,
            get: function get() {
              return SmallDialogInputEditor_1.SmallDialogInputEditor;
            }
          }); // eslint-disable-next-line @typescript-eslint/no-explicit-any

          var ImmutableCheckEditor = /*#__PURE__*/function (_CheckEditor_1$CheckE) {
            _inherits(ImmutableCheckEditor, _CheckEditor_1$CheckE);

            var _super2 = _createSuper(ImmutableCheckEditor);

            function ImmutableCheckEditor() {
              _classCallCheck(this, ImmutableCheckEditor);

              return _super2.apply(this, arguments);
            }

            _createClass(ImmutableCheckEditor, [{
              key: "disabled",
              get: function get() {
                return this._disabled;
              }
            }, {
              key: "readOnly",
              get: function get() {
                return this._readOnly;
              }
            }]);

            return ImmutableCheckEditor;
          }(CheckEditor_1.CheckEditor); // eslint-disable-next-line @typescript-eslint/no-explicit-any


          var ImmutableRadioEditor = /*#__PURE__*/function (_RadioEditor_1$RadioE) {
            _inherits(ImmutableRadioEditor, _RadioEditor_1$RadioE);

            var _super3 = _createSuper(ImmutableRadioEditor);

            function ImmutableRadioEditor() {
              _classCallCheck(this, ImmutableRadioEditor);

              return _super3.apply(this, arguments);
            }

            _createClass(ImmutableRadioEditor, [{
              key: "disabled",
              get: function get() {
                return this._disabled;
              }
            }, {
              key: "readOnly",
              get: function get() {
                return this._readOnly;
              }
            }]);

            return ImmutableRadioEditor;
          }(RadioEditor_1.RadioEditor); // eslint-disable-next-line @typescript-eslint/no-explicit-any


          var ImmutableInputEditor = /*#__PURE__*/function (_SmallDialogInputEdit) {
            _inherits(ImmutableInputEditor, _SmallDialogInputEdit);

            var _super4 = _createSuper(ImmutableInputEditor);

            function ImmutableInputEditor() {
              _classCallCheck(this, ImmutableInputEditor);

              return _super4.apply(this, arguments);
            }

            _createClass(ImmutableInputEditor, [{
              key: "disabled",
              get: function get() {
                return this._disabled;
              }
            }, {
              key: "readOnly",
              get: function get() {
                return this._readOnly;
              }
            }]);

            return ImmutableInputEditor;
          }(SmallDialogInputEditor_1.SmallDialogInputEditor);

          exports.ACTIONS = {
            CHECK: new ImmutableCheckEditor(),
            INPUT: new ImmutableInputEditor(),
            RADIO: new ImmutableRadioEditor()
          };

          function of(columnAction) {
            if (!columnAction) {
              return undefined;
            } else if (typeof columnAction === "string") {
              var key = columnAction.toUpperCase();
              return exports.ACTIONS[key] || of(null);
            } else {
              return columnAction;
            }
          }

          exports.of = of;
          /***/
        },

        /***/
        "./columns/action/Action.js":
        /*!**********************************!*\
          !*** ./columns/action/Action.js ***!
          \**********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionActionJs(module, exports, __nested_webpack_require_198839__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Action = exports.AbstractAction = void 0;

          var actionBind_1 = __nested_webpack_require_198839__(
          /*! ./actionBind */
          "./columns/action/actionBind.js");

          var BaseAction_1 = __nested_webpack_require_198839__(
          /*! ./BaseAction */
          "./columns/action/BaseAction.js");

          var utils_1 = __nested_webpack_require_198839__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var action_utils_1 = __nested_webpack_require_198839__(
          /*! ./action-utils */
          "./columns/action/action-utils.js");

          var AbstractAction = /*#__PURE__*/function (_BaseAction_1$BaseAct) {
            _inherits(AbstractAction, _BaseAction_1$BaseAct);

            var _super5 = _createSuper(AbstractAction);

            function AbstractAction() {
              var _this14;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, AbstractAction);

              _this14 = _super5.call(this, option);

              _this14._action = option.action || function () {};

              return _this14;
            }

            _createClass(AbstractAction, [{
              key: "editable",
              get: function get() {
                return false;
              }
            }, {
              key: "action",
              get: function get() {
                return this._action;
              },
              set: function set(action) {
                this._action = action;
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(grid, cellId) {
                var _this15 = this;

                var state = this.getState(grid);

                var action = function action(cell) {
                  if ((0, action_utils_1.isDisabledRecord)(_this15.disabled, grid, cell.row)) {
                    return;
                  }

                  var record = grid.getRowRecord(cell.row);

                  _this15._action(record, (0, utils_1.extend)(cell, {
                    grid: grid
                  }));
                };

                return [].concat(_toConsumableArray((0, actionBind_1.bindCellClickAction)(grid, cellId, {
                  action: action,
                  mouseOver: function mouseOver(e) {
                    if ((0, action_utils_1.isDisabledRecord)(_this15.disabled, grid, e.row)) {
                      return false;
                    }

                    state.mouseActiveCell = {
                      col: e.col,
                      row: e.row
                    };
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                    return true;
                  },
                  mouseOut: function mouseOut(e) {
                    delete state.mouseActiveCell;
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                  },
                  area: function area(e) {
                    if (!_this15.area) {
                      return true;
                    }

                    var event = e.event;
                    var clientX = event.clientX || event.pageX + window.scrollX;
                    var clientY = event.clientY || event.pageY + window.scrollY;
                    var canvasRect = grid.canvas.getBoundingClientRect();
                    var xInCanvas = clientX - canvasRect.left;
                    var yInCanvas = clientY - canvasRect.top;
                    var rect = grid.getCellRect(e.col, e.row);
                    return _this15.area({
                      col: e.col,
                      row: e.row,
                      grid: grid,
                      pointInCell: {
                        x: xInCanvas - rect.left + grid.scrollLeft,
                        y: yInCanvas - rect.top + grid.scrollTop
                      },
                      pointInDrawingCanvas: {
                        x: xInCanvas,
                        y: yInCanvas
                      }
                    });
                  }
                })), _toConsumableArray((0, actionBind_1.bindCellKeyAction)(grid, cellId, {
                  action: action
                })));
              }
            }, {
              key: "onPasteCellRangeBox",
              value: function onPasteCellRangeBox() {// noop
              }
            }, {
              key: "onDeleteCellRangeBox",
              value: function onDeleteCellRangeBox() {// noop
              }
            }]);

            return AbstractAction;
          }(BaseAction_1.BaseAction);

          exports.AbstractAction = AbstractAction;

          var Action = /*#__PURE__*/function (_AbstractAction) {
            _inherits(Action, _AbstractAction);

            var _super6 = _createSuper(Action);

            function Action() {
              var _this16;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, Action);

              _this16 = _super6.call(this, option);
              _this16._area = option.area;
              return _this16;
            }

            _createClass(Action, [{
              key: "area",
              get: function get() {
                return this._area;
              },
              set: function set(area) {
                this._area = area;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new Action(this);
              }
            }, {
              key: "getState",
              value: function getState(_grid) {
                return {};
              }
            }]);

            return Action;
          }(AbstractAction);

          exports.Action = Action;
          /***/
        },

        /***/
        "./columns/action/BaseAction.js":
        /*!**************************************!*\
          !*** ./columns/action/BaseAction.js ***!
          \**************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionBaseActionJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseAction = void 0;

          var BaseAction = /*#__PURE__*/function () {
            function BaseAction() {
              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, BaseAction);

              this._disabled = option.disabled || false;
            }

            _createClass(BaseAction, [{
              key: "disabled",
              get: function get() {
                return this._disabled;
              },
              set: function set(disabled) {
                this._disabled = disabled;
                this.onChangeDisabledInternal();
              }
            }, {
              key: "onChangeDisabledInternal",
              value: function onChangeDisabledInternal() {// abstract
              }
            }]);

            return BaseAction;
          }();

          exports.BaseAction = BaseAction;
          /***/
        },

        /***/
        "./columns/action/BaseInputEditor.js":
        /*!*******************************************!*\
          !*** ./columns/action/BaseInputEditor.js ***!
          \*******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionBaseInputEditorJs(module, exports, __nested_webpack_require_206837__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseInputEditor = void 0;

          var utils_1 = __nested_webpack_require_206837__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var action_utils_1 = __nested_webpack_require_206837__(
          /*! ./action-utils */
          "./columns/action/action-utils.js");

          var DG_EVENT_TYPE_1 = __nested_webpack_require_206837__(
          /*! ../../core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var Editor_1 = __nested_webpack_require_206837__(
          /*! ./Editor */
          "./columns/action/Editor.js");

          var KEY_ENTER = 13;
          var KEY_F2 = 113;

          var BaseInputEditor = /*#__PURE__*/function (_Editor_1$Editor) {
            _inherits(BaseInputEditor, _Editor_1$Editor);

            var _super7 = _createSuper(BaseInputEditor);

            function BaseInputEditor() {
              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, BaseInputEditor);

              return _super7.call(this, option);
            }

            _createClass(BaseInputEditor, [{
              key: "bindGridEvent",
              value: function bindGridEvent(grid, cellId) {
                var _this17 = this;

                var open = function open(cell) {
                  if ((0, action_utils_1.isReadOnlyRecord)(_this17.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(_this17.disabled, grid, cell.row)) {
                    return false;
                  }

                  _this17.onOpenCellInternal(grid, cell);

                  return true;
                };

                var input = function input(cell, value) {
                  if ((0, action_utils_1.isReadOnlyRecord)(_this17.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(_this17.disabled, grid, cell.row)) {
                    return;
                  }

                  _this17.onInputCellInternal(grid, cell, value);
                };

                function isTarget(col, row) {
                  return grid.getLayoutCellId(col, row) === cellId;
                }

                return [grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.INPUT_CELL, function (e) {
                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  input({
                    col: e.col,
                    row: e.row
                  }, e.value);
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.PASTE_CELL, function (e) {
                  if (e.multi) {
                    // ignore multi cell values
                    return;
                  }

                  var selectionRange = grid.selection.range;

                  if (!(0, utils_1.cellEquals)(selectionRange.start, selectionRange.end)) {
                    // ignore multi paste values
                    return;
                  }

                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  utils_1.event.cancel(e.event);
                  input({
                    col: e.col,
                    row: e.row
                  }, e.normalizeValue);
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.DBLCLICK_CELL, function (cell) {
                  if (!isTarget(cell.col, cell.row)) {
                    return;
                  }

                  open({
                    col: cell.col,
                    row: cell.row
                  });
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.DBLTAP_CELL, function (e) {
                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  open({
                    col: e.col,
                    row: e.row
                  });
                  utils_1.event.cancel(e.event);
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.KEYDOWN, function (e) {
                  if (e.keyCode !== KEY_F2 && e.keyCode !== KEY_ENTER) {
                    return;
                  }

                  var sel = grid.selection.select;

                  if (!isTarget(sel.col, sel.row)) {
                    return;
                  }

                  if (open({
                    col: sel.col,
                    row: sel.row
                  })) {
                    e.stopCellMoving();
                  }
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SELECTED_CELL, function (e) {
                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  _this17.onChangeSelectCellInternal(grid, {
                    col: e.col,
                    row: e.row
                  }, e.selected);
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SCROLL, function () {
                  _this17.onGridScrollInternal(grid);
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.EDITABLEINPUT_CELL, function (cell) {
                  if (!isTarget(cell.col, cell.row)) {
                    return false;
                  }

                  if ((0, action_utils_1.isReadOnlyRecord)(_this17.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(_this17.disabled, grid, cell.row)) {
                    return false;
                  }

                  return true;
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MODIFY_STATUS_EDITABLEINPUT_CELL, function (cell) {
                  if (!isTarget(cell.col, cell.row)) {
                    return;
                  }

                  if ((0, action_utils_1.isReadOnlyRecord)(_this17.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(_this17.disabled, grid, cell.row)) {
                    return;
                  }

                  var range = grid.getCellRange(cell.col, cell.row);

                  if (range.start.col !== range.end.col || range.start.row !== range.end.row) {
                    var _input = cell.input;
                    var baseRect = grid.getCellRect(cell.col, cell.row);
                    var rangeRect = grid.getCellRangeRect(range);
                    _input.style.top = "".concat((parseFloat(_input.style.top) + (rangeRect.top - baseRect.top)).toFixed(), "px");
                    _input.style.left = "".concat((parseFloat(_input.style.left) + (rangeRect.left - baseRect.left)).toFixed(), "px");
                    _input.style.width = "".concat(rangeRect.width.toFixed(), "px");
                    _input.style.height = "".concat(rangeRect.height.toFixed(), "px");
                  }

                  _this17.onSetInputAttrsInternal(grid, {
                    col: cell.col,
                    row: cell.row
                  }, cell.input);
                })];
              }
            }, {
              key: "onPasteCellRangeBox",
              value: function onPasteCellRangeBox(grid, cell, value) {
                var _this18 = this;

                if ((0, action_utils_1.isReadOnlyRecord)(this.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(this.disabled, grid, cell.row)) {
                  return;
                }

                grid.doChangeValue(cell.col, cell.row, function () {
                  if (_this18.isSupportMultilineValue()) {
                    return value;
                  }

                  return value.replace(/\r?\n/g, " ");
                });
              }
            }, {
              key: "onDeleteCellRangeBox",
              value: function onDeleteCellRangeBox(grid, cell) {
                if ((0, action_utils_1.isReadOnlyRecord)(this.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(this.disabled, grid, cell.row)) {
                  return;
                }

                grid.doChangeValue(cell.col, cell.row, function () {
                  return "";
                });
              }
            }, {
              key: "isSupportMultilineValue",
              value: function isSupportMultilineValue() {
                return false;
              }
            }]);

            return BaseInputEditor;
          }(Editor_1.Editor);

          exports.BaseInputEditor = BaseInputEditor;
          /***/
        },

        /***/
        "./columns/action/ButtonAction.js":
        /*!****************************************!*\
          !*** ./columns/action/ButtonAction.js ***!
          \****************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionButtonActionJs(module, exports, __nested_webpack_require_215613__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ButtonAction = void 0;

          var Action_1 = __nested_webpack_require_215613__(
          /*! ./Action */
          "./columns/action/Action.js");

          var symbolManager_1 = __nested_webpack_require_215613__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_215613__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var BUTTON_COLUMN_STATE_ID = (0, symbolManager_1.getButtonColumnStateId)();

          var ButtonAction = /*#__PURE__*/function (_Action_1$AbstractAct) {
            _inherits(ButtonAction, _Action_1$AbstractAct);

            var _super8 = _createSuper(ButtonAction);

            function ButtonAction() {
              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, ButtonAction);

              return _super8.call(this, option);
            }

            _createClass(ButtonAction, [{
              key: "area",
              get: function get() {
                return undefined;
              },
              set: function set(_area) {// noop
              }
            }, {
              key: "clone",
              value: function clone() {
                return new ButtonAction(this);
              }
            }, {
              key: "getState",
              value: function getState(grid) {
                var state = grid[BUTTON_COLUMN_STATE_ID];

                if (!state) {
                  state = {};
                  utils_1.obj.setReadonly(grid, BUTTON_COLUMN_STATE_ID, state);
                }

                return state;
              }
            }]);

            return ButtonAction;
          }(Action_1.AbstractAction);

          exports.ButtonAction = ButtonAction;
          /***/
        },

        /***/
        "./columns/action/CheckEditor.js":
        /*!***************************************!*\
          !*** ./columns/action/CheckEditor.js ***!
          \***************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionCheckEditorJs(module, exports, __nested_webpack_require_218009__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.CheckEditor = void 0;

          var actionBind_1 = __nested_webpack_require_218009__(
          /*! ./actionBind */
          "./columns/action/actionBind.js");

          var utils_1 = __nested_webpack_require_218009__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var action_utils_1 = __nested_webpack_require_218009__(
          /*! ./action-utils */
          "./columns/action/action-utils.js");

          var DG_EVENT_TYPE_1 = __nested_webpack_require_218009__(
          /*! ../../core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var Editor_1 = __nested_webpack_require_218009__(
          /*! ./Editor */
          "./columns/action/Editor.js");

          var animate_1 = __nested_webpack_require_218009__(
          /*! ../../internal/animate */
          "./internal/animate.js");

          var symbolManager_1 = __nested_webpack_require_218009__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var CHECK_COLUMN_STATE_ID = (0, symbolManager_1.getCheckColumnStateId)();

          var CheckEditor = /*#__PURE__*/function (_Editor_1$Editor2) {
            _inherits(CheckEditor, _Editor_1$Editor2);

            var _super9 = _createSuper(CheckEditor);

            function CheckEditor() {
              _classCallCheck(this, CheckEditor);

              return _super9.apply(this, arguments);
            }

            _createClass(CheckEditor, [{
              key: "clone",
              value: function clone() {
                return new CheckEditor(this);
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(grid, cellId) {
                var _this19 = this;

                var _state = grid[CHECK_COLUMN_STATE_ID];

                if (!_state) {
                  _state = {
                    block: {},
                    elapsed: {}
                  };
                  utils_1.obj.setReadonly(grid, CHECK_COLUMN_STATE_ID, _state);
                }

                var state = _state;

                var _action = function action(cell) {
                  var range = grid.getCellRange(cell.col, cell.row);
                  var cellKey = "".concat(range.start.col, ":").concat(range.start.row);

                  if ((0, action_utils_1.isReadOnlyRecord)(_this19.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(_this19.disabled, grid, cell.row) || state.block[cellKey]) {
                    return;
                  }

                  var ret = grid.doChangeValue(cell.col, cell.row, action_utils_1.toggleValue);

                  if (ret) {
                    var onChange = function onChange() {
                      // checkbox animation
                      (0, animate_1.animate)(200, function (point) {
                        if (point === 1) {
                          delete state.elapsed[cellKey];
                        } else {
                          state.elapsed[cellKey] = point;
                        }

                        grid.invalidateCellRange(range);
                      });
                    };

                    if ((0, utils_1.isPromise)(ret)) {
                      state.block[cellKey] = true;
                      ret.then(function () {
                        delete state.block[cellKey];
                        onChange();
                      });
                    } else {
                      onChange();
                    }
                  }
                };

                function isTarget(col, row) {
                  return grid.getLayoutCellId(col, row) === cellId;
                }

                return [].concat(_toConsumableArray((0, actionBind_1.bindCellClickAction)(grid, cellId, {
                  action: _action,
                  mouseOver: function mouseOver(e) {
                    if ((0, action_utils_1.isDisabledRecord)(_this19.disabled, grid, e.row)) {
                      return false;
                    }

                    state.mouseActiveCell = {
                      col: e.col,
                      row: e.row
                    };
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                    return true;
                  },
                  mouseOut: function mouseOut(e) {
                    delete state.mouseActiveCell;
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                  }
                })), _toConsumableArray((0, actionBind_1.bindCellKeyAction)(grid, cellId, {
                  action: function action(_e) {
                    var selrange = grid.selection.range;
                    var col = grid.selection.select.col;

                    for (var row = selrange.start.row; row <= selrange.end.row; row++) {
                      if (!isTarget(col, row)) {
                        continue;
                      }

                      _action({
                        col: col,
                        row: row
                      });
                    }
                  }
                })), [// paste value
                grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.PASTE_CELL, function (e) {
                  if (e.multi) {
                    // ignore multi cell values
                    return;
                  }

                  var selectionRange = grid.selection.range;

                  if (!(0, utils_1.cellEquals)(selectionRange.start, selectionRange.end)) {
                    // ignore multi paste values
                    return;
                  }

                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  utils_1.event.cancel(e.event);
                  var pasteValue = e.normalizeValue.trim();
                  grid.doGetCellValue(e.col, e.row, function (value) {
                    var newValue = (0, action_utils_1.toggleValue)(value);

                    if ("".concat(newValue).trim() === pasteValue) {
                      _action({
                        col: e.col,
                        row: e.row
                      });
                    } else if (isRejectValue(value, pasteValue)) {
                      var record = grid.getRowRecord(e.row);

                      if (!(0, utils_1.isPromise)(record)) {
                        grid.fireListeners("rejected_paste_values", {
                          detail: [{
                            col: e.col,
                            row: e.row,
                            record: record,
                            define: grid.getColumnDefine(e.col, e.row),
                            pasteValue: pasteValue
                          }]
                        });
                      }
                    }
                  });
                })]);
              }
            }, {
              key: "onPasteCellRangeBox",
              value: function onPasteCellRangeBox(grid, cell, value, context) {
                if ((0, action_utils_1.isReadOnlyRecord)(this.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(this.disabled, grid, cell.row)) {
                  return;
                }

                var pasteValue = value.trim();
                grid.doGetCellValue(cell.col, cell.row, function (value) {
                  var newValue = (0, action_utils_1.toggleValue)(value);

                  if ("".concat(newValue).trim() === pasteValue) {
                    grid.doChangeValue(cell.col, cell.row, action_utils_1.toggleValue);
                  } else if (isRejectValue(value, pasteValue)) {
                    context.reject();
                  }
                });
              }
            }, {
              key: "onDeleteCellRangeBox",
              value: function onDeleteCellRangeBox() {// noop
              }
            }]);

            return CheckEditor;
          }(Editor_1.Editor);

          exports.CheckEditor = CheckEditor;

          function isRejectValue(oldValue, pasteValue) {
            if ((oldValue != null ? "".concat(oldValue).trim() : "") === pasteValue) {
              return false;
            }

            var newValue = (0, action_utils_1.toggleValue)(oldValue);
            return "".concat(newValue).trim() !== pasteValue && "".concat((0, action_utils_1.toggleValue)(newValue)).trim() !== pasteValue;
          }
          /***/

        },

        /***/
        "./columns/action/Editor.js":
        /*!**********************************!*\
          !*** ./columns/action/Editor.js ***!
          \**********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionEditorJs(module, exports, __nested_webpack_require_226989__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Editor = void 0;

          var BaseAction_1 = __nested_webpack_require_226989__(
          /*! ./BaseAction */
          "./columns/action/BaseAction.js");

          var Editor = /*#__PURE__*/function (_BaseAction_1$BaseAct2) {
            _inherits(Editor, _BaseAction_1$BaseAct2);

            var _super10 = _createSuper(Editor);

            function Editor() {
              var _this20;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, Editor);

              _this20 = _super10.call(this, option);
              _this20._readOnly = option.readOnly || false;
              return _this20;
            }

            _createClass(Editor, [{
              key: "editable",
              get: function get() {
                return true;
              }
            }, {
              key: "readOnly",
              get: function get() {
                return this._readOnly;
              },
              set: function set(readOnly) {
                this._readOnly = readOnly;
                this.onChangeReadOnlyInternal();
              }
            }, {
              key: "onChangeReadOnlyInternal",
              value: function onChangeReadOnlyInternal() {// abstruct
              }
            }]);

            return Editor;
          }(BaseAction_1.BaseAction);

          exports.Editor = Editor;
          /***/
        },

        /***/
        "./columns/action/InlineInputEditor.js":
        /*!*********************************************!*\
          !*** ./columns/action/InlineInputEditor.js ***!
          \*********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionInlineInputEditorJs(module, exports, __nested_webpack_require_229014__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineInputEditor = void 0;

          var BaseInputEditor_1 = __nested_webpack_require_229014__(
          /*! ./BaseInputEditor */
          "./columns/action/BaseInputEditor.js");

          var InlineInputElement_1 = __nested_webpack_require_229014__(
          /*! ./internal/InlineInputElement */
          "./columns/action/internal/InlineInputElement.js");

          var symbolManager_1 = __nested_webpack_require_229014__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_229014__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var _ = (0, symbolManager_1.getInlineInputEditorStateId)();

          function getState(grid) {
            var state = grid[_];

            if (!state) {
              state = {};
              utils_1.obj.setReadonly(grid, _, state);
            }

            return state;
          } // eslint-disable-next-line @typescript-eslint/no-explicit-any


          var globalElement = null;
          var bindGridCount = 0;

          function attachInput(grid, cell, editor, value) {
            var state = getState(grid);

            if (!globalElement) {
              globalElement = new InlineInputElement_1.InlineInputElement();
            }

            if (!state.element) {
              state.element = globalElement;
              bindGridCount++;
              grid.addDisposable({
                dispose: function dispose() {
                  bindGridCount--;

                  if (!bindGridCount) {
                    globalElement === null || globalElement === void 0 ? void 0 : globalElement.dispose();
                    globalElement = null;
                    state.element = null;
                  }
                }
              });
            }

            globalElement.attach(grid, editor, cell.col, cell.row, value);
          }

          function detachInput(gridFocus) {
            if (globalElement) {
              globalElement.detach(gridFocus);
            }
          }

          function doChangeValue(_grid) {
            if (globalElement) {
              globalElement.doChangeValue();
            }
          }

          var InlineInputEditor = /*#__PURE__*/function (_BaseInputEditor_1$Ba) {
            _inherits(InlineInputEditor, _BaseInputEditor_1$Ba);

            var _super11 = _createSuper(InlineInputEditor);

            function InlineInputEditor() {
              var _this21;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, InlineInputEditor);

              _this21 = _super11.call(this, option);
              _this21._classList = option.classList;
              _this21._type = option.type;
              return _this21;
            }

            _createClass(InlineInputEditor, [{
              key: "classList",
              get: function get() {
                if (!this._classList) {
                  return undefined;
                }

                return Array.isArray(this._classList) ? this._classList : [this._classList];
              },
              set: function set(classList) {
                this._classList = classList;
              }
            }, {
              key: "type",
              get: function get() {
                return this._type;
              },
              set: function set(type) {
                this._type = type;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new InlineInputEditor(this);
              }
            }, {
              key: "onInputCellInternal",
              value: function onInputCellInternal(grid, cell, inputValue) {
                attachInput(grid, cell, this, inputValue);
              }
            }, {
              key: "onOpenCellInternal",
              value: function onOpenCellInternal(grid, cell) {
                var _this22 = this;

                grid.doGetCellValue(cell.col, cell.row, function (value) {
                  attachInput(grid, cell, _this22, value);
                });
              }
            }, {
              key: "onChangeSelectCellInternal",
              value: function onChangeSelectCellInternal(grid, _cell, _selected) {
                doChangeValue(grid);
                detachInput();
              }
            }, {
              key: "onGridScrollInternal",
              value: function onGridScrollInternal(grid) {
                doChangeValue(grid);
                detachInput(true);
              }
            }, {
              key: "onChangeDisabledInternal",
              value: function onChangeDisabledInternal() {
                // cancel input
                detachInput(true);
              }
            }, {
              key: "onChangeReadOnlyInternal",
              value: function onChangeReadOnlyInternal() {
                // cancel input
                detachInput(true);
              }
            }, {
              key: "onSetInputAttrsInternal",
              value: function onSetInputAttrsInternal(grid, _cell, input) {
                InlineInputElement_1.InlineInputElement.setInputAttrs(this, grid, input);
              }
            }]);

            return InlineInputEditor;
          }(BaseInputEditor_1.BaseInputEditor);

          exports.InlineInputEditor = InlineInputEditor;
          /***/
        },

        /***/
        "./columns/action/InlineMenuEditor.js":
        /*!********************************************!*\
          !*** ./columns/action/InlineMenuEditor.js ***!
          \********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionInlineMenuEditorJs(module, exports, __nested_webpack_require_235045__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineMenuEditor = void 0;

          var utils_1 = __nested_webpack_require_235045__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var action_utils_1 = __nested_webpack_require_235045__(
          /*! ./action-utils */
          "./columns/action/action-utils.js");

          var DG_EVENT_TYPE_1 = __nested_webpack_require_235045__(
          /*! ../../core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var Editor_1 = __nested_webpack_require_235045__(
          /*! ./Editor */
          "./columns/action/Editor.js");

          var InlineMenuElement_1 = __nested_webpack_require_235045__(
          /*! ./internal/InlineMenuElement */
          "./columns/action/internal/InlineMenuElement.js");

          var type_1 = __nested_webpack_require_235045__(
          /*! ../type */
          "./columns/type.js");

          var symbolManager_1 = __nested_webpack_require_235045__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var menu_items_1 = __nested_webpack_require_235045__(
          /*! ../../internal/menu-items */
          "./internal/menu-items.js");

          var _ = (0, symbolManager_1.getInlineMenuEditorStateId)();

          function getState(grid) {
            var state = grid[_];

            if (!state) {
              state = {};
              utils_1.obj.setReadonly(grid, _, state);
            }

            return state;
          } // eslint-disable-next-line @typescript-eslint/no-explicit-any


          var globalElement = null;
          var bindGridCount = 0;

          function attachMenu(grid, cell, editor, value, record) {
            var state = getState(grid);

            if (!globalElement) {
              globalElement = new InlineMenuElement_1.InlineMenuElement();
            }

            if (!state.element) {
              state.element = globalElement;
              bindGridCount++;
              grid.addDisposable({
                dispose: function dispose() {
                  bindGridCount--;

                  if (!bindGridCount) {
                    globalElement === null || globalElement === void 0 ? void 0 : globalElement.dispose();
                    globalElement = null;
                    state.element = null;
                  }
                }
              });
            }

            globalElement.attach(grid, editor, cell.col, cell.row, value, record);
          }

          function detachMenu(gridFocus) {
            if (globalElement) {
              globalElement.detach(gridFocus);
            }
          }

          var KEY_ENTER = 13;
          var KEY_F2 = 113;

          var InlineMenuEditor = /*#__PURE__*/function (_Editor_1$Editor3) {
            _inherits(InlineMenuEditor, _Editor_1$Editor3);

            var _super12 = _createSuper(InlineMenuEditor);

            function InlineMenuEditor() {
              var _this23;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, InlineMenuEditor);

              _this23 = _super12.call(this, option);
              _this23._classList = option.classList;
              _this23._options = (0, menu_items_1.normalizeToFn)(option.options);
              return _this23;
            }

            _createClass(InlineMenuEditor, [{
              key: "dispose",
              value: function dispose() {// noop
              }
            }, {
              key: "classList",
              get: function get() {
                if (!this._classList) {
                  return undefined;
                }

                return Array.isArray(this._classList) ? this._classList : [this._classList];
              },
              set: function set(classList) {
                this._classList = classList;
              }
            }, {
              key: "options",
              get: function get() {
                return this._options;
              },
              set: function set(options) {
                this._options = (0, menu_items_1.normalizeToFn)(options);
              }
            }, {
              key: "clone",
              value: function clone() {
                return new InlineMenuEditor(this);
              }
            }, {
              key: "onChangeDisabledInternal",
              value: function onChangeDisabledInternal() {
                // cancel input
                detachMenu(true);
              }
            }, {
              key: "onChangeReadOnlyInternal",
              value: function onChangeReadOnlyInternal() {
                // cancel input
                detachMenu(true);
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(grid, cellId) {
                var _this24 = this;

                var open = function open(cell) {
                  if ((0, action_utils_1.isReadOnlyRecord)(_this24.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(_this24.disabled, grid, cell.row)) {
                    return false;
                  }

                  grid.doGetCellValue(cell.col, cell.row, function (value) {
                    var record = grid.getRowRecord(cell.row);

                    if ((0, utils_1.isPromise)(record)) {
                      return;
                    }

                    attachMenu(grid, cell, _this24, value, record);
                  });
                  return true;
                };

                function isTarget(col, row) {
                  return grid.getLayoutCellId(col, row) === cellId;
                }

                return [grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.CLICK_CELL, function (cell) {
                  if (!isTarget(cell.col, cell.row)) {
                    return;
                  }

                  open({
                    col: cell.col,
                    row: cell.row
                  });
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.KEYDOWN, function (e) {
                  if (e.keyCode !== KEY_F2 && e.keyCode !== KEY_ENTER) {
                    return;
                  }

                  var sel = grid.selection.select;

                  if (!isTarget(sel.col, sel.row)) {
                    return;
                  }

                  if (open({
                    col: sel.col,
                    row: sel.row
                  })) {
                    e.stopCellMoving();
                  }
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SELECTED_CELL, function (_e) {
                  detachMenu();
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SCROLL, function () {
                  detachMenu(true);
                }), // mouse move
                grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOVER_CELL, function (e) {
                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  if ((0, action_utils_1.isReadOnlyRecord)(_this24.readOnly, grid, e.row) || (0, action_utils_1.isDisabledRecord)(_this24.disabled, grid, e.row)) {
                    return;
                  }

                  grid.getElement().style.cursor = "pointer";
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEMOVE_CELL, function (e) {
                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  if ((0, action_utils_1.isReadOnlyRecord)(_this24.readOnly, grid, e.row) || (0, action_utils_1.isDisabledRecord)(_this24.disabled, grid, e.row)) {
                    return;
                  }

                  if (!grid.getElement().style.cursor) {
                    grid.getElement().style.cursor = "pointer";
                  }
                }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOUT_CELL, function (e) {
                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  grid.getElement().style.cursor = "";
                }), // paste value
                grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.PASTE_CELL, function (e) {
                  if (e.multi) {
                    // ignore multi cell values
                    return;
                  }

                  var selectionRange = grid.selection.range;

                  if (!(0, utils_1.cellEquals)(selectionRange.start, selectionRange.end)) {
                    // ignore multi paste values
                    return;
                  }

                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  if ((0, action_utils_1.isReadOnlyRecord)(_this24.readOnly, grid, e.row) || (0, action_utils_1.isDisabledRecord)(_this24.disabled, grid, e.row)) {
                    return;
                  }

                  var record = grid.getRowRecord(e.row);

                  if ((0, utils_1.isPromise)(record)) {
                    return;
                  }

                  var pasteOpt = _this24._pasteDataToOptionValue(e.normalizeValue, grid, e, record);

                  if (pasteOpt) {
                    utils_1.event.cancel(e.event);
                    (0, utils_1.then)(grid.doChangeValue(e.col, e.row, function () {
                      return pasteOpt.value;
                    }), function () {
                      var range = grid.getCellRange(e.col, e.row);
                      grid.invalidateCellRange(range);
                    });
                  } else {
                    grid.fireListeners("rejected_paste_values", {
                      detail: [{
                        col: e.col,
                        row: e.row,
                        record: record,
                        define: grid.getColumnDefine(e.col, e.row),
                        pasteValue: e.normalizeValue
                      }]
                    });
                  }
                })];
              }
            }, {
              key: "onPasteCellRangeBox",
              value: function onPasteCellRangeBox(grid, cell, value, context) {
                if ((0, action_utils_1.isReadOnlyRecord)(this.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(this.disabled, grid, cell.row)) {
                  return;
                }

                var record = grid.getRowRecord(cell.row);

                if ((0, utils_1.isPromise)(record)) {
                  return;
                }

                var pasteOpt = this._pasteDataToOptionValue(value, grid, cell, record);

                if (pasteOpt) {
                  grid.doChangeValue(cell.col, cell.row, function () {
                    return pasteOpt.value;
                  });
                } else {
                  // unknown
                  context.reject();
                }
              }
            }, {
              key: "onDeleteCellRangeBox",
              value: function onDeleteCellRangeBox(grid, cell) {
                if ((0, action_utils_1.isReadOnlyRecord)(this.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(this.disabled, grid, cell.row)) {
                  return;
                }

                var record = grid.getRowRecord(cell.row);

                if ((0, utils_1.isPromise)(record)) {
                  return;
                }

                var pasteOpt = this._pasteDataToOptionValue("", grid, cell, record);

                if (pasteOpt) {
                  grid.doChangeValue(cell.col, cell.row, function () {
                    return pasteOpt.value;
                  });
                }
              }
            }, {
              key: "_pasteDataToOptionValue",
              value: function _pasteDataToOptionValue(value, grid, cell, record) {
                var options = this._options(record);

                var pasteOpt = _textToOptionValue(value, options);

                if (pasteOpt) {
                  return pasteOpt;
                }

                var columnType = grid.getColumnType(cell.col, cell.row);

                if (hasOptions(columnType)) {
                  // Find with caption.
                  var pasteValue = normalizePasteValueStr(value);
                  var captionOpt = utils_1.array.find(columnType.options, function (opt) {
                    return normalizePasteValueStr(opt.label) === pasteValue;
                  });

                  if (captionOpt) {
                    return _textToOptionValue(captionOpt.value, options);
                  }
                }

                return undefined;
              }
            }]);

            return InlineMenuEditor;
          }(Editor_1.Editor);

          exports.InlineMenuEditor = InlineMenuEditor;

          function _textToOptionValue(value, options) {
            var pasteValue = normalizePasteValueStr(value);
            var pasteOpt = utils_1.array.find(options, function (opt) {
              return normalizePasteValueStr(opt.value) === pasteValue;
            });

            if (pasteOpt) {
              return pasteOpt;
            }

            return undefined;
          } // eslint-disable-next-line @typescript-eslint/no-explicit-any


          function normalizePasteValueStr(value) {
            if (value == null) {
              return "";
            }

            return "".concat(value).trim();
          } // eslint-disable-next-line @typescript-eslint/no-explicit-any


          function hasOptions(columnType) {
            if (columnType instanceof type_1.MenuColumn) {
              return true;
            } // eslint-disable-next-line @typescript-eslint/no-explicit-any


            if (Array.isArray(columnType.options)) {
              return true;
            }

            return false;
          }
          /***/

        },

        /***/
        "./columns/action/RadioEditor.js":
        /*!***************************************!*\
          !*** ./columns/action/RadioEditor.js ***!
          \***************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionRadioEditorJs(module, exports, __nested_webpack_require_249341__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.RadioEditor = void 0;

          var actionBind_1 = __nested_webpack_require_249341__(
          /*! ./actionBind */
          "./columns/action/actionBind.js");

          var utils_1 = __nested_webpack_require_249341__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var action_utils_1 = __nested_webpack_require_249341__(
          /*! ./action-utils */
          "./columns/action/action-utils.js");

          var DG_EVENT_TYPE_1 = __nested_webpack_require_249341__(
          /*! ../../core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var Editor_1 = __nested_webpack_require_249341__(
          /*! ./Editor */
          "./columns/action/Editor.js");

          var animate_1 = __nested_webpack_require_249341__(
          /*! ../../internal/animate */
          "./internal/animate.js");

          var symbolManager_1 = __nested_webpack_require_249341__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_2 = __nested_webpack_require_249341__(
          /*! ../utils */
          "./columns/utils/index.js");

          var RADIO_COLUMN_STATE_ID = (0, symbolManager_1.getRadioColumnStateId)();

          var RadioEditor = /*#__PURE__*/function (_Editor_1$Editor4) {
            _inherits(RadioEditor, _Editor_1$Editor4);

            var _super13 = _createSuper(RadioEditor);

            function RadioEditor() {
              var _this25;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, RadioEditor);

              _this25 = _super13.call(this, option);
              _this25._group = option.group;
              _this25._checkAction = option.checkAction;
              return _this25;
            }

            _createClass(RadioEditor, [{
              key: "clone",
              value: function clone() {
                return new RadioEditor(this);
              }
              /** @deprecated Use checkAction instead. */

            }, {
              key: "group",
              get: function get() {
                return this._group;
              }
              /** @deprecated Use checkAction instead. */
              ,
              set: function set(group) {
                this._group = group;
              }
            }, {
              key: "checkAction",
              get: function get() {
                return this._checkAction;
              },
              set: function set(checkAction) {
                this._checkAction = checkAction;
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(grid, cellId) {
                var _this26 = this;

                var _state = grid[RADIO_COLUMN_STATE_ID];

                if (!_state) {
                  _state = {
                    block: {},
                    elapsed: {}
                  };
                  utils_1.obj.setReadonly(grid, RADIO_COLUMN_STATE_ID, _state);
                }

                var state = _state;

                var action = function action(cell) {
                  _this26._action(grid, cell);
                };

                function isTarget(col, row) {
                  return grid.getLayoutCellId(col, row) === cellId;
                }

                return [].concat(_toConsumableArray((0, actionBind_1.bindCellClickAction)(grid, cellId, {
                  action: action,
                  mouseOver: function mouseOver(e) {
                    if ((0, action_utils_1.isDisabledRecord)(_this26.disabled, grid, e.row)) {
                      return false;
                    }

                    state.mouseActiveCell = {
                      col: e.col,
                      row: e.row
                    };
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                    return true;
                  },
                  mouseOut: function mouseOut(e) {
                    delete state.mouseActiveCell;
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                  }
                })), _toConsumableArray((0, actionBind_1.bindCellKeyAction)(grid, cellId, {
                  action: action
                })), [// paste value
                grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.PASTE_CELL, function (e) {
                  if (e.multi) {
                    // ignore multi cell values
                    return;
                  }

                  var selectionRange = grid.selection.range;

                  if (!(0, utils_1.cellEquals)(selectionRange.start, selectionRange.end)) {
                    // ignore multi paste values
                    return;
                  }

                  if (!isTarget(e.col, e.row)) {
                    return;
                  }

                  utils_1.event.cancel(e.event);
                  var pasteValue = e.normalizeValue.trim();

                  if (isRejectValue(pasteValue)) {
                    // Not a boolean
                    var record = grid.getRowRecord(e.row);

                    if (!(0, utils_1.isPromise)(record)) {
                      grid.fireListeners("rejected_paste_values", {
                        detail: [{
                          col: e.col,
                          row: e.row,
                          record: record,
                          define: grid.getColumnDefine(e.col, e.row),
                          pasteValue: pasteValue
                        }]
                      });
                    }

                    return;
                  }

                  if (!(0, utils_2.toBoolean)(pasteValue)) {
                    return;
                  }

                  action({
                    col: e.col,
                    row: e.row
                  });
                })]);
              }
            }, {
              key: "onPasteCellRangeBox",
              value: function onPasteCellRangeBox(grid, cell, value, context) {
                if ((0, action_utils_1.isReadOnlyRecord)(this.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(this.disabled, grid, cell.row)) {
                  return;
                }

                var pasteValue = value.trim();

                if (isRejectValue(pasteValue)) {
                  // Not a boolean
                  context.reject();
                  return;
                }

                if (!(0, utils_2.toBoolean)(pasteValue)) {
                  return;
                }

                this._action(grid, {
                  col: cell.col,
                  row: cell.row
                });
              }
            }, {
              key: "onDeleteCellRangeBox",
              value: function onDeleteCellRangeBox() {// noop
              }
            }, {
              key: "_action",
              value: function _action(grid, cell) {
                var _this27 = this;

                var state = grid[RADIO_COLUMN_STATE_ID];
                var range = grid.getCellRange(cell.col, cell.row);
                var cellKey = "".concat(range.start.col, ":").concat(range.start.row);

                if ((0, action_utils_1.isReadOnlyRecord)(this.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(this.disabled, grid, cell.row) || state.block[cellKey]) {
                  return;
                }

                grid.doGetCellValue(cell.col, cell.row, function (value) {
                  if ((0, utils_2.toBoolean)(value)) {
                    return;
                  }

                  if (_this27._checkAction) {
                    // User behavior
                    var record = grid.getRowRecord(cell.row);

                    _this27._checkAction(record, (0, utils_1.extend)(cell, {
                      grid: grid
                    }));

                    return;
                  }

                  if (_this27._group) {
                    // Backward compatibility
                    var _state2 = grid[RADIO_COLUMN_STATE_ID];

                    var targets = _this27._group({
                      grid: grid,
                      col: cell.col,
                      row: cell.row
                    });

                    targets.forEach(function (_ref22) {
                      var col = _ref22.col,
                          row = _ref22.row;
                      var range = grid.getCellRange(col, row);
                      var cellKey = "".concat(range.start.col, ":").concat(range.start.row);

                      if ((0, action_utils_1.isReadOnlyRecord)(_this27.readOnly, grid, cell.row) || (0, action_utils_1.isDisabledRecord)(_this27.disabled, grid, cell.row) || _state2.block[cellKey]) {
                        return;
                      }

                      actionCell(grid, col, row, col === cell.col && row === cell.row);
                    });
                    return;
                  } // default behavior


                  var field = grid.getField(cell.col, cell.row);
                  var recordStartRow = grid.getRecordStartRowByRecordIndex(grid.getRecordIndexByRow(cell.row));
                  /** Original DataSource */

                  var dataSource = grid.dataSource.dataSource;
                  var girdRecords = getAllRecordsFromGrid(grid);

                  var _loop3 = function _loop3(index) {
                    var record = dataSource.get(index);
                    var showData = girdRecords.find(function (d) {
                      return d.record === record;
                    });

                    if (showData) {
                      actionCell(grid, cell.col, showData.row, showData.row === recordStartRow);
                    } else {
                      // Hidden record
                      (0, utils_1.then)(dataSource.getField(index, field), function (value) {
                        if (!(0, utils_2.toBoolean)(value)) {
                          return;
                        }

                        dataSource.setField(index, field, (0, action_utils_1.toggleValue)(value));
                      });
                    }
                  };

                  for (var index = 0; index < dataSource.length; index++) {
                    _loop3(index);
                  }
                });
              }
            }]);

            return RadioEditor;
          }(Editor_1.Editor);

          exports.RadioEditor = RadioEditor;

          function getAllRecordsFromGrid(grid) {
            var result = [];
            var rowCount = grid.rowCount,
                recordRowCount = grid.recordRowCount;

            for (var targetRow = grid.frozenRowCount; targetRow < rowCount; targetRow += recordRowCount) {
              var record = grid.getRowRecord(targetRow);
              result.push({
                row: targetRow,
                record: record
              });
            }

            return result;
          }

          function actionCell(grid, col, row, flag) {
            grid.doGetCellValue(col, row, function (value) {
              if ((0, utils_2.toBoolean)(value) === flag) {
                return;
              }

              var state = grid[RADIO_COLUMN_STATE_ID];
              var range = grid.getCellRange(col, row);
              var cellKey = "".concat(range.start.col, ":").concat(range.start.row);
              var ret = grid.doChangeValue(col, row, action_utils_1.toggleValue);

              if (ret) {
                var onChange = function onChange() {
                  // checkbox animation
                  (0, animate_1.animate)(200, function (point) {
                    if (point === 1) {
                      delete state.elapsed[cellKey];
                    } else {
                      state.elapsed[cellKey] = point;
                    }

                    grid.invalidateCellRange(range);
                  });
                };

                if ((0, utils_1.isPromise)(ret)) {
                  state.block[cellKey] = true;
                  ret.then(function () {
                    delete state.block[cellKey];
                    onChange();
                  });
                } else {
                  onChange();
                }
              }
            });
          }

          function isRejectValue(pasteValue) {
            return (0, action_utils_1.toggleValue)((0, action_utils_1.toggleValue)(pasteValue)) !== pasteValue;
          }
          /***/

        },

        /***/
        "./columns/action/SmallDialogInputEditor.js":
        /*!**************************************************!*\
          !*** ./columns/action/SmallDialogInputEditor.js ***!
          \**************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionSmallDialogInputEditorJs(module, exports, __nested_webpack_require_262491__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.SmallDialogInputEditor = void 0;

          var BaseInputEditor_1 = __nested_webpack_require_262491__(
          /*! ./BaseInputEditor */
          "./columns/action/BaseInputEditor.js");

          var SmallDialogInputElement_1 = __nested_webpack_require_262491__(
          /*! ./internal/SmallDialogInputElement */
          "./columns/action/internal/SmallDialogInputElement.js");

          var symbolManager_1 = __nested_webpack_require_262491__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_262491__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var _ = (0, symbolManager_1.getSmallDialogInputEditorStateId)();

          function getState(grid) {
            var state = grid[_];

            if (!state) {
              state = {};
              utils_1.obj.setReadonly(grid, _, state);
            }

            return state;
          } // eslint-disable-next-line @typescript-eslint/no-explicit-any


          var globalElement = null;
          var bindGridCount = 0;

          function attachInput(grid, cell, editor, value) {
            var state = getState(grid);

            if (!globalElement) {
              globalElement = new SmallDialogInputElement_1.SmallDialogInputElement();
            }

            if (!state.element) {
              state.element = globalElement;
              bindGridCount++;
              grid.addDisposable({
                dispose: function dispose() {
                  bindGridCount--;

                  if (!bindGridCount) {
                    globalElement === null || globalElement === void 0 ? void 0 : globalElement.dispose();
                    globalElement = null;
                    state.element = null;
                  }
                }
              });
            }

            globalElement.attach(grid, editor, cell.col, cell.row, value);
          }

          function detachInput(gridFocus) {
            if (globalElement) {
              globalElement.detach(gridFocus);
            }
          }

          var SmallDialogInputEditor = /*#__PURE__*/function (_BaseInputEditor_1$Ba2) {
            _inherits(SmallDialogInputEditor, _BaseInputEditor_1$Ba2);

            var _super14 = _createSuper(SmallDialogInputEditor);

            function SmallDialogInputEditor() {
              var _this28;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, SmallDialogInputEditor);

              _this28 = _super14.call(this, option);
              _this28._helperText = option.helperText;
              _this28._inputValidator = option.inputValidator;
              _this28._validator = option.validator;
              _this28._classList = option.classList;
              _this28._type = option.type;
              return _this28;
            }

            _createClass(SmallDialogInputEditor, [{
              key: "dispose",
              value: function dispose() {//noop
              }
            }, {
              key: "classList",
              get: function get() {
                if (!this._classList) {
                  return undefined;
                }

                return Array.isArray(this._classList) ? this._classList : [this._classList];
              },
              set: function set(classList) {
                this._classList = classList;
              }
            }, {
              key: "type",
              get: function get() {
                return this._type;
              },
              set: function set(type) {
                this._type = type;
              }
            }, {
              key: "helperText",
              get: function get() {
                return this._helperText;
              }
            }, {
              key: "inputValidator",
              get: function get() {
                return this._inputValidator;
              }
            }, {
              key: "validator",
              get: function get() {
                return this._validator;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new SmallDialogInputEditor(this);
              }
            }, {
              key: "onInputCellInternal",
              value: function onInputCellInternal(grid, cell, inputValue) {
                attachInput(grid, cell, this, inputValue);
              }
            }, {
              key: "onOpenCellInternal",
              value: function onOpenCellInternal(grid, cell) {
                var _this29 = this;

                grid.doGetCellValue(cell.col, cell.row, function (value) {
                  attachInput(grid, cell, _this29, value);
                });
              }
            }, {
              key: "onChangeSelectCellInternal",
              value: function onChangeSelectCellInternal(_grid, _cell, _selected) {
                // cancel input
                detachInput();
              }
            }, {
              key: "onGridScrollInternal",
              value: function onGridScrollInternal(_grid) {
                // cancel input
                detachInput(true);
              }
            }, {
              key: "onChangeDisabledInternal",
              value: function onChangeDisabledInternal() {
                // cancel input
                detachInput(true);
              }
            }, {
              key: "onChangeReadOnlyInternal",
              value: function onChangeReadOnlyInternal() {
                // cancel input
                detachInput(true);
              }
            }, {
              key: "onSetInputAttrsInternal",
              value: function onSetInputAttrsInternal(grid, _cell, input) {
                SmallDialogInputElement_1.SmallDialogInputElement.setInputAttrs(this, grid, input);
              }
            }]);

            return SmallDialogInputEditor;
          }(BaseInputEditor_1.BaseInputEditor);

          exports.SmallDialogInputEditor = SmallDialogInputEditor;
          /***/
        },

        /***/
        "./columns/action/action-utils.js":
        /*!****************************************!*\
          !*** ./columns/action/action-utils.js ***!
          \****************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionActionUtilsJs(module, exports, __nested_webpack_require_269160__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.toggleValue = exports.isReadOnlyRecord = exports.isDisabledRecord = void 0;

          var utils_1 = __nested_webpack_require_269160__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          function isDisabledRecord(option, grid, row) {
            if (grid.disabled) {
              return true;
            }

            return getBooleanOptionOfRecord(option, grid, row);
          }

          exports.isDisabledRecord = isDisabledRecord;

          function isReadOnlyRecord(option, grid, row) {
            if (grid.readOnly) {
              return true;
            }

            return getBooleanOptionOfRecord(option, grid, row);
          }

          exports.isReadOnlyRecord = isReadOnlyRecord;

          function toggleValue(val) {
            if (typeof val === "number") {
              if (val === 0) {
                return 1;
              } else {
                return 0;
              }
            } else if (typeof val === "string") {
              if (val === "false") {
                return "true";
              } else if (val === "off") {
                return "on";
              } else if (/^0+$/.exec(val)) {
                return val.replace(/^(0*)0$/, "$11");
              } else if (val === "true") {
                return "false";
              } else if (val === "on") {
                return "off";
              } else if (/^0*1$/.exec(val)) {
                return val.replace(/^(0*)1$/, "$10");
              }
            }

            return !val;
          }

          exports.toggleValue = toggleValue;

          function getBooleanOptionOfRecord(option, grid, row) {
            if (typeof option === "function") {
              var record = grid.getRowRecord(row);

              if ((0, utils_1.isPromise)(record)) {
                return true;
              }

              return !!option(record);
            }

            return !!option;
          }
          /***/

        },

        /***/
        "./columns/action/actionBind.js":
        /*!**************************************!*\
          !*** ./columns/action/actionBind.js ***!
          \**************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionActionBindJs(module, exports, __nested_webpack_require_271691__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.bindCellKeyAction = exports.bindCellClickAction = void 0;

          var utils_1 = __nested_webpack_require_271691__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var DG_EVENT_TYPE_1 = __nested_webpack_require_271691__(
          /*! ../../core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var KEY_ENTER = 13;
          var KEY_SPACE = 32;

          function bindCellClickAction(grid, cellId, _ref23) {
            var action = _ref23.action,
                mouseOver = _ref23.mouseOver,
                mouseOut = _ref23.mouseOut,
                area = _ref23.area;

            function isTarget(col, row) {
              return grid.getLayoutCellId(col, row) === cellId;
            }

            var mouseIsInCell = null;
            var mouseOvered = null;

            function processMouseOver(e) {
              mouseOvered = e;

              if (mouseOver) {
                if (!mouseOver({
                  col: e.col,
                  row: e.row
                })) {
                  return;
                }
              }

              grid.getElement().style.cursor = "pointer";
            }

            function processMouseOut(e) {
              if (mouseOut) {
                mouseOut({
                  col: e.col,
                  row: e.row
                });
              }

              mouseOvered = null;
              grid.getElement().style.cursor = "";
            }

            var disposables = [// click
            grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.CLICK_CELL, function (e) {
              if (!isTarget(e.col, e.row)) {
                return;
              }

              if ((0, utils_1.isPromise)(grid.getRowRecord(e.row))) {
                return;
              }

              if (area) {
                if (!area(e)) return;
              }

              action({
                col: e.col,
                row: e.row
              });
            }), // mouse move
            grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOVER_CELL, function (e) {
              if (!isTarget(e.col, e.row)) {
                return;
              }

              if ((0, utils_1.isPromise)(grid.getRowRecord(e.row))) {
                return;
              }

              mouseIsInCell = e;

              if (area) {
                if (!area(e)) return;
              }

              processMouseOver(e);
            }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOUT_CELL, function (e) {
              if (!mouseIsInCell || mouseIsInCell.col !== e.col || mouseIsInCell.row !== e.row) {
                return;
              }

              if (!mouseOvered) {
                processMouseOut(e);
              }
            })];

            if (area) {
              disposables.push(grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEMOVE_CELL, function (e) {
                if (!mouseIsInCell || mouseIsInCell.col !== e.col || mouseIsInCell.row !== e.row) {
                  return;
                }

                var isInArea = area(e);

                if (!mouseOvered) {
                  if (!isInArea) return; // mouse over

                  processMouseOver(e);
                } else {
                  if (isInArea) return; // mouse out

                  processMouseOut(e);
                }
              }));
            }

            return disposables;
          }

          exports.bindCellClickAction = bindCellClickAction;

          function bindCellKeyAction(grid, cellId, _ref24) {
            var action = _ref24.action,
                _ref24$acceptKeys = _ref24.acceptKeys,
                acceptKeys = _ref24$acceptKeys === void 0 ? [] : _ref24$acceptKeys;

            function isTarget(col, row) {
              return grid.getLayoutCellId(col, row) === cellId;
            }

            acceptKeys = [].concat(_toConsumableArray(acceptKeys), [KEY_ENTER, KEY_SPACE]);
            return [// enter key down
            grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.KEYDOWN, function (e) {
              var _a;

              if (acceptKeys.indexOf(e.keyCode) === -1) {
                return;
              }

              if (((_a = grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnEnter) && e.keyCode === KEY_ENTER) {
                // When moving with the enter key, no action is taken with the enter key.
                return;
              }

              var sel = grid.selection.select;

              if (!isTarget(sel.col, sel.row)) {
                return;
              }

              if ((0, utils_1.isPromise)(grid.getRowRecord(sel.row))) {
                return;
              }

              action({
                col: sel.col,
                row: sel.row
              });
              utils_1.event.cancel(e.event);
            })];
          }

          exports.bindCellKeyAction = bindCellKeyAction;
          /***/
        },

        /***/
        "./columns/action/internal/InlineInputElement.js":
        /*!*******************************************************!*\
          !*** ./columns/action/internal/InlineInputElement.js ***!
          \*******************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionInternalInlineInputElementJs(module, exports, __nested_webpack_require_277266__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineInputElement = void 0;

          var EventHandler_1 = __nested_webpack_require_277266__(
          /*! ../../../internal/EventHandler */
          "./internal/EventHandler.js");

          var dom_1 = __nested_webpack_require_277266__(
          /*! ../../../internal/dom */
          "./internal/dom.js");

          var utils_1 = __nested_webpack_require_277266__(
          /*! ../../../internal/utils */
          "./internal/utils.js");

          var input_value_handler_1 = __nested_webpack_require_277266__(
          /*! ./input-value-handler */
          "./columns/action/internal/input-value-handler.js");

          var KEY_TAB = 9;
          var KEY_ENTER = 13;
          var CLASSNAME = "cheetah-grid__inline-input";

          function createInputElement() {
            __nested_webpack_require_277266__(
            /*! @/columns/action/internal/InlineInputElement.css */
            "../src/js/columns/action/internal/InlineInputElement.css");

            return (0, dom_1.createElement)("input", {
              classList: CLASSNAME
            });
          }

          function _setInputAttrs(editor, _grid, input) {
            var classList = editor.classList,
                type = editor.type;

            if (classList) {
              var _input$classList;

              (_input$classList = input.classList).add.apply(_input$classList, _toConsumableArray(classList));
            }

            input.type = type || "";
          }

          var InlineInputElement = /*#__PURE__*/function () {
            function InlineInputElement() {
              _classCallCheck(this, InlineInputElement);

              this._handler = new EventHandler_1.EventHandler();
              this._input = createInputElement();

              this._bindInputEvents();
            }

            _createClass(InlineInputElement, [{
              key: "dispose",
              value: function dispose() {
                var _a;

                var input = this._input;
                this.detach();

                this._handler.dispose(); // @ts-expect-error -- ignore


                delete this._input;
                this._beforePropEditor = null;
                (_a = input.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(input);
              }
            }, {
              key: "attach",
              value: function attach(grid, editor, col, row, value) {
                var _this30 = this;

                var input = this._input;
                var handler = this._handler;

                if (this._beforePropEditor) {
                  var classList = this._beforePropEditor.classList;

                  if (classList) {
                    var _input$classList2;

                    (_input$classList2 = input.classList).remove.apply(_input$classList2, _toConsumableArray(classList));
                  }
                }

                input.style.font = grid.font || "16px sans-serif";

                var _grid$getAttachCellsA = grid.getAttachCellsArea(grid.getCellRange(col, row)),
                    element = _grid$getAttachCellsA.element,
                    rect = _grid$getAttachCellsA.rect;

                input.style.top = "".concat(rect.top.toFixed(), "px");
                input.style.left = "".concat(rect.left.toFixed(), "px");
                input.style.width = "".concat(rect.width.toFixed(), "px");
                input.style.height = "".concat(rect.height.toFixed(), "px");
                element.appendChild(input);

                _setInputAttrs(editor, grid, input);

                (0, input_value_handler_1.setInputValue)(input, value);
                this._activeData = {
                  grid: grid,
                  col: col,
                  row: row,
                  editor: editor
                };
                this._beforePropEditor = editor;

                var focus = function focus() {
                  input.focus();
                  var end = input.value.length;

                  try {
                    if (typeof input.selectionStart !== "undefined") {
                      input.selectionStart = end;
                      input.selectionEnd = end;
                      return;
                    }
                  } catch (e) {//ignore
                  } // eslint-disable-next-line @typescript-eslint/no-explicit-any


                  if (document.selection) {
                    // eslint-disable-next-line @typescript-eslint/no-explicit-any
                    var range = input.createTextRange();
                    range.collapse();
                    range.moveEnd("character", end);
                    range.moveStart("character", end);
                    range.select();
                  }
                };

                handler.tryWithOffEvents(input, "blur", function () {
                  focus();
                });
                this._attaching = true;
                setTimeout(function () {
                  delete _this30._attaching;
                });
              }
            }, {
              key: "detach",
              value: function detach(gridFocus) {
                if (this._isActive()) {
                  var _this$_activeData = this._activeData,
                      grid = _this$_activeData.grid,
                      col = _this$_activeData.col,
                      row = _this$_activeData.row;
                  var input = this._input;

                  this._handler.tryWithOffEvents(input, "blur", function () {
                    var _a;

                    (_a = input.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(input);
                  });

                  var range = grid.getCellRange(col, row);
                  grid.invalidateCellRange(range);

                  if (gridFocus) {
                    grid.focus();
                  }
                }

                this._activeData = null;
              }
            }, {
              key: "doChangeValue",
              value: function doChangeValue() {
                if (!this._isActive()) {
                  return;
                }

                var input = this._input;
                var value = input.value;
                var _this$_activeData2 = this._activeData,
                    grid = _this$_activeData2.grid,
                    col = _this$_activeData2.col,
                    row = _this$_activeData2.row;
                grid.doChangeValue(col, row, function () {
                  return value;
                });
              }
            }, {
              key: "_isActive",
              value: function _isActive() {
                var input = this._input;

                if (!input || !input.parentElement) {
                  return false;
                }

                if (!this._activeData) {
                  return false;
                }

                return true;
              }
            }, {
              key: "_bindInputEvents",
              value: function _bindInputEvents() {
                var _this31 = this;

                var handler = this._handler;
                var input = this._input;

                var stopPropagationOnly = function stopPropagationOnly(e) {
                  return e.stopPropagation();
                }; // gridにイベントが伝播しないように


                handler.on(input, "click", stopPropagationOnly);
                handler.on(input, "mousedown", stopPropagationOnly);
                handler.on(input, "touchstart", stopPropagationOnly);
                handler.on(input, "dblclick", stopPropagationOnly);
                handler.on(input, "compositionstart", function (_e) {
                  input.classList.add("composition");
                });
                handler.on(input, "compositionend", function (_e) {
                  input.classList.remove("composition");
                });
                handler.on(input, "keydown", function (e) {
                  if (input.classList.contains("composition")) {
                    return;
                  }

                  var keyCode = utils_1.event.getKeyCode(e);

                  if (keyCode === KEY_ENTER) {
                    _this31._onKeydownEnter(e);
                  } else if (keyCode === KEY_TAB) {
                    _this31._onKeydownTab(e);
                  }
                });
                handler.on(input, "blur", function (_e) {
                  _this31.doChangeValue();

                  _this31.detach();
                });
              }
            }, {
              key: "_onKeydownEnter",
              value: function _onKeydownEnter(e) {
                var _a;

                if (!this._isActive() || this._attaching) {
                  return;
                }

                var grid = this._activeData.grid;
                this.doChangeValue();
                this.detach(true);
                utils_1.event.cancel(e);

                if ((_a = grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnEnter) {
                  grid.onKeyDownMove(e);
                }
              }
            }, {
              key: "_onKeydownTab",
              value: function _onKeydownTab(e) {
                var _a;

                if (!this._isActive()) {
                  return;
                }

                var grid = this._activeData.grid;

                if (!((_a = grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnTab)) {
                  return;
                }

                this.doChangeValue();
                this.detach(true);
                grid.onKeyDownMove(e);
              }
            }], [{
              key: "setInputAttrs",
              value: function setInputAttrs(editor, grid, input) {
                _setInputAttrs(editor, grid, input);
              }
            }]);

            return InlineInputElement;
          }();

          exports.InlineInputElement = InlineInputElement;
          /***/
        },

        /***/
        "./columns/action/internal/InlineMenuElement.js":
        /*!******************************************************!*\
          !*** ./columns/action/internal/InlineMenuElement.js ***!
          \******************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionInternalInlineMenuElementJs(module, exports, __nested_webpack_require_287867__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineMenuElement = void 0;

          var dom_1 = __nested_webpack_require_287867__(
          /*! ../../../internal/dom */
          "./internal/dom.js");

          var EventHandler_1 = __nested_webpack_require_287867__(
          /*! ../../../internal/EventHandler */
          "./internal/EventHandler.js");

          var utils_1 = __nested_webpack_require_287867__(
          /*! ../../../internal/utils */
          "./internal/utils.js");

          var KEY_TAB = 9;
          var KEY_ENTER = 13;
          var KEY_UP = 38;
          var KEY_DOWN = 40;
          var KEY_ESC = 27;
          var CLASSNAME = "cheetah-grid__inline-menu";
          var ITEM_CLASSNAME = "".concat(CLASSNAME, "__menu-item");
          var HIDDEN_CLASSNAME = "".concat(CLASSNAME, "--hidden");
          var SHOWN_CLASSNAME = "".concat(CLASSNAME, "--shown");
          var EMPTY_ITEM_CLASSNAME = "".concat(ITEM_CLASSNAME, "--empty");

          function findItemParents(target) {
            var el = target;

            while (el && !el.classList.contains(ITEM_CLASSNAME)) {
              el = el.parentElement;

              if (!el || el.classList.contains(CLASSNAME)) {
                return null;
              }
            }

            return el;
          }

          function createMenuElement() {
            __nested_webpack_require_287867__(
            /*! @/columns/action/internal/InlineMenuElement.css */
            "../src/js/columns/action/internal/InlineMenuElement.css");

            return (0, dom_1.createElement)("ul", {
              classList: CLASSNAME
            });
          }

          function attachElement(element, rect, menu) {
            menu.style.top = "".concat(rect.top.toFixed(), "px");
            menu.style.left = "".concat(rect.left.toFixed(), "px");
            menu.style.width = "".concat(rect.width.toFixed(), "px");
            menu.style.lineHeight = "".concat(rect.height.toFixed(), "px");
            element.appendChild(menu);
          }

          function optionToLi(_ref25, index) {
            var classList = _ref25.classList,
                label = _ref25.label,
                value = _ref25.value,
                html = _ref25.html;
            var item = (0, dom_1.createElement)("li", {
              classList: ITEM_CLASSNAME
            });
            item.tabIndex = 0;
            item.dataset.valueindex = "".concat(index);

            if (classList) {
              var _item$classList;

              (_item$classList = item.classList).add.apply(_item$classList, _toConsumableArray(Array.isArray(classList) ? classList : [classList]));
            }

            if (label) {
              var span = (0, dom_1.createElement)("span", {
                text: label
              });
              item.appendChild(span);
            } else if (html) {
              (0, dom_1.appendHtml)(item, html);
            }

            if (value === "" || value == null) {
              item.classList.add(EMPTY_ITEM_CLASSNAME);
            }

            return item;
          }

          function openMenu(grid, editor, col, row, value, options, menu) {
            var classList = editor.classList;
            menu.classList.remove(SHOWN_CLASSNAME);
            menu.classList.add(HIDDEN_CLASSNAME);
            (0, dom_1.empty)(menu);
            menu.style.font = grid.font || "16px sans-serif";
            var emptyItemEl = null;
            var valueItemEl = null;
            options.forEach(function (option, i) {
              var item = optionToLi(option, i);
              menu.appendChild(item);

              if (option.value === value) {
                valueItemEl = item;
                item.dataset.select = "select";
              }

              if (item.classList.contains(EMPTY_ITEM_CLASSNAME)) {
                emptyItemEl = item;
              }
            });
            var focusEl = valueItemEl || emptyItemEl || menu.children[0];

            if (classList) {
              var _menu$classList;

              (_menu$classList = menu.classList).add.apply(_menu$classList, _toConsumableArray(classList));
            }

            var children = Array.prototype.slice.call(menu.children, 0);
            var focusIndex = children.indexOf(focusEl);

            var _grid$getAttachCellsA2 = grid.getAttachCellsArea(grid.getCellRange(col, row)),
                element = _grid$getAttachCellsA2.element,
                rect = _grid$getAttachCellsA2.rect; // Cover the right line


            rect.width++; // append for calculation

            attachElement(element, rect, menu); // Make the selection item at the middle

            var offset = 0;

            for (var i = 0; i < focusIndex; i++) {
              var offsetHeight = children[i].offsetHeight;
              offset += offsetHeight;
            }

            rect.offsetTop(-offset);
            menu.style.transformOrigin = "center ".concat(offset + Math.ceil(children[focusIndex].offsetHeight / 2), "px 0px");
            attachElement(element, rect, menu); // Control not to overflow the screen range

            var bkTransform = menu.style.transform;
            var menuClientRect;

            try {
              // To calculate the original position, set `transform` to `none`.
              menu.style.transform = "none";
              menuClientRect = menu.getBoundingClientRect();
            } finally {
              menu.style.transform = bkTransform;
            }

            var orgMenuTop = menuClientRect.top;
            var menuTop = orgMenuTop;
            var winBottom = window.innerHeight;
            var winMargin = 20;

            if (menuClientRect.bottom > winBottom - winMargin) {
              var diff = menuClientRect.bottom - winBottom + winMargin;
              menuTop -= diff;
            }

            if (menuTop < 0
            /*winTop*/
            + winMargin) {
              menuTop = winMargin;
            }

            if (menuTop !== orgMenuTop) {
              rect.offsetTop(-(orgMenuTop - menuTop)); // Sets the center of the menu since it is not possible to determine the exact center of the selected element.

              menu.style.transformOrigin = "center"; // re update

              attachElement(element, rect, menu);
            }

            if (focusEl) {
              focusEl.focus();
            }

            menu.classList.remove(HIDDEN_CLASSNAME);
            menu.classList.add(SHOWN_CLASSNAME);
          }

          function closeMenu(_grid, _col, _row, menu) {
            menu.classList.remove(SHOWN_CLASSNAME);
            menu.classList.add(HIDDEN_CLASSNAME);
            (0, dom_1.disableFocus)(menu);
          }

          var InlineMenuElement = /*#__PURE__*/function () {
            function InlineMenuElement() {
              var _this32 = this;

              _classCallCheck(this, InlineMenuElement);

              var handler = this._handler = new EventHandler_1.EventHandler();
              this._menu = createMenuElement();

              this._bindMenuEvents();

              var bodyClickListenerId;

              var deregisterBodyClickListener = this._deregisterBodyClickListener = function () {
                return handler.off(bodyClickListenerId);
              };

              this._registerBodyClickListener = function () {
                deregisterBodyClickListener();
                bodyClickListenerId = handler.on(document.body, "click", _this32._onBodyClick.bind(_this32), {
                  capture: true
                });
              };
            }

            _createClass(InlineMenuElement, [{
              key: "dispose",
              value: function dispose() {
                var _a;

                var menu = this._menu;
                this.detach();

                this._handler.dispose(); // @ts-expect-error -- ignore


                delete this._menu;
                this._beforePropEditor = null;
                (_a = menu.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(menu);
              }
            }, {
              key: "attach",
              value: function attach(grid, editor, col, row, value, record) {
                var menu = this._menu;

                if (this._beforePropEditor) {
                  var classList = this._beforePropEditor.classList;

                  if (classList) {
                    var _menu$classList2;

                    (_menu$classList2 = menu.classList).remove.apply(_menu$classList2, _toConsumableArray(classList));
                  }
                }

                var options = editor.options(record);
                openMenu(grid, editor, col, row, value, options, menu);
                this._activeData = {
                  grid: grid,
                  col: col,
                  row: row,
                  editor: editor,
                  options: options
                };
                this._beforePropEditor = editor;

                this._registerBodyClickListener();
              }
            }, {
              key: "detach",
              value: function detach(gridFocus) {
                if (this._isActive()) {
                  var _this$_activeData3 = this._activeData,
                      grid = _this$_activeData3.grid,
                      col = _this$_activeData3.col,
                      row = _this$_activeData3.row;
                  var menu = this._menu;
                  closeMenu(grid, col, row, menu);
                  var range = grid.getCellRange(col, row);
                  grid.invalidateCellRange(range);

                  if (gridFocus) {
                    grid.focus();
                  }
                }

                this._activeData = null;

                this._deregisterBodyClickListener();
              }
            }, {
              key: "_doChangeValue",
              value: function _doChangeValue(valueindex) {
                if (!this._isActive()) {
                  return;
                }

                var _this$_activeData4 = this._activeData,
                    grid = _this$_activeData4.grid,
                    col = _this$_activeData4.col,
                    row = _this$_activeData4.row,
                    options = _this$_activeData4.options;
                var option = options[Number(valueindex)];

                if (option) {
                  var value = option.value;
                  grid.doChangeValue(col, row, function () {
                    return value;
                  });
                }
              }
            }, {
              key: "_isActive",
              value: function _isActive() {
                var menu = this._menu;

                if (!menu || !menu.parentElement) {
                  return false;
                }

                if (!this._activeData) {
                  return false;
                }

                return true;
              }
            }, {
              key: "_bindMenuEvents",
              value: function _bindMenuEvents() {
                var _this33 = this;

                var handler = this._handler;
                var menu = this._menu;

                var stopPropagationOnly = function stopPropagationOnly(e) {
                  return e.stopPropagation();
                }; // gridにイベントが伝播しないように


                handler.on(menu, "mousedown", stopPropagationOnly);
                handler.on(menu, "touchstart", stopPropagationOnly);
                handler.on(menu, "dblclick", stopPropagationOnly);
                handler.on(menu, "click", function (e) {
                  e.stopPropagation();
                  var item = findItemParents(e.target);

                  if (!item) {
                    return;
                  }

                  var valueindex = item.dataset.valueindex;

                  _this33._doChangeValue(valueindex || "");

                  _this33.detach(true);
                });
                handler.on(menu, "keydown", function (e) {
                  var item = findItemParents(e.target);

                  if (!item) {
                    return;
                  }

                  var keyCode = utils_1.event.getKeyCode(e);

                  if (keyCode === KEY_ENTER) {
                    _this33._onKeydownEnter(menu, item, e);
                  } else if (keyCode === KEY_ESC) {
                    _this33.detach(true);

                    utils_1.event.cancel(e);
                  } else if (keyCode === KEY_UP) {
                    var n = (0, dom_1.findPrevSiblingFocusable)(item);

                    if (n) {
                      n.focus();
                      utils_1.event.cancel(e);
                    }
                  } else if (keyCode === KEY_DOWN) {
                    var _n = (0, dom_1.findNextSiblingFocusable)(item);

                    if (_n) {
                      _n.focus();

                      utils_1.event.cancel(e);
                    }
                  } else if (keyCode === KEY_TAB) {
                    _this33._onKeydownTab(menu, item, e);
                  }
                });
              }
            }, {
              key: "_onBodyClick",
              value: function _onBodyClick(e) {
                var el = e.target;

                if (!el) {
                  return;
                }

                if (this._menu.contains(el)) {
                  return;
                }

                if (this._isActive()) {
                  var grid = this._activeData.grid;

                  if (grid.getElement().contains(el)) {
                    return;
                  }
                }

                this.detach();
              }
            }, {
              key: "_onKeydownEnter",
              value: function _onKeydownEnter(_menu, item, e) {
                var _a;

                var grid = this._isActive() ? this._activeData.grid : null;
                var valueindex = item.dataset.valueindex;

                this._doChangeValue(valueindex || "");

                this.detach(true);
                utils_1.event.cancel(e);

                if (grid) {
                  if ((_a = grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnEnter) {
                    grid.onKeyDownMove(e);
                  }
                }
              }
            }, {
              key: "_onKeydownTab",
              value: function _onKeydownTab(menu, item, e) {
                var _a;

                if (this._isActive()) {
                  var grid = this._activeData.grid;

                  if ((_a = grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnTab) {
                    var valueindex = item.dataset.valueindex;

                    this._doChangeValue(valueindex || "");

                    this.detach(true);
                    grid.onKeyDownMove(e);
                    return;
                  }
                }

                if (!e.shiftKey) {
                  if (!(0, dom_1.findNextSiblingFocusable)(item)) {
                    var n = menu.querySelector(".".concat(ITEM_CLASSNAME));

                    if (!(0, dom_1.isFocusable)(n)) {
                      n = (0, dom_1.findNextSiblingFocusable)(n);
                    }

                    if (n) {
                      n.focus();
                      utils_1.event.cancel(e);
                    }
                  }
                } else {
                  if (!(0, dom_1.findPrevSiblingFocusable)(item)) {
                    var items = menu.querySelectorAll(".".concat(ITEM_CLASSNAME));
                    var _n2 = items[items.length - 1];

                    if (!(0, dom_1.isFocusable)(_n2)) {
                      _n2 = (0, dom_1.findPrevSiblingFocusable)(_n2);
                    }

                    if (_n2) {
                      _n2.focus();

                      utils_1.event.cancel(e);
                    }
                  }
                }
              }
            }]);

            return InlineMenuElement;
          }();

          exports.InlineMenuElement = InlineMenuElement;
          /***/
        },

        /***/
        "./columns/action/internal/SmallDialogInputElement.js":
        /*!************************************************************!*\
          !*** ./columns/action/internal/SmallDialogInputElement.js ***!
          \************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionInternalSmallDialogInputElementJs(module, exports, __nested_webpack_require_304618__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.SmallDialogInputElement = void 0;

          var utils_1 = __nested_webpack_require_304618__(
          /*! ../../../internal/utils */
          "./internal/utils.js");

          var EventHandler_1 = __nested_webpack_require_304618__(
          /*! ../../../internal/EventHandler */
          "./internal/EventHandler.js");

          var dom_1 = __nested_webpack_require_304618__(
          /*! ../../../internal/dom */
          "./internal/dom.js");

          var input_value_handler_1 = __nested_webpack_require_304618__(
          /*! ./input-value-handler */
          "./columns/action/internal/input-value-handler.js");

          var CLASSNAME = "cheetah-grid__small-dialog-input";
          var INPUT_CLASSNAME = "".concat(CLASSNAME, "__input");
          var HIDDEN_CLASSNAME = "".concat(CLASSNAME, "--hidden");
          var SHOWN_CLASSNAME = "".concat(CLASSNAME, "--shown");
          var KEY_ENTER = 13;
          var KEY_ESC = 27;

          function _focus(input, handler) {
            var focus = function focus() {
              input.focus();
              var end = input.value.length;

              try {
                if (typeof input.selectionStart !== "undefined") {
                  input.selectionStart = end;
                  input.selectionEnd = end;
                  return;
                }
              } catch (e) {//ignore
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any


              if (document.selection) {
                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                var range = input.createTextRange();
                range.collapse();
                range.moveEnd("character", end);
                range.moveStart("character", end);
                range.select();
              }
            };

            handler.tryWithOffEvents(input, "blur", function () {
              focus();
            });
          }

          function createDialogElement() {
            __nested_webpack_require_304618__(
            /*! @/columns/action/internal/SmallDialogInputElement.css */
            "../src/js/columns/action/internal/SmallDialogInputElement.css");

            var element = (0, dom_1.createElement)("div", {
              classList: [CLASSNAME, HIDDEN_CLASSNAME]
            });
            var input = (0, dom_1.createElement)("input", {
              classList: INPUT_CLASSNAME
            });
            input.readOnly = true;
            input.tabIndex = -1;
            element.appendChild(input);
            return element;
          }

          function bindProps(grid, dialog, input, editor) {
            var classList = editor.classList,
                helperText = editor.helperText;

            if (classList) {
              var _dialog$classList;

              (_dialog$classList = dialog.classList).add.apply(_dialog$classList, _toConsumableArray(classList));
            }

            if (helperText && typeof helperText !== "function") {
              dialog.dataset.helperText = helperText;
            }

            _setInputAttrs2(editor, grid, input);
          }

          function unbindProps(_grid, dialog, input, editor) {
            var classList = editor.classList;

            if (classList) {
              var _dialog$classList2;

              (_dialog$classList2 = dialog.classList).remove.apply(_dialog$classList2, _toConsumableArray(classList));
            }

            delete dialog.dataset.helperText;
            input.type = "";
          }

          function _setInputAttrs2(editor, _grid, input) {
            var type = editor.type;
            input.type = type || "";
          }

          var SmallDialogInputElement = /*#__PURE__*/function () {
            function SmallDialogInputElement() {
              _classCallCheck(this, SmallDialogInputElement);

              this._handler = new EventHandler_1.EventHandler();
              this._dialog = createDialogElement();
              this._input = this._dialog.querySelector(".".concat(INPUT_CLASSNAME));

              this._bindDialogEvents();
            }

            _createClass(SmallDialogInputElement, [{
              key: "dispose",
              value: function dispose() {
                var dialog = this._dialog;
                this.detach();

                this._handler.dispose(); // @ts-expect-error -- ignore


                delete this._dialog; // @ts-expect-error -- ignore

                delete this._input;
                this._beforePropEditor = null;

                if (dialog.parentElement) {
                  dialog.parentElement.removeChild(dialog);
                }
              }
            }, {
              key: "attach",
              value: function attach(grid, editor, col, row, value) {
                var _this34 = this;

                var handler = this._handler;
                var dialog = this._dialog;
                var input = this._input;

                if (this._beforePropEditor) {
                  unbindProps(grid, dialog, input, this._beforePropEditor);
                }

                delete dialog.dataset.errorMessage;
                dialog.classList.remove(SHOWN_CLASSNAME);
                dialog.classList.add(HIDDEN_CLASSNAME);
                input.readOnly = true;
                input.tabIndex = 0;

                var _grid$getAttachCellsA3 = grid.getAttachCellsArea(grid.getCellRange(col, row)),
                    element = _grid$getAttachCellsA3.element,
                    rect = _grid$getAttachCellsA3.rect;

                dialog.style.top = "".concat(rect.top.toFixed(), "px");
                dialog.style.left = "".concat(rect.left.toFixed(), "px");
                dialog.style.width = "".concat(rect.width.toFixed(), "px");
                input.style.height = "".concat(rect.height.toFixed(), "px");
                element.appendChild(dialog);
                (0, input_value_handler_1.setInputValue)(input, value);
                input.style.font = grid.font || "16px sans-serif";
                var activeData = {
                  grid: grid,
                  col: col,
                  row: row,
                  editor: editor
                };

                this._onInputValue(input, activeData);

                if (!utils_1.browser.IE) {
                  _focus(input, handler);
                } else {
                  // On the paste-event on IE, since it may not be focused, it will be delayed and focused.
                  setTimeout(function () {
                    return _focus(input, handler);
                  });
                }

                dialog.classList.add(SHOWN_CLASSNAME);
                dialog.classList.remove(HIDDEN_CLASSNAME);
                input.readOnly = false;
                bindProps(grid, dialog, input, editor);
                this._activeData = activeData;
                this._beforePropEditor = editor;
                this._attaching = true;
                setTimeout(function () {
                  delete _this34._attaching;
                });
              }
            }, {
              key: "detach",
              value: function detach(gridFocus) {
                if (this._isActive()) {
                  var dialog = this._dialog;
                  var input = this._input;
                  dialog.classList.remove(SHOWN_CLASSNAME);
                  dialog.classList.add(HIDDEN_CLASSNAME);
                  input.readOnly = true;
                  input.tabIndex = -1;
                  var _this$_activeData5 = this._activeData,
                      grid = _this$_activeData5.grid,
                      col = _this$_activeData5.col,
                      row = _this$_activeData5.row;
                  var range = grid.getCellRange(col, row);
                  grid.invalidateCellRange(range);

                  if (gridFocus) {
                    grid.focus();
                  }
                }

                this._activeData = null;
                this._beforeValue = null;
              }
            }, {
              key: "_doChangeValue",
              value: function _doChangeValue() {
                var _this35 = this;

                if (!this._isActive()) {
                  return false;
                }

                var input = this._input;
                var value = input.value;
                return (0, utils_1.then)(this._validate(value), function (res) {
                  if (res && value === input.value) {
                    var _this35$_activeData = _this35._activeData,
                        grid = _this35$_activeData.grid,
                        col = _this35$_activeData.col,
                        row = _this35$_activeData.row;
                    grid.doChangeValue(col, row, function () {
                      return value;
                    });
                    return true;
                  }

                  return false;
                });
              }
            }, {
              key: "_isActive",
              value: function _isActive() {
                var dialog = this._dialog;

                if (!dialog || !dialog.parentElement) {
                  return false;
                }

                if (!this._activeData) {
                  return false;
                }

                return true;
              }
            }, {
              key: "_bindDialogEvents",
              value: function _bindDialogEvents() {
                var _this36 = this;

                var handler = this._handler;
                var dialog = this._dialog;
                var input = this._input;

                var stopPropagationOnly = function stopPropagationOnly(e) {
                  return e.stopPropagation();
                }; // gridにイベントが伝播しないように


                handler.on(dialog, "click", stopPropagationOnly);
                handler.on(dialog, "dblclick", stopPropagationOnly);
                handler.on(dialog, "mousedown", stopPropagationOnly);
                handler.on(dialog, "touchstart", stopPropagationOnly);
                handler.on(input, "compositionstart", function (_e) {
                  input.classList.add("composition");
                });
                handler.on(input, "compositionend", function (_e) {
                  input.classList.remove("composition");

                  _this36._onInputValue(input);
                });

                var onKeyupAndPress = function onKeyupAndPress(_e) {
                  if (input.classList.contains("composition")) {
                    return;
                  }

                  _this36._onInputValue(input);
                };

                handler.on(input, "keyup", onKeyupAndPress);
                handler.on(input, "keypress", onKeyupAndPress);
                handler.on(input, "keydown", function (e) {
                  if (input.classList.contains("composition")) {
                    return;
                  }

                  var keyCode = utils_1.event.getKeyCode(e);

                  if (keyCode === KEY_ESC) {
                    _this36.detach(true);

                    utils_1.event.cancel(e);
                  } else if (keyCode === KEY_ENTER) {
                    _this36._onKeydownEnter(e);
                  } else {
                    _this36._onInputValue(input);
                  }
                });
              }
            }, {
              key: "_onKeydownEnter",
              value: function _onKeydownEnter(e) {
                var _this37 = this;

                if (this._attaching) {
                  return;
                }

                var input = this._input;
                var value = input.value;
                (0, utils_1.then)(this._doChangeValue(), function (r) {
                  var _a;

                  if (r && value === input.value) {
                    var grid = _this37._isActive() ? _this37._activeData.grid : null;

                    _this37.detach(true);

                    if ((_a = grid === null || grid === void 0 ? void 0 : grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnEnter) {
                      grid.onKeyDownMove(e);
                    }
                  }
                });
                utils_1.event.cancel(e);
              }
            }, {
              key: "_onInputValue",
              value: function _onInputValue(input, activeData) {
                var before = this._beforeValue;
                var value = input.value;

                if (before !== value) {
                  this._onInputValueChange(value, activeData);
                }

                this._beforeValue = value;
              }
            }, {
              key: "_onInputValueChange",
              value: function _onInputValueChange(after, activeData) {
                activeData = activeData || this._activeData;
                var dialog = this._dialog;
                var _activeData = activeData,
                    grid = _activeData.grid,
                    col = _activeData.col,
                    row = _activeData.row,
                    editor = _activeData.editor;

                if (typeof editor.helperText === "function") {
                  var helperText = editor.helperText(after, {
                    grid: grid,
                    col: col,
                    row: row
                  });

                  if (helperText) {
                    dialog.dataset.helperText = helperText;
                  } else {
                    delete dialog.dataset.helperText;
                  }
                }

                if ("errorMessage" in dialog.dataset) {
                  this._validate(after, true);
                }
              }
            }, {
              key: "_validate",
              value: function _validate(value, inputOnly) {
                var dialog = this._dialog;
                var input = this._input;
                var _this$_activeData6 = this._activeData,
                    grid = _this$_activeData6.grid,
                    col = _this$_activeData6.col,
                    row = _this$_activeData6.row,
                    editor = _this$_activeData6.editor;
                var message = "";

                if (editor.inputValidator) {
                  message = editor.inputValidator(value, {
                    grid: grid,
                    col: col,
                    row: row
                  });
                }

                return (0, utils_1.then)(message, function (message) {
                  if (!message && editor.validator && !inputOnly) {
                    message = editor.validator(value, {
                      grid: grid,
                      col: col,
                      row: row
                    });
                  }

                  return (0, utils_1.then)(message, function (message) {
                    if (message && value === input.value) {
                      dialog.dataset.errorMessage = message;
                    } else {
                      delete dialog.dataset.errorMessage;
                    }

                    return !message;
                  });
                });
              }
            }], [{
              key: "setInputAttrs",
              value: function setInputAttrs(editor, grid, input) {
                _setInputAttrs2(editor, grid, input);
              }
            }]);

            return SmallDialogInputElement;
          }();

          exports.SmallDialogInputElement = SmallDialogInputElement;
          /***/
        },

        /***/
        "./columns/action/internal/input-value-handler.js":
        /*!********************************************************!*\
          !*** ./columns/action/internal/input-value-handler.js ***!
          \********************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsActionInternalInputValueHandlerJs(module, exports, __nested_webpack_require_320778__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.setInputValue = void 0;

          var EventHandler_1 = __nested_webpack_require_320778__(
          /*! ../../../internal/EventHandler */
          "./internal/EventHandler.js");

          function setInputValue(input, value) {
            var sign = input.type === "number" && value === "-";

            if (sign) {
              // When `type="number"`, the minus sign is not accepted, so change it to `type="text"` once.
              input.type = "";
              var handler = new EventHandler_1.EventHandler();

              var dispose = function dispose() {
                if (handler) {
                  handler.dispose();
                  handler = null;
                }
              };

              handler.once(input, "input", function (_e) {
                input.type = "number";
                dispose();
              });
              handler.once(input, "blur", function (_e) {
                dispose();
              });
            }

            input.value = value !== null && value !== void 0 ? value : "";
          }

          exports.setInputValue = setInputValue;
          /***/
        },

        /***/
        "./columns/indicator/handlers.js":
        /*!***************************************!*\
          !*** ./columns/indicator/handlers.js ***!
          \***************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsIndicatorHandlersJs(module, exports, __nested_webpack_require_322471__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.getDrawIndicator = void 0;

          var triangle_1 = __nested_webpack_require_322471__(
          /*! ./triangle */
          "./columns/indicator/triangle.js");

          function getDrawIndicator(indicatorStyle) {
            var style = indicatorStyle.style;

            if (style === "triangle") {
              return triangle_1.drawTriangleIndicator;
            }

            return null;
          }

          exports.getDrawIndicator = getDrawIndicator;
          /***/
        },

        /***/
        "./columns/indicator/triangle.js":
        /*!***************************************!*\
          !*** ./columns/indicator/triangle.js ***!
          \***************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsIndicatorTriangleJs(module, exports, __webpack_require__) {
          "use strict";

          var _KIND_PROCESS_MAP;

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.drawTriangleIndicator = void 0;
          var KIND_PROCESS_MAP = (_KIND_PROCESS_MAP = {}, _defineProperty(_KIND_PROCESS_MAP, 0
          /* DrawIndicatorKind.topLeft */
          , {
            themeColor: function themeColor(helper) {
              return helper.theme.indicators.topLeftColor;
            },
            themeSize: function themeSize(helper) {
              return helper.theme.indicators.topLeftSize;
            },
            drawPath: function drawPath(ctx, rect, size) {
              var baseLeft = rect.left + 1;
              var baseTop = rect.top + 1;
              ctx.moveTo(baseLeft, baseTop);
              ctx.lineTo(baseLeft + size, baseTop);
              ctx.lineTo(baseLeft, baseTop + size);
            }
          }), _defineProperty(_KIND_PROCESS_MAP, 1
          /* DrawIndicatorKind.topRight */
          , {
            themeColor: function themeColor(helper) {
              return helper.theme.indicators.topRightColor;
            },
            themeSize: function themeSize(helper) {
              return helper.theme.indicators.topRightSize;
            },
            drawPath: function drawPath(ctx, rect, size) {
              var baseRight = rect.right - 2;
              var baseTop = rect.top + 1;
              ctx.moveTo(baseRight, baseTop);
              ctx.lineTo(baseRight - size, baseTop);
              ctx.lineTo(baseRight, baseTop + size);
            }
          }), _defineProperty(_KIND_PROCESS_MAP, 2
          /* DrawIndicatorKind.bottomRight */
          , {
            themeColor: function themeColor(helper) {
              return helper.theme.indicators.bottomRightColor;
            },
            themeSize: function themeSize(helper) {
              return helper.theme.indicators.bottomRightSize;
            },
            drawPath: function drawPath(ctx, rect, size) {
              var baseRight = rect.right - 2;
              var baseBottom = rect.bottom - 2;
              ctx.moveTo(baseRight, baseBottom);
              ctx.lineTo(baseRight - size, baseBottom);
              ctx.lineTo(baseRight, baseBottom - size);
            }
          }), _defineProperty(_KIND_PROCESS_MAP, 3
          /* DrawIndicatorKind.bottomLeft */
          , {
            themeColor: function themeColor(helper) {
              return helper.theme.indicators.bottomLeftColor;
            },
            themeSize: function themeSize(helper) {
              return helper.theme.indicators.bottomLeftSize;
            },
            drawPath: function drawPath(ctx, rect, size) {
              var baseLeft = rect.left + 1;
              var baseBottom = rect.bottom - 2;
              ctx.moveTo(baseLeft, baseBottom);
              ctx.lineTo(baseLeft + size, baseBottom);
              ctx.lineTo(baseLeft, baseBottom - size);
            }
          }), _KIND_PROCESS_MAP);

          function drawTriangleIndicator(context, style, kind, helper) {
            var process = KIND_PROCESS_MAP[kind];

            if (!process) {
              return;
            }

            helper.drawBorderWithClip(context, function (ctx) {
              var rect = context.getRect();
              var color = style.color || helper.getColor(process.themeColor(helper), context.col, context.row, ctx);
              var size = style.size && Number(style.size) || process.themeSize(helper) || rect.height / 6; // draw triangle

              ctx.fillStyle = color;
              ctx.beginPath();
              process.drawPath(ctx, rect, size);
              ctx.closePath();
              ctx.fill();
            });
          }

          exports.drawTriangleIndicator = drawTriangleIndicator;
          /***/
        },

        /***/
        "./columns/message/BaseMessage.js":
        /*!****************************************!*\
          !*** ./columns/message/BaseMessage.js ***!
          \****************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageBaseMessageJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseMessage = void 0;

          var BaseMessage = /*#__PURE__*/function () {
            function BaseMessage(grid) {
              _classCallCheck(this, BaseMessage);

              this._messageElement = null;
              this._grid = grid;
            }

            _createClass(BaseMessage, [{
              key: "dispose",
              value: function dispose() {
                this.detachMessageElement();

                if (this._messageElement) {
                  this._messageElement.dispose();
                }

                this._messageElement = null;
              }
            }, {
              key: "_getMessageElement",
              value: function _getMessageElement() {
                return this._messageElement || (this._messageElement = this.createMessageElementInternal());
              }
            }, {
              key: "attachMessageElement",
              value: function attachMessageElement(col, row, message) {
                var messageElement = this._getMessageElement();

                messageElement.attach(this._grid, col, row, message);
              }
            }, {
              key: "moveMessageElement",
              value: function moveMessageElement(col, row) {
                var messageElement = this._getMessageElement();

                messageElement.move(this._grid, col, row);
              }
            }, {
              key: "detachMessageElement",
              value: function detachMessageElement() {
                var messageElement = this._getMessageElement();

                messageElement._detach();
              }
            }, {
              key: "drawCellMessage",
              value: function drawCellMessage(message, context, style, helper, grid, info) {
                this.drawCellMessageInternal(message, context, style, helper, grid, info);
              }
            }]);

            return BaseMessage;
          }();

          exports.BaseMessage = BaseMessage;
          /***/
        },

        /***/
        "./columns/message/ErrorMessage.js":
        /*!*****************************************!*\
          !*** ./columns/message/ErrorMessage.js ***!
          \*****************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageErrorMessageJs(module, exports, __nested_webpack_require_330405__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ErrorMessage = void 0;

          var messageUtils = __importStar(__nested_webpack_require_330405__(
          /*! ./messageUtils */
          "./columns/message/messageUtils.js"));

          var BaseMessage_1 = __nested_webpack_require_330405__(
          /*! ./BaseMessage */
          "./columns/message/BaseMessage.js");

          var ErrorMessageElement_1 = __nested_webpack_require_330405__(
          /*! ./internal/ErrorMessageElement */
          "./columns/message/internal/ErrorMessageElement.js");

          var utils_1 = __nested_webpack_require_330405__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var RED_A100 = "#ff8a80";

          var ErrorMessage = /*#__PURE__*/function (_BaseMessage_1$BaseMe) {
            _inherits(ErrorMessage, _BaseMessage_1$BaseMe);

            var _super15 = _createSuper(ErrorMessage);

            function ErrorMessage() {
              _classCallCheck(this, ErrorMessage);

              return _super15.apply(this, arguments);
            }

            _createClass(ErrorMessage, [{
              key: "createMessageElementInternal",
              value: function createMessageElementInternal() {
                return new ErrorMessageElement_1.ErrorMessageElement();
              }
            }, {
              key: "drawCellMessageInternal",
              value: function drawCellMessageInternal(_message, context, style, helper, grid, _info) {
                var bgColor = style.bgColor;

                var _context$getSelection = context.getSelection(),
                    select = _context$getSelection.select;

                if (!(0, utils_1.cellInRange)(grid.getCellRange(context.col, context.row), select.col, select.row) || !grid.hasFocusGrid()) {
                  helper.drawBorderWithClip(context, function (ctx) {
                    messageUtils.drawExclamationMarkBox(context, {
                      bgColor: helper.getColor(helper.theme.messages.errorBgColor, context.col, context.row, ctx) || RED_A100,
                      color: bgColor,
                      boxWidth: helper.theme.messages.boxWidth,
                      markHeight: helper.theme.messages.markHeight
                    }, helper);
                  });
                }
              }
            }]);

            return ErrorMessage;
          }(BaseMessage_1.BaseMessage);

          exports.ErrorMessage = ErrorMessage;
          /***/
        },

        /***/
        "./columns/message/InfoMessage.js":
        /*!****************************************!*\
          !*** ./columns/message/InfoMessage.js ***!
          \****************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageInfoMessageJs(module, exports, __nested_webpack_require_334755__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InfoMessage = void 0;

          var messageUtils = __importStar(__nested_webpack_require_334755__(
          /*! ./messageUtils */
          "./columns/message/messageUtils.js"));

          var BaseMessage_1 = __nested_webpack_require_334755__(
          /*! ./BaseMessage */
          "./columns/message/BaseMessage.js");

          var MessageElement_1 = __nested_webpack_require_334755__(
          /*! ./internal/MessageElement */
          "./columns/message/internal/MessageElement.js");

          var utils_1 = __nested_webpack_require_334755__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var GREY_L2 = "#e0e0e0";

          var InfoMessage = /*#__PURE__*/function (_BaseMessage_1$BaseMe2) {
            _inherits(InfoMessage, _BaseMessage_1$BaseMe2);

            var _super16 = _createSuper(InfoMessage);

            function InfoMessage() {
              _classCallCheck(this, InfoMessage);

              return _super16.apply(this, arguments);
            }

            _createClass(InfoMessage, [{
              key: "createMessageElementInternal",
              value: function createMessageElementInternal() {
                return new MessageElement_1.MessageElement();
              }
            }, {
              key: "drawCellMessageInternal",
              value: function drawCellMessageInternal(_message, context, style, helper, grid, _info) {
                var bgColor = style.bgColor;

                var _context$getSelection2 = context.getSelection(),
                    select = _context$getSelection2.select;

                if (!(0, utils_1.cellInRange)(grid.getCellRange(context.col, context.row), select.col, select.row) || !grid.hasFocusGrid()) {
                  helper.drawBorderWithClip(context, function (ctx) {
                    messageUtils.drawInformationMarkBox(context, {
                      bgColor: helper.getColor(helper.theme.messages.infoBgColor, context.col, context.row, ctx) || GREY_L2,
                      color: bgColor,
                      boxWidth: helper.theme.messages.boxWidth,
                      markHeight: helper.theme.messages.markHeight
                    }, helper);
                  });
                }
              }
            }]);

            return InfoMessage;
          }(BaseMessage_1.BaseMessage);

          exports.InfoMessage = InfoMessage;
          /***/
        },

        /***/
        "./columns/message/MessageHandler.js":
        /*!*******************************************!*\
          !*** ./columns/message/MessageHandler.js ***!
          \*******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageMessageHandlerJs(module, exports, __nested_webpack_require_339086__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MessageHandler = exports.hasMessage = void 0;

          var ErrorMessage_1 = __nested_webpack_require_339086__(
          /*! ./ErrorMessage */
          "./columns/message/ErrorMessage.js");

          var InfoMessage_1 = __nested_webpack_require_339086__(
          /*! ./InfoMessage */
          "./columns/message/InfoMessage.js");

          var LG_EVENT_TYPE_1 = __nested_webpack_require_339086__(
          /*! ../../list-grid/LG_EVENT_TYPE */
          "./list-grid/LG_EVENT_TYPE.js");

          var WarningMessage_1 = __nested_webpack_require_339086__(
          /*! ./WarningMessage */
          "./columns/message/WarningMessage.js");

          var utils_1 = __nested_webpack_require_339086__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var EMPTY_MESSAGE = {
            type: "error",
            message: null
          };
          var MESSAGE_INSTANCE_FACTORY = {
            error: function error(grid) {
              return new ErrorMessage_1.ErrorMessage(grid);
            },
            info: function info(grid) {
              return new InfoMessage_1.InfoMessage(grid);
            },
            warning: function warning(grid) {
              return new WarningMessage_1.WarningMessage(grid);
            }
          };

          function normalizeMessage(message) {
            if (!message || (0, utils_1.isPromise)(message)) {
              return EMPTY_MESSAGE;
            }

            if (typeof message === "string") {
              return {
                type: "error",
                message: message,
                original: message
              };
            }

            var type = message.type || "error";

            if (type && type in MESSAGE_INSTANCE_FACTORY) {
              return {
                type: type.toLowerCase(),
                message: message.message,
                original: message
              };
            }

            return {
              type: "error",
              // eslint-disable-next-line @typescript-eslint/restrict-template-expressions
              message: "".concat(message),
              original: message
            };
          }

          function hasMessage(message) {
            return !!normalizeMessage(message).message;
          }

          exports.hasMessage = hasMessage;

          var MessageHandler = /*#__PURE__*/function () {
            function MessageHandler(grid, getMessage) {
              _classCallCheck(this, MessageHandler);

              this._attachInfo = null;
              this._grid = grid;
              this._messageInstances = {};

              this._bindGridEvent(grid, getMessage);
            }

            _createClass(MessageHandler, [{
              key: "dispose",
              value: function dispose() {
                var _a;

                var messageInstances = this._messageInstances;

                for (var k in messageInstances) {
                  (_a = messageInstances[k]) === null || _a === void 0 ? void 0 : _a.dispose();
                } // @ts-expect-error -- ignore


                delete this._messageInstances; // @ts-expect-error -- ignore

                delete this._attachInfo;
              }
            }, {
              key: "drawCellMessage",
              value: function drawCellMessage(message, context, style, helper, grid, info) {
                if (!hasMessage(message)) {
                  return;
                }

                var instance = this._getMessageInstanceOfMessage(message);

                instance.drawCellMessage(normalizeMessage(message), context, style, helper, grid, info);
              }
            }, {
              key: "_attach",
              value: function _attach(col, row, message) {
                var info = this._attachInfo;

                var instance = this._getMessageInstanceOfMessage(message);

                if (info && info.instance !== instance) {
                  info.instance.detachMessageElement();
                }

                instance.attachMessageElement(col, row, normalizeMessage(message));
                this._attachInfo = {
                  col: col,
                  row: row,
                  instance: instance
                };
              }
            }, {
              key: "_move",
              value: function _move(col, row) {
                var info = this._attachInfo;

                if (!info || info.col !== col || info.row !== row) {
                  return;
                }

                var instance = info.instance;
                instance.moveMessageElement(col, row);
              }
            }, {
              key: "_detach",
              value: function _detach() {
                var info = this._attachInfo;

                if (!info) {
                  return;
                }

                var instance = info.instance;
                instance.detachMessageElement();
                this._attachInfo = null;
              }
            }, {
              key: "_bindGridEvent",
              value: function _bindGridEvent(grid, getMessage) {
                var _this38 = this;

                var onSelectMessage = function onSelectMessage(sel) {
                  var setMessageData = function setMessageData(msg) {
                    if (!hasMessage(msg)) {
                      _this38._detach();
                    } else {
                      _this38._attach(sel.col, sel.row, msg);
                    }
                  };

                  var message = getMessage(sel.col, sel.row);

                  if ((0, utils_1.isPromise)(message)) {
                    _this38._detach();

                    message.then(function (msg) {
                      var newSel = grid.selection.select;

                      if (newSel.col !== sel.col || newSel.row !== sel.row) {
                        return;
                      }

                      setMessageData(msg);
                    });
                    return;
                  }

                  setMessageData(message);
                };

                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.SELECTED_CELL, function (e) {
                  if (!e.selected) {
                    return;
                  }

                  if (e.before.col === e.col && e.before.row === e.row) {
                    return;
                  }

                  onSelectMessage(e);
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.SCROLL, function () {
                  var sel = grid.selection.select;

                  _this38._move(sel.col, sel.row);
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.CHANGED_VALUE, function (e) {
                  if (!grid.hasFocusGrid()) {
                    return;
                  }

                  var sel = grid.selection.select;

                  if (sel.col !== e.col || sel.row !== e.row) {
                    return;
                  }

                  onSelectMessage(e);
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.FOCUS_GRID, function (_e) {
                  var sel = grid.selection.select;
                  onSelectMessage(sel);
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.BLUR_GRID, function (_e) {
                  _this38._detach();
                });
              }
            }, {
              key: "_getMessageInstanceOfMessage",
              value: function _getMessageInstanceOfMessage(message) {
                var messageInstances = this._messageInstances;

                var _normalizeMessage = normalizeMessage(message),
                    type = _normalizeMessage.type;

                return messageInstances[type] || (messageInstances[type] = MESSAGE_INSTANCE_FACTORY[type](this._grid));
              }
            }]);

            return MessageHandler;
          }();

          exports.MessageHandler = MessageHandler;
          /***/
        },

        /***/
        "./columns/message/WarningMessage.js":
        /*!*******************************************!*\
          !*** ./columns/message/WarningMessage.js ***!
          \*******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageWarningMessageJs(module, exports, __nested_webpack_require_347626__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.WarningMessage = void 0;

          var messageUtils = __importStar(__nested_webpack_require_347626__(
          /*! ./messageUtils */
          "./columns/message/messageUtils.js"));

          var BaseMessage_1 = __nested_webpack_require_347626__(
          /*! ./BaseMessage */
          "./columns/message/BaseMessage.js");

          var WarningMessageElement_1 = __nested_webpack_require_347626__(
          /*! ./internal/WarningMessageElement */
          "./columns/message/internal/WarningMessageElement.js");

          var utils_1 = __nested_webpack_require_347626__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var DEEP_ORANGE_A100 = "#ff9e80";

          var WarningMessage = /*#__PURE__*/function (_BaseMessage_1$BaseMe3) {
            _inherits(WarningMessage, _BaseMessage_1$BaseMe3);

            var _super17 = _createSuper(WarningMessage);

            function WarningMessage() {
              _classCallCheck(this, WarningMessage);

              return _super17.apply(this, arguments);
            }

            _createClass(WarningMessage, [{
              key: "createMessageElementInternal",
              value: function createMessageElementInternal() {
                return new WarningMessageElement_1.WarningMessageElement();
              }
            }, {
              key: "drawCellMessageInternal",
              value: function drawCellMessageInternal(_message, context, style, helper, grid, _info) {
                var bgColor = style.bgColor;

                var _context$getSelection3 = context.getSelection(),
                    select = _context$getSelection3.select;

                if (!(0, utils_1.cellInRange)(grid.getCellRange(context.col, context.row), select.col, select.row) || !grid.hasFocusGrid()) {
                  helper.drawBorderWithClip(context, function (ctx) {
                    messageUtils.drawExclamationMarkBox(context, {
                      bgColor: helper.getColor(helper.theme.messages.warnBgColor, context.col, context.row, ctx) || DEEP_ORANGE_A100,
                      color: bgColor,
                      boxWidth: helper.theme.messages.boxWidth,
                      markHeight: helper.theme.messages.markHeight
                    }, helper);
                  });
                }
              }
            }]);

            return WarningMessage;
          }(BaseMessage_1.BaseMessage);

          exports.WarningMessage = WarningMessage;
          /***/
        },

        /***/
        "./columns/message/internal/ErrorMessageElement.js":
        /*!*********************************************************!*\
          !*** ./columns/message/internal/ErrorMessageElement.js ***!
          \*********************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageInternalErrorMessageElementJs(module, exports, __nested_webpack_require_352109__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ErrorMessageElement = void 0;

          var MessageElement_1 = __nested_webpack_require_352109__(
          /*! ./MessageElement */
          "./columns/message/internal/MessageElement.js");

          var CLASSNAME = "cheetah-grid__error-message-element";
          var MESSAGE_CLASSNAME = "".concat(CLASSNAME, "__message");

          var ErrorMessageElement = /*#__PURE__*/function (_MessageElement_1$Mes) {
            _inherits(ErrorMessageElement, _MessageElement_1$Mes);

            var _super18 = _createSuper(ErrorMessageElement);

            function ErrorMessageElement() {
              var _this39;

              _classCallCheck(this, ErrorMessageElement);

              _this39 = _super18.call(this);

              __nested_webpack_require_352109__(
              /*! @/columns/message/internal/ErrorMessageElement.css */
              "../src/js/columns/message/internal/ErrorMessageElement.css");

              _this39._rootElement.classList.add(CLASSNAME);

              _this39._messageElement.classList.add(MESSAGE_CLASSNAME);

              return _this39;
            }

            return ErrorMessageElement;
          }(MessageElement_1.MessageElement);

          exports.ErrorMessageElement = ErrorMessageElement;
          /***/
        },

        /***/
        "./columns/message/internal/MessageElement.js":
        /*!****************************************************!*\
          !*** ./columns/message/internal/MessageElement.js ***!
          \****************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageInternalMessageElementJs(module, exports, __nested_webpack_require_353993__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MessageElement = void 0;

          var EventHandler_1 = __nested_webpack_require_353993__(
          /*! ../../../internal/EventHandler */
          "./internal/EventHandler.js");

          var dom_1 = __nested_webpack_require_353993__(
          /*! ../../../internal/dom */
          "./internal/dom.js");

          var CLASSNAME = "cheetah-grid__message-element";
          var MESSAGE_CLASSNAME = "".concat(CLASSNAME, "__message");
          var HIDDEN_CLASSNAME = "".concat(CLASSNAME, "--hidden");
          var SHOWN_CLASSNAME = "".concat(CLASSNAME, "--shown");
          var LEFT_DIFF_CSS_PROP_NAME = "--cheetah-grid-message-element-left-diff";

          function createMessageDomElement() {
            __nested_webpack_require_353993__(
            /*! @/columns/message/internal/MessageElement.css */
            "../src/js/columns/message/internal/MessageElement.css");

            var rootElement = (0, dom_1.createElement)("div", {
              classList: [CLASSNAME, HIDDEN_CLASSNAME]
            });
            var messageElement = (0, dom_1.createElement)("span", {
              classList: [MESSAGE_CLASSNAME]
            });
            rootElement.appendChild(messageElement);
            return rootElement;
          }

          var MessageElement = /*#__PURE__*/function () {
            function MessageElement() {
              _classCallCheck(this, MessageElement);

              this._handler = new EventHandler_1.EventHandler();
              var rootElement = this._rootElement = createMessageDomElement();
              this._messageElement = rootElement.querySelector(".".concat(MESSAGE_CLASSNAME));
            }

            _createClass(MessageElement, [{
              key: "dispose",
              value: function dispose() {
                this.detach();

                this._handler.dispose(); // @ts-expect-error -- ignore


                delete this._rootElement; // @ts-expect-error -- ignore

                delete this._messageElement;
              }
            }, {
              key: "attach",
              value: function attach(grid, col, row, message) {
                var rootElement = this._rootElement;
                var messageElement = this._messageElement;
                rootElement.classList.remove(SHOWN_CLASSNAME);
                rootElement.classList.add(HIDDEN_CLASSNAME);

                if (this._attachCell(grid, col, row)) {
                  rootElement.classList.add(SHOWN_CLASSNAME);
                  rootElement.classList.remove(HIDDEN_CLASSNAME);
                  messageElement.textContent = message.message;

                  this._adjustStyle(grid, col, row);
                } else {
                  this._detach();
                }
              }
            }, {
              key: "move",
              value: function move(grid, col, row) {
                var rootElement = this._rootElement;

                if (this._attachCell(grid, col, row)) {
                  rootElement.classList.add(SHOWN_CLASSNAME);
                  rootElement.classList.remove(HIDDEN_CLASSNAME);
                } else {
                  this._detach();
                }
              }
            }, {
              key: "detach",
              value: function detach() {
                this._detach();
              }
            }, {
              key: "_detach",
              value: function _detach() {
                var rootElement = this._rootElement;

                if (rootElement.parentElement) {
                  rootElement.parentElement.removeChild(rootElement);
                  rootElement.classList.remove(SHOWN_CLASSNAME);
                  rootElement.classList.add(HIDDEN_CLASSNAME);
                }
              }
            }, {
              key: "_attachCell",
              value: function _attachCell(grid, col, row) {
                var rootElement = this._rootElement;

                var _grid$getAttachCellsA4 = grid.getAttachCellsArea(grid.getCellRange(col, row)),
                    element = _grid$getAttachCellsA4.element,
                    rect = _grid$getAttachCellsA4.rect;

                var top = rect.bottom,
                    left = rect.left,
                    width = rect.width;
                var frozenRowCount = grid.frozenRowCount,
                    frozenColCount = grid.frozenColCount;

                if (row >= frozenRowCount && frozenRowCount > 0) {
                  var _grid$getAttachCellsA5 = grid.getAttachCellsArea(grid.getCellRange(col, frozenRowCount - 1)),
                      frozenRect = _grid$getAttachCellsA5.rect;

                  if (top < frozenRect.bottom) {
                    return false; // Outside the rectangle.
                  }
                } else {
                  if (top < 0) {
                    return false; // Outside the rectangle.
                  }
                }

                if (col >= frozenColCount && frozenColCount > 0) {
                  var _grid$getAttachCellsA6 = grid.getAttachCellsArea(grid.getCellRange(frozenColCount - 1, row)),
                      _frozenRect = _grid$getAttachCellsA6.rect;

                  if (left < _frozenRect.right) {
                    return false; // Outside the rectangle.
                  }
                } else {
                  if (left < 0) {
                    return false; // Outside the rectangle.
                  }
                }

                var offsetHeight = element.offsetHeight,
                    offsetWidth = element.offsetWidth;

                if (offsetHeight < top) {
                  return false; // Outside the rectangle.
                }

                if (offsetWidth < left) {
                  return false; // Outside the rectangle.
                }

                rootElement.style.top = "".concat(top.toFixed(), "px");
                rootElement.style.left = "".concat(left.toFixed(), "px");
                rootElement.style.width = "".concat(width.toFixed(), "px");

                if (rootElement.parentElement !== element) {
                  element.appendChild(rootElement);
                }

                return true;
              }
              /**
               * If the message is placed outside the Grid, adjust its position.
               */

            }, {
              key: "_adjustStyle",
              value: function _adjustStyle(grid, col, row) {
                var rootElement = this._rootElement;
                var element = grid.getElement();
                var messageRect = rootElement.getBoundingClientRect();
                var elementRect = element.getBoundingClientRect();
                var messageLeft = messageRect.left;

                if (elementRect.right < messageRect.right) {
                  var overflow = messageRect.right - elementRect.right;
                  messageLeft -= overflow;
                }

                if (messageLeft < elementRect.left) {
                  messageLeft = elementRect.left;
                }

                if (messageLeft !== messageRect.left) {
                  var diff = messageRect.left - messageLeft;

                  var _grid$getAttachCellsA7 = grid.getAttachCellsArea(grid.getCellRange(col, row)),
                      rect = _grid$getAttachCellsA7.rect;

                  rootElement.style.left = "".concat((rect.left - diff).toFixed(), "px");
                  var diffCss = "".concat(diff.toFixed(), "px");
                  rootElement.style.setProperty(LEFT_DIFF_CSS_PROP_NAME, diffCss);
                } else {
                  rootElement.style.removeProperty(LEFT_DIFF_CSS_PROP_NAME);
                }
              }
            }]);

            return MessageElement;
          }();

          exports.MessageElement = MessageElement;
          /***/
        },

        /***/
        "./columns/message/internal/WarningMessageElement.js":
        /*!***********************************************************!*\
          !*** ./columns/message/internal/WarningMessageElement.js ***!
          \***********************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageInternalWarningMessageElementJs(module, exports, __nested_webpack_require_362441__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.WarningMessageElement = void 0;

          var MessageElement_1 = __nested_webpack_require_362441__(
          /*! ./MessageElement */
          "./columns/message/internal/MessageElement.js");

          var CLASSNAME = "cheetah-grid__warning-message-element";
          var MESSAGE_CLASSNAME = "".concat(CLASSNAME, "__message");

          var WarningMessageElement = /*#__PURE__*/function (_MessageElement_1$Mes2) {
            _inherits(WarningMessageElement, _MessageElement_1$Mes2);

            var _super19 = _createSuper(WarningMessageElement);

            function WarningMessageElement() {
              var _this40;

              _classCallCheck(this, WarningMessageElement);

              _this40 = _super19.call(this);

              __nested_webpack_require_362441__(
              /*! @/columns/message/internal/WarningMessageElement.css */
              "../src/js/columns/message/internal/WarningMessageElement.css");

              _this40._rootElement.classList.add(CLASSNAME);

              _this40._messageElement.classList.add(MESSAGE_CLASSNAME);

              return _this40;
            }

            return WarningMessageElement;
          }(MessageElement_1.MessageElement);

          exports.WarningMessageElement = WarningMessageElement;
          /***/
        },

        /***/
        "./columns/message/messageUtils.js":
        /*!*****************************************!*\
          !*** ./columns/message/messageUtils.js ***!
          \*****************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsMessageMessageUtilsJs(module, exports, __nested_webpack_require_364297__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.drawInformationMarkBox = exports.drawExclamationMarkBox = void 0;

          var Rect_1 = __nested_webpack_require_364297__(
          /*! ../../internal/Rect */
          "./internal/Rect.js");

          function drawExclamationMarkBox(context, style, helper) {
            var bgColor = style.bgColor,
                color = style.color,
                boxWidth = style.boxWidth,
                markHeight = style.markHeight;
            var ctx = context.getContext();
            var rect = context.getRect(); // draw box

            ctx.fillStyle = bgColor;
            var boxRect = rect.copy();
            boxRect.left = boxRect.right - (Number(boxWidth) || 24);
            ctx.fillRect(boxRect.left, boxRect.top, boxRect.width, boxRect.height - 1); // draw exclamation mark

            var fillColor = color;
            var height = Number(markHeight) || 20;
            var width = height / 5;
            var left = boxRect.left + (boxRect.width - width) / 2;
            var top = boxRect.top + (boxRect.height - height) / 2;
            helper.fillRectWithState(new Rect_1.Rect(left, top, width, height / 5 * 3), context, {
              fillColor: fillColor
            });
            helper.fillRectWithState(new Rect_1.Rect(left, top + height / 5 * 4, width, height / 5), context, {
              fillColor: fillColor
            });
          }

          exports.drawExclamationMarkBox = drawExclamationMarkBox;

          function drawInformationMarkBox(context, style, helper) {
            var bgColor = style.bgColor,
                color = style.color,
                boxWidth = style.boxWidth,
                markHeight = style.markHeight;
            var ctx = context.getContext();
            var rect = context.getRect(); // draw box

            ctx.fillStyle = bgColor;
            var boxRect = rect.copy();
            boxRect.left = boxRect.right - (Number(boxWidth) || 24);
            ctx.fillRect(boxRect.left, boxRect.top, boxRect.width, boxRect.height - 1); // draw i mark

            var fillColor = color;
            var height = Number(markHeight) || 20;
            var width = height / 5;
            var left = boxRect.left + (boxRect.width - width) / 2;
            var top = boxRect.top + (boxRect.height - height) / 2;
            helper.fillRectWithState(new Rect_1.Rect(left, top, width, height / 5), context, {
              fillColor: fillColor
            });
            helper.fillRectWithState(new Rect_1.Rect(left, top + height / 5 * 2, width, height / 5 * 3), context, {
              fillColor: fillColor
            });
          }

          exports.drawInformationMarkBox = drawInformationMarkBox;
          /***/
        },

        /***/
        "./columns/style.js":
        /*!**************************!*\
          !*** ./columns/style.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleJs(module, exports, __nested_webpack_require_367492__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.of = exports.TreeStyle = exports.MenuStyle = exports.MultilineTextStyle = exports.PercentCompleteBarStyle = exports.IconStyle = exports.ImageStyle = exports.ButtonStyle = exports.RadioStyle = exports.CheckStyle = exports.NumberStyle = exports.Style = exports.BaseStyle = exports.EVENT_TYPE = void 0;

          var BaseStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/BaseStyle */
          "./columns/style/BaseStyle.js");

          Object.defineProperty(exports, "BaseStyle", {
            enumerable: true,
            get: function get() {
              return BaseStyle_1.BaseStyle;
            }
          });

          var ButtonStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/ButtonStyle */
          "./columns/style/ButtonStyle.js");

          Object.defineProperty(exports, "ButtonStyle", {
            enumerable: true,
            get: function get() {
              return ButtonStyle_1.ButtonStyle;
            }
          });

          var CheckStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/CheckStyle */
          "./columns/style/CheckStyle.js");

          Object.defineProperty(exports, "CheckStyle", {
            enumerable: true,
            get: function get() {
              return CheckStyle_1.CheckStyle;
            }
          });

          var IconStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/IconStyle */
          "./columns/style/IconStyle.js");

          Object.defineProperty(exports, "IconStyle", {
            enumerable: true,
            get: function get() {
              return IconStyle_1.IconStyle;
            }
          });

          var ImageStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/ImageStyle */
          "./columns/style/ImageStyle.js");

          Object.defineProperty(exports, "ImageStyle", {
            enumerable: true,
            get: function get() {
              return ImageStyle_1.ImageStyle;
            }
          });

          var MenuStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/MenuStyle */
          "./columns/style/MenuStyle.js");

          Object.defineProperty(exports, "MenuStyle", {
            enumerable: true,
            get: function get() {
              return MenuStyle_1.MenuStyle;
            }
          });

          var MultilineTextStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/MultilineTextStyle */
          "./columns/style/MultilineTextStyle.js");

          Object.defineProperty(exports, "MultilineTextStyle", {
            enumerable: true,
            get: function get() {
              return MultilineTextStyle_1.MultilineTextStyle;
            }
          });

          var NumberStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/NumberStyle */
          "./columns/style/NumberStyle.js");

          Object.defineProperty(exports, "NumberStyle", {
            enumerable: true,
            get: function get() {
              return NumberStyle_1.NumberStyle;
            }
          });

          var PercentCompleteBarStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/PercentCompleteBarStyle */
          "./columns/style/PercentCompleteBarStyle.js");

          Object.defineProperty(exports, "PercentCompleteBarStyle", {
            enumerable: true,
            get: function get() {
              return PercentCompleteBarStyle_1.PercentCompleteBarStyle;
            }
          });

          var RadioStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/RadioStyle */
          "./columns/style/RadioStyle.js");

          Object.defineProperty(exports, "RadioStyle", {
            enumerable: true,
            get: function get() {
              return RadioStyle_1.RadioStyle;
            }
          });

          var Style_1 = __nested_webpack_require_367492__(
          /*! ./style/Style */
          "./columns/style/Style.js");

          Object.defineProperty(exports, "Style", {
            enumerable: true,
            get: function get() {
              return Style_1.Style;
            }
          });

          var TreeStyle_1 = __nested_webpack_require_367492__(
          /*! ./style/TreeStyle */
          "./columns/style/TreeStyle.js");

          Object.defineProperty(exports, "TreeStyle", {
            enumerable: true,
            get: function get() {
              return TreeStyle_1.TreeStyle;
            }
          });
          var EVENT_TYPE = BaseStyle_1.BaseStyle.EVENT_TYPE;
          exports.EVENT_TYPE = EVENT_TYPE;

          function of(columnStyle, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          record) {
            var StyleClassDef = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : Style_1.Style;

            if (columnStyle) {
              if (columnStyle instanceof BaseStyle_1.BaseStyle) {
                return columnStyle;
              } else if (typeof columnStyle === "function") {
                return of(columnStyle(record), record, StyleClassDef);
              } else if (record && columnStyle in record) {
                return of(record[columnStyle], record, StyleClassDef);
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any


              return new StyleClassDef(columnStyle);
            } else {
              return StyleClassDef.DEFAULT;
            }
          }

          exports.of = of;
          /***/
        },

        /***/
        "./columns/style/BaseStyle.js":
        /*!************************************!*\
          !*** ./columns/style/BaseStyle.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleBaseStyleJs(module, exports, __nested_webpack_require_373374__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseStyle = void 0;

          var EventTarget_1 = __nested_webpack_require_373374__(
          /*! ../../core/EventTarget */
          "./core/EventTarget.js");

          var STYLE_EVENT_TYPE = {
            CHANGE_STYLE: "change_style"
          };
          var defaultStyle;

          var BaseStyle = /*#__PURE__*/function (_EventTarget_1$EventT) {
            _inherits(BaseStyle, _EventTarget_1$EventT);

            var _super20 = _createSuper(BaseStyle);

            function BaseStyle() {
              var _this41;

              var _ref26 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
                  bgColor = _ref26.bgColor,
                  visibility = _ref26.visibility,
                  indicatorTopLeft = _ref26.indicatorTopLeft,
                  indicatorTopRight = _ref26.indicatorTopRight,
                  indicatorBottomRight = _ref26.indicatorBottomRight,
                  indicatorBottomLeft = _ref26.indicatorBottomLeft;

              _classCallCheck(this, BaseStyle);

              _this41 = _super20.call(this);
              _this41._bgColor = bgColor;
              _this41._visibility = normalizeVisibility(visibility, undefined);
              _this41._indicatorTopLeft = normalizeIndicator(indicatorTopLeft);
              _this41._indicatorTopRight = normalizeIndicator(indicatorTopRight);
              _this41._indicatorBottomRight = normalizeIndicator(indicatorBottomRight);
              _this41._indicatorBottomLeft = normalizeIndicator(indicatorBottomLeft);
              return _this41;
            }

            _createClass(BaseStyle, [{
              key: "bgColor",
              get: function get() {
                return this._bgColor;
              },
              set: function set(bgColor) {
                this._bgColor = bgColor;
                this.doChangeStyle();
              }
            }, {
              key: "visibility",
              get: function get() {
                return this._visibility;
              },
              set: function set(visibility) {
                var normalized = normalizeVisibility(visibility, this._visibility);

                if (this._visibility === normalized) {
                  return;
                }

                this._visibility = normalized;
                this.doChangeStyle();
              }
            }, {
              key: "indicatorTopLeft",
              get: function get() {
                return this._indicatorTopLeft;
              },
              set: function set(indicatorTopLeft) {
                this._indicatorTopLeft = normalizeIndicator(indicatorTopLeft);
                this.doChangeStyle();
              }
            }, {
              key: "indicatorTopRight",
              get: function get() {
                return this._indicatorTopRight;
              },
              set: function set(indicatorTopRight) {
                this._indicatorTopRight = normalizeIndicator(indicatorTopRight);
                this.doChangeStyle();
              }
            }, {
              key: "indicatorBottomRight",
              get: function get() {
                return this._indicatorBottomRight;
              },
              set: function set(indicatorBottomRight) {
                this._indicatorBottomRight = normalizeIndicator(indicatorBottomRight);
                this.doChangeStyle();
              }
            }, {
              key: "indicatorBottomLeft",
              get: function get() {
                return this._indicatorBottomLeft;
              },
              set: function set(indicatorBottomLeft) {
                this._indicatorBottomLeft = normalizeIndicator(indicatorBottomLeft);
                this.doChangeStyle();
              }
            }, {
              key: "doChangeStyle",
              value: function doChangeStyle() {
                this.fireListeners(STYLE_EVENT_TYPE.CHANGE_STYLE);
              }
            }, {
              key: "clone",
              value: function clone() {
                return new BaseStyle(this);
              }
            }], [{
              key: "EVENT_TYPE",
              get: function get() {
                return STYLE_EVENT_TYPE;
              }
            }, {
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new BaseStyle();
              }
            }]);

            return BaseStyle;
          }(EventTarget_1.EventTarget);

          exports.BaseStyle = BaseStyle;

          function normalizeIndicator(indicator) {
            if (typeof indicator === "string") {
              return {
                style: indicator
              };
            }

            return indicator;
          }

          function normalizeVisibility(visibility, defaultValue) {
            if (visibility && visibility !== "visible" && visibility !== "hidden") {
              return defaultValue;
            }

            return visibility;
          }
          /***/

        },

        /***/
        "./columns/style/BranchGraphStyle.js":
        /*!*******************************************!*\
          !*** ./columns/style/BranchGraphStyle.js ***!
          \*******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleBranchGraphStyleJs(module, exports, __nested_webpack_require_379008__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BranchGraphStyle = void 0;

          var BaseStyle_1 = __nested_webpack_require_379008__(
          /*! ./BaseStyle */
          "./columns/style/BaseStyle.js");

          var defaultStyle;

          var DEFAULT_BRANCH_COLORS = function DEFAULT_BRANCH_COLORS(_name, index) {
            switch (index % 3) {
              case 0:
                return "#979797";

              case 1:
                return "#008fb5";

              case 2:
                return "#f1c109";

              default:
            }

            return "#979797";
          };

          var BranchGraphStyle = /*#__PURE__*/function (_BaseStyle_1$BaseStyl) {
            _inherits(BranchGraphStyle, _BaseStyle_1$BaseStyl);

            var _super21 = _createSuper(BranchGraphStyle);

            function BranchGraphStyle() {
              var _this42;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, BranchGraphStyle);

              _this42 = _super21.call(this, style);
              _this42._branchColors = style.branchColors || DEFAULT_BRANCH_COLORS;
              _this42._margin = style.margin || 4;
              _this42._circleSize = style.circleSize || 16;
              _this42._branchLineWidth = style.branchLineWidth || 4;
              _this42._mergeStyle = style.mergeStyle === "straight" ? "straight" : "bezier";
              return _this42;
            }

            _createClass(BranchGraphStyle, [{
              key: "branchColors",
              get: function get() {
                return this._branchColors;
              },
              set: function set(branchColors) {
                this._branchColors = branchColors;
                this.doChangeStyle();
              }
            }, {
              key: "margin",
              get: function get() {
                return this._margin;
              },
              set: function set(margin) {
                this._margin = margin;
                this.doChangeStyle();
              }
            }, {
              key: "circleSize",
              get: function get() {
                return this._circleSize;
              },
              set: function set(circleSize) {
                this._circleSize = circleSize;
                this.doChangeStyle();
              }
            }, {
              key: "branchLineWidth",
              get: function get() {
                return this._branchLineWidth;
              },
              set: function set(branchLineWidth) {
                this._branchLineWidth = branchLineWidth;
                this.doChangeStyle();
              }
            }, {
              key: "mergeStyle",
              get: function get() {
                return this._mergeStyle;
              },
              set: function set(mergeStyle) {
                this._mergeStyle = mergeStyle;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new BranchGraphStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new BranchGraphStyle();
              }
            }]);

            return BranchGraphStyle;
          }(BaseStyle_1.BaseStyle);

          exports.BranchGraphStyle = BranchGraphStyle;
          /***/
        },

        /***/
        "./columns/style/ButtonStyle.js":
        /*!**************************************!*\
          !*** ./columns/style/ButtonStyle.js ***!
          \**************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleButtonStyleJs(module, exports, __nested_webpack_require_383028__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ButtonStyle = void 0;

          var Style_1 = __nested_webpack_require_383028__(
          /*! ./Style */
          "./columns/style/Style.js");

          var utils_1 = __nested_webpack_require_383028__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var ButtonStyle = /*#__PURE__*/function (_Style_1$Style) {
            _inherits(ButtonStyle, _Style_1$Style);

            var _super22 = _createSuper(ButtonStyle);

            function ButtonStyle() {
              var _this43;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, ButtonStyle);

              _this43 = _super22.call(this, (0, utils_1.defaults)(style, {
                textAlign: "center"
              }));
              var buttonBgColor = style.buttonBgColor;
              _this43._buttonBgColor = buttonBgColor;
              return _this43;
            }

            _createClass(ButtonStyle, [{
              key: "buttonBgColor",
              get: function get() {
                return this._buttonBgColor;
              },
              set: function set(buttonBgColor) {
                this._buttonBgColor = buttonBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new ButtonStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new ButtonStyle();
              }
            }]);

            return ButtonStyle;
          }(Style_1.Style);

          exports.ButtonStyle = ButtonStyle;
          /***/
        },

        /***/
        "./columns/style/CheckStyle.js":
        /*!*************************************!*\
          !*** ./columns/style/CheckStyle.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleCheckStyleJs(module, exports, __nested_webpack_require_385363__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.CheckStyle = void 0;

          var StdBaseStyle_1 = __nested_webpack_require_385363__(
          /*! ./StdBaseStyle */
          "./columns/style/StdBaseStyle.js");

          var utils_1 = __nested_webpack_require_385363__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var CheckStyle = /*#__PURE__*/function (_StdBaseStyle_1$StdBa) {
            _inherits(CheckStyle, _StdBaseStyle_1$StdBa);

            var _super23 = _createSuper(CheckStyle);

            function CheckStyle() {
              var _this44;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, CheckStyle);

              _this44 = _super23.call(this, (0, utils_1.defaults)(style, {
                textAlign: "center"
              }));
              var uncheckBgColor = style.uncheckBgColor,
                  checkBgColor = style.checkBgColor,
                  borderColor = style.borderColor;
              _this44._uncheckBgColor = uncheckBgColor;
              _this44._checkBgColor = checkBgColor;
              _this44._borderColor = borderColor;
              return _this44;
            }

            _createClass(CheckStyle, [{
              key: "uncheckBgColor",
              get: function get() {
                return this._uncheckBgColor;
              },
              set: function set(uncheckBgColor) {
                this._uncheckBgColor = uncheckBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "checkBgColor",
              get: function get() {
                return this._checkBgColor;
              },
              set: function set(checkBgColor) {
                this._checkBgColor = checkBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "borderColor",
              get: function get() {
                return this._borderColor;
              },
              set: function set(borderColor) {
                this._borderColor = borderColor;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new CheckStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new CheckStyle();
              }
            }]);

            return CheckStyle;
          }(StdBaseStyle_1.StdBaseStyle);

          exports.CheckStyle = CheckStyle;
          /***/
        },

        /***/
        "./columns/style/IconStyle.js":
        /*!************************************!*\
          !*** ./columns/style/IconStyle.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleIconStyleJs(module, exports, __nested_webpack_require_388542__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.IconStyle = void 0;

          var Style_1 = __nested_webpack_require_388542__(
          /*! ./Style */
          "./columns/style/Style.js");

          var utils_1 = __nested_webpack_require_388542__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var IconStyle = /*#__PURE__*/function (_Style_1$Style2) {
            _inherits(IconStyle, _Style_1$Style2);

            var _super24 = _createSuper(IconStyle);

            function IconStyle() {
              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, IconStyle);

              return _super24.call(this, (0, utils_1.defaults)(style, {
                textAlign: "center"
              }));
            }

            _createClass(IconStyle, [{
              key: "clone",
              value: function clone() {
                return new IconStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new IconStyle();
              }
            }]);

            return IconStyle;
          }(Style_1.Style);

          exports.IconStyle = IconStyle;
          /***/
        },

        /***/
        "./columns/style/ImageStyle.js":
        /*!*************************************!*\
          !*** ./columns/style/ImageStyle.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleImageStyleJs(module, exports, __nested_webpack_require_390379__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ImageStyle = void 0;

          var StdBaseStyle_1 = __nested_webpack_require_390379__(
          /*! ./StdBaseStyle */
          "./columns/style/StdBaseStyle.js");

          var utils_1 = __nested_webpack_require_390379__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var ImageStyle = /*#__PURE__*/function (_StdBaseStyle_1$StdBa2) {
            _inherits(ImageStyle, _StdBaseStyle_1$StdBa2);

            var _super25 = _createSuper(ImageStyle);

            function ImageStyle() {
              var _this45;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, ImageStyle);

              _this45 = _super25.call(this, (0, utils_1.defaults)(style, {
                textAlign: "center"
              }));
              _this45._imageSizing = style.imageSizing;
              _this45._margin = style.margin || 4;
              return _this45;
            }

            _createClass(ImageStyle, [{
              key: "imageSizing",
              get: function get() {
                return this._imageSizing;
              },
              set: function set(imageSizing) {
                this._imageSizing = imageSizing;
                this.doChangeStyle();
              }
            }, {
              key: "margin",
              get: function get() {
                return this._margin;
              },
              set: function set(margin) {
                this._margin = margin;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new ImageStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new ImageStyle();
              }
            }]);

            return ImageStyle;
          }(StdBaseStyle_1.StdBaseStyle);

          exports.ImageStyle = ImageStyle;
          /***/
        },

        /***/
        "./columns/style/MenuStyle.js":
        /*!************************************!*\
          !*** ./columns/style/MenuStyle.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleMenuStyleJs(module, exports, __nested_webpack_require_393007__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MenuStyle = void 0;

          var Style_1 = __nested_webpack_require_393007__(
          /*! ./Style */
          "./columns/style/Style.js");

          var defaultStyle;

          var MenuStyle = /*#__PURE__*/function (_Style_1$Style3) {
            _inherits(MenuStyle, _Style_1$Style3);

            var _super26 = _createSuper(MenuStyle);

            function MenuStyle() {
              var _this46;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, MenuStyle);

              _this46 = _super26.call(this, style);
              var appearance = style.appearance;
              _this46._appearance = appearance;
              return _this46;
            }

            _createClass(MenuStyle, [{
              key: "appearance",
              get: function get() {
                return this._appearance || "menulist-button";
              },
              set: function set(appearance) {
                this._appearance = appearance;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new MenuStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new MenuStyle();
              }
            }]);

            return MenuStyle;
          }(Style_1.Style);

          exports.MenuStyle = MenuStyle;
          /***/
        },

        /***/
        "./columns/style/MultilineTextStyle.js":
        /*!*********************************************!*\
          !*** ./columns/style/MultilineTextStyle.js ***!
          \*********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleMultilineTextStyleJs(module, exports, __nested_webpack_require_395158__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MultilineTextStyle = void 0;

          var Style_1 = __nested_webpack_require_395158__(
          /*! ./Style */
          "./columns/style/Style.js");

          var utils_1 = __nested_webpack_require_395158__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var MultilineTextStyle = /*#__PURE__*/function (_Style_1$Style4) {
            _inherits(MultilineTextStyle, _Style_1$Style4);

            var _super27 = _createSuper(MultilineTextStyle);

            function MultilineTextStyle() {
              var _this47;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, MultilineTextStyle);

              _this47 = _super27.call(this, (0, utils_1.defaults)(style, {
                textBaseline: "top"
              }));
              _this47._lineHeight = style.lineHeight || "1em";
              _this47._autoWrapText = style.autoWrapText || false;
              _this47._lineClamp = style.lineClamp;
              return _this47;
            }

            _createClass(MultilineTextStyle, [{
              key: "clone",
              value: function clone() {
                return new MultilineTextStyle(this);
              }
            }, {
              key: "lineHeight",
              get: function get() {
                return this._lineHeight;
              },
              set: function set(lineHeight) {
                this._lineHeight = lineHeight;
                this.doChangeStyle();
              }
            }, {
              key: "lineClamp",
              get: function get() {
                return this._lineClamp;
              },
              set: function set(lineClamp) {
                this._lineClamp = lineClamp;
                this.doChangeStyle();
              }
            }, {
              key: "autoWrapText",
              get: function get() {
                return this._autoWrapText;
              },
              set: function set(autoWrapText) {
                this._autoWrapText = autoWrapText;
                this.doChangeStyle();
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new MultilineTextStyle();
              }
            }]);

            return MultilineTextStyle;
          }(Style_1.Style);

          exports.MultilineTextStyle = MultilineTextStyle;
          /***/
        },

        /***/
        "./columns/style/NumberStyle.js":
        /*!**************************************!*\
          !*** ./columns/style/NumberStyle.js ***!
          \**************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleNumberStyleJs(module, exports, __nested_webpack_require_398229__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.NumberStyle = void 0;

          var Style_1 = __nested_webpack_require_398229__(
          /*! ./Style */
          "./columns/style/Style.js");

          var utils_1 = __nested_webpack_require_398229__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var NumberStyle = /*#__PURE__*/function (_Style_1$Style5) {
            _inherits(NumberStyle, _Style_1$Style5);

            var _super28 = _createSuper(NumberStyle);

            function NumberStyle() {
              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, NumberStyle);

              return _super28.call(this, (0, utils_1.defaults)(style, {
                textAlign: "right"
              }));
            }

            _createClass(NumberStyle, [{
              key: "clone",
              value: function clone() {
                return new NumberStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new NumberStyle();
              }
            }]);

            return NumberStyle;
          }(Style_1.Style);

          exports.NumberStyle = NumberStyle;
          /***/
        },

        /***/
        "./columns/style/PercentCompleteBarStyle.js":
        /*!**************************************************!*\
          !*** ./columns/style/PercentCompleteBarStyle.js ***!
          \**************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStylePercentCompleteBarStyleJs(module, exports, __nested_webpack_require_400154__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.PercentCompleteBarStyle = void 0;

          var Style_1 = __nested_webpack_require_400154__(
          /*! ./Style */
          "./columns/style/Style.js");

          var defaultStyle;

          var DEFAULT_BAR_COLOR = function DEFAULT_BAR_COLOR(num) {
            if (num > 80) {
              return "#20a8d8";
            }

            if (num > 50) {
              return "#4dbd74";
            }

            if (num > 20) {
              return "#ffc107";
            }

            return "#f86c6b";
          };

          var PercentCompleteBarStyle = /*#__PURE__*/function (_Style_1$Style6) {
            _inherits(PercentCompleteBarStyle, _Style_1$Style6);

            var _super29 = _createSuper(PercentCompleteBarStyle);

            function PercentCompleteBarStyle() {
              var _this48;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, PercentCompleteBarStyle);

              _this48 = _super29.call(this, style);
              _this48._barColor = style.barColor || DEFAULT_BAR_COLOR;
              _this48._barBgColor = style.barBgColor || "#f0f3f5";
              _this48._barHeight = style.barHeight || 3;
              return _this48;
            }

            _createClass(PercentCompleteBarStyle, [{
              key: "barColor",
              get: function get() {
                return this._barColor;
              },
              set: function set(barColor) {
                this._barColor = barColor;
                this.doChangeStyle();
              }
            }, {
              key: "barBgColor",
              get: function get() {
                return this._barBgColor;
              },
              set: function set(barBgColor) {
                this._barBgColor = barBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "barHeight",
              get: function get() {
                return this._barHeight;
              },
              set: function set(barHeight) {
                this._barHeight = barHeight;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new PercentCompleteBarStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new PercentCompleteBarStyle();
              }
            }]);

            return PercentCompleteBarStyle;
          }(Style_1.Style);

          exports.PercentCompleteBarStyle = PercentCompleteBarStyle;
          /***/
        },

        /***/
        "./columns/style/RadioStyle.js":
        /*!*************************************!*\
          !*** ./columns/style/RadioStyle.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleRadioStyleJs(module, exports, __nested_webpack_require_403414__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.RadioStyle = void 0;

          var StdBaseStyle_1 = __nested_webpack_require_403414__(
          /*! ./StdBaseStyle */
          "./columns/style/StdBaseStyle.js");

          var utils_1 = __nested_webpack_require_403414__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var RadioStyle = /*#__PURE__*/function (_StdBaseStyle_1$StdBa3) {
            _inherits(RadioStyle, _StdBaseStyle_1$StdBa3);

            var _super30 = _createSuper(RadioStyle);

            function RadioStyle() {
              var _this49;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, RadioStyle);

              _this49 = _super30.call(this, (0, utils_1.defaults)(style, {
                textAlign: "center"
              }));
              var checkColor = style.checkColor,
                  uncheckBorderColor = style.uncheckBorderColor,
                  checkBorderColor = style.checkBorderColor,
                  uncheckBgColor = style.uncheckBgColor,
                  checkBgColor = style.checkBgColor;
              _this49._checkColor = checkColor;
              _this49._uncheckBorderColor = uncheckBorderColor;
              _this49._checkBorderColor = checkBorderColor;
              _this49._uncheckBgColor = uncheckBgColor;
              _this49._checkBgColor = checkBgColor;
              return _this49;
            }

            _createClass(RadioStyle, [{
              key: "checkColor",
              get: function get() {
                return this._checkColor;
              },
              set: function set(checkColor) {
                this._checkColor = checkColor;
                this.doChangeStyle();
              }
            }, {
              key: "uncheckBorderColor",
              get: function get() {
                return this._uncheckBorderColor;
              },
              set: function set(uncheckBorderColor) {
                this._uncheckBorderColor = uncheckBorderColor;
                this.doChangeStyle();
              }
            }, {
              key: "checkBorderColor",
              get: function get() {
                return this._checkBorderColor;
              },
              set: function set(checkBorderColor) {
                this._checkBorderColor = checkBorderColor;
                this.doChangeStyle();
              }
            }, {
              key: "uncheckBgColor",
              get: function get() {
                return this._uncheckBgColor;
              },
              set: function set(uncheckBgColor) {
                this._uncheckBgColor = uncheckBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "checkBgColor",
              get: function get() {
                return this._checkBgColor;
              },
              set: function set(checkBgColor) {
                this._checkBgColor = checkBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new RadioStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new RadioStyle();
              }
            }]);

            return RadioStyle;
          }(StdBaseStyle_1.StdBaseStyle);

          exports.RadioStyle = RadioStyle;
          /***/
        },

        /***/
        "./columns/style/StdBaseStyle.js":
        /*!***************************************!*\
          !*** ./columns/style/StdBaseStyle.js ***!
          \***************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleStdBaseStyleJs(module, exports, __nested_webpack_require_407503__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.StdBaseStyle = void 0;

          var BaseStyle_1 = __nested_webpack_require_407503__(
          /*! ./BaseStyle */
          "./columns/style/BaseStyle.js");

          var defaultStyle;

          var StdBaseStyle = /*#__PURE__*/function (_BaseStyle_1$BaseStyl2) {
            _inherits(StdBaseStyle, _BaseStyle_1$BaseStyl2);

            var _super31 = _createSuper(StdBaseStyle);

            function StdBaseStyle() {
              var _this50;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, StdBaseStyle);

              _this50 = _super31.call(this, style);
              _this50._textAlign = style.textAlign || "left";
              _this50._textBaseline = style.textBaseline || "middle";
              _this50._padding = style.padding;
              return _this50;
            }

            _createClass(StdBaseStyle, [{
              key: "textAlign",
              get: function get() {
                return this._textAlign;
              },
              set: function set(textAlign) {
                this._textAlign = textAlign;
                this.doChangeStyle();
              }
            }, {
              key: "textBaseline",
              get: function get() {
                return this._textBaseline;
              },
              set: function set(textBaseline) {
                this._textBaseline = textBaseline;
                this.doChangeStyle();
              }
            }, {
              key: "padding",
              get: function get() {
                return this._padding;
              },
              set: function set(padding) {
                this._padding = padding;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new StdBaseStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new StdBaseStyle();
              }
            }]);

            return StdBaseStyle;
          }(BaseStyle_1.BaseStyle);

          exports.StdBaseStyle = StdBaseStyle;
          /***/
        },

        /***/
        "./columns/style/Style.js":
        /*!********************************!*\
          !*** ./columns/style/Style.js ***!
          \********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleStyleJs(module, exports, __nested_webpack_require_410293__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Style = void 0;

          var StdBaseStyle_1 = __nested_webpack_require_410293__(
          /*! ./StdBaseStyle */
          "./columns/style/StdBaseStyle.js");

          var defaultStyle;

          var Style = /*#__PURE__*/function (_StdBaseStyle_1$StdBa4) {
            _inherits(Style, _StdBaseStyle_1$StdBa4);

            var _super32 = _createSuper(Style);

            function Style() {
              var _this51;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, Style);

              _this51 = _super32.call(this, style);
              _this51._color = style.color;
              _this51._font = style.font;
              _this51._textOverflow = style.textOverflow || "clip";
              return _this51;
            }

            _createClass(Style, [{
              key: "color",
              get: function get() {
                return this._color;
              },
              set: function set(color) {
                this._color = color;
                this.doChangeStyle();
              }
            }, {
              key: "font",
              get: function get() {
                return this._font;
              },
              set: function set(font) {
                this._font = font;
                this.doChangeStyle();
              }
            }, {
              key: "textOverflow",
              get: function get() {
                return this._textOverflow;
              },
              set: function set(textOverflow) {
                this._textOverflow = textOverflow;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new Style(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new Style();
              }
            }]);

            return Style;
          }(StdBaseStyle_1.StdBaseStyle);

          exports.Style = Style;
          /***/
        },

        /***/
        "./columns/style/TreeStyle.js":
        /*!************************************!*\
          !*** ./columns/style/TreeStyle.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsStyleTreeStyleJs(module, exports, __nested_webpack_require_412973__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.TreeStyle = void 0;

          var Style_1 = __nested_webpack_require_412973__(
          /*! ./Style */
          "./columns/style/Style.js");

          var defaultStyle;

          var TreeStyle = /*#__PURE__*/function (_Style_1$Style7) {
            _inherits(TreeStyle, _Style_1$Style7);

            var _super33 = _createSuper(TreeStyle);

            function TreeStyle() {
              var _this52;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, TreeStyle);

              _this52 = _super33.call(this, style);
              _this52._lineStyle = style.lineStyle;
              _this52._lineColor = style.lineColor;
              _this52._lineWidth = style.lineWidth;
              _this52._treeIcon = style.treeIcon;
              return _this52;
            }

            _createClass(TreeStyle, [{
              key: "clone",
              value: function clone() {
                return new TreeStyle(this);
              }
            }, {
              key: "lineStyle",
              get: function get() {
                return this._lineStyle;
              },
              set: function set(lineStyle) {
                this._lineStyle = lineStyle;
                this.doChangeStyle();
              }
            }, {
              key: "lineColor",
              get: function get() {
                return this._lineColor;
              },
              set: function set(lineColor) {
                this._lineColor = lineColor;
                this.doChangeStyle();
              }
            }, {
              key: "lineWidth",
              get: function get() {
                return this._lineWidth;
              },
              set: function set(lineWidth) {
                this._lineWidth = lineWidth;
                this.doChangeStyle();
              }
            }, {
              key: "treeIcon",
              get: function get() {
                return this._treeIcon;
              },
              set: function set(treeIcon) {
                this._treeIcon = treeIcon;
                this.doChangeStyle();
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new TreeStyle();
              }
            }]);

            return TreeStyle;
          }(Style_1.Style);

          exports.TreeStyle = TreeStyle;
          /***/
        },

        /***/
        "./columns/type.js":
        /*!*************************!*\
          !*** ./columns/type.js ***!
          \*************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeJs(module, exports, __nested_webpack_require_415961__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.of = exports.TreeColumn = exports.MultilineTextColumn = exports.MenuColumn = exports.BranchGraphColumn = exports.IconColumn = exports.PercentCompleteBarColumn = exports.ImageColumn = exports.ButtonColumn = exports.RadioColumn = exports.CheckColumn = exports.NumberColumn = exports.Column = void 0;

          var BranchGraphColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/BranchGraphColumn */
          "./columns/type/BranchGraphColumn.js");

          Object.defineProperty(exports, "BranchGraphColumn", {
            enumerable: true,
            get: function get() {
              return BranchGraphColumn_1.BranchGraphColumn;
            }
          });

          var ButtonColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/ButtonColumn */
          "./columns/type/ButtonColumn.js");

          Object.defineProperty(exports, "ButtonColumn", {
            enumerable: true,
            get: function get() {
              return ButtonColumn_1.ButtonColumn;
            }
          });

          var CheckColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/CheckColumn */
          "./columns/type/CheckColumn.js");

          Object.defineProperty(exports, "CheckColumn", {
            enumerable: true,
            get: function get() {
              return CheckColumn_1.CheckColumn;
            }
          });

          var Column_1 = __nested_webpack_require_415961__(
          /*! ./type/Column */
          "./columns/type/Column.js");

          Object.defineProperty(exports, "Column", {
            enumerable: true,
            get: function get() {
              return Column_1.Column;
            }
          });

          var IconColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/IconColumn */
          "./columns/type/IconColumn.js");

          Object.defineProperty(exports, "IconColumn", {
            enumerable: true,
            get: function get() {
              return IconColumn_1.IconColumn;
            }
          });

          var ImageColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/ImageColumn */
          "./columns/type/ImageColumn.js");

          Object.defineProperty(exports, "ImageColumn", {
            enumerable: true,
            get: function get() {
              return ImageColumn_1.ImageColumn;
            }
          });

          var MenuColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/MenuColumn */
          "./columns/type/MenuColumn.js");

          Object.defineProperty(exports, "MenuColumn", {
            enumerable: true,
            get: function get() {
              return MenuColumn_1.MenuColumn;
            }
          });

          var MultilineTextColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/MultilineTextColumn */
          "./columns/type/MultilineTextColumn.js");

          Object.defineProperty(exports, "MultilineTextColumn", {
            enumerable: true,
            get: function get() {
              return MultilineTextColumn_1.MultilineTextColumn;
            }
          });

          var NumberColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/NumberColumn */
          "./columns/type/NumberColumn.js");

          Object.defineProperty(exports, "NumberColumn", {
            enumerable: true,
            get: function get() {
              return NumberColumn_1.NumberColumn;
            }
          });

          var PercentCompleteBarColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/PercentCompleteBarColumn */
          "./columns/type/PercentCompleteBarColumn.js");

          Object.defineProperty(exports, "PercentCompleteBarColumn", {
            enumerable: true,
            get: function get() {
              return PercentCompleteBarColumn_1.PercentCompleteBarColumn;
            }
          });

          var RadioColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/RadioColumn */
          "./columns/type/RadioColumn.js");

          Object.defineProperty(exports, "RadioColumn", {
            enumerable: true,
            get: function get() {
              return RadioColumn_1.RadioColumn;
            }
          });

          var TreeColumn_1 = __nested_webpack_require_415961__(
          /*! ./type/TreeColumn */
          "./columns/type/TreeColumn.js");

          Object.defineProperty(exports, "TreeColumn", {
            enumerable: true,
            get: function get() {
              return TreeColumn_1.TreeColumn;
            }
          });
          var TYPES = {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            DEFAULT: new Column_1.Column(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            NUMBER: new NumberColumn_1.NumberColumn(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            CHECK: new CheckColumn_1.CheckColumn(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            RADIO: new RadioColumn_1.RadioColumn(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            BUTTON: new ButtonColumn_1.ButtonColumn(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            IMAGE: new ImageColumn_1.ImageColumn(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            MULTILINETEXT: new MultilineTextColumn_1.MultilineTextColumn()
          };

          function of(columnType) {
            if (!columnType) {
              return TYPES.DEFAULT;
            } else if (typeof columnType === "string") {
              var key = columnType.toUpperCase();
              return TYPES[key] || of(null);
            } else {
              return columnType;
            }
          }

          exports.of = of;
          /***/
        },

        /***/
        "./columns/type/BaseColumn.js":
        /*!************************************!*\
          !*** ./columns/type/BaseColumn.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeBaseColumnJs(module, exports, __nested_webpack_require_422253__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseColumn = void 0;

          var styleContents = __importStar(__nested_webpack_require_422253__(
          /*! ../style */
          "./columns/style.js"));

          var utils_1 = __nested_webpack_require_422253__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var BaseStyle_1 = __nested_webpack_require_422253__(
          /*! ../style/BaseStyle */
          "./columns/style/BaseStyle.js");

          var animate_1 = __nested_webpack_require_422253__(
          /*! ../../internal/animate */
          "./internal/animate.js");

          var symbolManager_1 = __nested_webpack_require_422253__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var handlers_1 = __nested_webpack_require_422253__(
          /*! ../indicator/handlers */
          "./columns/indicator/handlers.js");

          var setReadonly = utils_1.obj.setReadonly;
          var COLUMN_FADEIN_STATE_ID = (0, symbolManager_1.getColumnFadeinStateId)();

          function isFadeinWhenCallbackInPromise(column, grid) {
            if (column.fadeinWhenCallbackInPromise != null) {
              return column.fadeinWhenCallbackInPromise;
            }

            return !!grid.configure("fadeinWhenCallbackInPromise");
          }

          function getFadeinState(grid) {
            var state = grid[COLUMN_FADEIN_STATE_ID];

            if (!state) {
              state = {
                cells: {}
              };
              setReadonly(grid, COLUMN_FADEIN_STATE_ID, state);
            }

            return state;
          }

          function _generateFadeinPointAction(grid, col, row, context, drawInternal, drawCellBase) {
            return function (point) {
              var state = getFadeinState(grid);
              var stateKey = "".concat(row, ":").concat(col);

              if (point === 1) {
                delete state.cells[stateKey];
              } else {
                state.cells[stateKey] = {
                  opacity: point
                };
              }

              drawCellBase();
              drawInternal();
              var cellState = state.cells[stateKey];

              if (cellState) {
                //透過するため背景を透過で上書き
                var ctx = context.getContext();
                ctx.globalAlpha = 1 - cellState.opacity;

                try {
                  drawCellBase();
                } finally {
                  ctx.globalAlpha = 1;
                }
              }
            };
          }

          var fadeinMgr = {
            animate: function animate(grid, col, row, context, drawInternal, drawCellBase) {
              // fadein animation
              var state = getFadeinState(grid);
              var activeFadeins = [_generateFadeinPointAction(grid, col, row, context, drawInternal, drawCellBase)];
              state.activeFadeins = activeFadeins;
              (0, animate_1.animate)(500, function (point) {
                activeFadeins.forEach(function (f) {
                  return f(point);
                });

                if (point === 1) {
                  delete state.activeFadeins;
                }
              });
            },
            margeAnimate: function margeAnimate(grid, col, row, context, drawInternal, drawCellBase) {
              var state = getFadeinState(grid);

              if (state.activeFadeins) {
                state.activeFadeins.push(_generateFadeinPointAction(grid, col, row, context, drawInternal, drawCellBase));
              } else {
                drawInternal();
              }
            }
          };

          var BaseColumn = /*#__PURE__*/function () {
            function BaseColumn(option) {
              _classCallCheck(this, BaseColumn);

              this.onDrawCell = this.onDrawCell.bind(this); //スコープを固定させる
              //Promiseのcallbackでフェードイン表示する

              this._fadeinWhenCallbackInPromise = option === null || option === void 0 ? void 0 : option.fadeinWhenCallbackInPromise;
            }

            _createClass(BaseColumn, [{
              key: "fadeinWhenCallbackInPromise",
              get: function get() {
                return this._fadeinWhenCallbackInPromise;
              }
            }, {
              key: "StyleClass",
              get: function get() {
                return BaseStyle_1.BaseStyle;
              }
            }, {
              key: "onDrawCell",
              value: function onDrawCell(cellValue, info, context, grid) {
                var _this53 = this;

                var _a;

                var style = info.style,
                    getRecord = info.getRecord,
                    drawCellBase = info.drawCellBase;
                var helper = grid.getGridCanvasHelper();
                drawCellBase();
                var record = getRecord();
                var promise;

                if ((0, utils_1.isPromise)(record)) {
                  promise = record;
                } else if ((0, utils_1.isPromise)(cellValue)) {
                  promise = cellValue;
                } else {
                  var msg = info.getMessage();

                  if ((0, utils_1.isPromise)(msg)) {
                    promise = msg;
                  }
                } //文字描画


                if (promise) {
                  var start = Date.now();
                  return Promise.all([record, cellValue, promise.then(function () {
                    return cellValue;
                  }).then(function () {
                    return info.getMessage();
                  })]).then(function (_ref27) {
                    var record = _ref27[0],
                        val = _ref27[1],
                        message = _ref27[2];
                    var currentContext = context.toCurrentContext();
                    var drawRect = currentContext.getDrawRect();

                    if (!drawRect) {
                      return;
                    }

                    var time = Date.now() - start;

                    var drawInternal = function drawInternal() {
                      var currentContext = context.toCurrentContext();
                      var drawRect = currentContext.getDrawRect();

                      if (!drawRect) {
                        return;
                      }

                      var actStyle = styleContents.of(style, record, _this53.StyleClass);

                      _this53.drawInternal(_this53.convertInternal(val), currentContext, actStyle, helper, grid, info);

                      _this53.drawMessageInternal(message, currentContext, actStyle, helper, grid, info);

                      _this53.drawIndicatorsInternal(currentContext, actStyle, helper, grid, info);
                    };

                    if (!isFadeinWhenCallbackInPromise(_this53, grid)) {
                      drawInternal(); //単純な描画
                    } else {
                      var col = context.col,
                          row = context.row;

                      if (time < 80) {
                        //80ms以内のPromiseCallbackは前アニメーションに統合
                        fadeinMgr.margeAnimate(grid, col, row, context, drawInternal, drawCellBase);
                      } else {
                        //アニメーション
                        fadeinMgr.animate(grid, col, row, context, drawInternal, drawCellBase);
                      }
                    }
                  });
                } else {
                  var actStyle = styleContents.of(style, record, this.StyleClass);
                  this.drawInternal(this.convertInternal(cellValue), context, actStyle, helper, grid, info);
                  this.drawMessageInternal(info.getMessage(), context, actStyle, helper, grid, info);
                  this.drawIndicatorsInternal(context, actStyle, helper, grid, info); //フェードインの場合透過するため背景を透過で上書き

                  var col = context.col,
                      row = context.row;
                  var stateKey = "".concat(col, ":").concat(row);
                  var cellState = (_a = grid[COLUMN_FADEIN_STATE_ID]) === null || _a === void 0 ? void 0 : _a.cells[stateKey];

                  if (cellState) {
                    var ctx = context.getContext();
                    ctx.globalAlpha = 1 - cellState.opacity;

                    try {
                      drawCellBase();
                    } finally {
                      ctx.globalAlpha = 1;
                    }
                  }

                  return undefined;
                }
              }
            }, {
              key: "convertInternal",
              value: function convertInternal(value) {
                return value != null ? value : "";
              }
            }, {
              key: "drawMessageInternal",
              value: function drawMessageInternal(message, context, style, helper, grid, info) {
                info.messageHandler.drawCellMessage(message, context, style, helper, grid, info);
              }
            }, {
              key: "drawIndicatorsInternal",
              value: function drawIndicatorsInternal(context, style, helper, grid, info) {
                var _a;

                var indicatorTopLeft = style.indicatorTopLeft,
                    indicatorTopRight = style.indicatorTopRight,
                    indicatorBottomRight = style.indicatorBottomRight,
                    indicatorBottomLeft = style.indicatorBottomLeft;

                for (var _i2 = 0, _arr = [[indicatorTopLeft, 0
                /* DrawIndicatorKind.topLeft */
                ], [indicatorTopRight, 1
                /* DrawIndicatorKind.topRight */
                ], [indicatorBottomRight, 2
                /* DrawIndicatorKind.bottomRight */
                ], [indicatorBottomLeft, 3
                /* DrawIndicatorKind.bottomLeft */
                ]]; _i2 < _arr.length; _i2++) {
                  var _arr$_i = _arr[_i2],
                      indicatorStyle = _arr$_i[0],
                      kind = _arr$_i[1];

                  if (indicatorStyle) {
                    (_a = (0, handlers_1.getDrawIndicator)(indicatorStyle)) === null || _a === void 0 ? void 0 : _a(context, indicatorStyle, kind, helper, grid, info);
                  }
                }
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(_grid, _cellId) {
                return [];
              }
            }, {
              key: "getCopyCellValue",
              value: function getCopyCellValue(value, _grid, _cell) {
                return value;
              }
            }]);

            return BaseColumn;
          }();

          exports.BaseColumn = BaseColumn;
          /***/
        },

        /***/
        "./columns/type/BranchGraphColumn.js":
        /*!*******************************************!*\
          !*** ./columns/type/BranchGraphColumn.js ***!
          \*******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeBranchGraphColumnJs(module, exports, __nested_webpack_require_434875__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BranchGraphColumn = void 0;

          var utils_1 = __nested_webpack_require_434875__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var BaseColumn_1 = __nested_webpack_require_434875__(
          /*! ./BaseColumn */
          "./columns/type/BaseColumn.js");

          var BranchGraphStyle_1 = __nested_webpack_require_434875__(
          /*! ../style/BranchGraphStyle */
          "./columns/style/BranchGraphStyle.js");

          var symbolManager_1 = __nested_webpack_require_434875__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var _ = (0, symbolManager_1.getBranchGraphColumnStateId)();

          function getAllColumnData(grid, field, callback) {
            var dataSource = grid.dataSource;
            var allData = [];
            var promise;

            var _loop4 = function _loop4(index) {
              var data = dataSource.getField(index, field);

              if ((0, utils_1.isPromise)(data)) {
                var dataIndex = allData.length;
                allData.push(undefined);

                if (!promise) {
                  promise = data.then(function (d) {
                    allData[dataIndex] = d;
                  });
                } else {
                  promise = promise.then(function () {
                    return data;
                  }).then(function (d) {
                    allData[dataIndex] = d;
                  });
                }
              } else {
                allData.push(data);
              }
            };

            for (var index = 0; index < dataSource.length; index++) {
              _loop4(index);
            }

            if (promise) {
              promise.then(function () {
                return callback(allData);
              });
            } else {
              callback(allData);
            }
          }

          var BranchLine = function BranchLine(_ref28) {
            var fromIndex = _ref28.fromIndex,
                toIndex = _ref28.toIndex,
                colorIndex = _ref28.colorIndex,
                point = _ref28.point;

            _classCallCheck(this, BranchLine);

            this.fromIndex = fromIndex;
            this.toIndex = toIndex;
            this.colorIndex = colorIndex;
            this.point = point;
          };

          var BranchPoint = /*#__PURE__*/function () {
            function BranchPoint(_ref29) {
              var index = _ref29.index,
                  _ref29$commit = _ref29.commit,
                  commit = _ref29$commit === void 0 ? false : _ref29$commit,
                  _ref29$lines = _ref29.lines,
                  lines = _ref29$lines === void 0 ? [] : _ref29$lines,
                  tag = _ref29.tag;

              _classCallCheck(this, BranchPoint);

              this.index = index;
              this.commit = commit;
              this.lines = lines;
              this.tag = tag;
            }

            _createClass(BranchPoint, null, [{
              key: "mergeLines",
              value: function mergeLines(lines) {
                var result = lines.filter(function (l) {
                  return l.fromIndex != null && l.toIndex != null;
                });
                var fromList = lines.filter(function (l) {
                  return l.fromIndex != null && l.toIndex == null;
                });
                var toList = lines.filter(function (l) {
                  return l.fromIndex == null && l.toIndex != null;
                });
                fromList.forEach(function (f) {
                  for (var i = 0; i < toList.length; i++) {
                    var t = toList[i];

                    if (t.point) {
                      continue;
                    }

                    if (f.colorIndex === t.colorIndex) {
                      f.toIndex = t.toIndex;
                      toList.splice(i, 1);
                      break;
                    }
                  }

                  result.push(f);
                });
                return result.concat(toList);
              }
            }, {
              key: "merge",
              value: function merge(a, b) {
                if (!a) {
                  return b;
                }

                return new BranchPoint({
                  index: a.index,
                  commit: a.commit || b.commit,
                  lines: BranchPoint.mergeLines(a.lines.concat(b.lines)),
                  tag: a.tag || b.tag
                });
              }
            }]);

            return BranchPoint;
          }();

          function joinLine(timeline, branchIndex) {
            var reverse = _toConsumableArray(timeline).reverse();

            for (var i = 0; i < reverse.length; i++) {
              var f = reverse[i][branchIndex];

              if (f) {
                f.lines = BranchPoint.mergeLines(f.lines.concat([new BranchLine({
                  toIndex: branchIndex,
                  colorIndex: branchIndex
                })]));

                for (var j = 0; j < i; j++) {
                  var tl = reverse[j];
                  tl[branchIndex] = new BranchPoint({
                    index: branchIndex,
                    lines: [new BranchLine({
                      fromIndex: branchIndex,
                      toIndex: branchIndex,
                      colorIndex: branchIndex
                    })]
                  });
                }

                return true;
              }
            }

            return false;
          }

          function branch(_ref30, from, to) {
            var timeline = _ref30.timeline,
                branches = _ref30.branches;
            var fromIndex = from != null ? branches.indexOf(from) : -1;
            var toIndex = branches.indexOf(to);

            if (toIndex < 0) {
              toIndex = branches.length;
              branches.push(to);
            }

            function findBranchRootIndex() {
              for (var index = timeline.length - 1; index >= 0; index--) {
                var tl = timeline[index];
                var _from = tl[fromIndex];

                if (_from && _from.commit) {
                  return index;
                }
              }

              return -1;
            }

            if (fromIndex < 0) {
              return new BranchPoint({
                index: toIndex
              });
            } else {
              var fromTargetIndex = findBranchRootIndex();

              if (fromTargetIndex === -1) {
                return null;
              }

              var branchTargetFromIndex = fromTargetIndex + 1;
              var branchPoint = new BranchPoint({
                index: toIndex,
                lines: [new BranchLine({
                  fromIndex: fromIndex,
                  colorIndex: toIndex
                })]
              });
              var point;
              var result = null;

              if (branchTargetFromIndex < timeline.length) {
                var targetLine = timeline[branchTargetFromIndex];
                point = targetLine[toIndex] = BranchPoint.merge(targetLine[toIndex], branchPoint);
              } else {
                point = branchPoint;
                result = branchPoint;
              }

              var _from2 = timeline[fromTargetIndex][fromIndex];
              _from2.lines = BranchPoint.mergeLines(_from2.lines.concat([new BranchLine({
                toIndex: toIndex,
                colorIndex: toIndex,
                point: point
              })]));
              return result;
            }
          }

          function commit(_ref31, name) {
            var timeline = _ref31.timeline,
                branches = _ref31.branches;
            var index = branches.indexOf(name);

            if (index < 0) {
              return null;
            }

            var result = new BranchPoint({
              index: index,
              commit: true
            });

            if (joinLine(timeline, index)) {
              result.lines = BranchPoint.mergeLines(result.lines.concat([new BranchLine({
                fromIndex: index,
                colorIndex: index
              })]));
            }

            return result;
          }

          function commitTag(_ref32, name, tag) {
            var branches = _ref32.branches;
            var index = branches.indexOf(name);

            if (index < 0) {
              index = branches.length;
              branches.push(name);
            }

            return new BranchPoint({
              index: index,
              tag: tag
            });
          }

          function commitMerge(_ref33, from, to) {
            var timeline = _ref33.timeline,
                branches = _ref33.branches;
            var fromIndex = branches.indexOf(from);
            var toIndex = branches.indexOf(to);

            if (toIndex < 0 || fromIndex < 0) {
              return new BranchPoint({
                index: toIndex,
                commit: true
              });
            }

            var result = new BranchPoint({
              index: toIndex,
              commit: true,
              lines: [new BranchLine({
                fromIndex: fromIndex,
                colorIndex: fromIndex
              }), new BranchLine({
                fromIndex: toIndex,
                colorIndex: toIndex
              })]
            });

            var fromList = _toConsumableArray(timeline);

            var fromTargetLine = fromList.pop();

            if (fromTargetLine) {
              fromTargetLine[fromIndex] = BranchPoint.merge(fromTargetLine[fromIndex], new BranchPoint({
                index: toIndex,
                lines: [new BranchLine({
                  toIndex: toIndex,
                  colorIndex: fromIndex
                })]
              }));
            }

            if (joinLine(fromList, fromIndex) && fromTargetLine) {
              fromTargetLine[fromIndex].lines = BranchPoint.mergeLines(fromTargetLine[fromIndex].lines.concat([new BranchLine({
                fromIndex: fromIndex,
                colorIndex: fromIndex
              })]));
            }

            joinLine(timeline, toIndex);
            return result;
          }

          function calcCommand(info, command) {
            var timeline = info.timeline;
            var timelineData = []; // const last = timeline.length > 0 ? timeline[timeline.length - 1] : null;

            var commands = Array.isArray(command) ? command : [command];
            commands.forEach(function (cmd) {
              if (!cmd) {
                return;
              }

              var point;

              if (cmd.command === "branch") {
                var from = utils_1.obj.isObject(cmd.branch) ? cmd.branch.from : null;
                var to = utils_1.obj.isObject(cmd.branch) ? cmd.branch.to : cmd.branch;
                point = branch(info, from, to);
              } else if (cmd.command === "commit") {
                var _branch = cmd.branch;
                point = commit(info, _branch);
              } else if (cmd.command === "merge") {
                var _cmd$branch = cmd.branch,
                    _from3 = _cmd$branch.from,
                    _to = _cmd$branch.to;
                point = commitMerge(info, _from3, _to);
              } else if (cmd.command === "tag") {
                var _branch2 = cmd.branch,
                    tag = cmd.tag;
                point = commitTag(info, _branch2, tag);
              }

              if (point && point.index > -1) {
                timelineData[point.index] = BranchPoint.merge(timelineData[point.index], point);
              }
            });
            timeline.push(timelineData);
          }

          function calcBranchesInfo(start, grid, field) {
            var result = {
              branches: [],
              timeline: []
            };
            getAllColumnData(grid, field, function (data) {
              if (start !== "top") {
                data = _toConsumableArray(data).reverse();
              }

              data.forEach(function (command) {
                calcCommand(result, command);
              });
            });
            return result;
          }

          function calcBranchXPoints(ctx, left, width, radius, branches, timeline) {
            var w = Math.max(width / branches.length + 1, 5);
            timeline.forEach(function (tl) {
              tl.forEach(function (p, index) {
                if (index <= 0) {
                  // 計算の意味が無い
                  return;
                }

                if (p.tag) {
                  var textWidth = ctx.measureText(p.tag).width;

                  if (w * index + radius * 2 + 4 + textWidth > width) {
                    w = Math.max((width - radius * 2 - 4 - textWidth) / index, 5);
                  }
                }
              });
            });
            var result = [];
            var x = left;
            branches.forEach(function () {
              result.push(Math.ceil(x + radius));
              x += w;
            });
            return result;
          }

          function renderMerge(grid, ctx, x, y, upLineIndex, downLineIndex, colorIndex, _ref34, _ref35) {
            var branchXPoints = _ref34.branchXPoints,
                branchColors = _ref34.branchColors,
                branchLineWidth = _ref34.branchLineWidth,
                mergeStyle = _ref34.mergeStyle;
            var col = _ref35.col,
                row = _ref35.row,
                branches = _ref35.branches;

            if (upLineIndex != null || downLineIndex != null) {
              ctx.strokeStyle = (0, utils_1.getOrApply)(branchColors, branches[colorIndex], colorIndex);
              ctx.lineWidth = branchLineWidth;
              ctx.lineCap = "round";
              ctx.beginPath();

              if (upLineIndex != null) {
                var upX = branchXPoints[upLineIndex];
                var upRect = grid.getCellRelativeRect(col, row - 1);
                var upY = upRect.top + upRect.height / 2;
                ctx.moveTo(upX, upY);

                if (mergeStyle === "bezier") {
                  ctx.bezierCurveTo(upX, (y + upY) / 2, x, (y + upY) / 2, x, y);
                } else {
                  ctx.lineTo(x, y);
                }
              } else {
                ctx.moveTo(x, y);
              }

              if (downLineIndex != null) {
                var downX = branchXPoints[downLineIndex];
                var downRect = grid.getCellRelativeRect(col, row + 1);
                var downY = downRect.top + downRect.height / 2;

                if (mergeStyle === "bezier") {
                  ctx.bezierCurveTo(x, (y + downY) / 2, downX, (y + downY) / 2, downX, downY);
                } else {
                  ctx.lineTo(downX, downY);
                }
              }

              ctx.stroke();
            }
          }
          /**
           * BranchGraphColumn
           *
           * Data commands
           * - master branch or orphan branch
           *
           * ```js
           * {
           * 	command: 'branch',
           * 	branch: 'branch name A',
           * }
           * ```
           *
           * - commit
           *
           * ```js
           * {
           * 	command: 'commit',
           * 	branch: 'branch name A'
           * }
           * ```
           *
           * - branch
           *
           * ```js
           * {
           * 	command: 'branch',
           * 	branch: {
           * 		from: 'branch name A',
           * 		to: 'branch name B'
           * 	}
           * }
           * ```
           *
           * - merge
           *
           * ```js
           * {
           * 	command: 'merge',
           * 	branch: {
           * 		from: 'branch name B',
           * 		to: 'branch name A'
           * 	}
           * }
           * ```
           *
           * - tag
           *
           * ```js
           * {
           * 	command: 'tag',
           * 	branch: 'branch name A',
           * 	tag: 'tag name'
           * }
           * ```
           *
           * @memberof cheetahGrid.columns.type
           */


          var BranchGraphColumn = /*#__PURE__*/function (_BaseColumn_1$BaseCol) {
            _inherits(BranchGraphColumn, _BaseColumn_1$BaseCol);

            var _super34 = _createSuper(BranchGraphColumn);

            function BranchGraphColumn() {
              var _this54;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, BranchGraphColumn);

              _this54 = _super34.call(this, option);
              _this54._start = option.start || "bottom";
              _this54._cache = option.cache != null ? option.cache : false;
              return _this54;
            }

            _createClass(BranchGraphColumn, [{
              key: "StyleClass",
              get: function get() {
                return BranchGraphStyle_1.BranchGraphStyle;
              }
            }, {
              key: "clearCache",
              value: function clearCache(grid) {
                var internal = grid;
                delete internal[_];
              }
            }, {
              key: "onDrawCell",
              value: function onDrawCell(cellValue, info, context, grid) {
                if (this._cache) {
                  var state = grid[_] || (grid[_] = new Map());
                  var col = context.col,
                      row = context.row;
                  var field = grid.getField(col, row);

                  if (!state.has(field)) {
                    state.set(field, calcBranchesInfo(this._start, grid, field));
                  }
                }

                return _get(_getPrototypeOf(BranchGraphColumn.prototype), "onDrawCell", this).call(this, cellValue, info, context, grid);
              }
            }, {
              key: "clone",
              value: function clone() {
                return new BranchGraphColumn(this);
              }
            }, {
              key: "start",
              get: function get() {
                return this._start;
              }
            }, {
              key: "cache",
              get: function get() {
                return this._cache;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(_value, context, style, helper, grid, _ref36) {
                var drawCellBase = _ref36.drawCellBase;

                var _a, _b;

                var col = context.col,
                    row = context.row;
                var field = grid.getField(col, row);

                var _ref37 = (_b = this._cache ? (_a = grid[_]) === null || _a === void 0 ? void 0 : _a.get(field) : null) !== null && _b !== void 0 ? _b : calcBranchesInfo(this._start, grid, field),
                    timeline = _ref37.timeline,
                    branches = _ref37.branches;

                var _ref38 = this._start !== "top" ? {
                  upLineIndexKey: "toIndex",
                  downLineIndexKey: "fromIndex"
                } : {
                  upLineIndexKey: "fromIndex",
                  downLineIndexKey: "toIndex"
                },
                    upLineIndexKey = _ref38.upLineIndexKey,
                    downLineIndexKey = _ref38.downLineIndexKey;

                var data = this._start !== "top" ? timeline[timeline.length - (row - grid.frozenRowCount) - 1] : timeline[row - grid.frozenRowCount];
                var branchColors = style.branchColors,
                    branchLineWidth = style.branchLineWidth,
                    circleSize = style.circleSize,
                    mergeStyle = style.mergeStyle,
                    margin = style.margin,
                    bgColor = style.bgColor,
                    visibility = style.visibility;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                var rect = context.getRect();
                var radius = circleSize / 2;
                var width = rect.width - margin * 2;
                helper.drawWithClip(context, function (ctx) {
                  ctx.textAlign = "left";
                  ctx.textBaseline = "middle";
                  var branchXPoints = calcBranchXPoints(ctx, rect.left + margin, width, radius, branches, timeline);
                  var y = rect.top + rect.height / 2; // draw join lines

                  data.map(function (point, index) {
                    return point ? point.lines.map(function (line) {
                      return {
                        colorIndex: line.colorIndex,
                        upLineIndex: line[upLineIndexKey],
                        downLineIndex: line[downLineIndexKey],
                        pointIndex: index
                      };
                    }) : [];
                  }).reduce(function (p, c) {
                    return p.concat(c);
                  }, []) // flatMap
                  // order of overlap
                  .sort(function (a, b) {
                    return b.colorIndex - a.colorIndex;
                  }).forEach(function (line) {
                    var x = branchXPoints[line.pointIndex];
                    renderMerge(grid, ctx, x, y, line.upLineIndex, line.downLineIndex, line.colorIndex, {
                      margin: margin,
                      branchXPoints: branchXPoints,
                      branchLineWidth: branchLineWidth,
                      branchColors: branchColors,
                      mergeStyle: mergeStyle
                    }, {
                      width: width,
                      col: col,
                      row: row,
                      branches: branches
                    });
                  }); // draw commit points

                  data.forEach(function (p, index) {
                    if (p && p.commit) {
                      var x = branchXPoints[index];
                      ctx.fillStyle = (0, utils_1.getOrApply)(branchColors, branches[index], index);
                      ctx.beginPath();
                      ctx.arc(x, y, radius, 0, Math.PI * 2, true);
                      ctx.fill();
                      ctx.closePath();
                    }
                  }); // draw tags

                  data.forEach(function (p, index) {
                    if (p && p.tag) {
                      ctx.fillStyle = (0, utils_1.getOrApply)(branchColors, branches[index], index);
                      ctx.fillText(p.tag, branchXPoints[index] + radius + 4, y);
                    }
                  });
                });
              }
            }]);

            return BranchGraphColumn;
          }(BaseColumn_1.BaseColumn);

          exports.BranchGraphColumn = BranchGraphColumn;
          /***/
        },

        /***/
        "./columns/type/ButtonColumn.js":
        /*!**************************************!*\
          !*** ./columns/type/ButtonColumn.js ***!
          \**************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeButtonColumnJs(module, exports, __nested_webpack_require_458430__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ButtonColumn = void 0;

          var utils = __importStar(__nested_webpack_require_458430__(
          /*! ./columnUtils */
          "./columns/type/columnUtils.js"));

          var ButtonStyle_1 = __nested_webpack_require_458430__(
          /*! ../style/ButtonStyle */
          "./columns/style/ButtonStyle.js");

          var Column_1 = __nested_webpack_require_458430__(
          /*! ./Column */
          "./columns/type/Column.js");

          var utils_1 = __nested_webpack_require_458430__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var symbolManager_1 = __nested_webpack_require_458430__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var BUTTON_COLUMN_STATE_ID = (0, symbolManager_1.getButtonColumnStateId)();

          var ButtonColumn = /*#__PURE__*/function (_Column_1$Column) {
            _inherits(ButtonColumn, _Column_1$Column);

            var _super35 = _createSuper(ButtonColumn);

            function ButtonColumn() {
              var _this55;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, ButtonColumn);

              _this55 = _super35.call(this, option);
              _this55._caption = option.caption;
              return _this55;
            }

            _createClass(ButtonColumn, [{
              key: "StyleClass",
              get: function get() {
                return ButtonStyle_1.ButtonStyle;
              }
            }, {
              key: "caption",
              get: function get() {
                return this._caption;
              }
            }, {
              key: "withCaption",
              value: function withCaption(caption) {
                var c = this.clone();
                c._caption = caption;
                return c;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new ButtonColumn(this);
              }
            }, {
              key: "convertInternal",
              value: function convertInternal(value) {
                return this._caption || _get(_getPrototypeOf(ButtonColumn.prototype), "convertInternal", this).call(this, value);
              }
            }, {
              key: "getCopyCellValue",
              value: function getCopyCellValue(value) {
                return this._caption || value;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, grid, _ref39) {
                var drawCellBase = _ref39.drawCellBase,
                    getIcon = _ref39.getIcon;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    bgColor = style.bgColor,
                    color = style.color,
                    buttonBgColor = style.buttonBgColor,
                    font = style.font,
                    padding = style.padding,
                    textOverflow = style.textOverflow,
                    visibility = style.visibility;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                var textValue = value != null ? String(value) : "";
                helper.testFontLoad(font, textValue, context);
                var col = context.col,
                    row = context.row;
                var range = grid.getCellRange(col, row);
                var active = false;
                var state = grid[BUTTON_COLUMN_STATE_ID];

                if (state) {
                  if (state.mouseActiveCell && (0, utils_1.cellInRange)(range, state.mouseActiveCell.col, state.mouseActiveCell.row)) {
                    active = true;
                  } else {
                    var _context$getSelection4 = context.getSelection(),
                        select = _context$getSelection4.select;

                    if ((0, utils_1.cellInRange)(range, select.col, select.row)) {
                      active = true;
                    }
                  }
                }

                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  helper.button(textValue, context, {
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    bgColor: buttonBgColor,
                    color: color,
                    font: font,
                    padding: padding,
                    shadow: active ? {
                      color: "rgba(0, 0, 0, 0.48)",
                      blur: 6,
                      offsetY: 3
                    } : {},
                    textOverflow: textOverflow,
                    icons: icons
                  });
                });
              }
            }]);

            return ButtonColumn;
          }(Column_1.Column);

          exports.ButtonColumn = ButtonColumn;
          /***/
        },

        /***/
        "./columns/type/CheckColumn.js":
        /*!*************************************!*\
          !*** ./columns/type/CheckColumn.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeCheckColumnJs(module, exports, __nested_webpack_require_465469__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.CheckColumn = void 0;

          var BaseColumn_1 = __nested_webpack_require_465469__(
          /*! ./BaseColumn */
          "./columns/type/BaseColumn.js");

          var CheckStyle_1 = __nested_webpack_require_465469__(
          /*! ../style/CheckStyle */
          "./columns/style/CheckStyle.js");

          var symbolManager_1 = __nested_webpack_require_465469__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_465469__(
          /*! ../utils */
          "./columns/utils/index.js");

          var CHECK_COLUMN_STATE_ID = (0, symbolManager_1.getCheckColumnStateId)();

          var CheckColumn = /*#__PURE__*/function (_BaseColumn_1$BaseCol2) {
            _inherits(CheckColumn, _BaseColumn_1$BaseCol2);

            var _super36 = _createSuper(CheckColumn);

            function CheckColumn() {
              _classCallCheck(this, CheckColumn);

              return _super36.apply(this, arguments);
            }

            _createClass(CheckColumn, [{
              key: "StyleClass",
              get: function get() {
                return CheckStyle_1.CheckStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new CheckColumn(this);
              }
            }, {
              key: "convertInternal",
              value: function convertInternal(value) {
                return (0, utils_1.toBoolean)(value);
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, grid, _ref40) {
                var drawCellBase = _ref40.drawCellBase;

                var _a;

                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    padding = style.padding,
                    borderColor = style.borderColor,
                    checkBgColor = style.checkBgColor,
                    uncheckBgColor = style.uncheckBgColor,
                    bgColor = style.bgColor,
                    visibility = style.visibility;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                var col = context.col,
                    row = context.row;
                var range = grid.getCellRange(col, row);
                var cellKey = "".concat(range.start.col, ":").concat(range.start.row);
                var elapsed = (_a = grid[CHECK_COLUMN_STATE_ID]) === null || _a === void 0 ? void 0 : _a.elapsed[cellKey];
                var opt = {
                  textAlign: textAlign,
                  textBaseline: textBaseline,
                  borderColor: borderColor,
                  checkBgColor: checkBgColor,
                  uncheckBgColor: uncheckBgColor,
                  padding: padding
                };

                if (elapsed != null) {
                  opt.animElapsedTime = elapsed;
                }

                helper.checkbox(value, context, opt);
              }
            }]);

            return CheckColumn;
          }(BaseColumn_1.BaseColumn);

          exports.CheckColumn = CheckColumn;
          /***/
        },

        /***/
        "./columns/type/Column.js":
        /*!********************************!*\
          !*** ./columns/type/Column.js ***!
          \********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeColumnJs(module, exports, __nested_webpack_require_469338__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Column = void 0;

          var utils = __importStar(__nested_webpack_require_469338__(
          /*! ./columnUtils */
          "./columns/type/columnUtils.js"));

          var BaseColumn_1 = __nested_webpack_require_469338__(
          /*! ./BaseColumn */
          "./columns/type/BaseColumn.js");

          var Style_1 = __nested_webpack_require_469338__(
          /*! ../style/Style */
          "./columns/style/Style.js");

          var Column = /*#__PURE__*/function (_BaseColumn_1$BaseCol3) {
            _inherits(Column, _BaseColumn_1$BaseCol3);

            var _super37 = _createSuper(Column);

            function Column() {
              _classCallCheck(this, Column);

              return _super37.apply(this, arguments);
            }

            _createClass(Column, [{
              key: "StyleClass",
              get: function get() {
                return Style_1.Style;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new Column(this);
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, _grid, _ref41) {
                var drawCellBase = _ref41.drawCellBase,
                    getIcon = _ref41.getIcon;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    color = style.color,
                    font = style.font,
                    bgColor = style.bgColor,
                    padding = style.padding,
                    textOverflow = style.textOverflow,
                    visibility = style.visibility;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                var textValue = value != null ? String(value) : "";
                helper.testFontLoad(font, textValue, context);
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  helper.text(textValue, context, {
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    color: color,
                    font: font,
                    padding: padding,
                    textOverflow: textOverflow,
                    icons: icons
                  });
                });
              }
            }]);

            return Column;
          }(BaseColumn_1.BaseColumn);

          exports.Column = Column;
          /***/
        },

        /***/
        "./columns/type/IconColumn.js":
        /*!************************************!*\
          !*** ./columns/type/IconColumn.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeIconColumnJs(module, exports, __nested_webpack_require_473904__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.IconColumn = void 0;

          var icons = __importStar(__nested_webpack_require_473904__(
          /*! ../../internal/icons */
          "./internal/icons.js"));

          var Column_1 = __nested_webpack_require_473904__(
          /*! ./Column */
          "./columns/type/Column.js");

          var IconStyle_1 = __nested_webpack_require_473904__(
          /*! ../style/IconStyle */
          "./columns/style/IconStyle.js");

          function repeatArray(val, count) {
            if (count === Infinity) {
              count = 0;
            }

            var a = [];

            for (var i = 0; i < count; i++) {
              a.push(val);
            }

            return a;
          }

          var IconColumn = /*#__PURE__*/function (_Column_1$Column2) {
            _inherits(IconColumn, _Column_1$Column2);

            var _super38 = _createSuper(IconColumn);

            function IconColumn() {
              var _this56;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, IconColumn);

              _this56 = _super38.call(this, option);
              _this56._tagName = option.tagName || "i";
              _this56._className = option.className;
              _this56._content = option.content;
              _this56._name = option.name;
              _this56._iconWidth = option.iconWidth;
              return _this56;
            }

            _createClass(IconColumn, [{
              key: "StyleClass",
              get: function get() {
                return IconStyle_1.IconStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new IconColumn(this);
              }
            }, {
              key: "tagName",
              get: function get() {
                return this._tagName;
              }
            }, {
              key: "className",
              get: function get() {
                return this._className;
              }
            }, {
              key: "content",
              get: function get() {
                return this._content;
              }
            }, {
              key: "name",
              get: function get() {
                return this._name;
              }
            }, {
              key: "iconWidth",
              get: function get() {
                return this._iconWidth;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, grid, info) {
                var num = Number(value);

                if (!isNaN(num)) {
                  var icon = {};
                  icons.iconPropKeys.forEach(function (k) {
                    // eslint-disable-next-line @typescript-eslint/no-explicit-any
                    icon[k] = style[k];
                  });
                  icon.className = this._className;
                  icon.tagName = this._tagName;

                  if (this._content) {
                    icon.content = this._content;
                  }

                  icon.name = this._name;

                  if (this._iconWidth) {
                    icon.width = this._iconWidth;
                  }

                  info.getIcon = function () {
                    return repeatArray(icon, num);
                  };
                } else {
                  info.getIcon = function () {
                    return null;
                  };
                }

                _get(_getPrototypeOf(IconColumn.prototype), "drawInternal", this).call(this, "", context, style, helper, grid, info);
              }
            }]);

            return IconColumn;
          }(Column_1.Column);

          exports.IconColumn = IconColumn;
          /***/
        },

        /***/
        "./columns/type/ImageColumn.js":
        /*!*************************************!*\
          !*** ./columns/type/ImageColumn.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeImageColumnJs(module, exports, __nested_webpack_require_479646__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ImageColumn = void 0;

          var BaseColumn_1 = __nested_webpack_require_479646__(
          /*! ./BaseColumn */
          "./columns/type/BaseColumn.js");

          var ImageStyle_1 = __nested_webpack_require_479646__(
          /*! ../style/ImageStyle */
          "./columns/style/ImageStyle.js");

          var Rect_1 = __nested_webpack_require_479646__(
          /*! ../../internal/Rect */
          "./internal/Rect.js");

          var canvases_1 = __nested_webpack_require_479646__(
          /*! ../../internal/canvases */
          "./internal/canvases.js");

          var imgs_1 = __nested_webpack_require_479646__(
          /*! ../../internal/imgs */
          "./internal/imgs.js");

          var MAX_LRU_CACHE_SIZE = 50;

          function getImage(url) {
            return (0, imgs_1.getCacheOrLoad)("ImageColumn", MAX_LRU_CACHE_SIZE, url);
          }

          function calcKeepAspectRatioSize(width, height, maxWidth, maxHeight) {
            var newWidth = width;
            var newHeight = height;

            if (newWidth > maxWidth) {
              newWidth = maxWidth;
              newHeight = newWidth * height / width;
            }

            if (newHeight > maxHeight) {
              newHeight = maxHeight;
              newWidth = newHeight * width / height;
            }

            return {
              width: newWidth,
              height: newHeight
            };
          }

          var ImageColumn = /*#__PURE__*/function (_BaseColumn_1$BaseCol4) {
            _inherits(ImageColumn, _BaseColumn_1$BaseCol4);

            var _super39 = _createSuper(ImageColumn);

            function ImageColumn() {
              _classCallCheck(this, ImageColumn);

              return _super39.apply(this, arguments);
            }

            _createClass(ImageColumn, [{
              key: "StyleClass",
              get: function get() {
                return ImageStyle_1.ImageStyle;
              }
            }, {
              key: "onDrawCell",
              value: function onDrawCell(cellValue, info, context, grid) {
                return _get(_getPrototypeOf(ImageColumn.prototype), "onDrawCell", this).call(this, getImage(cellValue), info, context, grid);
              }
            }, {
              key: "clone",
              value: function clone() {
                return new ImageColumn(this);
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, _grid, _ref42) {
                var drawCellBase = _ref42.drawCellBase;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    padding = style.padding,
                    margin = style.margin,
                    bgColor = style.bgColor,
                    visibility = style.visibility;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                if (value) {
                  helper.drawWithClip(context, function (ctx) {
                    ctx.textAlign = textAlign;
                    ctx.textBaseline = textBaseline;
                    var rect = context.getRect();

                    if (padding) {
                      var paddingNums = helper.toBoxPixelArray(padding, context, undefined
                      /* font */
                      );
                      var left = rect.left + paddingNums[3];
                      var top = rect.top + paddingNums[0];
                      var width = rect.width - paddingNums[1] - paddingNums[3];
                      var height = rect.height - paddingNums[0] - paddingNums[2];
                      rect = new Rect_1.Rect(left, top, width, height);
                    }

                    if (style.imageSizing === "keep-aspect-ratio") {
                      var _calcKeepAspectRatioS = calcKeepAspectRatioSize(value.width, value.height, rect.width - margin * 2, rect.height - margin * 2),
                          _width = _calcKeepAspectRatioS.width,
                          _height = _calcKeepAspectRatioS.height;

                      var pos = (0, canvases_1.calcStartPosition)(ctx, rect, _width, _height, {
                        offset: margin
                      });
                      ctx.drawImage(value, 0, 0, value.width, value.height, pos.x, pos.y, _width, _height);
                    } else {
                      ctx.drawImage(value, 0, 0, value.width, value.height, rect.left + margin, rect.top + margin, rect.width - margin * 2, rect.height - margin * 2);
                    }
                  });
                }
              }
            }]);

            return ImageColumn;
          }(BaseColumn_1.BaseColumn);

          exports.ImageColumn = ImageColumn;
          /***/
        },

        /***/
        "./columns/type/MenuColumn.js":
        /*!************************************!*\
          !*** ./columns/type/MenuColumn.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeMenuColumnJs(module, exports, __nested_webpack_require_485105__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MenuColumn = void 0;

          var utils = __importStar(__nested_webpack_require_485105__(
          /*! ./columnUtils */
          "./columns/type/columnUtils.js"));

          var BaseColumn_1 = __nested_webpack_require_485105__(
          /*! ./BaseColumn */
          "./columns/type/BaseColumn.js");

          var MenuStyle_1 = __nested_webpack_require_485105__(
          /*! ../style/MenuStyle */
          "./columns/style/MenuStyle.js");

          var menu_items_1 = __nested_webpack_require_485105__(
          /*! ../../internal/menu-items */
          "./internal/menu-items.js");

          var MenuColumn = /*#__PURE__*/function (_BaseColumn_1$BaseCol5) {
            _inherits(MenuColumn, _BaseColumn_1$BaseCol5);

            var _super40 = _createSuper(MenuColumn);

            function MenuColumn() {
              var _this57;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, MenuColumn);

              _this57 = _super40.call(this, option);
              _this57._options = (0, menu_items_1.normalize)(option.options);
              return _this57;
            }

            _createClass(MenuColumn, [{
              key: "StyleClass",
              get: function get() {
                return MenuStyle_1.MenuStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new MenuColumn(this);
              }
            }, {
              key: "options",
              get: function get() {
                return this._options;
              }
            }, {
              key: "withOptions",
              value: function withOptions(options) {
                var c = this.clone();
                c._options = (0, menu_items_1.normalize)(options);
                return c;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, _grid, _ref43) {
                var drawCellBase = _ref43.drawCellBase,
                    getIcon = _ref43.getIcon;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    font = style.font,
                    bgColor = style.bgColor,
                    padding = style.padding,
                    textOverflow = style.textOverflow,
                    appearance = style.appearance,
                    visibility = style.visibility;
                var color = style.color;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                var convertedValue = this._convertInternal(value);

                var text = convertedValue != null ? String(convertedValue) : "";
                helper.testFontLoad(font, text, context);
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  var basePadding = helper.toBoxPixelArray(padding || 0, context, font);
                  var textPadding = basePadding.slice(0);
                  textPadding[1] += 26; // icon padding

                  var iconPadding = basePadding.slice(0);
                  iconPadding[1] += 8;

                  if (color == null && (value == null || value === "")) {
                    color = "rgba(0, 0, 0, .38)";
                  }

                  helper.text(text, context, {
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    color: color,
                    font: font,
                    padding: textPadding,
                    textOverflow: textOverflow,
                    icons: icons
                  });

                  if (appearance === "menulist-button") {
                    // draw dropdown arrow icon
                    helper.text("", context, {
                      textAlign: "right",
                      textBaseline: textBaseline,
                      color: color,
                      font: font,
                      icons: [{
                        path: "M0 2 5 7 10 2z",
                        width: 10,
                        color: "rgba(0, 0, 0, .54)"
                      }],
                      padding: iconPadding
                    });
                  } else if (appearance !== "none") {
                    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions
                    console.warn("unsupported appearance:".concat(appearance));
                  }
                });
              }
            }, {
              key: "convertInternal",
              value: function convertInternal(value) {
                return value;
              }
            }, {
              key: "_convertInternal",
              value: function _convertInternal(value) {
                var options = this._options;

                for (var i = 0; i < options.length; i++) {
                  var option = options[i];

                  if (option.value === value) {
                    value = option.label;
                    break;
                  }
                }

                return _get(_getPrototypeOf(MenuColumn.prototype), "convertInternal", this).call(this, value);
              }
            }, {
              key: "getCopyCellValue",
              value: function getCopyCellValue(value) {
                return this._convertInternal(value);
              }
            }]);

            return MenuColumn;
          }(BaseColumn_1.BaseColumn);

          exports.MenuColumn = MenuColumn;
          /***/
        },

        /***/
        "./columns/type/MultilineTextColumn.js":
        /*!*********************************************!*\
          !*** ./columns/type/MultilineTextColumn.js ***!
          \*********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeMultilineTextColumnJs(module, exports, __nested_webpack_require_492817__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MultilineTextColumn = void 0;

          var utils = __importStar(__nested_webpack_require_492817__(
          /*! ./columnUtils */
          "./columns/type/columnUtils.js"));

          var BaseColumn_1 = __nested_webpack_require_492817__(
          /*! ./BaseColumn */
          "./columns/type/BaseColumn.js");

          var MultilineTextStyle_1 = __nested_webpack_require_492817__(
          /*! ../style/MultilineTextStyle */
          "./columns/style/MultilineTextStyle.js");

          var MultilineTextColumn = /*#__PURE__*/function (_BaseColumn_1$BaseCol6) {
            _inherits(MultilineTextColumn, _BaseColumn_1$BaseCol6);

            var _super41 = _createSuper(MultilineTextColumn);

            function MultilineTextColumn() {
              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, MultilineTextColumn);

              return _super41.call(this, option);
            }

            _createClass(MultilineTextColumn, [{
              key: "StyleClass",
              get: function get() {
                return MultilineTextStyle_1.MultilineTextStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new MultilineTextColumn(this);
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, _grid, _ref44) {
                var drawCellBase = _ref44.drawCellBase,
                    getIcon = _ref44.getIcon;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    color = style.color,
                    font = style.font,
                    bgColor = style.bgColor,
                    padding = style.padding,
                    lineHeight = style.lineHeight,
                    autoWrapText = style.autoWrapText,
                    lineClamp = style.lineClamp,
                    textOverflow = style.textOverflow,
                    visibility = style.visibility;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                var textValue = value != null ? String(value) : "";
                var lines = textValue.replace(/\r?\n/g, "\n").replace(/\r/g, "\n").split("\n");
                helper.testFontLoad(font, textValue, context);
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  helper.multilineText(lines, context, {
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    color: color,
                    font: font,
                    padding: padding,
                    lineHeight: lineHeight,
                    autoWrapText: autoWrapText,
                    lineClamp: lineClamp,
                    textOverflow: textOverflow,
                    icons: icons
                  });
                });
              }
            }]);

            return MultilineTextColumn;
          }(BaseColumn_1.BaseColumn);

          exports.MultilineTextColumn = MultilineTextColumn;
          /***/
        },

        /***/
        "./columns/type/NumberColumn.js":
        /*!**************************************!*\
          !*** ./columns/type/NumberColumn.js ***!
          \**************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeNumberColumnJs(module, exports, __nested_webpack_require_498087__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.NumberColumn = void 0;

          var Column_1 = __nested_webpack_require_498087__(
          /*! ./Column */
          "./columns/type/Column.js");

          var NumberStyle_1 = __nested_webpack_require_498087__(
          /*! ../style/NumberStyle */
          "./columns/style/NumberStyle.js");

          var defaultFormat;

          var NumberColumn = /*#__PURE__*/function (_Column_1$Column3) {
            _inherits(NumberColumn, _Column_1$Column3);

            var _super42 = _createSuper(NumberColumn);

            function NumberColumn() {
              var _this58;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, NumberColumn);

              _this58 = _super42.call(this, option);
              _this58._format = option.format;
              return _this58;
            }

            _createClass(NumberColumn, [{
              key: "StyleClass",
              get: function get() {
                return NumberStyle_1.NumberStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new NumberColumn(this);
              }
            }, {
              key: "format",
              get: function get() {
                return this._format;
              }
            }, {
              key: "withFormat",
              value: function withFormat(format) {
                var c = this.clone();
                c._format = format;
                return c;
              }
            }, {
              key: "convertInternal",
              value: function convertInternal(value) {
                var num = Number(value);

                if (isNaN(num)) {
                  var convertedValue = _get(_getPrototypeOf(NumberColumn.prototype), "convertInternal", this).call(this, value);

                  return convertedValue != null ? String(convertedValue) : "";
                }

                var format = this._format || NumberColumn.defaultFormat;
                return format.format(num);
              }
            }], [{
              key: "defaultFormat",
              get: function get() {
                return defaultFormat || (defaultFormat = new Intl.NumberFormat());
              },
              set: function set(fmt) {
                defaultFormat = fmt;
              }
              /**
               * @deprecated Use defaultFormat instead
               */

            }, {
              key: "defaultFotmat",
              get: function get() {
                return this.defaultFormat;
              }
              /**
               * @deprecated Use defaultFormat instead
               */
              ,
              set: function set(fmt) {
                this.defaultFormat = fmt;
              }
            }]);

            return NumberColumn;
          }(Column_1.Column);

          exports.NumberColumn = NumberColumn;
          /***/
        },

        /***/
        "./columns/type/PercentCompleteBarColumn.js":
        /*!**************************************************!*\
          !*** ./columns/type/PercentCompleteBarColumn.js ***!
          \**************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypePercentCompleteBarColumnJs(module, exports, __nested_webpack_require_501671__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.PercentCompleteBarColumn = void 0;

          var utils_1 = __nested_webpack_require_501671__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var Column_1 = __nested_webpack_require_501671__(
          /*! ./Column */
          "./columns/type/Column.js");

          var PercentCompleteBarStyle_1 = __nested_webpack_require_501671__(
          /*! ../style/PercentCompleteBarStyle */
          "./columns/style/PercentCompleteBarStyle.js");

          var MARGIN = 2;

          var PercentCompleteBarColumn = /*#__PURE__*/function (_Column_1$Column4) {
            _inherits(PercentCompleteBarColumn, _Column_1$Column4);

            var _super43 = _createSuper(PercentCompleteBarColumn);

            function PercentCompleteBarColumn() {
              var _this59;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, PercentCompleteBarColumn);

              _this59 = _super43.call(this, option);
              _this59._min = option.min || 0;
              _this59._max = option.max || _this59._min + 100;

              _this59._formatter = option.formatter || function (v) {
                return v;
              };

              return _this59;
            }

            _createClass(PercentCompleteBarColumn, [{
              key: "StyleClass",
              get: function get() {
                return PercentCompleteBarStyle_1.PercentCompleteBarStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new PercentCompleteBarColumn(this);
              }
            }, {
              key: "min",
              get: function get() {
                return this.min;
              }
            }, {
              key: "max",
              get: function get() {
                return this.max;
              }
            }, {
              key: "formatter",
              get: function get() {
                return this.formatter;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, grid, info) {
                _get(_getPrototypeOf(PercentCompleteBarColumn.prototype), "drawInternal", this).call(this, this._formatter(value), context, style, helper, grid, info);

                var barColor = style.barColor,
                    barBgColor = style.barBgColor,
                    barHeight = style.barHeight,
                    visibility = style.visibility;

                if (visibility === "hidden") {
                  return;
                }

                var textValue = value != null ? String(value) : "";

                if (utils_1.str.endsWith(textValue, "%")) {
                  textValue = textValue.slice(0, -1);
                }

                var num = Number(textValue);

                if (isNaN(num)) {
                  return;
                }

                var rate = num < this._min ? 0 : num > this._max ? 1 : (num - this._min) / (this._max - this._min);
                helper.drawWithClip(context, function (ctx) {
                  var rect = context.getRect();
                  var barMaxWidth = rect.width - MARGIN * 2 - 1;
                  /*罫線*/

                  var barTop = rect.bottom - MARGIN - barHeight - 1;
                  /*罫線*/

                  var barLeft = rect.left + MARGIN;
                  ctx.fillStyle = (0, utils_1.getOrApply)(barBgColor, rate * 100) || "#f0f3f5";
                  ctx.beginPath();
                  ctx.rect(barLeft, barTop, barMaxWidth, barHeight);
                  ctx.fill();
                  var barSize = Math.min(barMaxWidth * rate, barMaxWidth);
                  ctx.fillStyle = (0, utils_1.getOrApply)(barColor, rate * 100) || "#20a8d8";
                  ctx.beginPath();
                  ctx.rect(barLeft, barTop, barSize, barHeight);
                  ctx.fill();
                });
              }
            }]);

            return PercentCompleteBarColumn;
          }(Column_1.Column);

          exports.PercentCompleteBarColumn = PercentCompleteBarColumn;
          /***/
        },

        /***/
        "./columns/type/RadioColumn.js":
        /*!*************************************!*\
          !*** ./columns/type/RadioColumn.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeRadioColumnJs(module, exports, __nested_webpack_require_506401__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.RadioColumn = void 0;

          var BaseColumn_1 = __nested_webpack_require_506401__(
          /*! ./BaseColumn */
          "./columns/type/BaseColumn.js");

          var RadioStyle_1 = __nested_webpack_require_506401__(
          /*! ../style/RadioStyle */
          "./columns/style/RadioStyle.js");

          var symbolManager_1 = __nested_webpack_require_506401__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_506401__(
          /*! ../utils */
          "./columns/utils/index.js");

          var RADIO_COLUMN_STATE_ID = (0, symbolManager_1.getRadioColumnStateId)();

          var RadioColumn = /*#__PURE__*/function (_BaseColumn_1$BaseCol7) {
            _inherits(RadioColumn, _BaseColumn_1$BaseCol7);

            var _super44 = _createSuper(RadioColumn);

            function RadioColumn() {
              _classCallCheck(this, RadioColumn);

              return _super44.apply(this, arguments);
            }

            _createClass(RadioColumn, [{
              key: "StyleClass",
              get: function get() {
                return RadioStyle_1.RadioStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new RadioColumn(this);
              }
            }, {
              key: "convertInternal",
              value: function convertInternal(value) {
                return (0, utils_1.toBoolean)(value);
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, grid, _ref45) {
                var drawCellBase = _ref45.drawCellBase;

                var _a;

                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    padding = style.padding,
                    checkColor = style.checkColor,
                    uncheckBorderColor = style.uncheckBorderColor,
                    checkBorderColor = style.checkBorderColor,
                    uncheckBgColor = style.uncheckBgColor,
                    checkBgColor = style.checkBgColor,
                    bgColor = style.bgColor,
                    visibility = style.visibility;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                if (visibility === "hidden") {
                  return;
                }

                var col = context.col,
                    row = context.row;
                var range = grid.getCellRange(col, row);
                var cellKey = "".concat(range.start.col, ":").concat(range.start.row);
                var elapsed = (_a = grid[RADIO_COLUMN_STATE_ID]) === null || _a === void 0 ? void 0 : _a.elapsed[cellKey];
                var opt = {
                  textAlign: textAlign,
                  textBaseline: textBaseline,
                  checkColor: checkColor,
                  uncheckBorderColor: uncheckBorderColor,
                  checkBorderColor: checkBorderColor,
                  uncheckBgColor: uncheckBgColor,
                  checkBgColor: checkBgColor,
                  padding: padding
                };

                if (elapsed != null) {
                  opt.animElapsedTime = elapsed;
                }

                helper.radioButton(value, context, opt);
              }
            }]);

            return RadioColumn;
          }(BaseColumn_1.BaseColumn);

          exports.RadioColumn = RadioColumn;
          /***/
        },

        /***/
        "./columns/type/TreeColumn.js":
        /*!************************************!*\
          !*** ./columns/type/TreeColumn.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeTreeColumnJs(module, exports, __nested_webpack_require_510531__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.getTreeNodeInfoAt = exports.TreeColumn = void 0;

          var inlineUtils = __importStar(__nested_webpack_require_510531__(
          /*! ../../element/inlines */
          "./element/inlines.js"));

          var utils = __importStar(__nested_webpack_require_510531__(
          /*! ../../columns/type/columnUtils */
          "./columns/type/columnUtils.js"));

          var Column_1 = __nested_webpack_require_510531__(
          /*! ./Column */
          "./columns/type/Column.js");

          var Rect_1 = __nested_webpack_require_510531__(
          /*! ../../internal/Rect */
          "./internal/Rect.js");

          var TreeStyle_1 = __nested_webpack_require_510531__(
          /*! ../style/TreeStyle */
          "./columns/style/TreeStyle.js");

          var canvases_1 = __nested_webpack_require_510531__(
          /*! ../../internal/canvases */
          "./internal/canvases.js");

          var symbolManager_1 = __nested_webpack_require_510531__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_510531__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var _ = (0, symbolManager_1.getTreeColumnStateId)();

          var TreeColumn = /*#__PURE__*/function (_Column_1$Column5) {
            _inherits(TreeColumn, _Column_1$Column5);

            var _super45 = _createSuper(TreeColumn);

            function TreeColumn() {
              var _this60;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, TreeColumn);

              _this60 = _super45.call(this, option);
              _this60._cache = option.cache != null ? option.cache : false;
              return _this60;
            }

            _createClass(TreeColumn, [{
              key: "StyleClass",
              get: function get() {
                return TreeStyle_1.TreeStyle;
              }
            }, {
              key: "clearCache",
              value: function clearCache(grid) {
                var internal = grid;
                if (!internal[_]) return;
                delete internal[_].cache;
              }
            }, {
              key: "drawnIconActionArea",
              get: function get() {
                return function (param) {
                  var internal = param.grid;
                  var state = internal[_];
                  if (!(state === null || state === void 0 ? void 0 : state.drawnIcons)) return false;
                  var drawnIcons = state.drawnIcons;
                  return drawnIcons.area(param);
                };
              }
            }, {
              key: "onDrawCell",
              value: function onDrawCell(cellValue, info, context, grid) {
                var state = grid[_] || (grid[_] = {});

                if (this._cache && !state.cache) {
                  var cache = state.cache || (state.cache = new Map());
                  var col = context.col,
                      row = context.row;
                  var field = grid.getField(col, row);

                  if (!cache.has(field)) {
                    cache.set(field, new TreeColumnInfo(grid, field));
                  }
                }

                return _get(_getPrototypeOf(TreeColumn.prototype), "onDrawCell", this).call(this, cellValue, info, context, grid);
              }
            }, {
              key: "clone",
              value: function clone() {
                return new TreeColumn(this);
              }
            }, {
              key: "cache",
              get: function get() {
                return this._cache;
              }
            }, {
              key: "getCopyCellValue",
              value: function getCopyCellValue(value) {
                var treeData = getTreeDataFromValue(value);
                return treeData.caption;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, grid, _ref46) {
                var drawCellBase = _ref46.drawCellBase,
                    getIcon = _ref46.getIcon;

                var _a, _b;

                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    bgColor = style.bgColor,
                    padding = style.padding,
                    color = style.color,
                    font = style.font,
                    textOverflow = style.textOverflow;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                var state = grid[_] || (grid[_] = {});

                if (state.drawnIcons) {
                  var drawnIcons = state.drawnIcons;
                  drawnIcons.delete(context);
                }

                var col = context.col,
                    row = context.row;
                var field = grid.getField(col, row);
                var tci = (_b = this._cache ? (_a = state.cache) === null || _a === void 0 ? void 0 : _a.get(field) : null) !== null && _b !== void 0 ? _b : new TreeColumnInfo(grid, field);
                var info = tci.getInfo(value, row);
                helper.testFontLoad(font, info.caption, context);
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  var rect = context.getRect();
                  var basePadding = helper.toBoxPixelArray(padding || 0, context, font);
                  var nestLevel = info.path.length;
                  helper.drawWithClip(context, function (ctx) {
                    var fontSize = (0, canvases_1.getFontSize)(ctx, font);
                    var indentSize = fontSize.width;
                    var top = rect.top + basePadding[0];
                    var left = rect.left + basePadding[3];
                    var height = rect.height - basePadding[0] - basePadding[2];
                    var lineBaseline = textBaseline !== null && textBaseline !== void 0 ? textBaseline : ctx.textBaseline || "middle"; // Calculate horizontal line position

                    var hLineY = top + height / 2;

                    if (lineBaseline === "bottom" || lineBaseline === "alphabetic" || lineBaseline === "ideographic") {
                      // bottom
                      hLineY = top + height - fontSize.height / 2;
                    } else if (textBaseline === "middle") {
                      hLineY = top + height / 2;
                    } else {
                      // top
                      hLineY = top + fontSize.height / 2;
                    } // Get the tree icon


                    var definedTreeIcon = style.treeIcon || helper.getStyleProperty(helper.theme.tree.treeIcon, col, row, ctx);
                    var treeIcon = definedTreeIcon === "none" ? null : definedTreeIcon === "chevron_right" || definedTreeIcon === "expand_more" ? {
                      name: definedTreeIcon,
                      width: fontSize.width
                    } : definedTreeIcon; // Calculate icon rect

                    var iconRect = null;

                    if (treeIcon) {
                      ctx.save();

                      try {
                        var treeLineLeft = left + indentSize * (nestLevel - 1);
                        var vLineX = treeLineLeft + indentSize / 2;
                        var size = inlineUtils.iconOf(treeIcon).width({
                          ctx: ctx
                        });
                        iconRect = new Rect_1.Rect(vLineX - size / 2, hLineY - size / 2, size, size);
                      } finally {
                        ctx.restore();
                      } // It preserves the position of the drawn icon
                      // because it is used for the `area` option of the `Action` class.


                      var _drawnIcons = state.drawnIcons || (state.drawnIcons = new DrawnIcons());

                      _drawnIcons.set(context, iconRect);
                    } // Get tree line color


                    var lineStyle = style.lineStyle || helper.theme.tree.lineStyle;

                    if (lineStyle !== "none") {
                      var lineWidth = style.lineWidth || helper.theme.tree.lineWidth;
                      var lineColor = style.lineColor || helper.getColor(helper.theme.tree.lineColor, col, row, ctx);
                      ctx.save();

                      try {
                        ctx.strokeStyle = lineColor;
                        ctx.lineWidth = lineWidth;
                        ctx.lineCap = "round";

                        if (iconRect) {
                          // Clip icon area
                          ctx.beginPath();
                          ctx.rect(0, 0, ctx.canvas.width, ctx.canvas.height); // Draw a square in the opposite direction to hollow out the inside.

                          ctx.rect(iconRect.right, iconRect.top, -iconRect.width, iconRect.height); // // For debug
                          // ctx.fillStyle = "#0002";
                          // ctx.fill();

                          ctx.clip();
                        } // Draw tree lines


                        info.getLines().forEach(function (line, index) {
                          var treeLineLeft = left + indentSize * index;
                          var vLineX = treeLineLeft + indentSize / 2;
                          var treeLineRight = treeLineLeft + indentSize;

                          if (line !== 0
                          /* TreeLineKind.none */
                          ) {
                              ctx.beginPath();

                              if (line === 1
                              /* TreeLineKind.vertical */
                              ) {
                                  ctx.moveTo(vLineX, rect.top);
                                  ctx.lineTo(vLineX, rect.bottom);
                                } else if (line === 2
                              /* TreeLineKind.last */
                              ) {
                                  ctx.moveTo(vLineX, rect.top);
                                  ctx.lineTo(vLineX, hLineY);
                                  ctx.lineTo(treeLineRight, hLineY);
                                } else if (line === 3
                              /* TreeLineKind.start */
                              ) {
                                  ctx.moveTo(treeLineRight, hLineY);
                                  ctx.lineTo(vLineX, hLineY);
                                  ctx.lineTo(vLineX, rect.bottom);
                                } else if (line === 4
                              /* TreeLineKind.verticalBranch */
                              ) {
                                  ctx.moveTo(vLineX, rect.top);
                                  ctx.lineTo(vLineX, rect.bottom);
                                  ctx.moveTo(vLineX, hLineY);
                                  ctx.lineTo(treeLineRight, hLineY);
                                } else if (line === 5
                              /* TreeLineKind.horizontal */
                              ) {
                                  ctx.moveTo(treeLineLeft, hLineY);
                                  ctx.lineTo(treeLineRight, hLineY);
                                } else if (line === 6
                              /* TreeLineKind.horizontalBranch */
                              ) {
                                  ctx.moveTo(treeLineLeft, hLineY);
                                  ctx.lineTo(treeLineRight, hLineY);
                                  ctx.moveTo(vLineX, hLineY);
                                  ctx.lineTo(vLineX, rect.bottom);
                                } else if (line === 7
                              /* TreeLineKind.lone */
                              ) {
                                  ctx.moveTo(vLineX, hLineY);
                                  ctx.lineTo(treeLineRight, hLineY);
                                }

                              ctx.stroke();
                            }
                        });
                      } finally {
                        ctx.restore();
                      }
                    }

                    if (treeIcon) {
                      // Draw tree icon
                      var iconLeftOffset = indentSize * (nestLevel - 1);
                      var iconWidth = indentSize;
                      var iconPadding = basePadding.slice(0);
                      iconPadding[3] += iconLeftOffset;
                      iconPadding[1] = rect.width - iconWidth - iconPadding[3]; // padding right

                      helper.text("", context, {
                        textAlign: "center",
                        textBaseline: textBaseline,
                        color: color,
                        font: font,
                        icons: [treeIcon],
                        padding: iconPadding
                      });
                    }

                    var textPadding = basePadding.slice(0);
                    textPadding[3] += nestLevel * indentSize; // Tree indent padding

                    helper.text(info.caption, context, {
                      textAlign: textAlign,
                      textBaseline: textBaseline,
                      color: color,
                      font: font,
                      padding: textPadding,
                      textOverflow: textOverflow,
                      icons: icons
                    });
                  });
                });
              }
            }]);

            return TreeColumn;
          }(Column_1.Column);

          exports.TreeColumn = TreeColumn;
          /**
           * If the cell is a TreeColumn, gets the tree node information from the given cell.
           */

          function getTreeNodeInfoAt(_ref47) {
            var grid = _ref47.grid,
                col = _ref47.col,
                row = _ref47.row;
            var field = grid.getField(col, row);
            if (!field) return {
              hasChildren: false,
              nodeType: "leaf"
            };
            var dataSource = grid.dataSource;
            var currIndex = grid.getRecordIndexByRow(row);
            var value = dataSource.getField(currIndex, field);
            var treeData = getTreeDataFromValue(value);
            var hasChildren = hasChildrenByRecord(treeData, dataSource, field, currIndex);
            return {
              nodeType: hasChildren ? "branch" : treeData.nodeType || "leaf",
              hasChildren: hasChildren
            };
          }

          exports.getTreeNodeInfoAt = getTreeNodeInfoAt;

          function hasChildrenByRecord(treeData, dataSource, field, recordIndex) {
            var next = dataSource.getField(recordIndex + 1, field);
            if (!next || (0, utils_1.isPromise)(next)) return false;
            var nextParentPath = getParentPath(next);
            return treeData.path.length === nextParentPath.length && nextParentPath.every(function (p, i) {
              return p === treeData.path[i];
            });
          }

          var TreeColumnInfo = /*#__PURE__*/function () {
            function TreeColumnInfo(grid, field) {
              _classCallCheck(this, TreeColumnInfo);

              this._cache = {};
              this._grid = grid;
              this._field = field;
            }

            _createClass(TreeColumnInfo, [{
              key: "getInfo",
              value: function getInfo(value, row) {
                var field = this._field,
                    grid = this._grid,
                    cache = this._cache;
                var currIndex = grid.getRecordIndexByRow(row);
                var dataSource = grid.dataSource;
                var treeData = getTreeDataFromValue(value);
                var hasChildren = hasChildrenByRecord(treeData, dataSource, field, currIndex);
                return {
                  caption: treeData.caption,
                  path: treeData.path,
                  getLines: function getLines() {
                    var currPath = [];
                    var parentPath = treeData.path.slice(0, -1);
                    var parentLines = parentPath.map(function (p, index) {
                      currPath.push(p);
                      var isLast = index === parentPath.length - 1;

                      if (hasNextSiblingWithCache(currPath)) {
                        return isLast ? 4
                        /* TreeLineKind.verticalBranch */
                        : 1
                        /* TreeLineKind.vertical */
                        ;
                      } else {
                        return isLast ? 2
                        /* TreeLineKind.last */
                        : 0
                        /* TreeLineKind.none */
                        ;
                      }
                    });
                    var selfLine;

                    if (hasChildren) {
                      selfLine = parentPath.length > 0 ? 6
                      /* TreeLineKind.horizontalBranch */
                      : 3
                      /* TreeLineKind.start */
                      ;
                    } else {
                      selfLine = parentPath.length > 0 ? 5
                      /* TreeLineKind.horizontal */
                      : 7
                      /* TreeLineKind.lone */
                      ;
                    }

                    return parentLines.concat(selfLine);
                  }
                };

                function hasNextSiblingWithCache(parentPath) {
                  var has = hasNextSiblingFromCache(currIndex, parentPath.length);

                  if (has != null) {
                    return has;
                  }

                  var result = hasNextSibling(parentPath);

                  for (var index = currIndex; index < result.end; index++) {
                    setNextSiblingToCache(index, parentPath.length, result.has);
                  }

                  return result.has;
                }

                function hasNextSiblingFromCache(index, level) {
                  var _ref48 = cache[index] || (cache[index] = {
                    hasNextSiblings: []
                  }),
                      hasNextSiblings = _ref48.hasNextSiblings;

                  return hasNextSiblings[level];
                }

                function setNextSiblingToCache(index, level, value) {
                  var _ref49 = cache[index] || (cache[index] = {
                    hasNextSiblings: []
                  }),
                      hasNextSiblings = _ref49.hasNextSiblings;

                  hasNextSiblings[level] = value;
                }

                function hasNextSibling(parentPath) {
                  var startIndex = currIndex + 1;

                  var _loop5 = function _loop5(index) {
                    var data = dataSource.getField(index, field);
                    if ((0, utils_1.isPromise)(data)) return {
                      v: {
                        end: index,
                        has: false
                      }
                    };
                    var nextPath = getParentPath(data);
                    if (!nextPath.length) return {
                      v: {
                        end: index,
                        has: false
                      }
                    };

                    if (parentPath.every(function (p, i) {
                      return p === nextPath[i];
                    })) {
                      // All matches!
                      if (parentPath.length < nextPath.length) {
                        // It's a child.
                        // e.g.
                        // ├ target
                        // │ ├ next
                        var has = hasNextSiblingFromCache(index, parentPath.length);
                        if (has != null) return {
                          v: {
                            end: index,
                            has: has
                          }
                        };
                        return "continue";
                      } // There is next sibling.
                      // e.g.
                      // ├ target
                      // │ ├ x
                      // │ └ x
                      // └ next


                      return {
                        v: {
                          end: index,
                          has: true
                        }
                      };
                    } // There is no next sibling.
                    // e.g.
                    // │ └ target
                    // │   ├ x
                    // │   └ x
                    // └ next


                    return {
                      v: {
                        end: index,
                        has: false
                      }
                    };
                  };

                  for (var index = startIndex; index < dataSource.length; index++) {
                    var _ret = _loop5(index);

                    if (_ret === "continue") continue;
                    if (_typeof(_ret) === "object") return _ret.v;
                  } // There is no next sibling.


                  return {
                    end: dataSource.length,
                    has: false
                  };
                }
              }
            }]);

            return TreeColumnInfo;
          }();

          function getTreeDataFromValue(value) {
            var _a, _b;

            if (value != null) {
              if (Array.isArray(value)) {
                return getTreeDataFromValue({
                  path: value
                });
              } else {
                if (Array.isArray(value.path)) return {
                  caption: String((_b = (_a = value.caption) !== null && _a !== void 0 ? _a : value.path[value.path.length - 1]) !== null && _b !== void 0 ? _b : ""),
                  path: value.path,
                  nodeType: value.nodeType
                };
                if (typeof value.path === "function") return getTreeDataFromValue(Object.assign(Object.assign({}, value), {
                  path: value.path()
                }));
              }
            }

            return {
              caption: String(value !== null && value !== void 0 ? value : ""),
              path: [value]
            };
          }

          function getParentPath(value) {
            return getTreeDataFromValue(value).path.slice(0, -1);
          }

          var DrawnIcons = /*#__PURE__*/function () {
            function DrawnIcons() {
              _classCallCheck(this, DrawnIcons);

              this._drawnIcons = new Map();
            }

            _createClass(DrawnIcons, [{
              key: "set",
              value: function set(cell, clipRect) {
                this._drawnIcons.set("".concat(cell.col, ":").concat(cell.row), clipRect);
              }
            }, {
              key: "delete",
              value: function _delete(cell) {
                this._drawnIcons.delete("".concat(cell.col, ":").concat(cell.row));
              }
            }, {
              key: "area",
              value: function area(_ref50) {
                var col = _ref50.col,
                    row = _ref50.row,
                    point = _ref50.pointInDrawingCanvas;
                var key = "".concat(col, ":").concat(row);

                var rect = this._drawnIcons.get(key);

                if (!rect) {
                  return false;
                }

                return rect.left <= point.x && point.x <= rect.right && rect.top <= point.y && point.y <= rect.bottom;
              }
            }]);

            return DrawnIcons;
          }();
          /***/

        },

        /***/
        "./columns/type/columnUtils.js":
        /*!*************************************!*\
          !*** ./columns/type/columnUtils.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsTypeColumnUtilsJs(module, exports, __nested_webpack_require_536257__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.loadIcons = void 0;

          var icons = __importStar(__nested_webpack_require_536257__(
          /*! ../../internal/icons */
          "./internal/icons.js"));

          var utils_1 = __nested_webpack_require_536257__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          function loadIcons(icon, context, helper, callback) {
            var argIcon = undefined;

            if (icon) {
              if ((0, utils_1.isPromise)(icon)) {
                icon.then(function (i) {
                  loadIcons(i, context.toCurrentContext(), helper, callback);
                });
              } else {
                var iconList = icons.toNormalizeArray(icon);
                iconList.forEach(function (i) {
                  if (i.font && i.content) {
                    helper.testFontLoad(i.font, i.content, context);
                  }
                });
                argIcon = iconList;
              }
            }

            callback(argIcon, context);
          }

          exports.loadIcons = loadIcons;
          /***/
        },

        /***/
        "./columns/utils/index.js":
        /*!********************************!*\
          !*** ./columns/utils/index.js ***!
          \********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function columnsUtilsIndexJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.toBoolean = void 0;

          function toBoolean(val) {
            if (typeof val === "string") {
              if (val === "false") {
                return false;
              } else if (val === "off") {
                return false;
              } else if (/^0+$/.exec(val)) {
                return false;
              }
            }

            return Boolean(val);
          }

          exports.toBoolean = toBoolean;
          /***/
        },

        /***/
        "./core.js":
        /*!*****************!*\
          !*** ./core.js ***!
          \*****************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function coreJs(module, exports, __nested_webpack_require_540157__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.EVENT_TYPE = exports.DrawGrid = void 0;

          var DrawGrid_1 = __nested_webpack_require_540157__(
          /*! ./core/DrawGrid */
          "./core/DrawGrid.js");

          Object.defineProperty(exports, "DrawGrid", {
            enumerable: true,
            get: function get() {
              return DrawGrid_1.DrawGrid;
            }
          });

          var DG_EVENT_TYPE_1 = __nested_webpack_require_540157__(
          /*! ./core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          Object.defineProperty(exports, "EVENT_TYPE", {
            enumerable: true,
            get: function get() {
              return DG_EVENT_TYPE_1.DG_EVENT_TYPE;
            }
          });
          /***/
        },

        /***/
        "./core/DG_EVENT_TYPE.js":
        /*!*******************************!*\
          !*** ./core/DG_EVENT_TYPE.js ***!
          \*******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function coreDG_EVENT_TYPEJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.DG_EVENT_TYPE = void 0;
          /**
           * DrawGrid event types
           * @classdesc cheetahGrid.core.EVENT_TYPE
           * @memberof cheetahGrid.core
           */

          exports.DG_EVENT_TYPE = {
            CLICK_CELL: "click_cell",
            DBLCLICK_CELL: "dblclick_cell",
            DBLTAP_CELL: "dbltap_cell",
            MOUSEDOWN_CELL: "mousedown_cell",
            MOUSEUP_CELL: "mouseup_cell",
            SELECTED_CELL: "selected_cell",
            KEYDOWN: "keydown",
            MOUSEMOVE_CELL: "mousemove_cell",
            MOUSEENTER_CELL: "mouseenter_cell",
            MOUSELEAVE_CELL: "mouseleave_cell",
            MOUSEOVER_CELL: "mouseover_cell",
            MOUSEOUT_CELL: "mouseout_cell",
            TOUCHSTART_CELL: "touchstart_cell",
            CONTEXTMENU_CELL: "contextmenu_cell",
            INPUT_CELL: "input_cell",
            PASTE_CELL: "paste_cell",
            DELETE_CELL: "delete_cell",
            EDITABLEINPUT_CELL: "editableinput_cell",
            MODIFY_STATUS_EDITABLEINPUT_CELL: "modify_status_editableinput_cell",
            RESIZE_COLUMN: "resize_column",
            SCROLL: "scroll",
            FOCUS_GRID: "focus_grid",
            BLUR_GRID: "blur_grid"
          };
          /***/
        },

        /***/
        "./core/DrawGrid.js":
        /*!**************************!*\
          !*** ./core/DrawGrid.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function coreDrawGridJs(module, exports, __nested_webpack_require_543174__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.DrawGrid = void 0;

          var calc = __importStar(__nested_webpack_require_543174__(
          /*! ../internal/calc */
          "./internal/calc.js"));

          var hiDPI = __importStar(__nested_webpack_require_543174__(
          /*! ../internal/hiDPI */
          "./internal/hiDPI.js"));

          var style = __importStar(__nested_webpack_require_543174__(
          /*! ../internal/style */
          "./internal/style.js"));

          var utils_1 = __nested_webpack_require_543174__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var paste_utils_1 = __nested_webpack_require_543174__(
          /*! ../internal/paste-utils */
          "./internal/paste-utils.js");

          var DG_EVENT_TYPE_1 = __nested_webpack_require_543174__(
          /*! ./DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var EventHandler_1 = __nested_webpack_require_543174__(
          /*! ../internal/EventHandler */
          "./internal/EventHandler.js");

          var EventTarget_1 = __nested_webpack_require_543174__(
          /*! ./EventTarget */
          "./core/EventTarget.js");

          var NumberMap_1 = __nested_webpack_require_543174__(
          /*! ../internal/NumberMap */
          "./internal/NumberMap.js");

          var Rect_1 = __nested_webpack_require_543174__(
          /*! ../internal/Rect */
          "./internal/Rect.js");

          var Scrollable_1 = __nested_webpack_require_543174__(
          /*! ../internal/Scrollable */
          "./internal/Scrollable.js");

          var canvases_1 = __nested_webpack_require_543174__(
          /*! ../internal/canvases */
          "./internal/canvases.js"); //protected symbol


          var symbolManager_1 = __nested_webpack_require_543174__(
          /*! ../internal/symbolManager */
          "./internal/symbolManager.js");

          var _utils_1$event = utils_1.event,
              isTouchEvent = _utils_1$event.isTouchEvent,
              getMouseButtons = _utils_1$event.getMouseButtons,
              getKeyCode = _utils_1$event.getKeyCode,
              cancelEvent = _utils_1$event.cancel;
          /** @private */

          var _ = (0, symbolManager_1.getProtectedSymbol)();
          /** @private */


          function createRootElement() {
            var element = document.createElement("div");
            element.classList.add("cheetah-grid");
            return element;
          }
          /** @private */


          var KEY_BS = 8;
          /** @private */

          var KEY_TAB = 9;
          /** @private */

          var KEY_ENTER = 13;
          /** @private */

          var KEY_END = 35;
          /** @private */

          var KEY_HOME = 36;
          /** @private */

          var KEY_LEFT = 37;
          /** @private */

          var KEY_UP = 38;
          /** @private */

          var KEY_RIGHT = 39;
          /** @private */

          var KEY_DOWN = 40;
          /** @private */

          var KEY_DEL = 46;
          /** @private */

          var KEY_ALPHA_A = 65;
          /** @private */

          var KEY_ALPHA_C = 67;
          /** @private */

          var KEY_ALPHA_V = 86; //private methods

          /** @private */

          function _vibrate(e) {
            if (navigator.vibrate && isTouchEvent(e)) {
              navigator.vibrate(50);
            }
          }
          /** @private */


          function _getTargetRowAt(absoluteY) {
            var _this61 = this;

            var internal = this.getTargetRowAtInternal(absoluteY);

            if (internal != null) {
              return internal;
            }

            var findBefore = function findBefore(startRow, startBottom) {
              var bottom = startBottom;

              for (var row = startRow; row >= 0; row--) {
                var height = _getRowHeight.call(_this61, row);

                var top = bottom - height;

                if (top <= absoluteY && absoluteY < bottom) {
                  return {
                    top: top,
                    row: row
                  };
                }

                bottom = top;
              }

              return null;
            };

            var findAfter = function findAfter(startRow, startBottom) {
              var top = startBottom - _getRowHeight.call(_this61, startRow);

              var rowCount = _this61[_].rowCount;

              for (var row = startRow; row < rowCount; row++) {
                var height = _getRowHeight.call(_this61, row);

                var _bottom = top + height;

                if (top <= absoluteY && absoluteY < _bottom) {
                  return {
                    top: top,
                    row: row
                  };
                }

                top = _bottom;
              }

              return null;
            };

            var candidateRow = Math.min(Math.ceil(absoluteY / this[_].defaultRowHeight), this.rowCount - 1);

            var bottom = _getRowsHeight.call(this, 0, candidateRow);

            if (absoluteY >= bottom) {
              return findAfter(candidateRow, bottom);
            } else {
              return findBefore(candidateRow, bottom);
            }
          }
          /** @private */


          function _getTargetColAt(grid, absoluteX) {
            var left = 0;
            var colCount = grid[_].colCount;

            for (var col = 0; col < colCount; col++) {
              var width = _getColWidth(grid, col);

              var right = left + width;

              if (right > absoluteX) {
                return {
                  left: left,
                  col: col
                };
              }

              left = right;
            }

            return null;
          }
          /** @private */


          function _getTargetFrozenRowAt(grid, absoluteY) {
            if (!grid[_].frozenRowCount) {
              return null;
            }

            var top = grid[_].scroll.top;
            var rowCount = grid[_].frozenRowCount;

            for (var row = 0; row < rowCount; row++) {
              var height = _getRowHeight.call(grid, row);

              var bottom = top + height;

              if (bottom > absoluteY) {
                return {
                  top: top,
                  row: row
                };
              }

              top = bottom;
            }

            return null;
          }
          /** @private */


          function _getTargetFrozenColAt(grid, absoluteX) {
            if (!grid[_].frozenColCount) {
              return null;
            }

            var left = grid[_].scroll.left;
            var colCount = grid[_].frozenColCount;

            for (var col = 0; col < colCount; col++) {
              var width = _getColWidth(grid, col);

              var right = left + width;

              if (right > absoluteX) {
                return {
                  left: left,
                  col: col
                };
              }

              left = right;
            }

            return null;
          }
          /** @private */


          function _getFrozenRowsRect(grid) {
            if (!grid[_].frozenRowCount) {
              return null;
            }

            var top = grid[_].scroll.top;
            var height = 0;
            var rowCount = grid[_].frozenRowCount;

            for (var row = 0; row < rowCount; row++) {
              height += _getRowHeight.call(grid, row);
            }

            return new Rect_1.Rect(grid[_].scroll.left, top, grid[_].canvas.width, height);
          }
          /** @private */


          function _getFrozenColsRect(grid) {
            if (!grid[_].frozenColCount) {
              return null;
            }

            var left = grid[_].scroll.left;
            var width = 0;
            var colCount = grid[_].frozenColCount;

            for (var col = 0; col < colCount; col++) {
              width += _getColWidth(grid, col);
            }

            return new Rect_1.Rect(left, grid[_].scroll.top, width, grid[_].canvas.height);
          }
          /** @private */


          function _getCellDrawing(grid, col, row) {
            if (!grid[_].drawCells[row]) {
              return null;
            }

            return grid[_].drawCells[row][col];
          }
          /** @private */


          function _putCellDrawing(grid, col, row, context) {
            if (!grid[_].drawCells[row]) {
              grid[_].drawCells[row] = {};
            }

            grid[_].drawCells[row][col] = context;
          }
          /** @private */


          function _removeCellDrawing(grid, col, row) {
            if (!grid[_].drawCells[row]) {
              return;
            }

            delete grid[_].drawCells[row][col];

            if (Object.keys(grid[_].drawCells[row]).length === 0) {
              delete grid[_].drawCells[row];
            }
          }
          /** @private */


          function _drawCell(ctx, col, absoluteLeft, width, row, absoluteTop, height, visibleRect, skipAbsoluteTop, skipAbsoluteLeft, drawLayers) {
            var _this62 = this;

            var rect = new Rect_1.Rect(absoluteLeft - visibleRect.left, absoluteTop - visibleRect.top, width, height);
            var drawRect = Rect_1.Rect.bounds(Math.max(absoluteLeft, skipAbsoluteLeft) - visibleRect.left, Math.max(absoluteTop, skipAbsoluteTop) - visibleRect.top, rect.right, rect.bottom);

            if (drawRect.height > 0 && drawRect.width > 0) {
              ctx.save();

              try {
                var cellDrawing = _getCellDrawing(this, col, row);

                if (cellDrawing) {
                  cellDrawing.cancel();
                }

                var dcContext = new DrawCellContext(col, row, ctx, rect, drawRect, !!cellDrawing, this[_].selection, drawLayers);
                var p = this.onDrawCell(col, row, dcContext);

                if ((0, utils_1.isPromise)(p)) {
                  //遅延描画
                  _putCellDrawing(this, col, row, dcContext);

                  var pCol = col;

                  dcContext._delayMode(this, function () {
                    _removeCellDrawing(_this62, pCol, row);
                  });

                  p.then(function () {
                    dcContext.terminate();
                  });
                }
              } finally {
                ctx.restore();
              }
            }
          }
          /** @private */


          function _drawRow(grid, ctx, initFrozenCol, initCol, drawRight, row, absoluteTop, height, visibleRect, skipAbsoluteTop, drawLayers) {
            var colCount = grid[_].colCount;

            var drawOuter = function drawOuter(col, absoluteLeft) {
              //データ範囲外の描画
              if (col >= colCount - 1 && grid[_].canvas.width > absoluteLeft - visibleRect.left) {
                var outerLeft = absoluteLeft - visibleRect.left;
                ctx.save();
                ctx.beginPath();
                ctx.fillStyle = grid.underlayBackgroundColor || "#F6F6F6";
                ctx.rect(outerLeft, absoluteTop - visibleRect.top, grid[_].canvas.width - outerLeft, height);
                ctx.fill();
                ctx.restore();
              }
            };

            var skipAbsoluteLeft = 0;

            if (initFrozenCol) {
              var _absoluteLeft = initFrozenCol.left;
              var count = grid[_].frozenColCount;

              for (var col = initFrozenCol.col; col < count; col++) {
                var width = _getColWidth(grid, col);

                _drawCell.call(grid, ctx, col, _absoluteLeft, width, row, absoluteTop, height, visibleRect, skipAbsoluteTop, 0, drawLayers);

                _absoluteLeft += width;

                if (drawRight <= _absoluteLeft) {
                  //描画範囲外（終了）
                  drawOuter(col, _absoluteLeft);
                  return;
                }
              }

              skipAbsoluteLeft = _absoluteLeft;
            }

            var absoluteLeft = initCol.left;

            for (var _col2 = initCol.col; _col2 < colCount; _col2++) {
              var _width2 = _getColWidth(grid, _col2);

              _drawCell.call(grid, ctx, _col2, absoluteLeft, _width2, row, absoluteTop, height, visibleRect, skipAbsoluteTop, skipAbsoluteLeft, drawLayers);

              absoluteLeft += _width2;

              if (drawRight <= absoluteLeft) {
                //描画範囲外（終了）
                drawOuter(_col2, absoluteLeft);
                return;
              }
            }

            drawOuter(colCount - 1, absoluteLeft);
          }
          /** @private */


          function _getInitContext() {
            return this._getInitContext();
          }
          /** @private */


          function _invalidateRect(grid, drawRect) {
            var visibleRect = _getVisibleRect(grid);

            var rowCount = grid[_].rowCount;

            var ctx = _getInitContext.call(grid);

            var initRow = _getTargetRowAt.call(grid, Math.max(visibleRect.top, drawRect.top)) || {
              top: _getRowsHeight.call(grid, 0, rowCount - 1),
              row: rowCount
            };
            var initCol = _getTargetColAt(grid, Math.max(visibleRect.left, drawRect.left)) || {
              left: _getColsWidth(grid, 0, grid[_].colCount - 1),
              col: grid[_].colCount
            };
            var drawBottom = Math.min(visibleRect.bottom, drawRect.bottom);
            var drawRight = Math.min(visibleRect.right, drawRect.right);

            var initFrozenRow = _getTargetFrozenRowAt(grid, Math.max(visibleRect.top, drawRect.top));

            var initFrozenCol = _getTargetFrozenColAt(grid, Math.max(visibleRect.left, drawRect.left));

            var drawLayers = new DrawLayers();

            var drawOuter = function drawOuter(row, absoluteTop) {
              //データ範囲外の描画
              if (row >= rowCount - 1 && grid[_].canvas.height > absoluteTop - visibleRect.top) {
                var outerTop = absoluteTop - visibleRect.top;
                ctx.save();
                ctx.beginPath();
                ctx.fillStyle = grid.underlayBackgroundColor || "#F6F6F6";
                ctx.rect(0, outerTop, grid[_].canvas.width, grid[_].canvas.height - outerTop);
                ctx.fill();
                ctx.restore();
              }
            };

            var skipAbsoluteTop = 0;

            if (initFrozenRow) {
              var _absoluteTop = initFrozenRow.top;
              var count = grid[_].frozenRowCount;

              for (var row = initFrozenRow.row; row < count; row++) {
                var height = _getRowHeight.call(grid, row);

                _drawRow(grid, ctx, initFrozenCol, initCol, drawRight, row, _absoluteTop, height, visibleRect, 0, drawLayers);

                _absoluteTop += height;

                if (drawBottom <= _absoluteTop) {
                  //描画範囲外（終了）
                  drawOuter(row, _absoluteTop);
                  drawLayers.draw(ctx);
                  return;
                }
              }

              skipAbsoluteTop = _absoluteTop;
            }

            var absoluteTop = initRow.top;

            for (var _row2 = initRow.row; _row2 < rowCount; _row2++) {
              var _height2 = _getRowHeight.call(grid, _row2); //行の描画


              _drawRow(grid, ctx, initFrozenCol, initCol, drawRight, _row2, absoluteTop, _height2, visibleRect, skipAbsoluteTop, drawLayers);

              absoluteTop += _height2;

              if (drawBottom <= absoluteTop) {
                //描画範囲外（終了）
                drawOuter(_row2, absoluteTop);
                drawLayers.draw(ctx);
                return;
              }
            }

            drawOuter(rowCount - 1, absoluteTop);
            drawLayers.draw(ctx);
          }
          /** @private */


          function _toPxWidth(grid, width) {
            return Math.round(calc.toPx(width, grid[_].calcWidthContext));
          }
          /** @private */


          function _adjustColWidth(grid, col, orgWidth) {
            var limits = _getColWidthLimits(grid, col);

            return Math.max(_applyColWidthLimits(limits, orgWidth), 0);
          }
          /** @private */


          function _applyColWidthLimits(limits, orgWidth) {
            if (!limits) {
              return orgWidth;
            }

            if (limits.min) {
              if (limits.min > orgWidth) {
                return limits.min;
              }
            }

            if (limits.max) {
              if (limits.max < orgWidth) {
                return limits.max;
              }
            }

            return orgWidth;
          }
          /**
           * Gets the definition of the column width.
           * @param {DrawGrid} grid grid instance
           * @param {number} col number of column
           * @returns {string|number} width definition
           * @private
           */


          function _getColWidthDefine(grid, col) {
            var width = grid[_].colWidthsMap.get(col);

            if (width) {
              return width;
            }

            return grid.defaultColWidth;
          }
          /**
           * Gets the column width limits.
           * @param {DrawGrid} grid grid instance
           * @param {number} col number of column
           * @returns {object|null} the column width limits
           * @private
           */


          function _getColWidthLimits(grid, col) {
            var limit = grid[_].colWidthsLimit[col];

            if (!limit) {
              return null;
            }

            var result = {};

            if (limit.min) {
              result.min = _toPxWidth(grid, limit.min);
              result.minDef = limit.min;
            }

            if (limit.max) {
              result.max = _toPxWidth(grid, limit.max);
              result.maxDef = limit.max;
            }

            return result;
          }
          /**
           * Checks if the given width definition is `auto`.
           * @param {string|number} width width definition to check
           * @returns {boolean} `true ` if the given width definition is `auto`
           * @private
           */


          function isAutoDefine(width) {
            return Boolean(width && typeof width === "string" && width.toLowerCase() === "auto");
          }
          /**
           * Creates a formula to calculate the auto width.
           * @param {DrawGrid} grid grid instance
           * @returns {string} formula
           * @private
           */


          function _calcAutoColWidthExpr(grid) {
            var shortCircuit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
            var fullWidth = grid[_].calcWidthContext.full;
            var sumMin = 0;
            var others = [];
            var autoCount = 0;
            var hasLimitsOnAuto = [];

            for (var col = 0; col < grid[_].colCount; col++) {
              var def = _getColWidthDefine(grid, col);

              var limits = _getColWidthLimits(grid, col);

              if (isAutoDefine(def)) {
                if (limits) {
                  hasLimitsOnAuto.push(limits);

                  if (limits.min) {
                    sumMin += limits.min;
                  }
                }

                autoCount++;
              } else {
                var expr = def;

                if (limits) {
                  var orgWidth = _toPxWidth(grid, expr);

                  var newWidth = _applyColWidthLimits(limits, orgWidth);

                  if (orgWidth !== newWidth) {
                    expr = "".concat(newWidth, "px");
                  }

                  sumMin += newWidth;
                }

                others.push(expr);
              }

              if (shortCircuit && sumMin > fullWidth) {
                // Returns 0px because it has consumed the full width.
                return "0px";
              }
            }

            if (hasLimitsOnAuto.length && others.length) {
              var autoPx = (fullWidth - _toPxWidth(grid, "calc(".concat(others.map(function (c) {
                return typeof c === "number" ? "".concat(c, "px") : c;
              }).join(" + "), ")"))) / autoCount;
              hasLimitsOnAuto.forEach(function (limits) {
                if (limits.min && autoPx < limits.min) {
                  others.push(limits.minDef);
                  autoCount--;
                } else if (limits.max && limits.max < autoPx) {
                  others.push(limits.maxDef);
                  autoCount--;
                }
              });

              if (shortCircuit && autoCount <= 0) {
                return "".concat(autoPx, "px");
              }
            }

            if (others.length) {
              var strDefs = [];
              var num = 0;
              others.forEach(function (c) {
                if (typeof c === "number") {
                  num += c;
                } else {
                  strDefs.push(c);
                }
              });
              strDefs.push("".concat(num, "px"));
              return "calc((100% - (".concat(strDefs.join(" + "), ")) / ").concat(autoCount, ")");
            } else {
              return "".concat(100 / autoCount, "%");
            }
          }
          /**
           * Calculate the pixels of width from the definition of width.
           * @param {DrawGrid} grid grid instance
           * @param {string|number} width width definition
           * @returns {number} the pixels of width
           * @private
           */


          function _colWidthDefineToPxWidth(grid, width) {
            if (isAutoDefine(width)) {
              return _toPxWidth(grid, _calcAutoColWidthExpr(grid));
            }

            return _toPxWidth(grid, width);
          }
          /** @private */


          function _getColWidth(grid, col) {
            var width = _getColWidthDefine(grid, col);

            return _adjustColWidth(grid, col, _colWidthDefineToPxWidth(grid, width));
          }
          /** @private */


          function _setColWidth(grid, col, width) {
            if (width != null) {
              grid[_].colWidthsMap.put(col, width);
            } else {
              grid[_].colWidthsMap.remove(col);
            }
          }
          /**
           * Overwrites the definition of a column whose width is set to `auto` with the current auto width formula.
           * @param {DrawGrid} grid grid instance
           * @returns {void}
           * @private
           */


          function _storeAutoColWidthExprs(grid) {
            var expr = null;

            for (var col = 0; col < grid[_].colCount; col++) {
              var def = _getColWidthDefine(grid, col);

              if (isAutoDefine(def)) {
                _setColWidth(grid, col, expr || (expr = _calcAutoColWidthExpr(grid, false)));
              }
            }
          }
          /** @private */


          function _getColsWidth(grid, startCol, endCol) {
            var defaultColPxWidth = _colWidthDefineToPxWidth(grid, grid.defaultColWidth);

            var colCount = endCol - startCol + 1;
            var w = defaultColPxWidth * colCount;

            grid[_].colWidthsMap.each(startCol, endCol, function (width, col) {
              w += _adjustColWidth(grid, col, _colWidthDefineToPxWidth(grid, width)) - defaultColPxWidth;
            });

            for (var col = startCol; col <= endCol; col++) {
              if (grid[_].colWidthsMap.has(col)) {
                continue;
              }

              var adj = _adjustColWidth(grid, col, defaultColPxWidth);

              if (adj !== defaultColPxWidth) {
                w += adj - defaultColPxWidth;
              }
            }

            return w;
          }
          /** @private */


          function _getRowHeight(row) {
            var internal = this.getRowHeightInternal(row);

            if (internal != null) {
              return internal;
            }

            var height = this[_].rowHeightsMap.get(row);

            if (height) {
              return height;
            }

            return this[_].defaultRowHeight;
          }
          /** @private */


          function _setRowHeight(grid, row, height) {
            if (height != null) {
              grid[_].rowHeightsMap.put(row, height);
            } else {
              grid[_].rowHeightsMap.remove(row);
            }
          }
          /** @private */


          function _getRowsHeight(startRow, endRow) {
            var _this63 = this;

            var internal = this.getRowsHeightInternal(startRow, endRow);

            if (internal != null) {
              return internal;
            }

            var rowCount = endRow - startRow + 1;
            var h = this[_].defaultRowHeight * rowCount;

            this[_].rowHeightsMap.each(startRow, endRow, function (height) {
              h += height - _this63[_].defaultRowHeight;
            });

            return h;
          }
          /** @private */


          function _getScrollWidth(grid) {
            return _getColsWidth(grid, 0, grid[_].colCount - 1);
          }
          /** @private */


          function _getScrollHeight(row) {
            var _this64 = this;

            var internal = this.getScrollHeightInternal(row);

            if (internal != null) {
              return internal;
            }

            var h = this[_].defaultRowHeight * this[_].rowCount;

            this[_].rowHeightsMap.each(0, this[_].rowCount - 1, function (height) {
              h += height - _this64[_].defaultRowHeight;
            });

            return h;
          }
          /** @private */


          function _onScroll(grid, _e) {
            var lastLeft = grid[_].scroll.left;
            var lastTop = grid[_].scroll.top;
            var moveX = grid[_].scrollable.scrollLeft - lastLeft;
            var moveY = grid[_].scrollable.scrollTop - lastTop; //次回計算用情報を保持

            grid[_].scroll = {
              left: grid[_].scrollable.scrollLeft,
              top: grid[_].scrollable.scrollTop
            }; // If the focus is on the header, recalculate and move the focus position.

            var focus = grid[_].selection.focus;
            var isFrozenCell = grid.isFrozenCell(focus.col, focus.row);

            if (isFrozenCell && ((isFrozenCell === null || isFrozenCell === void 0 ? void 0 : isFrozenCell.col) && moveX || (isFrozenCell === null || isFrozenCell === void 0 ? void 0 : isFrozenCell.row) && moveY)) {
              grid.setFocusCursor(focus.col, focus.row);
            }

            var visibleRect = _getVisibleRect(grid);

            if (Math.abs(moveX) >= visibleRect.width || Math.abs(moveY) >= visibleRect.height) {
              //全再描画
              _invalidateRect(grid, visibleRect);
            } else {
              //差分再描画
              grid[_].context.drawImage(grid[_].canvas, -moveX, -moveY);

              if (moveX !== 0) {
                //横移動の再描画範囲を計算
                var redrawRect = visibleRect.copy();

                if (moveX < 0) {
                  redrawRect.width = -moveX;

                  if (grid[_].frozenColCount > 0) {
                    //固定列がある場合固定列分描画
                    var frozenRect = _getFrozenColsRect(grid);

                    redrawRect.width += frozenRect.width;
                  }
                } else if (moveX > 0) {
                  redrawRect.left = redrawRect.right - moveX;
                } //再描画


                _invalidateRect(grid, redrawRect);

                if (moveX > 0) {
                  if (grid[_].frozenColCount > 0) {
                    //固定列がある場合固定列描画
                    _invalidateRect(grid, _getFrozenColsRect(grid));
                  }
                }
              }

              if (moveY !== 0) {
                //縦移動の再描画範囲を計算
                var _redrawRect = visibleRect.copy();

                if (moveY < 0) {
                  _redrawRect.height = -moveY;

                  if (grid[_].frozenRowCount > 0) {
                    //固定行がある場合固定行分描画
                    var _frozenRect2 = _getFrozenRowsRect(grid);

                    _redrawRect.height += _frozenRect2.height;
                  }
                } else if (moveY > 0) {
                  _redrawRect.top = _redrawRect.bottom - moveY;
                } //再描画


                _invalidateRect(grid, _redrawRect);

                if (moveY > 0) {
                  if (grid[_].frozenRowCount > 0) {
                    //固定行がある場合固定行描画
                    _invalidateRect(grid, _getFrozenRowsRect(grid));
                  }
                }
              }
            }
          }
          /** @private */
          // eslint-disable-next-line complexity


          function _onKeyDownMove(e) {
            var _a, _b, _c;

            var keyCode = getKeyCode(e);
            var focusCell = e.shiftKey ? this.selection.focus : this.selection.select;
            var ctrlOrMeta = e.ctrlKey || e.metaKey;

            if (keyCode === KEY_LEFT) {
              if (e.altKey) return; // unknown modifier key

              if (ctrlOrMeta) {
                move(this, null, "W", e.shiftKey);
              } else {
                if (!hMove.call(this, "W", e.shiftKey)) {
                  return;
                }
              }

              cancelEvent(e);
            } else if (keyCode === KEY_UP) {
              if (e.altKey) return; // unknown modifier key

              if (ctrlOrMeta) {
                move(this, "N", null, e.shiftKey);
              } else {
                if (!vMove.call(this, "N", e.shiftKey)) {
                  return;
                }
              }

              cancelEvent(e);
            } else if (keyCode === KEY_RIGHT) {
              if (e.altKey) return; // unknown modifier key

              if (ctrlOrMeta) {
                move(this, null, "E", e.shiftKey);
              } else {
                if (!hMove.call(this, "E", e.shiftKey)) {
                  return;
                }
              }

              cancelEvent(e);
            } else if (keyCode === KEY_DOWN) {
              if (e.altKey) return; // unknown modifier key

              if (ctrlOrMeta) {
                move(this, "S", null, e.shiftKey);
              } else {
                if (!vMove.call(this, "S", e.shiftKey)) {
                  return;
                }
              }

              cancelEvent(e);
            } else if (keyCode === KEY_HOME) {
              if (e.altKey) return; // unknown modifier key

              if (ctrlOrMeta) {
                move(this, "N", "W", e.shiftKey);
              } else {
                move(this, null, "W", e.shiftKey);
              }

              cancelEvent(e);
            } else if (keyCode === KEY_END) {
              if (e.altKey) return; // unknown modifier key

              if (ctrlOrMeta) {
                move(this, "S", "E", e.shiftKey);
              } else {
                move(this, null, "E", e.shiftKey);
              }

              cancelEvent(e);
            } else if (((_a = this.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnTab) && keyCode === KEY_TAB) {
              if (e.altKey || ctrlOrMeta) return; // unknown modifier key

              var newCell = null;

              if (typeof this.keyboardOptions.moveCellOnTab === "function") {
                newCell = this.keyboardOptions.moveCellOnTab({
                  cell: focusCell,
                  grid: this,
                  event: e
                });
              }

              if (newCell) {
                _moveFocusCell.call(this, newCell.col, newCell.row, false);
              } else if (e.shiftKey) {
                if (!hMove.call(this, "W", false)) {
                  var row = this.getMoveUpRowByKeyDownInternal(focusCell);

                  if (0 > row) {
                    return;
                  }

                  _moveFocusCell.call(this, this.colCount - 1, row, false);
                }
              } else {
                if (!hMove.call(this, "E", false)) {
                  var _row3 = this.getMoveDownRowByKeyDownInternal(focusCell);

                  if (this.rowCount <= _row3) {
                    return;
                  }

                  _moveFocusCell.call(this, 0, _row3, false);
                }
              }

              cancelEvent(e);
            } else if (((_b = this.keyboardOptions) === null || _b === void 0 ? void 0 : _b.moveCellOnEnter) && keyCode === KEY_ENTER) {
              if (e.altKey || ctrlOrMeta) return; // unknown modifier key

              var _newCell = null;

              if (typeof this.keyboardOptions.moveCellOnEnter === "function") {
                _newCell = this.keyboardOptions.moveCellOnEnter({
                  cell: focusCell,
                  grid: this,
                  event: e
                });
              }

              if (_newCell) {
                _moveFocusCell.call(this, _newCell.col, _newCell.row, false);
              } else if (e.shiftKey) {
                if (!vMove.call(this, "N", false)) {
                  var col = this.getMoveLeftColByKeyDownInternal(focusCell);

                  if (0 > col) {
                    return;
                  }

                  _moveFocusCell.call(this, col, this.rowCount - 1, false);
                }
              } else {
                if (!vMove.call(this, "S", false)) {
                  var _col3 = this.getMoveRightColByKeyDownInternal(focusCell);

                  if (this.colCount <= _col3) {
                    return;
                  }

                  _moveFocusCell.call(this, _col3, Math.min(this.frozenRowCount, this.rowCount - 1), false);
                }
              }

              cancelEvent(e);
            } else if (((_c = this.keyboardOptions) === null || _c === void 0 ? void 0 : _c.selectAllOnCtrlA) && keyCode === KEY_ALPHA_A) {
              if (e.altKey || e.shiftKey) return; // unknown modifier key

              if (!ctrlOrMeta) return;
              this.selection.range = {
                start: {
                  col: 0,
                  row: 0
                },
                end: {
                  col: this.colCount - 1,
                  row: this.rowCount - 1
                }
              };
              this.invalidate();
              cancelEvent(e);
            }

            function move(grid, vDir, hDir, shiftKeyFlg) {
              var row = vDir === "S" ? grid.rowCount - 1 : vDir === "N" ? 0 : focusCell.row;
              var col = hDir === "E" ? grid.colCount - 1 : hDir === "W" ? 0 : focusCell.col;

              _moveFocusCell.call(grid, col, row, shiftKeyFlg);
            }

            function vMove(vDir, shiftKeyFlg) {
              var col = focusCell.col;
              var row;

              if (vDir === "S") {
                row = this.getMoveDownRowByKeyDownInternal(focusCell);

                if (this.rowCount <= row) {
                  // Avoids the problem of the scroll position breaking due to a delayed scrolling event if user hold down the arrow keys.
                  this.makeVisibleCell(col, this.rowCount - 1);
                  return false;
                }
              } else {
                row = this.getMoveUpRowByKeyDownInternal(focusCell);

                if (row < 0) {
                  // Avoids the problem of the scroll position breaking due to a delayed scrolling event if user hold down the arrow keys.
                  this.makeVisibleCell(col, 0);
                  return false;
                }
              }

              _moveFocusCell.call(this, col, row, shiftKeyFlg);

              return true;
            }

            function hMove(hDir, shiftKeyFlg) {
              var row = focusCell.row;
              var col;

              if (hDir === "E") {
                col = this.getMoveRightColByKeyDownInternal(focusCell);

                if (this.colCount <= col) {
                  // Avoids the problem of the scroll position breaking due to a delayed scrolling event if user hold down the arrow keys.
                  this.makeVisibleCell(this.colCount - 1, row);
                  return false;
                }
              } else {
                col = this.getMoveLeftColByKeyDownInternal(focusCell);

                if (col < 0) {
                  // Avoids the problem of the scroll position breaking due to a delayed scrolling event if user hold down the arrow keys.
                  this.makeVisibleCell(0, row);
                  return false;
                }
              }

              _moveFocusCell.call(this, col, row, shiftKeyFlg);

              return true;
            }
          }
          /** @private */


          function _moveFocusCell(col, row, shiftKey) {
            var offset = this.getOffsetInvalidateCells();

            function extendRange(range) {
              if (offset > 0) {
                range.start.col -= offset;
                range.start.row -= offset;
                range.end.col += offset;
                range.end.row += offset;
              }

              return range;
            }

            var beforeRange = extendRange(this.selection.range);
            var beforeRect = this.getCellRangeRect(beforeRange);

            this.selection._setFocusCell(col, row, shiftKey);

            this.makeVisibleCell(col, row);
            this.focusCell(col, row);
            var afterRange = extendRange(this.selection.range);
            var afterRect = this.getCellRangeRect(afterRange);

            if (afterRect.intersection(beforeRect)) {
              var invalidateRect = Rect_1.Rect.max(afterRect, beforeRect);

              _invalidateRect(this, invalidateRect);
            } else {
              _invalidateRect(this, beforeRect);

              _invalidateRect(this, afterRect);
            }
          }
          /** @private */


          function _updatedSelection() {
            var focusControl = this[_].focusControl;
            var _this$_$selection$sel = this[_].selection.select,
                selCol = _this$_$selection$sel.col,
                selRow = _this$_$selection$sel.row;
            var results = this.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.EDITABLEINPUT_CELL, {
              col: selCol,
              row: selRow
            });
            var editMode = utils_1.array.findIndex(results, function (v) {
              return !!v;
            }) >= 0;
            focusControl.editMode = editMode;

            if (editMode) {
              focusControl.storeInputStatus();
              focusControl.setDefaultInputStatus();
              this.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MODIFY_STATUS_EDITABLEINPUT_CELL, {
                col: selCol,
                row: selRow,
                input: focusControl.input
              });
            }
          }
          /** @private */


          function _getMouseAbstractPoint(grid, evt) {
            var e;

            if (isTouchEvent(evt)) {
              e = evt.changedTouches[0];
            } else {
              e = evt;
            }

            var clientX = e.clientX || e.pageX + window.scrollX;
            var clientY = e.clientY || e.pageY + window.scrollY;

            var rect = grid[_].canvas.getBoundingClientRect();

            if (rect.right <= clientX) {
              return null;
            }

            if (rect.bottom <= clientY) {
              return null;
            }

            var x = clientX - rect.left + grid[_].scroll.left;
            var y = clientY - rect.top + grid[_].scroll.top;
            return {
              x: x,
              y: y
            };
          }
          /** @private */


          function _bindEvents() {
            // eslint-disable-next-line consistent-this, @typescript-eslint/no-this-alias
            var grid = this;
            var _grid$_ = grid[_],
                handler = _grid$_.handler,
                element = _grid$_.element,
                scrollable = _grid$_.scrollable;

            var getCellEventArgsSet = function getCellEventArgsSet(e) {
              var abstractPos = _getMouseAbstractPoint(grid, e);

              if (!abstractPos) {
                return {};
              }

              var cell = grid.getCellAt(abstractPos.x, abstractPos.y);

              if (cell.col < 0 || cell.row < 0) {
                return {
                  abstractPos: abstractPos,
                  cell: cell
                };
              }

              var eventArgs = {
                col: cell.col,
                row: cell.row,
                event: e
              };
              return {
                abstractPos: abstractPos,
                cell: cell,
                eventArgs: eventArgs
              };
            };

            var canResizeColumn = function canResizeColumn(col) {
              if (grid[_].disableColumnResize) {
                return false;
              }

              var limit = grid[_].colWidthsLimit[col];

              if (!limit || !limit.min || !limit.max) {
                return true;
              }

              return limit.max !== limit.min;
            };

            handler.on(element, "mousedown", function (e) {
              var eventArgsSet = getCellEventArgsSet(e);
              var abstractPos = eventArgsSet.abstractPos,
                  eventArgs = eventArgsSet.eventArgs;

              if (!abstractPos) {
                return;
              }

              if (eventArgs) {
                var results = grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEDOWN_CELL, eventArgs);

                if (utils_1.array.findIndex(results, function (v) {
                  return !v;
                }) >= 0) {
                  return;
                }
              }

              if (getMouseButtons(e) !== 1 && // For mobile safari. If we do not post-process here, the keyboard will not start in Mobile Safari.
              e.buttons !== 0) {
                return;
              }

              var resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y);

              if (resizeCol >= 0 && canResizeColumn(resizeCol)) {
                //幅変更
                grid[_].columnResizer.start(resizeCol, e);
              } else {
                //選択
                grid[_].cellSelector.start(e);
              }
            });
            handler.on(element, "mouseup", function (e) {
              if (!grid.hasListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEUP_CELL)) {
                return;
              }

              var _getCellEventArgsSet = getCellEventArgsSet(e),
                  eventArgs = _getCellEventArgsSet.eventArgs;

              if (eventArgs) {
                grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEUP_CELL, eventArgs);
              }
            });
            var doubleTapBefore = null;
            var longTouchId = null;
            var useTouch = null;

            function useTouchStart() {
              if ((useTouch === null || useTouch === void 0 ? void 0 : useTouch.timeoutId) != null) clearTimeout(useTouch.timeoutId);
              useTouch = {};
            }

            function useTouchEnd() {
              if (useTouch) {
                if (useTouch.timeoutId != null) clearTimeout(useTouch.timeoutId);
                useTouch.timeoutId = setTimeout(function () {
                  useTouch = null;
                }, 350);
              }
            }

            handler.on(element, "touchstart", function (e) {
              // Since it is an environment where touch start can be used, it blocks mousemove that occurs after this.
              useTouchStart();

              var _getCellEventArgsSet2 = getCellEventArgsSet(e),
                  eventArgs = _getCellEventArgsSet2.eventArgs;

              if (eventArgs) {
                grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.TOUCHSTART_CELL, eventArgs);
              }

              if (!doubleTapBefore) {
                doubleTapBefore = eventArgs;
                setTimeout(function () {
                  doubleTapBefore = null;
                }, 350);
              } else {
                if (eventArgs && eventArgs.col === doubleTapBefore.col && eventArgs.row === doubleTapBefore.row) {
                  grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.DBLTAP_CELL, eventArgs);
                }

                doubleTapBefore = null;

                if (e.defaultPrevented) {
                  return;
                }
              }

              if (e.targetTouches.length > 1) {
                // If touchstart with multiple fingers,
                // it is not considered as an operation event.
                return;
              }

              longTouchId = setTimeout(function () {
                //長押しした場合選択モード
                longTouchId = null;

                var abstractPos = _getMouseAbstractPoint(grid, e);

                if (!abstractPos) {
                  return;
                }

                var resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y, 15);

                if (resizeCol >= 0 && canResizeColumn(resizeCol)) {
                  //幅変更
                  grid[_].columnResizer.start(resizeCol, e);
                } else {
                  //選択
                  grid[_].cellSelector.start(e);
                }
              }, 500);
            });

            function cancel(_e) {
              if (longTouchId) {
                clearTimeout(longTouchId);
                longTouchId = null;
              }
            }

            handler.on(element, "touchcancel", function (e) {
              cancel(e);
              useTouchEnd();
            });
            handler.on(element, "touchmove", cancel);
            handler.on(element, "touchend", function (e) {
              useTouchEnd();

              if (longTouchId) {
                clearTimeout(longTouchId);

                grid[_].cellSelector.select(e);

                longTouchId = null;
              }
            });
            var isMouseover = false;
            var mouseEnterCell = null;
            var mouseOverCell = null;

            function onMouseenterCell(cell, props) {
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEENTER_CELL, Object.assign(Object.assign({}, props), {
                col: cell.col,
                row: cell.row
              }));
              mouseEnterCell = cell;
            }

            function onMouseleaveCell(props) {
              var beforeMouseCell = mouseEnterCell;
              mouseEnterCell = null;

              if (beforeMouseCell) {
                grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSELEAVE_CELL, Object.assign(Object.assign({}, props), {
                  col: beforeMouseCell.col,
                  row: beforeMouseCell.row
                }));
              }

              return beforeMouseCell || undefined;
            }

            function onMouseoverCell(cell, props) {
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOVER_CELL, Object.assign(Object.assign({}, props), {
                col: cell.col,
                row: cell.row
              }));
              mouseOverCell = cell;
            }

            function onMouseoutCell(props) {
              var beforeMouseCell = mouseOverCell;
              mouseOverCell = null;

              if (beforeMouseCell) {
                grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOUT_CELL, Object.assign(Object.assign({}, props), {
                  col: beforeMouseCell.col,
                  row: beforeMouseCell.row
                }));
              }

              return beforeMouseCell || undefined;
            }

            var scrollElement = scrollable.getElement();
            handler.on(scrollElement, "mouseover", function (_e) {
              isMouseover = true;
            });
            handler.on(scrollElement, "mouseout", function (event) {
              isMouseover = false;
              onMouseoutCell({
                event: event
              });
            });
            handler.on(element, "mouseleave", function (event) {
              onMouseleaveCell({
                event: event
              });
            });
            handler.on(element, "mousemove", function (e) {
              if (useTouch) {
                // Probably a mousemove event triggered by a touchstart. Therefore, this event is blocked.
                return;
              }

              var eventArgsSet = getCellEventArgsSet(e);
              var abstractPos = eventArgsSet.abstractPos,
                  eventArgs = eventArgsSet.eventArgs;

              if (eventArgs) {
                var beforeMouseCell = mouseEnterCell;

                if (beforeMouseCell) {
                  grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEMOVE_CELL, eventArgs);

                  if (beforeMouseCell.col !== eventArgs.col || beforeMouseCell.row !== eventArgs.row) {
                    var enterCell = {
                      col: eventArgs.col,
                      row: eventArgs.row
                    };
                    var outCell = onMouseoutCell({
                      related: enterCell,
                      event: e
                    });
                    var leaveCell = onMouseleaveCell({
                      related: enterCell,
                      event: e
                    });
                    onMouseenterCell(enterCell, {
                      related: leaveCell,
                      event: e
                    });

                    if (isMouseover) {
                      onMouseoverCell(enterCell, {
                        related: outCell,
                        event: e
                      });
                    }
                  } else if (isMouseover && !mouseOverCell) {
                    onMouseoverCell({
                      col: eventArgs.col,
                      row: eventArgs.row
                    }, {
                      event: e
                    });
                  }
                } else {
                  var _enterCell = {
                    col: eventArgs.col,
                    row: eventArgs.row
                  };
                  onMouseenterCell(_enterCell, {
                    event: e
                  });

                  if (isMouseover) {
                    onMouseoverCell(_enterCell, {
                      event: e
                    });
                  }

                  grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEMOVE_CELL, eventArgs);
                }
              } else {
                onMouseoutCell({
                  event: e
                });
                onMouseleaveCell({
                  event: e
                });
              }

              if (grid[_].columnResizer.moving(e) || grid[_].cellSelector.moving(e)) {
                return;
              }

              var style = element.style;

              if (!abstractPos) {
                if (style.cursor === "col-resize") {
                  style.cursor = "";
                }

                return;
              }

              var resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y);

              if (resizeCol >= 0 && canResizeColumn(resizeCol)) {
                style.cursor = "col-resize";
              } else {
                if (style.cursor === "col-resize") {
                  style.cursor = "";
                }
              }
            });
            handler.on(element, "click", function (e) {
              if (grid[_].columnResizer.lastMoving(e) || grid[_].cellSelector.lastMoving(e)) {
                return;
              }

              if (!grid.hasListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.CLICK_CELL)) {
                return;
              }

              var _getCellEventArgsSet3 = getCellEventArgsSet(e),
                  eventArgs = _getCellEventArgsSet3.eventArgs;

              if (!eventArgs) {
                return;
              }

              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.CLICK_CELL, eventArgs);
            });
            handler.on(element, "contextmenu", function (e) {
              if (!grid.hasListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.CONTEXTMENU_CELL)) {
                return;
              }

              var _getCellEventArgsSet4 = getCellEventArgsSet(e),
                  eventArgs = _getCellEventArgsSet4.eventArgs;

              if (!eventArgs) {
                return;
              }

              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.CONTEXTMENU_CELL, eventArgs);
            });
            handler.on(element, "dblclick", function (e) {
              if (!grid.hasListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.DBLCLICK_CELL)) {
                return;
              }

              var _getCellEventArgsSet5 = getCellEventArgsSet(e),
                  eventArgs = _getCellEventArgsSet5.eventArgs;

              if (!eventArgs) {
                return;
              }

              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.DBLCLICK_CELL, eventArgs);
            });

            grid[_].focusControl.onKeyDown(function (evt) {
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.KEYDOWN, evt);
            });

            grid[_].selection.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SELECTED_CELL, function (data) {
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SELECTED_CELL, data, data.selected);
            });

            scrollable.onScroll(function (e) {
              _onScroll(grid, e);

              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SCROLL, {
                event: e
              });
            });

            grid[_].focusControl.onKeyDownMove(function (e) {
              _onKeyDownMove.call(grid, e);
            });

            grid.listen("copydata", function (range) {
              var copyRange = grid.getCopyRangeInternal(range);
              var copyLines = [];

              for (var row = copyRange.start.row; row <= copyRange.end.row; row++) {
                var copyLine = "";

                for (var col = copyRange.start.col; col <= copyRange.end.col; col++) {
                  var copyCellValue = grid.getCopyCellValue(col, row, copyRange);
                  var strCellValue = void 0;

                  if (typeof copyCellValue === "string") {
                    strCellValue = copyCellValue;
                  } else if (copyCellValue == null || // Asynchronous data is treated as empty.
                  typeof Promise !== "undefined" && copyCellValue instanceof Promise) {
                    strCellValue = "";
                  } else {
                    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions
                    strCellValue = "".concat(copyCellValue);

                    if (/^\[object .*\]$/.exec(strCellValue)) {
                      // Ignore maybe object
                      strCellValue = "";
                    }
                  }

                  copyLine += /[\t\n]/.test(strCellValue) ? // Need quote
                  "\"".concat(strCellValue.replace(/"/g, '""'), "\"") : strCellValue;

                  if (col < copyRange.end.col) {
                    copyLine += "\t";
                  }
                }

                copyLines.push(copyLine);
              }

              return copyLines.join("\n");
            });

            grid[_].focusControl.onCopy(function (_e) {
              return utils_1.array.find(grid.fireListeners("copydata", grid[_].selection.range), function (r) {
                return r != null;
              });
            });

            grid[_].focusControl.onPaste(function (_ref51) {
              var value = _ref51.value,
                  event = _ref51.event;
              var trimOnPaste = grid.trimOnPaste;
              var normalizedValue = (0, paste_utils_1.normalizePasteValue)(value);
              var _grid$_$selection$sel = grid[_].selection.select,
                  col = _grid$_$selection$sel.col,
                  row = _grid$_$selection$sel.row;
              var multi = /[\r\n\u2028\u2029\t]/.test(normalizedValue); // is multi cell values

              var rangeBoxValues = null;
              var pasteCellEvent = {
                col: col,
                row: row,
                value: value,
                normalizeValue: trimOnPaste ? normalizedValue.trim() : normalizedValue,
                multi: multi,

                get rangeBoxValues() {
                  return rangeBoxValues !== null && rangeBoxValues !== void 0 ? rangeBoxValues : rangeBoxValues = (0, paste_utils_1.parsePasteRangeBoxValues)(normalizedValue, {
                    trimOnPaste: trimOnPaste
                  });
                },

                event: event
              };
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.PASTE_CELL, pasteCellEvent);
            });

            grid[_].focusControl.onInput(function (value) {
              var _grid$_$selection$sel2 = grid[_].selection.select,
                  col = _grid$_$selection$sel2.col,
                  row = _grid$_$selection$sel2.row;
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.INPUT_CELL, {
                col: col,
                row: row,
                value: value
              });
            });

            grid[_].focusControl.onDelete(function (event) {
              var _grid$_$selection$sel3 = grid[_].selection.select,
                  col = _grid$_$selection$sel3.col,
                  row = _grid$_$selection$sel3.row;
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.DELETE_CELL, {
                col: col,
                row: row,
                event: event
              });
            });

            grid[_].focusControl.onFocus(function (e) {
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.FOCUS_GRID, e);
              grid[_].focusedGrid = true;
              var _grid$_$selection$sel4 = grid[_].selection.select,
                  col = _grid$_$selection$sel4.col,
                  row = _grid$_$selection$sel4.row;
              grid.invalidateCell(col, row);
            });

            grid[_].focusControl.onBlur(function (e) {
              grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.BLUR_GRID, e);
              grid[_].focusedGrid = false;
              var _grid$_$selection$sel5 = grid[_].selection.select,
                  col = _grid$_$selection$sel5.col,
                  row = _grid$_$selection$sel5.row;
              grid.invalidateCell(col, row);
            });
          }
          /** @private */


          function _getResizeColAt(grid, abstractX, abstractY) {
            var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 5;

            if (grid[_].frozenRowCount <= 0) {
              return -1;
            }

            var frozenRect = _getFrozenRowsRect(grid);

            if (!frozenRect.inPoint(abstractX, abstractY)) {
              return -1;
            }

            var cell = grid.getCellAt(abstractX, abstractY);
            var cellRect = grid.getCellRect(cell.col, cell.row);

            if (abstractX < cellRect.left + offset) {
              return cell.col - 1;
            }

            if (cellRect.right - offset < abstractX) {
              return cell.col;
            }

            return -1;
          }
          /** @private */


          function _getVisibleRect(grid) {
            var _grid$_2 = grid[_],
                _grid$_2$scroll = _grid$_2.scroll,
                left = _grid$_2$scroll.left,
                top = _grid$_2$scroll.top,
                _grid$_2$canvas = _grid$_2.canvas,
                width = _grid$_2$canvas.width,
                height = _grid$_2$canvas.height;
            return new Rect_1.Rect(left, top, width, height);
          }
          /** @private */


          function _getScrollableVisibleRect(grid) {
            var frozenColsWidth = 0;

            if (grid[_].frozenColCount > 0) {
              //固定列がある場合固定列分描画
              var frozenRect = _getFrozenColsRect(grid);

              frozenColsWidth = frozenRect.width;
            }

            var frozenRowsHeight = 0;

            if (grid[_].frozenRowCount > 0) {
              //固定列がある場合固定列分描画
              var _frozenRect3 = _getFrozenRowsRect(grid);

              frozenRowsHeight = _frozenRect3.height;
            }

            return new Rect_1.Rect(grid[_].scrollable.scrollLeft + frozenColsWidth, grid[_].scrollable.scrollTop + frozenRowsHeight, grid[_].canvas.width - frozenColsWidth, grid[_].canvas.height - frozenRowsHeight);
          }
          /** @private */


          function _toRelativeRect(grid, absoluteRect) {
            var rect = absoluteRect.copy();

            var visibleRect = _getVisibleRect(grid);

            rect.offsetLeft(-visibleRect.left);
            rect.offsetTop(-visibleRect.top);
            return rect;
          } //end private methods
          //
          //
          //
          //

          /**
           * managing mouse down moving
           * @private
           */


          var BaseMouseDownMover = /*#__PURE__*/function () {
            function BaseMouseDownMover(grid) {
              _classCallCheck(this, BaseMouseDownMover);

              this._grid = grid;
              this._handler = new EventHandler_1.EventHandler();
              this._events = {};
              this._started = false;
              this._moved = false;
            }

            _createClass(BaseMouseDownMover, [{
              key: "moving",
              value: function moving(_e) {
                return !!this._started;
              }
            }, {
              key: "lastMoving",
              value: function lastMoving(e) {
                // mouseup後すぐに、clickイベントを反応しないようにする制御要
                if (this.moving(e)) {
                  return true;
                }

                var last = this._mouseEndPoint;

                if (!last) {
                  return false;
                }

                var pt = _getMouseAbstractPoint(this._grid, e);

                return pt != null && pt.x === last.x && pt.y === last.y;
              }
            }, {
              key: "_bindMoveAndUp",
              value: function _bindMoveAndUp(e) {
                var _this65 = this;

                var events = this._events;
                var handler = this._handler;

                if (!isTouchEvent(e)) {
                  events.mousemove = handler.on(document.body, "mousemove", function (e) {
                    return _this65._mouseMove(e);
                  });
                  events.mouseup = handler.on(document.body, "mouseup", function (e) {
                    return _this65._mouseUp(e);
                  });
                } else {
                  events.touchmove = handler.on(document.body, "touchmove", function (e) {
                    return _this65._mouseMove(e);
                  }, {
                    passive: false
                  });
                  events.touchend = handler.on(document.body, "touchend", function (e) {
                    return _this65._mouseUp(e);
                  });
                  events.touchcancel = handler.on(document.body, "touchcancel", function (e) {
                    return _this65._mouseUp(e);
                  });
                }

                this._started = true;
                this._moved = false;
              }
            }, {
              key: "_mouseMove",
              value: function _mouseMove(e) {
                if (!isTouchEvent(e)) {
                  if (getMouseButtons(e) !== 1) {
                    this._mouseUp(e);

                    return;
                  }
                }

                this._moved = this._moveInternal(e) || this._moved
                /*calculation on after*/
                ;
                cancelEvent(e);
              }
            }, {
              key: "_moveInternal",
              value: function _moveInternal(_e) {
                //protected
                return false;
              }
            }, {
              key: "_mouseUp",
              value: function _mouseUp(e) {
                var _this66 = this;

                var events = this._events;
                var handler = this._handler;
                handler.off(events.mousemove);
                handler.off(events.touchmove);
                handler.off(events.mouseup);
                handler.off(events.touchend); // handler.off(this._events.mouseleave);

                handler.off(events.touchcancel);
                this._started = false;

                this._upInternal(e); // mouseup後すぐに、clickイベントを反応しないようにする制御要


                if (this._moved) {
                  //移動が発生していたら
                  this._mouseEndPoint = _getMouseAbstractPoint(this._grid, e);
                  setTimeout(function () {
                    _this66._mouseEndPoint = null;
                  }, 10);
                }
              }
            }, {
              key: "_upInternal",
              value: function _upInternal(_e) {//protected
              }
            }, {
              key: "dispose",
              value: function dispose() {
                this._handler.dispose();
              }
            }]);

            return BaseMouseDownMover;
          }();
          /**
           * managing cell selection operation with mouse
           * @private
           */


          var CellSelector = /*#__PURE__*/function (_BaseMouseDownMover) {
            _inherits(CellSelector, _BaseMouseDownMover);

            var _super46 = _createSuper(CellSelector);

            function CellSelector() {
              _classCallCheck(this, CellSelector);

              return _super46.apply(this, arguments);
            }

            _createClass(CellSelector, [{
              key: "start",
              value: function start(e) {
                var cell = this._getTargetCell(e);

                if (!cell) {
                  return;
                }

                _moveFocusCell.call(this._grid, cell.col, cell.row, e.shiftKey);

                this._bindMoveAndUp(e);

                this._cell = cell;
                cancelEvent(e);

                _vibrate(e);
              }
            }, {
              key: "select",
              value: function select(e) {
                var cell = this._getTargetCell(e);

                if (!cell) {
                  return;
                }

                _moveFocusCell.call(this._grid, cell.col, cell.row, e.shiftKey);

                this._cell = cell;
              }
            }, {
              key: "_moveInternal",
              value: function _moveInternal(e) {
                var cell = this._getTargetCell(e);

                if (!cell) {
                  return false;
                }

                var _this$_cell = this._cell,
                    oldCol = _this$_cell.col,
                    oldRow = _this$_cell.row;
                var newCol = cell.col,
                    newRow = cell.row;

                if (oldCol === newCol && oldRow === newRow) {
                  return false;
                }

                var grid = this._grid;

                _moveFocusCell.call(grid, newCol, newRow, true); //make visible


                var makeVisibleCol = function () {
                  if (newCol < oldCol && 0 < newCol) {
                    // move left
                    return newCol - 1;
                  } else if (oldCol < newCol && newCol + 1 < grid.colCount) {
                    // move right
                    return newCol + 1;
                  }

                  return newCol;
                }();

                var makeVisibleRow = function () {
                  if (newRow < oldRow && 0 < newRow) {
                    // move up
                    return newRow - 1;
                  } else if (oldRow < newRow && newRow + 1 < grid.rowCount) {
                    // move down
                    return newRow + 1;
                  }

                  return newRow;
                }();

                if (makeVisibleCol !== newCol || makeVisibleRow !== newRow) {
                  grid.makeVisibleCell(makeVisibleCol, makeVisibleRow);
                }

                this._cell = cell;
                return true;
              }
            }, {
              key: "_getTargetCell",
              value: function _getTargetCell(e) {
                var grid = this._grid;

                var abstractPos = _getMouseAbstractPoint(grid, e);

                if (!abstractPos) {
                  return null;
                }

                var cell = grid.getCellAt(abstractPos.x, abstractPos.y);

                if (cell.col < 0 || cell.row < 0) {
                  return null;
                }

                return cell;
              }
            }]);

            return CellSelector;
          }(BaseMouseDownMover);
          /**
           * managing row width changing operation with mouse
           * @private
           */


          var ColumnResizer = /*#__PURE__*/function (_BaseMouseDownMover2) {
            _inherits(ColumnResizer, _BaseMouseDownMover2);

            var _super47 = _createSuper(ColumnResizer);

            function ColumnResizer(grid) {
              var _this67;

              _classCallCheck(this, ColumnResizer);

              _this67 = _super47.call(this, grid);
              _this67._x = -1;
              _this67._preX = -1;
              _this67._invalidateAbsoluteLeft = -1;
              _this67._targetCol = -1;
              return _this67;
            }

            _createClass(ColumnResizer, [{
              key: "start",
              value: function start(col, e) {
                var pageX;

                if (!isTouchEvent(e)) {
                  pageX = e.pageX;
                } else {
                  pageX = e.changedTouches[0].pageX;
                }

                this._x = pageX;
                this._preX = 0;

                this._bindMoveAndUp(e);

                this._targetCol = col;
                this._invalidateAbsoluteLeft = _getColsWidth(this._grid, 0, col - 1);
                cancelEvent(e);

                _vibrate(e);
              }
            }, {
              key: "_moveInternal",
              value: function _moveInternal(e) {
                var pageX = isTouchEvent(e) ? e.changedTouches[0].pageX : e.pageX;
                var x = pageX - this._x;
                var moveX = x - this._preX;
                this._preX = x;

                var pre = this._grid.getColWidth(this._targetCol);

                var afterSize = _adjustColWidth(this._grid, this._targetCol, pre + moveX);

                if (afterSize < 10 && moveX < 0) {
                  afterSize = 10;
                }

                _storeAutoColWidthExprs(this._grid);

                _setColWidth(this._grid, this._targetCol, afterSize);

                var rect = _getVisibleRect(this._grid);

                rect.left = this._invalidateAbsoluteLeft;

                _invalidateRect(this._grid, rect);

                this._grid.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.RESIZE_COLUMN, {
                  col: this._targetCol
                });

                return true;
              }
            }, {
              key: "_upInternal",
              value: function _upInternal(_e) {
                var grid = this._grid;

                if (grid.updateScroll()) {
                  grid.invalidate();
                }
              }
            }]);

            return ColumnResizer;
          }(BaseMouseDownMover);
          /** @private */


          function setSafeInputValue(input, value) {
            var type = input.type;
            input.type = "";
            input.value = value;

            if (type) {
              input.type = type;
            }
          }

          var IGNORE_STORE_ATTRS = ["style", "readonly"];
          /**
           * Manage focus
           * @private
           */

          var FocusControl = /*#__PURE__*/function (_EventTarget_1$EventT2) {
            _inherits(FocusControl, _EventTarget_1$EventT2);

            var _super48 = _createSuper(FocusControl);

            function FocusControl(grid, parentElement, scrollable, selection) {
              var _this68;

              _classCallCheck(this, FocusControl);

              _this68 = _super48.call(this);
              _this68._grid = grid;
              _this68._scrollable = scrollable;
              var handler = _this68._handler = new EventHandler_1.EventHandler();
              var input = _this68._input = document.createElement("input");
              input.classList.add("grid-focus-control");
              input.readOnly = true;
              parentElement.appendChild(input);
              handler.on(input, "compositionstart", function (_e) {
                input.classList.add("composition");
                input.style.font = grid.font || "16px sans-serif";
                _this68._isComposition = true;

                if (_this68._compositionEnd) {
                  clearTimeout(_this68._compositionEnd);
                  delete _this68._compositionEnd;
                }

                grid.focus();
              });
              var lastInputValue;

              var inputClear = function inputClear(storeLastInputValue) {
                lastInputValue = input.value;

                if (_this68._isComposition) {
                  return;
                }

                if (lastInputValue !== "") {
                  setSafeInputValue(input, "");
                }

                if (!storeLastInputValue) {
                  lastInputValue = "";
                }
              };

              var handleCompositionEnd = function handleCompositionEnd() {
                _this68._isComposition = false;
                input.classList.remove("composition");
                input.style.font = "";
                var value = input.value;
                inputClear(false);

                if (!input.readOnly) {
                  _this68.fireListeners("input", value);
                }

                if (_this68._compositionEnd) {
                  clearTimeout(_this68._compositionEnd);
                  delete _this68._compositionEnd;
                }
              };

              handler.on(input, "compositionend", function (_e) {
                _this68._compositionEnd = setTimeout(handleCompositionEnd, 1);
              });
              selection.listen("before_hook", function () {
                if (_this68._compositionEnd) {
                  handleCompositionEnd();
                }
              });
              handler.on(input, "keypress", function (e) {
                if (_this68._isComposition) {
                  return;
                }

                if (!input.readOnly && e.key && e.key.length === 1) {
                  if (e.ctrlKey || e.metaKey) {
                    if (e.key === "c") {//copy! for Firefox & Safari
                    } else if (e.key === "v") {//paste! for Firefox & Safari
                    }
                  } else {
                    if (e.key === " ") {
                      // Since the full-width space cannot be determined, it is processed by "input".
                      return;
                    }

                    _this68.fireListeners("input", e.key);

                    cancelEvent(e);
                  }
                }

                inputClear(true);
              });
              handler.on(input, "keydown", function (e) {
                var _a;

                if (_this68._isComposition) {
                  if (_this68._compositionEnd) {
                    handleCompositionEnd();
                    cancelEvent(e);
                  }

                  return;
                }

                var keyCode = getKeyCode(e);
                var stopCellMove = false;
                var evt = {
                  keyCode: keyCode,
                  event: e,
                  stopCellMoving: function stopCellMoving() {
                    stopCellMove = true;
                  }
                };

                _this68.fireListeners("keydown", evt);

                if (!input.readOnly && lastInputValue) {
                  // for Safari
                  _this68.fireListeners("input", lastInputValue);
                }

                if (!stopCellMove) _this68.fireKeyDownMove(keyCode, e);

                if (((_a = _this68._grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.deleteCellValueOnDel) && (keyCode === KEY_DEL || keyCode === KEY_BS)) {
                  _this68.fireListeners("delete", e);
                }

                inputClear(true);
              });
              handler.on(input, "keyup", function (_e) {
                if (_this68._isComposition) {
                  if (_this68._compositionEnd) {
                    handleCompositionEnd();
                  }
                }

                inputClear(true);
              });
              handler.on(input, "input", function (e) {
                if (e.data === " " || e.data === "　") {
                  // Since the full-width space cannot be determined on "keypress", it is processed by "input".
                  _this68.fireListeners("input", e.data);
                }

                inputClear(true);
              });

              if (utils_1.browser.IE) {
                handler.on(document, "keydown", function (e) {
                  if (e.target !== input) {
                    return;
                  }

                  var keyCode = getKeyCode(e);

                  if (keyCode === KEY_ALPHA_C && e.ctrlKey) {
                    // When text is not selected copy-event is not emit, on IE.
                    setSafeInputValue(input, "dummy");
                    input.select();
                    setTimeout(function () {
                      setSafeInputValue(input, "");
                    }, 100);
                  } else if (keyCode === KEY_ALPHA_V && e.ctrlKey) {
                    // When input is read-only paste-event is not emit, on IE.
                    if (input.readOnly) {
                      input.readOnly = false;
                      setTimeout(function () {
                        input.readOnly = true;
                        setSafeInputValue(input, "");
                      }, 10);
                    }
                  }
                });
              }

              if (utils_1.browser.Edge) {
                handler.once(document, "keydown", function (e) {
                  var _a;

                  if (!(0, utils_1.isDescendantElement)(parentElement, e.target)) {
                    return;
                  } // When the input has focus on the first page opening, the paste-event and copy-event is not emit, on Edge.


                  var dummyInput = document.createElement("input");
                  grid.getElement().appendChild(dummyInput);
                  dummyInput.focus();
                  input.focus();
                  (_a = dummyInput.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(dummyInput);
                });
              }

              handler.on(document, "paste", function (e) {
                if (!(0, utils_1.isDescendantElement)(parentElement, e.target)) {
                  return;
                }

                var pasteText = undefined;

                if (utils_1.browser.IE) {
                  // IE
                  // eslint-disable-next-line @typescript-eslint/no-explicit-any
                  pasteText = window.clipboardData.getData("Text");
                } else {
                  var clipboardData = e.clipboardData;

                  if (clipboardData.items) {
                    // Chrome & Firefox & Edge
                    pasteText = clipboardData.getData("text/plain");
                  } else {
                    // Safari
                    if (-1 !== Array.prototype.indexOf.call(clipboardData.types, "text/plain")) {
                      pasteText = clipboardData.getData("Text");
                    }
                  }
                }

                if (pasteText != null && pasteText.length) {
                  _this68.fireListeners("paste", {
                    value: pasteText,
                    event: e
                  });
                }
              });
              handler.on(document, "copy", function (e) {
                if (_this68._isComposition) {
                  return;
                }

                if (!(0, utils_1.isDescendantElement)(parentElement, e.target)) {
                  return;
                }

                setSafeInputValue(input, "");
                var data = utils_1.array.find(_this68.fireListeners("copy"), function (r) {
                  return r != null;
                });

                if (data != null) {
                  cancelEvent(e);

                  if (utils_1.browser.IE) {
                    // eslint-disable-next-line @typescript-eslint/no-explicit-any
                    window.clipboardData.setData("Text", data); // IE
                  } else {
                    e.clipboardData.setData("text/plain", data); // Chrome, Firefox
                  }
                }
              });
              handler.on(input, "focus", function (e) {
                _this68.fireListeners("focus", e);
              });
              handler.on(input, "blur", function (e) {
                _this68.fireListeners("blur", e);
              });
              return _this68;
            }

            _createClass(FocusControl, [{
              key: "fireKeyDownMove",
              value: function fireKeyDownMove(keyCode, e) {
                var _a, _b, _c;

                var fn = this._keyDownMoveCallback;

                if (!fn) {
                  return;
                }

                if (this._isComposition) {
                  return;
                }

                if (keyCode === KEY_LEFT || keyCode === KEY_UP || keyCode === KEY_RIGHT || keyCode === KEY_DOWN || keyCode === KEY_HOME || keyCode === KEY_END) {
                  fn(e);
                } else if (((_a = this._grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnTab) && keyCode === KEY_TAB) {
                  fn(e);
                } else if (((_b = this._grid.keyboardOptions) === null || _b === void 0 ? void 0 : _b.moveCellOnEnter) && keyCode === KEY_ENTER) {
                  fn(e);
                } else if (((_c = this._grid.keyboardOptions) === null || _c === void 0 ? void 0 : _c.selectAllOnCtrlA) && keyCode === KEY_ALPHA_A && (e.ctrlKey || e.metaKey)) {
                  fn(e);
                }
              }
            }, {
              key: "onKeyDownMove",
              value: function onKeyDownMove(fn) {
                this._keyDownMoveCallback = fn;
              }
            }, {
              key: "onKeyDown",
              value: function onKeyDown(fn) {
                return this.listen("keydown", fn);
              }
            }, {
              key: "onInput",
              value: function onInput(fn) {
                return this.listen("input", fn);
              }
            }, {
              key: "onDelete",
              value: function onDelete(fn) {
                return this.listen("delete", fn);
              }
            }, {
              key: "onCopy",
              value: function onCopy(fn) {
                return this.listen("copy", fn);
              }
            }, {
              key: "onPaste",
              value: function onPaste(fn) {
                return this.listen("paste", fn);
              }
            }, {
              key: "onFocus",
              value: function onFocus(fn) {
                return this.listen("focus", fn);
              }
            }, {
              key: "onBlur",
              value: function onBlur(fn) {
                return this.listen("blur", fn);
              }
            }, {
              key: "focus",
              value: function focus() {
                // this._input.value = '';
                this._input.focus();
              }
            }, {
              key: "setFocusRect",
              value: function setFocusRect(rect) {
                var input = this._input;

                var top = this._scrollable.calcTop(rect.top);

                input.style.top = "".concat((top - style.getScrollBarSize()).toFixed(), "px"); //position:relative だとずれるが、IEは position:relativeじゃないと最大値まで利用できない

                input.style.left = "".concat(rect.left.toFixed(), "px");
                input.style.width = "".concat(rect.width.toFixed(), "px");
                input.style.height = "".concat(rect.height.toFixed(), "px");
              }
            }, {
              key: "editMode",
              get: function get() {
                return !this._input.readOnly;
              },
              set: function set(editMode) {
                this._input.readOnly = !editMode;
              }
            }, {
              key: "resetInputStatus",
              value: function resetInputStatus() {
                var _a;

                var el = this._input;

                if (!el.classList.contains("grid-focus-control--stored-status")) {
                  return;
                }

                var composition = el.classList.contains("composition");
                var attrs = el.attributes;
                var removeNames = [];

                for (var i = 0, n = attrs.length; i < n; i++) {
                  var attr = attrs[i];
                  if (IGNORE_STORE_ATTRS.indexOf(attr.name) >= 0) continue;

                  if (!((_a = this._inputStatus) === null || _a === void 0 ? void 0 : _a.hasOwnProperty(attr.nodeName))) {
                    removeNames.push(attr.name);
                  }
                }

                removeNames.forEach(function (removeName) {
                  el.removeAttribute(removeName);
                });

                for (var name in this._inputStatus) {
                  el.setAttribute(name, this._inputStatus[name]);
                }

                if (composition) {
                  el.classList.add("composition");
                  el.style.font = this._grid.font || "16px sans-serif";
                } else {
                  el.classList.remove("composition");
                }

                el.classList.remove("grid-focus-control--stored-status");
              }
            }, {
              key: "storeInputStatus",
              value: function storeInputStatus() {
                var el = this._input;

                if (el.classList.contains("grid-focus-control--stored-status")) {
                  return;
                }

                var inputStatus = this._inputStatus = {};
                var attrs = el.attributes;

                for (var i = 0, n = attrs.length; i < n; i++) {
                  var attr = attrs[i];
                  if (IGNORE_STORE_ATTRS.indexOf(attr.name) >= 0) continue;
                  inputStatus[attr.name] = attr.value;
                }

                el.classList.add("grid-focus-control--stored-status");
              }
            }, {
              key: "setDefaultInputStatus",
              value: function setDefaultInputStatus() {// なぜかスクロールが少しずつずれていくことがあるのでここではセットしない。
                // this._input.style.font = this._grid.font || '16px sans-serif';
              }
            }, {
              key: "input",
              get: function get() {
                return this._input;
              }
            }, {
              key: "dispose",
              value: function dispose() {
                _get(_getPrototypeOf(FocusControl.prototype), "dispose", this).call(this);

                this._handler.dispose();
              }
            }]);

            return FocusControl;
          }(EventTarget_1.EventTarget);
          /**
           * Selected area management
           */


          var Selection = /*#__PURE__*/function (_EventTarget_1$EventT3) {
            _inherits(Selection, _EventTarget_1$EventT3);

            var _super49 = _createSuper(Selection);

            function Selection(grid) {
              var _this69;

              _classCallCheck(this, Selection);

              _this69 = _super49.call(this);
              _this69._grid = grid;
              _this69._sel = {
                col: 0,
                row: 0
              };
              _this69._focus = {
                col: 0,
                row: 0
              };
              _this69._start = {
                col: 0,
                row: 0
              };
              _this69._end = {
                col: 0,
                row: 0
              };
              return _this69;
            }

            _createClass(Selection, [{
              key: "range",
              get: function get() {
                var start = this._start;
                var end = this._end;
                var startCol = Math.min(start.col, end.col);
                var startRow = Math.min(start.row, end.row);
                var endCol = Math.max(start.col, end.col);
                var endRow = Math.max(start.row, end.row);
                return {
                  start: {
                    col: startCol,
                    row: startRow
                  },
                  end: {
                    col: endCol,
                    row: endRow
                  }
                };
              },
              set: function set(range) {
                var _this70 = this;

                this._callBeforeHooks();

                var startCol = Math.min(range.start.col, range.end.col);
                var startRow = Math.min(range.start.row, range.end.row);
                var endCol = Math.max(range.start.col, range.end.col);
                var endRow = Math.max(range.start.row, range.end.row);

                this._wrapFireSelectedEvent(function () {
                  _this70._sel = {
                    col: startCol,
                    row: startRow
                  };
                  _this70._focus = {
                    col: startCol,
                    row: startRow
                  };
                  _this70._start = {
                    col: startCol,
                    row: startRow
                  };
                  _this70._end = {
                    col: endCol,
                    row: endRow
                  };

                  _updatedSelection.call(_this70._grid);
                });
              }
            }, {
              key: "focus",
              get: function get() {
                var _this$_focus = this._focus,
                    col = _this$_focus.col,
                    row = _this$_focus.row;
                return {
                  col: col,
                  row: row
                };
              }
            }, {
              key: "select",
              get: function get() {
                var _this$_sel = this._sel,
                    col = _this$_sel.col,
                    row = _this$_sel.row;
                return {
                  col: col,
                  row: row
                };
              },
              set: function set(cell) {
                var _this71 = this;

                this._callBeforeHooks();

                this._wrapFireSelectedEvent(function () {
                  var _cell$col = cell.col,
                      col = _cell$col === void 0 ? 0 : _cell$col,
                      _cell$row = cell.row,
                      row = _cell$row === void 0 ? 0 : _cell$row;

                  _this71._setSelectCell(col, row);

                  _this71._setFocusCell(col, row, true, true);

                  _updatedSelection.call(_this71._grid);
                });
              }
            }, {
              key: "_setSelectCell",
              value: function _setSelectCell(col, row) {
                var _this72 = this;

                this._wrapFireSelectedEvent(function () {
                  _this72._sel = {
                    col: col,
                    row: row
                  };
                  _this72._start = {
                    col: col,
                    row: row
                  };
                });
              }
            }, {
              key: "_setFocusCell",
              value: function _setFocusCell(col, row, keepSelect, ignoreBeforeHook) {
                var _this73 = this;

                if (!ignoreBeforeHook) this._callBeforeHooks();

                this._wrapFireSelectedEvent(function () {
                  if (!keepSelect) {
                    _this73._setSelectCell(col, row);
                  }

                  _this73._focus = {
                    col: col,
                    row: row
                  };
                  _this73._end = {
                    col: col,
                    row: row
                  };
                });
              }
            }, {
              key: "_wrapFireSelectedEvent",
              value: function _wrapFireSelectedEvent(callback) {
                if (this._isWrapped) {
                  callback();
                } else {
                  this._isWrapped = true;

                  try {
                    var before = {
                      col: this._sel.col,
                      row: this._sel.row,
                      selected: false,
                      after: null
                    };
                    callback();
                    var after = {
                      col: this._sel.col,
                      row: this._sel.row,
                      selected: true,
                      before: {
                        col: before.col,
                        row: before.row
                      }
                    };
                    before.after = {
                      col: after.col,
                      row: after.row
                    };
                    this.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SELECTED_CELL, before);
                    this.fireListeners(DG_EVENT_TYPE_1.DG_EVENT_TYPE.SELECTED_CELL, after);
                  } finally {
                    this._isWrapped = false;
                  }
                }
              }
            }, {
              key: "_updateGridRange",
              value: function _updateGridRange() {
                var _this$_grid = this._grid,
                    rowCount = _this$_grid.rowCount,
                    colCount = _this$_grid.colCount;
                var points = [this._sel, this._focus, this._start, this._end];
                var needChange = false;

                for (var i = 0; i < points.length; i++) {
                  if (colCount <= points[i].col || rowCount <= points[i].row) {
                    needChange = true;
                    break;
                  }
                }

                if (!needChange) {
                  return false;
                }

                this._wrapFireSelectedEvent(function () {
                  points.forEach(function (p) {
                    p.col = Math.min(colCount - 1, p.col);
                    p.row = Math.min(rowCount - 1, p.row);
                  });
                });

                return true;
              }
            }, {
              key: "_callBeforeHooks",
              value: function _callBeforeHooks() {
                this.fireListeners("before_hook");
              }
            }]);

            return Selection;
          }(EventTarget_1.EventTarget);
          /**
           * This class manages the drawing process for each layer
           */

          /** @private */


          var DrawLayers = /*#__PURE__*/function () {
            function DrawLayers() {
              _classCallCheck(this, DrawLayers);

              this._layers = {};
            }

            _createClass(DrawLayers, [{
              key: "addDraw",
              value: function addDraw(level, fn) {
                var l = this._layers[level] || (this._layers[level] = new DrawLayer(level));
                l.addDraw(fn);
              }
            }, {
              key: "draw",
              value: function draw(ctx) {
                var list = [];

                for (var k in this._layers) {
                  list.push(this._layers[k]);
                }

                list.sort(function (a, b) {
                  return a.level - b.level;
                });
                list.forEach(function (l) {
                  return l.draw(ctx);
                });
              }
            }]);

            return DrawLayers;
          }();
          /** @private */


          var DrawLayer = /*#__PURE__*/function () {
            function DrawLayer(level) {
              _classCallCheck(this, DrawLayer);

              this._level = level;
              this._list = [];
            }

            _createClass(DrawLayer, [{
              key: "level",
              get: function get() {
                return this._level;
              }
            }, {
              key: "addDraw",
              value: function addDraw(fn) {
                this._list.push(fn);
              }
            }, {
              key: "draw",
              value: function draw(ctx) {
                this._list.forEach(function (fn) {
                  ctx.save();

                  try {
                    fn(ctx);
                  } finally {
                    ctx.restore();
                  }
                });
              }
            }]);

            return DrawLayer;
          }();
          /**
           * Context of cell drawing
           * @private
           */


          var DrawCellContext = /*#__PURE__*/function () {
            //  private _grid: any;
            //  private _onTerminate: any;

            /**
             * constructor
             * @param {number} col index of column
             * @param {number} row index of row
             * @param {CanvasRenderingContext2D} ctx context
             * @param {Rect} rect rect of cell area
             * @param {Rect} drawRect rect of drawing area
             * @param {boolean} drawing `true` if drawing is in progress
             * @param {object} selection the selection
             * @param {Array} drawLayers array of draw layers
             * @private
             */
            function DrawCellContext(col, row, ctx, rect, drawRect, drawing, selection, drawLayers) {
              _classCallCheck(this, DrawCellContext);

              this._rectFilter = null;
              this._col = col;
              this._row = row;
              this._mode = 0;
              this._ctx = ctx;
              this._rect = rect;
              this._drawRect = drawRect;
              this._drawing = drawing;
              this._selection = selection;
              this._drawLayers = drawLayers;
              this._childContexts = [];
            }

            _createClass(DrawCellContext, [{
              key: "drawing",
              get: function get() {
                if (this._mode === 0) {
                  return this._drawing;
                } else {
                  return true;
                }
              }
            }, {
              key: "row",
              get: function get() {
                return this._row;
              }
            }, {
              key: "col",
              get: function get() {
                return this._col;
              }
            }, {
              key: "cancel",
              value: function cancel() {
                this._cancel = true;

                this._childContexts.forEach(function (ctx) {
                  ctx.cancel();
                });
              }
              /**
               * select status.
               * @return {object} select status
               */

            }, {
              key: "getSelection",
              value: function getSelection() {
                return {
                  select: this._selection.select,
                  range: this._selection.range
                };
              }
              /**
               * Canvas context.
               * @return {CanvasRenderingContext2D} Canvas context.
               */

            }, {
              key: "getContext",
              value: function getContext() {
                if (this._mode === 0) {
                  return this._ctx;
                } else {
                  return _getInitContext.call(this._grid);
                }
              }
              /**
               * Rectangle of cell.
               * @return {Rect} rect Rectangle of cell.
               */

            }, {
              key: "getRect",
              value: function getRect() {
                var rectFilter = this._rectFilter;
                return rectFilter ? rectFilter(this._getRectInternal()) : this._getRectInternal();
              }
            }, {
              key: "setRectFilter",
              value: function setRectFilter(rectFilter) {
                this._rectFilter = rectFilter;
              }
              /**
               * Rectangle of Drawing range.
               * @return {Rect} Rectangle of Drawing range.
               */

            }, {
              key: "getDrawRect",
              value: function getDrawRect() {
                if (this._cancel) {
                  return null;
                }

                if (this._mode === 0) {
                  return this._drawRect;
                } else {
                  if (this._isOutOfRange()) {
                    return null;
                  }

                  var absoluteRect = this._grid.getCellRect(this._col, this._row);

                  return this._toRelativeDrawRect(absoluteRect);
                }
              }
            }, {
              key: "_isOutOfRange",
              value: function _isOutOfRange() {
                var _this$_grid2 = this._grid,
                    colCount = _this$_grid2.colCount,
                    rowCount = _this$_grid2.rowCount;
                return colCount <= this._col || rowCount <= this._row;
              }
              /**
               * get Context of current state
               * @return {DrawCellContext} current DrawCellContext.
               */

            }, {
              key: "toCurrentContext",
              value: function toCurrentContext() {
                if (this._mode === 0) {
                  return this;
                } else {
                  var absoluteRect = this._grid.getCellRect(this._col, this._row);

                  var rect = _toRelativeRect(this._grid, absoluteRect);

                  var drawRect = this._isOutOfRange() ? null : this._toRelativeDrawRect(absoluteRect);
                  var context = new DrawCellContext(this._col, this._row, this.getContext(), rect, drawRect, this.drawing, this._selection, this._drawLayers); // toCurrentContext は自分の toCurrentContextを呼ばせる

                  context.toCurrentContext = this.toCurrentContext.bind(this);

                  this._childContexts.push(context);

                  if (this._cancel) {
                    context.cancel();
                  }

                  context._rectFilter = this._rectFilter;
                  return context;
                }
              }
            }, {
              key: "addLayerDraw",
              value: function addLayerDraw(level, fn) {
                this._drawLayers.addDraw(level, fn);
              }
            }, {
              key: "_toRelativeDrawRect",
              value: function _toRelativeDrawRect(absoluteRect) {
                var visibleRect = _getVisibleRect(this._grid);

                var rect = absoluteRect.copy();

                if (!rect.intersection(visibleRect)) {
                  return null;
                }

                var grid = this._grid;
                var isFrozenCell = grid.isFrozenCell(this._col, this._row);

                if (grid.frozenColCount >= 0 && (!isFrozenCell || !isFrozenCell.col)) {
                  var fRect = grid.getCellRect(grid.frozenColCount - 1, this._row);
                  rect = Rect_1.Rect.bounds(Math.max(rect.left, fRect.right), rect.top, rect.right, rect.bottom);
                }

                if (grid.frozenRowCount >= 0 && (!isFrozenCell || !isFrozenCell.row)) {
                  var _fRect = grid.getCellRect(this._col, grid.frozenRowCount - 1);

                  rect = Rect_1.Rect.bounds(rect.left, Math.max(rect.top, _fRect.bottom), rect.right, rect.bottom);
                }

                if (!rect.intersection(visibleRect)) {
                  return null;
                }

                rect.offsetLeft(-visibleRect.left);
                rect.offsetTop(-visibleRect.top);
                return rect;
              }
            }, {
              key: "_delayMode",
              value: function _delayMode(grid, onTerminate) {
                this._mode = 1;
                this._ctx = null;
                this._rect = null;
                this._drawRect = null;
                this._grid = grid;
                this._onTerminate = onTerminate;
              }
              /**
               * terminate
               * @return {void}
               */

            }, {
              key: "terminate",
              value: function terminate() {
                var _a;

                if (this._mode !== 0) {
                  (_a = this._onTerminate) === null || _a === void 0 ? void 0 : _a.call(this);
                }
              }
            }, {
              key: "_getRectInternal",
              value: function _getRectInternal() {
                if (this._mode === 0) {
                  return this._rect;
                } else {
                  if (this._rect) {
                    return this._rect;
                  }

                  return this._grid.getCellRelativeRect(this._col, this._row);
                }
              }
            }]);

            return DrawCellContext;
          }();
          /** @private */


          var protectedKey = _;
          /**
           * DrawGrid
           * @classdesc cheetahGrid.core.DrawGrid
           * @memberof cheetahGrid.core
           */

          var DrawGrid = /*#__PURE__*/function (_EventTarget_1$EventT4) {
            _inherits(DrawGrid, _EventTarget_1$EventT4);

            var _super50 = _createSuper(DrawGrid);

            function DrawGrid() {
              var _this74;

              var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, DrawGrid);

              _this74 = _super50.call(this);
              var _options$rowCount = options.rowCount,
                  rowCount = _options$rowCount === void 0 ? 10 : _options$rowCount,
                  _options$colCount = options.colCount,
                  colCount = _options$colCount === void 0 ? 10 : _options$colCount,
                  _options$frozenColCou = options.frozenColCount,
                  frozenColCount = _options$frozenColCou === void 0 ? 0 : _options$frozenColCou,
                  _options$frozenRowCou = options.frozenRowCount,
                  frozenRowCount = _options$frozenRowCou === void 0 ? 0 : _options$frozenRowCou,
                  _options$defaultRowHe = options.defaultRowHeight,
                  defaultRowHeight = _options$defaultRowHe === void 0 ? 40 : _options$defaultRowHe,
                  _options$defaultColWi = options.defaultColWidth,
                  defaultColWidth = _options$defaultColWi === void 0 ? 80 : _options$defaultColWi,
                  font = options.font,
                  underlayBackgroundColor = options.underlayBackgroundColor,
                  keyboardOptions = options.keyboardOptions,
                  parentElement = options.parentElement,
                  disableColumnResize = options.disableColumnResize,
                  trimOnPaste = options.trimOnPaste;
              var protectedSpace = _this74[_] = {};
              style.initDocument();
              protectedSpace.element = createRootElement();
              protectedSpace.scrollable = new Scrollable_1.Scrollable();
              protectedSpace.handler = new EventHandler_1.EventHandler();
              protectedSpace.selection = new Selection(_assertThisInitialized(_this74));
              protectedSpace.focusControl = new FocusControl(_assertThisInitialized(_this74), protectedSpace.scrollable.getElement(), protectedSpace.scrollable, protectedSpace.selection);
              protectedSpace.canvas = hiDPI.transform(document.createElement("canvas"));
              protectedSpace.context = protectedSpace.canvas.getContext("2d", {
                alpha: false
              });
              protectedSpace.rowCount = rowCount;
              protectedSpace.colCount = colCount;
              protectedSpace.frozenColCount = frozenColCount;
              protectedSpace.frozenRowCount = frozenRowCount;
              protectedSpace.defaultRowHeight = defaultRowHeight;
              protectedSpace.defaultColWidth = defaultColWidth;
              protectedSpace.font = font;
              protectedSpace.underlayBackgroundColor = underlayBackgroundColor;
              protectedSpace.keyboardOptions = keyboardOptions;
              protectedSpace.disableColumnResize = disableColumnResize;
              protectedSpace.trimOnPaste = trimOnPaste !== null && trimOnPaste !== void 0 ? trimOnPaste : false; /////

              protectedSpace.rowHeightsMap = new NumberMap_1.NumberMap();
              protectedSpace.colWidthsMap = new NumberMap_1.NumberMap();
              protectedSpace.colWidthsLimit = {};
              protectedSpace.calcWidthContext = {
                _: protectedSpace,

                get full() {
                  return this._.canvas.width;
                },

                get em() {
                  return (0, canvases_1.getFontSize)(this._.context, this._.font).width;
                }

              };
              protectedSpace.columnResizer = new ColumnResizer(_assertThisInitialized(_this74));
              protectedSpace.cellSelector = new CellSelector(_assertThisInitialized(_this74));
              protectedSpace.drawCells = {};
              protectedSpace.cellTextOverflows = {};
              protectedSpace.focusedGrid = false;
              protectedSpace.element.appendChild(protectedSpace.canvas);
              protectedSpace.element.appendChild(protectedSpace.scrollable.getElement());
              protectedSpace.scroll = {
                left: 0,
                top: 0
              };

              _this74.updateScroll();

              if (parentElement) {
                parentElement.appendChild(protectedSpace.element);

                _this74.updateSize();
              } else {
                _this74.updateSize();
              }

              _bindEvents.call(_assertThisInitialized(_this74));

              _this74.bindEventsInternal();

              return _this74;
            }
            /**
             * Get root element.
             * @returns {HTMLElement} root element
             */


            _createClass(DrawGrid, [{
              key: "getElement",
              value: function getElement() {
                return this[_].element;
              }
              /**
               * Get canvas element.
               */

            }, {
              key: "canvas",
              get: function get() {
                return this[_].canvas;
              }
              /**
               * Focus the grid.
               * @return {void}
               */

            }, {
              key: "focus",
              value: function focus() {
                var _this$_$selection$sel2 = this[_].selection.select,
                    col = _this$_$selection$sel2.col,
                    row = _this$_$selection$sel2.row;
                this.focusCell(col, row);
              }
            }, {
              key: "hasFocusGrid",
              value: function hasFocusGrid() {
                return this[_].focusedGrid;
              }
              /**
               * Get the selection instance.
               */

            }, {
              key: "selection",
              get: function get() {
                return this[_].selection;
              }
              /**
               * Get the number of rows.
               */

            }, {
              key: "rowCount",
              get: function get() {
                return this[_].rowCount;
              }
              /**
               * Set the number of rows.
               */
              ,
              set: function set(rowCount) {
                this[_].rowCount = rowCount;
                this.updateScroll();

                if (this[_].selection._updateGridRange()) {
                  var _this$_$selection$foc = this[_].selection.focus,
                      col = _this$_$selection$foc.col,
                      row = _this$_$selection$foc.row;
                  this.makeVisibleCell(col, row);
                  this.setFocusCursor(col, row);
                }
              }
              /**
               * Get the number of columns.
               */

            }, {
              key: "colCount",
              get: function get() {
                return this[_].colCount;
              }
              /**
               * Set the number of columns.
               */
              ,
              set: function set(colCount) {
                this[_].colCount = colCount;
                this.updateScroll();

                if (this[_].selection._updateGridRange()) {
                  var _this$_$selection$foc2 = this[_].selection.focus,
                      col = _this$_$selection$foc2.col,
                      row = _this$_$selection$foc2.row;
                  this.makeVisibleCell(col, row);
                  this.setFocusCursor(col, row);
                }
              }
              /**
               * Get the number of frozen columns.
               */

            }, {
              key: "frozenColCount",
              get: function get() {
                return this[_].frozenColCount;
              }
              /**
               * Set the number of frozen columns.
               */
              ,
              set: function set(frozenColCount) {
                this[_].frozenColCount = frozenColCount;
              }
              /**
               * Get the number of frozen rows.
               */

            }, {
              key: "frozenRowCount",
              get: function get() {
                return this[_].frozenRowCount;
              }
              /**
               * Set the number of frozen rows.
               */
              ,
              set: function set(frozenRowCount) {
                this[_].frozenRowCount = frozenRowCount;
              }
              /**
               * Get the default row height.
               *
               */

            }, {
              key: "defaultRowHeight",
              get: function get() {
                return this[_].defaultRowHeight;
              }
              /**
               * Set the default row height.
               */
              ,
              set: function set(defaultRowHeight) {
                this[_].defaultRowHeight = defaultRowHeight;
              }
              /**
               * Get the default column width.
               */

            }, {
              key: "defaultColWidth",
              get: function get() {
                return this[_].defaultColWidth;
              }
              /**
               * Set the default column width.
               */
              ,
              set: function set(defaultColWidth) {
                this[_].defaultColWidth = defaultColWidth;
              }
              /**
               * Get the font definition as a string.
               */

            }, {
              key: "font",
              get: function get() {
                return this[_].font;
              }
              /**
               * Set the font definition with the given string.
               */
              ,
              set: function set(font) {
                this[_].font = font;
              }
              /**
               * Get the background color of the underlay.
               */

            }, {
              key: "underlayBackgroundColor",
              get: function get() {
                return this[_].underlayBackgroundColor;
              }
              /**
               * Set the background color of the underlay.
               */
              ,
              set: function set(underlayBackgroundColor) {
                this[_].underlayBackgroundColor = underlayBackgroundColor;
              }
              /**
               * If set to true, trim the pasted text on pasting.
               */

            }, {
              key: "trimOnPaste",
              get: function get() {
                return this[_].trimOnPaste;
              },
              set: function set(trimOnPaste) {
                this[_].trimOnPaste = trimOnPaste;
              }
            }, {
              key: "keyboardOptions",
              get: function get() {
                var _a;

                return (_a = this[_].keyboardOptions) !== null && _a !== void 0 ? _a : null;
              },
              set: function set(keyboardOptions) {
                this[_].keyboardOptions = keyboardOptions !== null && keyboardOptions !== void 0 ? keyboardOptions : undefined;
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "configure",
              value: function configure(name, value) {
                var cfg = this[_].config || (this[_].config = {});

                if (value != null) {
                  cfg[name] = value;
                }

                return cfg[name];
              }
              /**
               * Apply the changed size.
               * @return {void}
               */

            }, {
              key: "updateSize",
              value: function updateSize() {
                //スタイルをクリアしてサイズ値を取得
                var canvas = this[_].canvas;
                canvas.style.width = "";
                canvas.style.height = "";
                var width = Math.floor(canvas.offsetWidth || canvas.parentElement.offsetWidth - style.getScrollBarSize()
                /*for legacy*/
                );
                var height = Math.floor(canvas.offsetHeight || canvas.parentElement.offsetHeight - style.getScrollBarSize()
                /*for legacy*/
                );
                canvas.width = width;
                canvas.height = height; //整数で一致させるためstyleをセットして返す

                canvas.style.width = "".concat(width, "px");
                canvas.style.height = "".concat(height, "px");
                var focus = this[_].selection.focus;

                this[_].focusControl.setFocusRect(this.getCellRect(focus.col, focus.row));
              }
              /**
               * Apply the changed scroll size.
               * @return {boolean} `true` if there was a change in the scroll size
               */

            }, {
              key: "updateScroll",
              value: function updateScroll() {
                var scrollable = this[_].scrollable;

                var newHeight = _getScrollHeight.call(this);

                var newWidth = _getScrollWidth(this);

                if (newHeight === scrollable.scrollHeight && newWidth === scrollable.scrollWidth) {
                  return false;
                }

                scrollable.setScrollSize(newWidth, newHeight);
                this[_].scroll = {
                  left: scrollable.scrollLeft,
                  top: scrollable.scrollTop
                };
                var focus = this[_].selection.focus;

                this[_].focusControl.setFocusRect(this.getCellRect(focus.col, focus.row));

                return true;
              }
              /**
               * Get the row height of the given the row index.
               * @param  {number} row The row index
               * @return {number} The row height
               */

            }, {
              key: "getRowHeight",
              value: function getRowHeight(row) {
                return _getRowHeight.call(this, row);
              }
              /**
               * Set the row height of the given the row index.
               * @param  {number} row The row index
               * @param  {number} height The row height
               * @return {void}
               */

            }, {
              key: "setRowHeight",
              value: function setRowHeight(row, height) {
                _setRowHeight(this, row, height);
              }
              /**
               * Get the column width of the given the column index.
               * @param  {number} col The column index
               * @return {number} The column width
               */

            }, {
              key: "getColWidth",
              value: function getColWidth(col) {
                return _getColWidth(this, col);
              }
              /**
               * Set the column width of the given the column index.
               * @param  {number} col The column index
               * @param  {number} width The column width
               * @return {void}
               */

            }, {
              key: "setColWidth",
              value: function setColWidth(col, width) {
                _setColWidth(this, col, width);
              }
              /**
               * Get the column max width of the given the column index.
               * @param  {number} col The column index
               * @return {number} The column max width
               */

            }, {
              key: "getMaxColWidth",
              value: function getMaxColWidth(col) {
                var obj = this[_].colWidthsLimit[col];
                return obj && obj.max || undefined;
              }
              /**
               * Set the column max width of the given the column index.
               * @param  {number} col The column index
               * @param  {number} maxwidth The column max width
               * @return {void}
               */

            }, {
              key: "setMaxColWidth",
              value: function setMaxColWidth(col, maxwidth) {
                var obj = this[_].colWidthsLimit[col] || (this[_].colWidthsLimit[col] = {});

                if (maxwidth != null) {
                  obj.max = maxwidth;
                } else {
                  delete obj.max;
                }
              }
              /**
               * Get the column min width of the given the column index.
               * @param  {number} col The column index
               * @return {number} The column min width
               */

            }, {
              key: "getMinColWidth",
              value: function getMinColWidth(col) {
                var obj = this[_].colWidthsLimit[col];
                return obj && obj.min || undefined;
              }
              /**
               * Set the column min width of the given the column index.
               * @param  {number} col The column index
               * @param  {number} minwidth The column min width
               * @return {void}
               */

            }, {
              key: "setMinColWidth",
              value: function setMinColWidth(col, minwidth) {
                var obj = this[_].colWidthsLimit[col] || (this[_].colWidthsLimit[col] = {});

                if (minwidth != null) {
                  obj.min = minwidth;
                } else {
                  delete obj.min;
                }
              }
              /**
               * Get the rect of the cell.
               * @param {number} col index of column, of the cell
               * @param {number} row index of row, of the cell
               * @returns {Rect} the rect of the cell.
               */

            }, {
              key: "getCellRect",
              value: function getCellRect(col, row) {
                var isFrozenCell = this.isFrozenCell(col, row);

                var absoluteLeft = _getColsWidth(this, 0, col - 1);

                var width = _getColWidth(this, col);

                if (isFrozenCell && isFrozenCell.col) {
                  absoluteLeft += this[_].scroll.left;
                }

                var absoluteTop = _getRowsHeight.call(this, 0, row - 1);

                var height = _getRowHeight.call(this, row);

                if (isFrozenCell && isFrozenCell.row) {
                  absoluteTop += this[_].scroll.top;
                }

                return new Rect_1.Rect(absoluteLeft, absoluteTop, width, height);
              }
              /**
               * Get the relative rectangle of the cell.
               * @param {number} col index of column, of the cell
               * @param {number} row index of row, of the cell
               * @returns {Rect} the rect of the cell.
               */

            }, {
              key: "getCellRelativeRect",
              value: function getCellRelativeRect(col, row) {
                return _toRelativeRect(this, this.getCellRect(col, row));
              }
              /**
               * Get the rectangle of the cells area.
               * @param {number} startCol index of the starting column, of the cell
               * @param {number} startRow index of the starting row, of the cell
               * @param {number} endCol index of the ending column, of the cell
               * @param {number} endRow index of the ending row, of the cell
               * @returns {Rect} the rect of the cells.
               */

            }, {
              key: "getCellsRect",
              value: function getCellsRect(startCol, startRow, endCol, endRow) {
                var isFrozenStartCell = this.isFrozenCell(startCol, startRow);
                var isFrozenEndCell = this.isFrozenCell(endCol, endRow);

                var absoluteLeft = _getColsWidth(this, 0, startCol - 1);

                var width = _getColsWidth(this, startCol, endCol);

                if (isFrozenStartCell && isFrozenStartCell.col) {
                  var scrollLeft = this[_].scroll.left;
                  absoluteLeft += scrollLeft;

                  if (!isFrozenEndCell || !isFrozenEndCell.col) {
                    width -= scrollLeft;
                    width = Math.max(width, _getColsWidth(this, startCol, this.frozenColCount - 1));
                  }
                }

                var absoluteTop = _getRowsHeight.call(this, 0, startRow - 1);

                var height = _getRowsHeight.call(this, startRow, endRow);

                if (isFrozenStartCell && isFrozenStartCell.row) {
                  var scrollTop = this[_].scroll.top;
                  absoluteTop += scrollTop;

                  if (!isFrozenEndCell || !isFrozenEndCell.row) {
                    height -= scrollTop;
                    height = Math.max(height, _getColsWidth(this, startRow, this.frozenRowCount - 1));
                  }
                }

                return new Rect_1.Rect(absoluteLeft, absoluteTop, width, height);
              }
            }, {
              key: "getCellRangeRect",
              value: function getCellRangeRect(range) {
                return this.getCellsRect(range.start.col, range.start.row, range.end.col, range.end.row);
              }
            }, {
              key: "isFrozenCell",
              value: function isFrozenCell(col, row) {
                var _this$_ = this[_],
                    frozenRowCount = _this$_.frozenRowCount,
                    frozenColCount = _this$_.frozenColCount;
                var isFrozenRow = frozenRowCount > 0 && row < frozenRowCount;
                var isFrozenCol = frozenColCount > 0 && col < frozenColCount;

                if (isFrozenRow || isFrozenCol) {
                  return {
                    row: isFrozenRow,
                    col: isFrozenCol
                  };
                } else {
                  return null;
                }
              }
            }, {
              key: "getRowAt",
              value: function getRowAt(absoluteY) {
                var frozen = _getTargetFrozenRowAt(this, absoluteY);

                if (frozen) {
                  return frozen.row;
                }

                var row = _getTargetRowAt.call(this, absoluteY);

                return row ? row.row : -1;
              }
            }, {
              key: "getColAt",
              value: function getColAt(absoluteX) {
                var frozen = _getTargetFrozenColAt(this, absoluteX);

                if (frozen) {
                  return frozen.col;
                }

                var col = _getTargetColAt(this, absoluteX);

                return col ? col.col : -1;
              }
            }, {
              key: "getCellAt",
              value: function getCellAt(absoluteX, absoluteY) {
                return {
                  row: this.getRowAt(absoluteY),
                  col: this.getColAt(absoluteX)
                };
              }
              /**
               * Scroll to where cell is visible.
               * @param  {number} col The column index.
               * @param  {number} row The row index
               * @return {void}
               */

            }, {
              key: "makeVisibleCell",
              value: function makeVisibleCell(col, row) {
                var isFrozenCell = this.isFrozenCell(col, row);

                if (isFrozenCell && isFrozenCell.col && isFrozenCell.row) {
                  return;
                }

                var rect = this.getCellRect(col, row);

                var visibleRect = _getScrollableVisibleRect(this);

                if (visibleRect.contains(rect)) {
                  return;
                }

                var scrollable = this[_].scrollable;

                if (!isFrozenCell || !isFrozenCell.col) {
                  if (rect.left < visibleRect.left) {
                    scrollable.scrollLeft -= visibleRect.left - rect.left;
                  } else if (visibleRect.right < rect.right) {
                    scrollable.scrollLeft -= visibleRect.right - rect.right;
                  }
                }

                if (!isFrozenCell || !isFrozenCell.row) {
                  if (rect.top < visibleRect.top) {
                    scrollable.scrollTop -= visibleRect.top - rect.top;
                  } else if (visibleRect.bottom < rect.bottom) {
                    scrollable.scrollTop -= visibleRect.bottom - rect.bottom;
                  }
                }
              }
              /**
               * Moves the focus cursor to the given cell.
               * @param  {number} col The column index.
               * @param  {number} row The row index
               * @return {void}
               */

            }, {
              key: "setFocusCursor",
              value: function setFocusCursor(col, row) {
                var focusControl = this[_].focusControl;
                var oldEditMode = focusControl.editMode;
                focusControl.setFocusRect(this.getCellRect(col, row));

                _updatedSelection.call(this);

                if (oldEditMode && !focusControl.editMode) {
                  focusControl.resetInputStatus();
                }
              }
              /**
               * Focus the cell.
               * @param  {number} col The column index.
               * @param  {number} row The row index
               * @return {void}
               */

            }, {
              key: "focusCell",
              value: function focusCell(col, row) {
                this.setFocusCursor(col, row); // Failure occurs in IE if focus is not last

                this[_].focusControl.focus();
              }
              /**
               * Redraws the range of the given cell.
               * @param  {number} col The column index of cell.
               * @param  {number} row The row index of cell.
               * @return {void}
               */

            }, {
              key: "invalidateCell",
              value: function invalidateCell(col, row) {
                this.invalidateGridRect(col, row);
              }
              /**
               * Redraws the range of the given cells.
               * @param {number} startCol index of the starting column, of the cell
               * @param {number} startRow index of the starting row, of the cell
               * @param {number} endCol index of the ending column, of the cell
               * @param {number} endRow index of the ending row, of the cell
               * @return {void}
               */

            }, {
              key: "invalidateGridRect",
              value: function invalidateGridRect(startCol, startRow) {
                var endCol = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : startCol;
                var endRow = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : startRow;
                var offset = this.getOffsetInvalidateCells();

                if (offset > 0) {
                  startCol -= offset;
                  startRow -= offset;
                  endCol += offset;
                  endRow += offset;
                }

                var visibleRect = _getVisibleRect(this);

                var cellsRect = this.getCellsRect(startCol, startRow, endCol, endRow);
                var invalidateTarget = visibleRect.intersection(cellsRect);

                if (invalidateTarget) {
                  var _this$_2 = this[_],
                      frozenColCount = _this$_2.frozenColCount,
                      frozenRowCount = _this$_2.frozenRowCount;

                  if (frozenColCount > 0 && endCol >= frozenColCount) {
                    var frozenRect = _getFrozenColsRect(this);

                    if (frozenRect.intersection(invalidateTarget)) {
                      invalidateTarget.left = Math.min(frozenRect.right - 1, invalidateTarget.left);
                    }
                  }

                  if (frozenRowCount > 0 && endRow >= frozenRowCount) {
                    var _frozenRect4 = _getFrozenRowsRect(this);

                    if (_frozenRect4.intersection(invalidateTarget)) {
                      invalidateTarget.top = Math.min(_frozenRect4.bottom - 1, invalidateTarget.top);
                    }
                  }

                  _invalidateRect(this, invalidateTarget);
                }
              }
            }, {
              key: "invalidateCellRange",
              value: function invalidateCellRange(range) {
                this.invalidateGridRect(range.start.col, range.start.row, range.end.col, range.end.row);
              }
              /**
               * Redraws the whole grid.
               * @return {void}
               */

            }, {
              key: "invalidate",
              value: function invalidate() {
                var visibleRect = _getVisibleRect(this);

                _invalidateRect(this, visibleRect);
              }
              /**
               * Get the number of scrollable rows fully visible in the grid. visibleRowCount does not include the frozen rows counted by the frozenRowCount property. It does not include any partially visible rows on the bottom of the grid.
               * @returns {number}
               */

            }, {
              key: "visibleRowCount",
              get: function get() {
                var frozenRowCount = this.frozenRowCount;

                var visibleRect = _getVisibleRect(this);

                var visibleTop = frozenRowCount > 0 ? visibleRect.top + _getRowsHeight.call(this, 0, frozenRowCount - 1) : visibleRect.top;

                var initRow = _getTargetRowAt.call(this, visibleTop);

                if (!initRow) {
                  return 0;
                }

                var startRow = Math.max(initRow.top >= visibleTop ? initRow.row : initRow.row + 1, frozenRowCount);

                var absoluteTop = _getRowsHeight.call(this, 0, startRow - 1);

                var count = 0;
                var rowCount = this.rowCount;

                for (var row = startRow; row < rowCount; row++) {
                  var height = _getRowHeight.call(this, row);

                  var bottom = absoluteTop + height;

                  if (visibleRect.bottom < bottom) {
                    break;
                  }

                  count++;
                  absoluteTop = bottom;
                }

                return count;
              }
              /**
               * Get the number of scrollable columns fully visible in the grid. visibleColCount does not include the frozen columns counted by the frozenColCount property. It does not include any partially visible columns on the right of the grid.
               * @returns {number}
               */

            }, {
              key: "visibleColCount",
              get: function get() {
                var frozenColCount = this.frozenColCount;

                var visibleRect = _getVisibleRect(this);

                var visibleLeft = frozenColCount > 0 ? visibleRect.left + _getColsWidth(this, 0, frozenColCount - 1) : visibleRect.left;

                var initCol = _getTargetColAt(this, visibleLeft);

                if (!initCol) {
                  return 0;
                }

                var startCol = Math.max(initCol.left >= visibleLeft ? initCol.col : initCol.col + 1, frozenColCount);

                var absoluteLeft = _getColsWidth(this, 0, startCol - 1);

                var count = 0;
                var colCount = this.colCount;

                for (var col = startCol; col < colCount; col++) {
                  var width = _getColWidth(this, col);

                  var right = absoluteLeft + width;

                  if (visibleRect.right < right) {
                    break;
                  }

                  count++;
                  absoluteLeft = right;
                }

                return count;
              }
              /**
               * Get the index of the first row in the scrollable region that is visible.
               * @returns {number}
               */

            }, {
              key: "topRow",
              get: function get() {
                var frozenRowCount = this.frozenRowCount;

                var visibleRect = _getVisibleRect(this);

                var visibleTop = frozenRowCount > 0 ? visibleRect.top + _getRowsHeight.call(this, 0, frozenRowCount - 1) : visibleRect.top;

                var initRow = _getTargetRowAt.call(this, visibleTop);

                if (!initRow) {
                  return 0;
                }

                return Math.max(initRow.top >= visibleTop ? initRow.row : initRow.row + 1, frozenRowCount);
              }
              /**
               * Get the index of the first column in the scrollable region that is visible.
               * @returns {number}
               */

            }, {
              key: "leftCol",
              get: function get() {
                var frozenColCount = this.frozenColCount;

                var visibleRect = _getVisibleRect(this);

                var visibleLeft = frozenColCount > 0 ? visibleRect.left + _getColsWidth(this, 0, frozenColCount - 1) : visibleRect.left;

                var initCol = _getTargetColAt(this, visibleLeft);

                if (!initCol) {
                  return 0;
                }

                return Math.max(initCol.left >= visibleLeft ? initCol.col : initCol.col + 1, frozenColCount);
              }
              /**
               * gets or sets the number of pixels that an element's content is scrolled vertically
               */

            }, {
              key: "scrollTop",
              get: function get() {
                return this[_].scrollable.scrollTop;
              },
              set: function set(scrollTop) {
                this[_].scrollable.scrollTop = scrollTop;
              }
              /**
               * gets or sets the number of pixels that an element's content is scrolled from its left edge
               */

            }, {
              key: "scrollLeft",
              get: function get() {
                return this[_].scrollable.scrollLeft;
              },
              set: function set(scrollLeft) {
                this[_].scrollable.scrollLeft = scrollLeft;
              }
              /**
               * Get the value of cell with the copy action.
               * <p>
               * Please implement
               * </p>
               *
               * @protected
               * @param col Column index of cell.
               * @param row Row index of cell.
               * @param range Copy range.
               * @return {string} the value of cell
               */

            }, {
              key: "getCopyCellValue",
              value: function getCopyCellValue(_col, _row, _range) {
                //Please implement get cell value!!
                return undefined;
              }
              /**
               * Get the overflowed text in the cell rectangle, from the given cell.
               * @param  {number} col The column index.
               * @param  {number} row The row index
               * @return {string | null} The text overflowing the cell rect.
               */

            }, {
              key: "getCellOverflowText",
              value: function getCellOverflowText(col, row) {
                var key = "".concat(col, ":").concat(row);
                return this[_].cellTextOverflows[key] || null;
              }
              /**
               * Set the overflowed text in the cell rectangle, to the given cell.
               * @param  {number} col The column index.
               * @param  {number} row The row index
               * @param  {string} overflowText The overflowed text in the cell rectangle.
               * @return {void}
               */

            }, {
              key: "setCellOverflowText",
              value: function setCellOverflowText(col, row, overflowText) {
                var key = "".concat(col, ":").concat(row);

                if (overflowText) {
                  this[_].cellTextOverflows[key] = typeof overflowText === "string" ? overflowText.trim() : overflowText;
                } else {
                  delete this[_].cellTextOverflows[key];
                }
              }
            }, {
              key: "addDisposable",
              value: function addDisposable(disposable) {
                if (!disposable || !disposable.dispose || typeof disposable.dispose !== "function") {
                  throw new Error("not disposable!");
                }

                var disposables = this[_].disposables = this[_].disposables || [];
                disposables.push(disposable);
              }
              /**
               * Dispose the grid instance.
               * @returns {void}
               */

            }, {
              key: "dispose",
              value: function dispose() {
                _get(_getPrototypeOf(DrawGrid.prototype), "dispose", this).call(this);

                var protectedSpace = this[_];
                protectedSpace.handler.dispose();
                protectedSpace.scrollable.dispose();
                protectedSpace.focusControl.dispose();
                protectedSpace.columnResizer.dispose();
                protectedSpace.cellSelector.dispose();

                if (protectedSpace.disposables) {
                  protectedSpace.disposables.forEach(function (disposable) {
                    return disposable.dispose();
                  });
                  protectedSpace.disposables = null;
                }

                var parentElement = protectedSpace.element.parentElement;

                if (parentElement) {
                  parentElement.removeChild(protectedSpace.element);
                }
              }
            }, {
              key: "getAttachCellsArea",
              value: function getAttachCellsArea(range) {
                return {
                  element: this.getElement(),
                  rect: _toRelativeRect(this, this.getCellRangeRect(range))
                };
              }
            }, {
              key: "onKeyDownMove",
              value: function onKeyDownMove(evt) {
                _onKeyDownMove.call(this, evt);
              }
            }, {
              key: "bindEventsInternal",
              value: function bindEventsInternal() {//nop
              }
            }, {
              key: "getTargetRowAtInternal",
              value: function getTargetRowAtInternal(_absoluteY) {//継承用 設定を無視して計算する場合継承して実装
              }
            }, {
              key: "getRowsHeightInternal",
              value: function getRowsHeightInternal(_startRow, _endRow) {//継承用 設定を無視して計算する場合継承して実装
              }
            }, {
              key: "getRowHeightInternal",
              value: function getRowHeightInternal(_row) {//継承用 設定を無視して計算する場合継承して実装
              }
            }, {
              key: "getScrollHeightInternal",
              value: function getScrollHeightInternal(_row) {//継承用 設定を無視して計算する場合継承して実装
              }
            }, {
              key: "getMoveLeftColByKeyDownInternal",
              value: function getMoveLeftColByKeyDownInternal(_ref52) {
                var col = _ref52.col;
                return col - 1;
              }
            }, {
              key: "getMoveRightColByKeyDownInternal",
              value: function getMoveRightColByKeyDownInternal(_ref53) {
                var col = _ref53.col;
                return col + 1;
              }
            }, {
              key: "getMoveUpRowByKeyDownInternal",
              value: function getMoveUpRowByKeyDownInternal(_ref54) {
                var row = _ref54.row;
                return row - 1;
              }
            }, {
              key: "getMoveDownRowByKeyDownInternal",
              value: function getMoveDownRowByKeyDownInternal(_ref55) {
                var row = _ref55.row;
                return row + 1;
              }
            }, {
              key: "getOffsetInvalidateCells",
              value: function getOffsetInvalidateCells() {
                return 0;
              }
            }, {
              key: "getCopyRangeInternal",
              value: function getCopyRangeInternal(range) {
                return range;
              }
            }, {
              key: "_getInitContext",
              value: function _getInitContext() {
                var ctx = this[_].context; //初期化

                ctx.fillStyle = "white";
                ctx.strokeStyle = "black";
                ctx.textAlign = "left";
                ctx.textBaseline = "top";
                ctx.lineWidth = 1;
                ctx.font = this.font || "16px sans-serif";
                return ctx;
              }
            }, {
              key: "fireListeners",
              value: function fireListeners(type) {
                var _get3;

                for (var _len4 = arguments.length, event = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
                  event[_key4 - 1] = arguments[_key4];
                }

                return (_get3 = _get(_getPrototypeOf(DrawGrid.prototype), "fireListeners", this)).call.apply(_get3, [this, type].concat(event));
              }
            }], [{
              key: "EVENT_TYPE",
              get: function get() {
                return DG_EVENT_TYPE_1.DG_EVENT_TYPE;
              }
            }]);

            return DrawGrid;
          }(EventTarget_1.EventTarget);

          exports.DrawGrid = DrawGrid;
          /***/
        },

        /***/
        "./core/EventTarget.js":
        /*!*****************************!*\
          !*** ./core/EventTarget.js ***!
          \*****************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function coreEventTargetJs(module, exports, __nested_webpack_require_693349__) {
          "use strict";

          var _a;

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.EventTarget = void 0;

          var utils_1 = __nested_webpack_require_693349__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var symbolManager_1 = __nested_webpack_require_693349__(
          /*! ../internal/symbolManager */
          "./internal/symbolManager.js"); //private symbol

          /** @private */


          var _ = (0, symbolManager_1.get)();
          /** @private */


          var nextId = 1;
          /**
           * event target.
           */

          var EventTarget = /*#__PURE__*/function () {
            function EventTarget() {
              _classCallCheck(this, EventTarget);

              this[_a] = {
                listeners: {},
                listenerData: {}
              };
            }
            /**
             * Adds an event listener.
             * @param  {string} type The event type id.
             * @param  {function} listener Callback method.
             * @return {number} unique id for the listener.
             */


            _createClass(EventTarget, [{
              key: "listen",
              value: function listen(type, listener) {
                var _this75 = this;

                var list = this[_].listeners[type] || (this[_].listeners[type] = []);
                list.push(listener);
                var id = nextId++;
                this[_].listenerData[id] = {
                  type: type,
                  listener: listener,
                  remove: function remove() {
                    delete _this75[_].listenerData[id];
                    var index = list.indexOf(listener);
                    list.splice(index, 1);

                    if (!_this75[_].listeners[type].length) {
                      delete _this75[_].listeners[type];
                    }
                  }
                };
                return id;
              }
              /**
               * Removes an event listener which was added with listen() by the id returned by listen().
               * @param  {number} id the id returned by listen().
               * @return {void}
               */

            }, {
              key: "unlisten",
              value: function unlisten(id) {
                if (!this[_]) {
                  return;
                }

                this[_].listenerData[id].remove();
              }
            }, {
              key: "addEventListener",
              value: function addEventListener(type, listener) {
                this.listen(type, listener);
              }
            }, {
              key: "removeEventListener",
              value: function removeEventListener(type, listener) {
                var _this76 = this;

                if (!this[_]) {
                  return;
                }

                (0, utils_1.each)(this[_].listenerData, function (obj, id) {
                  if (obj.type === type && obj.listener === listener) {
                    _this76.unlisten(id);
                  }
                });
              }
            }, {
              key: "hasListeners",
              value: function hasListeners(type) {
                if (!this[_]) {
                  return false;
                }

                return !!this[_].listeners[type];
              }
              /**
               * Fires all registered listeners
               * @param  {string}    type The type of the listeners to fire.
               * @param  {...*} args fire arguments
               * @return {*} the result of the last listener
               */
              // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "fireListeners",
              value: function fireListeners(type) {
                var _this77 = this;

                for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {
                  args[_key5 - 1] = arguments[_key5];
                }

                if (!this[_]) {
                  return [];
                }

                var list = this[_].listeners[type];

                if (!list) {
                  return [];
                }

                return list.map(function (listener) {
                  return listener.call.apply(listener, [_this77].concat(args));
                }).filter(function (r) {
                  return r != null;
                });
              }
            }, {
              key: "dispose",
              value: function dispose() {
                // @ts-expect-error -- ignore
                delete this[_];
              }
            }]);

            return EventTarget;
          }();

          exports.EventTarget = EventTarget;
          _a = _;
          /***/
        },

        /***/
        "./data.js":
        /*!*****************!*\
          !*** ./data.js ***!
          \*****************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function dataJs(module, exports, __nested_webpack_require_698578__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.FilterDataSource = exports.CachedDataSource = exports.DataSource = void 0;

          var DataSource_1 = __nested_webpack_require_698578__(
          /*! ./data/DataSource */
          "./data/DataSource.js");

          Object.defineProperty(exports, "DataSource", {
            enumerable: true,
            get: function get() {
              return DataSource_1.DataSource;
            }
          });

          var CachedDataSource_1 = __nested_webpack_require_698578__(
          /*! ./data/CachedDataSource */
          "./data/CachedDataSource.js");

          Object.defineProperty(exports, "CachedDataSource", {
            enumerable: true,
            get: function get() {
              return CachedDataSource_1.CachedDataSource;
            }
          });

          var FilterDataSource_1 = __nested_webpack_require_698578__(
          /*! ./data/FilterDataSource */
          "./data/FilterDataSource.js");

          Object.defineProperty(exports, "FilterDataSource", {
            enumerable: true,
            get: function get() {
              return FilterDataSource_1.FilterDataSource;
            }
          });
          /***/
        },

        /***/
        "./data/CachedDataSource.js":
        /*!**********************************!*\
          !*** ./data/CachedDataSource.js ***!
          \**********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function dataCachedDataSourceJs(module, exports, __nested_webpack_require_700252__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.CachedDataSource = void 0;

          var DataSource_1 = __nested_webpack_require_700252__(
          /*! ./DataSource */
          "./data/DataSource.js");
          /** @private */


          function _setFieldCache( // eslint-disable-next-line @typescript-eslint/no-explicit-any
          fCache, index, field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          value) {
            var recCache = fCache[index] || (fCache[index] = new Map());
            recCache.set(field, value);
          }
          /**
           * grid data source for caching Promise data
           *
           * @classdesc cheetahGrid.data.CachedDataSource
           * @memberof cheetahGrid.data
           */


          var CachedDataSource = /*#__PURE__*/function (_DataSource_1$DataSou) {
            _inherits(CachedDataSource, _DataSource_1$DataSou);

            var _super51 = _createSuper(CachedDataSource);

            function CachedDataSource(opt) {
              var _this78;

              _classCallCheck(this, CachedDataSource);

              _this78 = _super51.call(this, opt);
              _this78._rCache = {};
              _this78._fCache = {};
              return _this78;
            }

            _createClass(CachedDataSource, [{
              key: "getOriginal",
              value: function getOriginal(index) {
                if (this._rCache && this._rCache[index]) {
                  return this._rCache[index];
                }

                return _get(_getPrototypeOf(CachedDataSource.prototype), "getOriginal", this).call(this, index);
              }
            }, {
              key: "getOriginalField",
              value: function getOriginalField(index, field) {
                var rowCache = this._fCache && this._fCache[index];

                if (rowCache) {
                  var cache = rowCache.get(field);

                  if (cache) {
                    return cache;
                  }
                }

                return _get(_getPrototypeOf(CachedDataSource.prototype), "getOriginalField", this).call(this, index, field);
              }
            }, {
              key: "setOriginalField",
              value: function setOriginalField(index, field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              value) {
                var fCache = this._fCache;

                if (fCache && fCache[index]) {
                  delete fCache[index]; // clear row cache
                }

                return _get(_getPrototypeOf(CachedDataSource.prototype), "setOriginalField", this).call(this, index, field, value);
              }
            }, {
              key: "clearCache",
              value: function clearCache() {
                if (this._rCache) {
                  this._rCache = {};
                }

                if (this._fCache) {
                  this._fCache = {};
                }
              }
            }, {
              key: "fieldPromiseCallBackInternal",
              value: function fieldPromiseCallBackInternal(index, field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              value) {
                _setFieldCache(this._fCache, index, field, value);
              }
            }, {
              key: "recordPromiseCallBackInternal",
              value: function recordPromiseCallBackInternal(index, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              record) {
                this._rCache[index] = record;
              }
            }, {
              key: "dispose",
              value: function dispose() {
                _get(_getPrototypeOf(CachedDataSource.prototype), "dispose", this).call(this);
              }
            }], [{
              key: "EVENT_TYPE",
              get: function get() {
                return DataSource_1.DataSource.EVENT_TYPE;
              }
            }, {
              key: "ofArray",
              value: function ofArray(array) {
                return new CachedDataSource({
                  get: function get(index) {
                    return array[index];
                  },
                  length: array.length,
                  source: array
                });
              }
            }]);

            return CachedDataSource;
          }(DataSource_1.DataSource);

          exports.CachedDataSource = CachedDataSource;
          /***/
        },

        /***/
        "./data/DataSource.js":
        /*!****************************!*\
          !*** ./data/DataSource.js ***!
          \****************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function dataDataSourceJs(module, exports, __nested_webpack_require_705181__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.DataSource = void 0;

          var _sort = __importStar(__nested_webpack_require_705181__(
          /*! ../internal/sort */
          "./internal/sort.js"));

          var utils_1 = __nested_webpack_require_705181__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var EventTarget_1 = __nested_webpack_require_705181__(
          /*! ../core/EventTarget */
          "./core/EventTarget.js");
          /** @private */


          function isFieldAssessor(field) {
            if (utils_1.obj.isObject(field)) {
              if (field.get && field.set) {
                return true;
              }
            }

            return false;
          }
          /** @private */


          var EVENT_TYPE = {
            UPDATE_LENGTH: "update_length",
            UPDATED_LENGTH: "updated_length",
            UPDATED_ORDER: "updated_order"
          };
          /** @private */

          function ascOrderFn(v1, v2) {
            if (v1 === v2) {
              return 0;
            }

            if (v1 == null) {
              return v2 == null ? // If both are nullish, consider a match.
              0 : // Nulls first
              -1;
            }

            if (v2 == null) {
              // Nulls first
              return 1;
            }

            return v1 > v2 ? 1 : -1;
          }

          function descOrderFn(v1, v2) {
            return ascOrderFn(v1, v2) * -1;
          }
          /** @private */


          function getValue(value, setPromiseBack) {
            var maybePromiseValue = (0, utils_1.getOrApply)(value);

            if ((0, utils_1.isPromise)(maybePromiseValue)) {
              var promiseValue = maybePromiseValue.then(function (r) {
                setPromiseBack(r);
                return r;
              }); //一時的にキャッシュ

              setPromiseBack(promiseValue);
              return promiseValue;
            } else {
              return maybePromiseValue;
            }
          }
          /** @private */


          function getField(record, field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          setPromiseBack) {
            if (record == null) {
              return undefined;
            }

            if ((0, utils_1.isPromise)(record)) {
              return record.then(function (r) {
                return getField(r, field, setPromiseBack);
              });
            }

            var fieldGet = isFieldAssessor(field) ? field.get : field;

            if (fieldGet in record) {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              var _fieldResult = record[fieldGet]; // eslint-disable-next-line @typescript-eslint/no-explicit-any

              return getValue(_fieldResult, setPromiseBack);
            }

            if (typeof fieldGet === "function") {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              var _fieldResult2 = fieldGet(record);

              return getValue(_fieldResult2, setPromiseBack);
            } // eslint-disable-next-line @typescript-eslint/restrict-template-expressions


            var ss = String(fieldGet).split(".");

            if (ss.length <= 1) {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              var _fieldResult3 = record[fieldGet];
              return getValue(_fieldResult3, setPromiseBack);
            }

            var fieldResult = (0, utils_1.applyChainSafe).apply(void 0, [record, // eslint-disable-next-line @typescript-eslint/no-explicit-any
            function (val, name) {
              return getField(val, name, utils_1.emptyFn);
            }].concat(_toConsumableArray(ss)));
            return getValue(fieldResult, setPromiseBack);
          }
          /** @private */


          function setField(record, field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          value) {
            if (record == null) {
              return false;
            }

            var fieldSet = isFieldAssessor(field) ? field.set : field;

            if (fieldSet in record) {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              record[fieldSet] = value;
            } else if (typeof fieldSet === "function") {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              return fieldSet(record, value);
            } else if (typeof fieldSet === "string") {
              var ss = "".concat(fieldSet).split("."); // eslint-disable-next-line @typescript-eslint/no-explicit-any

              var obj = record;
              var length = ss.length;

              for (var i = 0; i < length; i++) {
                var f = ss[i];

                if (i === length - 1) {
                  obj[f] = value;
                } else {
                  obj = obj[f] || (obj[f] = {});
                }
              }
            } else {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              record[fieldSet] = value;
            }

            return true;
          }
          /** @private */


          function _getIndex(sortedIndexMap, index) {
            if (!sortedIndexMap) {
              return index;
            }

            var mapIndex = sortedIndexMap[index];
            return mapIndex != null ? mapIndex : index;
          }
          /**
           * grid data source
           *
           * @classdesc cheetahGrid.data.DataSource
           * @memberof cheetahGrid.data
           */


          var DataSource = /*#__PURE__*/function (_EventTarget_1$EventT5) {
            _inherits(DataSource, _EventTarget_1$EventT5);

            var _super52 = _createSuper(DataSource);

            function DataSource(obj) {
              var _this79;

              _classCallCheck(this, DataSource);

              var _a;

              _this79 = _super52.call(this);
              _this79._sortedIndexMap = null; // eslint-disable-next-line @typescript-eslint/no-explicit-any

              _this79._get = (obj === null || obj === void 0 ? void 0 : obj.get.bind(obj)) || undefined;
              _this79._length = (obj === null || obj === void 0 ? void 0 : obj.length) || 0;
              _this79._source = (_a = obj === null || obj === void 0 ? void 0 : obj.source) !== null && _a !== void 0 ? _a : obj;
              return _this79;
            } // eslint-disable-next-line @typescript-eslint/no-explicit-any


            _createClass(DataSource, [{
              key: "source",
              get: function get() {
                return this._source;
              }
            }, {
              key: "get",
              value: function get(index) {
                return this.getOriginal(_getIndex(this._sortedIndexMap, index));
              }
            }, {
              key: "getField",
              value: function getField(index, field) {
                return this.getOriginalField(_getIndex(this._sortedIndexMap, index), field);
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "hasField",
              value: function hasField(index, field) {
                return this.hasOriginalField(_getIndex(this._sortedIndexMap, index), field);
              }
            }, {
              key: "setField",
              value: function setField(index, field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              value) {
                return this.setOriginalField(_getIndex(this._sortedIndexMap, index), field, value);
              }
            }, {
              key: "sort",
              value: function sort(field, order) {
                var _this80 = this;

                var sortedIndexMap = new Array(this._length);
                var orderFn = order !== "desc" ? ascOrderFn : descOrderFn;
                return _sort.sortPromise(function (index) {
                  return sortedIndexMap[index] != null ? sortedIndexMap[index] : sortedIndexMap[index] = index;
                }, function (index, rel) {
                  sortedIndexMap[index] = rel;
                }, this._length, orderFn, function (index) {
                  return _this80.getOriginalField(index, field);
                }).then(function () {
                  _this80._sortedIndexMap = sortedIndexMap;

                  _this80.fireListeners(EVENT_TYPE.UPDATED_ORDER);
                });
              }
            }, {
              key: "length",
              get: function get() {
                return this._length;
              },
              set: function set(length) {
                if (this._length === length) {
                  return;
                }

                var results = this.fireListeners(EVENT_TYPE.UPDATE_LENGTH, length);

                if (utils_1.array.findIndex(results, function (v) {
                  return !v;
                }) >= 0) {
                  return;
                }

                this._length = length;
                this.fireListeners(EVENT_TYPE.UPDATED_LENGTH, this._length);
              }
            }, {
              key: "dataSource",
              get: function get() {
                return this;
              }
            }, {
              key: "dispose",
              value: function dispose() {
                _get(_getPrototypeOf(DataSource.prototype), "dispose", this).call(this);
              }
            }, {
              key: "getOriginal",
              value: function getOriginal(index) {
                var _this81 = this;

                return getValue(this._get(index), function (val) {
                  _this81.recordPromiseCallBackInternal(index, val);
                });
              }
            }, {
              key: "getOriginalField",
              value: function getOriginalField(index, field) {
                var _this82 = this;

                if (field == null) {
                  return undefined;
                }

                var record = this.getOriginal(index);
                return getField(record, field, function (val) {
                  _this82.fieldPromiseCallBackInternal(index, field, val);
                });
              }
            }, {
              key: "hasOriginalField",
              value: function hasOriginalField(index, field) {
                if (field == null) {
                  return false;
                }

                if (typeof field === "function") {
                  return true;
                }

                var record = this.getOriginal(index);
                return Boolean(record && field in record);
              }
            }, {
              key: "setOriginalField",
              value: function setOriginalField(index, field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              value) {
                if (field == null) {
                  return false;
                }

                var record = this.getOriginal(index);

                if ((0, utils_1.isPromise)(record)) {
                  return record.then(function (r) {
                    return setField(r, field, value);
                  });
                }

                return setField(record, field, value);
              }
            }, {
              key: "fieldPromiseCallBackInternal",
              value: function fieldPromiseCallBackInternal(_index, _field, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              _value) {//
              }
            }, {
              key: "recordPromiseCallBackInternal",
              value: function recordPromiseCallBackInternal(_index, _record) {//
              }
            }], [{
              key: "EVENT_TYPE",
              get: function get() {
                return EVENT_TYPE;
              }
            }, {
              key: "ofArray",
              value: function ofArray(array) {
                return new DataSource({
                  get: function get(index) {
                    return array[index];
                  },
                  length: array.length,
                  source: array
                });
              }
            }]);

            return DataSource;
          }(EventTarget_1.EventTarget);

          exports.DataSource = DataSource; // eslint-disable-next-line @typescript-eslint/no-explicit-any

          DataSource.EMPTY = new DataSource({
            get: function get() {
              /*noop */
            },
            length: 0
          });
          /***/
        },

        /***/
        "./data/FilterDataSource.js":
        /*!**********************************!*\
          !*** ./data/FilterDataSource.js ***!
          \**********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function dataFilterDataSourceJs(module, exports, __nested_webpack_require_719641__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.FilterDataSource = void 0;

          var utils_1 = __nested_webpack_require_719641__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var DataSource_1 = __nested_webpack_require_719641__(
          /*! ./DataSource */
          "./data/DataSource.js");

          var EventHandler_1 = __nested_webpack_require_719641__(
          /*! ../internal/EventHandler */
          "./internal/EventHandler.js");
          /** @private */


          var DataSourceIterator = /*#__PURE__*/function () {
            function DataSourceIterator(dataSource) {
              _classCallCheck(this, DataSourceIterator);

              this._dataSource = dataSource;
              this._curIndex = -1;
              this._data = [];
            }

            _createClass(DataSourceIterator, [{
              key: "hasNext",
              value: function hasNext() {
                var next = this._curIndex + 1;
                return this._dataSource.length > next;
              }
            }, {
              key: "next",
              value: function next() {
                var next = this._curIndex + 1;

                var data = this._getIndexData(next);

                this._curIndex = next;
                return data;
              }
            }, {
              key: "movePrev",
              value: function movePrev() {
                this._curIndex--;
              }
            }, {
              key: "_getIndexData",
              value: function _getIndexData(index, nest) {
                var dataSource = this._dataSource;
                var data = this._data;

                if (index < data.length) {
                  return data[index];
                }

                if (dataSource.length <= index) {
                  return undefined;
                }

                var record = this._dataSource.get(index);

                data[index] = record;

                if ((0, utils_1.isPromise)(record)) {
                  record.then(function (val) {
                    data[index] = val;
                  });

                  if (!nest) {
                    for (var i = 1; i <= 100; i++) {
                      this._getIndexData(index + i, true);
                    }
                  }
                }

                return record;
              }
            }]);

            return DataSourceIterator;
          }();
          /** @private */


          var FilterData = /*#__PURE__*/function () {
            function FilterData(dc, original, filter) {
              _classCallCheck(this, FilterData);

              this._cancel = false;
              this._owner = dc;
              this._dataSourceItr = new DataSourceIterator(original);
              this._filter = filter;
              this._filteredList = [];
              this._queues = [];
            }

            _createClass(FilterData, [{
              key: "get",
              value: function get(index) {
                if (this._cancel) {
                  return undefined;
                }

                var filteredList = this._filteredList;

                if (index < filteredList.length) {
                  return filteredList[index];
                }

                var queues = this._queues;
                var indexQueue = queues[index];

                if (indexQueue) {
                  return indexQueue;
                }

                return queues[index] || this._findIndex(index);
              }
            }, {
              key: "cancel",
              value: function cancel() {
                this._cancel = true;
              }
            }, {
              key: "_findIndex",
              value: function _findIndex(index) {
                if (window.Promise) {
                  var timeout = Date.now() + 100;
                  var count = 0;
                  return this._findIndexWithTimeout(index, function () {
                    count++;

                    if (count >= 100) {
                      count = 0;
                      return timeout < Date.now();
                    }

                    return false;
                  });
                }

                return this._findIndexWithTimeout(index, function () {
                  return false;
                });
              }
            }, {
              key: "_findIndexWithTimeout",
              value: function _findIndexWithTimeout(index, testTimeout) {
                var _this83 = this;

                var filteredList = this._filteredList;
                var filter = this._filter;
                var dataSourceItr = this._dataSourceItr;
                var queues = this._queues;

                while (dataSourceItr.hasNext()) {
                  if (this._cancel) {
                    return undefined;
                  }

                  var record = dataSourceItr.next();

                  if ((0, utils_1.isPromise)(record)) {
                    dataSourceItr.movePrev();
                    var queue = record.then(function (_value) {
                      queues[index] = null;
                      return _this83.get(index);
                    });
                    queues[index] = queue;
                    return queue;
                  }

                  if (filter(record)) {
                    filteredList.push(record);

                    if (index < filteredList.length) {
                      return filteredList[index];
                    }
                  }

                  if (testTimeout()) {
                    var promise = new Promise(function (resolve) {
                      setTimeout(function () {
                        resolve();
                      }, 300);
                    });

                    var _queue = promise.then(function () {
                      queues[index] = null;
                      return _this83.get(index);
                    });

                    queues[index] = _queue;
                    return _queue;
                  }
                }

                var dc = this._owner;
                dc.length = filteredList.length;
                return undefined;
              }
            }]);

            return FilterData;
          }();
          /**
           * grid data source for filter
           *
           * @classdesc cheetahGrid.data.FilterDataSource
           * @memberof cheetahGrid.data
           */


          var FilterDataSource = /*#__PURE__*/function (_DataSource_1$DataSou2) {
            _inherits(FilterDataSource, _DataSource_1$DataSou2);

            var _super53 = _createSuper(FilterDataSource);

            function FilterDataSource(dataSource, filter) {
              var _this84;

              _classCallCheck(this, FilterDataSource);

              _this84 = _super53.call(this, dataSource);
              _this84._filterData = null;
              _this84._dataSource = dataSource;
              _this84.filter = filter;
              var handler = _this84._handler = new EventHandler_1.EventHandler();
              handler.on(dataSource, DataSource_1.DataSource.EVENT_TYPE.UPDATED_ORDER, function () {
                // reset
                // eslint-disable-next-line no-self-assign
                _this84.filter = _this84.filter;
              });
              (0, utils_1.each)(DataSource_1.DataSource.EVENT_TYPE, function (type) {
                handler.on(dataSource, type, function () {
                  var _this85;

                  for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
                    args[_key6] = arguments[_key6];
                  }

                  return (_this85 = _this84).fireListeners.apply(_this85, [type].concat(args));
                });
              });
              return _this84;
            }

            _createClass(FilterDataSource, [{
              key: "filter",
              get: function get() {
                var _a;

                return ((_a = this._filterData) === null || _a === void 0 ? void 0 : _a._filter) || null;
              },
              set: function set(filter) {
                if (this._filterData) {
                  this._filterData.cancel();
                }

                this._filterData = filter ? new FilterData(this, this._dataSource, filter) : null;
                this.length = this._dataSource.length;
              }
            }, {
              key: "getOriginal",
              value: function getOriginal(index) {
                if (!this._filterData) {
                  return _get(_getPrototypeOf(FilterDataSource.prototype), "getOriginal", this).call(this, index);
                }

                return this._filterData.get(index);
              }
            }, {
              key: "sort",
              value: function sort(field, order) {
                return this._dataSource.sort(field, order);
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "source",
              get: function get() {
                return this._dataSource.source;
              }
            }, {
              key: "dataSource",
              get: function get() {
                return this._dataSource;
              }
            }, {
              key: "dispose",
              value: function dispose() {
                this._handler.dispose();

                _get(_getPrototypeOf(FilterDataSource.prototype), "dispose", this).call(this);
              }
            }], [{
              key: "EVENT_TYPE",
              get: function get() {
                return DataSource_1.DataSource.EVENT_TYPE;
              }
            }]);

            return FilterDataSource;
          }(DataSource_1.DataSource);

          exports.FilterDataSource = FilterDataSource;
          /***/
        },

        /***/
        "./element/Inline.js":
        /*!***************************!*\
          !*** ./element/Inline.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function elementInlineJs(module, exports, __nested_webpack_require_729979__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Inline = void 0;

          var utils_1 = __nested_webpack_require_729979__(
          /*! ../internal/utils */
          "./internal/utils.js");

          function getWidth(ctx, content) {
            return ctx.measureText(content).width;
          }

          function breakWidth(ctx, content, itr, candidateIndex, width) {
            var chars = [];
            var ret = itr.next();

            for (var i = 0; i < candidateIndex && ret !== null; i++, ret = itr.next()) {
              chars.push(ret);
            }

            var beforeWidth = getWidth(ctx, chars.join(""));

            if (beforeWidth > width) {
              while (chars.length) {
                var c = chars.pop();
                beforeWidth -= getWidth(ctx, c || "");

                if (beforeWidth <= width) {
                  break;
                }
              }
            } else if (beforeWidth < width) {
              while (ret !== null) {
                var charWidth = getWidth(ctx, ret);

                if (beforeWidth + charWidth > width) {
                  break;
                }

                chars.push(ret);
                beforeWidth += charWidth;
                ret = itr.next();
              }
            }

            var beforeContent = chars.join("").replace(/\s+$/, "");
            var afterContent = content.slice(beforeContent.length).replace(/^\s+/, "");
            return {
              before: beforeContent ? new Inline(beforeContent) : null,
              after: afterContent ? new Inline(afterContent) : null
            };
          }

          var Inline = /*#__PURE__*/function () {
            function Inline(content) {
              _classCallCheck(this, Inline);

              this._content = content != null ? content : "";
            }

            _createClass(Inline, [{
              key: "width",
              value: function width(_ref56) {
                var ctx = _ref56.ctx;
                return getWidth(ctx, this._content);
              }
            }, {
              key: "font",
              value: function font() {
                return null;
              }
            }, {
              key: "color",
              value: function color() {
                return null;
              }
            }, {
              key: "canDraw",
              value: function canDraw() {
                return true;
              } // eslint-disable-next-line @typescript-eslint/no-empty-function

            }, {
              key: "onReady",
              value: function onReady(_callback) {}
            }, {
              key: "draw",
              value: function draw(_ref57) {
                var ctx = _ref57.ctx,
                    canvashelper = _ref57.canvashelper,
                    rect = _ref57.rect,
                    offset = _ref57.offset,
                    offsetLeft = _ref57.offsetLeft,
                    offsetRight = _ref57.offsetRight,
                    offsetTop = _ref57.offsetTop,
                    offsetBottom = _ref57.offsetBottom;
                canvashelper.fillTextRect(ctx, this._content, rect.left, rect.top, rect.width, rect.height, {
                  offset: offset + 1,
                  padding: {
                    left: offsetLeft,
                    right: offsetRight,
                    top: offsetTop,
                    bottom: offsetBottom
                  }
                });
              }
            }, {
              key: "canBreak",
              value: function canBreak() {
                return !!this._content;
              }
            }, {
              key: "splitIndex",
              value: function splitIndex(index) {
                var content = this._content;
                var itr = utils_1.str.genChars(content);
                var chars = [];
                var ret = itr.next();

                for (var i = 0; i < index && ret !== null; i++, ret = itr.next()) {
                  chars.push(ret);
                }

                var beforeContent = chars.join("");
                var afterContent = content.slice(beforeContent.length);
                return {
                  before: beforeContent ? new Inline(beforeContent) : null,
                  after: afterContent ? new Inline(afterContent) : null
                };
              }
            }, {
              key: "breakWord",
              value: function breakWord(ctx, width) {
                var content = this._content;
                var allWidth = this.width({
                  ctx: ctx
                });
                var candidate = Math.floor(this._content.length * width / allWidth);
                var itr = utils_1.str.genWords(content);
                return breakWidth(ctx, content, itr, candidate, width);
              }
            }, {
              key: "breakAll",
              value: function breakAll(ctx, width) {
                var content = this._content;
                var allWidth = this.width({
                  ctx: ctx
                });
                var candidate = Math.floor(this._content.length * width / allWidth);
                var itr = utils_1.str.genChars(content);
                return breakWidth(ctx, content, itr, candidate, width);
              }
            }, {
              key: "toString",
              value: function toString() {
                return this._content;
              }
            }]);

            return Inline;
          }();

          exports.Inline = Inline;
          /***/
        },

        /***/
        "./element/InlineDrawer.js":
        /*!*********************************!*\
          !*** ./element/InlineDrawer.js ***!
          \*********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function elementInlineDrawerJs(module, exports, __nested_webpack_require_736037__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineDrawer = void 0;

          var Inline_1 = __nested_webpack_require_736037__(
          /*! ./Inline */
          "./element/Inline.js");

          var InlineDrawer = /*#__PURE__*/function (_Inline_1$Inline) {
            _inherits(InlineDrawer, _Inline_1$Inline);

            var _super54 = _createSuper(InlineDrawer);

            function InlineDrawer(_ref58) {
              var _this86;

              var draw = _ref58.draw,
                  width = _ref58.width,
                  color = _ref58.color;

              _classCallCheck(this, InlineDrawer);

              _this86 = _super54.call(this);
              _this86._draw = draw;
              _this86._width = width; // this._height = height;

              _this86._color = color;
              return _this86;
            }

            _createClass(InlineDrawer, [{
              key: "width",
              value: function width(_arg) {
                return this._width;
              }
            }, {
              key: "font",
              value: function font() {
                return null;
              }
            }, {
              key: "color",
              value: function color() {
                var _a;

                return (_a = this._color) !== null && _a !== void 0 ? _a : null;
              }
            }, {
              key: "canDraw",
              value: function canDraw() {
                return true;
              } // eslint-disable-next-line @typescript-eslint/no-empty-function

            }, {
              key: "onReady",
              value: function onReady(_callback) {}
            }, {
              key: "draw",
              value: function draw(_ref59) {
                var ctx = _ref59.ctx,
                    canvashelper = _ref59.canvashelper,
                    rect = _ref59.rect,
                    offset = _ref59.offset,
                    offsetLeft = _ref59.offsetLeft,
                    offsetRight = _ref59.offsetRight,
                    offsetTop = _ref59.offsetTop,
                    offsetBottom = _ref59.offsetBottom;

                this._draw({
                  ctx: ctx,
                  canvashelper: canvashelper,
                  rect: rect,
                  offset: offset,
                  offsetLeft: offsetLeft,
                  offsetRight: offsetRight,
                  offsetTop: offsetTop,
                  offsetBottom: offsetBottom
                });
              }
            }, {
              key: "canBreak",
              value: function canBreak() {
                return false;
              }
            }, {
              key: "toString",
              value: function toString() {
                return "";
              }
            }]);

            return InlineDrawer;
          }(Inline_1.Inline);

          exports.InlineDrawer = InlineDrawer;
          /***/
        },

        /***/
        "./element/InlineIcon.js":
        /*!*******************************!*\
          !*** ./element/InlineIcon.js ***!
          \*******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function elementInlineIconJs(module, exports, __nested_webpack_require_739439__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineIcon = void 0;

          var fonts = __importStar(__nested_webpack_require_739439__(
          /*! ../internal/fonts */
          "./internal/fonts.js"));

          var Inline_1 = __nested_webpack_require_739439__(
          /*! ./Inline */
          "./element/Inline.js");

          var InlineIcon = /*#__PURE__*/function (_Inline_1$Inline2) {
            _inherits(InlineIcon, _Inline_1$Inline2);

            var _super55 = _createSuper(InlineIcon);

            function InlineIcon(icon) {
              var _this87;

              _classCallCheck(this, InlineIcon);

              _this87 = _super55.call(this);
              _this87._icon = icon || {};
              return _this87;
            }

            _createClass(InlineIcon, [{
              key: "width",
              value: function width(_ref60) {
                var ctx = _ref60.ctx;
                var icon = this._icon;

                if (icon.width) {
                  return icon.width;
                }

                if (icon.font && fonts.check(icon.font, icon.content || "")) {
                  ctx.save();
                  ctx.canvas.style.letterSpacing = "normal";

                  try {
                    ctx.font = icon.font || ctx.font;
                    return ctx.measureText(icon.content || "").width;
                  } finally {
                    ctx.canvas.style.letterSpacing = "";
                    ctx.restore();
                  }
                }

                return 0; //unknown
              }
            }, {
              key: "font",
              value: function font() {
                var _a;

                return (_a = this._icon.font) !== null && _a !== void 0 ? _a : null;
              }
            }, {
              key: "color",
              value: function color() {
                var _a;

                return (_a = this._icon.color) !== null && _a !== void 0 ? _a : null;
              }
            }, {
              key: "canDraw",
              value: function canDraw() {
                var icon = this._icon;
                return icon.font ? fonts.check(icon.font, icon.content || "") : true;
              }
            }, {
              key: "onReady",
              value: function onReady(callback) {
                var icon = this._icon;

                if (icon.font && !fonts.check(icon.font, icon.content || "")) {
                  fonts.load(icon.font, icon.content || "", callback);
                }
              }
            }, {
              key: "draw",
              value: function draw(_ref61) {
                var ctx = _ref61.ctx,
                    canvashelper = _ref61.canvashelper,
                    rect = _ref61.rect,
                    offset = _ref61.offset,
                    offsetLeft = _ref61.offsetLeft,
                    offsetRight = _ref61.offsetRight,
                    offsetTop = _ref61.offsetTop,
                    offsetBottom = _ref61.offsetBottom;
                var icon = this._icon;

                if (icon.content) {
                  ctx.canvas.style.letterSpacing = "normal";

                  try {
                    // eslint-disable-next-line no-self-assign
                    ctx.font = ctx.font; // To apply letterSpacing, we need to reset it.

                    canvashelper.fillTextRect(ctx, icon.content, rect.left, rect.top, rect.width, rect.height, {
                      offset: offset + 1,
                      padding: {
                        left: offsetLeft + (this._icon.offsetLeft || 0),
                        right: offsetRight,
                        top: offsetTop + (this._icon.offsetTop || 0),
                        bottom: offsetBottom
                      }
                    });
                  } finally {
                    ctx.canvas.style.letterSpacing = "";
                  }
                }
              }
            }, {
              key: "canBreak",
              value: function canBreak() {
                return false;
              }
            }, {
              key: "toString",
              value: function toString() {
                return "";
              }
            }]);

            return InlineIcon;
          }(Inline_1.Inline);

          exports.InlineIcon = InlineIcon;
          /***/
        },

        /***/
        "./element/InlineImage.js":
        /*!********************************!*\
          !*** ./element/InlineImage.js ***!
          \********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function elementInlineImageJs(module, exports, __nested_webpack_require_745655__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineImage = void 0;

          var Inline_1 = __nested_webpack_require_745655__(
          /*! ./Inline */
          "./element/Inline.js");

          var imgs_1 = __nested_webpack_require_745655__(
          /*! ../internal/imgs */
          "./internal/imgs.js");

          var utils_1 = __nested_webpack_require_745655__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var InlineImage = /*#__PURE__*/function (_Inline_1$Inline3) {
            _inherits(InlineImage, _Inline_1$Inline3);

            var _super56 = _createSuper(InlineImage);

            function InlineImage(_ref62) {
              var _this88;

              var src = _ref62.src,
                  width = _ref62.width,
                  height = _ref62.height,
                  imageLeft = _ref62.imageLeft,
                  imageTop = _ref62.imageTop,
                  imageWidth = _ref62.imageWidth,
                  imageHeight = _ref62.imageHeight;

              _classCallCheck(this, InlineImage);

              _this88 = _super56.call(this);
              _this88._inlineImgPromise = null;
              _this88._inlineImg = null;
              _this88._src = src;
              _this88._width = width;
              _this88._height = height;
              _this88._imageLeft = imageLeft;
              _this88._imageTop = imageTop;
              _this88._imageWidth = imageWidth;
              _this88._imageHeight = imageHeight;
              _this88._onloaded = [];

              if ((0, utils_1.isPromise)(src)) {
                src.then(function (s) {
                  _this88._src = s;

                  _this88._loadImage(s);
                });
              } else {
                _this88._loadImage(src);
              }

              return _this88;
            }

            _createClass(InlineImage, [{
              key: "_loadImage",
              value: function _loadImage(src) {
                var _this89 = this;

                var img = this._inlineImgPromise = (0, imgs_1.getCacheOrLoad)("InlineImage", 50, src);

                if ((0, utils_1.isPromise)(img)) {
                  img.then(function (i) {
                    _this89._inlineImg = i;

                    _this89._onloaded.forEach(function (fn) {
                      return fn();
                    });
                  });
                } else {
                  this._inlineImg = img;
                }
              }
            }, {
              key: "width",
              value: function width(_arg) {
                var _a, _b;

                return this._width || ((_b = (_a = this._inlineImg) === null || _a === void 0 ? void 0 : _a.width) !== null && _b !== void 0 ? _b : 0);
              }
            }, {
              key: "font",
              value: function font() {
                return null;
              }
            }, {
              key: "color",
              value: function color() {
                return null;
              }
            }, {
              key: "canDraw",
              value: function canDraw() {
                return !!this._inlineImg;
              }
            }, {
              key: "onReady",
              value: function onReady(callback) {
                if ((0, utils_1.isPromise)(this._src) || (0, utils_1.isPromise)(this._inlineImgPromise)) {
                  this._onloaded.push(function () {
                    return callback();
                  });
                }
              }
            }, {
              key: "draw",
              value: function draw(_ref63) {
                var ctx = _ref63.ctx,
                    canvashelper = _ref63.canvashelper,
                    rect = _ref63.rect,
                    offset = _ref63.offset,
                    offsetLeft = _ref63.offsetLeft,
                    offsetRight = _ref63.offsetRight,
                    offsetTop = _ref63.offsetTop,
                    offsetBottom = _ref63.offsetBottom;
                var img = this._inlineImg;
                canvashelper.drawInlineImageRect(ctx, img, this._imageLeft || 0, this._imageTop || 0, this._imageWidth || img.width, this._imageHeight || img.height, this._width || img.width, this._height || img.height, rect.left, rect.top, rect.width, rect.height, {
                  offset: offset + 1,
                  padding: {
                    left: offsetLeft,
                    right: offsetRight,
                    top: offsetTop,
                    bottom: offsetBottom
                  }
                });
              }
            }, {
              key: "canBreak",
              value: function canBreak() {
                return false;
              }
            }, {
              key: "toString",
              value: function toString() {
                return "";
              }
            }]);

            return InlineImage;
          }(Inline_1.Inline);

          exports.InlineImage = InlineImage;
          /***/
        },

        /***/
        "./element/InlinePath2D.js":
        /*!*********************************!*\
          !*** ./element/InlinePath2D.js ***!
          \*********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function elementInlinePath2DJs(module, exports, __nested_webpack_require_751140__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlinePath2D = void 0;

          var path2DManager = __importStar(__nested_webpack_require_751140__(
          /*! ../internal/path2DManager */
          "./internal/path2DManager.js"));

          var Inline_1 = __nested_webpack_require_751140__(
          /*! ./Inline */
          "./element/Inline.js");

          var canvases_1 = __nested_webpack_require_751140__(
          /*! ../internal/canvases */
          "./internal/canvases.js");

          var InlinePath2D = /*#__PURE__*/function (_Inline_1$Inline4) {
            _inherits(InlinePath2D, _Inline_1$Inline4);

            var _super57 = _createSuper(InlinePath2D);

            function InlinePath2D(_ref64) {
              var _this90;

              var path = _ref64.path,
                  width = _ref64.width,
                  height = _ref64.height,
                  color = _ref64.color;

              _classCallCheck(this, InlinePath2D);

              _this90 = _super57.call(this); // このタイミングでないとIEでPath2Dのpolyfillが反映されない

              var Path2D = path2DManager.getPath2D();
              _this90._path = new Path2D(path);
              _this90._width = width;
              _this90._height = height;
              _this90._color = color;
              return _this90;
            }

            _createClass(InlinePath2D, [{
              key: "width",
              value: function width(_arg) {
                return this._width;
              }
            }, {
              key: "font",
              value: function font() {
                return null;
              }
            }, {
              key: "color",
              value: function color() {
                var _a;

                return (_a = this._color) !== null && _a !== void 0 ? _a : null;
              }
            }, {
              key: "canDraw",
              value: function canDraw() {
                return true;
              } // eslint-disable-next-line @typescript-eslint/no-empty-function

            }, {
              key: "onReady",
              value: function onReady(_callback) {}
            }, {
              key: "draw",
              value: function draw(_ref65) {
                var ctx = _ref65.ctx,
                    rect = _ref65.rect,
                    offset = _ref65.offset,
                    offsetLeft = _ref65.offsetLeft,
                    offsetRight = _ref65.offsetRight,
                    offsetTop = _ref65.offsetTop,
                    offsetBottom = _ref65.offsetBottom;
                offset++;
                var padding = {
                  left: offsetLeft,
                  right: offsetRight,
                  top: offsetTop,
                  bottom: offsetBottom
                };
                ctx.save();

                try {
                  ctx.beginPath();
                  ctx.rect(rect.left, rect.top, rect.width, rect.height); //clip

                  ctx.clip(); //文字描画

                  var pos = (0, canvases_1.calcStartPosition)(ctx, rect, this._width, this._height, {
                    offset: offset,
                    padding: padding
                  });
                  ctx.translate(pos.x, pos.y);
                  ctx.fill(this._path);
                } finally {
                  ctx.restore();
                }
              }
            }, {
              key: "canBreak",
              value: function canBreak() {
                return false;
              }
            }, {
              key: "toString",
              value: function toString() {
                return "";
              }
            }]);

            return InlinePath2D;
          }(Inline_1.Inline);

          exports.InlinePath2D = InlinePath2D;
          /***/
        },

        /***/
        "./element/InlineSvg.js":
        /*!******************************!*\
          !*** ./element/InlineSvg.js ***!
          \******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function elementInlineSvgJs(module, exports, __nested_webpack_require_756734__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.InlineSvg = void 0;

          var utils_1 = __nested_webpack_require_756734__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var InlineImage_1 = __nested_webpack_require_756734__(
          /*! ./InlineImage */
          "./element/InlineImage.js");

          function buildSvgDataUrl(svg) {
            var data = typeof svg === "string" ? svg : new XMLSerializer().serializeToString(svg);
            var url = "data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(data)); //svgデータをbase64に変換

            return url;
          }

          function getSvgElement(svg) {
            if (typeof svg === "string") {
              var parser = new DOMParser();
              return parser.parseFromString(svg, "image/svg+xml").children[0];
            } else {
              return svg;
            }
          }

          var InlineSvg = /*#__PURE__*/function (_InlineImage_1$Inline) {
            _inherits(InlineSvg, _InlineImage_1$Inline);

            var _super58 = _createSuper(InlineSvg);

            function InlineSvg(_ref66) {
              var svg = _ref66.svg,
                  width = _ref66.width,
                  height = _ref66.height;

              _classCallCheck(this, InlineSvg);

              var _a, _b;

              var svgElem = (0, utils_1.then)(svg, getSvgElement);
              var elmWidth = !(0, utils_1.isPromise)(svgElem) ? (_a = svgElem.getAttribute("width")) !== null && _a !== void 0 ? _a : undefined : undefined;
              var elmHeight = !(0, utils_1.isPromise)(svgElem) ? (_b = svgElem.getAttribute("height")) !== null && _b !== void 0 ? _b : undefined : undefined;
              var numElmWidth = elmWidth != null ? Number(elmWidth) : undefined;
              var numElmHeight = elmHeight != null ? Number(elmHeight) : undefined;
              return _super58.call(this, {
                src: (0, utils_1.then)(svg, buildSvgDataUrl),
                width: width || numElmWidth,
                height: height || numElmHeight,
                imageWidth: numElmWidth,
                imageHeight: numElmHeight
              });
            }

            _createClass(InlineSvg, [{
              key: "canBreak",
              value: function canBreak() {
                return false;
              }
            }, {
              key: "toString",
              value: function toString() {
                return "";
              }
            }]);

            return InlineSvg;
          }(InlineImage_1.InlineImage);

          exports.InlineSvg = InlineSvg;
          /***/
        },

        /***/
        "./element/inlines.js":
        /*!****************************!*\
          !*** ./element/inlines.js ***!
          \****************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function elementInlinesJs(module, exports, __nested_webpack_require_759814__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.string = exports.buildInlines = exports.of = exports.iconOf = void 0;

          var icons = __importStar(__nested_webpack_require_759814__(
          /*! ../icons */
          "./icons.js"));

          var path2DManager = __importStar(__nested_webpack_require_759814__(
          /*! ../internal/path2DManager */
          "./internal/path2DManager.js"));

          var Inline_1 = __nested_webpack_require_759814__(
          /*! ./Inline */
          "./element/Inline.js");

          var InlineDrawer_1 = __nested_webpack_require_759814__(
          /*! ./InlineDrawer */
          "./element/InlineDrawer.js");

          var InlineIcon_1 = __nested_webpack_require_759814__(
          /*! ./InlineIcon */
          "./element/InlineIcon.js");

          var InlineImage_1 = __nested_webpack_require_759814__(
          /*! ./InlineImage */
          "./element/InlineImage.js");

          var InlinePath2D_1 = __nested_webpack_require_759814__(
          /*! ./InlinePath2D */
          "./element/InlinePath2D.js");

          var InlineSvg_1 = __nested_webpack_require_759814__(
          /*! ./InlineSvg */
          "./element/InlineSvg.js");

          var canvases_1 = __nested_webpack_require_759814__(
          /*! ../internal/canvases */
          "./internal/canvases.js");

          function drawRegisteredIcon(ctx, icon, drawWidth, drawHeight, left, top, width, height) {
            var _ref67 = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : {},
                _ref67$offset = _ref67.offset,
                offset = _ref67$offset === void 0 ? 2 : _ref67$offset,
                padding = _ref67.padding;

            var rect = {
              left: left,
              top: top,
              width: width,
              height: height,
              right: left + width,
              bottom: top + height
            };
            ctx.save();

            try {
              ctx.beginPath();
              ctx.rect(rect.left, rect.top, rect.width, rect.height); //clip

              ctx.clip(); //文字描画

              var pos = (0, canvases_1.calcStartPosition)(ctx, rect, drawWidth, drawHeight, {
                offset: offset,
                padding: padding
              });
              path2DManager.fill(icon, ctx, pos.x, pos.y, drawWidth, drawHeight);
            } finally {
              ctx.restore();
            }
          }

          function isIconConstructorOption(icon) {
            if (icon.font && icon.content) {
              return true;
            }

            return false;
          }

          function isInlineImageConstructorOption(icon) {
            if (icon.src) {
              return true;
            }

            return false;
          }

          function isInlineSvgConstructorOption(icon) {
            if (icon.path) {
              return true;
            }

            return false;
          }

          function iconOf(icon) {
            if (icon instanceof Inline_1.Inline) {
              return icon;
            }

            if (!icon) {
              return null;
            }

            if (isIconConstructorOption(icon)) {
              return new InlineIcon_1.InlineIcon(icon);
            }

            if (isInlineImageConstructorOption(icon)) {
              return new InlineImage_1.InlineImage({
                src: icon.src,
                width: icon.width,
                height: icon.width
              });
            }

            if (icon.svg) {
              return new InlineSvg_1.InlineSvg({
                svg: icon.svg,
                width: icon.width,
                height: icon.width
              });
            }

            if (isInlineSvgConstructorOption(icon)) {
              return new InlinePath2D_1.InlinePath2D({
                path: icon.path,
                width: icon.width,
                height: icon.width,
                color: icon.color
              });
            }

            var registeredIcons = icons.get();

            if (icon.name && registeredIcons[icon.name]) {
              var registeredIcon = registeredIcons[icon.name];
              var width = icon.width || Math.max(registeredIcon.width, registeredIcon.height);
              return new InlineDrawer_1.InlineDrawer({
                draw: function draw(_ref68) {
                  var ctx = _ref68.ctx,
                      rect = _ref68.rect,
                      offset = _ref68.offset,
                      offsetLeft = _ref68.offsetLeft,
                      offsetRight = _ref68.offsetRight,
                      offsetTop = _ref68.offsetTop,
                      offsetBottom = _ref68.offsetBottom;
                  drawRegisteredIcon(ctx, registeredIcon, width, width, rect.left, rect.top, rect.width, rect.height, {
                    offset: offset + 1,
                    padding: {
                      left: offsetLeft,
                      right: offsetRight,
                      top: offsetTop,
                      bottom: offsetBottom
                    }
                  });
                },
                width: width,
                height: width,
                color: icon.color
              });
            }

            return new InlineIcon_1.InlineIcon(icon);
          }

          exports.iconOf = iconOf;

          function of(content) {
            if (content == null) {
              return null;
            }

            if (content instanceof Inline_1.Inline) {
              return content;
            }

            return new Inline_1.Inline(content);
          }

          exports.of = of;

          function buildInlines(icons, inline) {
            var result = [];

            if (icons) {
              result.push.apply(result, _toConsumableArray(icons.map(function (icon) {
                return iconOf(icon);
              }).filter(function (i) {
                return i != null;
              })));
            }

            if (Array.isArray(inline) // && inline.filter(il => il instanceof Inline).length <- ?
            ) {
                result.push.apply(result, _toConsumableArray(inline.map(function (il) {
                  return of(il);
                }).filter(function (i) {
                  return i != null;
                })));
              } else {
              var il = of(inline);

              if (il) {
                result.push(il);
              }
            }

            return result;
          }

          exports.buildInlines = buildInlines;

          function string(inline) {
            return buildInlines(undefined, inline).join("");
          }

          exports.string = string;
          /***/
        },

        /***/
        "./get-internal.js":
        /*!*************************!*\
          !*** ./get-internal.js ***!
          \*************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function getInternalJs(module, exports, __nested_webpack_require_768264__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.getInternal = void 0;

          function getInternal() {
            console.warn("use internal!!");
            return {
              color: __nested_webpack_require_768264__(
              /*! ./internal/color */
              "./internal/color.js"),
              sort: __nested_webpack_require_768264__(
              /*! ./internal/sort */
              "./internal/sort.js"),
              calc: __nested_webpack_require_768264__(
              /*! ./internal/calc */
              "./internal/calc.js"),
              symbolManager: __nested_webpack_require_768264__(
              /*! ./internal/symbolManager */
              "./internal/symbolManager.js"),
              path2DManager: __nested_webpack_require_768264__(
              /*! ./internal/path2DManager */
              "./internal/path2DManager.js"),
              pasteUtils: __nested_webpack_require_768264__(
              /*! ./internal/paste-utils */
              "./internal/paste-utils.js")
            };
          }

          exports.getInternal = getInternal;
          /***/
        },

        /***/
        "./header/action.js":
        /*!**************************!*\
          !*** ./header/action.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerActionJs(module, exports, __nested_webpack_require_769762__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ofCell = exports.of = exports.CheckHeaderAction = exports.SortHeaderAction = exports.BaseAction = exports.ACTIONS = void 0;

          var BaseAction_1 = __nested_webpack_require_769762__(
          /*! ./action/BaseAction */
          "./header/action/BaseAction.js");

          Object.defineProperty(exports, "BaseAction", {
            enumerable: true,
            get: function get() {
              return BaseAction_1.BaseAction;
            }
          });

          var CheckHeaderAction_1 = __nested_webpack_require_769762__(
          /*! ./action/CheckHeaderAction */
          "./header/action/CheckHeaderAction.js");

          Object.defineProperty(exports, "CheckHeaderAction", {
            enumerable: true,
            get: function get() {
              return CheckHeaderAction_1.CheckHeaderAction;
            }
          });

          var SortHeaderAction_1 = __nested_webpack_require_769762__(
          /*! ./action/SortHeaderAction */
          "./header/action/SortHeaderAction.js");

          Object.defineProperty(exports, "SortHeaderAction", {
            enumerable: true,
            get: function get() {
              return SortHeaderAction_1.SortHeaderAction;
            }
          });

          var ImmutableSortHeaderAction = /*#__PURE__*/function (_SortHeaderAction_1$S) {
            _inherits(ImmutableSortHeaderAction, _SortHeaderAction_1$S);

            var _super59 = _createSuper(ImmutableSortHeaderAction);

            function ImmutableSortHeaderAction() {
              _classCallCheck(this, ImmutableSortHeaderAction);

              return _super59.apply(this, arguments);
            }

            _createClass(ImmutableSortHeaderAction, [{
              key: "disabled",
              get: function get() {
                return this._disabled;
              }
            }]);

            return ImmutableSortHeaderAction;
          }(SortHeaderAction_1.SortHeaderAction);

          var ImmutableCheckHeaderAction = /*#__PURE__*/function (_CheckHeaderAction_1$) {
            _inherits(ImmutableCheckHeaderAction, _CheckHeaderAction_1$);

            var _super60 = _createSuper(ImmutableCheckHeaderAction);

            function ImmutableCheckHeaderAction() {
              _classCallCheck(this, ImmutableCheckHeaderAction);

              return _super60.apply(this, arguments);
            }

            _createClass(ImmutableCheckHeaderAction, [{
              key: "disabled",
              get: function get() {
                return this._disabled;
              }
            }]);

            return ImmutableCheckHeaderAction;
          }(CheckHeaderAction_1.CheckHeaderAction);

          exports.ACTIONS = {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            SORT: new ImmutableSortHeaderAction(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            CHECK: new ImmutableCheckHeaderAction()
          };

          function of(headerAction) {
            if (!headerAction) {
              return undefined;
            } else if (typeof headerAction === "string") {
              var key = headerAction.toUpperCase();
              return exports.ACTIONS[key] || of(null);
            } else {
              return headerAction;
            }
          }

          exports.of = of;

          function ofCell(headerCell) {
            if (headerCell.sort) {
              if (typeof headerCell.sort === "function") {
                var sortMethod = headerCell.sort; // 0.9.0 Backward compatibility

                var sort = function sort(_ref69) {
                  var order = _ref69.order,
                      col = _ref69.col,
                      grid = _ref69.grid;
                  return sortMethod.call(headerCell, order, col, grid);
                };

                return new ImmutableSortHeaderAction({
                  sort: sort
                });
              }

              if (typeof headerCell.sort === "string") {
                return new ImmutableSortHeaderAction({
                  sort: headerCell.sort
                });
              }

              return exports.ACTIONS.SORT;
            }

            return of(headerCell.headerAction);
          }

          exports.ofCell = ofCell;
          /***/
        },

        /***/
        "./header/action/BaseAction.js":
        /*!*************************************!*\
          !*** ./header/action/BaseAction.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerActionBaseActionJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseAction = void 0;

          var BaseAction = /*#__PURE__*/function () {
            function BaseAction() {
              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, BaseAction);

              this._disabled = !!option.disabled || false;
            }

            _createClass(BaseAction, [{
              key: "disabled",
              get: function get() {
                return this._disabled;
              },
              set: function set(disabled) {
                this._disabled = disabled;
                this.onChangeDisabledInternal();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new BaseAction(this);
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(_grid, _cellId) {
                return [];
              }
            }, {
              key: "onChangeDisabledInternal",
              value: function onChangeDisabledInternal() {// impl
              }
            }]);

            return BaseAction;
          }();

          exports.BaseAction = BaseAction;
          /***/
        },

        /***/
        "./header/action/CheckHeaderAction.js":
        /*!********************************************!*\
          !*** ./header/action/CheckHeaderAction.js ***!
          \********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerActionCheckHeaderActionJs(module, exports, __nested_webpack_require_776429__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.CheckHeaderAction = void 0;

          var actionBind_1 = __nested_webpack_require_776429__(
          /*! ./actionBind */
          "./header/action/actionBind.js");

          var BaseAction_1 = __nested_webpack_require_776429__(
          /*! ./BaseAction */
          "./header/action/BaseAction.js");

          var animate_1 = __nested_webpack_require_776429__(
          /*! ../../internal/animate */
          "./internal/animate.js");

          var symbolManager_1 = __nested_webpack_require_776429__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_776429__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var CHECK_HEADER_STATE_ID = (0, symbolManager_1.getCheckHeaderStateId)();

          function getState(grid) {
            var state = grid[CHECK_HEADER_STATE_ID];

            if (!state) {
              state = {
                elapsed: {},
                block: {}
              };
              utils_1.obj.setReadonly(grid, CHECK_HEADER_STATE_ID, state);
            }

            return state;
          }

          var CheckHeaderAction = /*#__PURE__*/function (_BaseAction_1$BaseAct3) {
            _inherits(CheckHeaderAction, _BaseAction_1$BaseAct3);

            var _super61 = _createSuper(CheckHeaderAction);

            function CheckHeaderAction() {
              _classCallCheck(this, CheckHeaderAction);

              return _super61.apply(this, arguments);
            }

            _createClass(CheckHeaderAction, [{
              key: "clone",
              value: function clone() {
                return new CheckHeaderAction(this);
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(grid, cellId) {
                var _this91 = this;

                var state = getState(grid);

                var action = function action(_ref70) {
                  var col = _ref70.col,
                      row = _ref70.row;
                  var range = grid.getCellRange(col, row);
                  var cellKey = "".concat(range.start.col, ":").concat(range.start.row);

                  if (_this91.disabled || state.block[cellKey]) {
                    return;
                  }

                  var checked = grid.getHeaderValue(range.start.col, range.start.row);
                  grid.setHeaderValue(range.start.col, range.start.row, !checked);

                  var onChange = function onChange() {
                    // checkbox animation
                    (0, animate_1.animate)(200, function (point) {
                      if (point === 1) {
                        delete state.elapsed[cellKey];
                      } else {
                        state.elapsed[cellKey] = point;
                      }

                      grid.invalidateCellRange(range);
                    });
                  };

                  onChange();
                };

                return [].concat(_toConsumableArray((0, actionBind_1.bindCellClickAction)(grid, cellId, {
                  action: action,
                  mouseOver: function mouseOver(e) {
                    if (_this91.disabled) {
                      return false;
                    }

                    state.mouseActiveCell = {
                      col: e.col,
                      row: e.row
                    };
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                    return true;
                  },
                  mouseOut: function mouseOut(e) {
                    delete state.mouseActiveCell;
                    var range = grid.getCellRange(e.col, e.row);
                    grid.invalidateCellRange(range);
                  }
                })), _toConsumableArray((0, actionBind_1.bindCellKeyAction)(grid, cellId, {
                  action: action
                })));
              }
            }]);

            return CheckHeaderAction;
          }(BaseAction_1.BaseAction);

          exports.CheckHeaderAction = CheckHeaderAction;
          /***/
        },

        /***/
        "./header/action/SortHeaderAction.js":
        /*!*******************************************!*\
          !*** ./header/action/SortHeaderAction.js ***!
          \*******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerActionSortHeaderActionJs(module, exports, __nested_webpack_require_781147__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.SortHeaderAction = void 0;

          var BaseAction_1 = __nested_webpack_require_781147__(
          /*! ./BaseAction */
          "./header/action/BaseAction.js");

          var actionBind_1 = __nested_webpack_require_781147__(
          /*! ./actionBind */
          "./header/action/actionBind.js");

          var SortHeaderAction = /*#__PURE__*/function (_BaseAction_1$BaseAct4) {
            _inherits(SortHeaderAction, _BaseAction_1$BaseAct4);

            var _super62 = _createSuper(SortHeaderAction);

            function SortHeaderAction() {
              var _this92;

              var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, SortHeaderAction);

              var _a;

              _this92 = _super62.call(this, option);
              _this92._sort = (_a = option.sort) !== null && _a !== void 0 ? _a : true;
              return _this92;
            }

            _createClass(SortHeaderAction, [{
              key: "sort",
              get: function get() {
                return this._sort;
              },
              set: function set(sort) {
                this._sort = sort;
                this.onChangeDisabledInternal();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new SortHeaderAction(this);
              }
            }, {
              key: "_executeSort",
              value: function _executeSort(newState, grid) {
                if (typeof this._sort === "function") {
                  this._sort({
                    order: newState.order || "asc",
                    col: newState.col,
                    row: newState.row,
                    grid: grid
                  });
                } else if (typeof this._sort === "string" && ( // v1.6.3 Backward compatibility
                this._sort !== "true" || hasTrueField(grid))) {
                  var field = this._sort;
                  grid.dataSource.sort(field, newState.order || "asc");
                } else {
                  var fieldRow = Math.min(grid.recordRowCount - 1, newState.row) + grid.frozenRowCount;

                  var _field3 = grid.getField(newState.col, fieldRow);

                  if (_field3 == null) {
                    return;
                  }

                  grid.dataSource.sort(_field3, newState.order || "asc");
                }
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(grid, cellId) {
                var _this93 = this;

                function isTarget(col, row) {
                  return grid.getLayoutCellId(col, row) === cellId;
                }

                var action = function action(cell) {
                  if (_this93.disabled) {
                    return;
                  }

                  var state = grid.sortState;
                  var newState;
                  var range = grid.getCellRange(cell.col, cell.row);

                  if (isTarget(state.col, cell.row)) {
                    newState = {
                      col: range.start.col,
                      row: range.start.row,
                      order: state.order === "asc" ? "desc" : "asc"
                    };
                  } else {
                    newState = {
                      col: range.start.col,
                      row: range.start.row,
                      order: "asc"
                    };
                  }

                  grid.sortState = newState;

                  _this93._executeSort(newState, grid);

                  grid.invalidateGridRect(0, 0, grid.colCount - 1, grid.rowCount - 1);
                };

                return _toConsumableArray((0, actionBind_1.bindCellClickAction)(grid, cellId, {
                  action: action,
                  mouseOver: function mouseOver(_e) {
                    if (_this93.disabled) {
                      return false;
                    }

                    return true;
                  }
                }));
              }
            }]);

            return SortHeaderAction;
          }(BaseAction_1.BaseAction);

          exports.SortHeaderAction = SortHeaderAction;

          function hasTrueField(grid) {
            if (grid.dataSource.length > 0) {
              var record = grid.dataSource.get(0);
              return record != null && "true" in record;
            }

            return false;
          }
          /***/

        },

        /***/
        "./header/action/actionBind.js":
        /*!*************************************!*\
          !*** ./header/action/actionBind.js ***!
          \*************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerActionActionBindJs(module, exports, __nested_webpack_require_786222__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.bindCellKeyAction = exports.bindCellClickAction = void 0;

          var DG_EVENT_TYPE_1 = __nested_webpack_require_786222__(
          /*! ../../core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var utils_1 = __nested_webpack_require_786222__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var KEY_ENTER = 13;
          var KEY_SPACE = 32;

          function bindCellClickAction(grid, cellId, _ref71) {
            var action = _ref71.action,
                mouseOver = _ref71.mouseOver,
                mouseOut = _ref71.mouseOut;

            function isTarget(col, row) {
              return grid.getLayoutCellId(col, row) === cellId;
            }

            var inMouse;
            return [// click
            grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.CLICK_CELL, function (e) {
              if (!isTarget(e.col, e.row)) {
                return;
              }

              action({
                col: e.col,
                row: e.row
              });
            }), // mouse move
            grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOVER_CELL, function (e) {
              if (!isTarget(e.col, e.row)) {
                return;
              }

              if (mouseOver) {
                if (!mouseOver({
                  col: e.col,
                  row: e.row
                })) {
                  return;
                }
              }

              grid.getElement().style.cursor = "pointer";
              inMouse = true;
            }), //横からMOUSEENTERした場合、'col-resize'の処理と競合するのでmoveを監視して処理する
            grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEMOVE_CELL, function (e) {
              if (!isTarget(e.col, e.row)) {
                return;
              }

              if (inMouse && !grid.getElement().style.cursor) {
                grid.getElement().style.cursor = "pointer";
              }
            }), grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.MOUSEOUT_CELL, function (e) {
              if (!isTarget(e.col, e.row)) {
                return;
              }

              if (mouseOut) {
                mouseOut({
                  col: e.col,
                  row: e.row
                });
              }

              grid.getElement().style.cursor = "";
              inMouse = false;
            })];
          }

          exports.bindCellClickAction = bindCellClickAction;

          function bindCellKeyAction(grid, cellId, _ref72) {
            var action = _ref72.action,
                _ref72$acceptKeys = _ref72.acceptKeys,
                acceptKeys = _ref72$acceptKeys === void 0 ? [] : _ref72$acceptKeys;

            function isTarget(col, row) {
              return grid.getLayoutCellId(col, row) === cellId;
            }

            acceptKeys = [].concat(_toConsumableArray(acceptKeys), [KEY_ENTER, KEY_SPACE]);
            return [// enter key down
            grid.listen(DG_EVENT_TYPE_1.DG_EVENT_TYPE.KEYDOWN, function (e) {
              var _a;

              if (acceptKeys.indexOf(e.keyCode) === -1) {
                return;
              }

              if (((_a = grid.keyboardOptions) === null || _a === void 0 ? void 0 : _a.moveCellOnEnter) && e.keyCode === KEY_ENTER) {
                // When moving with the enter key, no action is taken with the enter key.
                return;
              }

              var sel = grid.selection.select;

              if (!isTarget(sel.col, sel.row)) {
                return;
              }

              action({
                col: sel.col,
                row: sel.row
              });
              utils_1.event.cancel(e.event);
            })];
          }

          exports.bindCellKeyAction = bindCellKeyAction;
          /***/
        },

        /***/
        "./header/style.js":
        /*!*************************!*\
          !*** ./header/style.js ***!
          \*************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleJs(module, exports, __nested_webpack_require_790463__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.of = exports.MultilineTextHeaderStyle = exports.CheckHeaderStyle = exports.SortHeaderStyle = exports.Style = exports.BaseStyle = void 0;

          var BaseStyle_1 = __nested_webpack_require_790463__(
          /*! ./style/BaseStyle */
          "./header/style/BaseStyle.js");

          Object.defineProperty(exports, "BaseStyle", {
            enumerable: true,
            get: function get() {
              return BaseStyle_1.BaseStyle;
            }
          });

          var CheckHeaderStyle_1 = __nested_webpack_require_790463__(
          /*! ./style/CheckHeaderStyle */
          "./header/style/CheckHeaderStyle.js");

          Object.defineProperty(exports, "CheckHeaderStyle", {
            enumerable: true,
            get: function get() {
              return CheckHeaderStyle_1.CheckHeaderStyle;
            }
          });

          var MultilineTextHeaderStyle_1 = __nested_webpack_require_790463__(
          /*! ./style/MultilineTextHeaderStyle */
          "./header/style/MultilineTextHeaderStyle.js");

          Object.defineProperty(exports, "MultilineTextHeaderStyle", {
            enumerable: true,
            get: function get() {
              return MultilineTextHeaderStyle_1.MultilineTextHeaderStyle;
            }
          });

          var SortHeaderStyle_1 = __nested_webpack_require_790463__(
          /*! ./style/SortHeaderStyle */
          "./header/style/SortHeaderStyle.js");

          Object.defineProperty(exports, "SortHeaderStyle", {
            enumerable: true,
            get: function get() {
              return SortHeaderStyle_1.SortHeaderStyle;
            }
          });

          var Style_1 = __nested_webpack_require_790463__(
          /*! ./style/Style */
          "./header/style/Style.js");

          Object.defineProperty(exports, "Style", {
            enumerable: true,
            get: function get() {
              return Style_1.Style;
            }
          });

          function of(headerStyle, StyleClass) {
            if (headerStyle) {
              if (headerStyle instanceof Style_1.Style) {
                return headerStyle;
              } else if (typeof headerStyle === "function") {
                return of(headerStyle(), StyleClass);
              }

              return new StyleClass(headerStyle);
            } else {
              return StyleClass.DEFAULT;
            }
          }

          exports.of = of;
          /***/
        },

        /***/
        "./header/style/BaseStyle.js":
        /*!***********************************!*\
          !*** ./header/style/BaseStyle.js ***!
          \***********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleBaseStyleJs(module, exports, __nested_webpack_require_793398__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseStyle = void 0;

          var EventTarget_1 = __nested_webpack_require_793398__(
          /*! ../../core/EventTarget */
          "./core/EventTarget.js");

          var EVENT_TYPE = {
            CHANGE_STYLE: "change_style"
          };
          var defaultStyle;

          var BaseStyle = /*#__PURE__*/function (_EventTarget_1$EventT6) {
            _inherits(BaseStyle, _EventTarget_1$EventT6);

            var _super63 = _createSuper(BaseStyle);

            function BaseStyle() {
              var _this94;

              var _ref73 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
                  bgColor = _ref73.bgColor;

              _classCallCheck(this, BaseStyle);

              _this94 = _super63.call(this);
              _this94._bgColor = bgColor;
              return _this94;
            }

            _createClass(BaseStyle, [{
              key: "bgColor",
              get: function get() {
                return this._bgColor;
              },
              set: function set(bgColor) {
                this._bgColor = bgColor;
                this.doChangeStyle();
              }
            }, {
              key: "doChangeStyle",
              value: function doChangeStyle() {
                this.fireListeners(EVENT_TYPE.CHANGE_STYLE);
              }
            }, {
              key: "clone",
              value: function clone() {
                return new BaseStyle(this);
              }
            }], [{
              key: "EVENT_TYPE",
              get: function get() {
                return EVENT_TYPE;
              }
            }, {
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new BaseStyle();
              }
            }]);

            return BaseStyle;
          }(EventTarget_1.EventTarget);

          exports.BaseStyle = BaseStyle;
          /***/
        },

        /***/
        "./header/style/CheckHeaderStyle.js":
        /*!******************************************!*\
          !*** ./header/style/CheckHeaderStyle.js ***!
          \******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleCheckHeaderStyleJs(module, exports, __nested_webpack_require_795923__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.CheckHeaderStyle = void 0;

          var StdTextBaseStyle_1 = __nested_webpack_require_795923__(
          /*! ./StdTextBaseStyle */
          "./header/style/StdTextBaseStyle.js");

          var utils_1 = __nested_webpack_require_795923__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var defaultStyle;

          var CheckHeaderStyle = /*#__PURE__*/function (_StdTextBaseStyle_1$S) {
            _inherits(CheckHeaderStyle, _StdTextBaseStyle_1$S);

            var _super64 = _createSuper(CheckHeaderStyle);

            function CheckHeaderStyle() {
              var _this95;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, CheckHeaderStyle);

              _this95 = _super64.call(this, (0, utils_1.defaults)(style, {
                textAlign: "center"
              }));
              var uncheckBgColor = style.uncheckBgColor,
                  checkBgColor = style.checkBgColor,
                  borderColor = style.borderColor;
              _this95._uncheckBgColor = uncheckBgColor;
              _this95._checkBgColor = checkBgColor;
              _this95._borderColor = borderColor;
              return _this95;
            }

            _createClass(CheckHeaderStyle, [{
              key: "uncheckBgColor",
              get: function get() {
                return this._uncheckBgColor;
              },
              set: function set(uncheckBgColor) {
                this._uncheckBgColor = uncheckBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "checkBgColor",
              get: function get() {
                return this._checkBgColor;
              },
              set: function set(checkBgColor) {
                this._checkBgColor = checkBgColor;
                this.doChangeStyle();
              }
            }, {
              key: "borderColor",
              get: function get() {
                return this._borderColor;
              },
              set: function set(borderColor) {
                this._borderColor = borderColor;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new CheckHeaderStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new CheckHeaderStyle();
              }
            }]);

            return CheckHeaderStyle;
          }(StdTextBaseStyle_1.StdTextBaseStyle);

          exports.CheckHeaderStyle = CheckHeaderStyle;
          /***/
        },

        /***/
        "./header/style/MultilineTextHeaderStyle.js":
        /*!**************************************************!*\
          !*** ./header/style/MultilineTextHeaderStyle.js ***!
          \**************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleMultilineTextHeaderStyleJs(module, exports, __nested_webpack_require_799263__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MultilineTextHeaderStyle = void 0;

          var StdMultilineTextBaseStyle_1 = __nested_webpack_require_799263__(
          /*! ./StdMultilineTextBaseStyle */
          "./header/style/StdMultilineTextBaseStyle.js");

          var defaultStyle;

          var MultilineTextHeaderStyle = /*#__PURE__*/function (_StdMultilineTextBase) {
            _inherits(MultilineTextHeaderStyle, _StdMultilineTextBase);

            var _super65 = _createSuper(MultilineTextHeaderStyle);

            function MultilineTextHeaderStyle() {
              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, MultilineTextHeaderStyle);

              return _super65.call(this, style);
            }

            _createClass(MultilineTextHeaderStyle, [{
              key: "clone",
              value: function clone() {
                return new MultilineTextHeaderStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new MultilineTextHeaderStyle();
              }
            }]);

            return MultilineTextHeaderStyle;
          }(StdMultilineTextBaseStyle_1.StdMultilineTextBaseStyle);

          exports.MultilineTextHeaderStyle = MultilineTextHeaderStyle;
          /***/
        },

        /***/
        "./header/style/SortHeaderStyle.js":
        /*!*****************************************!*\
          !*** ./header/style/SortHeaderStyle.js ***!
          \*****************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleSortHeaderStyleJs(module, exports, __nested_webpack_require_801215__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.SortHeaderStyle = void 0;

          var StdMultilineTextBaseStyle_1 = __nested_webpack_require_801215__(
          /*! ./StdMultilineTextBaseStyle */
          "./header/style/StdMultilineTextBaseStyle.js");

          var defaultStyle;

          var SortHeaderStyle = /*#__PURE__*/function (_StdMultilineTextBase2) {
            _inherits(SortHeaderStyle, _StdMultilineTextBase2);

            var _super66 = _createSuper(SortHeaderStyle);

            function SortHeaderStyle() {
              var _this96;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, SortHeaderStyle);

              _this96 = _super66.call(this, style);
              _this96._sortArrowColor = style.sortArrowColor;
              _this96._multiline = style.multiline;
              return _this96;
            }

            _createClass(SortHeaderStyle, [{
              key: "sortArrowColor",
              get: function get() {
                return this._sortArrowColor;
              },
              set: function set(sortArrowColor) {
                this._sortArrowColor = sortArrowColor;
                this.doChangeStyle();
              }
            }, {
              key: "multiline",
              get: function get() {
                return !!this._multiline;
              },
              set: function set(multiline) {
                this._multiline = multiline;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new SortHeaderStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new SortHeaderStyle();
              }
            }]);

            return SortHeaderStyle;
          }(StdMultilineTextBaseStyle_1.StdMultilineTextBaseStyle);

          exports.SortHeaderStyle = SortHeaderStyle;
          /***/
        },

        /***/
        "./header/style/StdBaseStyle.js":
        /*!**************************************!*\
          !*** ./header/style/StdBaseStyle.js ***!
          \**************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleStdBaseStyleJs(module, exports, __nested_webpack_require_803820__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.StdBaseStyle = void 0;

          var BaseStyle_1 = __nested_webpack_require_803820__(
          /*! ./BaseStyle */
          "./header/style/BaseStyle.js");

          var defaultStyle;

          var StdBaseStyle = /*#__PURE__*/function (_BaseStyle_1$BaseStyl3) {
            _inherits(StdBaseStyle, _BaseStyle_1$BaseStyl3);

            var _super67 = _createSuper(StdBaseStyle);

            function StdBaseStyle() {
              var _this97;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, StdBaseStyle);

              _this97 = _super67.call(this, style);
              _this97._textAlign = style.textAlign || "left";
              _this97._textBaseline = style.textBaseline || "middle";
              return _this97;
            }

            _createClass(StdBaseStyle, [{
              key: "textAlign",
              get: function get() {
                return this._textAlign;
              },
              set: function set(textAlign) {
                this._textAlign = textAlign;
                this.doChangeStyle();
              }
            }, {
              key: "textBaseline",
              get: function get() {
                return this._textBaseline;
              },
              set: function set(textBaseline) {
                this._textBaseline = textBaseline;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new StdBaseStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new StdBaseStyle();
              }
            }]);

            return StdBaseStyle;
          }(BaseStyle_1.BaseStyle);

          exports.StdBaseStyle = StdBaseStyle;
          /***/
        },

        /***/
        "./header/style/StdMultilineTextBaseStyle.js":
        /*!***************************************************!*\
          !*** ./header/style/StdMultilineTextBaseStyle.js ***!
          \***************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleStdMultilineTextBaseStyleJs(module, exports, __nested_webpack_require_806380__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.StdMultilineTextBaseStyle = void 0;

          var StdTextBaseStyle_1 = __nested_webpack_require_806380__(
          /*! ./StdTextBaseStyle */
          "./header/style/StdTextBaseStyle.js");

          var defaultStyle;

          var StdMultilineTextBaseStyle = /*#__PURE__*/function (_StdTextBaseStyle_1$S2) {
            _inherits(StdMultilineTextBaseStyle, _StdTextBaseStyle_1$S2);

            var _super68 = _createSuper(StdMultilineTextBaseStyle);

            function StdMultilineTextBaseStyle() {
              var _this98;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, StdMultilineTextBaseStyle);

              _this98 = _super68.call(this, style);
              _this98._lineHeight = style.lineHeight || "1em";
              _this98._autoWrapText = style.autoWrapText || false;
              _this98._lineClamp = style.lineClamp;
              return _this98;
            }

            _createClass(StdMultilineTextBaseStyle, [{
              key: "clone",
              value: function clone() {
                return new StdMultilineTextBaseStyle(this);
              }
            }, {
              key: "lineHeight",
              get: function get() {
                return this._lineHeight;
              },
              set: function set(lineHeight) {
                this._lineHeight = lineHeight;
                this.doChangeStyle();
              }
            }, {
              key: "lineClamp",
              get: function get() {
                return this._lineClamp;
              },
              set: function set(lineClamp) {
                this._lineClamp = lineClamp;
                this.doChangeStyle();
              }
            }, {
              key: "autoWrapText",
              get: function get() {
                return this._autoWrapText;
              },
              set: function set(autoWrapText) {
                this._autoWrapText = autoWrapText;
                this.doChangeStyle();
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new StdMultilineTextBaseStyle();
              }
            }]);

            return StdMultilineTextBaseStyle;
          }(StdTextBaseStyle_1.StdTextBaseStyle);

          exports.StdMultilineTextBaseStyle = StdMultilineTextBaseStyle;
          /***/
        },

        /***/
        "./header/style/StdTextBaseStyle.js":
        /*!******************************************!*\
          !*** ./header/style/StdTextBaseStyle.js ***!
          \******************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleStdTextBaseStyleJs(module, exports, __nested_webpack_require_809427__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.StdTextBaseStyle = void 0;

          var StdBaseStyle_1 = __nested_webpack_require_809427__(
          /*! ./StdBaseStyle */
          "./header/style/StdBaseStyle.js");

          var defaultStyle;

          var StdTextBaseStyle = /*#__PURE__*/function (_StdBaseStyle_1$StdBa5) {
            _inherits(StdTextBaseStyle, _StdBaseStyle_1$StdBa5);

            var _super69 = _createSuper(StdTextBaseStyle);

            function StdTextBaseStyle() {
              var _this99;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, StdTextBaseStyle);

              _this99 = _super69.call(this, style);
              _this99._color = style.color;
              _this99._font = style.font;
              _this99._padding = style.padding;
              _this99._textOverflow = style.textOverflow || "ellipsis";
              return _this99;
            }

            _createClass(StdTextBaseStyle, [{
              key: "color",
              get: function get() {
                return this._color;
              },
              set: function set(color) {
                this._color = color;
                this.doChangeStyle();
              }
            }, {
              key: "font",
              get: function get() {
                return this._font;
              },
              set: function set(font) {
                this._font = font;
                this.doChangeStyle();
              }
            }, {
              key: "padding",
              get: function get() {
                return this._padding;
              },
              set: function set(padding) {
                this._padding = padding;
                this.doChangeStyle();
              }
            }, {
              key: "textOverflow",
              get: function get() {
                return this._textOverflow;
              },
              set: function set(textOverflow) {
                this._textOverflow = textOverflow;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new StdTextBaseStyle(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new StdTextBaseStyle();
              }
            }]);

            return StdTextBaseStyle;
          }(StdBaseStyle_1.StdBaseStyle);

          exports.StdTextBaseStyle = StdTextBaseStyle;
          /***/
        },

        /***/
        "./header/style/Style.js":
        /*!*******************************!*\
          !*** ./header/style/Style.js ***!
          \*******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerStyleStyleJs(module, exports, __nested_webpack_require_812541__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Style = void 0;

          var StdMultilineTextBaseStyle_1 = __nested_webpack_require_812541__(
          /*! ./StdMultilineTextBaseStyle */
          "./header/style/StdMultilineTextBaseStyle.js");

          var defaultStyle;

          var Style = /*#__PURE__*/function (_StdMultilineTextBase3) {
            _inherits(Style, _StdMultilineTextBase3);

            var _super70 = _createSuper(Style);

            function Style() {
              var _this100;

              var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, Style);

              _this100 = _super70.call(this, style);
              _this100._multiline = style.multiline;
              return _this100;
            }

            _createClass(Style, [{
              key: "multiline",
              get: function get() {
                return !!this._multiline;
              },
              set: function set(multiline) {
                this._multiline = multiline;
                this.doChangeStyle();
              }
            }, {
              key: "clone",
              value: function clone() {
                return new Style(this);
              }
            }], [{
              key: "DEFAULT",
              get: function get() {
                return defaultStyle ? defaultStyle : defaultStyle = new Style();
              }
            }]);

            return Style;
          }(StdMultilineTextBaseStyle_1.StdMultilineTextBaseStyle);

          exports.Style = Style;
          /***/
        },

        /***/
        "./header/type.js":
        /*!************************!*\
          !*** ./header/type.js ***!
          \************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerTypeJs(module, exports, __nested_webpack_require_814588__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.ofCell = exports.of = exports.MultilineTextHeader = exports.CheckHeader = exports.SortHeader = exports.Header = exports.BaseHeader = void 0;

          var BaseHeader_1 = __nested_webpack_require_814588__(
          /*! ./type/BaseHeader */
          "./header/type/BaseHeader.js");

          Object.defineProperty(exports, "BaseHeader", {
            enumerable: true,
            get: function get() {
              return BaseHeader_1.BaseHeader;
            }
          });

          var CheckHeader_1 = __nested_webpack_require_814588__(
          /*! ./type/CheckHeader */
          "./header/type/CheckHeader.js");

          Object.defineProperty(exports, "CheckHeader", {
            enumerable: true,
            get: function get() {
              return CheckHeader_1.CheckHeader;
            }
          });

          var Header_1 = __nested_webpack_require_814588__(
          /*! ./type/Header */
          "./header/type/Header.js");

          Object.defineProperty(exports, "Header", {
            enumerable: true,
            get: function get() {
              return Header_1.Header;
            }
          });

          var MultilineTextHeader_1 = __nested_webpack_require_814588__(
          /*! ./type/MultilineTextHeader */
          "./header/type/MultilineTextHeader.js");

          Object.defineProperty(exports, "MultilineTextHeader", {
            enumerable: true,
            get: function get() {
              return MultilineTextHeader_1.MultilineTextHeader;
            }
          });

          var SortHeader_1 = __nested_webpack_require_814588__(
          /*! ./type/SortHeader */
          "./header/type/SortHeader.js");

          Object.defineProperty(exports, "SortHeader", {
            enumerable: true,
            get: function get() {
              return SortHeader_1.SortHeader;
            }
          });
          var TYPES = {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            DEFAULT: new Header_1.Header(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            SORT: new SortHeader_1.SortHeader(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            CHECK: new CheckHeader_1.CheckHeader(),
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            MULTILINETEXT: new MultilineTextHeader_1.MultilineTextHeader()
          };

          function of(headerType) {
            if (!headerType) {
              return TYPES.DEFAULT;
            } else if (typeof headerType === "string") {
              var key = headerType.toUpperCase();
              return TYPES[key] || of(null);
            } else {
              return headerType;
            }
          }

          exports.of = of;

          function ofCell(headerCell) {
            if (headerCell.sort) {
              return TYPES.SORT;
            }

            return of(headerCell.headerType);
          }

          exports.ofCell = ofCell;
          /***/
        },

        /***/
        "./header/type/BaseHeader.js":
        /*!***********************************!*\
          !*** ./header/type/BaseHeader.js ***!
          \***********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerTypeBaseHeaderJs(module, exports, __nested_webpack_require_818104__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseHeader = void 0;

          var styleContents = __importStar(__nested_webpack_require_818104__(
          /*! ../style */
          "./header/style.js"));

          var BaseStyle_1 = __nested_webpack_require_818104__(
          /*! ../style/BaseStyle */
          "./header/style/BaseStyle.js");

          var BaseHeader = /*#__PURE__*/function () {
            function BaseHeader() {
              var _options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

              _classCallCheck(this, BaseHeader);

              this.onDrawCell = this.onDrawCell.bind(this); //スコープを固定させる
            }

            _createClass(BaseHeader, [{
              key: "StyleClass",
              get: function get() {
                return BaseStyle_1.BaseStyle;
              }
            }, {
              key: "onDrawCell",
              value: function onDrawCell(cellValue, info, context, grid) {
                var style = info.style,
                    drawCellBase = info.drawCellBase;
                var helper = grid.getGridCanvasHelper();
                drawCellBase(); //文字描画

                this.drawInternal(this.convertInternal(cellValue), context, styleContents.of(style, this.StyleClass), helper, grid, info);
              }
            }, {
              key: "convertInternal",
              value: function convertInternal(value) {
                if (typeof value === "function") {
                  value = value();
                } // eslint-disable-next-line @typescript-eslint/restrict-template-expressions


                return value != null ? "".concat(value) : "";
              }
            }, {
              key: "bindGridEvent",
              value: function bindGridEvent(_grid, _cellId) {
                return [];
              }
            }, {
              key: "getCopyCellValue",
              value: function getCopyCellValue(value, _grid, _cell) {
                if (typeof value === "function") {
                  value = value();
                }

                return value != null ? value : "";
              }
            }]);

            return BaseHeader;
          }();

          exports.BaseHeader = BaseHeader;
          /***/
        },

        /***/
        "./header/type/CheckHeader.js":
        /*!************************************!*\
          !*** ./header/type/CheckHeader.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerTypeCheckHeaderJs(module, exports, __nested_webpack_require_822250__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.CheckHeader = void 0;

          var inlineUtils = __importStar(__nested_webpack_require_822250__(
          /*! ../../element/inlines */
          "./element/inlines.js"));

          var utils = __importStar(__nested_webpack_require_822250__(
          /*! ../../columns/type/columnUtils */
          "./columns/type/columnUtils.js"));

          var BaseHeader_1 = __nested_webpack_require_822250__(
          /*! ./BaseHeader */
          "./header/type/BaseHeader.js");

          var CheckHeaderStyle_1 = __nested_webpack_require_822250__(
          /*! ../style/CheckHeaderStyle */
          "./header/style/CheckHeaderStyle.js");

          var symbolManager_1 = __nested_webpack_require_822250__(
          /*! ../../internal/symbolManager */
          "./internal/symbolManager.js");

          var utils_1 = __nested_webpack_require_822250__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var CHECK_HEADER_STATE_ID = (0, symbolManager_1.getCheckHeaderStateId)(); // eslint-disable-next-line @typescript-eslint/no-explicit-any

          function getState(grid) {
            var state = grid[CHECK_HEADER_STATE_ID];

            if (!state) {
              state = {
                elapsed: {},
                block: {}
              };
              utils_1.obj.setReadonly(grid, CHECK_HEADER_STATE_ID, state);
            }

            return state;
          }

          var CheckHeader = /*#__PURE__*/function (_BaseHeader_1$BaseHea) {
            _inherits(CheckHeader, _BaseHeader_1$BaseHea);

            var _super71 = _createSuper(CheckHeader);

            function CheckHeader() {
              _classCallCheck(this, CheckHeader);

              return _super71.apply(this, arguments);
            }

            _createClass(CheckHeader, [{
              key: "StyleClass",
              get: function get() {
                return CheckHeaderStyle_1.CheckHeaderStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new CheckHeader(this);
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, // eslint-disable-next-line @typescript-eslint/no-explicit-any
              grid, _ref74) {
                var drawCellBase = _ref74.drawCellBase,
                    getIcon = _ref74.getIcon;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    borderColor = style.borderColor,
                    checkBgColor = style.checkBgColor,
                    uncheckBgColor = style.uncheckBgColor,
                    bgColor = style.bgColor,
                    padding = style.padding,
                    color = style.color,
                    font = style.font,
                    textOverflow = style.textOverflow;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                var col = context.col,
                    row = context.row;
                var range = grid.getCellRange(col, row);
                var cellKey = "".concat(range.start.col, ":").concat(range.start.row);

                var _getState = getState(grid),
                    elapsed = _getState.elapsed[cellKey];

                var checked = grid.getHeaderValue(range.start.col, range.start.row);
                var opt = {
                  textAlign: textAlign,
                  textBaseline: textBaseline,
                  borderColor: borderColor,
                  checkBgColor: checkBgColor,
                  uncheckBgColor: uncheckBgColor
                };

                if (elapsed != null) {
                  opt.animElapsedTime = elapsed;
                }

                var inlineCheck = helper.buildCheckBoxInline(!!checked, context, opt);
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  var contents = [inlineCheck];
                  contents = contents.concat(inlineUtils.buildInlines(icons, value != null ? String(value) : ""));
                  helper.text(contents, context, {
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    color: color,
                    font: font,
                    padding: padding,
                    textOverflow: textOverflow
                  });
                });
              }
            }]);

            return CheckHeader;
          }(BaseHeader_1.BaseHeader);

          exports.CheckHeader = CheckHeader;
          /***/
        },

        /***/
        "./header/type/Header.js":
        /*!*******************************!*\
          !*** ./header/type/Header.js ***!
          \*******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerTypeHeaderJs(module, exports, __nested_webpack_require_828780__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Header = void 0;

          var utils = __importStar(__nested_webpack_require_828780__(
          /*! ../../columns/type/columnUtils */
          "./columns/type/columnUtils.js"));

          var BaseHeader_1 = __nested_webpack_require_828780__(
          /*! ./BaseHeader */
          "./header/type/BaseHeader.js");

          var Style_1 = __nested_webpack_require_828780__(
          /*! ../style/Style */
          "./header/style/Style.js");

          var Header = /*#__PURE__*/function (_BaseHeader_1$BaseHea2) {
            _inherits(Header, _BaseHeader_1$BaseHea2);

            var _super72 = _createSuper(Header);

            function Header() {
              _classCallCheck(this, Header);

              return _super72.apply(this, arguments);
            }

            _createClass(Header, [{
              key: "StyleClass",
              get: function get() {
                return Style_1.Style;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, _grid, _ref75) {
                var drawCellBase = _ref75.drawCellBase,
                    getIcon = _ref75.getIcon;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    color = style.color,
                    font = style.font,
                    bgColor = style.bgColor,
                    padding = style.padding,
                    textOverflow = style.textOverflow,
                    lineHeight = style.lineHeight,
                    autoWrapText = style.autoWrapText,
                    lineClamp = style.lineClamp,
                    multiline = style.multiline;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                var textValue = value != null ? String(value) : "";
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  if (multiline) {
                    var multilines = textValue.replace(/\r?\n/g, "\n").replace(/\r/g, "\n").split("\n");
                    helper.multilineText(multilines, context, {
                      textAlign: textAlign,
                      textBaseline: textBaseline,
                      color: color,
                      font: font,
                      padding: padding,
                      lineHeight: lineHeight,
                      autoWrapText: autoWrapText,
                      lineClamp: lineClamp,
                      textOverflow: textOverflow,
                      icons: icons
                    });
                  } else {
                    helper.text(textValue, context, {
                      textAlign: textAlign,
                      textBaseline: textBaseline,
                      color: color,
                      font: font,
                      padding: padding,
                      textOverflow: textOverflow,
                      icons: icons
                    });
                  }
                });
              }
            }]);

            return Header;
          }(BaseHeader_1.BaseHeader);

          exports.Header = Header;
          /***/
        },

        /***/
        "./header/type/MultilineTextHeader.js":
        /*!********************************************!*\
          !*** ./header/type/MultilineTextHeader.js ***!
          \********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerTypeMultilineTextHeaderJs(module, exports, __nested_webpack_require_833979__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MultilineTextHeader = void 0;

          var utils = __importStar(__nested_webpack_require_833979__(
          /*! ../../columns/type/columnUtils */
          "./columns/type/columnUtils.js"));

          var BaseHeader_1 = __nested_webpack_require_833979__(
          /*! ./BaseHeader */
          "./header/type/BaseHeader.js");

          var MultilineTextHeaderStyle_1 = __nested_webpack_require_833979__(
          /*! ../style/MultilineTextHeaderStyle */
          "./header/style/MultilineTextHeaderStyle.js");

          var MultilineTextHeader = /*#__PURE__*/function (_BaseHeader_1$BaseHea3) {
            _inherits(MultilineTextHeader, _BaseHeader_1$BaseHea3);

            var _super73 = _createSuper(MultilineTextHeader);

            function MultilineTextHeader() {
              _classCallCheck(this, MultilineTextHeader);

              return _super73.apply(this, arguments);
            }

            _createClass(MultilineTextHeader, [{
              key: "StyleClass",
              get: function get() {
                return MultilineTextHeaderStyle_1.MultilineTextHeaderStyle;
              }
            }, {
              key: "clone",
              value: function clone() {
                return new MultilineTextHeader(this);
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, _grid, _ref76) {
                var drawCellBase = _ref76.drawCellBase,
                    getIcon = _ref76.getIcon;
                var textAlign = style.textAlign,
                    textBaseline = style.textBaseline,
                    color = style.color,
                    font = style.font,
                    bgColor = style.bgColor,
                    padding = style.padding,
                    lineHeight = style.lineHeight,
                    autoWrapText = style.autoWrapText,
                    lineClamp = style.lineClamp,
                    textOverflow = style.textOverflow;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                var textValue = value != null ? String(value) : "";
                var multilines = textValue.replace(/\r?\n/g, "\n").replace(/\r/g, "\n").split("\n");
                helper.testFontLoad(font, textValue, context);
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  helper.multilineText(multilines, context, {
                    textAlign: textAlign,
                    textBaseline: textBaseline,
                    color: color,
                    font: font,
                    padding: padding,
                    lineHeight: lineHeight,
                    autoWrapText: autoWrapText,
                    lineClamp: lineClamp,
                    textOverflow: textOverflow,
                    icons: icons
                  });
                });
              }
            }]);

            return MultilineTextHeader;
          }(BaseHeader_1.BaseHeader);

          exports.MultilineTextHeader = MultilineTextHeader;
          /***/
        },

        /***/
        "./header/type/SortHeader.js":
        /*!***********************************!*\
          !*** ./header/type/SortHeader.js ***!
          \***********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headerTypeSortHeaderJs(module, exports, __nested_webpack_require_839050__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.SortHeader = void 0;

          var utils = __importStar(__nested_webpack_require_839050__(
          /*! ../../columns/type/columnUtils */
          "./columns/type/columnUtils.js"));

          var BaseHeader_1 = __nested_webpack_require_839050__(
          /*! ./BaseHeader */
          "./header/type/BaseHeader.js");

          var SortHeaderStyle_1 = __nested_webpack_require_839050__(
          /*! ../style/SortHeaderStyle */
          "./header/style/SortHeaderStyle.js");

          var utils_1 = __nested_webpack_require_839050__(
          /*! ../../internal/utils */
          "./internal/utils.js");

          var canvases_1 = __nested_webpack_require_839050__(
          /*! ../../internal/canvases */
          "./internal/canvases.js");

          var SortHeader = /*#__PURE__*/function (_BaseHeader_1$BaseHea4) {
            _inherits(SortHeader, _BaseHeader_1$BaseHea4);

            var _super74 = _createSuper(SortHeader);

            function SortHeader() {
              _classCallCheck(this, SortHeader);

              return _super74.apply(this, arguments);
            }

            _createClass(SortHeader, [{
              key: "StyleClass",
              get: function get() {
                return SortHeaderStyle_1.SortHeaderStyle;
              }
            }, {
              key: "drawInternal",
              value: function drawInternal(value, context, style, helper, grid, _ref77) {
                var drawCellBase = _ref77.drawCellBase,
                    getIcon = _ref77.getIcon;
                var textAlign = style.textAlign,
                    _style$textBaseline = style.textBaseline,
                    textBaseline = _style$textBaseline === void 0 ? "middle" : _style$textBaseline,
                    color = style.color,
                    bgColor = style.bgColor,
                    font = style.font,
                    padding = style.padding,
                    textOverflow = style.textOverflow,
                    lineHeight = style.lineHeight,
                    autoWrapText = style.autoWrapText,
                    lineClamp = style.lineClamp,
                    sortArrowColor = style.sortArrowColor,
                    multiline = style.multiline;

                if (bgColor) {
                  drawCellBase({
                    bgColor: bgColor
                  });
                }

                var textValue = value != null ? String(value) : "";
                helper.testFontLoad(font, textValue, context);
                utils.loadIcons(getIcon(), context, helper, function (icons, context) {
                  var state = grid.sortState;
                  var order = undefined;
                  var col = context.col,
                      row = context.row;
                  var range = grid.getCellRange(col, row);

                  if ((0, utils_1.cellInRange)(range, state.col, state.row)) {
                    order = state.order;
                  }

                  var ctx = context.getContext();
                  var arrowSize = (0, canvases_1.getFontSize)(ctx, font).width * 1.2;
                  var trailingIcon = {
                    name: order != null ? order === "asc" ? "arrow_downward" : "arrow_upward" : undefined,
                    width: arrowSize,
                    color: helper.getColor(sortArrowColor || helper.theme.header.sortArrowColor, col, row, ctx) || "rgba(0, 0, 0, 0.38)"
                  };

                  if (multiline) {
                    var lines = textValue.replace(/\r?\n/g, "\n").replace(/\r/g, "\n").split("\n");
                    helper.multilineText(lines, context, {
                      textAlign: textAlign,
                      textBaseline: textBaseline,
                      color: color,
                      font: font,
                      padding: padding,
                      lineHeight: lineHeight,
                      autoWrapText: autoWrapText,
                      lineClamp: lineClamp,
                      textOverflow: textOverflow,
                      icons: icons,
                      trailingIcon: trailingIcon
                    });
                  } else {
                    helper.text(textValue, context, {
                      textAlign: textAlign,
                      textBaseline: textBaseline,
                      color: color,
                      font: font,
                      padding: padding,
                      textOverflow: textOverflow,
                      icons: icons,
                      trailingIcon: trailingIcon
                    });
                  }
                });
              }
            }]);

            return SortHeader;
          }(BaseHeader_1.BaseHeader);

          exports.SortHeader = SortHeader;
          /***/
        },

        /***/
        "./headers.js":
        /*!********************!*\
          !*** ./headers.js ***!
          \********************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function headersJs(module, exports, __nested_webpack_require_845633__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.style = exports.type = exports.action = void 0;

          var action = __importStar(__nested_webpack_require_845633__(
          /*! ./header/action */
          "./header/action.js"));

          exports.action = action;

          var style = __importStar(__nested_webpack_require_845633__(
          /*! ./header/style */
          "./header/style.js"));

          exports.style = style;

          var type = __importStar(__nested_webpack_require_845633__(
          /*! ./header/type */
          "./header/type.js"));

          exports.type = type;
          /***/
        },

        /***/
        "./icons.js":
        /*!******************!*\
          !*** ./icons.js ***!
          \******************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function iconsJs(module, exports, __nested_webpack_require_848026__) {
          "use strict";
          /*eslint-disable camelcase*/

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.get = void 0;

          var utils_1 = __nested_webpack_require_848026__(
          /*! ./internal/utils */
          "./internal/utils.js");

          var icons_1 = __nested_webpack_require_848026__(
          /*! ./plugins/icons */
          "./plugins/icons.js");

          var builtins = {
            get arrow_upward() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_arrow_upward_48px.svg");
              return {
                d: "M8 24l2.83 2.83L22 15.66V40h4V15.66l11.17 11.17L40 24 24 8 8 24z",
                width: 48,
                height: 48
              };
            },

            get arrow_downward() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_arrow_downward_48px.svg");
              return {
                d: "M40 24l-2.82-2.82L26 32.34V8h-4v24.34L10.84 21.16 8 24l16 16 16-16z",
                width: 48,
                height: 48
              };
            },

            get edit() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/image/svg/production/ic_edit_48px.svg");
              return {
                d: "M6 34.5V42h7.5l22.13-22.13-7.5-7.5L6 34.5zm35.41-20.41c.78-.78.78-2.05 0-2.83l-4.67-4.67c-.78-.78-2.05-.78-2.83 0l-3.66 3.66 7.5 7.5 3.66-3.66z",
                width: 48,
                height: 48
              };
            },

            get add() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/content/svg/production/ic_add_48px.svg");
              return {
                d: "M38 26H26v12h-4V26H10v-4h12V10h4v12h12v4z",
                width: 48,
                height: 48
              };
            },

            get star() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/toggle/svg/production/ic_star_24px.svg");
              return {
                d: "M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z",
                width: 24,
                height: 24
              };
            },

            get star_border() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/toggle/svg/production/ic_star_border_24px.svg");
              return {
                d: "M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z",
                width: 24,
                height: 24
              };
            },

            get star_half() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/toggle/svg/production/ic_star_half_24px.svg");
              return {
                d: "M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z",
                width: 24,
                height: 24
              };
            },

            get keyboard_arrow_down() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/hardware/svg/production/ic_keyboard_arrow_down_48px.svg");
              return {
                d: "M14.83 16.42L24 25.59l9.17-9.17L36 19.25l-12 12-12-12z",
                width: 48,
                height: 48
              };
            },

            get keyboard_arrow_left() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/hardware/svg/production/ic_keyboard_arrow_left_48px.svg");
              return {
                d: "M30.83 32.67l-9.17-9.17 9.17-9.17L28 11.5l-12 12 12 12z",
                width: 48,
                height: 48
              };
            },

            get keyboard_arrow_right() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/hardware/svg/production/ic_keyboard_arrow_right_48px.svg");
              return {
                d: "M17.17 32.92l9.17-9.17-9.17-9.17L20 11.75l12 12-12 12z",
                width: 48,
                height: 48
              };
            },

            get keyboard_arrow_up() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/hardware/svg/production/ic_keyboard_arrow_up_48px.svg");
              return {
                d: "M14.83 30.83L24 21.66l9.17 9.17L36 28 24 16 12 28z",
                width: 48,
                height: 48
              };
            },

            get chevron_left() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_chevron_left_48px.svg");
              return {
                d: "M14.83 30.83L24 21.66l9.17 9.17L36 28 24 16 12 28z",
                width: 48,
                height: 48
              };
            },

            get chevron_right() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_chevron_right_48px.svg");
              return {
                d: "M20 12l-2.83 2.83L26.34 24l-9.17 9.17L20 36l12-12z",
                width: 48,
                height: 48
              };
            },

            get expand_less() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_expand_less_48px.svg");
              return {
                d: "M24 16L12 28l2.83 2.83L24 21.66l9.17 9.17L36 28z",
                width: 48,
                height: 48
              };
            },

            get expand_more() {
              // return require("cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_expand_more_48px.svg");
              return {
                d: "M33.17 17.17L24 26.34l-9.17-9.17L12 20l12 12 12-12z",
                width: 48,
                height: 48
              };
            }

          };

          function get() {
            return (0, utils_1.extend)(builtins, icons_1.icons);
          }

          exports.get = get;
          /***/
        },

        /***/
        "./internal/EventHandler.js":
        /*!**********************************!*\
          !*** ./internal/EventHandler.js ***!
          \**********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalEventHandlerJs(module, exports, __nested_webpack_require_854745__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.EventHandler = void 0;

          var utils_1 = __nested_webpack_require_854745__(
          /*! ./utils */
          "./internal/utils.js");
          /** @private */


          var nextId = 1;

          var EventHandler = /*#__PURE__*/function () {
            function EventHandler() {
              _classCallCheck(this, EventHandler);

              this._listeners = {};
            }

            _createClass(EventHandler, [{
              key: "on",
              value: function on(target, type, listener) {
                for (var _len7 = arguments.length, options = new Array(_len7 > 3 ? _len7 - 3 : 0), _key7 = 3; _key7 < _len7; _key7++) {
                  options[_key7 - 3] = arguments[_key7];
                }

                if (target.addEventListener) {
                  target.addEventListener.apply(target, [type, listener].concat(options));
                }

                var obj = {
                  target: target,
                  type: type,
                  listener: listener,
                  options: options
                };
                var id = nextId++;
                this._listeners[id] = obj;
                return id;
              }
            }, {
              key: "once",
              value: function once(target, type, listener) {
                var _this101 = this;

                for (var _len8 = arguments.length, options = new Array(_len8 > 3 ? _len8 - 3 : 0), _key8 = 3; _key8 < _len8; _key8++) {
                  options[_key8 - 3] = arguments[_key8];
                }

                var id = this.on.apply(this, [target, type, function () {
                  _this101.off(id);

                  listener.apply(void 0, arguments);
                }].concat(options));
                return id;
              }
            }, {
              key: "tryWithOffEvents",
              value: function tryWithOffEvents(target, type, call) {
                var list = [];

                try {
                  (0, utils_1.each)(this._listeners, function (obj) {
                    if (obj.target === target && obj.type === type) {
                      if (obj.target.removeEventListener) {
                        var _obj$target;

                        (_obj$target = obj.target).removeEventListener.apply(_obj$target, [obj.type, obj.listener].concat(_toConsumableArray(obj.options)));
                      }

                      list.push(obj);
                    }
                  });
                  call();
                } finally {
                  list.forEach(function (obj) {
                    if (obj.target.addEventListener) {
                      var _obj$target2;

                      (_obj$target2 = obj.target).addEventListener.apply(_obj$target2, [obj.type, obj.listener].concat(_toConsumableArray(obj.options)));
                    }
                  });
                }
              }
            }, {
              key: "off",
              value: function off(id) {
                if (id == null) {
                  return;
                }

                var obj = this._listeners[id];

                if (!obj) {
                  return;
                }

                delete this._listeners[id];

                if (obj.target.removeEventListener) {
                  var _obj$target3;

                  (_obj$target3 = obj.target).removeEventListener.apply(_obj$target3, [obj.type, obj.listener].concat(_toConsumableArray(obj.options)));
                }
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "fire",
              value: function fire(target, type) {
                for (var _len9 = arguments.length, args = new Array(_len9 > 2 ? _len9 - 2 : 0), _key9 = 2; _key9 < _len9; _key9++) {
                  args[_key9 - 2] = arguments[_key9];
                }

                (0, utils_1.each)(this._listeners, function (obj) {
                  if (obj.target === target && obj.type === type) {
                    var _obj$listener;

                    (_obj$listener = obj.listener).call.apply(_obj$listener, [obj.target].concat(args));
                  }
                });
              }
            }, {
              key: "hasListener",
              value: function hasListener(target, type) {
                var result = false;
                (0, utils_1.each)(this._listeners, function (obj) {
                  if (obj.target === target && obj.type === type) {
                    result = true;
                  }
                });
                return result;
              }
            }, {
              key: "clear",
              value: function clear() {
                (0, utils_1.each)(this._listeners, function (obj) {
                  if (obj.target.removeEventListener) {
                    var _obj$target4;

                    (_obj$target4 = obj.target).removeEventListener.apply(_obj$target4, [obj.type, obj.listener].concat(_toConsumableArray(obj.options)));
                  }
                });
                this._listeners = {};
              }
            }, {
              key: "dispose",
              value: function dispose() {
                this.clear(); // eslint-disable-next-line @typescript-eslint/no-explicit-any

                this._listeners = null;
              }
            }]);

            return EventHandler;
          }();

          exports.EventHandler = EventHandler;
          /***/
        },

        /***/
        "./internal/LRUCache.js":
        /*!******************************!*\
          !*** ./internal/LRUCache.js ***!
          \******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalLRUCacheJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.LRUCache = void 0;

          var LRUCache = /*#__PURE__*/function () {
            function LRUCache(cacheSize) {
              _classCallCheck(this, LRUCache);

              this._list = [];
              this._map = {};
              this._cacheSize = cacheSize || 50;
            }

            _createClass(LRUCache, [{
              key: "get",
              value: function get(key) {
                var val = this._map[key];

                if (val) {
                  var list = this._list;
                  var idx = list.indexOf(key);
                  list.splice(idx, 1);
                  list.push(key);
                }

                return val;
              }
            }, {
              key: "put",
              value: function put(key, value) {
                var list = this._list;
                var map = this._map;

                if (map[key]) {
                  var idx = list.indexOf(key);
                  list.splice(idx, 1);
                }

                map[key] = value;
                list.push(key);

                if (list.length > this._cacheSize) {
                  var remKey = list.shift() || "";
                  delete map[remKey];
                }
              }
            }]);

            return LRUCache;
          }();

          exports.LRUCache = LRUCache;
          /***/
        },

        /***/
        "./internal/NumberMap.js":
        /*!*******************************!*\
          !*** ./internal/NumberMap.js ***!
          \*******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalNumberMapJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.NumberMap = void 0;

          var indexFirst = function indexFirst(arr, elm) {
            var low = 0;
            var high = arr.length - 1;

            while (low <= high) {
              var i = Math.floor((low + high) / 2);

              if (arr[i] === elm) {
                return i;
              } else if (arr[i] > elm) {
                high = i - 1;
              } else {
                low = i + 1;
              }
            }

            return high < 0 ? 0 : high;
          };

          var NumberMap = /*#__PURE__*/function () {
            function NumberMap() {
              _classCallCheck(this, NumberMap);

              this._keys = [];
              this._vals = {};
              this._sorted = false;
            }

            _createClass(NumberMap, [{
              key: "put",
              value: function put(key, value) {
                if (!(key in this._vals)) {
                  this._keys.push(key);

                  this._sorted = false;
                }

                this._vals[key] = value;
              }
            }, {
              key: "remove",
              value: function remove(key) {
                delete this._vals[key];

                var index = this._keys.indexOf(key);

                if (index < 0) {
                  return;
                }

                this._keys.splice(index, 1);

                this._sorted = false;
              }
            }, {
              key: "get",
              value: function get(key) {
                return this._vals[key];
              }
            }, {
              key: "has",
              value: function has(key) {
                return this._vals[key] != null;
              }
            }, {
              key: "each",
              value: function each(keyFrom, keyTo, fn) {
                var keys = this._keys;
                var length = keys.length;

                if (!this._sorted) {
                  keys.sort(function (a, b) {
                    if (a < b) {
                      return -1;
                    }

                    if (a > b) {
                      return 1;
                    }

                    return 0;
                  });
                  this._sorted = true;
                }

                for (var i = indexFirst(keys, keyFrom); i < length; i++) {
                  var key = keys[i];

                  if (keyFrom <= key && key <= keyTo) {
                    fn(this.get(key), key);
                  } else if (keyTo < key) {
                    return;
                  }
                }
              }
            }]);

            return NumberMap;
          }();

          exports.NumberMap = NumberMap;
          /***/
        },

        /***/
        "./internal/Rect.js":
        /*!**************************!*\
          !*** ./internal/Rect.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalRectJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Rect = void 0;

          var Rect = /*#__PURE__*/function () {
            function Rect(left, top, width, height) {
              _classCallCheck(this, Rect);

              this._left = left;
              this._top = top;
              this._width = width;
              this._height = height;
            }

            _createClass(Rect, [{
              key: "left",
              get: function get() {
                return this._left;
              },
              set: function set(left) {
                var right = this.right;
                this._left = left;
                this.right = right;
              }
            }, {
              key: "top",
              get: function get() {
                return this._top;
              },
              set: function set(top) {
                var bottom = this.bottom;
                this._top = top;
                this.bottom = bottom;
              }
            }, {
              key: "width",
              get: function get() {
                return this._width;
              },
              set: function set(width) {
                this._width = width;
                this._right = undefined;
              }
            }, {
              key: "height",
              get: function get() {
                return this._height;
              },
              set: function set(height) {
                this._height = height;
                this._bottom = undefined;
              }
            }, {
              key: "right",
              get: function get() {
                return this._right !== undefined ? this._right : this._right = this.left + this.width;
              },
              set: function set(right) {
                this._right = right;
                this.width = right - this.left;
              }
            }, {
              key: "bottom",
              get: function get() {
                return this._bottom !== undefined ? this._bottom : this._bottom = this.top + this.height;
              },
              set: function set(bottom) {
                this._bottom = bottom;
                this.height = bottom - this.top;
              }
            }, {
              key: "offsetLeft",
              value: function offsetLeft(offset) {
                this._left += offset;
                this._right = undefined;
              }
            }, {
              key: "offsetTop",
              value: function offsetTop(offset) {
                this._top += offset;
                this._bottom = undefined;
              }
            }, {
              key: "copy",
              value: function copy() {
                return new Rect(this.left, this.top, this.width, this.height);
              }
            }, {
              key: "intersection",
              value: function intersection(rect) {
                var x0 = Math.max(this.left, rect.left);
                var x1 = Math.min(this.left + this.width, rect.left + rect.width);

                if (x0 <= x1) {
                  var y0 = Math.max(this.top, rect.top);
                  var y1 = Math.min(this.top + this.height, rect.top + rect.height);

                  if (y0 <= y1) {
                    return Rect.bounds(x0, y0, x1, y1);
                  }
                }

                return null;
              }
            }, {
              key: "contains",
              value: function contains(another) {
                return this.left <= another.left && this.left + this.width >= another.left + another.width && this.top <= another.top && this.top + this.height >= another.top + another.height;
              }
            }, {
              key: "inPoint",
              value: function inPoint(x, y) {
                return this.left <= x && this.left + this.width >= x && this.top <= y && this.top + this.height >= y;
              }
            }], [{
              key: "bounds",
              value: function bounds(left, top, right, bottom) {
                return new Rect(left, top, right - left, bottom - top);
              }
            }, {
              key: "max",
              value: function max(rect1, rect2) {
                return Rect.bounds(Math.min(rect1.left, rect2.left), Math.min(rect1.top, rect2.top), Math.max(rect1.right, rect2.right), Math.max(rect1.bottom, rect2.bottom));
              }
            }]);

            return Rect;
          }();

          exports.Rect = Rect;
          /***/
        },

        /***/
        "./internal/Scrollable.js":
        /*!********************************!*\
          !*** ./internal/Scrollable.js ***!
          \********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalScrollableJs(module, exports, __nested_webpack_require_870906__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Scrollable = void 0;

          var style = __importStar(__nested_webpack_require_870906__(
          /*! ./style */
          "./internal/style.js"));

          var EventHandler_1 = __nested_webpack_require_870906__(
          /*! ./EventHandler */
          "./internal/EventHandler.js");

          var utils_1 = __nested_webpack_require_870906__(
          /*! ./utils */
          "./internal/utils.js");

          var MAX_SCROLL = utils_1.browser.heightLimit - 1000;

          var Scrollable = /*#__PURE__*/function () {
            function Scrollable() {
              _classCallCheck(this, Scrollable);

              this._p = 1;
              this._handler = new EventHandler_1.EventHandler();
              this._scrollable = document.createElement("div");

              this._scrollable.classList.add("grid-scrollable");

              this._height = 0;
              this._width = 0;
              this._endPointElement = document.createElement("div");

              this._endPointElement.classList.add("grid-scroll-end-point");

              this._update();

              this._scrollable.appendChild(this._endPointElement); // const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? 'DOMMouseScroll' : 'mousewheel'; //FF doesn't recognize mousewheel as of FF3.x
              // this._handler.on(this._scrollable, mousewheelevt, (evt) => {
              // const delta = evt.detail ? evt.detail * (-120) : evt.wheelDelta;
              // const point = Math.min(Math.abs(delta) / 12, this.scrollHeight / 5);
              // this.scrollTop += delta < 0 ? point : -point;
              // });

            }

            _createClass(Scrollable, [{
              key: "calcTop",
              value: function calcTop(top) {
                var relativeTop = top - this.scrollTop;
                return this._scrollable.scrollTop + relativeTop;
              }
            }, {
              key: "getElement",
              value: function getElement() {
                return this._scrollable;
              }
            }, {
              key: "setScrollSize",
              value: function setScrollSize(width, height) {
                this._width = width;
                this._height = height;

                this._update();
              }
            }, {
              key: "scrollWidth",
              get: function get() {
                return this._width;
              },
              set: function set(width) {
                this._width = width;

                this._update();
              }
            }, {
              key: "scrollHeight",
              get: function get() {
                return this._height;
              },
              set: function set(height) {
                this._height = height;

                this._update();
              }
            }, {
              key: "scrollLeft",
              get: function get() {
                return Math.max(Math.ceil(this._scrollable.scrollLeft), 0);
              },
              set: function set(scrollLeft) {
                this._scrollable.scrollLeft = scrollLeft;
              }
            }, {
              key: "scrollTop",
              get: function get() {
                return Math.max(Math.ceil(this._scrollable.scrollTop / this._p), 0);
              },
              set: function set(scrollTop) {
                this._scrollable.scrollTop = scrollTop * this._p;
              }
            }, {
              key: "onScroll",
              value: function onScroll(fn) {
                this._handler.on(this._scrollable, "scroll", fn);
              }
            }, {
              key: "dispose",
              value: function dispose() {
                this._handler.dispose();
              }
            }, {
              key: "_update",
              value: function _update() {
                var domHeight;
                var _this$_scrollable = this._scrollable,
                    offsetHeight = _this$_scrollable.offsetHeight,
                    offsetWidth = _this$_scrollable.offsetWidth;

                if (this._height > MAX_SCROLL) {
                  var sbSize = style.getScrollBarSize();
                  var vScrollRange = MAX_SCROLL - offsetHeight + sbSize;
                  var rScrollRange = this._height - offsetHeight + sbSize;
                  this._p = vScrollRange / rScrollRange;
                  domHeight = MAX_SCROLL;
                } else {
                  this._p = 1;
                  domHeight = this._height;
                }

                this._endPointElement.style.top = "".concat(domHeight.toFixed(), "px");
                this._endPointElement.style.left = "".concat(this._width.toFixed(), "px"); // Sets the maximum value to the scroll position
                // if the current scroll position exceeds the maximum value.

                if (this.scrollTop > this.scrollHeight - offsetHeight) {
                  this.scrollTop = this.scrollHeight - offsetHeight;
                }

                if (this.scrollLeft > this.scrollWidth - offsetWidth) {
                  this.scrollLeft = this.scrollWidth - offsetWidth;
                }
              }
            }]);

            return Scrollable;
          }();

          exports.Scrollable = Scrollable;
          /***/
        },

        /***/
        "./internal/animate.js":
        /*!*****************************!*\
          !*** ./internal/animate.js ***!
          \*****************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalAnimateJs(module, exports, __nested_webpack_require_878081__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.animate = void 0;

          var utils_1 = __nested_webpack_require_878081__(
          /*! ./utils */
          "./internal/utils.js");

          function cubicBezier(x2, y2, x3, y3) {
            var step;
            var err = 0.0001;
            x2 *= 3;
            y2 *= 3;
            x3 *= 3;
            y3 *= 3;
            return function (t) {
              var p, a, b, c, d, x, s;

              if (t < 0 || 1 < t) {
                throw new Error("".concat(t));
              }

              p = step || t;

              do {
                a = 1 - p;
                b = a * a;
                c = p * p;
                d = c * p;
                x = x2 * b * p + x3 * a * c + d;
                s = t - x;
                p += s * 0.5;
              } while (err < Math.abs(s));

              step = p;
              return y2 * b * p + y3 * a * c + d;
            };
          }

          var EASINGS = {
            linear: function linear(p) {
              return p;
            },
            easeIn: cubicBezier(0.42, 0.0, 1.0, 1.0),
            easeOut: cubicBezier(0.0, 0.0, 0.58, 1.0),
            easeInOut: cubicBezier(0.42, 0.0, 0.58, 1.0)
          };
          var raf = utils_1.isNode ? function () {} : window.requestAnimationFrame || // eslint-disable-next-line @typescript-eslint/no-explicit-any
          function (fn) {
            return setTimeout(fn, 1);
          };

          function now() {
            return Date.now();
          }
          /**
           * <pre>
           * Animates.
           * </pre>
           * @function
           * @param {number} duration animation time.
           * @param {function} step step
           * @param {function|string} easing easing
           * @returns {object} Deferred object.
           */


          function animate(duration, step, easing) {
            var startedAt = now();
            var easingFn = easing == null ? EASINGS.easeInOut : typeof easing === "string" ? EASINGS[easing] : easing;
            var canceledFlg = false;

            var createAnim = function createAnim(resolve, reject) {
              var anim = function anim() {
                var point = now() - startedAt;

                if (canceledFlg) {
                  //cancel
                  if (reject) {
                    reject();
                  }
                } else if (point >= duration) {
                  //end
                  step(1);

                  if (resolve) {
                    resolve();
                  }
                } else {
                  step(easingFn(point / duration));
                  raf(anim);
                }
              };

              return anim;
            };

            var cancel = function cancel() {
              canceledFlg = true;
            };

            if (typeof Promise !== "undefined") {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              var result = new Promise(function (resolve, reject) {
                var anim = createAnim(resolve, reject);
                step(0);
                anim();
              });
              result.cancel = cancel;
              return result;
            } else {
              var anim = createAnim(function () {}, function () {});
              step(0);
              anim();
              return {
                cancel: cancel
              };
            }
          }

          exports.animate = animate;
          /***/
        },

        /***/
        "./internal/calc.js":
        /*!**************************!*\
          !*** ./internal/calc.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalCalcJs(module, exports, __nested_webpack_require_882068__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.toPx = void 0;

          var utils_1 = __nested_webpack_require_882068__(
          /*! ./utils */
          "./internal/utils.js");

          var TYPE_PAREN = 0;
          var TYPE_UNIT = 1;
          var TYPE_OPERATOR = 2;
          var TYPE_NUMBER = 3;
          var NODE_TYPE_UNIT = 10;
          var NODE_TYPE_BINARY_EXPRESSION = 11;
          var NODE_TYPE_NUMBER = 12;
          var TABULATION = 0x09;
          var CARRIAGE_RETURN = 0x0d;
          var LINE_FEED = 0x0a;
          var FORM_FEED = 0x0c;
          var SPACE = 0x20;
          var PERCENT = 0x25;
          var FULL_STOP = 0x2e;
          var DIGIT_0 = 0x30;
          var DIGIT_9 = 0x39;
          var LATIN_CAPITAL_A = 0x41;
          var LATIN_CAPITAL_Z = 0x5a;
          var LATIN_SMALL_A = 0x61;
          var LATIN_SMALL_Z = 0x7a;

          function isUpperLetter(cp) {
            return cp >= LATIN_CAPITAL_A && cp <= LATIN_CAPITAL_Z;
          }

          function isLowerLetter(cp) {
            return cp >= LATIN_SMALL_A && cp <= LATIN_SMALL_Z;
          }

          function isLetter(cp) {
            return isLowerLetter(cp) || isUpperLetter(cp);
          }

          function isWhitespace(cp) {
            return cp === TABULATION || cp === LINE_FEED || cp === FORM_FEED || cp === CARRIAGE_RETURN || cp === SPACE;
          }

          function isDigit(cp) {
            return cp >= DIGIT_0 && cp <= DIGIT_9;
          }

          function isDot(cp) {
            return cp === FULL_STOP;
          }

          function isUnit(cp) {
            return isLetter(cp) || cp === PERCENT;
          }

          function createError(calc) {
            return new Error("calc parse error: ".concat(calc));
          }
          /**
           * tokenize
           * @param {string} calc calc expression
           * @returns {Array} tokens
           * @private
           */


          function tokenize(calc) {
            var exp = calc.replace(/calc\(/g, "(").trim();
            var tokens = [];
            var len = exp.length;

            for (var index = 0; index < len; index++) {
              var c = exp[index];
              var cp = c.charCodeAt(0);

              if (c === "(" || c === ")") {
                tokens.push({
                  value: c,
                  type: TYPE_PAREN
                });
              } else if (c === "*" || c === "/") {
                tokens.push({
                  value: c,
                  type: TYPE_OPERATOR
                });
              } else if (c === "+" || c === "-") {
                index = parseSign(c, index + 1) - 1;
              } else if (isDigit(cp) || isDot(cp)) {
                index = parseNum(c, index + 1) - 1;
              } else if (isWhitespace(cp)) {// skip
              } else {
                throw createError(calc);
              }
            }

            function parseSign(sign, start) {
              if (start < len) {
                var _c3 = exp[start];

                var _cp = _c3.charCodeAt(0);

                if (isDigit(_cp) || isDot(_cp)) {
                  return parseNum(sign + _c3, start + 1);
                }
              }

              tokens.push({
                value: sign,
                type: TYPE_OPERATOR
              });
              return start;
            }

            function parseNum(num, start) {
              var index = start;

              for (; index < len; index++) {
                var _c4 = exp[index];

                var _cp2 = _c4.charCodeAt(0);

                if (isDigit(_cp2)) {
                  num += _c4;
                } else if (_c4 === ".") {
                  if (num.indexOf(".") >= 0) {
                    throw createError(calc);
                  }

                  num += _c4;
                } else if (isUnit(_cp2)) {
                  return parseUnit(num, _c4, index + 1);
                } else {
                  break;
                }
              }

              if (num === ".") {
                throw createError(calc);
              }

              tokens.push({
                value: parseFloat(num),
                type: TYPE_NUMBER
              });
              return index;
            }

            function parseUnit(num, unit, start) {
              var index = start;

              for (; index < len; index++) {
                var _c5 = exp[index];

                var _cp3 = _c5.charCodeAt(0);

                if (isUnit(_cp3)) {
                  unit += _c5;
                } else {
                  break;
                }
              }

              tokens.push({
                value: parseFloat(num),
                unit: unit,
                type: TYPE_UNIT
              });
              return index;
            }

            return tokens;
          }

          var PRECEDENCE = {
            "*": 3,
            "/": 3,
            "+": 2,
            "-": 2
          };

          function lex(tokens, calc) {
            function buildBinaryExpNode(stack) {
              var right = stack.pop();
              var op = stack.pop();
              var left = stack.pop();

              if (!left || !left.nodeType || !op || op.type !== TYPE_OPERATOR || !right || !right.nodeType) {
                throw createError(calc);
              }

              return {
                nodeType: NODE_TYPE_BINARY_EXPRESSION,
                left: left,
                op: op,
                right: right
              };
            }

            var stack = [];

            while (tokens.length) {
              var token = tokens.shift();

              if (token.type === TYPE_PAREN && token.value === "(") {
                (function () {
                  var deep = 0;
                  var closeIndex = utils_1.array.findIndex(tokens, function (t) {
                    if (t.type === TYPE_PAREN && t.value === "(") {
                      deep++;
                    } else if (t.type === TYPE_PAREN && t.value === ")") {
                      if (!deep) {
                        return true;
                      }

                      deep--;
                    }

                    return false;
                  });

                  if (closeIndex === -1) {
                    throw createError(calc);
                  }

                  stack.push(lex(tokens.splice(0, closeIndex), calc));
                  tokens.shift();
                })();
              } else if (token.type === TYPE_OPERATOR) {
                if (stack.length >= 3) {
                  var beforeOp = stack[stack.length - 2].value;

                  if (PRECEDENCE[token.value] <= PRECEDENCE[beforeOp]) {
                    stack.push(buildBinaryExpNode(stack));
                  }
                }

                stack.push(token);
              } else if (token.type === TYPE_UNIT) {
                var num = token.value,
                    unit = token.unit;
                stack.push({
                  nodeType: NODE_TYPE_UNIT,
                  value: num,
                  unit: unit
                });
              } else if (token.type === TYPE_NUMBER) {
                stack.push({
                  nodeType: NODE_TYPE_NUMBER,
                  value: token.value
                });
              }
            }

            while (stack.length > 1) {
              stack.push(buildBinaryExpNode(stack));
            }

            return stack[0];
          }

          function parse(calcStr) {
            var tokens = tokenize(calcStr);
            return lex(tokens, calcStr);
          }

          function calcNode(node, context) {
            if (node.nodeType === NODE_TYPE_BINARY_EXPRESSION) {
              var left = calcNode(node.left, context);
              var right = calcNode(node.right, context);

              switch (node.op.value) {
                case "+":
                  return left + right;

                case "-":
                  return left - right;

                case "*":
                  return left * right;

                case "/":
                  return left / right;

                default:
                  // eslint-disable-next-line @typescript-eslint/restrict-template-expressions
                  throw new Error("calc error. unknown operator: ".concat(node.op.value));
              }
            } else if (node.nodeType === NODE_TYPE_UNIT) {
              switch (node.unit) {
                case "%":
                  return node.value * context.full / 100;

                case "em":
                  return node.value * context.em;

                case "px":
                  return node.value;

                default:
                  throw new Error("calc error. unknown unit: ".concat(node.unit));
              }
            } else if (node.nodeType === NODE_TYPE_NUMBER) {
              return node.value;
            }

            throw new Error("calc error.");
          }

          function toPxInternal(value, context) {
            var ast = parse(value);
            return calcNode(ast, context);
          }

          function toPx(value, context) {
            if (typeof value === "string") {
              return toPxInternal(value.trim(), context);
            }

            return value - 0;
          }

          exports.toPx = toPx;
          /***/
        },

        /***/
        "./internal/canvases.js":
        /*!******************************!*\
          !*** ./internal/canvases.js ***!
          \******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalCanvasesJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.calcStartPosition = exports.calcBasePosition = exports.getFontSize = void 0;
          var fontSizeCache = {};

          function getFontSize(ctx, font) {
            var fontName = font || ctx.font;

            if (fontSizeCache[fontName]) {
              return fontSizeCache[fontName];
            }

            var bk = ctx.font;

            try {
              ctx.font = fontName;
              var em = ctx.measureText("あ").width;
              return fontSizeCache[fontName] = {
                width: em,
                height: em
              };
            } finally {
              ctx.font = bk;
            }
          }

          exports.getFontSize = getFontSize;

          function calcBasePosition(ctx, rect) {
            var _ref78 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                _ref78$offset = _ref78.offset,
                offset = _ref78$offset === void 0 ? 0 : _ref78$offset,
                _ref78$padding = _ref78.padding;

            _ref78$padding = _ref78$padding === void 0 ? {} : _ref78$padding;
            var _ref78$padding$left = _ref78$padding.left,
                paddingLeft = _ref78$padding$left === void 0 ? 0 : _ref78$padding$left,
                _ref78$padding$right = _ref78$padding.right,
                paddingRight = _ref78$padding$right === void 0 ? 0 : _ref78$padding$right,
                _ref78$padding$top = _ref78$padding.top,
                paddingTop = _ref78$padding$top === void 0 ? 0 : _ref78$padding$top,
                _ref78$padding$bottom = _ref78$padding.bottom,
                paddingBottom = _ref78$padding$bottom === void 0 ? 0 : _ref78$padding$bottom;
            return calcStartPosition(ctx, rect, 0, 0, {
              offset: offset,
              padding: {
                left: paddingLeft,
                right: paddingRight,
                top: paddingTop,
                bottom: paddingBottom
              }
            });
          }

          exports.calcBasePosition = calcBasePosition;

          function calcStartPosition(ctx, rect, width, height) {
            var _ref79 = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {},
                _ref79$offset = _ref79.offset,
                offset = _ref79$offset === void 0 ? 0 : _ref79$offset,
                _ref79$padding = _ref79.padding;

            _ref79$padding = _ref79$padding === void 0 ? {} : _ref79$padding;
            var _ref79$padding$left = _ref79$padding.left,
                paddingLeft = _ref79$padding$left === void 0 ? 0 : _ref79$padding$left,
                _ref79$padding$right = _ref79$padding.right,
                paddingRight = _ref79$padding$right === void 0 ? 0 : _ref79$padding$right,
                _ref79$padding$top = _ref79$padding.top,
                paddingTop = _ref79$padding$top === void 0 ? 0 : _ref79$padding$top,
                _ref79$padding$bottom = _ref79$padding.bottom,
                paddingBottom = _ref79$padding$bottom === void 0 ? 0 : _ref79$padding$bottom;
            var textAlign = ctx.textAlign || "left";
            var textBaseline = ctx.textBaseline || "middle";
            ctx.textAlign = textAlign;
            ctx.textBaseline = textBaseline;
            var x = rect.left + offset + paddingLeft;

            if (textAlign === "right" || textAlign === "end") {
              x = rect.right - width - offset - paddingRight;
            } else if (textAlign === "center") {
              x = rect.left + (rect.width - width + paddingLeft - paddingRight) / 2;
            }

            var y = rect.top + offset + paddingTop;

            if (textBaseline === "bottom" || textBaseline === "alphabetic" || textBaseline === "ideographic") {
              y = rect.bottom - height - offset - paddingBottom;
            } else if (textBaseline === "middle") {
              y = rect.top + (rect.height - height + paddingTop - paddingBottom) / 2;
            }

            return {
              x: x,
              y: y
            };
          }

          exports.calcStartPosition = calcStartPosition;
          /***/
        },

        /***/
        "./internal/color.js":
        /*!***************************!*\
          !*** ./internal/color.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalColorJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.colorToRGB = void 0;
          var rgbMap = {};

          function styleColorToRGB(color) {
            var dummy = document.createElement("div");
            var style = dummy.style;
            style.color = color;
            style.position = "fixed";
            style.height = "1px";
            style.width = "1px";
            style.opacity = "0";
            document.body.appendChild(dummy);

            var _getComputedStyle = (document.defaultView || window).getComputedStyle(dummy, ""),
                styleColor = _getComputedStyle.color;

            document.body.removeChild(dummy);
            return colorToRGB0(styleColor || "");
          }

          function hexToNum(hex) {
            return parseInt(hex, 16);
          }

          function createRGB(r, g, b) {
            var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
            return {
              r: r,
              g: g,
              b: b,
              a: a
            };
          }

          function tripleHexToRGB(_ref80) {
            var r = _ref80[1],
                g = _ref80[2],
                b = _ref80[3];
            return createRGB(hexToNum(r + r), hexToNum(g + g), hexToNum(b + b));
          }

          function sextupleHexToRGB(_ref81) {
            var r1 = _ref81[1],
                r2 = _ref81[2],
                g1 = _ref81[3],
                g2 = _ref81[4],
                b1 = _ref81[5],
                b2 = _ref81[6];
            return createRGB(hexToNum(r1 + r2), hexToNum(g1 + g2), hexToNum(b1 + b2));
          }

          function testRGB(_ref82) {
            var r = _ref82.r,
                g = _ref82.g,
                b = _ref82.b,
                a = _ref82.a;
            return 0 <= r && r <= 255 && 0 <= g && g <= 255 && 0 <= b && b <= 255 && 0 <= a && a <= 1;
          }

          function rateToByte(r) {
            return Math.ceil(r * 255 / 100);
          }

          var numberPattern = /((?:\+|-)?(?:\d+(?:\.\d+)?|\.\d+))/.source;
          var percentPattern = "".concat(numberPattern, "%");
          var maybePercentPattern = "".concat(numberPattern, "(%?)");

          function buildRgbWithCommaRegExp(bytePattern) {
            return new RegExp("^rgba?\\(\\s*".concat(bytePattern, "\\s*,\\s*").concat(bytePattern, "\\s*,\\s*").concat(bytePattern, "\\s*\\)$"), "i");
          }

          function buildRgbLv4RegExp(bytePattern) {
            return new RegExp("^rgba?\\(\\s*".concat(bytePattern, "\\s+").concat(bytePattern, "\\s+").concat(bytePattern, "\\s*\\)$"), "i");
          }

          function buildRgbaWithCommaRegExp(bytePattern, alphaPattern) {
            return new RegExp("^rgba?\\(\\s*".concat(bytePattern, "\\s*,\\s*").concat(bytePattern, "\\s*,\\s*").concat(bytePattern, "\\s*,\\s*").concat(alphaPattern, "\\s*\\)$"), "i");
          }

          function buildRgbaLv4RegExp(bytePattern, alphaPattern) {
            return new RegExp("^rgba?\\(\\s*".concat(bytePattern, "\\s+").concat(bytePattern, "\\s+").concat(bytePattern, "\\s*/\\s*").concat(alphaPattern, "\\s*\\)$"), "i");
          }

          function colorToRGB0(color) {
            if (/^#[0-9a-f]{3}$/i.exec(color)) {
              return tripleHexToRGB(color);
            }

            if (/^#[0-9a-f]{6}$/i.exec(color)) {
              return sextupleHexToRGB(color);
            }

            var ret = buildRgbWithCommaRegExp(numberPattern).exec(color) || buildRgbLv4RegExp(numberPattern).exec(color);

            if (ret) {
              var rgb = createRGB(Number(ret[1]), Number(ret[2]), Number(ret[3]));

              if (testRGB(rgb)) {
                return rgb;
              }
            }

            ret = buildRgbWithCommaRegExp(percentPattern).exec(color) || buildRgbLv4RegExp(percentPattern).exec(color);

            if (ret) {
              var _rgb = createRGB(rateToByte(Number(ret[1])), rateToByte(Number(ret[2])), rateToByte(Number(ret[3])));

              if (testRGB(_rgb)) {
                return _rgb;
              }
            }

            ret = buildRgbaWithCommaRegExp(numberPattern, maybePercentPattern).exec(color) || buildRgbaLv4RegExp(numberPattern, maybePercentPattern).exec(color);

            if (ret) {
              var _rgb2 = createRGB(Number(ret[1]), Number(ret[2]), Number(ret[3]), Number(ret[4]) / (ret[5]
              /* % */
              ? 100 : 1));

              if (testRGB(_rgb2)) {
                return _rgb2;
              }
            }

            ret = buildRgbaWithCommaRegExp(percentPattern, maybePercentPattern).exec(color) || buildRgbaLv4RegExp(percentPattern, maybePercentPattern).exec(color);

            if (ret) {
              var _rgb3 = createRGB(rateToByte(Number(ret[1])), rateToByte(Number(ret[2])), rateToByte(Number(ret[3])), Number(ret[4]) / (ret[5]
              /* % */
              ? 100 : 1));

              if (testRGB(_rgb3)) {
                return _rgb3;
              }
            }

            return null;
          }

          function colorToRGB(color) {
            if (typeof color !== "string") {
              return createRGB(0, 0, 0, 0);
            }

            color = color.toLowerCase().trim();

            if (rgbMap[color]) {
              return rgbMap[color];
            }

            return colorToRGB0(color) || (rgbMap[color] = styleColorToRGB(color));
          }

          exports.colorToRGB = colorToRGB;
          /***/
        },

        /***/
        "./internal/dom.js":
        /*!*************************!*\
          !*** ./internal/dom.js ***!
          \*************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalDomJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.findNextSiblingFocusable = exports.findPrevSiblingFocusable = exports.isFocusable = exports.enableFocus = exports.disableFocus = exports.appendHtml = exports.toNodeList = exports.empty = exports.createElement = void 0;

          function createElement(tagName) {
            var _ref83 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
                classList = _ref83.classList,
                text = _ref83.text,
                html = _ref83.html;

            var element = document.createElement(tagName);

            if (classList) {
              if (Array.isArray(classList)) {
                var _element$classList;

                (_element$classList = element.classList).add.apply(_element$classList, _toConsumableArray(classList));
              } else {
                element.classList.add(classList);
              }
            }

            if (text) {
              element.textContent = text;
            } else if (html) {
              element.innerHTML = html;
            }

            return element;
          }

          exports.createElement = createElement;

          function empty(dom) {
            var c;

            while (c = dom.firstChild) {
              dom.removeChild(c);
            }
          }

          exports.empty = empty;

          function isNode(arg) {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            return !!(arg.nodeType && arg.nodeName);
          }

          function toNode(arg) {
            if (isNode(arg)) {
              return arg;
            }

            var dom = createElement("div", {
              html: arg
            });
            return Array.prototype.slice.call(dom.childNodes);
          }

          function toNodeList(arg) {
            if (Array.isArray(arg)) {
              var result = [];
              arg.forEach(function (e) {
                result.push.apply(result, _toConsumableArray(toNodeList(e)));
              });
              return result;
            }

            var node = toNode(arg);
            return Array.isArray(node) ? node : [node];
          }

          exports.toNodeList = toNodeList;

          function appendHtml(dom, inner) {
            toNodeList(inner).forEach(function (node) {
              dom.appendChild(node);
            });
          }

          exports.appendHtml = appendHtml;

          function disableFocus(el) {
            el.dataset.disableBeforeTabIndex = "".concat(el.tabIndex);
            el.tabIndex = -1;
            Array.prototype.slice.call(el.children, 0).forEach(disableFocus);
          }

          exports.disableFocus = disableFocus;

          function enableFocus(el) {
            if ("disableBeforeTabIndex" in el.dataset) {
              el.tabIndex = Number(el.dataset.disableBeforeTabIndex);
            }

            Array.prototype.slice.call(el.children, 0).forEach(enableFocus);
          }

          exports.enableFocus = enableFocus;

          function isFocusable(el) {
            return el.tabIndex != null && el.tabIndex > -1;
          }

          exports.isFocusable = isFocusable;

          function findPrevSiblingFocusable(el) {
            var n = el.previousSibling;

            while (n && !isFocusable(n)) {
              n = n.previousSibling;
            }

            return n;
          }

          exports.findPrevSiblingFocusable = findPrevSiblingFocusable;

          function findNextSiblingFocusable(el) {
            var n = el.nextSibling;

            while (n && !isFocusable(n)) {
              n = n.nextSibling;
            }

            return n;
          }

          exports.findNextSiblingFocusable = findNextSiblingFocusable;
          /***/
        },

        /***/
        "./internal/fonts.js":
        /*!***************************!*\
          !*** ./internal/fonts.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalFontsJs(module, exports, __nested_webpack_require_906781__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.load = exports.check = void 0;

          var utils_1 = __nested_webpack_require_906781__(
          /*! ./utils */
          "./internal/utils.js");

          var loads = {};
          var load;
          exports.load = load;
          var check;
          exports.check = check;

          if (utils_1.isNode) {
            exports.load = load = function load(_font, _testStr, callback) {
              callback();
            };

            exports.check = check = function check() {
              return false;
            };
          } else {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            var fontFaceSet = document.fonts;
            var legacy = !fontFaceSet;
            exports.load = load = legacy ? function (font, testStr, callback) {
              //for legacy(IE)
              if (loads["".concat(font, " @ ").concat(testStr)]) {
                callback();
                return;
              } // eslint-disable-next-line @typescript-eslint/no-var-requires


              __nested_webpack_require_906781__(
              /*! ./legacy/fontwatch/FontWatchRunner */
              "./internal/legacy/fontwatch/FontWatchRunner.js").load(font, testStr, function () {
                loads["".concat(font, " @ ").concat(testStr)] = true;
                callback();
              }, function () {
                loads["".concat(font, " @ ").concat(testStr)] = true;
                callback();
              });
            } : function (font, _testStr, callback) {
              if (loads.all || loads[font]) {
                callback();
                return;
              }

              fontFaceSet.ready.then(function () {
                loads.all = true;
              });
              fontFaceSet.load(font).then(function () {
                loads[font] = true;
                callback();
              });
            };
            exports.check = check = legacy ? function (font, testStr) {
              //for legacy(IE)
              if (loads["".concat(font, " @ ").concat(testStr)]) {
                return true;
              }

              load(font, testStr, function () {});
              return false;
            } : function (font, testStr) {
              if (loads.all || loads[font]) {
                return true;
              }

              if (!fontFaceSet.check(font)) {
                load(font, testStr, function () {});
                return false;
              }

              return true;
            };
          }
          /***/

        },

        /***/
        "./internal/hiDPI.js":
        /*!***************************!*\
          !*** ./internal/hiDPI.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalHiDPIJs(module, exports, __nested_webpack_require_909820__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.transform = void 0;

          var EventHandler_1 = __nested_webpack_require_909820__(
          /*! ./EventHandler */
          "./internal/EventHandler.js");

          var utils_1 = __nested_webpack_require_909820__(
          /*! ./utils */
          "./internal/utils.js");

          var handler = new EventHandler_1.EventHandler();
          var ratio = 1;

          function setRatio() {
            if (utils_1.isNode) {
              ratio = 1;
            } else {
              ratio = Math.ceil(window.devicePixelRatio || 1);

              if (ratio > 1 && ratio % 2 !== 0) {
                ratio += 1;
              }
            }
          }

          setRatio();

          if (!utils_1.isNode) {
            handler.on(window, "resize", setRatio);
          }

          function transform(canvas) {
            var ctx = canvas.getContext("2d");
            var getAttribute = canvas.getAttribute,
                setAttribute = canvas.setAttribute;

            canvas.getAttribute = function (name) {
              var result = getAttribute.call(this, name);

              if (name === "width" || name === "height") {
                result = "".concat(Number(result) / ratio);
              }

              return result;
            };

            canvas.setAttribute = function (name, val) {
              var wh = name === "width" || name === "height";

              if (wh) {
                val = "".concat(Number(val) * ratio);
              }

              var result = setAttribute.call(this, name, val);

              if (wh) {
                ctx.scale(ratio, ratio);
              }

              return result;
            };

            Object.defineProperty(canvas, "width", {
              get: function get() {
                return Number(canvas.getAttribute("width"));
              },
              set: function set(val) {
                canvas.setAttribute("width", "".concat(Math.floor(val)));
              },
              configurable: true,
              enumerable: true
            });
            Object.defineProperty(canvas, "height", {
              get: function get() {
                return Number(canvas.getAttribute("height"));
              },
              set: function set(val) {
                canvas.setAttribute("height", "".concat(Math.floor(val)));
              },
              configurable: true,
              enumerable: true
            });
            var drawImage = ctx.drawImage; // eslint-disable-next-line @typescript-eslint/no-explicit-any

            ctx.drawImage = function (img) {
              for (var _len10 = arguments.length, args = new Array(_len10 > 1 ? _len10 - 1 : 0), _key10 = 1; _key10 < _len10; _key10++) {
                args[_key10 - 1] = arguments[_key10];
              }

              if (img !== canvas || ratio === 1) {
                return drawImage.call.apply(drawImage, [this, img].concat(args));
              }

              this.save();

              try {
                this.scale(1 / ratio, 1 / ratio);

                if (args.length > 4) {
                  args[4] *= ratio;
                  args[5] *= ratio;
                } else {
                  args[0] *= ratio;
                  args[1] *= ratio;
                }

                return drawImage.call.apply(drawImage, [this, img].concat(args));
              } finally {
                this.restore();
              }
            };

            return canvas;
          }

          exports.transform = transform;
          /***/
        },

        /***/
        "./internal/icons.js":
        /*!***************************!*\
          !*** ./internal/icons.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalIconsJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.iconPropKeys = exports.toNormalizeArray = exports.getIconProps = void 0;
          var ICON_PROP_KEYS = ["content", "font", "color", "className", "tagName", "isLiga", "width", "src", "svg", "name", "path", "offsetTop", "offsetLeft"];

          function quote(name) {
            var quoted = [];
            var split = name.split(/,\s*/);

            for (var i = 0; i < split.length; i++) {
              var part = split[i].replace(/['"]/g, "");

              if (part.indexOf(" ") === -1 && !/^\d/.test(part)) {
                quoted.push(part);
              } else {
                quoted.push("'".concat(part, "'"));
              }
            }

            return quoted.join(",");
          }

          var doms = {};
          var props = {};

          function getIconProps(tagName, className) {
            var tagProps = props[tagName] || (props[tagName] = {});

            if (tagProps[className]) {
              return tagProps[className];
            }

            var dom = doms[tagName] || (doms[tagName] = document.createElement(tagName)); // `classList.add()` cannot be used because it may be separated by spaces.

            dom.className = className;
            dom.classList.add("cheetah-grid-icon");
            document.body.appendChild(dom);

            try {
              var beforeStyle = (document.defaultView || window).getComputedStyle(dom, "::before");
              var content = beforeStyle.getPropertyValue("content");

              if (content.length >= 3 && (content[0] === '"' || content[0] === "'")) {
                if (content[0] === content[content.length - 1]) {
                  content = content.slice(1, -1);
                }
              }

              var font = beforeStyle.getPropertyValue("font");

              if (!font) {
                font = "".concat(beforeStyle.getPropertyValue("font-style"), " ").concat(beforeStyle.getPropertyValue("font-variant"), " ").concat(beforeStyle.getPropertyValue("font-weight"), " ").concat(beforeStyle.getPropertyValue("font-size"), "/").concat(beforeStyle.getPropertyValue("line-height"), " ").concat(quote(beforeStyle.getPropertyValue("font-family")));
              }

              var color = beforeStyle.getPropertyValue("color");
              var width = dom.clientWidth;
              var isLiga = (beforeStyle.getPropertyValue("font-feature-settings") || "").indexOf("liga") > -1;
              return tagProps[className] = {
                content: content,
                font: font,
                color: color,
                width: width,
                isLiga: isLiga
              };
            } finally {
              document.body.removeChild(dom);
            }
          }

          exports.getIconProps = getIconProps;

          function toPropArray(prop, count) {
            var result = [];

            if (Array.isArray(prop)) {
              result.push.apply(result, _toConsumableArray(prop));

              for (var i = prop.length; i < count; i++) {
                result.push(null);
              }
            } else {
              for (var _i3 = 0; _i3 < count; _i3++) {
                result.push(prop);
              }
            }

            return result;
          }

          function toSimpleArray(iconProps) {
            if (!iconProps) {
              return iconProps;
            } else if (Array.isArray(iconProps)) {
              return iconProps;
            }

            var workData = {};
            var count = 0;
            ICON_PROP_KEYS.forEach(function (k) {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              var prop = iconProps[k];

              if (prop) {
                if (Array.isArray(prop)) {
                  count = Math.max(count, prop.length);
                } else {
                  count = Math.max(count, 1);
                }
              }
            });
            ICON_PROP_KEYS.forEach(function (k) {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              var arr = toPropArray(iconProps[k], count); // eslint-disable-next-line @typescript-eslint/no-explicit-any

              workData[k] = arr;
            });
            var result = [];

            var _loop6 = function _loop6(i) {
              var data = {};
              ICON_PROP_KEYS.forEach(function (k) {
                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                var val = workData[k][i]; // eslint-disable-next-line @typescript-eslint/no-explicit-any

                data[k] = val;
              });
              result.push(data);
            };

            for (var i = 0; i < count; i++) {
              _loop6(i);
            }

            return result;
          }

          function normalize(iconProps) {
            var data = {};

            for (var k in iconProps) {
              if (k === "className") {
                continue;
              }

              if (isIconKey(k)) {
                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                data[k] = iconProps[k];
              }
            }

            if (iconProps.className) {
              var prop = getIconProps(iconProps.tagName || "i", iconProps.className);

              for (var _k2 in prop) {
                if (isIconKey(_k2)) {
                  if (iconProps[_k2] == null) {
                    // eslint-disable-next-line @typescript-eslint/no-explicit-any
                    data[_k2] = prop[_k2];
                  }
                }
              }
            }

            return data;
          }

          function toNormalizeArray(iconProps) {
            var icons = toSimpleArray(iconProps);

            if (!icons) {
              return icons;
            }

            return icons.map(function (icon) {
              return normalize(icon);
            });
          }

          exports.toNormalizeArray = toNormalizeArray;
          exports.iconPropKeys = ICON_PROP_KEYS;

          function isIconKey(k) {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            return ICON_PROP_KEYS.indexOf(k) >= 0;
          }
          /***/

        },

        /***/
        "./internal/imgs.js":
        /*!**************************!*\
          !*** ./internal/imgs.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalImgsJs(module, exports, __nested_webpack_require_920588__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.getCacheOrLoad = exports.loadImage = void 0;

          var LRUCache_1 = __nested_webpack_require_920588__(
          /*! ./LRUCache */
          "./internal/LRUCache.js");

          var utils_1 = __nested_webpack_require_920588__(
          /*! ./utils */
          "./internal/utils.js");

          var allCache = {};

          function loadImage(src) {
            if (typeof Promise === "undefined") {
              console.error("Promise is not loaded. load Promise before this process.");
              return {
                then: function then() {
                  return this;
                } // eslint-disable-next-line @typescript-eslint/no-explicit-any

              };
            }

            var img = new Image();
            var result = new Promise(function (resolve) {
              img.onload = function () {
                resolve(img);
              };
            });

            img.onerror = function () {
              var url = src.length > 200 ? "".concat(src.slice(0, 200), "...") : src;
              console.warn("cannot load: ".concat(url));
              throw new Error("IMAGE LOAD ERROR: ".concat(url));
            };

            img.src = src;
            return result;
          }

          exports.loadImage = loadImage;

          function getCacheOrLoad0(cache, src) {
            return (0, utils_1.then)(src, function (src) {
              var c = cache.get(src);

              if (c) {
                return c;
              }

              var result = loadImage(src).then(function (img) {
                cache.put(src, img);
                return img;
              });
              cache.put(src, result);
              return result;
            });
          }

          function getCacheOrLoad(cacheName, cacheSize, src) {
            var cache = allCache[cacheName] || (allCache[cacheName] = new LRUCache_1.LRUCache(cacheSize));
            return getCacheOrLoad0(cache, src);
          }

          exports.getCacheOrLoad = getCacheOrLoad;
          /***/
        },

        /***/
        "./internal/legacy/canvas/Path2DShim.js":
        /*!**********************************************!*\
          !*** ./internal/legacy/canvas/Path2DShim.js ***!
          \**********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalLegacyCanvasPath2DShimJs(module, exports, __nested_webpack_require_923209__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Path2DShim = void 0;

          var PathCommandsParser_1 = __nested_webpack_require_923209__(
          /*! ./PathCommandsParser */
          "./internal/legacy/canvas/PathCommandsParser.js");

          var parser = new PathCommandsParser_1.PathCommandsParser();

          var Path2DShim = /*#__PURE__*/function () {
            function Path2DShim(arg) {
              _classCallCheck(this, Path2DShim);

              this._ops = [];

              if (arg === undefined) {
                return;
              }

              if (typeof arg === "string") {
                // try {
                this._ops = parser.parse(arg); // } catch (e) {
                // 	throw e;
                // }
              } else if (arg.hasOwnProperty("_ops")) {
                this._ops = _toConsumableArray(arg._ops);
              } else {
                throw new Error("Error: ".concat(_typeof(arg), " is not a valid argument to Path"));
              }
            }

            _createClass(Path2DShim, [{
              key: "arc",
              value: function arc() {
                for (var _len11 = arguments.length, args = new Array(_len11), _key11 = 0; _key11 < _len11; _key11++) {
                  args[_key11] = arguments[_key11];
                }

                this._ops.push({
                  op: "arc",
                  args: args
                });
              }
            }, {
              key: "arcTo",
              value: function arcTo() {
                for (var _len12 = arguments.length, args = new Array(_len12), _key12 = 0; _key12 < _len12; _key12++) {
                  args[_key12] = arguments[_key12];
                }

                this._ops.push({
                  op: "arcTo",
                  args: args
                });
              }
            }, {
              key: "bezierCurveTo",
              value: function bezierCurveTo() {
                for (var _len13 = arguments.length, args = new Array(_len13), _key13 = 0; _key13 < _len13; _key13++) {
                  args[_key13] = arguments[_key13];
                }

                this._ops.push({
                  op: "bezierCurveTo",
                  args: args
                });
              }
            }, {
              key: "closePath",
              value: function closePath() {
                for (var _len14 = arguments.length, args = new Array(_len14), _key14 = 0; _key14 < _len14; _key14++) {
                  args[_key14] = arguments[_key14];
                }

                this._ops.push({
                  op: "closePath",
                  args: args
                });
              }
            }, {
              key: "ellipse",
              value: function ellipse() {
                for (var _len15 = arguments.length, args = new Array(_len15), _key15 = 0; _key15 < _len15; _key15++) {
                  args[_key15] = arguments[_key15];
                }

                this._ops.push({
                  op: "ellipse",
                  args: args
                });
              }
            }, {
              key: "lineTo",
              value: function lineTo() {
                for (var _len16 = arguments.length, args = new Array(_len16), _key16 = 0; _key16 < _len16; _key16++) {
                  args[_key16] = arguments[_key16];
                }

                this._ops.push({
                  op: "lineTo",
                  args: args
                });
              }
            }, {
              key: "moveTo",
              value: function moveTo() {
                for (var _len17 = arguments.length, args = new Array(_len17), _key17 = 0; _key17 < _len17; _key17++) {
                  args[_key17] = arguments[_key17];
                }

                this._ops.push({
                  op: "moveTo",
                  args: args
                });
              }
            }, {
              key: "quadraticCurveTo",
              value: function quadraticCurveTo() {
                for (var _len18 = arguments.length, args = new Array(_len18), _key18 = 0; _key18 < _len18; _key18++) {
                  args[_key18] = arguments[_key18];
                }

                this._ops.push({
                  op: "quadraticCurveTo",
                  args: args
                });
              }
            }, {
              key: "rect",
              value: function rect() {
                for (var _len19 = arguments.length, args = new Array(_len19), _key19 = 0; _key19 < _len19; _key19++) {
                  args[_key19] = arguments[_key19];
                }

                this._ops.push({
                  op: "rect",
                  args: args
                });
              }
            }, {
              key: "roundRect",
              value: function roundRect(_x, _y, _w, _h, _radii) {
                throw new Error("Method not implemented.");
              }
            }]);

            return Path2DShim;
          }();

          exports.Path2DShim = Path2DShim;
          var CanvasRenderingContext2D = window.CanvasRenderingContext2D;
          var originalFill = CanvasRenderingContext2D.prototype.fill; // eslint-disable-next-line @typescript-eslint/no-explicit-any

          CanvasRenderingContext2D.prototype.fill = function () {
            var _this102 = this;

            for (var _len20 = arguments.length, args = new Array(_len20), _key20 = 0; _key20 < _len20; _key20++) {
              args[_key20] = arguments[_key20];
            }

            if (args[0] instanceof Path2DShim) {
              var path = args[0];
              this.beginPath();

              path._ops.forEach(function (op) {
                var fn = _this102[op.op];
                fn.apply(_this102, op.args);
              });

              originalFill.apply(this, Array.prototype.slice.call(args, 1));
            } else {
              originalFill.apply(this, args);
            }
          };
          /***/

        },

        /***/
        "./internal/legacy/canvas/PathCommands.js":
        /*!************************************************!*\
          !*** ./internal/legacy/canvas/PathCommands.js ***!
          \************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalLegacyCanvasPathCommandsJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.PathCommands = void 0;
          /*eslint new-cap: "off"*/

          function mag(v) {
            return Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2));
          }

          function dot(u, v) {
            return u[0] * v[0] + u[1] * v[1];
          }

          function ratio(u, v) {
            return dot(u, v) / (mag(u) * mag(v));
          }

          function clamp(value, min, max) {
            return Math.min(Math.max(value, min), max);
          }

          function angle(u, v) {
            var sign = 1.0;

            if (u[0] * v[1] - u[1] * v[0] < 0) {
              sign = -1.0;
            }

            return sign * Math.acos(clamp(ratio(u, v), -1, 1));
          }

          function rotClockwise(v, angle) {
            var cost = Math.cos(angle);
            var sint = Math.sin(angle);
            return [cost * v[0] + sint * v[1], -1 * sint * v[0] + cost * v[1]];
          }

          function rotCounterClockwise(v, angle) {
            var cost = Math.cos(angle);
            var sint = Math.sin(angle);
            return [cost * v[0] - sint * v[1], sint * v[0] + cost * v[1]];
          }

          function midPoint(u, v) {
            return [(u[0] - v[0]) / 2.0, (u[1] - v[1]) / 2.0];
          }

          function meanVec(u, v) {
            return [(u[0] + v[0]) / 2.0, (u[1] + v[1]) / 2.0];
          }

          function pointMul(u, v) {
            return [u[0] * v[0], u[1] * v[1]];
          }

          function scale(c, v) {
            return [c * v[0], c * v[1]];
          }

          function sum(u, v) {
            return [u[0] + v[0], u[1] + v[1]];
          } // Convert an SVG elliptical arc to a series of canvas commands.
          //
          // x1, y1, x2, y2: start and stop coordinates of the ellipse.
          // rx, ry: radii of the ellipse.
          // phi: rotation of the ellipse.
          // fA: large arc flag.
          // fS: sweep flag.


          function ellipseFromEllipticalArc(ctx, x1, y1, rx, ry, phi, fA, fS, x2, y2) {
            // Convert from endpoint to center parametrization, as detailed in:
            //   http://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes
            if (rx === 0 || ry === 0) {
              ctx.lineTo(x2, x1);
              return;
            }

            phi *= Math.PI / 180.0;
            rx = Math.abs(rx);
            ry = Math.abs(ry);
            var xPrime = rotClockwise(midPoint([x1, y1], [x2, y2]), phi); // F.6.5.1

            var xPrime2 = pointMul(xPrime, xPrime);
            var rx2 = Math.pow(rx, 2);
            var ry2 = Math.pow(ry, 2);
            var lambda = Math.sqrt(xPrime2[0] / rx2 + xPrime2[1] / ry2);

            if (lambda > 1) {
              rx *= lambda;
              ry *= lambda;
              rx2 = Math.pow(rx, 2);
              ry2 = Math.pow(ry, 2);
            }

            var factor = Math.sqrt(Math.abs(rx2 * ry2 - rx2 * xPrime2[1] - ry2 * xPrime2[0]) / (rx2 * xPrime2[1] + ry2 * xPrime2[0]));

            if (fA === fS) {
              factor *= -1.0;
            }

            var cPrime = scale(factor, [rx * xPrime[1] / ry, -ry * xPrime[0] / rx]); // F.6.5.2

            var c = sum(rotCounterClockwise(cPrime, phi), meanVec([x1, y1], [x2, y2])); // F.6.5.3

            var x1UnitVector = [(xPrime[0] - cPrime[0]) / rx, (xPrime[1] - cPrime[1]) / ry];
            var x2UnitVector = [(-1.0 * xPrime[0] - cPrime[0]) / rx, (-1.0 * xPrime[1] - cPrime[1]) / ry];
            var theta = angle([1, 0], x1UnitVector); // F.6.5.5

            var deltaTheta = angle(x1UnitVector, x2UnitVector); // F.6.5.6

            var start = theta;
            var end = theta + deltaTheta;
            ctx.save();
            ctx.translate(c[0], c[1]);
            ctx.rotate(phi);
            ctx.scale(rx, ry);
            ctx.arc(0, 0, 1, start, end, !fS);
            ctx.restore();
          }

          var PathCommands = function PathCommands(ctx) {
            var _this103 = this;

            _classCallCheck(this, PathCommands);

            var lMx;
            var lMy;
            var lx = 0;
            var ly = 0;
            var reflected;
            var lastCommand = "";

            function makeReflected() {
              if ("CcSsQqTt".indexOf(lastCommand) < 0) {
                return {
                  x: lx,
                  y: ly
                };
              }

              return reflected;
            }

            this.M = function (px, py) {
              ctx.moveTo(px, py);
              lMx = px;
              lMy = py;
              lx = px;
              ly = py;
              lastCommand = "M";
              return _this103;
            };

            this.m = function (px, py) {
              return _this103.M(px + lx, py + ly);
            };

            this.L = function (px, py) {
              ctx.lineTo(px, py);
              lx = px;
              ly = py;
              lastCommand = "L";
              return _this103;
            };

            this.l = function (px, py) {
              return _this103.L(px + lx, py + ly);
            };

            this.H = function (px) {
              return _this103.L(px, ly);
            };

            this.h = function (px) {
              return _this103.H(px + lx);
            };

            this.V = function (py) {
              return _this103.L(lx, py);
            };

            this.v = function (py) {
              return _this103.V(py + ly);
            };

            this.Z = function () {
              ctx.closePath();
              lx = lMx;
              ly = lMy;
              lastCommand = "Z";
              return _this103;
            };

            this.z = function () {
              return _this103.Z();
            }; //C x1 y1, x2 y2, x y (or c dx1 dy1, dx2 dy2, dx dy)


            this.C = function (cp1x, cp1y, cp2x, cp2y, px, py) {
              ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, px, py);
              lx = px;
              ly = py;
              reflected = {
                x: 2 * px - cp2x,
                y: 2 * py - cp2y
              };
              lastCommand = "C";
              return _this103;
            };

            this.c = function (cp1x, cp1y, cp2x, cp2y, px, py) {
              return _this103.C(cp1x + lx, cp1y + ly, cp2x + lx, cp2y + ly, px + lx, py + ly);
            }; //S x2 y2, x y (or s dx2 dy2, dx dy)


            this.S = function (cpx, cpy, px, py) {
              var _makeReflected = makeReflected(),
                  cp1x = _makeReflected.x,
                  cp1y = _makeReflected.y;

              return _this103.C(cp1x, cp1y, cpx, cpy, px, py);
            };

            this.s = function (cpx, cpy, px, py) {
              return _this103.S(cpx + lx, cpy + ly, px + lx, py + ly);
            }; //Q x1 y1, x y (or q dx1 dy1, dx dy)


            this.Q = function (cpx, cpy, px, py) {
              ctx.quadraticCurveTo(cpx, cpy, px, py);
              lx = px;
              ly = py;
              reflected = {
                x: 2 * px - cpx,
                y: 2 * py - cpy
              };
              lastCommand = "Q";
              return _this103;
            };

            this.q = function (cpx, cpy, px, py) {
              return _this103.Q(cpx + lx, cpy + ly, px + lx, py + ly);
            }; //T x y (or t dx dy)


            this.T = function (px, py) {
              var _makeReflected2 = makeReflected(),
                  cpx = _makeReflected2.x,
                  cpy = _makeReflected2.y;

              return _this103.Q(cpx, cpy, px, py);
            };

            this.t = function (px, py) {
              return _this103.T(px + lx, py + ly);
            }; //A rx ry x-axis-rotation large-arc-flag sweep-flag x y


            this.A = function (rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py) {
              var x1 = lx;
              var y1 = ly;
              ellipseFromEllipticalArc(ctx, x1, y1, rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py);
              lx = px;
              ly = py;
              lastCommand = "A";
              return _this103;
            }; //a rx ry x-axis-rotation large-arc-flag sweep-flag dx dy


            this.a = function (rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py) {
              return _this103.A(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px + lx, py + ly);
            };
          };

          exports.PathCommands = PathCommands;
          /***/
        },

        /***/
        "./internal/legacy/canvas/PathCommandsParser.js":
        /*!******************************************************!*\
          !*** ./internal/legacy/canvas/PathCommandsParser.js ***!
          \******************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalLegacyCanvasPathCommandsParserJs(module, exports, __nested_webpack_require_938892__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.PathCommandsParser = void 0;

          var PathCommands_1 = __nested_webpack_require_938892__(
          /*! ./PathCommands */
          "./internal/legacy/canvas/PathCommands.js");

          function pathTokens(d) {
            var idx = 0;
            return {
              next: function next() {
                var s = "";

                while (d.length > idx) {
                  var c = d[idx];
                  idx++;

                  if (" ,\n\r\t".indexOf(c) > -1) {
                    if (s) {
                      return s;
                    }
                  } else {
                    var type = ".+-1234567890".indexOf(c) > -1 ? "num" : "str";

                    if (type === "str") {
                      if (s) {
                        idx--;
                        return s;
                      }

                      return c;
                    }

                    if ("-+".indexOf(c) > -1) {
                      if (s) {
                        idx--;
                        return s;
                      }
                    }

                    if (c === ".") {
                      if (s.indexOf(".") > -1) {
                        idx--;
                        return s;
                      }
                    }

                    s += c;
                  }
                }

                return s || null;
              }
            };
          }

          function command(builder, cmd, argsProvider) {
            if (cmd.toUpperCase() === "M" || cmd.toUpperCase() === "L" || cmd.toUpperCase() === "T") {
              builder.command(cmd, argsProvider.next(), argsProvider.next());
              return cmd === "M" ? "L" : cmd === "m" ? "l" : cmd;
            } else if (cmd.toUpperCase() === "H" || cmd.toUpperCase() === "V") {
              builder.command(cmd, argsProvider.next());
              return cmd;
            } else if (cmd.toUpperCase() === "Z") {
              builder.command(cmd);
              return cmd;
            } else if (cmd.toUpperCase() === "C") {
              builder.command(cmd, argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next());
              return cmd;
            } else if (cmd.toUpperCase() === "S" || cmd.toUpperCase() === "Q") {
              builder.command(cmd, argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next());
              return cmd;
            } else if (cmd.toUpperCase() === "A") {
              builder.command(cmd, argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next());
              return cmd;
            } else {
              // https://developer.mozilla.org/ja/docs/Web/SVG/Tutorial/Paths
              console.warn("unsupported:".concat(cmd));
            }

            return null;
          }

          var PathCommandsParser = /*#__PURE__*/function () {
            function PathCommandsParser() {
              var _this104 = this;

              _classCallCheck(this, PathCommandsParser);

              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              this._ops = [];
              this._commands = new PathCommands_1.PathCommands(this);

              var buildPush = function buildPush(op) {
                return (// eslint-disable-next-line @typescript-eslint/no-explicit-any
                  function () {
                    for (var _len21 = arguments.length, args = new Array(_len21), _key21 = 0; _key21 < _len21; _key21++) {
                      args[_key21] = arguments[_key21];
                    }

                    _this104._ops.push({
                      op: op,
                      args: args
                    });
                  }
                );
              };

              this.moveTo = buildPush("moveTo");
              this.lineTo = buildPush("lineTo");
              this.closePath = buildPush("closePath");
              this.bezierCurveTo = buildPush("bezierCurveTo");
              this.quadraticCurveTo = buildPush("quadraticCurveTo");
              this.save = buildPush("save");
              this.translate = buildPush("translate");
              this.rotate = buildPush("rotate");
              this.scale = buildPush("scale");
              this.arc = buildPush("arc");
              this.restore = buildPush("restore");
              this.arcTo = buildPush("arcTo");
              this.ellipse = buildPush("ellipse");
              this.rect = buildPush("rect");
            } // eslint-disable-next-line @typescript-eslint/no-explicit-any


            _createClass(PathCommandsParser, [{
              key: "command",
              value: function command(name) {
                for (var _len22 = arguments.length, args = new Array(_len22 > 1 ? _len22 - 1 : 0), _key22 = 1; _key22 < _len22; _key22++) {
                  args[_key22 - 1] = arguments[_key22];
                }

                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                var numArgs = args || [];

                for (var i = 0; i < args.length; i++) {
                  numArgs[i] -= 0;
                }

                var command = this._commands[name]; // eslint-disable-next-line @typescript-eslint/no-explicit-any

                command.apply(this, numArgs);
              } // eslint-disable-next-line @typescript-eslint/no-explicit-any

            }, {
              key: "parse",
              value: function parse(d) {
                var _this105 = this;

                var ops = this._ops = [];
                var tokens = pathTokens(d);

                try {
                  (function () {
                    var cmd;
                    var subsequentCommand = "Z";

                    while (cmd = tokens.next()) {
                      if (!isNaN(Number(cmd))) {
                        (function () {
                          var fst = true;
                          var argsProvider = {
                            next: function next() {
                              if (fst) {
                                fst = false;
                                return cmd;
                              }

                              return tokens.next();
                            }
                          };
                          subsequentCommand = command(_this105, subsequentCommand, argsProvider) || "Z";
                        })();
                      } else {
                        subsequentCommand = command(_this105, cmd, tokens) || "Z";
                      }
                    }
                  })();
                } catch (e) {
                  console.log("Error: ".concat(d));
                  throw e;
                }

                return ops;
              }
            }]);

            return PathCommandsParser;
          }();

          exports.PathCommandsParser = PathCommandsParser;
          /***/
        },

        /***/
        "./internal/legacy/fontwatch/FontRuler.js":
        /*!************************************************!*\
          !*** ./internal/legacy/fontwatch/FontRuler.js ***!
          \************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalLegacyFontwatchFontRulerJs(module, exports, __webpack_require__) {
          "use strict"; //see https://github.com/typekit/webfontloader

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.FontRuler = void 0;

          function computeStyle(font) {
            return [{
              display: "block",
              position: "absolute",
              top: "-9999px",
              left: "-9999px",
              width: "auto",
              height: "auto",
              margin: "0",
              padding: "0",
              "white-space": "nowrap",
              font: font
            }, {
              "font-variant": "normal",
              "font-size": "300px",
              "font-style": "normal",
              "font-weight": "400",
              "line-height": "normal"
            }];
          }

          var FontRuler = /*#__PURE__*/function () {
            function FontRuler(font, testStr) {
              _classCallCheck(this, FontRuler);

              var e = document.createElement("span");
              e.setAttribute("aria-hidden", "true");
              e.textContent = testStr || "BESbswy";
              computeStyle(font).forEach(function (style) {
                for (var k in style) {
                  var key = k; // eslint-disable-next-line @typescript-eslint/no-explicit-any

                  e.style[key] = style[key];
                }
              });
              document.body.appendChild(e);
              this.el_ = e;
            }

            _createClass(FontRuler, [{
              key: "getWidth",
              value: function getWidth() {
                return this.el_.offsetWidth;
              }
            }, {
              key: "remove",
              value: function remove() {
                document.body.removeChild(this.el_);
              }
            }]);

            return FontRuler;
          }();

          exports.FontRuler = FontRuler;
          /***/
        },

        /***/
        "./internal/legacy/fontwatch/FontWatchRunner.js":
        /*!******************************************************!*\
          !*** ./internal/legacy/fontwatch/FontWatchRunner.js ***!
          \******************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalLegacyFontwatchFontWatchRunnerJs(module, exports, __nested_webpack_require_948989__) {
          "use strict"; //see https://github.com/typekit/webfontloader
          //http://defghi1977.html.xdomain.jp/tech/canvasMemo/canvasMemo.htm

          var FontRuler_1 = __nested_webpack_require_948989__(
          /*! ./FontRuler */
          "./internal/legacy/fontwatch/FontRuler.js");

          var LastResortFonts = {
            SERIF: "serif",
            SANS_SERIF: "sans-serif"
          };
          var watchRunners = {};

          var FontWatchRunner = /*#__PURE__*/function () {
            function FontWatchRunner(font, testStr) {
              _classCallCheck(this, FontWatchRunner);

              this.activeCallbacks = [];
              this.inactiveCallbacks = [];
              this.status = null;
              this.lastResortWidths_ = {};
              this.fontRulerA_ = new FontRuler_1.FontRuler("".concat(font, ",").concat(LastResortFonts.SERIF), testStr);
              this.fontRulerB_ = new FontRuler_1.FontRuler("".concat(font, ",").concat(LastResortFonts.SANS_SERIF), testStr);
              var lastResortRulerA = new FontRuler_1.FontRuler("4px ".concat(LastResortFonts.SERIF), testStr);
              var lastResortRulerB = new FontRuler_1.FontRuler("4px ".concat(LastResortFonts.SANS_SERIF), testStr); //start

              this.lastResortWidths_[LastResortFonts.SERIF] = lastResortRulerA.getWidth();
              this.lastResortWidths_[LastResortFonts.SANS_SERIF] = lastResortRulerB.getWidth();
              lastResortRulerA.remove();
              lastResortRulerB.remove();
              this.started_ = Date.now();
              this.check_();
            }

            _createClass(FontWatchRunner, [{
              key: "then",
              value: function then(activeCallback, inactiveCallback) {
                if (this.status) {
                  if (this.status !== "ng") {
                    activeCallback();
                  } else {
                    inactiveCallback();
                  }
                } else {
                  this.activeCallbacks.push(activeCallback);
                  this.inactiveCallbacks.push(inactiveCallback);
                }
              }
            }, {
              key: "check_",
              value: function check_() {
                var _this106 = this;

                var widthA = this.fontRulerA_.getWidth();
                var widthB = this.fontRulerB_.getWidth();

                if (this.isFallbackFont_(widthA, widthB) || this.isLastResortFont_(widthA, widthB)) {
                  if (Date.now() - this.started_ >= 3000) {
                    // timeout
                    if (this.isLastResortFont_(widthA, widthB)) {
                      this.finish_(this.activeCallbacks);
                      this.status = "ok";
                    } else {
                      this.finish_(this.inactiveCallbacks);
                      this.status = "ng";
                    }
                  } else {
                    setTimeout(function () {
                      _this106.check_();
                    }, 50);
                  }
                } else {
                  this.finish_(this.activeCallbacks);
                  this.status = "ok";
                }
              }
            }, {
              key: "isFallbackFont_",
              value: function isFallbackFont_(a, b) {
                return this.widthMatches_(a, LastResortFonts.SERIF) && this.widthMatches_(b, LastResortFonts.SANS_SERIF);
              }
            }, {
              key: "widthsMatchLastResortWidths_",
              value: function widthsMatchLastResortWidths_(a, b) {
                for (var font in LastResortFonts) {
                  if (LastResortFonts.hasOwnProperty(font)) {
                    if (this.widthMatches_(a, LastResortFonts[font]) && this.widthMatches_(b, LastResortFonts[font])) {
                      return true;
                    }
                  }
                }

                return false;
              }
            }, {
              key: "widthMatches_",
              value: function widthMatches_(width, lastResortFont) {
                return width === this.lastResortWidths_[lastResortFont];
              }
            }, {
              key: "isLastResortFont_",
              value: function isLastResortFont_(a, b) {
                return hasWebKitFallbackBug() && this.widthsMatchLastResortWidths_(a, b);
              }
            }, {
              key: "finish_",
              value: function finish_(callbacks) {
                var _this107 = this;

                setTimeout(function () {
                  _this107.fontRulerA_.remove();

                  _this107.fontRulerB_.remove();

                  callbacks.forEach(function (cb) {
                    return cb();
                  });
                }, 0);
              }
            }], [{
              key: "load",
              value: function load(font, testStr, activeCallback, inactiveCallback) {
                var c = watchRunners[font] || (watchRunners[font] = {});
                testStr += "";
                var runner;

                if (c[testStr]) {
                  runner = c[testStr];
                } else {
                  runner = c[testStr] = new FontWatchRunner(font, testStr);
                }

                runner.then(activeCallback, inactiveCallback);
              }
            }]);

            return FontWatchRunner;
          }();

          var HAS_WEBKIT_FALLBACK_BUG = null;

          function hasWebKitFallbackBug() {
            if (HAS_WEBKIT_FALLBACK_BUG === null) {
              var match = /AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);
              HAS_WEBKIT_FALLBACK_BUG = !!match && (parseInt(match[1], 10) < 536 || parseInt(match[1], 10) === 536 && parseInt(match[2], 10) <= 11);
            }

            return HAS_WEBKIT_FALLBACK_BUG;
          }

          module.exports = FontWatchRunner;
          /***/
        },

        /***/
        "./internal/menu-items.js":
        /*!********************************!*\
          !*** ./internal/menu-items.js ***!
          \********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalMenuItemsJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.normalizeToFn = exports.normalize = void 0;
          /** @private */

          function extend(a, b) {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            var o = {};

            for (var k in a) {
              o[k] = a[k];
            }

            for (var _k3 in b) {
              o[_k3] = b[_k3];
            }

            return o;
          }
          /**
           * Normalize the given menu options.
           * @param {*} options menu options to given
           * @returns {Array} Normalized options
           * @private
           */


          function normalize(options) {
            if (!options) {
              return [];
            }

            if (Array.isArray(options)) {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              return options.map( // eslint-disable-next-line @typescript-eslint/no-explicit-any
              function (e) {
                return extend(e, {
                  label: e.caption || e.label
                });
              });
            }

            if (typeof options === "string") {
              return normalize(JSON.parse(options));
            }

            var result = [];

            for (var k in options) {
              result.push({
                value: k,
                label: options[k]
              });
            }

            return result;
          }

          exports.normalize = normalize;
          /**
           * Normalize the given menu options.
           * @param {*} options menu options to given
           * @returns {Array} Normalized options
           * @private
           */

          function normalizeToFn(options) {
            if (typeof options === "function") {
              return function (record) {
                return normalize(options(record));
              };
            }

            return function () {
              return normalize(options);
            };
          }

          exports.normalizeToFn = normalizeToFn;
          /***/
        },

        /***/
        "./internal/paste-utils.js":
        /*!*********************************!*\
          !*** ./internal/paste-utils.js ***!
          \*********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalPasteUtilsJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.parsePasteRangeBoxValues = exports.normalizePasteValue = void 0;

          function normalizePasteValue(text) {
            return text[text.length - 1] !== "\n" ? text : text[text.length - 2] === "\r" ? text.slice(0, -2) : text.slice(0, -1);
          }

          exports.normalizePasteValue = normalizePasteValue;

          function parsePasteRangeBoxValues(value, option) {
            var normalizedValue = normalizePasteValue(value);

            var _parseValues = parseValues(normalizedValue, option),
                values = _parseValues.values,
                colCount = _parseValues.colCount;

            return {
              colCount: colCount,
              rowCount: values.length,
              getCellValue: function getCellValue(offsetCol, offsetRow) {
                var _a, _b;

                return (_b = (_a = values[offsetRow]) === null || _a === void 0 ? void 0 : _a[offsetCol]) !== null && _b !== void 0 ? _b : "";
              }
            };
          }

          exports.parsePasteRangeBoxValues = parsePasteRangeBoxValues;

          function parseValues(text, _ref84) {
            var trimOnPaste = _ref84.trimOnPaste;
            var len = text.length;
            var adjustCell = trimOnPaste ? function (cell) {
              return cell.trim();
            } : function (cell) {
              return cell;
            };
            var colCount = 1;
            var line = [];
            var values = [line];
            var cell = "";

            for (var index = 0; index < len; index++) {
              var char = text[index];

              if (char === "\t") {
                line.push(adjustCell(cell));
                cell = "";
                continue;
              }

              if (char === "\n") {
                // End of line
                cell = adjustCell(cell);

                if (cell[cell.length - 1] === "\r") {
                  cell = cell.slice(0, -1);
                }

                line.push(cell);
                colCount = Math.max(colCount, line.length);
                line = [];
                values.push(line);
                cell = "";
                continue;
              }

              if (char === '"' && !cell.trim()) {
                var quoted = processQuotedCell(index + 1);

                if (quoted) {
                  cell = quoted.cell;
                  index = quoted.next - 1;
                  continue;
                }
              }

              cell += char;
            } // End of text


            line.push(adjustCell(cell));
            colCount = Math.max(colCount, line.length);
            return {
              values: values,
              colCount: colCount
            };

            function processQuotedCell(start) {
              var cell = "";
              var index = start;

              while (index < len) {
                var _char = text[index];

                if (_char !== '"') {
                  cell += _char;
                  index++;
                  continue;
                }

                if (text[index + 1] === '"') {
                  // Escape
                  cell += '"';
                  index += 2;
                  continue;
                } // Maybe end quote


                var next = index + 1;

                while (next < len) {
                  var c = text[next];

                  if (c.trim()) {
                    // Not quoted. e.g. "A"B
                    return null;
                  }

                  if (c === "\t" || c === "\n") {
                    break;
                  } // Allow spaces


                  next++;
                } // End quote


                return {
                  cell: cell,
                  next: next
                };
              }

              return null;
            }
          }
          /***/

        },

        /***/
        "./internal/path2DManager.js":
        /*!***********************************!*\
          !*** ./internal/path2DManager.js ***!
          \***********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalPath2DManagerJs(module, exports, __nested_webpack_require_962373__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.fill = exports.getPath2D = void 0;

          var utils_1 = __nested_webpack_require_962373__(
          /*! ./utils */
          "./internal/utils.js");

          function getPath2D() {
            if (typeof Path2D !== "undefined" && !utils_1.browser.Edge) {
              return Path2D;
            } // eslint-disable-next-line @typescript-eslint/no-var-requires


            return __nested_webpack_require_962373__(
            /*! ./legacy/canvas/Path2DShim */
            "./internal/legacy/canvas/Path2DShim.js").Path2DShim;
          }

          exports.getPath2D = getPath2D;

          function fill(pathModule, ctx, x, y, w, h) {
            ctx.save();

            try {
              var width = pathModule.width,
                  height = pathModule.height;
              var upsideDown = pathModule.ud,
                  _pathModule$x = pathModule.x,
                  offsetX = _pathModule$x === void 0 ? 0 : _pathModule$x,
                  _pathModule$y = pathModule.y,
                  offsetY = _pathModule$y === void 0 ? 0 : _pathModule$y;
              w = w || width;
              h = h || height;
              var xrate = w / width;
              var yrate = h / (upsideDown ? -height : height);
              x = x || 0;
              y = upsideDown ? (y || 0) + -height * yrate : y || 0;
              ctx.translate(x, y);
              ctx.scale(xrate, yrate);

              if (offsetX !== 0 || offsetY !== 0) {
                ctx.translate(offsetX, offsetY);
              }

              var _Path2D = getPath2D();

              var path2d = pathModule.path2d = pathModule.path2d || new _Path2D(pathModule.d);
              ctx.fill(path2d);
            } finally {
              ctx.restore();
            }
          }

          exports.fill = fill;
          /***/
        },

        /***/
        "./internal/sort.js":
        /*!**************************!*\
          !*** ./internal/sort.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalSortJs(module, exports, __nested_webpack_require_964678__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.sortPromise = exports.sort = exports.sortArray = void 0;

          var utils_1 = __nested_webpack_require_964678__(
          /*! ./utils */
          "./internal/utils.js");

          function createArray(get, length) {
            var array = new Array(length);

            for (var i = 0; i < length; i++) {
              array[i] = get(i);
            }

            return array;
          }

          function createArrayPromise(get, getField, length // eslint-disable-next-line @typescript-eslint/no-explicit-any
          ) {
            return new Promise(function (resolve) {
              var plist = [];
              var array = new Array(length);

              var _loop7 = function _loop7(i) {
                var data = get(i);
                var record = {
                  v: data,
                  f: data
                };
                array[i] = record;

                if ((0, utils_1.isPromise)(data)) {
                  plist.push(data.then(function (v) {
                    record.v = v;
                    record.f = v;
                  }));
                }
              };

              for (var i = 0; i < length; i++) {
                _loop7(i);
              }

              Promise.all(plist).then(function () {
                return getField == null ? // eslint-disable-next-line @typescript-eslint/no-explicit-any
                array : // eslint-disable-next-line @typescript-eslint/no-explicit-any
                setArrayField(array, getField);
              }).then(resolve);
            });
          }

          function setArrayField(array, getField) {
            return new Promise(function (resolve) {
              var length = array.length;
              var plist = [];

              var _loop8 = function _loop8(i) {
                var record = array[i];
                var f = getField(record.v);

                if ((0, utils_1.isPromise)(f)) {
                  plist.push(f.then(function (v) {
                    record.f = v;
                  }));
                } else {
                  record.f = f;
                }
              };

              for (var i = 0; i < length; i++) {
                _loop8(i);
              }

              Promise.all(plist).then(function () {
                return resolve(array);
              });
            });
          }

          function sortArray(array, compare) {
            Array.prototype.sort.call(array, compare);
          }

          exports.sortArray = sortArray;

          function sort(get, set, length, compare, getField) {
            var old = createArray(get, length);

            if (getField != null) {
              old.sort(function (r1, r2) {
                return compare(getField(r1), getField(r2));
              });
            } else {
              old.sort(compare);
            }

            for (var i = 0; i < length; i++) {
              set(i, old[i]);
            }
          }

          exports.sort = sort;

          function sortPromise(get, set, length, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          compare, // eslint-disable-next-line @typescript-eslint/no-explicit-any
          getField) {
            if (typeof Promise !== "undefined") {
              return createArrayPromise(get, getField, length).then(function (array) {
                array.sort(function (r1, r2) {
                  return compare(r1.f, r2.f);
                });

                for (var i = 0; i < length; i++) {
                  set(i, array[i].v);
                }
              });
            } else {
              sort(get, set, length, compare, getField);
              var dummyPromise = {
                then: function then(fn) {
                  fn();
                  return dummyPromise;
                },
                catch: function _catch() {
                  return dummyPromise;
                } // eslint-disable-next-line @typescript-eslint/no-explicit-any

              };
              return dummyPromise;
            }
          }

          exports.sortPromise = sortPromise;
          /***/
        },

        /***/
        "./internal/style.js":
        /*!***************************!*\
          !*** ./internal/style.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalStyleJs(module, exports, __nested_webpack_require_969309__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.getScrollBarSize = exports.initDocument = void 0;

          function getScrollBarWidth() {
            var wrapper = document.createElement("div");
            var inner = document.createElement("div");
            var wrapperStyle = wrapper.style;
            wrapperStyle.position = "fixed";
            wrapperStyle.height = "50px";
            wrapperStyle.width = "50px";
            wrapperStyle.overflow = "scroll";
            wrapperStyle.opacity = "0";
            wrapperStyle.pointerEvents = "none";
            var style = inner.style;
            style.height = "100%";
            style.width = "100%";
            inner.textContent = "x";
            wrapper.appendChild(inner);
            document.body.appendChild(wrapper);
            var wrapperWidth = wrapper.getBoundingClientRect().width;
            var innerWidth = inner.getBoundingClientRect().width;
            document.body.removeChild(wrapper);
            return Math.ceil(wrapperWidth - innerWidth);
          }

          var SCROLLBAR_SIZE;

          function initDocumentInternal() {
            __nested_webpack_require_969309__(
            /*! @/internal/style.css */
            "../src/js/internal/style.css");

            SCROLLBAR_SIZE = getScrollBarWidth() || 10;
            var style = document.createElement("style");
            style.setAttribute("type", "text/css");
            style.setAttribute("data-name", "cheetah-grid");
            style.innerHTML = "\n.cheetah-grid .grid-scroll-end-point {\n\twidth: ".concat(SCROLLBAR_SIZE, "px;\n\theight: ").concat(SCROLLBAR_SIZE, "px;\n}\n.cheetah-grid > canvas {\n\twidth: -webkit-calc(100% - ").concat(SCROLLBAR_SIZE, "px);\n\twidth: calc(100% - ").concat(SCROLLBAR_SIZE, "px);\n\theight: -webkit-calc(100% - ").concat(SCROLLBAR_SIZE, "px);\n\theight: calc(100% - ").concat(SCROLLBAR_SIZE, "px);\n}\n\t\t");
            document.head.appendChild(style);
          }

          var initDocumentVar = initDocumentInternal;

          function initDocument() {
            initDocumentVar();
            initDocumentVar = Function.prototype;
          }

          exports.initDocument = initDocument;

          function getScrollBarSize() {
            return SCROLLBAR_SIZE;
          }

          exports.getScrollBarSize = getScrollBarSize;
          /***/
        },

        /***/
        "./internal/symbolManager.js":
        /*!***********************************!*\
          !*** ./internal/symbolManager.js ***!
          \***********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalSymbolManagerJs(module, exports, __nested_webpack_require_972172__) {
          "use strict";
          /* WEBPACK VAR INJECTION */

          (function (global) {
            Object.defineProperty(exports, "__esModule", {
              value: true
            });
            exports.getCheckHeaderStateId = exports.getInlineMenuEditorStateId = exports.getInlineInputEditorStateId = exports.getSmallDialogInputEditorStateId = exports.getTreeColumnStateId = exports.getBranchGraphColumnStateId = exports.getColumnFadeinStateId = exports.getButtonColumnStateId = exports.getRadioColumnStateId = exports.getCheckColumnStateId = exports.getProtectedSymbol = exports.get = void 0;
            /* eslint-disable @typescript-eslint/no-explicit-any */

            var utils_1 = __nested_webpack_require_972172__(
            /*! ./utils */
            "./internal/utils.js");

            var _Symbol = utils_1.isNode ? global.Symbol : window.Symbol ? window.Symbol : function () {
              function random() {
                var c = "abcdefghijklmnopqrstuvwxyz0123456789";
                var cl = c.length;
                var r = "";

                for (var i = 0; i < 10; i++) {
                  r += c[Math.floor(Math.random() * cl)];
                }

                return r;
              }

              return function (name) {
                if (name) {
                  return "#".concat(name, "_").concat(random());
                } else {
                  return "#_".concat(random());
                }
              };
            }();

            var mem = {};

            function get(name) {
              if (name) {
                return mem[name] ? mem[name] : mem[name] = _Symbol(name);
              } else {
                return _Symbol();
              }
            }

            exports.get = get;

            function getProtectedSymbol() {
              return get("protected");
            }

            exports.getProtectedSymbol = getProtectedSymbol;

            function getCheckColumnStateId() {
              return get("chkcol.stateID");
            }

            exports.getCheckColumnStateId = getCheckColumnStateId;

            function getRadioColumnStateId() {
              return get("rdcol.stateID");
            }

            exports.getRadioColumnStateId = getRadioColumnStateId;

            function getButtonColumnStateId() {
              return get("btncol.stateID");
            }

            exports.getButtonColumnStateId = getButtonColumnStateId;

            function getColumnFadeinStateId() {
              return get("col.fadein_stateID");
            }

            exports.getColumnFadeinStateId = getColumnFadeinStateId;

            function getBranchGraphColumnStateId() {
              return get("branch_graph_col.stateID");
            }

            exports.getBranchGraphColumnStateId = getBranchGraphColumnStateId;

            function getTreeColumnStateId() {
              return get("tree_col.stateID");
            }

            exports.getTreeColumnStateId = getTreeColumnStateId;

            function getSmallDialogInputEditorStateId() {
              return get("small_dialog_input_editor.stateID");
            }

            exports.getSmallDialogInputEditorStateId = getSmallDialogInputEditorStateId;

            function getInlineInputEditorStateId() {
              return get("inline_input_editor.stateID");
            }

            exports.getInlineInputEditorStateId = getInlineInputEditorStateId;

            function getInlineMenuEditorStateId() {
              return get("inline_menu_editor.stateID");
            }

            exports.getInlineMenuEditorStateId = getInlineMenuEditorStateId;

            function getCheckHeaderStateId() {
              return get("check_header.stateID");
            }

            exports.getCheckHeaderStateId = getCheckHeaderStateId;
            /* WEBPACK VAR INJECTION */
          }).call(this, __nested_webpack_require_972172__(
          /*! ./../../node_modules/webpack/buildin/global.js */
          "../node_modules/webpack/buildin/global.js"));
          /***/
        },

        /***/
        "./internal/utils.js":
        /*!***************************!*\
          !*** ./internal/utils.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function internalUtilsJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.emptyFn = exports.style = exports.event = exports.str = exports.obj = exports.browser = exports.cellInRange = exports.cellEquals = exports.array = exports.then = exports.getIgnoreCase = exports.getOrApply = exports.applyChainSafe = exports.getChainSafe = exports.isDescendantElement = exports.isNode = exports.isPromise = exports.extend = exports.defaults = exports.omit = exports.each = void 0;
          var isNode = typeof window === "undefined" || typeof window.window === "undefined";
          exports.isNode = isNode;
          var arrayFind;
          var arrayFindIndex;
          var array = {
            get find() {
              if (arrayFind) {
                return arrayFind;
              }

              if (Array.prototype.find) {
                arrayFind = function arrayFind(arr, predicate) {
                  return Array.prototype.find.call(arr, predicate);
                };
              } else {
                arrayFind = function arrayFind(arr, predicate) {
                  var index = array.findIndex(arr, predicate);
                  return index >= 0 ? arr[index] : undefined;
                };
              }

              return arrayFind;
            },

            get findIndex() {
              if (arrayFindIndex) {
                return arrayFindIndex;
              }

              if (Array.prototype.findIndex) {
                arrayFindIndex = function arrayFindIndex(arr, predicate) {
                  return Array.prototype.findIndex.call(arr, predicate);
                };
              } else {
                arrayFindIndex = function arrayFindIndex(arr, predicate) {
                  var length = arr.length;

                  for (var i = 0; i < length; i++) {
                    var value = arr[i];

                    if (predicate(value, i, arr)) {
                      return i;
                    }
                  }

                  return -1;
                };
              }

              return arrayFindIndex;
            }

          };
          exports.array = array;

          function analyzeUserAgent() {
            if (isNode) {
              return {
                IE: false,
                Edge: false,
                Chrome: false,
                Firefox: false,
                Safari: false
              };
            } else {
              var ua = window.navigator.userAgent.toLowerCase();
              return {
                IE: !!/(msie|trident)/.exec(ua),
                Edge: ua.indexOf("edge") > -1,
                Chrome: ua.indexOf("chrome") > -1 && ua.indexOf("edge") === -1,
                Firefox: ua.indexOf("firefox") > -1,
                Safari: ua.indexOf("safari") > -1 && ua.indexOf("edge") === -1
              };
            }
          }

          var _analyzeUserAgent = analyzeUserAgent(),
              IE = _analyzeUserAgent.IE,
              Chrome = _analyzeUserAgent.Chrome,
              Firefox = _analyzeUserAgent.Firefox,
              Edge = _analyzeUserAgent.Edge,
              Safari = _analyzeUserAgent.Safari;

          function setReadonly(obj, name, value) {
            Object.defineProperty(obj, name, {
              enumerable: false,
              configurable: true,
              value: value
            });
          } // eslint-disable-next-line @typescript-eslint/no-explicit-any


          function each(obj, fn) {
            for (var key in obj) {
              fn(obj[key], key, obj);
            }
          }

          exports.each = each; // eslint-disable-next-line @typescript-eslint/no-explicit-any

          function isObject(obj) {
            return obj === Object(obj);
          }

          function omit(source, omits) {
            var result = {};

            var _loop9 = function _loop9(key) {
              if (omits.indexOf(key) >= 0) {
                return "continue";
              }

              Object.defineProperty(result, key, {
                get: function get() {
                  return source[key];
                },
                set: function set(val) {
                  source[key] = val;
                },
                configurable: true,
                enumerable: true
              });
            };

            for (var key in source) {
              var _ret2 = _loop9(key);

              if (_ret2 === "continue") continue;
            }

            return result;
          }

          exports.omit = omit;

          function defaults(source, defs) {
            var keys = [];
            var result = {};

            var _loop10 = function _loop10(key) {
              keys.push(key);
              Object.defineProperty(result, key, {
                get: function get() {
                  var val = source[key];
                  return val === undefined ? defs[key] : val;
                },
                set: function set(val) {
                  source[key] = val;
                },
                configurable: true,
                enumerable: true
              });
            };

            for (var key in source) {
              _loop10(key);
            }

            var _loop11 = function _loop11(_key23) {
              if (keys.indexOf(_key23) >= 0) {
                return "continue";
              }

              Object.defineProperty(result, _key23, {
                get: function get() {
                  var val = source[_key23];
                  return val === undefined ? defs[_key23] : val;
                },
                set: function set(val) {
                  source[_key23] = val;
                },
                configurable: true,
                enumerable: true
              });
            };

            for (var _key23 in defs) {
              var _ret3 = _loop11(_key23);

              if (_ret3 === "continue") continue;
            }

            return result;
          }

          exports.defaults = defaults;

          function extend() {
            var result = {};

            for (var _len23 = arguments.length, args = new Array(_len23), _key24 = 0; _key24 < _len23; _key24++) {
              args[_key24] = arguments[_key24];
            }

            args.forEach(function (source) {
              var _loop12 = function _loop12(key) {
                Object.defineProperty(result, key, {
                  get: function get() {
                    return source[key];
                  },
                  set: function set(val) {
                    source[key] = val;
                  },
                  configurable: true,
                  enumerable: true
                });
              };

              for (var key in source) {
                _loop12(key);
              }
            });
            return result;
          }

          exports.extend = extend;

          function isDescendantElement(root, target) {
            while (target.parentElement) {
              var p = target.parentElement;

              if (root === p) {
                return true;
              }

              target = p;
            }

            return false;
          }

          exports.isDescendantElement = isDescendantElement;
          /* eslint-disable @typescript-eslint/no-explicit-any */

          function applyChainSafe(obj, fn) {
            var value = obj;

            for (var i = 0; i < (arguments.length <= 2 ? 0 : arguments.length - 2) && value != null; i++) {
              value = fn(value, i + 2 < 2 || arguments.length <= i + 2 ? undefined : arguments[i + 2]);
            }

            return value;
          }

          exports.applyChainSafe = applyChainSafe;

          function getChainSafe(obj) {
            for (var _len24 = arguments.length, names = new Array(_len24 > 1 ? _len24 - 1 : 0), _key25 = 1; _key25 < _len24; _key25++) {
              names[_key25 - 1] = arguments[_key25];
            }

            return applyChainSafe.apply(void 0, [obj, function (val, name) {
              return val[name];
            }].concat(names));
          }

          exports.getChainSafe = getChainSafe;

          function getOrApply(value) {
            if (typeof value === "function") {
              for (var _len25 = arguments.length, args = new Array(_len25 > 1 ? _len25 - 1 : 0), _key26 = 1; _key26 < _len25; _key26++) {
                args[_key26 - 1] = arguments[_key26];
              }

              return value.apply(void 0, args);
            } else {
              return value;
            }
          }

          exports.getOrApply = getOrApply;
          /* eslint-enable @typescript-eslint/no-explicit-any */

          function endsWith(str, searchString, position) {
            var subjectString = str.toString();

            if (typeof position !== "number" || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {
              position = subjectString.length;
            }

            position -= searchString.length;
            var lastIndex = subjectString.lastIndexOf(searchString, position);
            return lastIndex !== -1 && lastIndex === position;
          }

          function genChars(s) {
            // Surrogate Code Point
            // [\uD800-\uDBFF]
            // Variation Selectors
            // FVS [\u180B-\u180D]
            // VS1～VS16 [\uFE00-\uFE0F]
            // VS17～VS256 \uDB40[\uDD00-\uDDEF]
            var re = /([\uD800-\uDBFF][\uDC00-\uDFFF]|\r\n|[^\uD800-\uDFFF])([\u180B-\u180D]|[\uFE00-\uFE0F]|\uDB40[\uDD00-\uDDEF])?/g;
            return {
              next: function next() {
                var res = re.exec(s);
                return res !== null ? res[0] : null;
              }
            };
          }

          function genWords(s) {
            var re = /[!-~]+|[^!-~\s]+|\s+/g;
            return {
              next: function next() {
                var res = re.exec(s);
                return res !== null ? res[0] : null;
              }
            };
          }

          function isPromise(data) {
            return Boolean(data && typeof data.then === "function");
          }

          exports.isPromise = isPromise;

          function then(result, callback) {
            return isPromise(result) ? result.then(function (r) {
              return callback(r);
            }) : callback(result);
          }

          exports.then = then;

          function getMouseButtons(e) {
            if (e.buttons != null) {
              return e.buttons;
            }
            /*for legacy*/


            if (e.which != null) {
              if (e.which === 3) {
                //right?
                return 4;
              }

              if (e.which === 2) {
                //middle?
                return 4;
              }

              return e.which; //left or no
            }

            if (e.button === 0 || e.button === 1) {
              return 1; //candidate left
            }

            if (e.button === 2) {
              return 2; // right
            }

            return 0; //no or middle?
          }

          function getKeyCode(e) {
            return e.keyCode || e.which;
          }

          function isTouchEvent(e) {
            return !!e.changedTouches;
          } // eslint-disable-next-line @typescript-eslint/no-explicit-any


          function getIgnoreCase(obj, name) {
            if (obj[name]) {
              return obj[name];
            }

            var l = name.toLowerCase();

            if (obj[l]) {
              return obj[l];
            }

            var u = name.toLowerCase();

            if (obj[u]) {
              return obj[u];
            }

            for (var k in obj) {
              if (k.toLowerCase() === l) {
                return obj[k];
              }
            }

            return undefined;
          }

          exports.getIgnoreCase = getIgnoreCase;

          function cancel(e) {
            e.preventDefault();
            e.stopPropagation();
          }

          function toBoxArray(obj) {
            if (!Array.isArray(obj)) {
              return [obj
              /*top*/
              , obj
              /*right*/
              , obj
              /*bottom*/
              , obj
              /*left*/
              ];
            }

            if (obj.length === 3) {
              return [obj[0]
              /*top*/
              , obj[1]
              /*right*/
              , obj[2]
              /*bottom*/
              , obj[1]
              /*left*/
              ];
            }

            if (obj.length === 2) {
              return [obj[0]
              /*top*/
              , obj[1]
              /*right*/
              , obj[0]
              /*bottom*/
              , obj[1]
              /*left*/
              ];
            }

            if (obj.length === 1) {
              return [obj[0]
              /*top*/
              , obj[0]
              /*right*/
              , obj[0]
              /*bottom*/
              , obj[0]
              /*left*/
              ];
            }

            return obj;
          }

          function cellEquals(a, b) {
            return a.col === b.col && a.row === b.row;
          }

          exports.cellEquals = cellEquals;

          function cellInRange(range, col, row) {
            return range.start.col <= col && col <= range.end.col && range.start.row <= row && row <= range.end.row;
          }

          exports.cellInRange = cellInRange;
          exports.browser = {
            IE: IE,
            Edge: Edge,
            Chrome: Chrome,
            Firefox: Firefox,
            Safari: Safari,
            // Chrome 16777216 (onl Chrome 33554431)
            // FireFox 17895588
            // IE 10737433
            heightLimit: Chrome ? 16777216 : Firefox ? 17895588 : 10737433 // default IE limit

          };
          exports.obj = {
            setReadonly: setReadonly,
            isObject: isObject
          };
          exports.str = {
            endsWith: endsWith,
            genChars: genChars,
            genWords: genWords
          };
          exports.event = {
            getMouseButtons: getMouseButtons,
            getKeyCode: getKeyCode,
            isTouchEvent: isTouchEvent,
            cancel: cancel
          };
          exports.style = {
            toBoxArray: toBoxArray
          };
          exports.emptyFn = Function.prototype;
          /***/
        },

        /***/
        "./list-grid/LG_EVENT_TYPE.js":
        /*!************************************!*\
          !*** ./list-grid/LG_EVENT_TYPE.js ***!
          \************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function listGridLG_EVENT_TYPEJs(module, exports, __nested_webpack_require_991574__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.LG_EVENT_TYPE = void 0;

          var DG_EVENT_TYPE_1 = __nested_webpack_require_991574__(
          /*! ../core/DG_EVENT_TYPE */
          "./core/DG_EVENT_TYPE.js");

          var utils_1 = __nested_webpack_require_991574__(
          /*! ../internal/utils */
          "./internal/utils.js");

          exports.LG_EVENT_TYPE = (0, utils_1.extend)(DG_EVENT_TYPE_1.DG_EVENT_TYPE, {
            BEFORE_CHANGE_VALUE: "before_change_value",
            CHANGED_VALUE: "changed_value",
            CHANGED_HEADER_VALUE: "changed_header_value",
            REJECTED_PASTE_VALUES: "rejected_paste_values"
          });
          /***/
        },

        /***/
        "./list-grid/layout-map/index.js":
        /*!***************************************!*\
          !*** ./list-grid/layout-map/index.js ***!
          \***************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function listGridLayoutMapIndexJs(module, exports, __nested_webpack_require_992761__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MultiLayoutMap = exports.SimpleHeaderLayoutMap = void 0;

          var simple_header_layout_1 = __nested_webpack_require_992761__(
          /*! ./internal/simple-header-layout */
          "./list-grid/layout-map/internal/simple-header-layout.js");

          Object.defineProperty(exports, "SimpleHeaderLayoutMap", {
            enumerable: true,
            get: function get() {
              return simple_header_layout_1.SimpleHeaderLayoutMap;
            }
          });

          var multi_layout_1 = __nested_webpack_require_992761__(
          /*! ./internal/multi-layout */
          "./list-grid/layout-map/internal/multi-layout.js");

          Object.defineProperty(exports, "MultiLayoutMap", {
            enumerable: true,
            get: function get() {
              return multi_layout_1.MultiLayoutMap;
            }
          });
          /***/
        },

        /***/
        "./list-grid/layout-map/internal/multi-layout.js":
        /*!*******************************************************!*\
          !*** ./list-grid/layout-map/internal/multi-layout.js ***!
          \*******************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function listGridLayoutMapInternalMultiLayoutJs(module, exports, __nested_webpack_require_994264__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.MultiLayoutMap = void 0;

          var columns = __importStar(__nested_webpack_require_994264__(
          /*! ../../../columns */
          "./columns.js"));

          var headerAction = __importStar(__nested_webpack_require_994264__(
          /*! ../../../header/action */
          "./header/action.js"));

          var headerType = __importStar(__nested_webpack_require_994264__(
          /*! ../../../header/type */
          "./header/type.js"));

          var utils_1 = __nested_webpack_require_994264__(
          /*! ./utils */
          "./list-grid/layout-map/internal/utils.js");

          function normalizeLayout(layout) {
            if (Array.isArray(layout)) {
              return {
                header: layout,
                body: layout
              };
            }

            return layout;
          }

          var seqId = 0;

          var LayoutObjectGrid = /*#__PURE__*/function () {
            function LayoutObjectGrid(layout, transform) {
              var _this108 = this;

              _classCallCheck(this, LayoutObjectGrid);

              this.objects = [];
              this.objectGrid = [];
              this.objectMap = {};
              this.columnCount = 0;
              this.columnWidths = [];
              layout.forEach(function (rowLayout, row) {
                var col = 0;
                rowLayout.forEach(function (cell) {
                  var _a, _b;

                  var id = seqId++;
                  var obj = transform(cell, id);

                  _this108.objects.push(obj);

                  _this108.objectMap[id] = obj;
                  col = _this108._findStartCell(col, row);
                  var rowSpan = Number((_a = cell.rowSpan) !== null && _a !== void 0 ? _a : 1);
                  var colSpan = Number((_b = cell.colSpan) !== null && _b !== void 0 ? _b : 1);
                  var endRow = row + rowSpan;
                  var endCol = col + colSpan;

                  for (var rowIndex = row; rowIndex < endRow; rowIndex++) {
                    var objectGridRow = _this108._getObjectGridRow(rowIndex);

                    for (var colIndex = col; colIndex < endCol; colIndex++) {
                      objectGridRow[colIndex] = obj;
                    }
                  }

                  if (colSpan === 1) {
                    _this108._setWidthDataIfAbsent(col, cell);
                  }

                  _this108._useColumnIndex(endCol - 1);

                  col = endCol;
                });
              });
            }

            _createClass(LayoutObjectGrid, [{
              key: "rowCount",
              get: function get() {
                return this.objectGrid.length;
              }
            }, {
              key: "_findStartCell",
              value: function _findStartCell(col, row) {
                var objectGridRow = this._getObjectGridRow(row);

                for (var index = col; index < objectGridRow.length; index++) {
                  if (!objectGridRow[index]) {
                    return index;
                  }
                }

                return objectGridRow.length;
              }
            }, {
              key: "_getObjectGridRow",
              value: function _getObjectGridRow(row) {
                return this.objectGrid[row] || (this.objectGrid[row] = []);
              }
            }, {
              key: "_useColumnIndex",
              value: function _useColumnIndex(col) {
                if (this.columnCount > col) {
                  return;
                }

                this.columnCount = col + 1;
              }
            }, {
              key: "_setWidthDataIfAbsent",
              value: function _setWidthDataIfAbsent(col, cell) {
                if (!this.columnWidths[col]) {
                  if (cell.width != null || cell.maxWidth != null || cell.minWidth != null) {
                    this.columnWidths[col] = {
                      width: cell.width,
                      maxWidth: cell.maxWidth,
                      minWidth: cell.minWidth
                    };
                  }
                }
              }
            }]);

            return LayoutObjectGrid;
          }();

          var MultiLayoutMap = /*#__PURE__*/function () {
            function MultiLayoutMap(layout) {
              _classCallCheck(this, MultiLayoutMap);

              this._columnWidths = [];
              this._emptyDataCache = new utils_1.EmptyDataCache();
              var hbLayouut = normalizeLayout(layout);
              var header = this._header = new LayoutObjectGrid(hbLayouut.header, function (hd, id) {
                return {
                  id: id,
                  caption: hd.caption,
                  field: hd.headerField || hd.field,
                  headerIcon: hd.headerIcon,
                  style: hd.headerStyle,
                  headerType: headerType.ofCell(hd),
                  action: headerAction.ofCell(hd),
                  define: hd
                };
              });
              var body = this._body = new LayoutObjectGrid(hbLayouut.body, function (colDef, id) {
                return {
                  id: id,
                  field: colDef.field,
                  width: colDef.width,
                  minWidth: colDef.minWidth,
                  maxWidth: colDef.maxWidth,
                  icon: colDef.icon,
                  message: colDef.message,
                  columnType: columns.type.of(colDef.columnType),
                  action: columns.action.of(colDef.action),
                  style: colDef.style,
                  define: colDef
                };
              });
              var columnCount = this._columnCount = Math.max(header.columnCount, body.columnCount);

              for (var col = 0; col < columnCount; col++) {
                var widthDef = header.columnWidths[col] || body.columnWidths[col] || {};
                this._columnWidths[col] = widthDef;
              }
            }

            _createClass(MultiLayoutMap, [{
              key: "columnWidths",
              get: function get() {
                return this._columnWidths;
              }
            }, {
              key: "headerRowCount",
              get: function get() {
                return this._header.rowCount;
              }
            }, {
              key: "bodyRowCount",
              get: function get() {
                return this._body.rowCount;
              }
            }, {
              key: "colCount",
              get: function get() {
                return this._columnCount;
              }
            }, {
              key: "headerObjects",
              get: function get() {
                return this._header.objects;
              }
            }, {
              key: "columnObjects",
              get: function get() {
                return this._body.objects;
              }
            }, {
              key: "getCellId",
              value: function getCellId(col, row) {
                var _a, _b, _c, _d;

                if (this.headerRowCount <= row) {
                  var bodyRow = row - this.headerRowCount;
                  var bodyLayoutRow = bodyRow % this.bodyRowCount;
                  return (_b = (_a = this._body.objectGrid[bodyLayoutRow]) === null || _a === void 0 ? void 0 : _a[col]) === null || _b === void 0 ? void 0 : _b.id;
                } //in header


                return (_d = (_c = this._header.objectGrid[row]) === null || _c === void 0 ? void 0 : _c[col]) === null || _d === void 0 ? void 0 : _d.id;
              }
            }, {
              key: "getHeader",
              value: function getHeader(col, row) {
                var id = this.getCellId(col, row);
                return this._header.objectMap[id] || this._emptyDataCache.getHeader(col, row);
              }
            }, {
              key: "getBody",
              value: function getBody(col, row) {
                var id = this.getCellId(col, row);
                return this._body.objectMap[id] || this._emptyDataCache.getBody(col, row);
              }
            }, {
              key: "getBodyLayoutRangeById",
              value: function getBodyLayoutRangeById(id) {
                var _a;

                for (var row = 0; row < this.bodyRowCount; row++) {
                  var objectGridRow = this._body.objectGrid[row];

                  if (!objectGridRow) {
                    continue;
                  }

                  for (var col = 0; col < this.colCount; col++) {
                    if (id === ((_a = objectGridRow[col]) === null || _a === void 0 ? void 0 : _a.id)) {
                      return this._getCellRange(this._body, col, row, 0);
                    }
                  }
                }

                throw new Error("can not found body layout @id=".concat(id));
              }
            }, {
              key: "getCellRange",
              value: function getCellRange(col, row) {
                if (this.headerRowCount <= row) {
                  var recordIndex = this.getRecordIndexByRow(row);
                  var startRow = this.getRecordStartRowByRecordIndex(recordIndex);
                  var bodyRow = row - this.headerRowCount;
                  var bodyLayoutRow = bodyRow % this.bodyRowCount;
                  return this._getCellRange(this._body, col, bodyLayoutRow, startRow);
                } //in header


                return this._getCellRange(this._header, col, row, 0);
              }
            }, {
              key: "getRecordIndexByRow",
              value: function getRecordIndexByRow(row) {
                if (row < this.headerRowCount) {
                  return -1;
                } else {
                  var bodyRow = row - this.headerRowCount;
                  return Math.floor(bodyRow / this.bodyRowCount);
                }
              }
            }, {
              key: "getRecordStartRowByRecordIndex",
              value: function getRecordStartRowByRecordIndex(index) {
                return this.headerRowCount + index * this.bodyRowCount;
              }
            }, {
              key: "_getCellRange",
              value: function _getCellRange( // eslint-disable-next-line @typescript-eslint/no-explicit-any
              layout, col, layoutRow, offsetRow) {
                var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;

                var result = {
                  start: {
                    col: col,
                    row: layoutRow + offsetRow
                  },
                  end: {
                    col: col,
                    row: layoutRow + offsetRow
                  }
                };
                var objectGrid = layout.objectGrid;
                var id = (_b = (_a = objectGrid[layoutRow]) === null || _a === void 0 ? void 0 : _a[col]) === null || _b === void 0 ? void 0 : _b.id;

                if (id == null) {
                  return result;
                }

                for (var c = col - 1; c >= 0; c--) {
                  if (id !== ((_d = (_c = objectGrid[layoutRow]) === null || _c === void 0 ? void 0 : _c[c]) === null || _d === void 0 ? void 0 : _d.id)) {
                    break;
                  }

                  result.start.col = c;
                }

                for (var _c6 = col + 1; _c6 < layout.columnCount; _c6++) {
                  if (id !== ((_f = (_e = objectGrid[layoutRow]) === null || _e === void 0 ? void 0 : _e[_c6]) === null || _f === void 0 ? void 0 : _f.id)) {
                    break;
                  }

                  result.end.col = _c6;
                }

                for (var r = layoutRow - 1; r >= 0; r--) {
                  if (id !== ((_h = (_g = objectGrid[r]) === null || _g === void 0 ? void 0 : _g[col]) === null || _h === void 0 ? void 0 : _h.id)) {
                    break;
                  }

                  result.start.row = r + offsetRow;
                }

                for (var _r2 = layoutRow + 1; _r2 < layout.rowCount; _r2++) {
                  if (id !== ((_k = (_j = objectGrid[_r2]) === null || _j === void 0 ? void 0 : _j[col]) === null || _k === void 0 ? void 0 : _k.id)) {
                    break;
                  }

                  result.end.row = _r2 + offsetRow;
                }

                return result;
              }
            }]);

            return MultiLayoutMap;
          }();

          exports.MultiLayoutMap = MultiLayoutMap;
          /***/
        },

        /***/
        "./list-grid/layout-map/internal/simple-header-layout.js":
        /*!***************************************************************!*\
          !*** ./list-grid/layout-map/internal/simple-header-layout.js ***!
          \***************************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function listGridLayoutMapInternalSimpleHeaderLayoutJs(module, exports, __nested_webpack_require_1008793__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.SimpleHeaderLayoutMap = void 0;

          var columns = __importStar(__nested_webpack_require_1008793__(
          /*! ../../../columns */
          "./columns.js"));

          var headerAction = __importStar(__nested_webpack_require_1008793__(
          /*! ../../../header/action */
          "./header/action.js"));

          var headerType = __importStar(__nested_webpack_require_1008793__(
          /*! ../../../header/type */
          "./header/type.js"));

          var utils_1 = __nested_webpack_require_1008793__(
          /*! ./utils */
          "./list-grid/layout-map/internal/utils.js");

          var seqId = 0;

          var SimpleHeaderLayoutMap = /*#__PURE__*/function () {
            function SimpleHeaderLayoutMap(header) {
              _classCallCheck(this, SimpleHeaderLayoutMap);

              this.bodyRowCount = 1;
              this._emptyDataCache = new utils_1.EmptyDataCache();
              this._columns = [];
              this._headerCellIds = [];
              this._headerObjects = this._addHeaders(0, header, []);
              this._headerObjectMap = this._headerObjects.reduce(function (o, e) {
                o[e.id] = e;
                return o;
              }, {});
            }

            _createClass(SimpleHeaderLayoutMap, [{
              key: "columnWidths",
              get: function get() {
                return this._columns;
              }
            }, {
              key: "headerRowCount",
              get: function get() {
                return this._headerCellIds.length;
              }
            }, {
              key: "colCount",
              get: function get() {
                return this._columns.length;
              }
            }, {
              key: "headerObjects",
              get: function get() {
                return this._headerObjects;
              }
            }, {
              key: "columnObjects",
              get: function get() {
                return this._columns;
              }
            }, {
              key: "getCellId",
              value: function getCellId(col, row) {
                if (this.headerRowCount <= row) {
                  return this._columns[col].id;
                } //in header


                return this._headerCellIds[row][col];
              }
            }, {
              key: "getHeader",
              value: function getHeader(col, row) {
                var id = this.getCellId(col, row);
                return this._headerObjectMap[id] || this._emptyDataCache.getHeader(col, row);
              }
            }, {
              key: "getBody",
              value: function getBody(col, _row) {
                return this._columns[col] || this._emptyDataCache.getBody(col, 0);
              }
            }, {
              key: "getBodyLayoutRangeById",
              value: function getBodyLayoutRangeById(id) {
                for (var col = 0; col < this.colCount; col++) {
                  if (id === this._columns[col].id) {
                    return {
                      start: {
                        col: col,
                        row: 0
                      },
                      end: {
                        col: col,
                        row: 0
                      }
                    };
                  }
                }

                throw new Error("can not found body layout @id=".concat(id));
              }
            }, {
              key: "getCellRange",
              value: function getCellRange(col, row) {
                var result = {
                  start: {
                    col: col,
                    row: row
                  },
                  end: {
                    col: col,
                    row: row
                  }
                };

                if (this.headerRowCount <= row) {
                  return result;
                } //in header


                var id = this.getCellId(col, row);

                for (var c = col - 1; c >= 0; c--) {
                  if (id !== this.getCellId(c, row)) {
                    break;
                  }

                  result.start.col = c;
                }

                for (var _c7 = col + 1; _c7 < this.colCount; _c7++) {
                  if (id !== this.getCellId(_c7, row)) {
                    break;
                  }

                  result.end.col = _c7;
                }

                for (var r = row - 1; r >= 0; r--) {
                  if (id !== this.getCellId(col, r)) {
                    break;
                  }

                  result.start.row = r;
                }

                for (var _r3 = row + 1; _r3 < this.headerRowCount; _r3++) {
                  if (id !== this.getCellId(col, _r3)) {
                    break;
                  }

                  result.end.row = _r3;
                }

                return result;
              }
            }, {
              key: "getRecordIndexByRow",
              value: function getRecordIndexByRow(row) {
                if (row < this.headerRowCount) {
                  return -1;
                } else {
                  return row - this.headerRowCount;
                }
              }
            }, {
              key: "getRecordStartRowByRecordIndex",
              value: function getRecordStartRowByRecordIndex(index) {
                return this.headerRowCount + index;
              }
            }, {
              key: "_addHeaders",
              value: function _addHeaders(row, header, roots) {
                var _this109 = this;

                var results = [];

                var rowCells = this._headerCellIds[row] || this._newRow(row);

                header.forEach(function (hd) {
                  var col = _this109._columns.length;
                  var id = seqId++;
                  var cell = {
                    id: id,
                    caption: hd.caption,
                    field: hd.headerField || hd.field,
                    headerIcon: hd.headerIcon,
                    style: hd.headerStyle,
                    headerType: headerType.ofCell(hd),
                    action: headerAction.ofCell(hd),
                    define: hd
                  };
                  results[id] = cell;
                  rowCells[col] = id;

                  for (var r = row - 1; r >= 0; r--) {
                    _this109._headerCellIds[r][col] = roots[r];
                  }

                  if (hd.columns) {
                    _this109._addHeaders(row + 1, hd.columns, [].concat(_toConsumableArray(roots), [id])).forEach(function (c) {
                      return results.push(c);
                    });
                  } else {
                    var colDef = hd;

                    _this109._columns.push({
                      id: seqId++,
                      field: colDef.field,
                      width: colDef.width,
                      minWidth: colDef.minWidth,
                      maxWidth: colDef.maxWidth,
                      icon: colDef.icon,
                      message: colDef.message,
                      columnType: columns.type.of(colDef.columnType),
                      action: columns.action.of(colDef.action),
                      style: colDef.style,
                      define: colDef
                    });

                    for (var _r4 = row + 1; _r4 < _this109._headerCellIds.length; _r4++) {
                      _this109._headerCellIds[_r4][col] = id;
                    }
                  }
                });
                return results;
              }
            }, {
              key: "_newRow",
              value: function _newRow(row) {
                var newRow = this._headerCellIds[row] = [];

                if (!this._columns.length) {
                  return newRow;
                }

                var prev = this._headerCellIds[row - 1];

                for (var col = 0; col < prev.length; col++) {
                  newRow[col] = prev[col];
                }

                return newRow;
              }
            }]);

            return SimpleHeaderLayoutMap;
          }();

          exports.SimpleHeaderLayoutMap = SimpleHeaderLayoutMap;
          /***/
        },

        /***/
        "./list-grid/layout-map/internal/utils.js":
        /*!************************************************!*\
          !*** ./list-grid/layout-map/internal/utils.js ***!
          \************************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function listGridLayoutMapInternalUtilsJs(module, exports, __nested_webpack_require_1018985__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.EmptyDataCache = exports.newEmptyColumnData = exports.newEmptyHeaderData = void 0;

          var columns = __importStar(__nested_webpack_require_1018985__(
          /*! ../../../columns */
          "./columns.js"));

          var headerType = __importStar(__nested_webpack_require_1018985__(
          /*! ../../../header/type */
          "./header/type.js"));

          var seqId = -1; // eslint-disable-next-line @typescript-eslint/no-explicit-any

          function newEmptyHeaderData() {
            return {
              id: seqId--,
              define: {},
              headerType: headerType.of(null) // default

            };
          }

          exports.newEmptyHeaderData = newEmptyHeaderData; // eslint-disable-next-line @typescript-eslint/no-explicit-any

          function newEmptyColumnData() {
            return {
              id: seqId--,
              define: {},
              columnType: columns.type.of(null),
              style: null
            };
          }

          exports.newEmptyColumnData = newEmptyColumnData;

          var EmptyDataCache = /*#__PURE__*/function () {
            function EmptyDataCache() {
              _classCallCheck(this, EmptyDataCache);

              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              this.headers = []; // eslint-disable-next-line @typescript-eslint/no-explicit-any

              this.columns = [];
            }

            _createClass(EmptyDataCache, [{
              key: "getHeader",
              value: function getHeader(col, row) {
                var rows = this.headers[row] || (this.headers[row] = []);
                return rows[col] || (rows[col] = newEmptyHeaderData());
              }
            }, {
              key: "getBody",
              value: function getBody(col, row) {
                var rows = this.columns[row] || (this.columns[row] = []);
                return rows[col] || (rows[col] = newEmptyColumnData());
              }
            }]);

            return EmptyDataCache;
          }();

          exports.EmptyDataCache = EmptyDataCache;
          /***/
        },

        /***/
        "./main.js":
        /*!*****************!*\
          !*** ./main.js ***!
          \*****************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function mainJs(module, exports, __nested_webpack_require_1022931__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.register = exports.getIcons = exports.GridCanvasHelper = exports.data = exports.themes = exports.headers = exports.columns = exports.ListGrid = exports.tools = exports.core = exports._getInternal = void 0;

          var columns = __importStar(__nested_webpack_require_1022931__(
          /*! ./columns */
          "./columns.js"));

          exports.columns = columns;

          var core = __importStar(__nested_webpack_require_1022931__(
          /*! ./core */
          "./core.js"));

          exports.core = core;

          var data = __importStar(__nested_webpack_require_1022931__(
          /*! ./data */
          "./data.js"));

          exports.data = data;

          var headers = __importStar(__nested_webpack_require_1022931__(
          /*! ./headers */
          "./headers.js"));

          exports.headers = headers;

          var icons = __importStar(__nested_webpack_require_1022931__(
          /*! ./icons */
          "./icons.js"));

          var register = __importStar(__nested_webpack_require_1022931__(
          /*! ./register */
          "./register.js"));

          exports.register = register;

          var themes = __importStar(__nested_webpack_require_1022931__(
          /*! ./themes */
          "./themes.js"));

          exports.themes = themes;

          var tools = __importStar(__nested_webpack_require_1022931__(
          /*! ./tools */
          "./tools.js"));

          exports.tools = tools;

          var ListGrid_1 = __nested_webpack_require_1022931__(
          /*! ./ListGrid */
          "./ListGrid.js");

          Object.defineProperty(exports, "ListGrid", {
            enumerable: true,
            get: function get() {
              return ListGrid_1.ListGrid;
            }
          });

          var GridCanvasHelper_1 = __nested_webpack_require_1022931__(
          /*! ./GridCanvasHelper */
          "./GridCanvasHelper.js");

          Object.defineProperty(exports, "GridCanvasHelper", {
            enumerable: true,
            get: function get() {
              return GridCanvasHelper_1.GridCanvasHelper;
            }
          });

          var get_internal_1 = __nested_webpack_require_1022931__(
          /*! ./get-internal */
          "./get-internal.js");

          Object.defineProperty(exports, "_getInternal", {
            enumerable: true,
            get: function get() {
              return get_internal_1.getInternal;
            }
          });
          /** @private */

          function getIcons() {
            return icons.get();
          }

          exports.getIcons = getIcons; // backward compatibility

          exports.default = {
            core: core,
            tools: tools,
            // impl Grids
            ListGrid: ListGrid_1.ListGrid,
            // objects
            columns: columns,
            headers: headers,
            themes: themes,
            data: data,
            // helper
            GridCanvasHelper: GridCanvasHelper_1.GridCanvasHelper,
            //plugin registers
            register: register,

            get icons() {
              return getIcons();
            }

          }; // eslint-disable-next-line @typescript-eslint/no-explicit-any

          Object.defineProperty(themes, "default", {
            enumerable: false,
            configurable: true,
            get: function get() {
              return themes.getDefault();
            },
            set: function set(defaultTheme) {
              themes.setDefault(defaultTheme);
            }
          }); // eslint-disable-next-line @typescript-eslint/no-explicit-any

          Object.defineProperty(themes, "choices", {
            enumerable: false,
            configurable: true,
            get: function get() {
              return themes.getChoices();
            }
          });
          /***/
        },

        /***/
        "./plugins/icons.js":
        /*!**************************!*\
          !*** ./plugins/icons.js ***!
          \**************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function pluginsIconsJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.icons = void 0;
          exports.icons = {};
          /***/
        },

        /***/
        "./plugins/themes.js":
        /*!***************************!*\
          !*** ./plugins/themes.js ***!
          \***************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function pluginsThemesJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.themes = void 0;
          exports.themes = {};
          /***/
        },

        /***/
        "./register.js":
        /*!*********************!*\
          !*** ./register.js ***!
          \*********************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function registerJs(module, exports, __nested_webpack_require_1029658__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.icons = exports.icon = exports.theme = void 0;

          var icons_1 = __nested_webpack_require_1029658__(
          /*! ./plugins/icons */
          "./plugins/icons.js");

          var themes_1 = __nested_webpack_require_1029658__(
          /*! ./plugins/themes */
          "./plugins/themes.js");

          function register(obj, name, value) {
            var old = obj[name];
            obj[name] = value;
            return old;
          }

          function registers(obj, values) {
            for (var k in values) {
              obj[k] = values[k];
            }
          }

          function theme(name, theme) {
            if (theme != null) {
              return register(themes_1.themes, name, theme);
            } else {
              return themes_1.themes[name];
            }
          }

          exports.theme = theme;

          function icon(name, icon) {
            if (icon != null) {
              return register(icons_1.icons, name, icon);
            } else {
              return icons_1.icons[name];
            }
          }

          exports.icon = icon;

          function icons(icons) {
            return registers(icons_1.icons, icons);
          }

          exports.icons = icons;
          /***/
        },

        /***/
        "./themes.js":
        /*!*******************!*\
          !*** ./themes.js ***!
          \*******************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function themesJs(module, exports, __nested_webpack_require_1031367__) {
          "use strict";

          var __importDefault = this && this.__importDefault || function (mod) {
            return mod && mod.__esModule ? mod : {
              "default": mod
            };
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.getChoices = exports.setDefault = exports.getDefault = exports.of = exports.theme = exports.MATERIAL_DESIGN = exports.BASIC = void 0;

          var utils_1 = __nested_webpack_require_1031367__(
          /*! ./internal/utils */
          "./internal/utils.js");

          var theme_1 = __nested_webpack_require_1031367__(
          /*! ./themes/theme */
          "./themes/theme.js");

          var BASIC_1 = __importDefault(__nested_webpack_require_1031367__(
          /*! ./themes/BASIC */
          "./themes/BASIC.js"));

          var MATERIAL_DESIGN_1 = __importDefault(__nested_webpack_require_1031367__(
          /*! ./themes/MATERIAL_DESIGN */
          "./themes/MATERIAL_DESIGN.js"));

          var themes_1 = __nested_webpack_require_1031367__(
          /*! ./plugins/themes */
          "./plugins/themes.js");

          exports.BASIC = new theme_1.Theme(BASIC_1.default);
          exports.MATERIAL_DESIGN = new theme_1.Theme(MATERIAL_DESIGN_1.default);
          var builtin = {
            BASIC: exports.BASIC,
            MATERIAL_DESIGN: exports.MATERIAL_DESIGN
          };
          var defTheme = exports.MATERIAL_DESIGN;
          exports.theme = {
            Theme: theme_1.Theme
          };

          function of(value) {
            if (!value) {
              return null;
            }

            if (typeof value === "string") {
              var t = (0, utils_1.getIgnoreCase)(getChoices(), value);

              if (t) {
                return t;
              }

              return null;
            }

            if (value instanceof theme_1.Theme) {
              return value;
            }

            return new theme_1.Theme(value);
          }

          exports.of = of;

          function getDefault() {
            return defTheme;
          }

          exports.getDefault = getDefault;

          function setDefault(defaultTheme) {
            defTheme = of(defaultTheme) || defTheme;
          }

          exports.setDefault = setDefault;

          function getChoices() {
            return (0, utils_1.extend)(builtin, themes_1.themes);
          }

          exports.getChoices = getChoices;
          /***/
        },

        /***/
        "./themes/BASIC.js":
        /*!*************************!*\
          !*** ./themes/BASIC.js ***!
          \*************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function themesBASICJs(module, exports, __webpack_require__) {
          "use strict";
          /*eslint no-bitwise:0*/

          Object.defineProperty(exports, "__esModule", {
            value: true
          });

          function DEFAULT_BG_COLOR(args) {
            var row = args.row,
                grid = args.grid;

            if (row < grid.frozenRowCount) {
              return "#FFF";
            }

            var index = grid.getRecordIndexByRow(row);

            if (!(index & 1)) {
              return "#FFF";
            } else {
              return "#F6F6F6";
            }
          }

          var cacheLinearGradient = {};

          function getLinearGradient(context, left, top, right, bottom, colorStops) {
            var stop;
            var stopsKey = [];

            for (stop in colorStops) {
              stopsKey.push("".concat(stop, "@").concat(colorStops[stop]));
            }

            var key = "".concat(left, "/").concat(top, "/").concat(right, "/").concat(bottom, "/").concat(stopsKey.join(","));
            var ret = cacheLinearGradient[key];

            if (ret) {
              return ret;
            }

            var grad = context.createLinearGradient(left, top, left, bottom);

            for (stop in colorStops) {
              grad.addColorStop(Number(stop), colorStops[stop]);
            }

            return cacheLinearGradient[key] = grad;
          }

          function FROZEN_ROWS_BG_COLOR(args) {
            var col = args.col,
                grid = args.grid,
                frozenRowCount = args.grid.frozenRowCount,
                context = args.context;

            var _grid$getCellRelative = grid.getCellRelativeRect(col, 0),
                left = _grid$getCellRelative.left,
                top = _grid$getCellRelative.top;

            var _grid$getCellRelative2 = grid.getCellRelativeRect(col, frozenRowCount - 1),
                bottom = _grid$getCellRelative2.bottom;

            return getLinearGradient(context, left, top, left, bottom, {
              0: "#FFF",
              1: "#D3D3D3"
            });
          }
          /**
           * basic theme
           * @name BASIC
           * @memberof cheetahGrid.themes.choices
           */


          exports.default = {
            color: "#000",
            // frozenRowsColor: '#000',
            defaultBgColor: DEFAULT_BG_COLOR,
            frozenRowsBgColor: FROZEN_ROWS_BG_COLOR,
            selectionBgColor: "#CCE0FF",
            borderColor: "#000",
            // frozenRowsBorderColor: '#000',
            highlightBorderColor: "#5E9ED6",
            checkbox: {
              uncheckBgColor: "#FFF",
              checkBgColor: "rgb(76, 73, 72)",
              borderColor: "#000"
            },
            radioButton: {
              checkColor: "rgb(76, 73, 72)",
              checkBorderColor: "#000",
              uncheckBorderColor: "#000",
              uncheckBgColor: "#FFF",
              checkBgColor: "#FFF"
            },
            button: {
              color: "#FFF",
              bgColor: "#2196F3"
            },
            header: {
              sortArrowColor: "rgba(0, 0, 0, 0.38)"
            },
            indicators: {
              topLeftColor: "#000"
            },
            underlayBackgroundColor: "#F6F6F6"
          };
          /***/
        },

        /***/
        "./themes/MATERIAL_DESIGN.js":
        /*!***********************************!*\
          !*** ./themes/MATERIAL_DESIGN.js ***!
          \***********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function themesMATERIAL_DESIGNJs(module, exports, __webpack_require__) {
          "use strict";
          /*eslint no-bitwise:0*/

          Object.defineProperty(exports, "__esModule", {
            value: true
          });

          function FROZEN_ROWS_BORDER_COLOR(args) {
            var row = args.row,
                frozenRowCount = args.grid.frozenRowCount;

            if (frozenRowCount - 1 === row) {
              return ["#f2f2f2", "#f2f2f2", "#ccc7c7", "#f2f2f2"];
            } else {
              return ["#f2f2f2"];
            }
          }

          function BORDER_COLOR(args) {
            var col = args.col,
                row = args.row,
                grid = args.grid;
            var colCount = grid.colCount,
                frozenColCount = grid.frozenColCount,
                recordRowCount = grid.recordRowCount;
            var top = "#ccc7c7";
            var bottom = "#ccc7c7";

            if (recordRowCount > 1) {
              var startRow = grid.getRecordStartRowByRecordIndex(grid.getRecordIndexByRow(row));
              var endRow = startRow + recordRowCount - 1;

              if (startRow !== row) {
                top = null;
              }

              if (endRow !== row) {
                bottom = null;
              }
            }

            if (frozenColCount - 1 === col) {
              return [top, "#f2f2f2", bottom, null];
            }

            if (colCount - 1 === col) {
              return [top, "#f2f2f2", bottom, null];
            }

            return [top, null, bottom, null];
          }
          /**
           * material design theme
           * @name MATERIAL_DESIGN
           * @memberof cheetahGrid.themes.choices
           */


          exports.default = {
            color: "rgba(0, 0, 0, 0.87)",
            frozenRowsColor: "rgba(0, 0, 0, 0.54)",
            defaultBgColor: "#FFF",
            // frozenRowsBgColor: '#FFF',
            selectionBgColor: "#CCE0FF",
            borderColor: BORDER_COLOR,
            frozenRowsBorderColor: FROZEN_ROWS_BORDER_COLOR,
            highlightBorderColor: "#5E9ED6",
            checkbox: {
              // uncheckBgColor: '#FFF',
              checkBgColor: "rgb(76, 73, 72)",
              borderColor: "rgba(0, 0, 0, 0.26)"
            },
            radioButton: {
              checkColor: "rgb(76, 73, 72)",
              checkBorderColor: "rgb(76, 73, 72)",
              uncheckBorderColor: "rgb(189, 189, 189)" // uncheckBgColor: "#FFF",
              // checkBgColor: "#FFF",

            },
            button: {
              color: "#FFF",
              bgColor: "#2196F3"
            },
            header: {
              sortArrowColor: "rgba(0, 0, 0, 0.38)"
            },
            indicators: {
              topLeftColor: "#ccc7c7"
            },
            underlayBackgroundColor: "#FFF"
          };
          /***/
        },

        /***/
        "./themes/theme.js":
        /*!*************************!*\
          !*** ./themes/theme.js ***!
          \*************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function themesThemeJs(module, exports, __nested_webpack_require_1041089__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Theme = void 0;

          var utils_1 = __nested_webpack_require_1041089__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var symbolManager_1 = __nested_webpack_require_1041089__(
          /*! ../internal/symbolManager */
          "./internal/symbolManager.js");

          var TreeColumn_1 = __nested_webpack_require_1041089__(
          /*! ../columns/type/TreeColumn */
          "./columns/type/TreeColumn.js"); //private symbol


          var _ = (0, symbolManager_1.get)();

          function getProp(obj, superObj, names, defNames, convertForSuper, defaultValue) {
            var value = (0, utils_1.getChainSafe).apply(void 0, [obj].concat(_toConsumableArray(names))) || (0, utils_1.getChainSafe).apply(void 0, [superObj].concat(_toConsumableArray(names)));

            if (value) {
              return value;
            }

            if (!defNames) {
              return value || defaultValue;
            }

            var getChainSafeWithConvert = convertForSuper ? function (obj) {
              for (var _len26 = arguments.length, names = new Array(_len26 > 1 ? _len26 - 1 : 0), _key27 = 1; _key27 < _len26; _key27++) {
                names[_key27 - 1] = arguments[_key27];
              }

              var value = (0, utils_1.getChainSafe).apply(void 0, [obj].concat(names));

              if (!value) {
                return value;
              }

              return convertForSuper(value);
            } : utils_1.getChainSafe;
            return getChainSafeWithConvert.apply(void 0, [obj].concat(_toConsumableArray(defNames))) || getChainSafeWithConvert.apply(void 0, [superObj].concat(_toConsumableArray(defNames))) || defaultValue;
          }

          var Theme = /*#__PURE__*/function () {
            function Theme(obj, superTheme) {
              _classCallCheck(this, Theme);

              this._checkbox = null;
              this._radioButton = null;
              this._button = null;
              this._tree = null;
              this._header = null;
              this._messages = null;
              this._indicators = null;
              this[_] = {
                obj: obj,
                superTheme: superTheme
              };
            }

            _createClass(Theme, [{
              key: "font",
              get: function get() {
                var _this$_3 = this[_],
                    obj = _this$_3.obj,
                    superTheme = _this$_3.superTheme;
                return getProp(obj, superTheme, ["font"]);
              }
            }, {
              key: "underlayBackgroundColor",
              get: function get() {
                var _this$_4 = this[_],
                    obj = _this$_4.obj,
                    superTheme = _this$_4.superTheme;
                return getProp(obj, superTheme, ["underlayBackgroundColor"]);
              } // color

            }, {
              key: "color",
              get: function get() {
                var _this$_5 = this[_],
                    obj = _this$_5.obj,
                    superTheme = _this$_5.superTheme;
                return getProp(obj, superTheme, ["color"]);
              }
            }, {
              key: "frozenRowsColor",
              get: function get() {
                var _this$_6 = this[_],
                    obj = _this$_6.obj,
                    superTheme = _this$_6.superTheme;
                return getProp(obj, superTheme, ["frozenRowsColor"], ["color"]);
              } // background

            }, {
              key: "defaultBgColor",
              get: function get() {
                var _this$_7 = this[_],
                    obj = _this$_7.obj,
                    superTheme = _this$_7.superTheme;
                return getProp(obj, superTheme, ["defaultBgColor"]);
              }
            }, {
              key: "frozenRowsBgColor",
              get: function get() {
                var _this$_8 = this[_],
                    obj = _this$_8.obj,
                    superTheme = _this$_8.superTheme;
                return getProp(obj, superTheme, ["frozenRowsBgColor"], ["defaultBgColor"]);
              }
            }, {
              key: "selectionBgColor",
              get: function get() {
                var _this$_9 = this[_],
                    obj = _this$_9.obj,
                    superTheme = _this$_9.superTheme;
                return getProp(obj, superTheme, ["selectionBgColor"], ["defaultBgColor"]);
              }
            }, {
              key: "highlightBgColor",
              get: function get() {
                var _this110 = this;

                if (this.hasProperty(["highlightBgColor"])) {
                  var _this$_10 = this[_],
                      obj = _this$_10.obj,
                      superTheme = _this$_10.superTheme;
                  return getProp(obj, superTheme, ["highlightBgColor"]);
                } // eslint-disable-next-line @typescript-eslint/no-explicit-any


                return function (args) {
                  var color = args.row < args.grid.frozenRowCount ? _this110.frozenRowsBgColor : _this110.defaultBgColor;

                  if (typeof color === "function") {
                    return color(args);
                  }

                  return color;
                };
              } // border

            }, {
              key: "borderColor",
              get: function get() {
                var _this$_11 = this[_],
                    obj = _this$_11.obj,
                    superTheme = _this$_11.superTheme;
                return getProp(obj, superTheme, ["borderColor"]);
              }
            }, {
              key: "frozenRowsBorderColor",
              get: function get() {
                var _this$_12 = this[_],
                    obj = _this$_12.obj,
                    superTheme = _this$_12.superTheme;
                return getProp(obj, superTheme, ["frozenRowsBorderColor"], ["borderColor"]);
              }
            }, {
              key: "highlightBorderColor",
              get: function get() {
                var _this$_13 = this[_],
                    obj = _this$_13.obj,
                    superTheme = _this$_13.superTheme;
                return getProp(obj, superTheme, ["highlightBorderColor"], ["borderColor"]);
              }
            }, {
              key: "checkbox",
              get: function get() {
                var _this$_14 = this[_],
                    obj = _this$_14.obj,
                    superTheme = _this$_14.superTheme;
                return this._checkbox || (this._checkbox = {
                  get uncheckBgColor() {
                    return getCheckboxProp("uncheckBgColor", ["defaultBgColor"]);
                  },

                  get checkBgColor() {
                    return getCheckboxProp("checkBgColor", ["borderColor"], colorsToColor, "#000");
                  },

                  get borderColor() {
                    return getCheckboxProp("borderColor", ["borderColor"], colorsToColor, "#000");
                  }

                });

                function getCheckboxProp(prop, defNames, convertForSuper, defaultValue) {
                  return getProp(obj, superTheme, ["checkbox", prop], defNames, convertForSuper, defaultValue);
                }
              }
            }, {
              key: "radioButton",
              get: function get() {
                var _this$_15 = this[_],
                    obj = _this$_15.obj,
                    superTheme = _this$_15.superTheme;
                return this._radioButton || (this._radioButton = {
                  get checkColor() {
                    return getRadioButtonProp("checkColor", ["color"]);
                  },

                  get uncheckBorderColor() {
                    return getRadioButtonProp("uncheckBorderColor", ["borderColor"], colorsToColor, "#000");
                  },

                  get checkBorderColor() {
                    return getRadioButtonProp("checkBorderColor", ["borderColor"], colorsToColor, "#000");
                  },

                  get uncheckBgColor() {
                    return getRadioButtonProp("uncheckBgColor", ["defaultBgColor"]);
                  },

                  get checkBgColor() {
                    return getRadioButtonProp("checkBgColor", ["defaultBgColor"]);
                  }

                });

                function getRadioButtonProp(prop, defNames, convertForSuper, defaultValue) {
                  return getProp(obj, superTheme, ["radioButton", prop], defNames, convertForSuper, defaultValue);
                }
              }
            }, {
              key: "button",
              get: function get() {
                var _this$_16 = this[_],
                    obj = _this$_16.obj,
                    superTheme = _this$_16.superTheme;
                return this._button || (this._button = {
                  get color() {
                    return getButtonProp("color", ["color"]);
                  },

                  get bgColor() {
                    return getButtonProp("bgColor", ["defaultBgColor"]);
                  }

                });

                function getButtonProp(prop, defNames) {
                  return getProp(obj, superTheme, ["button", prop], defNames);
                }
              }
            }, {
              key: "tree",
              get: function get() {
                var _this$_17 = this[_],
                    obj = _this$_17.obj,
                    superTheme = _this$_17.superTheme;
                return this._tree || (this._tree = {
                  get lineStyle() {
                    return getTreeProp("lineStyle", undefined, undefined, "solid");
                  },

                  get lineColor() {
                    return getTreeProp("lineColor", ["borderColor"], colorsToColor, "#0000");
                  },

                  get lineWidth() {
                    return getTreeProp("lineWidth", undefined, undefined, 1);
                  },

                  get treeIcon() {
                    return getTreeProp("treeIcon", undefined, undefined, function (args) {
                      var _ref85 = (0, TreeColumn_1.getTreeNodeInfoAt)(args),
                          hasChildren = _ref85.hasChildren,
                          nodeType = _ref85.nodeType;

                      if (hasChildren) {
                        return "expand_more";
                      }

                      return nodeType === "branch" ? "chevron_right" : "none";
                    });
                  }

                });

                function getTreeProp(prop, defNames, convertForSuper, defaultValue) {
                  return getProp(obj, superTheme, ["tree", prop], defNames, convertForSuper, defaultValue);
                }
              }
            }, {
              key: "header",
              get: function get() {
                var _this$_18 = this[_],
                    obj = _this$_18.obj,
                    superTheme = _this$_18.superTheme;
                return this._header || (this._header = {
                  get sortArrowColor() {
                    return getProp(obj, superTheme, ["header", "sortArrowColor"], ["color"]);
                  }

                });
              }
            }, {
              key: "messages",
              get: function get() {
                var _this$_19 = this[_],
                    obj = _this$_19.obj,
                    superTheme = _this$_19.superTheme;
                return this._messages || (this._messages = {
                  get infoBgColor() {
                    return getMessageProp("infoBgColor");
                  },

                  get errorBgColor() {
                    return getMessageProp("errorBgColor");
                  },

                  get warnBgColor() {
                    return getMessageProp("warnBgColor");
                  },

                  get boxWidth() {
                    return getMessageProp("boxWidth");
                  },

                  get markHeight() {
                    return getMessageProp("markHeight");
                  }

                });

                function getMessageProp(prop) {
                  return getProp(obj, superTheme, ["messages", prop]);
                }
              }
            }, {
              key: "indicators",
              get: function get() {
                var _this$_20 = this[_],
                    obj = _this$_20.obj,
                    superTheme = _this$_20.superTheme;
                return this._indicators || (this._indicators = {
                  get topLeftColor() {
                    return getIndicatorsProp("topLeftColor", ["borderColor"], colorsToColor, "#000");
                  },

                  get topLeftSize() {
                    return getIndicatorsProp("topLeftSize");
                  },

                  get topRightColor() {
                    return getIndicatorsProp("topRightColor", ["borderColor"], colorsToColor, "#000");
                  },

                  get topRightSize() {
                    return getIndicatorsProp("topRightSize");
                  },

                  get bottomRightColor() {
                    return getIndicatorsProp("bottomRightColor", ["borderColor"], colorsToColor, "#000");
                  },

                  get bottomRightSize() {
                    return getIndicatorsProp("bottomRightSize");
                  },

                  get bottomLeftColor() {
                    return getIndicatorsProp("bottomLeftColor", ["borderColor"], colorsToColor, "#000");
                  },

                  get bottomLeftSize() {
                    return getIndicatorsProp("bottomLeftSize");
                  }

                });

                function getIndicatorsProp(prop, defNames, convertForSuper, defaultValue) {
                  return getProp(obj, superTheme, ["indicators", prop], defNames, convertForSuper, defaultValue);
                }
              }
            }, {
              key: "hasProperty",
              value: function hasProperty(names) {
                var _this$_21 = this[_],
                    obj = _this$_21.obj,
                    superTheme = _this$_21.superTheme;
                return hasThemeProperty(obj, names) || hasThemeProperty(superTheme, names);
              }
            }, {
              key: "extends",
              value: function _extends(obj) {
                return new Theme(obj, this);
              }
            }]);

            return Theme;
          }();

          exports.Theme = Theme;

          function hasThemeProperty(obj, names) {
            if (obj instanceof Theme) {
              return obj.hasProperty(names);
            } else {
              // eslint-disable-next-line @typescript-eslint/no-explicit-any
              var o = obj;

              if (!o) {
                return false;
              }

              for (var index = 0; index < names.length; index++) {
                var name = names[index];
                o = o[name];

                if (!o) {
                  return false;
                }
              }

              return !!o;
            }
          }

          function colorsToColor(colors) {
            if (typeof colors === "function") {
              return function (arg) {
                var val = colors(arg);
                return val ? colorsArrayToColor(val) : val;
              };
            }

            return colorsArrayToColor(colors);

            function colorsArrayToColor( // eslint-disable-next-line @typescript-eslint/ban-types
            colors) {
              if (!Array.isArray(colors)) {
                return colors;
              }

              return colors.find(Boolean) || undefined;
            }
          }
          /***/

        },

        /***/
        "./tools.js":
        /*!******************!*\
          !*** ./tools.js ***!
          \******************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function toolsJs(module, exports, __nested_webpack_require_1057444__) {
          "use strict";

          var __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            var desc = Object.getOwnPropertyDescriptor(m, k);

            if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
              desc = {
                enumerable: true,
                get: function get() {
                  return m[k];
                }
              };
            }

            Object.defineProperty(o, k2, desc);
          } : function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          });

          var __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {
            Object.defineProperty(o, "default", {
              enumerable: true,
              value: v
            });
          } : function (o, v) {
            o["default"] = v;
          });

          var __importStar = this && this.__importStar || function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) {
              if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
            }

            __setModuleDefault(result, mod);

            return result;
          };

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.canvashelper = void 0;

          var canvashelper = __importStar(__nested_webpack_require_1057444__(
          /*! ./tools/canvashelper */
          "./tools/canvashelper.js"));

          exports.canvashelper = canvashelper;
          /***/
        },

        /***/
        "./tools/canvashelper.js":
        /*!*******************************!*\
          !*** ./tools/canvashelper.js ***!
          \*******************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function toolsCanvashelperJs(module, exports, __nested_webpack_require_1059597__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.drawButton = exports.drawRadioButton = exports.drawCheckbox = exports.measureRadioButton = exports.measureCheckbox = exports.drawInlineImageRect = exports.fillTextRect = exports.strokeCircle = exports.fillCircle = exports.strokeRoundRect = exports.fillRoundRect = exports.roundRect = exports.strokeColorsRect = void 0;

          var canvases_1 = __nested_webpack_require_1059597__(
          /*! ../internal/canvases */
          "./internal/canvases.js");

          var ceil = Math.ceil,
              PI = Math.PI;

          function strokeColorsRect(ctx, borderColors, left, top, width, height) {
            function strokeRectLines(positions) {
              for (var i = 0; i < borderColors.length; i++) {
                var color = borderColors[i];
                var _preColor = borderColors[i - 1];

                if (color) {
                  if (_preColor !== color) {
                    if (_preColor) {
                      ctx.strokeStyle = _preColor;
                      ctx.stroke();
                    }

                    var pos1 = positions[i];
                    ctx.beginPath();
                    ctx.moveTo(pos1.x, pos1.y);
                  }

                  var pos2 = positions[i + 1];
                  ctx.lineTo(pos2.x, pos2.y);
                } else {
                  if (_preColor) {
                    ctx.strokeStyle = _preColor;
                    ctx.stroke();
                  }
                }
              }

              var preColor = borderColors[borderColors.length - 1];

              if (preColor) {
                ctx.strokeStyle = preColor;
                ctx.stroke();
              }
            }

            if (borderColors[0] === borderColors[1] && borderColors[0] === borderColors[2] && borderColors[0] === borderColors[3]) {
              if (borderColors[0]) {
                ctx.strokeStyle = borderColors[0];
                ctx.strokeRect(left, top, width, height);
              }
            } else {
              strokeRectLines([{
                x: left,
                y: top
              }, {
                x: left + width,
                y: top
              }, {
                x: left + width,
                y: top + height
              }, {
                x: left,
                y: top + height
              }, {
                x: left,
                y: top
              }]);
            }
          }

          exports.strokeColorsRect = strokeColorsRect;

          function roundRect(ctx, left, top, width, height, radius) {
            ctx.beginPath();
            ctx.arc(left + radius, top + radius, radius, -PI, -0.5 * PI, false);
            ctx.arc(left + width - radius, top + radius, radius, -0.5 * PI, 0, false);
            ctx.arc(left + width - radius, top + height - radius, radius, 0, 0.5 * PI, false);
            ctx.arc(left + radius, top + height - radius, radius, 0.5 * PI, PI, false);
            ctx.closePath();
          }

          exports.roundRect = roundRect;

          function fillRoundRect(ctx, left, top, width, height, radius) {
            roundRect(ctx, left, top, width, height, radius);
            ctx.fill();
          }

          exports.fillRoundRect = fillRoundRect;

          function strokeRoundRect(ctx, left, top, width, height, radius) {
            roundRect(ctx, left, top, width, height, radius);
            ctx.stroke();
          }

          exports.strokeRoundRect = strokeRoundRect;

          function fillCircle(ctx, left, top, width, height) {
            var min = Math.min(width, height) / 2;
            ctx.beginPath();
            ctx.arc(left + min, top + min, min, 0, 2 * Math.PI);
            ctx.closePath();
            ctx.fill();
          }

          exports.fillCircle = fillCircle;

          function strokeCircle(ctx, left, top, width, height) {
            var min = Math.min(width, height) / 2;
            ctx.beginPath();
            ctx.arc(left + min, top + min, min, 0, 2 * Math.PI);
            ctx.closePath();
            ctx.stroke();
          }

          exports.strokeCircle = strokeCircle;

          function fillTextRect(ctx, text, left, top, width, height) {
            var _ref86 = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : {},
                _ref86$offset = _ref86.offset,
                offset = _ref86$offset === void 0 ? 2 : _ref86$offset,
                padding = _ref86.padding;

            var rect = {
              left: left,
              top: top,
              width: width,
              height: height,
              right: left + width,
              bottom: top + height
            };
            ctx.save();

            try {
              ctx.beginPath();
              ctx.rect(rect.left, rect.top, rect.width, rect.height); //clip

              ctx.clip(); //文字描画

              var pos = (0, canvases_1.calcBasePosition)(ctx, rect, {
                offset: offset,
                padding: padding
              });
              ctx.fillText(text, pos.x, pos.y);
            } finally {
              ctx.restore();
            }
          }

          exports.fillTextRect = fillTextRect;

          function drawInlineImageRect(ctx, image, srcLeft, srcTop, srcWidth, srcHeight, destWidth, destHeight, left, top, width, height) {
            var _ref87 = arguments.length > 12 && arguments[12] !== undefined ? arguments[12] : {},
                _ref87$offset = _ref87.offset,
                offset = _ref87$offset === void 0 ? 2 : _ref87$offset,
                padding = _ref87.padding;

            var rect = {
              left: left,
              top: top,
              width: width,
              height: height,
              right: left + width,
              bottom: top + height
            };
            ctx.save();

            try {
              ctx.beginPath();
              ctx.rect(rect.left, rect.top, rect.width, rect.height); //clip

              ctx.clip(); //文字描画

              var pos = (0, canvases_1.calcStartPosition)(ctx, rect, destWidth, destHeight, {
                offset: offset,
                padding: padding
              });
              ctx.drawImage(image, srcLeft, srcTop, srcWidth, srcHeight, pos.x, pos.y, destWidth, destHeight);
            } finally {
              ctx.restore();
            }
          }

          exports.drawInlineImageRect = drawInlineImageRect;
          /**
           * Returns an object containing the width of the checkbox.
           * @param  {CanvasRenderingContext2D} ctx canvas context
           * @return {Object} Object containing the width of the checkbox
           * @memberof cheetahGrid.tools.canvashelper
           */

          function measureCheckbox(ctx) {
            return {
              width: (0, canvases_1.getFontSize)(ctx, null).width
            };
          }

          exports.measureCheckbox = measureCheckbox;
          /**
           * Returns an object containing the width of the radio button.
           * @param  {CanvasRenderingContext2D} ctx canvas context
           * @return {Object} Object containing the width of the radio button
           * @memberof cheetahGrid.tools.canvashelper
           */

          function measureRadioButton(ctx) {
            return {
              width: (0, canvases_1.getFontSize)(ctx, null).width
            };
          }

          exports.measureRadioButton = measureRadioButton;
          /**
           * draw Checkbox
           * @param  {CanvasRenderingContext2D} ctx canvas context
           * @param  {number} x The x coordinate where to start drawing the checkbox (relative to the canvas)
           * @param  {number} y The y coordinate where to start drawing the checkbox (relative to the canvas)
           * @param  {boolean|number} check checkbox check status
           * @param  {object} option option
           * @return {void}
           * @memberof cheetahGrid.tools.canvashelper
           */

          function drawCheckbox(ctx, x, y, check) {
            var _ref88 = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {},
                _ref88$uncheckBgColor = _ref88.uncheckBgColor,
                uncheckBgColor = _ref88$uncheckBgColor === void 0 ? "#FFF" : _ref88$uncheckBgColor,
                _ref88$checkBgColor = _ref88.checkBgColor,
                checkBgColor = _ref88$checkBgColor === void 0 ? "rgb(76, 73, 72)" : _ref88$checkBgColor,
                _ref88$borderColor = _ref88.borderColor,
                borderColor = _ref88$borderColor === void 0 ? "#000" : _ref88$borderColor,
                _ref88$boxSize = _ref88.boxSize,
                boxSize = _ref88$boxSize === void 0 ? measureCheckbox(ctx).width : _ref88$boxSize;

            var checkPoint = typeof check === "number" ? check > 1 ? 1 : check : 1;
            ctx.save();

            try {
              ctx.fillStyle = check ? checkBgColor : uncheckBgColor;
              var leftX = ceil(x);
              var topY = ceil(y);
              var size = ceil(boxSize);
              fillRoundRect(ctx, leftX - 1, topY - 1, size + 1, size + 1, boxSize / 5);
              ctx.lineWidth = 1;
              ctx.strokeStyle = borderColor;
              strokeRoundRect(ctx, leftX - 0.5, topY - 0.5, size, size, boxSize / 5);

              if (check) {
                ctx.lineWidth = ceil(boxSize / 10);
                ctx.strokeStyle = uncheckBgColor;
                var leftWidth = boxSize / 4;
                var rightWidth = boxSize / 2 * 0.9;
                var leftLeftPos = x + boxSize * 0.2;
                var leftTopPos = y + boxSize / 2;

                if (checkPoint < 0.5) {
                  leftWidth *= checkPoint * 2;
                }

                ctx.beginPath();
                ctx.moveTo(leftLeftPos, leftTopPos);
                ctx.lineTo(leftLeftPos + leftWidth, leftTopPos + leftWidth);

                if (checkPoint > 0.5) {
                  if (checkPoint < 1) {
                    rightWidth *= (checkPoint - 0.5) * 2;
                  }

                  ctx.lineTo(leftLeftPos + leftWidth + rightWidth, leftTopPos + leftWidth - rightWidth);
                }

                ctx.stroke();
              }
            } finally {
              ctx.restore();
            }
          }

          exports.drawCheckbox = drawCheckbox;
          /**
           * draw Radio button
           * @param  {CanvasRenderingContext2D} ctx canvas context
           * @param  {number} x The x coordinate where to start drawing the radio button (relative to the canvas)
           * @param  {number} y The y coordinate where to start drawing the radio button (relative to the canvas)
           * @param  {boolean|number} check radio button check status
           * @param  {object} option option
           * @return {void}
           * @memberof cheetahGrid.tools.canvashelper
           */

          function drawRadioButton(ctx, x, y, check) {
            var _ref89 = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {},
                _ref89$checkColor = _ref89.checkColor,
                checkColor = _ref89$checkColor === void 0 ? "rgb(76, 73, 72)" : _ref89$checkColor,
                _ref89$borderColor = _ref89.borderColor,
                borderColor = _ref89$borderColor === void 0 ? "#000" : _ref89$borderColor,
                _ref89$bgColor = _ref89.bgColor,
                bgColor = _ref89$bgColor === void 0 ? "#FFF" : _ref89$bgColor,
                _ref89$boxSize = _ref89.boxSize,
                boxSize = _ref89$boxSize === void 0 ? measureRadioButton(ctx).width : _ref89$boxSize;

            var ratio = typeof check === "number" ? check > 1 ? 1 : check : 1;
            ctx.save();

            try {
              ctx.fillStyle = bgColor;
              var leftX = ceil(x);
              var topY = ceil(y);
              var size = ceil(boxSize);
              fillCircle(ctx, leftX - 1, topY - 1, size + 1, size + 1);
              ctx.lineWidth = 1;
              ctx.strokeStyle = borderColor;
              strokeCircle(ctx, leftX - 0.5, topY - 0.5, size, size);

              if (check) {
                var checkSize = size * ratio / 2;
                var padding = (size - checkSize) / 2;
                ctx.fillStyle = checkColor;
                fillCircle(ctx, ceil((leftX - 0.5 + padding) * 100) / 100, ceil((topY - 0.5 + padding) * 100) / 100, ceil(checkSize * 100) / 100, ceil(checkSize * 100) / 100);
              }
            } finally {
              ctx.restore();
            }
          }

          exports.drawRadioButton = drawRadioButton;
          /**
           * draw Button
           */

          function drawButton(ctx, left, top, width, height) {
            var option = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};
            var _option$backgroundCol = option.backgroundColor,
                backgroundColor = _option$backgroundCol === void 0 ? "#FFF" : _option$backgroundCol,
                _option$bgColor = option.bgColor,
                bgColor = _option$bgColor === void 0 ? backgroundColor : _option$bgColor,
                _option$radius = option.radius,
                radius = _option$radius === void 0 ? 4 : _option$radius,
                _option$shadow = option.shadow,
                shadow = _option$shadow === void 0 ? {} : _option$shadow;
            ctx.save();

            try {
              ctx.fillStyle = bgColor;

              if (shadow) {
                var _shadow$color = shadow.color,
                    color = _shadow$color === void 0 ? "rgba(0, 0, 0, 0.24)" : _shadow$color,
                    _shadow$blur = shadow.blur,
                    blur = _shadow$blur === void 0 ? 1 : _shadow$blur,
                    _shadow$offsetX = shadow.offsetX,
                    offsetX = _shadow$offsetX === void 0 ? 0 : _shadow$offsetX,
                    _shadow$offsetY = shadow.offsetY,
                    offsetY = _shadow$offsetY === void 0 ? 2 : _shadow$offsetY,
                    _shadow$offset = shadow.offset;
                _shadow$offset = _shadow$offset === void 0 ? {} : _shadow$offset;
                var _shadow$offset$x = _shadow$offset.x,
                    ox = _shadow$offset$x === void 0 ? offsetX : _shadow$offset$x,
                    _shadow$offset$y = _shadow$offset.y,
                    oy = _shadow$offset$y === void 0 ? offsetY : _shadow$offset$y;
                ctx.shadowColor = color;
                ctx.shadowBlur = blur; //ぼかし

                ctx.shadowOffsetX = ox;
                ctx.shadowOffsetY = oy;
              }

              fillRoundRect(ctx, ceil(left), ceil(top), ceil(width), ceil(height), radius);
            } finally {
              ctx.restore();
            }
          }

          exports.drawButton = drawButton;
          /***/
        },

        /***/
        "./tooltip/BaseTooltip.js":
        /*!********************************!*\
          !*** ./tooltip/BaseTooltip.js ***!
          \********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function tooltipBaseTooltipJs(module, exports, __webpack_require__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.BaseTooltip = void 0;

          var BaseTooltip = /*#__PURE__*/function () {
            function BaseTooltip(grid) {
              _classCallCheck(this, BaseTooltip);

              this._grid = grid;
            }

            _createClass(BaseTooltip, [{
              key: "dispose",
              value: function dispose() {
                this.detachTooltipElement();

                if (this._tooltipElement) {
                  this._tooltipElement.dispose();
                }

                this._tooltipElement = undefined;
              }
            }, {
              key: "_getTooltipElement",
              value: function _getTooltipElement() {
                if (this._tooltipElement) {
                  return this._tooltipElement;
                }

                return this._tooltipElement = this.createTooltipElementInternal();
              }
            }, {
              key: "attachTooltipElement",
              value: function attachTooltipElement(col, row, content) {
                var tooltipElement = this._getTooltipElement();

                tooltipElement.attach(this._grid, col, row, content);
              }
            }, {
              key: "moveTooltipElement",
              value: function moveTooltipElement(col, row) {
                var tooltipElement = this._getTooltipElement();

                tooltipElement.move(this._grid, col, row);
              }
            }, {
              key: "detachTooltipElement",
              value: function detachTooltipElement() {
                var tooltipElement = this._getTooltipElement();

                tooltipElement._detach();
              }
            }]);

            return BaseTooltip;
          }();

          exports.BaseTooltip = BaseTooltip;
          /***/
        },

        /***/
        "./tooltip/Tooltip.js":
        /*!****************************!*\
          !*** ./tooltip/Tooltip.js ***!
          \****************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function tooltipTooltipJs(module, exports, __nested_webpack_require_1077309__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.Tooltip = void 0;

          var BaseTooltip_1 = __nested_webpack_require_1077309__(
          /*! ./BaseTooltip */
          "./tooltip/BaseTooltip.js");

          var TooltipElement_1 = __nested_webpack_require_1077309__(
          /*! ./internal/TooltipElement */
          "./tooltip/internal/TooltipElement.js");

          var Tooltip = /*#__PURE__*/function (_BaseTooltip_1$BaseTo) {
            _inherits(Tooltip, _BaseTooltip_1$BaseTo);

            var _super75 = _createSuper(Tooltip);

            function Tooltip() {
              _classCallCheck(this, Tooltip);

              return _super75.apply(this, arguments);
            }

            _createClass(Tooltip, [{
              key: "createTooltipElementInternal",
              value: function createTooltipElementInternal() {
                return new TooltipElement_1.TooltipElement();
              }
            }]);

            return Tooltip;
          }(BaseTooltip_1.BaseTooltip);

          exports.Tooltip = Tooltip;
          /***/
        },

        /***/
        "./tooltip/TooltipHandler.js":
        /*!***********************************!*\
          !*** ./tooltip/TooltipHandler.js ***!
          \***********************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function tooltipTooltipHandlerJs(module, exports, __nested_webpack_require_1078861__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.TooltipHandler = void 0;

          var LG_EVENT_TYPE_1 = __nested_webpack_require_1078861__(
          /*! ../list-grid/LG_EVENT_TYPE */
          "./list-grid/LG_EVENT_TYPE.js");

          var Tooltip_1 = __nested_webpack_require_1078861__(
          /*! ./Tooltip */
          "./tooltip/Tooltip.js");

          var utils_1 = __nested_webpack_require_1078861__(
          /*! ../internal/utils */
          "./internal/utils.js");

          var TOOLTIP_INSTANCE_FACTORY = {
            "overflow-text": function overflowText(grid) {
              return new Tooltip_1.Tooltip(grid);
            }
          };

          function getTooltipInstanceInfo( // eslint-disable-next-line @typescript-eslint/no-explicit-any
          grid, col, row) {
            //
            // overflow text tooltip
            var overflowText = grid.getCellOverflowText(col, row);

            if (overflowText) {
              return {
                type: "overflow-text",
                content: overflowText
              };
            }

            return null;
          }

          var TooltipHandler = /*#__PURE__*/function () {
            function TooltipHandler(grid) {
              _classCallCheck(this, TooltipHandler);

              this._grid = grid;
              this._tooltipInstances = {};

              this._bindGridEvent(grid);
            }

            _createClass(TooltipHandler, [{
              key: "dispose",
              value: function dispose() {
                var tooltipInstances = this._tooltipInstances;

                for (var k in tooltipInstances) {
                  tooltipInstances[k].dispose();
                } // @ts-expect-error -- ignore


                delete this._tooltipInstances;
                this._attachInfo = null;
              }
            }, {
              key: "_attach",
              value: function _attach(col, row) {
                var info = this._attachInfo;

                var instanceInfo = this._getTooltipInstanceInfo(col, row);

                if (info && (!instanceInfo || info.instance !== instanceInfo.instance)) {
                  info.instance.detachTooltipElement();
                  this._attachInfo = null;
                }

                if (!instanceInfo) {
                  return;
                }

                var instance = instanceInfo.instance;
                instance.attachTooltipElement(col, row, instanceInfo.content);

                var range = this._grid.getCellRange(col, row);

                this._attachInfo = {
                  range: range,
                  instance: instance
                };
              }
            }, {
              key: "_move",
              value: function _move(col, row) {
                var info = this._attachInfo;

                if (!info || !(0, utils_1.cellInRange)(info.range, col, row)) {
                  return;
                }

                var instance = info.instance;
                instance.moveTooltipElement(col, row);
              }
            }, {
              key: "_detach",
              value: function _detach() {
                var info = this._attachInfo;

                if (!info) {
                  return;
                }

                var instance = info.instance;
                instance.detachTooltipElement();
                this._attachInfo = null;
              }
            }, {
              key: "_isAttachCell",
              value: function _isAttachCell(col, row) {
                var info = this._attachInfo;

                if (!info) {
                  return false;
                }

                return (0, utils_1.cellInRange)(info.range, col, row);
              }
            }, {
              key: "_bindGridEvent",
              value: function _bindGridEvent(grid) {
                var _this111 = this;

                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.MOUSEOVER_CELL, function (e) {
                  if (e.related) {
                    if (_this111._isAttachCell(e.col, e.row)) {
                      return;
                    }
                  }

                  _this111._attach(e.col, e.row);
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.MOUSEOUT_CELL, function (e) {
                  if (e.related) {
                    if (_this111._isAttachCell(e.related.col, e.related.row)) {
                      return;
                    }
                  }

                  _this111._detach();
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.SELECTED_CELL, function (e) {
                  if (_this111._isAttachCell(e.col, e.row)) {
                    _this111._detach();
                  }
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.SCROLL, function () {
                  var info = _this111._attachInfo;

                  if (!info) {
                    return;
                  }

                  _this111._move(info.range.start.col, info.range.start.row);
                });
                grid.listen(LG_EVENT_TYPE_1.LG_EVENT_TYPE.CHANGED_VALUE, function (e) {
                  if (_this111._isAttachCell(e.col, e.row)) {
                    _this111._detach();

                    _this111._attach(e.col, e.row);
                  }
                });
              }
            }, {
              key: "_getTooltipInstanceInfo",
              value: function _getTooltipInstanceInfo(col, row) {
                var grid = this._grid;
                var tooltipInstances = this._tooltipInstances;
                var info = getTooltipInstanceInfo(grid, col, row);

                if (!info) {
                  return null;
                }

                var type = info.type;
                var instance = tooltipInstances[type] || (tooltipInstances[type] = TOOLTIP_INSTANCE_FACTORY[type](grid));
                return {
                  instance: instance,
                  type: type,
                  content: info.content
                };
              }
            }]);

            return TooltipHandler;
          }();

          exports.TooltipHandler = TooltipHandler;
          /***/
        },

        /***/
        "./tooltip/internal/TooltipElement.js":
        /*!********************************************!*\
          !*** ./tooltip/internal/TooltipElement.js ***!
          \********************************************/

        /*! no static exports found */

        /*! ModuleConcatenation bailout: Module is not an ECMAScript module */

        /***/
        function tooltipInternalTooltipElementJs(module, exports, __nested_webpack_require_1085623__) {
          "use strict";

          Object.defineProperty(exports, "__esModule", {
            value: true
          });
          exports.TooltipElement = void 0;

          var EventHandler_1 = __nested_webpack_require_1085623__(
          /*! ../../internal/EventHandler */
          "./internal/EventHandler.js");

          var dom_1 = __nested_webpack_require_1085623__(
          /*! ../../internal/dom */
          "./internal/dom.js");

          var CLASSNAME = "cheetah-grid__tooltip-element";
          var CONTENT_CLASSNAME = "".concat(CLASSNAME, "__content");
          var HIDDEN_CLASSNAME = "".concat(CLASSNAME, "--hidden");
          var SHOWN_CLASSNAME = "".concat(CLASSNAME, "--shown");

          function createTooltipDomElement() {
            __nested_webpack_require_1085623__(
            /*! @/tooltip/internal/TooltipElement.css */
            "../src/js/tooltip/internal/TooltipElement.css");

            var rootElement = (0, dom_1.createElement)("div", {
              classList: [CLASSNAME, HIDDEN_CLASSNAME]
            });
            var messageElement = (0, dom_1.createElement)("pre", {
              classList: [CONTENT_CLASSNAME]
            });
            rootElement.appendChild(messageElement);
            return rootElement;
          }

          var TooltipElement = /*#__PURE__*/function () {
            function TooltipElement() {
              _classCallCheck(this, TooltipElement);

              this._handler = new EventHandler_1.EventHandler();
              var rootElement = this._rootElement = createTooltipDomElement();
              this._messageElement = rootElement.querySelector(".".concat(CONTENT_CLASSNAME));
            }

            _createClass(TooltipElement, [{
              key: "dispose",
              value: function dispose() {
                this.detach();
                var rootElement = this._rootElement;

                if (rootElement.parentElement) {
                  rootElement.parentElement.removeChild(rootElement);
                }

                this._handler.dispose(); // @ts-expect-error -- ignore


                delete this._rootElement; // @ts-expect-error -- ignore

                delete this._messageElement;
              }
            }, {
              key: "attach",
              value: function attach(grid, col, row, content) {
                var rootElement = this._rootElement;
                var messageElement = this._messageElement;
                rootElement.classList.remove(SHOWN_CLASSNAME);
                rootElement.classList.add(HIDDEN_CLASSNAME);

                if (this._attachCell(grid, col, row)) {
                  rootElement.classList.add(SHOWN_CLASSNAME);
                  rootElement.classList.remove(HIDDEN_CLASSNAME);
                  messageElement.textContent = content;
                } else {
                  this._detach();
                }
              }
            }, {
              key: "move",
              value: function move(grid, col, row) {
                var rootElement = this._rootElement;

                if (this._attachCell(grid, col, row)) {
                  rootElement.classList.add(SHOWN_CLASSNAME);
                  rootElement.classList.remove(HIDDEN_CLASSNAME);
                } else {
                  this._detach();
                }
              }
            }, {
              key: "detach",
              value: function detach() {
                this._detach();
              }
            }, {
              key: "_detach",
              value: function _detach() {
                var rootElement = this._rootElement;

                if (rootElement.parentElement) {
                  // rootElement.parentElement.removeChild(rootElement);
                  rootElement.classList.remove(SHOWN_CLASSNAME);
                  rootElement.classList.add(HIDDEN_CLASSNAME);
                }
              }
            }, {
              key: "_attachCell",
              value: function _attachCell(grid, col, row) {
                var rootElement = this._rootElement;

                var _grid$getAttachCellsA8 = grid.getAttachCellsArea(grid.getCellRange(col, row)),
                    element = _grid$getAttachCellsA8.element,
                    rect = _grid$getAttachCellsA8.rect;

                var top = rect.bottom,
                    left = rect.left,
                    width = rect.width;
                var frozenRowCount = grid.frozenRowCount,
                    frozenColCount = grid.frozenColCount;

                if (row >= frozenRowCount && frozenRowCount > 0) {
                  var _grid$getAttachCellsA9 = grid.getAttachCellsArea(grid.getCellRange(col, frozenRowCount - 1)),
                      frozenRect = _grid$getAttachCellsA9.rect;

                  if (top < frozenRect.bottom) {
                    return false; //範囲外
                  }
                } else {
                  if (top < 0) {
                    return false; //範囲外
                  }
                }

                if (col >= frozenColCount && frozenColCount > 0) {
                  var _grid$getAttachCellsA10 = grid.getAttachCellsArea(grid.getCellRange(frozenColCount - 1, row)),
                      _frozenRect5 = _grid$getAttachCellsA10.rect;

                  if (left < _frozenRect5.right) {
                    return false; //範囲外
                  }
                } else {
                  if (left < 0) {
                    return false; //範囲外
                  }
                }

                var _element$getBoundingC = element.getBoundingClientRect(),
                    offsetHeight = _element$getBoundingC.height,
                    offsetWidth = _element$getBoundingC.width,
                    elementLeft = _element$getBoundingC.left,
                    elementRight = _element$getBoundingC.right;

                if (offsetHeight < top) {
                  return false; //範囲外
                }

                if (offsetWidth < left) {
                  return false; //範囲外
                }

                var cellCenter = left + width / 2;
                rootElement.style.top = "".concat(top.toFixed(), "px");
                rootElement.style.left = "".concat(cellCenter.toFixed(), "px");
                rootElement.style.minWidth = "".concat(width.toFixed(), "px");
                var maxWidthForLeft = (elementLeft + cellCenter) * 2;
                var winWidth = window.innerWidth;
                var maxWidthForRight = (offsetWidth - cellCenter + (winWidth - elementRight)) * 2;
                var maxWidth = Math.min(maxWidthForLeft, maxWidthForRight);
                rootElement.style.maxWidth = "".concat(maxWidth.toFixed(), "px");

                if (rootElement.parentElement !== element) {
                  element.appendChild(rootElement);
                }

                return true;
              }
            }]);

            return TooltipElement;
          }();

          exports.TooltipElement = TooltipElement;
          /***/
        }
        /******/

      })
    );
  });
}).call(typeof __webpack_require__.g !== "undefined" ? __webpack_require__.g : window, typeof __webpack_require__.g !== "undefined" ? __webpack_require__.g : window);
})();
//# sourceMappingURL=cheetahGrid.es5.js.map

/***/ }),

/***/ "./srcjs/modules/header.js":
/*!*********************************!*\
  !*** ./srcjs/modules/header.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   asHeader: () => (/* binding */ asHeader)
/* harmony export */ });
const asHeader = (x) => {
  return '<h1>' + x.message + '</h1>';
}




/***/ }),

/***/ "widgets":
/*!******************************!*\
  !*** external "HTMLWidgets" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = HTMLWidgets;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			id: moduleId,
/******/ 			loaded: false,
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/node module decorator */
/******/ 	(() => {
/******/ 		__webpack_require__.nmd = (module) => {
/******/ 			module.paths = [];
/******/ 			if (!module.children) module.children = [];
/******/ 			return module;
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it needs to be in strict mode.
(() => {
"use strict";
/*!**********************************!*\
  !*** ./srcjs/widgets/cheetah.js ***!
  \**********************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var widgets__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets */ "widgets");
/* harmony import */ var widgets__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(widgets__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _modules_header_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/header.js */ "./srcjs/modules/header.js");
/* harmony import */ var cheetah_grid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! cheetah-grid */ "./node_modules/cheetah-grid/dist/cheetahGrid.es5.js");
/* harmony import */ var cheetah_grid__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(cheetah_grid__WEBPACK_IMPORTED_MODULE_2__);




HTMLWidgets.widget({

  name: 'cheetah',

  type: 'output',

  factory: function (el, width, height) {

    let id = el.id;

    return {

      renderValue: function (x, id = el.id) {
        let columns;
        const header = Object.keys(x.data[0])
        const defaultCol = header.map((key) => {
          return ({ field: key, caption: key, width: 'auto' });
        });

        if (x.columns !== null) {
          // Create a lookup map from user input
          const userMap = Object.fromEntries(x.columns.map(item => [item.field, item]));

          // Merge user input values into defaultCol
          columns = defaultCol.map(item => ({
            ...item,
            ...(userMap[item.field] || {})
          }));

        } else {
          columns = defaultCol
        }

        const grid = new cheetah_grid__WEBPACK_IMPORTED_MODULE_2__.ListGrid({
          parentElement: document.getElementById(id),
          header: columns,
          // Array data to be displayed on the grid
          records: x.data,
          // Column fixed position
          // frozenColCount: 1,
        });

        const {
          CLICK_CELL,
          CHANGED_VALUE,
        } = cheetah_grid__WEBPACK_IMPORTED_MODULE_2__.ListGrid.EVENT_TYPE;

        grid.listen(
          CLICK_CELL, (...args) => {
            Shiny.setInputValue(`${id}_click_cell`, args);
          }
        );

        grid.listen(
          CHANGED_VALUE, (...args) => {
            Shiny.setInputValue(`${id}_changed_value`, args);
          }
        );
      },

      resize: function (width, height) {

        // TODO: code to re-render the widget with a new size

      }

    };
  }
});

})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQixpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGtHQUFrRztBQUNsRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBLGtHQUFrRztBQUNsRztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxrR0FBa0c7QUFDbEc7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQSxtR0FBbUc7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7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O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6Qjs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0I7OztBQUdsQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLFFBQVE7QUFDbEMsMEJBQTBCLFFBQVE7QUFDbEMsMEJBQTBCLEdBQUc7QUFDN0I7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixRQUFRO0FBQ2xDLDBCQUEwQixRQUFRO0FBQ2xDLDBCQUEwQixHQUFHO0FBQzdCOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsUUFBUTtBQUNsQywwQkFBMEIsUUFBUTtBQUNsQywwQkFBMEIsR0FBRztBQUM3QjtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsUUFBUTtBQUNsQywwQkFBMEIsUUFBUTtBQUNsQywwQkFBMEIsR0FB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QUFDbkI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7O0FBRWhCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjs7QUFFaEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7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O0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLHdEQUF3RDtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyR0FBMkc7O0FBRTNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLCtEQUErRCxpQ0FBbUI7QUFDbEY7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsWUFBWTtBQUNaO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLDBDQUEwQyxpQ0FBbUI7QUFDN0Q7QUFDQTs7QUFFQSw4QkFBOEIsaUNBQW1CO0FBQ2pEO0FBQ0E7O0FBRUEsc0NBQXNDLGlDQUFtQjtBQUN6RDtBQUNBOztBQUVBLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLDhEQUE4RCxpQ0FBbUI7QUFDakY7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsWUFBWTtBQUNaO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLDBDQUEwQyxpQ0FBbUI7QUFDN0Q7QUFDQTs7QUFFQSw4QkFBOEIsaUNBQW1CO0FBQ2pEO0FBQ0E7O0FBRUEsaUNBQWlDLGlDQUFtQjtBQUNwRDtBQUNBOztBQUVBLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLGlFQUFpRSxpQ0FBbUI7QUFDcEY7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSwrQkFBK0IsaUNBQW1CO0FBQ2xEO0FBQ0E7O0FBRUEsOEJBQThCLGlDQUFtQjtBQUNqRDtBQUNBOztBQUVBLGdDQUFnQyxpQ0FBbUI7QUFDbkQ7QUFDQTs7QUFFQSxpQ0FBaUMsaUNBQW1CO0FBQ3BEO0FBQ0E7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCOzs7QUFHbEIsK0NBQStDOztBQUUvQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxpRUFBaUUsaUNBQW1CO0FBQ3BGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFlBQVk7QUFDWjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSwwQ0FBMEMsaUNBQW1CO0FBQzdEO0FBQ0E7O0FBRUEsOEJBQThCLGlDQUFtQjtBQUNqRDtBQUNBOztBQUVBLHdDQUF3QyxpQ0FBbUI7QUFDM0Q7QUFDQTs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSw4RUFBOEUsaUNBQW1CO0FBQ2pHOztBQUVBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUEsaUNBQWlDLGlDQUFtQjtBQUNwRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLGNBQWMsaUNBQW1CO0FBQ2pDO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLHlFQUF5RSxpQ0FBbUI7QUFDNUY7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSwrQkFBK0IsaUNBQW1CO0FBQ2xEO0FBQ0E7O0FBRUEsc0JBQXNCLGlDQUFtQjtBQUN6QztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGlDQUFtQjtBQUMvQjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHlDQUF5Qzs7O0FBR3pDLDBDQUEwQzs7QUFFMUM7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBLGtCQUFrQjtBQUNsQjtBQUNBLGtDQUFrQztBQUNsQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBLGtCQUFrQjtBQUNsQjtBQUNBLGtDQUFrQztBQUNsQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxnQ0FBZ0M7QUFDaEM7O0FBRUE7QUFDQSxnQ0FBZ0M7QUFDaEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsZ0ZBQWdGLGlDQUFtQjtBQUNuRzs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLGlDQUFpQyxpQ0FBbUI7QUFDcEQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxjQUFjLGlDQUFtQjtBQUNqQztBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSwrREFBK0QsaUNBQW1CO0FBQ2xGOztBQUVBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUEsdUJBQXVCLGlDQUFtQjtBQUMxQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQzs7QUFFMUM7QUFDQTtBQUNBO0FBQ0Esd0ZBQXdGOztBQUV4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQzs7QUFFMUM7QUFDQTtBQUNBO0FBQ0Esd0ZBQXdGOztBQUV4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxpREFBaUQsaUNBQW1CO0FBQ3BFOztBQUVBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUEsNEJBQTRCLGlDQUFtQjtBQUMvQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYLDhCQUE4QixpQ0FBbUI7QUFDakQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCw2QkFBNkIsaUNBQW1CO0FBQ2hEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVgsNEJBQTRCLGlDQUFtQjtBQUMvQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYLDZCQUE2QixpQ0FBbUI7QUFDaEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCw0QkFBNEIsaUNBQW1CO0FBQy9DO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVgscUNBQXFDLGlDQUFtQjtBQUN4RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYLDhCQUE4QixpQ0FBbUI7QUFDakQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCwwQ0FBMEMsaUNBQW1CO0FBQzdEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVgsNkJBQTZCLGlDQUFtQjtBQUNoRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCw0QkFBNEIsaUNBQW1CO0FBQy9DO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQSxnQkFBZ0I7OztBQUdoQjtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLDBEQUEwRCxpQ0FBbUI7QUFDN0U7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSw4QkFBOEIsaUNBQW1CO0FBQ2pEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLGlHQUFpRztBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLGlFQUFpRSxpQ0FBbUI7QUFDcEY7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSw0QkFBNEIsaUNBQW1CO0FBQy9DO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsNERBQTRELGlDQUFtQjtBQUMvRTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsMkRBQTJELGlDQUFtQjtBQUM5RTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLCtCQUErQixpQ0FBbUI7QUFDbEQ7QUFDQTs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLDBEQUEwRCxpQ0FBbUI7QUFDN0U7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsMkRBQTJELGlDQUFtQjtBQUM5RTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLCtCQUErQixpQ0FBbUI7QUFDbEQ7QUFDQTs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLDBEQUEwRCxpQ0FBbUI7QUFDN0U7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsbUVBQW1FLGlDQUFtQjtBQUN0Rjs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLDREQUE0RCxpQ0FBbUI7QUFDL0U7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0Esd0VBQXdFLGlDQUFtQjtBQUMzRjs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLDJEQUEyRCxpQ0FBbUI7QUFDOUU7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSwrQkFBK0IsaUNBQW1CO0FBQ2xEO0FBQ0E7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsNkRBQTZELGlDQUFtQjtBQUNoRjs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLDRCQUE0QixpQ0FBbUI7QUFDL0M7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0Esc0RBQXNELGlDQUFtQjtBQUN6RTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLCtCQUErQixpQ0FBbUI7QUFDbEQ7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsMERBQTBELGlDQUFtQjtBQUM3RTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsZ0RBQWdELGlDQUFtQjtBQUNuRTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLG9DQUFvQyxpQ0FBbUI7QUFDdkQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCwrQkFBK0IsaUNBQW1CO0FBQ2xEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVgsOEJBQThCLGlDQUFtQjtBQUNqRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYLHlCQUF5QixpQ0FBbUI7QUFDNUM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCw2QkFBNkIsaUNBQW1CO0FBQ2hEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVgsOEJBQThCLGlDQUFtQjtBQUNqRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYLDZCQUE2QixpQ0FBbUI7QUFDaEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCxzQ0FBc0MsaUNBQW1CO0FBQ3pEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVgsK0JBQStCLGlDQUFtQjtBQUNsRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYLDJDQUEyQyxpQ0FBbUI7QUFDOUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCw4QkFBOEIsaUNBQW1CO0FBQ2pEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVgsNkJBQTZCLGlDQUFtQjtBQUNoRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSwwREFBMEQsaUNBQW1CO0FBQzdFOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFlBQVk7QUFDWjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSwyQ0FBMkMsaUNBQW1CO0FBQzlEO0FBQ0E7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBLDRCQUE0QixpQ0FBbUI7QUFDL0M7QUFDQTs7QUFFQSwwQkFBMEIsaUNBQW1CO0FBQzdDO0FBQ0E7O0FBRUEsZ0NBQWdDLGlDQUFtQjtBQUNuRDtBQUNBOztBQUVBLDJCQUEyQixpQ0FBbUI7QUFDOUM7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsNERBQTREO0FBQzVEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBLGtCQUFrQjtBQUNsQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7OztBQUdsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxzQ0FBc0M7QUFDdEMsc0JBQXNCO0FBQ3RCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxzRkFBc0Y7O0FBRXRGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUJBQW1CO0FBQ3ZDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLGlFQUFpRSxpQ0FBbUI7QUFDcEY7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUEsNkJBQTZCLGlDQUFtQjtBQUNoRDtBQUNBOztBQUVBLG1DQUFtQyxpQ0FBbUI7QUFDdEQ7QUFDQTs7QUFFQSxnQ0FBZ0MsaUNBQW1CO0FBQ25EO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTs7QUFFQSxnQ0FBZ0MsMkJBQTJCO0FBQzNEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGtDQUFrQyxtQkFBbUI7QUFDckQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGFBQWE7O0FBRWI7QUFDQSxXQUFXOztBQUVYO0FBQ0E7O0FBRUEsNEJBQTRCLG9CQUFvQjtBQUNoRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjs7QUFFakIsZ0NBQWdDLE9BQU87QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsbUJBQW1CO0FBQ25COztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvREFBb0QsWUFBWTtBQUNoRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLGNBQWM7QUFDZDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGVBQWU7QUFDZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsYUFBYTs7QUFFYjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsbUNBQW1DOztBQUVuQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEOztBQUV0RDtB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QUF3QjtBQUN0RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYixxQ0FBcUMsZUFBZTtBQUNwRDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRTs7QUFFaEU7QUFDQTtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBLGtCQUFrQjs7O0FBR2xCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0Esa0JBQWtCOzs7QUFHbEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQ0FBb0M7O0FBRXBDO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxjQUFjO0FBQ2Qsb0NBQW9DOztBQUVwQztBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsY0FBYztBQUNkLG9DQUFvQzs7QUFFcEM7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGNBQWM7QUFDZCxvQ0FBb0M7O0FBRXBDO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxjQUFjO0FBQ2Qsb0NBQW9DOztBQUVwQztBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7O0FBRUE7QUFDQSxjQUFjO0FBQ2Qsb0NBQW9DOztBQUVwQztBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7O0FBRUE7QUFDQSxjQUFjO0FBQ2Qsa0RBQWtEOztBQUVsRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxjQUFjO0FBQ2Qsa0RBQWtEOztBQUVsRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxjQUFjO0FBQ2Qsa0RBQWtEOztBQUVsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGNBQWM7QUFDZDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtB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QUNBLDBCQUEwQixRQUFRO0FBQ2xDOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE1BQU07QUFDaEM7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE1BQU07QUFDaEM7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixpQkFBaUI7QUFDM0M7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCOztBQUVBOztBQUVBO0FBQ0EsK0pBQStKOztBQUUvSjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVztBQUNYOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpSEFBaUg7O0FBRWpIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjs7QUFFakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsYUFBYTtBQUN0Qzs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxnQkFBZ0I7O0FBRWhCLGFBQWE7QUFDYjtBQUNBO0FBQ0EsZ0VBQWdFOztBQUVoRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7O0FBRUEs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QUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsNERBQTRELGlDQUFtQjtBQUMvRTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLDRCQUE0QixpQ0FBbUI7QUFDL0M7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EseUVBQXlFLGlDQUFtQjtBQUM1Rjs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLG1DQUFtQyxpQ0FBbUI7QUFDdEQ7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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VDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsMENBQTBDLGlDQUFtQjtBQUM3RDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBLHdCQUF3QixpQ0FBbUI7QUFDM0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFD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QTtBQUNBLGFBQWE7O0FBRWI7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLHVEQUF1RCxpQ0FBbUI7QUFDMUU7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsWUFBWTtBQUNaO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLG1DQUFtQyxpQ0FBbUI7QUFDdEQ7QUFDQTs7QUFFQSwrQkFBK0IsaUNBQW1CO0FBQ2xEO0FBQ0E7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLG1FQUFtRSxtR0FBbUc7QUFDdEs7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7O0FBRWxCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyRkFBMkY7QUFDM0Y7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLG9EQUFvRCxpQ0FBbUI7QUFDdkU7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQSx3QkFBd0IsaUNBQW1CO0FBQzNDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCOztBQUVoQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsUUFBUTtBQUM3QixxQkFBcUIsVUFBVTtBQUMvQixxQkFBcUIsaUJBQWlCO0FBQ3RDLHVCQUF1QixRQUFRO0FBQy9COzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLGNBQWM7QUFDZCxrREFBa0QsZ0JBQWdCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxpREFBaUQsaUNBQW1CO0FBQ3BFOztBQUVBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUEsd0JBQXdCLGlDQUFtQjtBQUMzQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsUUFBUTtBQUM3Qix1QkFBdUIsT0FBTztBQUM5QjtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQ0FBZ0MsYUFBYTtBQUM3QztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsZ0JBQWdCLDRCQUE0QjtBQUM1QyxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHFCQUFxQixhQUFhO0FBQ2xDOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxxQkFBcUIsYUFBYTtBQUNsQzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsbUJBQW1COztBQUVuQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsK0ZBQStGO0FBQy9GO0FBQ0E7QUFDQTs7QUFFQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7O0FBRUE7QUFDQSwrRkFBK0Y7QUFDL0Y7QUFDQTtBQUNBOztBQUVBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDhCQUE4QjtBQUM5Qjs7QUFFQTtBQUNBLHdCQUF3QjtBQUN4Qjs7QUFFQTtBQUNBLHdCQUF3QjtBQUN4Qjs7QUFFQSxzQkFBc0I7QUFDdEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxZQUFZOzs7QUFHWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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OztBQUVBOztBQUVBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtB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O1dDUEE7V0FDQTtXQUNBO1dBQ0E7V0FDQSx5Q0FBeUMsd0NBQXdDO1dBQ2pGO1dBQ0E7V0FDQTs7Ozs7V0NQQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLEdBQUc7V0FDSDtXQUNBO1dBQ0EsQ0FBQzs7Ozs7V0NQRDs7Ozs7V0NBQTtXQUNBO1dBQ0E7V0FDQSx1REFBdUQsaUJBQWlCO1dBQ3hFO1dBQ0EsZ0RBQWdELGFBQWE7V0FDN0Q7Ozs7O1dDTkE7V0FDQTtXQUNBO1dBQ0E7V0FDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNKaUI7QUFDK0I7QUFDSjs7QUFFNUM7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IseUNBQXlDO0FBQzdELFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QyxXQUFXOztBQUVYLFVBQVU7QUFDVjtBQUNBOztBQUVBLHlCQUF5QixrREFBb0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQSxVQUFVLEVBQUUsa0RBQW9COztBQUVoQztBQUNBO0FBQ0EsbUNBQW1DLEdBQUc7QUFDdEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsbUNBQW1DLEdBQUc7QUFDdEM7QUFDQTtBQUNBLE9BQU87O0FBRVA7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGVldGFoci8uL25vZGVfbW9kdWxlcy9jaGVldGFoLWdyaWQvZGlzdC9jaGVldGFoR3JpZC5lczUuanMiLCJ3ZWJwYWNrOi8vY2hlZXRhaHIvLi9zcmNqcy9tb2R1bGVzL2hlYWRlci5qcyIsIndlYnBhY2s6Ly9jaGVldGFoci9leHRlcm5hbCB2YXIgXCJIVE1MV2lkZ2V0c1wiIiwid2VicGFjazovL2NoZWV0YWhyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2NoZWV0YWhyL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL2NoZWV0YWhyL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9jaGVldGFoci93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL2NoZWV0YWhyL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vY2hlZXRhaHIvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9jaGVldGFoci93ZWJwYWNrL3J1bnRpbWUvbm9kZSBtb2R1bGUgZGVjb3JhdG9yIiwid2VicGFjazovL2NoZWV0YWhyLy4vc3JjanMvd2lkZ2V0cy9jaGVldGFoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISBDaGVldGFoIEdyaWQgdjEuMTYuMCB8IGxpY2Vuc2UgTUlUICovXG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBzZXQodGFyZ2V0LCBwcm9wZXJ0eSwgdmFsdWUsIHJlY2VpdmVyKSB7IGlmICh0eXBlb2YgUmVmbGVjdCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBSZWZsZWN0LnNldCkgeyBzZXQgPSBSZWZsZWN0LnNldDsgfSBlbHNlIHsgc2V0ID0gZnVuY3Rpb24gc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlcikgeyB2YXIgYmFzZSA9IF9zdXBlclByb3BCYXNlKHRhcmdldCwgcHJvcGVydHkpOyB2YXIgZGVzYzsgaWYgKGJhc2UpIHsgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYmFzZSwgcHJvcGVydHkpOyBpZiAoZGVzYy5zZXQpIHsgZGVzYy5zZXQuY2FsbChyZWNlaXZlciwgdmFsdWUpOyByZXR1cm4gdHJ1ZTsgfSBlbHNlIGlmICghZGVzYy53cml0YWJsZSkgeyByZXR1cm4gZmFsc2U7IH0gfSBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihyZWNlaXZlciwgcHJvcGVydHkpOyBpZiAoZGVzYykgeyBpZiAoIWRlc2Mud3JpdGFibGUpIHsgcmV0dXJuIGZhbHNlOyB9IGRlc2MudmFsdWUgPSB2YWx1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlY2VpdmVyLCBwcm9wZXJ0eSwgZGVzYyk7IH0gZWxzZSB7IF9kZWZpbmVQcm9wZXJ0eShyZWNlaXZlciwgcHJvcGVydHksIHZhbHVlKTsgfSByZXR1cm4gdHJ1ZTsgfTsgfSByZXR1cm4gc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlcik7IH1cblxuZnVuY3Rpb24gX3NldCh0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSwgcmVjZWl2ZXIsIGlzU3RyaWN0KSB7IHZhciBzID0gc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlciB8fCB0YXJnZXQpOyBpZiAoIXMgJiYgaXNTdHJpY3QpIHsgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gc2V0IHByb3BlcnR5Jyk7IH0gcmV0dXJuIHZhbHVlOyB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5cbmZ1bmN0aW9uIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ICE9PSBcInVuZGVmaW5lZFwiICYmIFJlZmxlY3QuZ2V0KSB7IF9nZXQgPSBSZWZsZWN0LmdldDsgfSBlbHNlIHsgX2dldCA9IGZ1bmN0aW9uIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgdmFyIGJhc2UgPSBfc3VwZXJQcm9wQmFzZSh0YXJnZXQsIHByb3BlcnR5KTsgaWYgKCFiYXNlKSByZXR1cm47IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihiYXNlLCBwcm9wZXJ0eSk7IGlmIChkZXNjLmdldCkgeyByZXR1cm4gZGVzYy5nZXQuY2FsbChyZWNlaXZlcik7IH0gcmV0dXJuIGRlc2MudmFsdWU7IH07IH0gcmV0dXJuIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIgfHwgdGFyZ2V0KTsgfVxuXG5mdW5jdGlvbiBfc3VwZXJQcm9wQmFzZShvYmplY3QsIHByb3BlcnR5KSB7IHdoaWxlICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7IG9iamVjdCA9IF9nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAob2JqZWN0ID09PSBudWxsKSBicmVhazsgfSByZXR1cm4gb2JqZWN0OyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH1cblxuZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfVxuXG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9XG5cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH1cblxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpdGVyW1N5bWJvbC5pdGVyYXRvcl0gIT0gbnVsbCB8fCBpdGVyW1wiQEBpdGVyYXRvclwiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfVxuXG5mdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9XG5cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfVxuXG5mdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbihmdW5jdGlvbiAod2luZG93KSB7XG4gIChmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG4gICAgaWYgKCh0eXBlb2YgZXhwb3J0cyA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKGV4cG9ydHMpKSA9PT0gJ29iamVjdCcgJiYgKHR5cGVvZiBtb2R1bGUgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihtb2R1bGUpKSA9PT0gJ29iamVjdCcpIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO2Vsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgZGVmaW5lKFtdLCBmYWN0b3J5KTtlbHNlIGlmICgodHlwZW9mIGV4cG9ydHMgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihleHBvcnRzKSkgPT09ICdvYmplY3QnKSBleHBvcnRzW1wiY2hlZXRhaEdyaWRcIl0gPSBmYWN0b3J5KCk7ZWxzZSByb290W1wiY2hlZXRhaEdyaWRcIl0gPSBmYWN0b3J5KCk7XG4gIH0pKHdpbmRvdywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAoXG4gICAgICAvKioqKioqL1xuICAgICAgZnVuY3Rpb24gKG1vZHVsZXMpIHtcbiAgICAgICAgLy8gd2VicGFja0Jvb3RzdHJhcFxuXG4gICAgICAgIC8qKioqKiovXG4gICAgICAgIC8vIFRoZSBtb2R1bGUgY2FjaGVcblxuICAgICAgICAvKioqKioqL1xuICAgICAgICB2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuICAgICAgICAvKioqKioqL1xuXG4gICAgICAgIC8qKioqKiovXG4gICAgICAgIC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5cbiAgICAgICAgLyoqKioqKi9cblxuICAgICAgICBmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cbiAgICAgICAgICAvKioqKioqL1xuICAgICAgICAgIGlmIChpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuICAgICAgICAgICAgLyoqKioqKi9cbiAgICAgICAgICAgIHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuICAgICAgICAgICAgLyoqKioqKi9cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqKioqKi9cbiAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXG4gICAgICAgICAgLyoqKioqKi9cblxuXG4gICAgICAgICAgdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuICAgICAgICAgICAgLyoqKioqKi9cbiAgICAgICAgICAgIGk6IG1vZHVsZUlkLFxuXG4gICAgICAgICAgICAvKioqKioqL1xuICAgICAgICAgICAgbDogZmFsc2UsXG5cbiAgICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgICBleHBvcnRzOiB7fVxuICAgICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIH07XG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cbiAgICAgICAgICAvKioqKioqL1xuXG4gICAgICAgICAgbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuXG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIG1vZHVsZS5sID0gdHJ1ZTtcbiAgICAgICAgICAvKioqKioqL1xuXG4gICAgICAgICAgLyoqKioqKi9cbiAgICAgICAgICAvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiAgICAgICAgICAvKioqKioqL1xuICAgICAgICB9XG4gICAgICAgIC8qKioqKiovXG5cbiAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAvKioqKioqL1xuICAgICAgICAvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuXG4gICAgICAgIC8qKioqKiovXG5cblxuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuICAgICAgICAvKioqKioqL1xuXG4gICAgICAgIC8qKioqKiovXG4gICAgICAgIC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG5cbiAgICAgICAgLyoqKioqKi9cblxuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuICAgICAgICAvKioqKioqL1xuXG4gICAgICAgIC8qKioqKiovXG4gICAgICAgIC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuXG4gICAgICAgIC8qKioqKiovXG5cbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24gKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgaWYgKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiAgICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICBnZXQ6IGdldHRlclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvKioqKioqL1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKioqKioqL1xuXG4gICAgICAgIH07XG4gICAgICAgIC8qKioqKiovXG5cbiAgICAgICAgLyoqKioqKi9cbiAgICAgICAgLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuXG4gICAgICAgIC8qKioqKiovXG5cblxuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbiAoZXhwb3J0cykge1xuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuICAgICAgICAgICAgLyoqKioqKi9cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHtcbiAgICAgICAgICAgICAgdmFsdWU6ICdNb2R1bGUnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKioqKiovXG5cblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLyoqKioqKi9cbiAgICAgICAgfTtcbiAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAvKioqKioqL1xuICAgICAgICAvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcblxuICAgICAgICAvKioqKioqL1xuICAgICAgICAvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcblxuICAgICAgICAvKioqKioqL1xuICAgICAgICAvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcblxuICAgICAgICAvKioqKioqL1xuICAgICAgICAvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcblxuICAgICAgICAvKioqKioqL1xuICAgICAgICAvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG5cbiAgICAgICAgLyoqKioqKi9cblxuXG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uICh2YWx1ZSwgbW9kZSkge1xuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgaWYgKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuICAgICAgICAgIC8qKioqKiovXG5cbiAgICAgICAgICBpZiAobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAvKioqKioqL1xuXG4gICAgICAgICAgaWYgKG1vZGUgJiA0ICYmIF90eXBlb2YodmFsdWUpID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gICAgICAgICAgLyoqKioqKi9cblxuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvKioqKioqL1xuXG4gICAgICAgICAgaWYgKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7XG4gICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICByZXR1cm4gdmFsdWVba2V5XTtcbiAgICAgICAgICAgIH0uYmluZChudWxsLCBrZXkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIHJldHVybiBucztcbiAgICAgICAgICAvKioqKioqL1xuICAgICAgICB9O1xuICAgICAgICAvKioqKioqL1xuXG4gICAgICAgIC8qKioqKiovXG4gICAgICAgIC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5cbiAgICAgICAgLyoqKioqKi9cblxuXG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uIChtb2R1bGUpIHtcbiAgICAgICAgICAvKioqKioqL1xuICAgICAgICAgIHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTtcbiAgICAgICAgICB9IDpcbiAgICAgICAgICAvKioqKioqL1xuICAgICAgICAgIGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgICAgICAgIH07XG4gICAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiAgICAgICAgICAvKioqKioqL1xuXG5cbiAgICAgICAgICByZXR1cm4gZ2V0dGVyO1xuICAgICAgICAgIC8qKioqKiovXG4gICAgICAgIH07XG4gICAgICAgIC8qKioqKiovXG5cbiAgICAgICAgLyoqKioqKi9cbiAgICAgICAgLy8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG5cbiAgICAgICAgLyoqKioqKi9cblxuXG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uIChvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqKioqKi9cblxuICAgICAgICAvKioqKioqL1xuICAgICAgICAvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuXG4gICAgICAgIC8qKioqKiovXG5cblxuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuICAgICAgICAvKioqKioqL1xuXG4gICAgICAgIC8qKioqKiovXG5cbiAgICAgICAgLyoqKioqKi9cbiAgICAgICAgLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5cbiAgICAgICAgLyoqKioqKi9cblxuICAgICAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vbWFpbi5qc1wiKTtcbiAgICAgICAgLyoqKioqKi9cbiAgICAgIH0oXG4gICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAvKioqKioqL1xuICAgICAge1xuICAgICAgICAvKioqL1xuICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPyEuLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPyEuLi9zcmMvanMvY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvSW5saW5lSW5wdXRFbGVtZW50LmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTUtMSEuLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjPz9yZWYtLTUtMiEuLi9zcmMvanMvY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvSW5saW5lSW5wdXRFbGVtZW50LmNzcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgZXhwb3J0cyBwcm92aWRlZDogZGVmYXVsdCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSB1c2VzIG1vZHVsZS5pZCAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIG5vZGVfbW9kdWxlc0Nzc0xvYWRlckRpc3RDanNKc05vZGVfbW9kdWxlc1Bvc3Rjc3NMb2FkZXJTcmNJbmRleEpzU3JjSnNDb2x1bW5zQWN0aW9uSW50ZXJuYWxJbmxpbmVJbnB1dEVsZW1lbnRDc3MobW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4gICAgICAgICAgLyogaGFybW9ueSBpbXBvcnQgKi9cblxuXG4gICAgICAgICAgdmFyIF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzICovXG4gICAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpO1xuICAgICAgICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovXG5cblxuICAgICAgICAgIHZhciBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18pOyAvLyBJbXBvcnRzXG5cblxuICAgICAgICAgIHZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19fZGVmYXVsdCgpKGZhbHNlKTsgLy8gTW9kdWxlXG5cblxuICAgICAgICAgIF9fX0NTU19MT0FERVJfRVhQT1JUX19fLnB1c2goW21vZHVsZS5pLCBcIi5jaGVldGFoLWdyaWRfX2lubGluZS1pbnB1dDo6LW1zLWNsZWFye3Zpc2liaWxpdHk6aGlkZGVufS5jaGVldGFoLWdyaWRfX2lubGluZS1pbnB1dHtwb3NpdGlvbjphYnNvbHV0ZTstd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDtib3gtc2l6aW5nOmJvcmRlci1ib3h9XCIsIFwiXCJdKTsgLy8gRXhwb3J0c1xuXG4gICAgICAgICAgLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqL1xuXG5cbiAgICAgICAgICBfX3dlYnBhY2tfZXhwb3J0c19fW1wiZGVmYXVsdFwiXSA9IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8hLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8hLi4vc3JjL2pzL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL0lubGluZU1lbnVFbGVtZW50LmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tNS0xIS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmM/P3JlZi0tNS0yIS4uL3NyYy9qcy9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVNZW51RWxlbWVudC5jc3MgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgZXhwb3J0cyBwcm92aWRlZDogZGVmYXVsdCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSB1c2VzIG1vZHVsZS5pZCAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIG5vZGVfbW9kdWxlc0Nzc0xvYWRlckRpc3RDanNKc05vZGVfbW9kdWxlc1Bvc3Rjc3NMb2FkZXJTcmNJbmRleEpzU3JjSnNDb2x1bW5zQWN0aW9uSW50ZXJuYWxJbmxpbmVNZW51RWxlbWVudENzcyhtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtcbiAgICAgICAgICAvKiBoYXJtb255IGltcG9ydCAqL1xuXG5cbiAgICAgICAgICB2YXIgX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanMgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIik7XG4gICAgICAgICAgLyogaGFybW9ueSBpbXBvcnQgKi9cblxuXG4gICAgICAgICAgdmFyIF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19fZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9fX3dlYnBhY2tfcmVxdWlyZV9fLm4oX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyk7IC8vIEltcG9ydHNcblxuXG4gICAgICAgICAgdmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX19kZWZhdWx0KCkoZmFsc2UpOyAvLyBNb2R1bGVcblxuXG4gICAgICAgICAgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18ucHVzaChbbW9kdWxlLmksIFwiLmNoZWV0YWgtZ3JpZF9faW5saW5lLW1lbnV7cG9zaXRpb246YWJzb2x1dGU7Y29sb3I6cmdiYSgwLDAsMCwuODcpOy13ZWJraXQtYm94LXNpemluZzpjb250ZW50LWJveDtib3gtc2l6aW5nOmNvbnRlbnQtYm94O21hcmdpbjotMXB4IGF1dG8gYXV0byAtMXB4O3BhZGRpbmc6OHB4IDA7YmFja2dyb3VuZC1jb2xvcjojZmFmYWZhO2xpc3Qtc3R5bGUtdHlwZTpub25lO2JvcmRlci1yYWRpdXM6MnB4O21heC1oZWlnaHQ6Y2FsYygxMDB2aCAtIDQwcHgpO292ZXJmbG93LXk6YXV0b30uY2hlZXRhaC1ncmlkX19pbmxpbmUtbWVudS0taGlkZGVuey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKC45KTt0cmFuc2Zvcm06c2NhbGUoLjkpOy13ZWJraXQtYm94LXNoYWRvdzpub25lO2JveC1zaGFkb3c6bm9uZTtvcGFjaXR5OjA7cG9pbnRlci1ldmVudHM6bm9uZTstd2Via2l0LXRyYW5zaXRpb246YWxsIDUwbXMgZWFzZS1vdXQ7dHJhbnNpdGlvbjphbGwgNTBtcyBlYXNlLW91dH0uY2hlZXRhaC1ncmlkX19pbmxpbmUtbWVudS0taGlkZGVuICp7cG9pbnRlci1ldmVudHM6bm9uZX0uY2hlZXRhaC1ncmlkX19pbmxpbmUtbWVudS0tc2hvd257LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtN3B4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtN3B4KTstd2Via2l0LWJveC1zaGFkb3c6MCAzcHggMXB4IC0ycHggcmdiYSgwLDAsMCwuMiksMCAycHggMnB4IDAgcmdiYSgwLDAsMCwuMTQpLDAgMXB4IDVweCAwIHJnYmEoMCwwLDAsLjEyKTtib3gtc2hhZG93OjAgM3B4IDFweCAtMnB4IHJnYmEoMCwwLDAsLjIpLDAgMnB4IDJweCAwIHJnYmEoMCwwLDAsLjE0KSwwIDFweCA1cHggMCByZ2JhKDAsMCwwLC4xMik7b3BhY2l0eToxOy13ZWJraXQtdHJhbnNpdGlvbjphbGwgLjE1cyBlYXNlLW91dDt0cmFuc2l0aW9uOmFsbCAuMTVzIGVhc2Utb3V0fS5jaGVldGFoLWdyaWRfX2lubGluZS1tZW51X19tZW51LWl0ZW17aGVpZ2h0OjEwMCU7LXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94O2Rpc3BsYXk6LXdlYmtpdC1ib3g7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LXdlYmtpdC1ib3gtYWxpZ246Y2VudGVyOy1tcy1mbGV4LWFsaWduOmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7LXdlYmtpdC1ib3gtcGFjazpzdGFydDstbXMtZmxleC1wYWNrOnN0YXJ0O2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O291dGxpbmU6bm9uZTtjdXJzb3I6cG9pbnRlcjtwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW47cGFkZGluZzowIDE2cHh9LmNoZWV0YWgtZ3JpZF9faW5saW5lLW1lbnVfX21lbnUtaXRlbS0tZW1wdHl7Y29sb3I6cmdiYSgwLDAsMCwuMzgpfS5jaGVldGFoLWdyaWRfX2lubGluZS1tZW51X19tZW51LWl0ZW06YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXCI7cG9zaXRpb246YWJzb2x1dGU7dG9wOi01MCU7bGVmdDotNTAlO3dpZHRoOjIwMCU7aGVpZ2h0OjIwMCU7YmFja2dyb3VuZC1jb2xvcjojMDAwO29wYWNpdHk6MDtwb2ludGVyLWV2ZW50czpub25lOy13ZWJraXQtdHJhbnNpdGlvbjpvcGFjaXR5IDE1bXMgbGluZWFyO3RyYW5zaXRpb246b3BhY2l0eSAxNW1zIGxpbmVhcn0uY2hlZXRhaC1ncmlkX19pbmxpbmUtbWVudV9fbWVudS1pdGVtOmhvdmVyOmJlZm9yZSwuY2hlZXRhaC1ncmlkX19pbmxpbmUtbWVudV9fbWVudS1pdGVtW2RhdGEtc2VsZWN0XTpiZWZvcmV7b3BhY2l0eTouMDR9LmNoZWV0YWgtZ3JpZF9faW5saW5lLW1lbnVfX21lbnUtaXRlbTpmb2N1czpiZWZvcmV7b3BhY2l0eTouMTJ9XCIsIFwiXCJdKTsgLy8gRXhwb3J0c1xuXG4gICAgICAgICAgLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqL1xuXG5cbiAgICAgICAgICBfX3dlYnBhY2tfZXhwb3J0c19fW1wiZGVmYXVsdFwiXSA9IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8hLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8hLi4vc3JjL2pzL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL1NtYWxsRGlhbG9nSW5wdXRFbGVtZW50LmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tNS0xIS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmM/P3JlZi0tNS0yIS4uL3NyYy9qcy9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9TbWFsbERpYWxvZ0lucHV0RWxlbWVudC5jc3MgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgZXhwb3J0cyBwcm92aWRlZDogZGVmYXVsdCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSB1c2VzIG1vZHVsZS5pZCAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIG5vZGVfbW9kdWxlc0Nzc0xvYWRlckRpc3RDanNKc05vZGVfbW9kdWxlc1Bvc3Rjc3NMb2FkZXJTcmNJbmRleEpzU3JjSnNDb2x1bW5zQWN0aW9uSW50ZXJuYWxTbWFsbERpYWxvZ0lucHV0RWxlbWVudENzcyhtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtcbiAgICAgICAgICAvKiBoYXJtb255IGltcG9ydCAqL1xuXG5cbiAgICAgICAgICB2YXIgX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanMgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIik7XG4gICAgICAgICAgLyogaGFybW9ueSBpbXBvcnQgKi9cblxuXG4gICAgICAgICAgdmFyIF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19fZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9fX3dlYnBhY2tfcmVxdWlyZV9fLm4oX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyk7IC8vIEltcG9ydHNcblxuXG4gICAgICAgICAgdmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX19kZWZhdWx0KCkoZmFsc2UpOyAvLyBNb2R1bGVcblxuXG4gICAgICAgICAgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18ucHVzaChbbW9kdWxlLmksIFwiLmNoZWV0YWgtZ3JpZF9fc21hbGwtZGlhbG9nLWlucHV0X19pbnB1dDo6LW1zLWNsZWFye3Zpc2liaWxpdHk6aGlkZGVufUAtd2Via2l0LWtleWZyYW1lcyBjaGVldGFoLWdyaWRfX3NtYWxsLWRpYWxvZy1pbnB1dC0taGlkZGVuLWFuaW1hdGlvbnswJXtvcGFjaXR5OjF9OTkle29wYWNpdHk6MX10b3tvcGFjaXR5OjB9fUBrZXlmcmFtZXMgY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXQtLWhpZGRlbi1hbmltYXRpb257MCV7b3BhY2l0eToxfTk5JXtvcGFjaXR5OjF9dG97b3BhY2l0eTowfX0uY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXR7cG9zaXRpb246YWJzb2x1dGU7LXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O2JveC1zaXppbmc6Y29udGVudC1ib3g7bWFyZ2luOi0xcHggYXV0byBhdXRvIC0xcHg7Ym9yZGVyLXJhZGl1czozcHg7YmFja2dyb3VuZC1jb2xvcjojZmFmYWZhOy13ZWJraXQtdHJhbnNpdGlvbjpwYWRkaW5nIC4xNXMgZWFzZS1vdXQsLXdlYmtpdC1ib3gtc2hhZG93IC4xNXMgZWFzZS1vdXQ7dHJhbnNpdGlvbjpwYWRkaW5nIC4xNXMgZWFzZS1vdXQsLXdlYmtpdC1ib3gtc2hhZG93IC4xNXMgZWFzZS1vdXQ7dHJhbnNpdGlvbjpwYWRkaW5nIC4xNXMgZWFzZS1vdXQsYm94LXNoYWRvdyAuMTVzIGVhc2Utb3V0O3RyYW5zaXRpb246cGFkZGluZyAuMTVzIGVhc2Utb3V0LGJveC1zaGFkb3cgLjE1cyBlYXNlLW91dCwtd2Via2l0LWJveC1zaGFkb3cgLjE1cyBlYXNlLW91dH0uY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXQtLWhpZGRlbnstd2Via2l0LWJveC1zaGFkb3c6bm9uZTtib3gtc2hhZG93Om5vbmU7cGFkZGluZzowO3BvaW50ZXItZXZlbnRzOm5vbmU7LXdlYmtpdC1hbmltYXRpb246Y2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXQtLWhpZGRlbi1hbmltYXRpb24gLjE1cyBlYXNlLW91dDthbmltYXRpb246Y2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXQtLWhpZGRlbi1hbmltYXRpb24gLjE1cyBlYXNlLW91dDtvcGFjaXR5OjB9LmNoZWV0YWgtZ3JpZF9fc21hbGwtZGlhbG9nLWlucHV0LS1zaG93bnstd2Via2l0LWJveC1zaGFkb3c6MCAzcHggMXB4IC0ycHggcmdiYSgwLDAsMCwuMiksMCAycHggMnB4IDAgcmdiYSgwLDAsMCwuMTQpLDAgMXB4IDVweCAwIHJnYmEoMCwwLDAsLjEyKTtib3gtc2hhZG93OjAgM3B4IDFweCAtMnB4IHJnYmEoMCwwLDAsLjIpLDAgMnB4IDJweCAwIHJnYmEoMCwwLDAsLjE0KSwwIDFweCA1cHggMCByZ2JhKDAsMCwwLC4xMik7cGFkZGluZzo4cHggMjRweH0uY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXRfX2lucHV0e3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7LXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94O3BhZGRpbmc6M3B4IDJweCAwIDRweDtib3JkZXI6bm9uZTtib3JkZXItYm90dG9tOjFweCBzb2xpZCByZ2JhKDAsMCwwLC44Nyk7b3V0bGluZTpub25lO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7LXdlYmtpdC10cmFuc2l0aW9uOmFsbCAuM3MgZWFzZS1vdXQ7dHJhbnNpdGlvbjphbGwgLjNzIGVhc2Utb3V0fS5jaGVldGFoLWdyaWRfX3NtYWxsLWRpYWxvZy1pbnB1dF9faW5wdXQ6Zm9jdXN7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgIzIxOTZmMzstd2Via2l0LWJveC1zaGFkb3c6MCAxcHggMCAwICMyMTk2ZjM7Ym94LXNoYWRvdzowIDFweCAwIDAgIzIxOTZmM30uY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXQ6YWZ0ZXJ7Y29udGVudDpcXFwiXFxcIjtmb250LWZhbWlseTpSb2JvdG87Zm9udC1zaXplOjEycHg7Zm9udC1zaXplOi43NXJlbTttaW4taGVpZ2h0OjFlbTtsaW5lLWhlaWdodDoxO2Rpc3BsYXk6YmxvY2s7d2lkdGg6MTAwJTtwYWRkaW5nLXRvcDo4cHh9LmNoZWV0YWgtZ3JpZF9fc21hbGwtZGlhbG9nLWlucHV0LmhlbHBlci10ZXh0LS1yaWdodC1qdXN0aWZpZWQ6YWZ0ZXJ7dGV4dC1hbGlnbjpyaWdodH0uY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXRbZGF0YS1oZWxwZXItdGV4dF06YWZ0ZXJ7Y29udGVudDphdHRyKGRhdGEtaGVscGVyLXRleHQpO2NvbG9yOnJnYmEoMCwwLDAsLjg3KX0uY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXRbZGF0YS1lcnJvci1tZXNzYWdlXSBpbnB1dHtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjZmYxNzQ0Oy13ZWJraXQtYm94LXNoYWRvdzowIDFweCAwIDAgI2ZmMTc0NDtib3gtc2hhZG93OjAgMXB4IDAgMCAjZmYxNzQ0fS5jaGVldGFoLWdyaWRfX3NtYWxsLWRpYWxvZy1pbnB1dFtkYXRhLWVycm9yLW1lc3NhZ2VdOmFmdGVye2NvbnRlbnQ6YXR0cihkYXRhLWVycm9yLW1lc3NhZ2UpO2NvbG9yOiNmZjE3NDQ7dGV4dC1hbGlnbjpsZWZ0fVwiLCBcIlwiXSk7IC8vIEV4cG9ydHNcblxuICAgICAgICAgIC8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi9cblxuXG4gICAgICAgICAgX193ZWJwYWNrX2V4cG9ydHNfX1tcImRlZmF1bHRcIl0gPSBfX19DU1NfTE9BREVSX0VYUE9SVF9fXztcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvRXJyb3JNZXNzYWdlRWxlbWVudC5jc3NcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTUtMSEuLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjPz9yZWYtLTUtMiEuLi9zcmMvanMvY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL0Vycm9yTWVzc2FnZUVsZW1lbnQuY3NzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIGV4cG9ydHMgcHJvdmlkZWQ6IGRlZmF1bHQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgdXNlcyBtb2R1bGUuaWQgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBub2RlX21vZHVsZXNDc3NMb2FkZXJEaXN0Q2pzSnNOb2RlX21vZHVsZXNQb3N0Y3NzTG9hZGVyU3JjSW5kZXhKc1NyY0pzQ29sdW1uc01lc3NhZ2VJbnRlcm5hbEVycm9yTWVzc2FnZUVsZW1lbnRDc3MobW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4gICAgICAgICAgLyogaGFybW9ueSBpbXBvcnQgKi9cblxuXG4gICAgICAgICAgdmFyIF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzICovXG4gICAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpO1xuICAgICAgICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovXG5cblxuICAgICAgICAgIHZhciBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18pOyAvLyBJbXBvcnRzXG5cblxuICAgICAgICAgIHZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19fZGVmYXVsdCgpKGZhbHNlKTsgLy8gTW9kdWxlXG5cblxuICAgICAgICAgIF9fX0NTU19MT0FERVJfRVhQT1JUX19fLnB1c2goW21vZHVsZS5pLCBcIi5jaGVldGFoLWdyaWRfX2Vycm9yLW1lc3NhZ2UtZWxlbWVudHtib3JkZXItdG9wOjFweCBzb2xpZCAjZmYxNzQ0O2NvbG9yOiNmZjE3NDR9XCIsIFwiXCJdKTsgLy8gRXhwb3J0c1xuXG4gICAgICAgICAgLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqL1xuXG5cbiAgICAgICAgICBfX3dlYnBhY2tfZXhwb3J0c19fW1wiZGVmYXVsdFwiXSA9IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8hLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8hLi4vc3JjL2pzL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9NZXNzYWdlRWxlbWVudC5jc3NcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8/cmVmLS01LTEhLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYz8/cmVmLS01LTIhLi4vc3JjL2pzL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9NZXNzYWdlRWxlbWVudC5jc3MgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIGV4cG9ydHMgcHJvdmlkZWQ6IGRlZmF1bHQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgdXNlcyBtb2R1bGUuaWQgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBub2RlX21vZHVsZXNDc3NMb2FkZXJEaXN0Q2pzSnNOb2RlX21vZHVsZXNQb3N0Y3NzTG9hZGVyU3JjSW5kZXhKc1NyY0pzQ29sdW1uc01lc3NhZ2VJbnRlcm5hbE1lc3NhZ2VFbGVtZW50Q3NzKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO1xuICAgICAgICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovXG5cblxuICAgICAgICAgIHZhciBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbiAgICAgICAgICAvKiBoYXJtb255IGltcG9ydCAqL1xuXG5cbiAgICAgICAgICB2YXIgX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX19kZWZhdWx0ID0gLyojX19QVVJFX18qL19fd2VicGFja19yZXF1aXJlX18ubihfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fKTsgLy8gSW1wb3J0c1xuXG5cbiAgICAgICAgICB2YXIgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18gPSBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fX2RlZmF1bHQoKShmYWxzZSk7IC8vIE1vZHVsZVxuXG5cbiAgICAgICAgICBfX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaSwgXCIuY2hlZXRhaC1ncmlkX19tZXNzYWdlLWVsZW1lbnR7cG9zaXRpb246YWJzb2x1dGU7bWFyZ2luLXRvcDotMnB4Oy13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94O2JveC1zaXppbmc6Ym9yZGVyLWJveDtib3JkZXItcmFkaXVzOjAgMCAzcHggM3B4O2JhY2tncm91bmQtY29sb3I6aHNsYSgwLDAlLDk4JSwuODUpO3BhZGRpbmc6OHB4IDJweDtwb2ludGVyLWV2ZW50czpub25lOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTtib3JkZXItdG9wOjFweCBzb2xpZCByZ2JhKDAsMCwwLC44Nyk7Y29sb3I6cmdiYSgwLDAsMCwuODcpfS5jaGVldGFoLWdyaWRfX21lc3NhZ2UtZWxlbWVudC0taGlkZGVue2Rpc3BsYXk6bm9uZX0uY2hlZXRhaC1ncmlkX19tZXNzYWdlLWVsZW1lbnQtLXNob3due2Rpc3BsYXk6YmxvY2t9LmNoZWV0YWgtZ3JpZF9fbWVzc2FnZS1lbGVtZW50X19tZXNzYWdle2ZvbnQtZmFtaWx5OlJvYm90bztmb250LXNpemU6MTJweDtmb250LXNpemU6Ljc1cmVtO21pbi1oZWlnaHQ6MWVtO2xpbmUtaGVpZ2h0OjE7ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlfVwiLCBcIlwiXSk7IC8vIEV4cG9ydHNcblxuICAgICAgICAgIC8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi9cblxuXG4gICAgICAgICAgX193ZWJwYWNrX2V4cG9ydHNfX1tcImRlZmF1bHRcIl0gPSBfX19DU1NfTE9BREVSX0VYUE9SVF9fXztcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvV2FybmluZ01lc3NhZ2VFbGVtZW50LmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8/cmVmLS01LTEhLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYz8/cmVmLS01LTIhLi4vc3JjL2pzL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9XYXJuaW5nTWVzc2FnZUVsZW1lbnQuY3NzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgZXhwb3J0cyBwcm92aWRlZDogZGVmYXVsdCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSB1c2VzIG1vZHVsZS5pZCAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIG5vZGVfbW9kdWxlc0Nzc0xvYWRlckRpc3RDanNKc05vZGVfbW9kdWxlc1Bvc3Rjc3NMb2FkZXJTcmNJbmRleEpzU3JjSnNDb2x1bW5zTWVzc2FnZUludGVybmFsV2FybmluZ01lc3NhZ2VFbGVtZW50Q3NzKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO1xuICAgICAgICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovXG5cblxuICAgICAgICAgIHZhciBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbiAgICAgICAgICAvKiBoYXJtb255IGltcG9ydCAqL1xuXG5cbiAgICAgICAgICB2YXIgX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX19kZWZhdWx0ID0gLyojX19QVVJFX18qL19fd2VicGFja19yZXF1aXJlX18ubihfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fKTsgLy8gSW1wb3J0c1xuXG5cbiAgICAgICAgICB2YXIgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18gPSBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fX2RlZmF1bHQoKShmYWxzZSk7IC8vIE1vZHVsZVxuXG5cbiAgICAgICAgICBfX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaSwgXCIuY2hlZXRhaC1ncmlkX193YXJuaW5nLW1lc3NhZ2UtZWxlbWVudHtib3JkZXItdG9wOjFweCBzb2xpZCAjZGQyYzAwO2NvbG9yOiNkZDJjMDB9XCIsIFwiXCJdKTsgLy8gRXhwb3J0c1xuXG4gICAgICAgICAgLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqL1xuXG5cbiAgICAgICAgICBfX3dlYnBhY2tfZXhwb3J0c19fW1wiZGVmYXVsdFwiXSA9IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8hLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8hLi4vc3JjL2pzL2ludGVybmFsL3N0eWxlLmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tNS0xIS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmM/P3JlZi0tNS0yIS4uL3NyYy9qcy9pbnRlcm5hbC9zdHlsZS5jc3MgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgZXhwb3J0cyBwcm92aWRlZDogZGVmYXVsdCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSB1c2VzIG1vZHVsZS5pZCAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIG5vZGVfbW9kdWxlc0Nzc0xvYWRlckRpc3RDanNKc05vZGVfbW9kdWxlc1Bvc3Rjc3NMb2FkZXJTcmNJbmRleEpzU3JjSnNJbnRlcm5hbFN0eWxlQ3NzKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO1xuICAgICAgICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovXG5cblxuICAgICAgICAgIHZhciBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbiAgICAgICAgICAvKiBoYXJtb255IGltcG9ydCAqL1xuXG5cbiAgICAgICAgICB2YXIgX25vZGVfbW9kdWxlc19jc3NfbG9hZGVyX2Rpc3RfcnVudGltZV9hcGlfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX19kZWZhdWx0ID0gLyojX19QVVJFX18qL19fd2VicGFja19yZXF1aXJlX18ubihfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fKTsgLy8gSW1wb3J0c1xuXG5cbiAgICAgICAgICB2YXIgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18gPSBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fX2RlZmF1bHQoKShmYWxzZSk7IC8vIE1vZHVsZVxuXG5cbiAgICAgICAgICBfX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaSwgXCIuY2hlZXRhaC1ncmlkIC5ncmlkLXNjcm9sbGFibGV7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtwb3NpdGlvbjphYnNvbHV0ZTtvdmVyZmxvdzpzY3JvbGx9LmNoZWV0YWgtZ3JpZCAuZ3JpZC1zY3JvbGwtZW5kLXBvaW50e29wYWNpdHk6MDtwb3NpdGlvbjpyZWxhdGl2ZX0uY2hlZXRhaC1ncmlke3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCV9LmNoZWV0YWgtZ3JpZD5jYW52YXN7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MDtoZWlnaHQ6MH0uY2hlZXRhaC1ncmlkIC5ncmlkLWZvY3VzLWNvbnRyb2x7cG9zaXRpb246cmVsYXRpdmUhaW1wb3J0YW50O3dpZHRoOjFweDtoZWlnaHQ6MXB4O29wYWNpdHk6MDtwYWRkaW5nOjA7bWFyZ2luOjA7LXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94O3BvaW50ZXItZXZlbnRzOm5vbmU7bWF4LXdpZHRoOjA7bWF4LWhlaWdodDowO2Zsb2F0Om5vbmUhaW1wb3J0YW50fS5jaGVldGFoLWdyaWQgaW5wdXQuZ3JpZC1mb2N1cy1jb250cm9sOjotbXMtY2xlYXJ7dmlzaWJpbGl0eTpoaWRkZW59LmNoZWV0YWgtZ3JpZCBpbnB1dC5ncmlkLWZvY3VzLWNvbnRyb2wuY29tcG9zaXRpb257b3BhY2l0eToxO21heC13aWR0aDpub25lO21heC1oZWlnaHQ6bm9uZX1cIiwgXCJcIl0pOyAvLyBFeHBvcnRzXG5cbiAgICAgICAgICAvKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovXG5cblxuICAgICAgICAgIF9fd2VicGFja19leHBvcnRzX19bXCJkZWZhdWx0XCJdID0gX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPyEuLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPyEuLi9zcmMvanMvdG9vbHRpcC9pbnRlcm5hbC9Ub29sdGlwRWxlbWVudC5jc3NcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tNS0xIS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmM/P3JlZi0tNS0yIS4uL3NyYy9qcy90b29sdGlwL2ludGVybmFsL1Rvb2x0aXBFbGVtZW50LmNzcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIGV4cG9ydHMgcHJvdmlkZWQ6IGRlZmF1bHQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgdXNlcyBtb2R1bGUuaWQgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBub2RlX21vZHVsZXNDc3NMb2FkZXJEaXN0Q2pzSnNOb2RlX21vZHVsZXNQb3N0Y3NzTG9hZGVyU3JjSW5kZXhKc1NyY0pzVG9vbHRpcEludGVybmFsVG9vbHRpcEVsZW1lbnRDc3MobW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4gICAgICAgICAgLyogaGFybW9ueSBpbXBvcnQgKi9cblxuXG4gICAgICAgICAgdmFyIF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzICovXG4gICAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpO1xuICAgICAgICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovXG5cblxuICAgICAgICAgIHZhciBfbm9kZV9tb2R1bGVzX2Nzc19sb2FkZXJfZGlzdF9ydW50aW1lX2FwaV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18pOyAvLyBJbXBvcnRzXG5cblxuICAgICAgICAgIHZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9ub2RlX21vZHVsZXNfY3NzX2xvYWRlcl9kaXN0X3J1bnRpbWVfYXBpX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19fZGVmYXVsdCgpKGZhbHNlKTsgLy8gTW9kdWxlXG5cblxuICAgICAgICAgIF9fX0NTU19MT0FERVJfRVhQT1JUX19fLnB1c2goW21vZHVsZS5pLCBcIkAtd2Via2l0LWtleWZyYW1lcyBjaGVldGFoLWdyaWRfX3Rvb2x0aXAtZWxlbWVudC0tc2hvd24tYW5pbWF0aW9uezAle29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSguOCkgdHJhbnNsYXRlWCgtNjAlKTt0cmFuc2Zvcm06c2NhbGUoLjgpIHRyYW5zbGF0ZVgoLTYwJSl9dG97b3BhY2l0eToxOy13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZVgoLTUwJSk7dHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZVgoLTUwJSl9fUBrZXlmcmFtZXMgY2hlZXRhaC1ncmlkX190b29sdGlwLWVsZW1lbnQtLXNob3duLWFuaW1hdGlvbnswJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoLjgpIHRyYW5zbGF0ZVgoLTYwJSk7dHJhbnNmb3JtOnNjYWxlKC44KSB0cmFuc2xhdGVYKC02MCUpfXRve29wYWNpdHk6MTstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGVYKC01MCUpO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGVYKC01MCUpfX0uY2hlZXRhaC1ncmlkX190b29sdGlwLWVsZW1lbnR7cG9zaXRpb246YWJzb2x1dGU7LXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94O2JvcmRlci1yYWRpdXM6M3B4O2JhY2tncm91bmQtY29sb3I6IzIzMmYzNDtwYWRkaW5nOjhweDtwb2ludGVyLWV2ZW50czpub25lOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTtjb2xvcjojZmZmfS5jaGVldGFoLWdyaWRfX3Rvb2x0aXAtZWxlbWVudC0taGlkZGVue29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpOy13ZWJraXQtdHJhbnNpdGlvbjpvcGFjaXR5IDc1bXMgbGluZWFyO3RyYW5zaXRpb246b3BhY2l0eSA3NW1zIGxpbmVhcn0uY2hlZXRhaC1ncmlkX190b29sdGlwLWVsZW1lbnQtLXNob3due29wYWNpdHk6MTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpOy13ZWJraXQtYW5pbWF0aW9uOmNoZWV0YWgtZ3JpZF9fdG9vbHRpcC1lbGVtZW50LS1zaG93bi1hbmltYXRpb24gLjE1cyBlYXNlLW91dDthbmltYXRpb246Y2hlZXRhaC1ncmlkX190b29sdGlwLWVsZW1lbnQtLXNob3duLWFuaW1hdGlvbiAuMTVzIGVhc2Utb3V0fS5jaGVldGFoLWdyaWRfX3Rvb2x0aXAtZWxlbWVudF9fY29udGVudHtmb250LWZhbWlseTpSb2JvdG87Zm9udC1zaXplOjEycHg7Zm9udC1zaXplOi43NXJlbTttaW4taGVpZ2h0OjFlbTtsaW5lLWhlaWdodDoxO3dpZHRoOjEwMCU7ZGlzcGxheTpibG9jazt3aGl0ZS1zcGFjZTpwcmUtd3JhcDttYXJnaW46MDstd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDtib3gtc2l6aW5nOmJvcmRlci1ib3h9XCIsIFwiXCJdKTsgLy8gRXhwb3J0c1xuXG4gICAgICAgICAgLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqL1xuXG5cbiAgICAgICAgICBfX3dlYnBhY2tfZXhwb3J0c19fW1wiZGVmYXVsdFwiXSA9IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBub2RlX21vZHVsZXNDc3NMb2FkZXJEaXN0UnVudGltZUFwaUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICAgIC8qXG4gICAgICAgICAgICBNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuICAgICAgICAgICAgQXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxuICAgICAgICAgICovXG4gICAgICAgICAgLy8gY3NzIGJhc2UgY29kZSwgaW5qZWN0ZWQgYnkgdGhlIGNzcy1sb2FkZXJcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xuXG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodXNlU291cmNlTWFwKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IFtdOyAvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nXG5cbiAgICAgICAgICAgIGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBjc3NXaXRoTWFwcGluZ1RvU3RyaW5nKGl0ZW0sIHVzZVNvdXJjZU1hcCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXRlbVsyXSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiQG1lZGlhIFwiLmNvbmNhdChpdGVtWzJdLCBcIiB7XCIpLmNvbmNhdChjb250ZW50LCBcIn1cIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgICAgICAgIH0pLmpvaW4oJycpO1xuICAgICAgICAgICAgfTsgLy8gaW1wb3J0IGEgbGlzdCBvZiBtb2R1bGVzIGludG8gdGhlIGxpc3RcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBmdW5jLW5hbWVzXG5cblxuICAgICAgICAgICAgbGlzdC5pID0gZnVuY3Rpb24gKG1vZHVsZXMsIG1lZGlhUXVlcnksIGRlZHVwZSkge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIG1vZHVsZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgICAgICAgICAgbW9kdWxlcyA9IFtbbnVsbCwgbW9kdWxlcywgJyddXTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzID0ge307XG5cbiAgICAgICAgICAgICAgaWYgKGRlZHVwZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1kZXN0cnVjdHVyaW5nXG4gICAgICAgICAgICAgICAgICB2YXIgaWQgPSB0aGlzW2ldWzBdO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoaWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2lkXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IG1vZHVsZXMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBbXS5jb25jYXQobW9kdWxlc1tfaV0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRlZHVwZSAmJiBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XG4gICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29udGludWVcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChtZWRpYVF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWl0ZW1bMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbVsyXSA9IG1lZGlhUXVlcnk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpdGVtWzJdID0gXCJcIi5jb25jYXQobWVkaWFRdWVyeSwgXCIgYW5kIFwiKS5jb25jYXQoaXRlbVsyXSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gbGlzdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgZnVuY3Rpb24gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gaXRlbVsxXSB8fCAnJzsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1kZXN0cnVjdHVyaW5nXG5cbiAgICAgICAgICAgIHZhciBjc3NNYXBwaW5nID0gaXRlbVszXTtcblxuICAgICAgICAgICAgaWYgKCFjc3NNYXBwaW5nKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodXNlU291cmNlTWFwICYmIHR5cGVvZiBidG9hID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgIHZhciBzb3VyY2VNYXBwaW5nID0gdG9Db21tZW50KGNzc01hcHBpbmcpO1xuICAgICAgICAgICAgICB2YXIgc291cmNlVVJMcyA9IGNzc01hcHBpbmcuc291cmNlcy5tYXAoZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIi8qIyBzb3VyY2VVUkw9XCIuY29uY2F0KGNzc01hcHBpbmcuc291cmNlUm9vdCB8fCAnJykuY29uY2F0KHNvdXJjZSwgXCIgKi9cIik7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gW2NvbnRlbnRdLmNvbmNhdChzb3VyY2VVUkxzKS5jb25jYXQoW3NvdXJjZU1hcHBpbmddKS5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFtjb250ZW50XS5qb2luKCdcXG4nKTtcbiAgICAgICAgICB9IC8vIEFkYXB0ZWQgZnJvbSBjb252ZXJ0LXNvdXJjZS1tYXAgKE1JVClcblxuXG4gICAgICAgICAgZnVuY3Rpb24gdG9Db21tZW50KHNvdXJjZU1hcCkge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gXCJzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCxcIi5jb25jYXQoYmFzZTY0KTtcbiAgICAgICAgICAgIHJldHVybiBcIi8qIyBcIi5jb25jYXQoZGF0YSwgXCIgKi9cIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiovXG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gbm9kZV9tb2R1bGVzU3R5bGVMb2FkZXJEaXN0UnVudGltZUluamVjdFN0eWxlc0ludG9TdHlsZVRhZ0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIGlzT2xkSUUgPSBmdW5jdGlvbiBpc09sZElFKCkge1xuICAgICAgICAgICAgdmFyIG1lbW87XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gbWVtb3JpemUoKSB7XG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgbWVtbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAvLyBUZXN0IGZvciBJRSA8PSA5IGFzIHByb3Bvc2VkIGJ5IEJyb3dzZXJoYWNrc1xuICAgICAgICAgICAgICAgIC8vIEBzZWUgaHR0cDovL2Jyb3dzZXJoYWNrcy5jb20vI2hhY2stZTcxZDg2OTJmNjUzMzQxNzNmZWU3MTVjMjIyY2I4MDVcbiAgICAgICAgICAgICAgICAvLyBUZXN0cyBmb3IgZXhpc3RlbmNlIG9mIHN0YW5kYXJkIGdsb2JhbHMgaXMgdG8gYWxsb3cgc3R5bGUtbG9hZGVyXG4gICAgICAgICAgICAgICAgLy8gdG8gb3BlcmF0ZSBjb3JyZWN0bHkgaW50byBub24tc3RhbmRhcmQgZW52aXJvbm1lbnRzXG4gICAgICAgICAgICAgICAgLy8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay1jb250cmliL3N0eWxlLWxvYWRlci9pc3N1ZXMvMTc3XG4gICAgICAgICAgICAgICAgbWVtbyA9IEJvb2xlYW4od2luZG93ICYmIGRvY3VtZW50ICYmIGRvY3VtZW50LmFsbCAmJiAhd2luZG93LmF0b2IpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIHZhciBnZXRUYXJnZXQgPSBmdW5jdGlvbiBnZXRUYXJnZXQoKSB7XG4gICAgICAgICAgICB2YXIgbWVtbyA9IHt9O1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG1lbW9yaXplKHRhcmdldCkge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIG1lbW9bdGFyZ2V0XSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGVUYXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7IC8vIFNwZWNpYWwgY2FzZSB0byByZXR1cm4gaGVhZCBvZiBpZnJhbWUgaW5zdGVhZCBvZiBpZnJhbWUgaXRzZWxmXG5cbiAgICAgICAgICAgICAgICBpZiAod2luZG93LkhUTUxJRnJhbWVFbGVtZW50ICYmIHN0eWxlVGFyZ2V0IGluc3RhbmNlb2Ygd2luZG93LkhUTUxJRnJhbWVFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uIGlmIGFjY2VzcyB0byBpZnJhbWUgaXMgYmxvY2tlZFxuICAgICAgICAgICAgICAgICAgICAvLyBkdWUgdG8gY3Jvc3Mtb3JpZ2luIHJlc3RyaWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICBzdHlsZVRhcmdldCA9IHN0eWxlVGFyZ2V0LmNvbnRlbnREb2N1bWVudC5oZWFkO1xuICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dFxuICAgICAgICAgICAgICAgICAgICBzdHlsZVRhcmdldCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVtb1t0YXJnZXRdID0gc3R5bGVUYXJnZXQ7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gbWVtb1t0YXJnZXRdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICB2YXIgc3R5bGVzSW5Eb20gPSBbXTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldEluZGV4QnlJZGVudGlmaWVyKGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAtMTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXNJbkRvbS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBpZiAoc3R5bGVzSW5Eb21baV0uaWRlbnRpZmllciA9PT0gaWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBtb2R1bGVzVG9Eb20obGlzdCwgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIGlkQ291bnRNYXAgPSB7fTtcbiAgICAgICAgICAgIHZhciBpZGVudGlmaWVycyA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuICAgICAgICAgICAgICB2YXIgaWQgPSBvcHRpb25zLmJhc2UgPyBpdGVtWzBdICsgb3B0aW9ucy5iYXNlIDogaXRlbVswXTtcbiAgICAgICAgICAgICAgdmFyIGNvdW50ID0gaWRDb3VudE1hcFtpZF0gfHwgMDtcbiAgICAgICAgICAgICAgdmFyIGlkZW50aWZpZXIgPSBcIlwiLmNvbmNhdChpZCwgXCIgXCIpLmNvbmNhdChjb3VudCk7XG4gICAgICAgICAgICAgIGlkQ291bnRNYXBbaWRdID0gY291bnQgKyAxO1xuICAgICAgICAgICAgICB2YXIgaW5kZXggPSBnZXRJbmRleEJ5SWRlbnRpZmllcihpZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgICAgICBjc3M6IGl0ZW1bMV0sXG4gICAgICAgICAgICAgICAgbWVkaWE6IGl0ZW1bMl0sXG4gICAgICAgICAgICAgICAgc291cmNlTWFwOiBpdGVtWzNdXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHN0eWxlc0luRG9tW2luZGV4XS5yZWZlcmVuY2VzKys7XG4gICAgICAgICAgICAgICAgc3R5bGVzSW5Eb21baW5kZXhdLnVwZGF0ZXIob2JqKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHlsZXNJbkRvbS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIGlkZW50aWZpZXI6IGlkZW50aWZpZXIsXG4gICAgICAgICAgICAgICAgICB1cGRhdGVyOiBhZGRTdHlsZShvYmosIG9wdGlvbnMpLFxuICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlczogMVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWRlbnRpZmllcnMucHVzaChpZGVudGlmaWVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGlkZW50aWZpZXJzO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBvcHRpb25zLmF0dHJpYnV0ZXMgfHwge307XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0cmlidXRlcy5ub25jZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgdmFyIG5vbmNlID0gdHJ1ZSA/IF9fd2VicGFja19yZXF1aXJlX18ubmMgOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgICAgaWYgKG5vbmNlKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5ub25jZSA9IG5vbmNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5pbnNlcnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgb3B0aW9ucy5pbnNlcnQoc3R5bGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldFRhcmdldChvcHRpb25zLmluc2VydCB8fCAnaGVhZCcpO1xuXG4gICAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGRuJ3QgZmluZCBhIHN0eWxlIHRhcmdldC4gVGhpcyBwcm9iYWJseSBtZWFucyB0aGF0IHRoZSB2YWx1ZSBmb3IgdGhlICdpbnNlcnQnIHBhcmFtZXRlciBpcyBpbnZhbGlkLlwiKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzdHlsZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGUpIHtcbiAgICAgICAgICAgIC8vIGlzdGFuYnVsIGlnbm9yZSBpZlxuICAgICAgICAgICAgaWYgKHN0eWxlLnBhcmVudE5vZGUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdHlsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgICovXG5cblxuICAgICAgICAgIHZhciByZXBsYWNlVGV4dCA9IGZ1bmN0aW9uIHJlcGxhY2VUZXh0KCkge1xuICAgICAgICAgICAgdmFyIHRleHRTdG9yZSA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlcGxhY2UoaW5kZXgsIHJlcGxhY2VtZW50KSB7XG4gICAgICAgICAgICAgIHRleHRTdG9yZVtpbmRleF0gPSByZXBsYWNlbWVudDtcbiAgICAgICAgICAgICAgcmV0dXJuIHRleHRTdG9yZS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGUsIGluZGV4LCByZW1vdmUsIG9iaikge1xuICAgICAgICAgICAgdmFyIGNzcyA9IHJlbW92ZSA/ICcnIDogb2JqLm1lZGlhID8gXCJAbWVkaWEgXCIuY29uY2F0KG9iai5tZWRpYSwgXCIge1wiKS5jb25jYXQob2JqLmNzcywgXCJ9XCIpIDogb2JqLmNzczsgLy8gRm9yIG9sZCBJRVxuXG4gICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgICovXG5cbiAgICAgICAgICAgIGlmIChzdHlsZS5zdHlsZVNoZWV0KSB7XG4gICAgICAgICAgICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIGNzc05vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpO1xuICAgICAgICAgICAgICB2YXIgY2hpbGROb2RlcyA9IHN0eWxlLmNoaWxkTm9kZXM7XG5cbiAgICAgICAgICAgICAgaWYgKGNoaWxkTm9kZXNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgc3R5bGUucmVtb3ZlQ2hpbGQoY2hpbGROb2Rlc1tpbmRleF0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgc3R5bGUuaW5zZXJ0QmVmb3JlKGNzc05vZGUsIGNoaWxkTm9kZXNbaW5kZXhdKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHlsZS5hcHBlbmRDaGlsZChjc3NOb2RlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGFwcGx5VG9UYWcoc3R5bGUsIG9wdGlvbnMsIG9iaikge1xuICAgICAgICAgICAgdmFyIGNzcyA9IG9iai5jc3M7XG4gICAgICAgICAgICB2YXIgbWVkaWEgPSBvYmoubWVkaWE7XG4gICAgICAgICAgICB2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcblxuICAgICAgICAgICAgaWYgKG1lZGlhKSB7XG4gICAgICAgICAgICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnbWVkaWEnLCBtZWRpYSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdHlsZS5yZW1vdmVBdHRyaWJ1dGUoJ21lZGlhJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzb3VyY2VNYXAgJiYgdHlwZW9mIGJ0b2EgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgIGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIuY29uY2F0KGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSksIFwiICovXCIpO1xuICAgICAgICAgICAgfSAvLyBGb3Igb2xkIElFXG5cbiAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAgKi9cblxuXG4gICAgICAgICAgICBpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuICAgICAgICAgICAgICBzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSBjc3M7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB3aGlsZSAoc3R5bGUuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICAgIHN0eWxlLnJlbW92ZUNoaWxkKHN0eWxlLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHNpbmdsZXRvbiA9IG51bGw7XG4gICAgICAgICAgdmFyIHNpbmdsZXRvbkNvdW50ZXIgPSAwO1xuXG4gICAgICAgICAgZnVuY3Rpb24gYWRkU3R5bGUob2JqLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgc3R5bGU7XG4gICAgICAgICAgICB2YXIgdXBkYXRlO1xuICAgICAgICAgICAgdmFyIHJlbW92ZTtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XG4gICAgICAgICAgICAgIHZhciBzdHlsZUluZGV4ID0gc2luZ2xldG9uQ291bnRlcisrO1xuICAgICAgICAgICAgICBzdHlsZSA9IHNpbmdsZXRvbiB8fCAoc2luZ2xldG9uID0gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpKTtcbiAgICAgICAgICAgICAgdXBkYXRlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlLCBzdHlsZUluZGV4LCBmYWxzZSk7XG4gICAgICAgICAgICAgIHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZSwgc3R5bGVJbmRleCwgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdHlsZSA9IGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKTtcbiAgICAgICAgICAgICAgdXBkYXRlID0gYXBwbHlUb1RhZy5iaW5kKG51bGwsIHN0eWxlLCBvcHRpb25zKTtcblxuICAgICAgICAgICAgICByZW1vdmUgPSBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKTtcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdXBkYXRlKG9iaik7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gdXBkYXRlU3R5bGUobmV3T2JqKSB7XG4gICAgICAgICAgICAgIGlmIChuZXdPYmopIHtcbiAgICAgICAgICAgICAgICBpZiAobmV3T2JqLmNzcyA9PT0gb2JqLmNzcyAmJiBuZXdPYmoubWVkaWEgPT09IG9iai5tZWRpYSAmJiBuZXdPYmouc291cmNlTWFwID09PSBvYmouc291cmNlTWFwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdXBkYXRlKG9iaiA9IG5ld09iaik7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobGlzdCwgb3B0aW9ucykge1xuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307IC8vIEZvcmNlIHNpbmdsZS10YWcgc29sdXRpb24gb24gSUU2LTksIHdoaWNoIGhhcyBhIGhhcmQgbGltaXQgb24gdGhlICMgb2YgPHN0eWxlPlxuICAgICAgICAgICAgLy8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZVxuXG4gICAgICAgICAgICBpZiAoIW9wdGlvbnMuc2luZ2xldG9uICYmIHR5cGVvZiBvcHRpb25zLnNpbmdsZXRvbiAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaXN0ID0gbGlzdCB8fCBbXTtcbiAgICAgICAgICAgIHZhciBsYXN0SWRlbnRpZmllcnMgPSBtb2R1bGVzVG9Eb20obGlzdCwgb3B0aW9ucyk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcbiAgICAgICAgICAgICAgbmV3TGlzdCA9IG5ld0xpc3QgfHwgW107XG5cbiAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChuZXdMaXN0KSAhPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGFzdElkZW50aWZpZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlkZW50aWZpZXIgPSBsYXN0SWRlbnRpZmllcnNbaV07XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gZ2V0SW5kZXhCeUlkZW50aWZpZXIoaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgc3R5bGVzSW5Eb21baW5kZXhdLnJlZmVyZW5jZXMtLTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBuZXdMYXN0SWRlbnRpZmllcnMgPSBtb2R1bGVzVG9Eb20obmV3TGlzdCwgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGxhc3RJZGVudGlmaWVycy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgX2lkZW50aWZpZXIgPSBsYXN0SWRlbnRpZmllcnNbX2ldO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9pbmRleCA9IGdldEluZGV4QnlJZGVudGlmaWVyKF9pZGVudGlmaWVyKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdHlsZXNJbkRvbVtfaW5kZXhdLnJlZmVyZW5jZXMgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIHN0eWxlc0luRG9tW19pbmRleF0udXBkYXRlcigpO1xuXG4gICAgICAgICAgICAgICAgICBzdHlsZXNJbkRvbS5zcGxpY2UoX2luZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBsYXN0SWRlbnRpZmllcnMgPSBuZXdMYXN0SWRlbnRpZmllcnM7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH07XG4gICAgICAgICAgLyoqKi9cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9nbG9iYWwuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL25vZGVfbW9kdWxlcy93ZWJwYWNrL2J1aWxkaW4vZ2xvYmFsLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIG5vZGVfbW9kdWxlc1dlYnBhY2tCdWlsZGluR2xvYmFsSnMobW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAgICAgdmFyIGc7IC8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXG5cbiAgICAgICAgICBnID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxuICAgICAgICAgICAgZyA9IGcgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKF90eXBlb2Yod2luZG93KSA9PT0gXCJvYmplY3RcIikgZyA9IHdpbmRvdztcbiAgICAgICAgICB9IC8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cbiAgICAgICAgICAvLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xuICAgICAgICAgIC8vIGVhc2llciB0byBoYW5kbGUgdGhpcyBjYXNlLiBpZighZ2xvYmFsKSB7IC4uLn1cblxuXG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBnO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuLi9zcmMvanMvY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvSW5saW5lSW5wdXRFbGVtZW50LmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi4vc3JjL2pzL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL0lubGluZUlucHV0RWxlbWVudC5jc3MgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gc3JjSnNDb2x1bW5zQWN0aW9uSW50ZXJuYWxJbmxpbmVJbnB1dEVsZW1lbnRDc3MobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgdmFyIGFwaSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGNvbnRlbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAhLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tNS0xIS4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmM/P3JlZi0tNS0yIS4vSW5saW5lSW5wdXRFbGVtZW50LmNzcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVJbnB1dEVsZW1lbnQuY3NzXCIpO1xuXG4gICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaSwgY29udGVudCwgJyddXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgb3B0aW9ucyA9IHt9O1xuICAgICAgICAgIG9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG4gICAgICAgICAgb3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcbiAgICAgICAgICB2YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuICAgICAgICAgIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHMgfHwge307XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4uL3NyYy9qcy9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVNZW51RWxlbWVudC5jc3NcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi4vc3JjL2pzL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL0lubGluZU1lbnVFbGVtZW50LmNzcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIHNyY0pzQ29sdW1uc0FjdGlvbkludGVybmFsSW5saW5lTWVudUVsZW1lbnRDc3MobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgdmFyIGFwaSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGNvbnRlbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAhLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tNS0xIS4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmM/P3JlZi0tNS0yIS4vSW5saW5lTWVudUVsZW1lbnQuY3NzICovXG4gICAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8hLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8hLi4vc3JjL2pzL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL0lubGluZU1lbnVFbGVtZW50LmNzc1wiKTtcblxuICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmksIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTtcbiAgICAgICAgICBvcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xuICAgICAgICAgIG9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG4gICAgICAgICAgdmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcbiAgICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzIHx8IHt9O1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuLi9zcmMvanMvY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQuY3NzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL3NyYy9qcy9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9TbWFsbERpYWxvZ0lucHV0RWxlbWVudC5jc3MgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBzcmNKc0NvbHVtbnNBY3Rpb25JbnRlcm5hbFNtYWxsRGlhbG9nSW5wdXRFbGVtZW50Q3NzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIHZhciBhcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcblxuICAgICAgICAgIHZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgIS4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTUtMSEuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjPz9yZWYtLTUtMiEuL1NtYWxsRGlhbG9nSW5wdXRFbGVtZW50LmNzcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9TbWFsbERpYWxvZ0lucHV0RWxlbWVudC5jc3NcIik7XG5cbiAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBvcHRpb25zID0ge307XG4gICAgICAgICAgb3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbiAgICAgICAgICBvcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuICAgICAgICAgIHZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscyB8fCB7fTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi4vc3JjL2pzL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9FcnJvck1lc3NhZ2VFbGVtZW50LmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuLi9zcmMvanMvY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL0Vycm9yTWVzc2FnZUVsZW1lbnQuY3NzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gc3JjSnNDb2x1bW5zTWVzc2FnZUludGVybmFsRXJyb3JNZXNzYWdlRWxlbWVudENzcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICB2YXIgYXBpID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzICovXG4gICAgICAgICAgXCIuLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIik7XG5cbiAgICAgICAgICB2YXIgY29udGVudCA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohICEuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcz8/cmVmLS01LTEhLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL3NyYz8/cmVmLS01LTIhLi9FcnJvck1lc3NhZ2VFbGVtZW50LmNzcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvRXJyb3JNZXNzYWdlRWxlbWVudC5jc3NcIik7XG5cbiAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBvcHRpb25zID0ge307XG4gICAgICAgICAgb3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbiAgICAgICAgICBvcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuICAgICAgICAgIHZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscyB8fCB7fTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi4vc3JjL2pzL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9NZXNzYWdlRWxlbWVudC5jc3NcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvTWVzc2FnZUVsZW1lbnQuY3NzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIHNyY0pzQ29sdW1uc01lc3NhZ2VJbnRlcm5hbE1lc3NhZ2VFbGVtZW50Q3NzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIHZhciBhcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcblxuICAgICAgICAgIHZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgIS4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTUtMSEuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjPz9yZWYtLTUtMiEuL01lc3NhZ2VFbGVtZW50LmNzcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvTWVzc2FnZUVsZW1lbnQuY3NzXCIpO1xuXG4gICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaSwgY29udGVudCwgJyddXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgb3B0aW9ucyA9IHt9O1xuICAgICAgICAgIG9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG4gICAgICAgICAgb3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcbiAgICAgICAgICB2YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuICAgICAgICAgIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHMgfHwge307XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvV2FybmluZ01lc3NhZ2VFbGVtZW50LmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvV2FybmluZ01lc3NhZ2VFbGVtZW50LmNzcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gc3JjSnNDb2x1bW5zTWVzc2FnZUludGVybmFsV2FybmluZ01lc3NhZ2VFbGVtZW50Q3NzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIHZhciBhcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcblxuICAgICAgICAgIHZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgIS4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTUtMSEuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjPz9yZWYtLTUtMiEuL1dhcm5pbmdNZXNzYWdlRWxlbWVudC5jc3MgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPyEuLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPyEuLi9zcmMvanMvY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL1dhcm5pbmdNZXNzYWdlRWxlbWVudC5jc3NcIik7XG5cbiAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBvcHRpb25zID0ge307XG4gICAgICAgICAgb3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbiAgICAgICAgICBvcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuICAgICAgICAgIHZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscyB8fCB7fTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi4vc3JjL2pzL2ludGVybmFsL3N0eWxlLmNzc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuLi9zcmMvanMvaW50ZXJuYWwvc3R5bGUuY3NzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gc3JjSnNJbnRlcm5hbFN0eWxlQ3NzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIHZhciBhcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcblxuICAgICAgICAgIHZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTUtMSEuLi8uLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjPz9yZWYtLTUtMiEuL3N0eWxlLmNzcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy9pbnRlcm5hbC9zdHlsZS5jc3NcIik7XG5cbiAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBvcHRpb25zID0ge307XG4gICAgICAgICAgb3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbiAgICAgICAgICBvcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuICAgICAgICAgIHZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscyB8fCB7fTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi4vc3JjL2pzL3Rvb2x0aXAvaW50ZXJuYWwvVG9vbHRpcEVsZW1lbnQuY3NzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi4vc3JjL2pzL3Rvb2x0aXAvaW50ZXJuYWwvVG9vbHRpcEVsZW1lbnQuY3NzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBzcmNKc1Rvb2x0aXBJbnRlcm5hbFRvb2x0aXBFbGVtZW50Q3NzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIHZhciBhcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMgKi9cbiAgICAgICAgICBcIi4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcblxuICAgICAgICAgIHZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTUtMSEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjPz9yZWYtLTUtMiEuL1Rvb2x0aXBFbGVtZW50LmNzcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanM/IS4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/IS4uL3NyYy9qcy90b29sdGlwL2ludGVybmFsL1Rvb2x0aXBFbGVtZW50LmNzc1wiKTtcblxuICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmksIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTtcbiAgICAgICAgICBvcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xuICAgICAgICAgIG9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG4gICAgICAgICAgdmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcbiAgICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzIHx8IHt9O1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL0dyaWRDYW52YXNIZWxwZXIuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL0dyaWRDYW52YXNIZWxwZXIuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIEdyaWRDYW52YXNIZWxwZXJKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkdyaWRDYW52YXNIZWxwZXIgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgY2FsYyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL2NhbGMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvY2FsYy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgY2FudmFzaGVscGVyID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdG9vbHMvY2FudmFzaGVscGVyICovXG4gICAgICAgICAgXCIuL3Rvb2xzL2NhbnZhc2hlbHBlci5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgZm9udHMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC9mb250cyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9mb250cy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgaW5saW5lVXRpbHMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9lbGVtZW50L2lubGluZXMgKi9cbiAgICAgICAgICBcIi4vZWxlbWVudC9pbmxpbmVzLmpzXCIpKTtcblxuICAgICAgICAgIHZhciB0aGVtZXMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90aGVtZXMgKi9cbiAgICAgICAgICBcIi4vdGhlbWVzLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBjYW52YXNlc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC9jYW52YXNlcyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9jYW52YXNlcy5qc1wiKTtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBJbmxpbmVEcmF3ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vZWxlbWVudC9JbmxpbmVEcmF3ZXIgKi9cbiAgICAgICAgICBcIi4vZWxlbWVudC9JbmxpbmVEcmF3ZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgUmVjdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC9SZWN0ICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL1JlY3QuanNcIik7XG5cbiAgICAgICAgICB2YXIgY29sb3JfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaW50ZXJuYWwvY29sb3IgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvY29sb3IuanNcIik7XG5cbiAgICAgICAgICB2YXIgX3RvQm94QXJyYXkgPSB1dGlsc18xLnN0eWxlLnRvQm94QXJyYXk7XG4gICAgICAgICAgdmFyIElOTElORV9FTExJUFNJUyA9IGlubGluZVV0aWxzLm9mKFwiXFx1MjAyNlwiKTtcbiAgICAgICAgICB2YXIgVEVYVF9PRkZTRVQgPSAyO1xuICAgICAgICAgIHZhciBDSEVDS0JPWF9PRkZTRVQgPSBURVhUX09GRlNFVCArIDE7XG5cbiAgICAgICAgICBmdW5jdGlvbiBpbnZhbGlkYXRlQ2VsbChjb250ZXh0LCBncmlkKSB7XG4gICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICBncmlkLmludmFsaWRhdGVDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0U3R5bGVQcm9wZXJ0eShjb2xvciwgY29sLCByb3csIGdyaWQsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS5nZXRPckFwcGx5KShjb2xvciwge1xuICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgcm93OiByb3csXG4gICAgICAgICAgICAgIGdyaWQ6IGdyaWQsXG4gICAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGdldEZvbnQoZm9udCwgY29sLCByb3csIGdyaWQsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmIChmb250ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICgwLCB1dGlsc18xLmdldE9yQXBwbHkpKGZvbnQsIHtcbiAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgIHJvdzogcm93LFxuICAgICAgICAgICAgICBncmlkOiBncmlkLFxuICAgICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0VGhlbWVWYWx1ZShncmlkKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgbmFtZXMgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgICAgICAgICBuYW1lc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBncmlkVGhlbWVWYWx1ZSA9ICgwLCB1dGlsc18xLmdldENoYWluU2FmZSkuYXBwbHkodm9pZCAwLCBbZ3JpZC50aGVtZV0uY29uY2F0KG5hbWVzKSk7XG5cbiAgICAgICAgICAgIGlmIChncmlkVGhlbWVWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIC8vIHVzZSBkZWZhdWx0IHRoZW1lXG4gICAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS5nZXRDaGFpblNhZmUpLmFwcGx5KHZvaWQgMCwgW3RoZW1lcy5nZXREZWZhdWx0KCldLmNvbmNhdChuYW1lcykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGdyaWRUaGVtZVZhbHVlICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGdyaWRUaGVtZVZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZGVmYXVsdFRoZW1lVmFsdWU7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBncmlkVGhlbWVWYWx1ZShhcmdzKTtcblxuICAgICAgICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIHVzZSBncmlkIHRoZW1lXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICB9IC8vIHVzZSBkZWZhdWx0IHRoZW1lXG5cblxuICAgICAgICAgICAgICBkZWZhdWx0VGhlbWVWYWx1ZSA9IGRlZmF1bHRUaGVtZVZhbHVlIHx8ICgwLCB1dGlsc18xLmdldENoYWluU2FmZSkuYXBwbHkodm9pZCAwLCBbdGhlbWVzLmdldERlZmF1bHQoKV0uY29uY2F0KG5hbWVzKSk7XG4gICAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS5nZXRPckFwcGx5KShkZWZhdWx0VGhlbWVWYWx1ZSwgYXJncyk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIF90ZXN0Rm9udExvYWQoZm9udCwgdmFsdWUsIGNvbnRleHQsIGdyaWQpIHtcbiAgICAgICAgICAgIGlmIChmb250KSB7XG4gICAgICAgICAgICAgIGlmICghZm9udHMuY2hlY2soZm9udCwgdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgZm9udHMubG9hZChmb250LCB2YWx1ZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGludmFsaWRhdGVDZWxsKGNvbnRleHQsIGdyaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBkcmF3SW5saW5lcyhjdHgsIGlubGluZXMsIHJlY3QsIG9mZnNldCwgb2Zmc2V0VG9wLCBvZmZzZXRCb3R0b20sIGNvbCwgcm93LCBncmlkKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBkcmF3SW5saW5lKGlubGluZSwgb2Zmc2V0TGVmdCwgb2Zmc2V0UmlnaHQpIHtcbiAgICAgICAgICAgICAgaWYgKGlubGluZS5jYW5EcmF3KCkpIHtcbiAgICAgICAgICAgICAgICBjdHguc2F2ZSgpO1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBfZ2V0U3R5bGVQcm9wZXJ0eShpbmxpbmUuY29sb3IoKSB8fCBjdHguZmlsbFN0eWxlLCBjb2wsIHJvdywgZ3JpZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gaW5saW5lLmZvbnQoKSB8fCBjdHguZm9udDtcbiAgICAgICAgICAgICAgICAgIGlubGluZS5kcmF3KHtcbiAgICAgICAgICAgICAgICAgICAgY3R4OiBjdHgsXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc2hlbHBlcjogY2FudmFzaGVscGVyLFxuICAgICAgICAgICAgICAgICAgICByZWN0OiByZWN0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0TGVmdDogb2Zmc2V0TGVmdCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0UmlnaHQ6IG9mZnNldFJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3A6IG9mZnNldFRvcCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0Qm90dG9tOiBvZmZzZXRCb3R0b21cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmxpbmUub25SZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZ3JpZC5pbnZhbGlkYXRlQ2VsbChjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgfSk7IC8vbm9vcFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpbmxpbmVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAvLzHku7bjga7loLTlkIjjga/luYXoqIjnrpfjgYzkuI3opoHjgarjgZ/jgoHliIblspBcbiAgICAgICAgICAgICAgdmFyIGlubGluZSA9IGlubGluZXNbMF07XG4gICAgICAgICAgICAgIGRyYXdJbmxpbmUoaW5saW5lLCAwLCAwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBpbmxpbmVXaWR0aHMgPSBpbmxpbmVzLm1hcChmdW5jdGlvbiAoaW5saW5lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbmxpbmUud2lkdGgoe1xuICAgICAgICAgICAgICAgICAgY3R4OiBjdHhcbiAgICAgICAgICAgICAgICB9KSB8fCAwKSAtIDA7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB2YXIgb2Zmc2V0UmlnaHQgPSBpbmxpbmVXaWR0aHMucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBiO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdmFyIG9mZnNldExlZnQgPSAwO1xuICAgICAgICAgICAgICBpbmxpbmVzLmZvckVhY2goZnVuY3Rpb24gKGlubGluZSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5saW5lV2lkdGggPSBpbmxpbmVXaWR0aHNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIG9mZnNldFJpZ2h0IC09IGlubGluZVdpZHRoO1xuICAgICAgICAgICAgICAgIGRyYXdJbmxpbmUoaW5saW5lLCBvZmZzZXRMZWZ0LCBvZmZzZXRSaWdodCk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0TGVmdCArPSBpbmxpbmVXaWR0aDtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gYnVpbGRJbmxpbmVzKGljb25zLCBpbmxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBpbmxpbmVVdGlscy5idWlsZElubGluZXMoaWNvbnMsIGlubGluZSB8fCBcIlwiKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBpbmxpbmVUb1N0cmluZyhpbmxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBpbmxpbmVVdGlscy5zdHJpbmcoaW5saW5lKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRPdmVyZmxvd0lubGluZSh0ZXh0T3ZlcmZsb3cpIHtcbiAgICAgICAgICAgIGlmICghaXNBbGxvd092ZXJmbG93KHRleHRPdmVyZmxvdykgfHwgdGV4dE92ZXJmbG93ID09PSBcImVsbGlwc2lzXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIElOTElORV9FTExJUFNJUztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGV4dE92ZXJmbG93ID0gdGV4dE92ZXJmbG93LnRyaW0oKTtcblxuICAgICAgICAgICAgaWYgKHRleHRPdmVyZmxvdy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGlubGluZVV0aWxzLm9mKHRleHRPdmVyZmxvd1swXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBJTkxJTkVfRUxMSVBTSVM7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gaXNBbGxvd092ZXJmbG93KHRleHRPdmVyZmxvdykge1xuICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4odGV4dE92ZXJmbG93ICYmIHRleHRPdmVyZmxvdyAhPT0gXCJjbGlwXCIgJiYgdHlwZW9mIHRleHRPdmVyZmxvdyA9PT0gXCJzdHJpbmdcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0T3ZlcmZsb3dJbmxpbmVzSW5kZXgoY3R4LCBpbmxpbmVzLCB3aWR0aCkge1xuICAgICAgICAgICAgdmFyIG1heFdpZHRoID0gd2lkdGggLSAzO1xuICAgICAgICAgICAgLypidWZmZXIqL1xuXG4gICAgICAgICAgICB2YXIgbGluZVdpZHRoID0gMDtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBpbmxpbmUgPSBpbmxpbmVzW2ldO1xuICAgICAgICAgICAgICB2YXIgaW5saW5lV2lkdGggPSAoaW5saW5lLndpZHRoKHtcbiAgICAgICAgICAgICAgICBjdHg6IGN0eFxuICAgICAgICAgICAgICB9KSB8fCAwKSAtIDA7XG5cbiAgICAgICAgICAgICAgaWYgKGxpbmVXaWR0aCArIGlubGluZVdpZHRoID4gbWF4V2lkdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgaW5kZXg6IGksXG4gICAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IGxpbmVXaWR0aCxcbiAgICAgICAgICAgICAgICAgIHJlbVdpZHRoOiBtYXhXaWR0aCAtIGxpbmVXaWR0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBsaW5lV2lkdGggKz0gaW5saW5lV2lkdGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGlzT3ZlcmZsb3dJbmxpbmVzKGN0eCwgaW5saW5lcywgd2lkdGgpIHtcbiAgICAgICAgICAgIHJldHVybiAhIWdldE92ZXJmbG93SW5saW5lc0luZGV4KGN0eCwgaW5saW5lcywgd2lkdGgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGJyZWFrV2lkdGhJbmxpbmVzKGN0eCwgaW5saW5lcywgd2lkdGgpIHtcbiAgICAgICAgICAgIHZhciBpbmRleERhdGEgPSBnZXRPdmVyZmxvd0lubGluZXNJbmRleChjdHgsIGlubGluZXMsIHdpZHRoKTtcblxuICAgICAgICAgICAgaWYgKCFpbmRleERhdGEpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBiZWZvcmVJbmxpbmVzOiBpbmxpbmVzLFxuICAgICAgICAgICAgICAgIG92ZXJmbG93OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBhZnRlcklubGluZXM6IFtdXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpbmRleCA9IGluZGV4RGF0YS5pbmRleCxcbiAgICAgICAgICAgICAgICByZW1XaWR0aCA9IGluZGV4RGF0YS5yZW1XaWR0aDtcbiAgICAgICAgICAgIHZhciBpbmxpbmUgPSBpbmxpbmVzW2luZGV4XTtcbiAgICAgICAgICAgIHZhciBiZWZvcmVJbmxpbmVzID0gaW5saW5lcy5zbGljZSgwLCBpbmRleCk7XG4gICAgICAgICAgICB2YXIgYWZ0ZXJJbmxpbmVzID0gW107XG5cbiAgICAgICAgICAgIGlmIChpbmxpbmUuY2FuQnJlYWsoKSkge1xuICAgICAgICAgICAgICB2YXIgX2lubGluZSRicmVha1dvcmQgPSBpbmxpbmUuYnJlYWtXb3JkKGN0eCwgcmVtV2lkdGgpLFxuICAgICAgICAgICAgICAgICAgYmVmb3JlID0gX2lubGluZSRicmVha1dvcmQuYmVmb3JlLFxuICAgICAgICAgICAgICAgICAgYWZ0ZXIgPSBfaW5saW5lJGJyZWFrV29yZC5hZnRlcjtcblxuICAgICAgICAgICAgICBpZiAoIWJlZm9yZSAmJiAhYmVmb3JlSW5saW5lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2lubGluZSRicmVha0FsbCA9IGlubGluZS5icmVha0FsbChjdHgsIHJlbVdpZHRoKTtcblxuICAgICAgICAgICAgICAgIGJlZm9yZSA9IF9pbmxpbmUkYnJlYWtBbGwuYmVmb3JlO1xuICAgICAgICAgICAgICAgIGFmdGVyID0gX2lubGluZSRicmVha0FsbC5hZnRlcjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICghYmVmb3JlICYmICFiZWZvcmVJbmxpbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIEFsd2F5cyByZXR1cm4gb25lIGNoYXJcbiAgICAgICAgICAgICAgICB2YXIgX2lubGluZSRzcGxpdEluZGV4ID0gaW5saW5lLnNwbGl0SW5kZXgoMSk7XG5cbiAgICAgICAgICAgICAgICBiZWZvcmUgPSBfaW5saW5lJHNwbGl0SW5kZXguYmVmb3JlO1xuICAgICAgICAgICAgICAgIGFmdGVyID0gX2lubGluZSRzcGxpdEluZGV4LmFmdGVyO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGJlZm9yZSkge1xuICAgICAgICAgICAgICAgIGJlZm9yZUlubGluZXMucHVzaChiZWZvcmUpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGFmdGVyKSB7XG4gICAgICAgICAgICAgICAgYWZ0ZXJJbmxpbmVzLnB1c2goYWZ0ZXIpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYWZ0ZXJJbmxpbmVzLnB1c2guYXBwbHkoYWZ0ZXJJbmxpbmVzLCBfdG9Db25zdW1hYmxlQXJyYXkoaW5saW5lcy5zbGljZShpbmRleCArIDEpKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpZiAoIWJlZm9yZUlubGluZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gQWx3YXlzIHJldHVybiBvbmUgY2hhclxuICAgICAgICAgICAgICAgIGJlZm9yZUlubGluZXMucHVzaChpbmxpbmUpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYWZ0ZXJJbmxpbmVzLnB1c2guYXBwbHkoYWZ0ZXJJbmxpbmVzLCBfdG9Db25zdW1hYmxlQXJyYXkoaW5saW5lcy5zbGljZShiZWZvcmVJbmxpbmVzLmxlbmd0aCkpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgYmVmb3JlSW5saW5lczogYmVmb3JlSW5saW5lcyxcbiAgICAgICAgICAgICAgb3ZlcmZsb3c6IHRydWUsXG4gICAgICAgICAgICAgIGFmdGVySW5saW5lczogYWZ0ZXJJbmxpbmVzXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIHRydW5jYXRlSW5saW5lcyhjdHgsIGlubGluZXMsIHdpZHRoLCBvcHRpb24pIHtcbiAgICAgICAgICAgIHZhciBpbmRleERhdGEgPSBnZXRPdmVyZmxvd0lubGluZXNJbmRleChjdHgsIGlubGluZXMsIHdpZHRoKTtcblxuICAgICAgICAgICAgaWYgKCFpbmRleERhdGEpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbmxpbmVzOiBpbmxpbmVzLFxuICAgICAgICAgICAgICAgIG92ZXJmbG93OiBmYWxzZVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBpbmRleERhdGEuaW5kZXgsXG4gICAgICAgICAgICAgICAgbGluZVdpZHRoID0gaW5kZXhEYXRhLmxpbmVXaWR0aDtcbiAgICAgICAgICAgIHZhciBpbmxpbmUgPSBpbmxpbmVzW2luZGV4XTtcbiAgICAgICAgICAgIHZhciBvdmVyZmxvd0lubGluZSA9IGdldE92ZXJmbG93SW5saW5lKG9wdGlvbik7XG4gICAgICAgICAgICB2YXIgZWxsaXBzaXNXaWR0aCA9IG92ZXJmbG93SW5saW5lLndpZHRoKHtcbiAgICAgICAgICAgICAgY3R4OiBjdHhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHJlbVdpZHRoID0gd2lkdGggLSBsaW5lV2lkdGggLSBlbGxpcHNpc1dpZHRoO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGlubGluZXMuc2xpY2UoMCwgaW5kZXgpO1xuXG4gICAgICAgICAgICBpZiAoaW5saW5lLmNhbkJyZWFrKCkpIHtcbiAgICAgICAgICAgICAgdmFyIF9pbmxpbmUkYnJlYWtBbGwyID0gaW5saW5lLmJyZWFrQWxsKGN0eCwgcmVtV2lkdGgpLFxuICAgICAgICAgICAgICAgICAgYmVmb3JlID0gX2lubGluZSRicmVha0FsbDIuYmVmb3JlO1xuXG4gICAgICAgICAgICAgIGlmIChiZWZvcmUpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChiZWZvcmUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKG92ZXJmbG93SW5saW5lKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGlubGluZXM6IHJlc3VsdCxcbiAgICAgICAgICAgICAgb3ZlcmZsb3c6IHRydWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gX2lubGluZVJlY3QoZ3JpZCwgY3R4LCBpbmxpbmUsIGRyYXdSZWN0LCBjb2wsIHJvdywgX3JlZikge1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IF9yZWYub2Zmc2V0LFxuICAgICAgICAgICAgICAgIGNvbG9yID0gX3JlZi5jb2xvcixcbiAgICAgICAgICAgICAgICB0ZXh0QWxpZ24gPSBfcmVmLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBfcmVmLnRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICBmb250ID0gX3JlZi5mb250LFxuICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdyA9IF9yZWYudGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgIGljb25zID0gX3JlZi5pY29ucyxcbiAgICAgICAgICAgICAgICB0cmFpbGluZ0ljb24gPSBfcmVmLnRyYWlsaW5nSWNvbjtcbiAgICAgICAgICAgIC8v5paH5a2Xc3R5bGVcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBfZ2V0U3R5bGVQcm9wZXJ0eShjb2xvciB8fCBjdHguZmlsbFN0eWxlLCBjb2wsIHJvdywgZ3JpZCwgY3R4KTtcbiAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSB0ZXh0QWxpZ247XG4gICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gdGV4dEJhc2VsaW5lO1xuICAgICAgICAgICAgY3R4LmZvbnQgPSBmb250IHx8IGN0eC5mb250O1xuICAgICAgICAgICAgdmFyIGlubGluZXMgPSBidWlsZElubGluZXMoaWNvbnMsIGlubGluZSk7XG4gICAgICAgICAgICB2YXIgdHJhaWxpbmdJY29uSW5saW5lID0gdHJhaWxpbmdJY29uID8gaW5saW5lVXRpbHMuaWNvbk9mKHRyYWlsaW5nSWNvbikgOiBudWxsO1xuICAgICAgICAgICAgdmFyIGlubGluZURyYXdSZWN0ID0gZHJhd1JlY3Q7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBkcmF3UmVjdC53aWR0aDtcbiAgICAgICAgICAgIHZhciB0cmFpbGluZ0ljb25XaWR0aCA9IDA7XG5cbiAgICAgICAgICAgIGlmICh0cmFpbGluZ0ljb25JbmxpbmUpIHtcbiAgICAgICAgICAgICAgdHJhaWxpbmdJY29uV2lkdGggPSB0cmFpbGluZ0ljb25JbmxpbmUud2lkdGgoe1xuICAgICAgICAgICAgICAgIGN0eDogY3R4XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB3aWR0aCAtPSB0cmFpbGluZ0ljb25XaWR0aDtcbiAgICAgICAgICAgICAgaW5saW5lRHJhd1JlY3QgPSBuZXcgUmVjdF8xLlJlY3QoZHJhd1JlY3QubGVmdCwgZHJhd1JlY3QudG9wLCB3aWR0aCwgZHJhd1JlY3QuaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzQWxsb3dPdmVyZmxvdyh0ZXh0T3ZlcmZsb3cpICYmIGlzT3ZlcmZsb3dJbmxpbmVzKGN0eCwgaW5saW5lcywgd2lkdGgpKSB7XG4gICAgICAgICAgICAgIHZhciBfdHJ1bmNhdGVJbmxpbmVzID0gdHJ1bmNhdGVJbmxpbmVzKGN0eCwgaW5saW5lcywgd2lkdGgsIHRleHRPdmVyZmxvdyksXG4gICAgICAgICAgICAgICAgICB0cnVuY0lubGluZXMgPSBfdHJ1bmNhdGVJbmxpbmVzLmlubGluZXMsXG4gICAgICAgICAgICAgICAgICBvdmVyZmxvdyA9IF90cnVuY2F0ZUlubGluZXMub3ZlcmZsb3c7XG5cbiAgICAgICAgICAgICAgaW5saW5lcyA9IHRydW5jSW5saW5lcztcbiAgICAgICAgICAgICAgZ3JpZC5zZXRDZWxsT3ZlcmZsb3dUZXh0KGNvbCwgcm93LCBvdmVyZmxvdyAmJiBpbmxpbmVUb1N0cmluZyhpbmxpbmUpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGdyaWQuc2V0Q2VsbE92ZXJmbG93VGV4dChjb2wsIHJvdywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkcmF3SW5saW5lcyhjdHgsIGlubGluZXMsIGlubGluZURyYXdSZWN0LCBvZmZzZXQsIDAsIDAsIGNvbCwgcm93LCBncmlkKTtcblxuICAgICAgICAgICAgaWYgKHRyYWlsaW5nSWNvbklubGluZSkge1xuICAgICAgICAgICAgICAvLyBEcmF3IHRyYWlsaW5nIGljb25cbiAgICAgICAgICAgICAgdmFyIHN1bVdpZHRoID0gMDtcbiAgICAgICAgICAgICAgaW5saW5lcy5mb3JFYWNoKGZ1bmN0aW9uIChpbmxpbmUpIHtcbiAgICAgICAgICAgICAgICBzdW1XaWR0aCArPSBpbmxpbmUud2lkdGgoe1xuICAgICAgICAgICAgICAgICAgY3R4OiBjdHhcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHZhciBiYXNlUmVjdCA9IG5ldyBSZWN0XzEuUmVjdChkcmF3UmVjdC5sZWZ0LCBkcmF3UmVjdC50b3AsIGRyYXdSZWN0LndpZHRoLCBkcmF3UmVjdC5oZWlnaHQpO1xuICAgICAgICAgICAgICB2YXIgdHJhaWxpbmdJY29uUmVjdCA9IGJhc2VSZWN0LmNvcHkoKTtcblxuICAgICAgICAgICAgICBpZiAod2lkdGggPCBzdW1XaWR0aCkge1xuICAgICAgICAgICAgICAgIHRyYWlsaW5nSWNvblJlY3QubGVmdCA9IHRyYWlsaW5nSWNvblJlY3QucmlnaHQgLSB0cmFpbGluZ0ljb25XaWR0aCAtIG9mZnNldDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0cmFpbGluZ0ljb25SZWN0LmxlZnQgKz0gc3VtV2lkdGg7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0cmFpbGluZ0ljb25SZWN0LnJpZ2h0ID0gYmFzZVJlY3QucmlnaHQ7XG4gICAgICAgICAgICAgIGRyYXdJbmxpbmVzKGN0eCwgW3RyYWlsaW5nSWNvbklubGluZV0sIHRyYWlsaW5nSWNvblJlY3QsIG9mZnNldCwgMCwgMCwgY29sLCByb3csIGdyaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHlcblxuXG4gICAgICAgICAgZnVuY3Rpb24gX211bHRpSW5saW5lUmVjdChncmlkLCBjdHgsIG11bHRpSW5saW5lcywgZHJhd1JlY3QsIGNvbCwgcm93LCBfcmVmMikge1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IF9yZWYyLm9mZnNldCxcbiAgICAgICAgICAgICAgICBjb2xvciA9IF9yZWYyLmNvbG9yLFxuICAgICAgICAgICAgICAgIHRleHRBbGlnbiA9IF9yZWYyLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBfcmVmMi50ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgZm9udCA9IF9yZWYyLmZvbnQsXG4gICAgICAgICAgICAgICAgbGluZUhlaWdodCA9IF9yZWYyLmxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgYXV0b1dyYXBUZXh0ID0gX3JlZjIuYXV0b1dyYXBUZXh0LFxuICAgICAgICAgICAgICAgIGxpbmVDbGFtcCA9IF9yZWYyLmxpbmVDbGFtcCxcbiAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3cgPSBfcmVmMi50ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgaWNvbnMgPSBfcmVmMi5pY29ucyxcbiAgICAgICAgICAgICAgICB0cmFpbGluZ0ljb24gPSBfcmVmMi50cmFpbGluZ0ljb247XG4gICAgICAgICAgICAvL+aWh+Wtl3N0eWxlXG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gX2dldFN0eWxlUHJvcGVydHkoY29sb3IgfHwgY3R4LmZpbGxTdHlsZSwgY29sLCByb3csIGdyaWQsIGN0eCk7XG4gICAgICAgICAgICBjdHgudGV4dEFsaWduID0gdGV4dEFsaWduO1xuICAgICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9IHRleHRCYXNlbGluZTtcbiAgICAgICAgICAgIGN0eC5mb250ID0gZm9udCB8fCBjdHguZm9udDtcblxuICAgICAgICAgICAgaWYgKGxpbmVDbGFtcCA9PT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgICAgdmFyIHJlY3RIZWlnaHQgPSBkcmF3UmVjdC5oZWlnaHQgLSBvZmZzZXQgKiAyIC0gMjtcbiAgICAgICAgICAgICAgLypvZmZzZXQgYWRkZWQgYnkgSW5saW5lI2RyYXcqL1xuXG4gICAgICAgICAgICAgIGxpbmVDbGFtcCA9IE1hdGgubWF4KE1hdGguZmxvb3IocmVjdEhlaWdodCAvIGxpbmVIZWlnaHQpLCAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRyYWlsaW5nSWNvbklubGluZSA9IHRyYWlsaW5nSWNvbiA/IGlubGluZVV0aWxzLmljb25PZih0cmFpbGluZ0ljb24pIDogbnVsbDtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGRyYXdSZWN0LndpZHRoO1xuICAgICAgICAgICAgdmFyIHRyYWlsaW5nSWNvbldpZHRoID0gMDtcblxuICAgICAgICAgICAgaWYgKHRyYWlsaW5nSWNvbklubGluZSkge1xuICAgICAgICAgICAgICB0cmFpbGluZ0ljb25XaWR0aCA9IHRyYWlsaW5nSWNvbklubGluZS53aWR0aCh7XG4gICAgICAgICAgICAgICAgY3R4OiBjdHhcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHdpZHRoIC09IHRyYWlsaW5nSWNvbldpZHRoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYnVpbGRlZE11bHRpSW5saW5lcztcblxuICAgICAgICAgICAgaWYgKGF1dG9XcmFwVGV4dCB8fCBsaW5lQ2xhbXAgPiAwIHx8IGlzQWxsb3dPdmVyZmxvdyh0ZXh0T3ZlcmZsb3cpKSB7XG4gICAgICAgICAgICAgIGJ1aWxkZWRNdWx0aUlubGluZXMgPSBbXTtcbiAgICAgICAgICAgICAgdmFyIHByb2NMaW5lQ2xhbXAgPSBsaW5lQ2xhbXAgPiAwID8gZnVuY3Rpb24gKGlubGluZXMsIGhhc05leHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoYnVpbGRlZE11bHRpSW5saW5lcy5sZW5ndGggKyAxID49IGxpbmVDbGFtcCkge1xuICAgICAgICAgICAgICAgICAgaWYgKGlubGluZXMubGVuZ3RoID09PSAwICYmIGhhc05leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnVpbGRlZE11bHRpSW5saW5lcy5wdXNoKFtnZXRPdmVyZmxvd0lubGluZSh0ZXh0T3ZlcmZsb3cpXSk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQuc2V0Q2VsbE92ZXJmbG93VGV4dChjb2wsIHJvdywgbXVsdGlJbmxpbmVzLm1hcChpbmxpbmVUb1N0cmluZykuam9pbihcIlxcblwiKSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RydW5jYXRlSW5saW5lczIgPSB0cnVuY2F0ZUlubGluZXMoY3R4LCBpbmxpbmVzLCB3aWR0aCwgdGV4dE92ZXJmbG93KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRydW5jSW5saW5lcyA9IF90cnVuY2F0ZUlubGluZXMyLmlubGluZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdyA9IF90cnVuY2F0ZUlubGluZXMyLm92ZXJmbG93O1xuXG4gICAgICAgICAgICAgICAgICAgIGJ1aWxkZWRNdWx0aUlubGluZXMucHVzaChoYXNOZXh0ICYmICFvdmVyZmxvdyA/IHRydW5jSW5saW5lcy5jb25jYXQoW2dldE92ZXJmbG93SW5saW5lKHRleHRPdmVyZmxvdyldKSA6IHRydW5jSW5saW5lcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG92ZXJmbG93IHx8IGhhc05leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICBncmlkLnNldENlbGxPdmVyZmxvd1RleHQoY29sLCByb3csIG11bHRpSW5saW5lcy5tYXAoaW5saW5lVG9TdHJpbmcpLmpvaW4oXCJcXG5cIikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgdmFyIHByb2NMaW5lID0gYXV0b1dyYXBUZXh0ID8gZnVuY3Rpb24gKGlubGluZXMsIGhhc05leHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXByb2NMaW5lQ2xhbXAoaW5saW5lcywgaGFzTmV4dCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAoaW5saW5lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghcHJvY0xpbmVDbGFtcChpbmxpbmVzLCBoYXNOZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBfYnJlYWtXaWR0aElubGluZXMgPSBicmVha1dpZHRoSW5saW5lcyhjdHgsIGlubGluZXMsIHdpZHRoKSxcbiAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVJbmxpbmVzID0gX2JyZWFrV2lkdGhJbmxpbmVzLmJlZm9yZUlubGluZXMsXG4gICAgICAgICAgICAgICAgICAgICAgYWZ0ZXJJbmxpbmVzID0gX2JyZWFrV2lkdGhJbmxpbmVzLmFmdGVySW5saW5lcztcblxuICAgICAgICAgICAgICAgICAgYnVpbGRlZE11bHRpSW5saW5lcy5wdXNoKGJlZm9yZUlubGluZXMpO1xuICAgICAgICAgICAgICAgICAgaW5saW5lcyA9IGFmdGVySW5saW5lcztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfSA6IGlzQWxsb3dPdmVyZmxvdyh0ZXh0T3ZlcmZsb3cpID8gZnVuY3Rpb24gKGlubGluZXMsIGhhc05leHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXByb2NMaW5lQ2xhbXAoaW5saW5lcywgaGFzTmV4dCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgX3RydW5jYXRlSW5saW5lczMgPSB0cnVuY2F0ZUlubGluZXMoY3R4LCBpbmxpbmVzLCB3aWR0aCwgdGV4dE92ZXJmbG93KSxcbiAgICAgICAgICAgICAgICAgICAgdHJ1bmNJbmxpbmVzID0gX3RydW5jYXRlSW5saW5lczMuaW5saW5lcyxcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3cgPSBfdHJ1bmNhdGVJbmxpbmVzMy5vdmVyZmxvdztcblxuICAgICAgICAgICAgICAgIGJ1aWxkZWRNdWx0aUlubGluZXMucHVzaCh0cnVuY0lubGluZXMpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG92ZXJmbG93KSB7XG4gICAgICAgICAgICAgICAgICBncmlkLnNldENlbGxPdmVyZmxvd1RleHQoY29sLCByb3csIG11bHRpSW5saW5lcy5tYXAoaW5saW5lVG9TdHJpbmcpLmpvaW4oXCJcXG5cIikpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9IDogZnVuY3Rpb24gKGlubGluZXMsIGhhc05leHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXByb2NMaW5lQ2xhbXAoaW5saW5lcywgaGFzTmV4dCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBidWlsZGVkTXVsdGlJbmxpbmVzLnB1c2goaW5saW5lcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIGdyaWQuc2V0Q2VsbE92ZXJmbG93VGV4dChjb2wsIHJvdywgZmFsc2UpO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGxpbmVSb3cgPSAwOyBsaW5lUm93IDwgbXVsdGlJbmxpbmVzLmxlbmd0aDsgbGluZVJvdysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlubGluZSA9IG11bHRpSW5saW5lc1tsaW5lUm93XTtcbiAgICAgICAgICAgICAgICB2YXIgYnVpbGRlZElubGluZSA9IGJ1aWxkSW5saW5lcyhsaW5lUm93ID09PSAwID8gaWNvbnMgOiB1bmRlZmluZWQsIGlubGluZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXByb2NMaW5lKGJ1aWxkZWRJbmxpbmUsIGxpbmVSb3cgKyAxIDwgbXVsdGlJbmxpbmVzLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZ3JpZC5zZXRDZWxsT3ZlcmZsb3dUZXh0KGNvbCwgcm93LCBmYWxzZSk7XG4gICAgICAgICAgICAgIGJ1aWxkZWRNdWx0aUlubGluZXMgPSBtdWx0aUlubGluZXMubWFwKGZ1bmN0aW9uIChpbmxpbmUsIGxpbmVSb3cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRJbmxpbmVzKGxpbmVSb3cgPT09IDAgPyBpY29ucyA6IHVuZGVmaW5lZCwgaW5saW5lKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwYWRkaW5nVG9wID0gMDtcbiAgICAgICAgICAgIHZhciBwYWRkaW5nQm90dG9tID0gbGluZUhlaWdodCAqIChidWlsZGVkTXVsdGlJbmxpbmVzLmxlbmd0aCAtIDEpO1xuXG4gICAgICAgICAgICBpZiAoY3R4LnRleHRCYXNlbGluZSA9PT0gXCJ0b3BcIiB8fCBjdHgudGV4dEJhc2VsaW5lID09PSBcImhhbmdpbmdcIikge1xuICAgICAgICAgICAgICB2YXIgZW0gPSAoMCwgY2FudmFzZXNfMS5nZXRGb250U2l6ZSkoY3R4LCBjdHguZm9udCkuaGVpZ2h0O1xuICAgICAgICAgICAgICB2YXIgcGFkID0gKGxpbmVIZWlnaHQgLSBlbSkgLyAyO1xuICAgICAgICAgICAgICBwYWRkaW5nVG9wICs9IHBhZDtcbiAgICAgICAgICAgICAgcGFkZGluZ0JvdHRvbSAtPSBwYWQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGN0eC50ZXh0QmFzZWxpbmUgPT09IFwiYm90dG9tXCIgfHwgY3R4LnRleHRCYXNlbGluZSA9PT0gXCJhbHBoYWJldGljXCIgfHwgY3R4LnRleHRCYXNlbGluZSA9PT0gXCJpZGVvZ3JhcGhpY1wiKSB7XG4gICAgICAgICAgICAgIHZhciBfZW0gPSAoMCwgY2FudmFzZXNfMS5nZXRGb250U2l6ZSkoY3R4LCBjdHguZm9udCkuaGVpZ2h0O1xuXG4gICAgICAgICAgICAgIHZhciBfcGFkID0gKGxpbmVIZWlnaHQgLSBfZW0pIC8gMjtcblxuICAgICAgICAgICAgICBwYWRkaW5nVG9wIC09IF9wYWQ7XG4gICAgICAgICAgICAgIHBhZGRpbmdCb3R0b20gKz0gX3BhZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnVpbGRlZE11bHRpSW5saW5lcy5mb3JFYWNoKGZ1bmN0aW9uIChidWlsZGVkSW5saW5lKSB7XG4gICAgICAgICAgICAgIGRyYXdJbmxpbmVzKGN0eCwgYnVpbGRlZElubGluZSwgZHJhd1JlY3QsIG9mZnNldCwgcGFkZGluZ1RvcCwgcGFkZGluZ0JvdHRvbSwgY29sLCByb3csIGdyaWQpO1xuICAgICAgICAgICAgICBwYWRkaW5nVG9wICs9IGxpbmVIZWlnaHQ7XG4gICAgICAgICAgICAgIHBhZGRpbmdCb3R0b20gLT0gbGluZUhlaWdodDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAodHJhaWxpbmdJY29uSW5saW5lKSB7XG4gICAgICAgICAgICAgIC8vIERyYXcgdHJhaWxpbmcgaWNvblxuICAgICAgICAgICAgICB2YXIgbWF4V2lkdGggPSAwO1xuICAgICAgICAgICAgICBidWlsZGVkTXVsdGlJbmxpbmVzLmZvckVhY2goZnVuY3Rpb24gKGJ1aWxkZWRJbmxpbmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VtV2lkdGggPSAwO1xuICAgICAgICAgICAgICAgIGJ1aWxkZWRJbmxpbmUuZm9yRWFjaChmdW5jdGlvbiAoaW5saW5lKSB7XG4gICAgICAgICAgICAgICAgICBzdW1XaWR0aCArPSBpbmxpbmUud2lkdGgoe1xuICAgICAgICAgICAgICAgICAgICBjdHg6IGN0eFxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgbWF4V2lkdGggPSBNYXRoLm1heChtYXhXaWR0aCwgc3VtV2lkdGgpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdmFyIGJhc2VSZWN0ID0gbmV3IFJlY3RfMS5SZWN0KGRyYXdSZWN0LmxlZnQsIGRyYXdSZWN0LnRvcCwgZHJhd1JlY3Qud2lkdGgsIGRyYXdSZWN0LmhlaWdodCk7XG4gICAgICAgICAgICAgIHZhciB0cmFpbGluZ0ljb25SZWN0ID0gYmFzZVJlY3QuY29weSgpO1xuXG4gICAgICAgICAgICAgIGlmICh3aWR0aCA8IG1heFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgdHJhaWxpbmdJY29uUmVjdC5sZWZ0ID0gdHJhaWxpbmdJY29uUmVjdC5yaWdodCAtIHRyYWlsaW5nSWNvbldpZHRoIC0gb2Zmc2V0O1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRyYWlsaW5nSWNvblJlY3QubGVmdCArPSBtYXhXaWR0aDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRyYWlsaW5nSWNvblJlY3QucmlnaHQgPSBiYXNlUmVjdC5yaWdodDtcbiAgICAgICAgICAgICAgZHJhd0lubGluZXMoY3R4LCBbdHJhaWxpbmdJY29uSW5saW5lXSwgdHJhaWxpbmdJY29uUmVjdCwgb2Zmc2V0LCAwLCAwLCBjb2wsIHJvdywgZ3JpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY2FsY0VsYXBzZWRDb2xvcihzdGFydENvbG9yLCBlbmRDb2xvciwgZWxhcHNlZFRpbWUpIHtcbiAgICAgICAgICAgIHZhciBzdGFydENvbG9yUkdCID0gKDAsIGNvbG9yXzEuY29sb3JUb1JHQikoc3RhcnRDb2xvcik7XG4gICAgICAgICAgICB2YXIgZW5kQ29sb3JSR0IgPSAoMCwgY29sb3JfMS5jb2xvclRvUkdCKShlbmRDb2xvcik7XG5cbiAgICAgICAgICAgIHZhciBnZXRSR0IgPSBmdW5jdGlvbiBnZXRSR0IoY29sb3JOYW1lKSB7XG4gICAgICAgICAgICAgIHZhciBzdGFydCA9IHN0YXJ0Q29sb3JSR0JbY29sb3JOYW1lXTtcbiAgICAgICAgICAgICAgdmFyIGVuZCA9IGVuZENvbG9yUkdCW2NvbG9yTmFtZV07XG5cbiAgICAgICAgICAgICAgaWYgKGVsYXBzZWRUaW1lID49IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW5kO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGVsYXBzZWRUaW1lIDw9IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnQ7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgZGlmZiA9IHN0YXJ0IC0gZW5kO1xuICAgICAgICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHN0YXJ0IC0gZGlmZiAqIGVsYXBzZWRUaW1lKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiBcInJnYihcIi5jb25jYXQoZ2V0UkdCKFwiclwiKSwgXCIsIFwiKS5jb25jYXQoZ2V0UkdCKFwiZ1wiKSwgXCIsIFwiKS5jb25jYXQoZ2V0UkdCKFwiYlwiKSwgXCIpXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGRyYXdDaGVja2JveChjdHgsIHJlY3QsIGNvbCwgcm93LCBjaGVjaywgaGVscGVyLCBfcmVmMykge1xuICAgICAgICAgICAgdmFyIF9yZWYzJGFuaW1FbGFwc2VkVGltZSA9IF9yZWYzLmFuaW1FbGFwc2VkVGltZSxcbiAgICAgICAgICAgICAgICBhbmltRWxhcHNlZFRpbWUgPSBfcmVmMyRhbmltRWxhcHNlZFRpbWUgPT09IHZvaWQgMCA/IDEgOiBfcmVmMyRhbmltRWxhcHNlZFRpbWUsXG4gICAgICAgICAgICAgICAgX3JlZjMkdW5jaGVja0JnQ29sb3IgPSBfcmVmMy51bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvciA9IF9yZWYzJHVuY2hlY2tCZ0NvbG9yID09PSB2b2lkIDAgPyBoZWxwZXIudGhlbWUuY2hlY2tib3gudW5jaGVja0JnQ29sb3IgOiBfcmVmMyR1bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICBfcmVmMyRjaGVja0JnQ29sb3IgPSBfcmVmMy5jaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yID0gX3JlZjMkY2hlY2tCZ0NvbG9yID09PSB2b2lkIDAgPyBoZWxwZXIudGhlbWUuY2hlY2tib3guY2hlY2tCZ0NvbG9yIDogX3JlZjMkY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgIF9yZWYzJGJvcmRlckNvbG9yID0gX3JlZjMuYm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSBfcmVmMyRib3JkZXJDb2xvciA9PT0gdm9pZCAwID8gaGVscGVyLnRoZW1lLmNoZWNrYm94LmJvcmRlckNvbG9yIDogX3JlZjMkYm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgX3JlZjMkdGV4dEFsaWduID0gX3JlZjMudGV4dEFsaWduLFxuICAgICAgICAgICAgICAgIHRleHRBbGlnbiA9IF9yZWYzJHRleHRBbGlnbiA9PT0gdm9pZCAwID8gXCJjZW50ZXJcIiA6IF9yZWYzJHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICBfcmVmMyR0ZXh0QmFzZWxpbmUgPSBfcmVmMy50ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lID0gX3JlZjMkdGV4dEJhc2VsaW5lID09PSB2b2lkIDAgPyBcIm1pZGRsZVwiIDogX3JlZjMkdGV4dEJhc2VsaW5lO1xuICAgICAgICAgICAgdmFyIHBvc2l0aW9uT3B0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDcgJiYgYXJndW1lbnRzWzddICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbN10gOiB7fTtcbiAgICAgICAgICAgIHZhciBib3hXaWR0aCA9IGNhbnZhc2hlbHBlci5tZWFzdXJlQ2hlY2tib3goY3R4KS53aWR0aDtcbiAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSB0ZXh0QWxpZ247XG4gICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gdGV4dEJhc2VsaW5lO1xuICAgICAgICAgICAgdmFyIHBvcyA9ICgwLCBjYW52YXNlc18xLmNhbGNTdGFydFBvc2l0aW9uKShjdHgsIHJlY3QsIGJveFdpZHRoICsgMVxuICAgICAgICAgICAgLyrnvavnt5rliIYrMSovXG4gICAgICAgICAgICAsIGJveFdpZHRoICsgMVxuICAgICAgICAgICAgLyrnvavnt5rliIYrMSovXG4gICAgICAgICAgICAsIHBvc2l0aW9uT3B0KTtcbiAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yID0gaGVscGVyLmdldENvbG9yKHVuY2hlY2tCZ0NvbG9yLCBjb2wsIHJvdywgY3R4KTtcbiAgICAgICAgICAgIGNoZWNrQmdDb2xvciA9IGhlbHBlci5nZXRDb2xvcihjaGVja0JnQ29sb3IsIGNvbCwgcm93LCBjdHgpO1xuICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSBoZWxwZXIuZ2V0Q29sb3IoYm9yZGVyQ29sb3IsIGNvbCwgcm93LCBjdHgpO1xuXG4gICAgICAgICAgICBpZiAoMCA8IGFuaW1FbGFwc2VkVGltZSAmJiBhbmltRWxhcHNlZFRpbWUgPCAxKSB7XG4gICAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yID0gY2hlY2sgPyB1bmNoZWNrQmdDb2xvciA6IGNhbGNFbGFwc2VkQ29sb3IoY2hlY2tCZ0NvbG9yLCB1bmNoZWNrQmdDb2xvciwgYW5pbUVsYXBzZWRUaW1lKTtcbiAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yID0gY2hlY2sgPyBjYWxjRWxhcHNlZENvbG9yKHVuY2hlY2tCZ0NvbG9yLCBjaGVja0JnQ29sb3IsIGFuaW1FbGFwc2VkVGltZSkgOiBjaGVja0JnQ29sb3I7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhbnZhc2hlbHBlci5kcmF3Q2hlY2tib3goY3R4LCBwb3MueCwgcG9zLnksIGNoZWNrID8gYW5pbUVsYXBzZWRUaW1lIDogZmFsc2UsIHtcbiAgICAgICAgICAgICAgdW5jaGVja0JnQ29sb3I6IHVuY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICBjaGVja0JnQ29sb3I6IGNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IGJvcmRlckNvbG9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBkcmF3UmFkaW9CdXR0b24oY3R4LCByZWN0LCBjb2wsIHJvdywgY2hlY2ssIGhlbHBlciwgX3JlZjQpIHtcbiAgICAgICAgICAgIHZhciBfcmVmNCRhbmltRWxhcHNlZFRpbWUgPSBfcmVmNC5hbmltRWxhcHNlZFRpbWUsXG4gICAgICAgICAgICAgICAgYW5pbUVsYXBzZWRUaW1lID0gX3JlZjQkYW5pbUVsYXBzZWRUaW1lID09PSB2b2lkIDAgPyAxIDogX3JlZjQkYW5pbUVsYXBzZWRUaW1lLFxuICAgICAgICAgICAgICAgIF9yZWY0JGNoZWNrQ29sb3IgPSBfcmVmNC5jaGVja0NvbG9yLFxuICAgICAgICAgICAgICAgIGNoZWNrQ29sb3IgPSBfcmVmNCRjaGVja0NvbG9yID09PSB2b2lkIDAgPyBoZWxwZXIudGhlbWUucmFkaW9CdXR0b24uY2hlY2tDb2xvciA6IF9yZWY0JGNoZWNrQ29sb3IsXG4gICAgICAgICAgICAgICAgX3JlZjQkdW5jaGVja0JvcmRlckNvID0gX3JlZjQudW5jaGVja0JvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgIHVuY2hlY2tCb3JkZXJDb2xvciA9IF9yZWY0JHVuY2hlY2tCb3JkZXJDbyA9PT0gdm9pZCAwID8gaGVscGVyLnRoZW1lLnJhZGlvQnV0dG9uLnVuY2hlY2tCb3JkZXJDb2xvciA6IF9yZWY0JHVuY2hlY2tCb3JkZXJDbyxcbiAgICAgICAgICAgICAgICBfcmVmNCRjaGVja0JvcmRlckNvbG8gPSBfcmVmNC5jaGVja0JvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgIGNoZWNrQm9yZGVyQ29sb3IgPSBfcmVmNCRjaGVja0JvcmRlckNvbG8gPT09IHZvaWQgMCA/IGhlbHBlci50aGVtZS5yYWRpb0J1dHRvbi5jaGVja0JvcmRlckNvbG9yIDogX3JlZjQkY2hlY2tCb3JkZXJDb2xvLFxuICAgICAgICAgICAgICAgIF9yZWY0JHVuY2hlY2tCZ0NvbG9yID0gX3JlZjQudW5jaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgdW5jaGVja0JnQ29sb3IgPSBfcmVmNCR1bmNoZWNrQmdDb2xvciA9PT0gdm9pZCAwID8gaGVscGVyLnRoZW1lLnJhZGlvQnV0dG9uLnVuY2hlY2tCZ0NvbG9yIDogX3JlZjQkdW5jaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgX3JlZjQkY2hlY2tCZ0NvbG9yID0gX3JlZjQuY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgIGNoZWNrQmdDb2xvciA9IF9yZWY0JGNoZWNrQmdDb2xvciA9PT0gdm9pZCAwID8gaGVscGVyLnRoZW1lLnJhZGlvQnV0dG9uLmNoZWNrQmdDb2xvciA6IF9yZWY0JGNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICBfcmVmNCR0ZXh0QWxpZ24gPSBfcmVmNC50ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgdGV4dEFsaWduID0gX3JlZjQkdGV4dEFsaWduID09PSB2b2lkIDAgPyBcImNlbnRlclwiIDogX3JlZjQkdGV4dEFsaWduLFxuICAgICAgICAgICAgICAgIF9yZWY0JHRleHRCYXNlbGluZSA9IF9yZWY0LnRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBfcmVmNCR0ZXh0QmFzZWxpbmUgPT09IHZvaWQgMCA/IFwibWlkZGxlXCIgOiBfcmVmNCR0ZXh0QmFzZWxpbmU7XG4gICAgICAgICAgICB2YXIgcG9zaXRpb25PcHQgPSBhcmd1bWVudHMubGVuZ3RoID4gNyAmJiBhcmd1bWVudHNbN10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s3XSA6IHt9O1xuICAgICAgICAgICAgdmFyIGJveFdpZHRoID0gY2FudmFzaGVscGVyLm1lYXN1cmVSYWRpb0J1dHRvbihjdHgpLndpZHRoO1xuICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9IHRleHRBbGlnbjtcbiAgICAgICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSB0ZXh0QmFzZWxpbmU7XG4gICAgICAgICAgICB2YXIgcG9zID0gKDAsIGNhbnZhc2VzXzEuY2FsY1N0YXJ0UG9zaXRpb24pKGN0eCwgcmVjdCwgYm94V2lkdGggKyAxXG4gICAgICAgICAgICAvKue9q+e3muWIhisxKi9cbiAgICAgICAgICAgICwgYm94V2lkdGggKyAxXG4gICAgICAgICAgICAvKue9q+e3muWIhisxKi9cbiAgICAgICAgICAgICwgcG9zaXRpb25PcHQpO1xuICAgICAgICAgICAgY2hlY2tDb2xvciA9IGhlbHBlci5nZXRDb2xvcihjaGVja0NvbG9yLCBjb2wsIHJvdywgY3R4KTtcbiAgICAgICAgICAgIHVuY2hlY2tCb3JkZXJDb2xvciA9IGhlbHBlci5nZXRDb2xvcih1bmNoZWNrQm9yZGVyQ29sb3IsIGNvbCwgcm93LCBjdHgpO1xuICAgICAgICAgICAgY2hlY2tCb3JkZXJDb2xvciA9IGhlbHBlci5nZXRDb2xvcihjaGVja0JvcmRlckNvbG9yLCBjb2wsIHJvdywgY3R4KTtcbiAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yID0gaGVscGVyLmdldENvbG9yKHVuY2hlY2tCZ0NvbG9yLCBjb2wsIHJvdywgY3R4KTtcbiAgICAgICAgICAgIGNoZWNrQmdDb2xvciA9IGhlbHBlci5nZXRDb2xvcihjaGVja0JnQ29sb3IsIGNvbCwgcm93LCBjdHgpO1xuICAgICAgICAgICAgdmFyIGJvcmRlckNvbG9yID0gY2hlY2sgPyBjaGVja0JvcmRlckNvbG9yIDogdW5jaGVja0JvcmRlckNvbG9yO1xuICAgICAgICAgICAgdmFyIGJnQ29sb3IgPSBjaGVjayA/IGNoZWNrQmdDb2xvciA6IHVuY2hlY2tCZ0NvbG9yO1xuXG4gICAgICAgICAgICBpZiAoMCA8IGFuaW1FbGFwc2VkVGltZSAmJiBhbmltRWxhcHNlZFRpbWUgPCAxKSB7XG4gICAgICAgICAgICAgIGJvcmRlckNvbG9yID0gY2hlY2sgPyBjYWxjRWxhcHNlZENvbG9yKHVuY2hlY2tCb3JkZXJDb2xvciwgY2hlY2tCb3JkZXJDb2xvciwgYW5pbUVsYXBzZWRUaW1lKSA6IGNhbGNFbGFwc2VkQ29sb3IoY2hlY2tCb3JkZXJDb2xvciwgdW5jaGVja0JvcmRlckNvbG9yLCBhbmltRWxhcHNlZFRpbWUpO1xuICAgICAgICAgICAgICBiZ0NvbG9yID0gY2hlY2sgPyBjYWxjRWxhcHNlZENvbG9yKHVuY2hlY2tCZ0NvbG9yLCBjaGVja0JnQ29sb3IsIGFuaW1FbGFwc2VkVGltZSkgOiBjYWxjRWxhcHNlZENvbG9yKGNoZWNrQmdDb2xvciwgdW5jaGVja0JnQ29sb3IsIGFuaW1FbGFwc2VkVGltZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhbnZhc2hlbHBlci5kcmF3UmFkaW9CdXR0b24oY3R4LCBwb3MueCwgcG9zLnksIGNoZWNrID8gYW5pbUVsYXBzZWRUaW1lIDogMSAtIGFuaW1FbGFwc2VkVGltZSwge1xuICAgICAgICAgICAgICBjaGVja0NvbG9yOiBjaGVja0NvbG9yLFxuICAgICAgICAgICAgICBib3JkZXJDb2xvcjogYm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgIGJnQ29sb3I6IGJnQ29sb3JcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBUaGVtZVJlc29sdmVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFRoZW1lUmVzb2x2ZXIoZ3JpZCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGhlbWVSZXNvbHZlcik7XG5cbiAgICAgICAgICAgICAgdGhpcy5fY2hlY2tib3ggPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9yYWRpb0J1dHRvbiA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMuX2J1dHRvbiA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMuX3RyZWUgPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9oZWFkZXIgPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9tZXNzYWdlcyA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMuX2luZGljYXRvcnMgPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9ncmlkID0gZ3JpZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFRoZW1lUmVzb2x2ZXIsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRUaGVtZVZhbHVlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUaGVtZVZhbHVlKCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgbmFtZSA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuICAgICAgICAgICAgICAgICAgbmFtZVtfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZS5hcHBseSh2b2lkIDAsIFt0aGlzLl9ncmlkXS5jb25jYXQobmFtZSkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmb250XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZSh0aGlzLl9ncmlkLCBcImZvbnRcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInVuZGVybGF5QmFja2dyb3VuZENvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZSh0aGlzLl9ncmlkLCBcInVuZGVybGF5QmFja2dyb3VuZENvbG9yXCIpO1xuICAgICAgICAgICAgICB9IC8vIGNvbG9yXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZSh0aGlzLl9ncmlkLCBcImNvbG9yXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmcm96ZW5Sb3dzQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKHRoaXMuX2dyaWQsIFwiZnJvemVuUm93c0NvbG9yXCIpO1xuICAgICAgICAgICAgICB9IC8vIGJhY2tncm91bmRcblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZGVmYXVsdEJnQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKHRoaXMuX2dyaWQsIFwiZGVmYXVsdEJnQ29sb3JcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZyb3plblJvd3NCZ0NvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZSh0aGlzLl9ncmlkLCBcImZyb3plblJvd3NCZ0NvbG9yXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzZWxlY3Rpb25CZ0NvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZSh0aGlzLl9ncmlkLCBcInNlbGVjdGlvbkJnQ29sb3JcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImhpZ2hsaWdodEJnQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKHRoaXMuX2dyaWQsIFwiaGlnaGxpZ2h0QmdDb2xvclwiKTtcbiAgICAgICAgICAgICAgfSAvLyBib3JkZXJcblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYm9yZGVyQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKHRoaXMuX2dyaWQsIFwiYm9yZGVyQ29sb3JcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZyb3plblJvd3NCb3JkZXJDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldFRoZW1lVmFsdWUodGhpcy5fZ3JpZCwgXCJmcm96ZW5Sb3dzQm9yZGVyQ29sb3JcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImhpZ2hsaWdodEJvcmRlckNvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZSh0aGlzLl9ncmlkLCBcImhpZ2hsaWdodEJvcmRlckNvbG9yXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjaGVja2JveFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuX2dyaWQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoZWNrYm94IHx8ICh0aGlzLl9jaGVja2JveCA9IHtcbiAgICAgICAgICAgICAgICAgIGdldCB1bmNoZWNrQmdDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENoZWNrYm94UHJvcChcInVuY2hlY2tCZ0NvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGNoZWNrQmdDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENoZWNrYm94UHJvcChcImNoZWNrQmdDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBib3JkZXJDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENoZWNrYm94UHJvcChcImJvcmRlckNvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRDaGVja2JveFByb3AocHJvcCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKGdyaWQsIFwiY2hlY2tib3hcIiwgcHJvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJyYWRpb0J1dHRvblwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuX2dyaWQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JhZGlvQnV0dG9uIHx8ICh0aGlzLl9yYWRpb0J1dHRvbiA9IHtcbiAgICAgICAgICAgICAgICAgIGdldCBjaGVja0NvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UmFkaW9CdXR0b25Qcm9wKFwiY2hlY2tDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB1bmNoZWNrQm9yZGVyQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRSYWRpb0J1dHRvblByb3AoXCJ1bmNoZWNrQm9yZGVyQ29sb3JcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgY2hlY2tCb3JkZXJDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFJhZGlvQnV0dG9uUHJvcChcImNoZWNrQm9yZGVyQ29sb3JcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgdW5jaGVja0JnQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRSYWRpb0J1dHRvblByb3AoXCJ1bmNoZWNrQmdDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBjaGVja0JnQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRSYWRpb0J1dHRvblByb3AoXCJjaGVja0JnQ29sb3JcIik7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJhZGlvQnV0dG9uUHJvcChwcm9wKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX2dldFRoZW1lVmFsdWUoZ3JpZCwgXCJyYWRpb0J1dHRvblwiLCBwcm9wKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJ1dHRvblwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuX2dyaWQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2J1dHRvbiB8fCAodGhpcy5fYnV0dG9uID0ge1xuICAgICAgICAgICAgICAgICAgZ2V0IGNvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0QnV0dG9uUHJvcChcImNvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGJnQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRCdXR0b25Qcm9wKFwiYmdDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0QnV0dG9uUHJvcChwcm9wKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX2dldFRoZW1lVmFsdWUoZ3JpZCwgXCJidXR0b25cIiwgcHJvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ0cmVlXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBncmlkID0gdGhpcy5fZ3JpZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdHJlZSB8fCAodGhpcy5fdHJlZSA9IHtcbiAgICAgICAgICAgICAgICAgIGdldCBsaW5lU3R5bGUoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRUcmVlUHJvcChcImxpbmVTdHlsZVwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBsaW5lQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRUcmVlUHJvcChcImxpbmVDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBsaW5lV2lkdGgoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRUcmVlUHJvcChcImxpbmVXaWR0aFwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB0cmVlSWNvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFRyZWVQcm9wKFwidHJlZUljb25cIik7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFRyZWVQcm9wKHByb3ApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VGhlbWVWYWx1ZShncmlkLCBcInRyZWVcIiwgcHJvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoZWFkZXJcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLl9ncmlkO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWFkZXIgfHwgKHRoaXMuX2hlYWRlciA9IHtcbiAgICAgICAgICAgICAgICAgIGdldCBzb3J0QXJyb3dDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKGdyaWQsIFwiaGVhZGVyXCIsIFwic29ydEFycm93Q29sb3JcIik7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibWVzc2FnZXNcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLl9ncmlkO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZXNzYWdlcyB8fCAodGhpcy5fbWVzc2FnZXMgPSB7XG4gICAgICAgICAgICAgICAgICBnZXQgaW5mb0JnQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRNZXNzYWdlUHJvcChcImluZm9CZ0NvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGVycm9yQmdDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldE1lc3NhZ2VQcm9wKFwiZXJyb3JCZ0NvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IHdhcm5CZ0NvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0TWVzc2FnZVByb3AoXCJ3YXJuQmdDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBib3hXaWR0aCgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldE1lc3NhZ2VQcm9wKFwiYm94V2lkdGhcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgbWFya0hlaWdodCgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldE1lc3NhZ2VQcm9wKFwibWFya0hlaWdodFwiKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TWVzc2FnZVByb3AocHJvcCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKGdyaWQsIFwibWVzc2FnZXNcIiwgcHJvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJpbmRpY2F0b3JzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBncmlkID0gdGhpcy5fZ3JpZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faW5kaWNhdG9ycyB8fCAodGhpcy5faW5kaWNhdG9ycyA9IHtcbiAgICAgICAgICAgICAgICAgIGdldCB0b3BMZWZ0Q29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRJbmRpY2F0b3JzUHJvcChcInRvcExlZnRDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB0b3BMZWZ0U2l6ZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEluZGljYXRvcnNQcm9wKFwidG9wTGVmdFNpemVcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgdG9wUmlnaHRDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEluZGljYXRvcnNQcm9wKFwidG9wUmlnaHRDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB0b3BSaWdodFNpemUoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRJbmRpY2F0b3JzUHJvcChcInRvcFJpZ2h0U2l6ZVwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBib3R0b21SaWdodENvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SW5kaWNhdG9yc1Byb3AoXCJib3R0b21SaWdodENvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGJvdHRvbVJpZ2h0U2l6ZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEluZGljYXRvcnNQcm9wKFwiYm90dG9tUmlnaHRTaXplXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGJvdHRvbUxlZnRDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEluZGljYXRvcnNQcm9wKFwiYm90dG9tTGVmdENvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGJvdHRvbUxlZnRTaXplKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SW5kaWNhdG9yc1Byb3AoXCJib3R0b21MZWZ0U2l6ZVwiKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0SW5kaWNhdG9yc1Byb3AocHJvcCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRUaGVtZVZhbHVlKGdyaWQsIFwiaW5kaWNhdG9yc1wiLCBwcm9wKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFRoZW1lUmVzb2x2ZXI7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gc3Ryb2tlUmVjdChjdHgsIGNvbG9yLCBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShjb2xvcikpIHtcbiAgICAgICAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gY29sb3I7XG4gICAgICAgICAgICAgICAgY3R4LnN0cm9rZVJlY3QobGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIGJvcmRlckNvbG9ycyA9IF90b0JveEFycmF5KGNvbG9yKTtcblxuICAgICAgICAgICAgICBjYW52YXNoZWxwZXIuc3Ryb2tlQ29sb3JzUmVjdChjdHgsIGJvcmRlckNvbG9ycywgbGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRQYWRkZWRSZWN0KHJlY3QsIHBhZGRpbmcsIGZvbnQsIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgaGVscGVyLCBjb250ZXh0KSB7XG4gICAgICAgICAgICBpZiAoIXBhZGRpbmcpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlY3Q7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBfaGVscGVyJHRvQm94UGl4ZWxBcnIgPSBoZWxwZXIudG9Cb3hQaXhlbEFycmF5KHBhZGRpbmcsIGNvbnRleHQsIGZvbnQpLFxuICAgICAgICAgICAgICAgIHBUb3AgPSBfaGVscGVyJHRvQm94UGl4ZWxBcnJbMF0sXG4gICAgICAgICAgICAgICAgcFJpZ2h0ID0gX2hlbHBlciR0b0JveFBpeGVsQXJyWzFdLFxuICAgICAgICAgICAgICAgIHBCb3R0b20gPSBfaGVscGVyJHRvQm94UGl4ZWxBcnJbMl0sXG4gICAgICAgICAgICAgICAgcExlZnQgPSBfaGVscGVyJHRvQm94UGl4ZWxBcnJbM107XG5cbiAgICAgICAgICAgIHZhciBsZWZ0ID0gcmVjdC5sZWZ0ICsgcExlZnQ7XG4gICAgICAgICAgICB2YXIgdG9wID0gcmVjdC50b3AgKyBwVG9wO1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gcmVjdC53aWR0aCAtIHBSaWdodCAtIHBMZWZ0O1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHJlY3QuaGVpZ2h0IC0gcFRvcCAtIHBCb3R0b207XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlY3RfMS5SZWN0KGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIEdyaWRDYW52YXNIZWxwZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gR3JpZENhbnZhc0hlbHBlcihncmlkKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHcmlkQ2FudmFzSGVscGVyKTtcblxuICAgICAgICAgICAgICB0aGlzLl9ncmlkID0gZ3JpZDtcbiAgICAgICAgICAgICAgdGhpcy5fdGhlbWUgPSBuZXcgVGhlbWVSZXNvbHZlcihncmlkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEdyaWRDYW52YXNIZWxwZXIsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjcmVhdGVDYWxjdWxhdG9yXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVDYWxjdWxhdG9yKGNvbnRleHQsIGZvbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgY2FsY1dpZHRoOiBmdW5jdGlvbiBjYWxjV2lkdGgod2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGMudG9QeCh3aWR0aCwge1xuICAgICAgICAgICAgICAgICAgICAgIGdldCBmdWxsKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBjb250ZXh0LmdldFJlY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWN0LndpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgICAgICBnZXQgZW0oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKDAsIGNhbnZhc2VzXzEuZ2V0Rm9udFNpemUpKGNvbnRleHQuZ2V0Q29udGV4dCgpLCBmb250KS53aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgY2FsY0hlaWdodDogZnVuY3Rpb24gY2FsY0hlaWdodChoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGMudG9QeChoZWlnaHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICBnZXQgZnVsbCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWN0ID0gY29udGV4dC5nZXRSZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVjdC5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICAgIGdldCBlbSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoMCwgY2FudmFzZXNfMS5nZXRGb250U2l6ZSkoY29udGV4dC5nZXRDb250ZXh0KCksIGZvbnQpLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q29sb3JcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbG9yKGNvbG9yLCBjb2wsIHJvdywgY3R4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRTdHlsZVByb3BlcnR5KGNvbG9yLCBjb2wsIHJvdywgdGhpcy5fZ3JpZCwgY3R4KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0U3R5bGVQcm9wZXJ0eVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3R5bGVQcm9wZXJ0eShzdHlsZSwgY29sLCByb3csIGN0eCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0U3R5bGVQcm9wZXJ0eShzdHlsZSwgY29sLCByb3csIHRoaXMuX2dyaWQsIGN0eCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRvQm94QXJyYXlcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvQm94QXJyYXkob2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90b0JveEFycmF5KG9iaik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRvQm94UGl4ZWxBcnJheVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdG9Cb3hQaXhlbEFycmF5KHZhbHVlLCBjb250ZXh0LCBmb250KSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiB8fCBBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0b3IgPSB0aGlzLmNyZWF0ZUNhbGN1bGF0b3IoY29udGV4dCwgZm9udCk7XG5cbiAgICAgICAgICAgICAgICAgIHZhciBib3ggPSBfdG9Cb3hBcnJheSh2YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiBbY2FsY3VsYXRvci5jYWxjSGVpZ2h0KGJveFswXSksIGNhbGN1bGF0b3IuY2FsY1dpZHRoKGJveFsxXSksIGNhbGN1bGF0b3IuY2FsY0hlaWdodChib3hbMl0pLCBjYWxjdWxhdG9yLmNhbGNXaWR0aChib3hbM10pXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX3RvQm94QXJyYXkodmFsdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ0aGVtZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdXaXRoQ2xpcFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd1dpdGhDbGlwKGNvbnRleHQsIGRyYXcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZHJhd1JlY3QgPSBjb250ZXh0LmdldERyYXdSZWN0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRyYXdSZWN0KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNvbnRleHQuZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgY3R4LnJlY3QoZHJhd1JlY3QubGVmdCwgZHJhd1JlY3QudG9wLCBkcmF3UmVjdC53aWR0aCwgZHJhd1JlY3QuaGVpZ2h0KTsgLy9jbGlwXG5cbiAgICAgICAgICAgICAgICAgIGN0eC5jbGlwKCk7XG4gICAgICAgICAgICAgICAgICBkcmF3KGN0eCk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3Qm9yZGVyV2l0aENsaXBcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdCb3JkZXJXaXRoQ2xpcChjb250ZXh0LCBkcmF3KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXdSZWN0ID0gY29udGV4dC5nZXREcmF3UmVjdCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkcmF3UmVjdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZWN0ID0gY29udGV4dC5nZXRSZWN0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNvbnRleHQuZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgLy/nvavnt5rnlKhjbGlwXG4gICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICB2YXIgY2xpcExlZnQgPSBkcmF3UmVjdC5sZWZ0O1xuICAgICAgICAgICAgICAgICAgdmFyIGNsaXBXaWR0aCA9IGRyYXdSZWN0LndpZHRoO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoZHJhd1JlY3QubGVmdCA9PT0gcmVjdC5sZWZ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNsaXBMZWZ0ICs9IC0xO1xuICAgICAgICAgICAgICAgICAgICBjbGlwV2lkdGggKz0gMTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIGNsaXBUb3AgPSBkcmF3UmVjdC50b3A7XG4gICAgICAgICAgICAgICAgICB2YXIgY2xpcEhlaWdodCA9IGRyYXdSZWN0LmhlaWdodDtcblxuICAgICAgICAgICAgICAgICAgaWYgKGRyYXdSZWN0LnRvcCA9PT0gcmVjdC50b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpcFRvcCArPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgY2xpcEhlaWdodCArPSAxO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBjdHgucmVjdChjbGlwTGVmdCwgY2xpcFRvcCwgY2xpcFdpZHRoLCBjbGlwSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgIGN0eC5jbGlwKCk7XG4gICAgICAgICAgICAgICAgICBkcmF3KGN0eCk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0ZXh0KF90ZXh0LCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBfcmVmNSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge30sXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBfcmVmNS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBfcmVmNSRvZmZzZXQgPSBfcmVmNS5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IF9yZWY1JG9mZnNldCA9PT0gdm9pZCAwID8gVEVYVF9PRkZTRVQgOiBfcmVmNSRvZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gX3JlZjUuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIF9yZWY1JHRleHRBbGlnbiA9IF9yZWY1LnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduID0gX3JlZjUkdGV4dEFsaWduID09PSB2b2lkIDAgPyBcImxlZnRcIiA6IF9yZWY1JHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgX3JlZjUkdGV4dEJhc2VsaW5lID0gX3JlZjUudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBfcmVmNSR0ZXh0QmFzZWxpbmUgPT09IHZvaWQgMCA/IFwibWlkZGxlXCIgOiBfcmVmNSR0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQgPSBfcmVmNS5mb250LFxuICAgICAgICAgICAgICAgICAgICBfcmVmNSR0ZXh0T3ZlcmZsb3cgPSBfcmVmNS50ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdyA9IF9yZWY1JHRleHRPdmVyZmxvdyA9PT0gdm9pZCAwID8gXCJjbGlwXCIgOiBfcmVmNSR0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zID0gX3JlZjUuaWNvbnMsXG4gICAgICAgICAgICAgICAgICAgIHRyYWlsaW5nSWNvbiA9IF9yZWY1LnRyYWlsaW5nSWNvbjtcblxuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMudGhlbWUuY29sb3I7XG5cbiAgICAgICAgICAgICAgICAgIC8vIGhlYWRlciBjb2xvclxuICAgICAgICAgICAgICAgICAgdmFyIGlzRnJvemVuQ2VsbCA9IHRoaXMuX2dyaWQuaXNGcm96ZW5DZWxsKGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuQ2VsbCAmJiBpc0Zyb3plbkNlbGwucm93KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy50aGVtZS5mcm96ZW5Sb3dzQ29sb3I7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3V2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgZm9udCA9IGdldEZvbnQoZm9udCwgY29udGV4dC5jb2wsIGNvbnRleHQucm93LCBfdGhpcy5fZ3JpZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgIHZhciByZWN0ID0gZ2V0UGFkZGVkUmVjdChjb250ZXh0LmdldFJlY3QoKSwgcGFkZGluZywgZm9udCwgX3RoaXMsIGNvbnRleHQpO1xuXG4gICAgICAgICAgICAgICAgICBfaW5saW5lUmVjdChfdGhpcy5fZ3JpZCwgY3R4LCBfdGV4dCwgcmVjdCwgY29sLCByb3csIHtcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiB0ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZTogdGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICBmb250OiBmb250LFxuICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3c6IHRleHRPdmVyZmxvdyxcbiAgICAgICAgICAgICAgICAgICAgaWNvbnM6IGljb25zLFxuICAgICAgICAgICAgICAgICAgICB0cmFpbGluZ0ljb246IHRyYWlsaW5nSWNvblxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm11bHRpbGluZVRleHRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG11bHRpbGluZVRleHQobGluZXMsIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBfcmVmNiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge30sXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBfcmVmNi5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBfcmVmNiRvZmZzZXQgPSBfcmVmNi5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IF9yZWY2JG9mZnNldCA9PT0gdm9pZCAwID8gVEVYVF9PRkZTRVQgOiBfcmVmNiRvZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gX3JlZjYuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIF9yZWY2JHRleHRBbGlnbiA9IF9yZWY2LnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduID0gX3JlZjYkdGV4dEFsaWduID09PSB2b2lkIDAgPyBcImxlZnRcIiA6IF9yZWY2JHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgX3JlZjYkdGV4dEJhc2VsaW5lID0gX3JlZjYudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBfcmVmNiR0ZXh0QmFzZWxpbmUgPT09IHZvaWQgMCA/IFwibWlkZGxlXCIgOiBfcmVmNiR0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQgPSBfcmVmNi5mb250LFxuICAgICAgICAgICAgICAgICAgICBfcmVmNiRsaW5lSGVpZ2h0ID0gX3JlZjYubGluZUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodCA9IF9yZWY2JGxpbmVIZWlnaHQgPT09IHZvaWQgMCA/IFwiMWVtXCIgOiBfcmVmNiRsaW5lSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBfcmVmNiRhdXRvV3JhcFRleHQgPSBfcmVmNi5hdXRvV3JhcFRleHQsXG4gICAgICAgICAgICAgICAgICAgIGF1dG9XcmFwVGV4dCA9IF9yZWY2JGF1dG9XcmFwVGV4dCA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmNiRhdXRvV3JhcFRleHQsXG4gICAgICAgICAgICAgICAgICAgIF9yZWY2JGxpbmVDbGFtcCA9IF9yZWY2LmxpbmVDbGFtcCxcbiAgICAgICAgICAgICAgICAgICAgbGluZUNsYW1wID0gX3JlZjYkbGluZUNsYW1wID09PSB2b2lkIDAgPyAwIDogX3JlZjYkbGluZUNsYW1wLFxuICAgICAgICAgICAgICAgICAgICBfcmVmNiR0ZXh0T3ZlcmZsb3cgPSBfcmVmNi50ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdyA9IF9yZWY2JHRleHRPdmVyZmxvdyA9PT0gdm9pZCAwID8gXCJjbGlwXCIgOiBfcmVmNiR0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zID0gX3JlZjYuaWNvbnMsXG4gICAgICAgICAgICAgICAgICAgIHRyYWlsaW5nSWNvbiA9IF9yZWY2LnRyYWlsaW5nSWNvbjtcblxuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMudGhlbWUuY29sb3I7XG5cbiAgICAgICAgICAgICAgICAgIC8vIGhlYWRlciBjb2xvclxuICAgICAgICAgICAgICAgICAgdmFyIGlzRnJvemVuQ2VsbCA9IHRoaXMuX2dyaWQuaXNGcm96ZW5DZWxsKGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuQ2VsbCAmJiBpc0Zyb3plbkNlbGwucm93KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy50aGVtZS5mcm96ZW5Sb3dzQ29sb3I7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3V2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgZm9udCA9IGdldEZvbnQoZm9udCwgY29udGV4dC5jb2wsIGNvbnRleHQucm93LCBfdGhpczIuX2dyaWQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGdldFBhZGRlZFJlY3QoY29udGV4dC5nZXRSZWN0KCksIHBhZGRpbmcsIGZvbnQsIF90aGlzMiwgY29udGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdG9yID0gX3RoaXMyLmNyZWF0ZUNhbGN1bGF0b3IoY29udGV4dCwgZm9udCk7XG5cbiAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQgPSBjYWxjdWxhdG9yLmNhbGNIZWlnaHQobGluZUhlaWdodCk7XG5cbiAgICAgICAgICAgICAgICAgIF9tdWx0aUlubGluZVJlY3QoX3RoaXMyLl9ncmlkLCBjdHgsIGxpbmVzLCByZWN0LCBjb2wsIHJvdywge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6IGxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIGF1dG9XcmFwVGV4dDogYXV0b1dyYXBUZXh0LFxuICAgICAgICAgICAgICAgICAgICBsaW5lQ2xhbXA6IGxpbmVDbGFtcCxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zOiBpY29ucyxcbiAgICAgICAgICAgICAgICAgICAgdHJhaWxpbmdJY29uOiB0cmFpbGluZ0ljb25cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmaWxsVGV4dFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmlsbFRleHQodGV4dCwgeCwgeSwgY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBfcmVmNyA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDoge30sXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gX3JlZjcuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIF9yZWY3JHRleHRBbGlnbiA9IF9yZWY3LnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduID0gX3JlZjckdGV4dEFsaWduID09PSB2b2lkIDAgPyBcImxlZnRcIiA6IF9yZWY3JHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgX3JlZjckdGV4dEJhc2VsaW5lID0gX3JlZjcudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBfcmVmNyR0ZXh0QmFzZWxpbmUgPT09IHZvaWQgMCA/IFwidG9wXCIgOiBfcmVmNyR0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQgPSBfcmVmNy5mb250O1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbnRleHQuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcblxuICAgICAgICAgICAgICAgIGlmICghY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy50aGVtZS5jb2xvcjtcblxuICAgICAgICAgICAgICAgICAgLy8gaGVhZGVyIGNvbG9yXG4gICAgICAgICAgICAgICAgICB2YXIgaXNGcm96ZW5DZWxsID0gdGhpcy5fZ3JpZC5pc0Zyb3plbkNlbGwoY29sLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoaXNGcm96ZW5DZWxsICYmIGlzRnJvemVuQ2VsbC5yb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLnRoZW1lLmZyb3plblJvd3NDb2xvcjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gY29udGV4dC5nZXRDb250ZXh0KCk7XG4gICAgICAgICAgICAgICAgY3R4LnNhdmUoKTtcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICBmb250ID0gZ2V0Rm9udChmb250LCBjb250ZXh0LmNvbCwgY29udGV4dC5yb3csIHRoaXMuX2dyaWQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gX2dldFN0eWxlUHJvcGVydHkoY29sb3IsIGNvbCwgcm93LCB0aGlzLl9ncmlkLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9IHRleHRBbGlnbjtcbiAgICAgICAgICAgICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSB0ZXh0QmFzZWxpbmU7XG4gICAgICAgICAgICAgICAgICBjdHguZm9udCA9IGZvbnQgfHwgY3R4LmZvbnQ7XG4gICAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQodGV4dCwgeCwgeSk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmaWxsQ2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmlsbENlbGwoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9yZWY4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgX3JlZjgkZmlsbENvbG9yID0gX3JlZjguZmlsbENvbG9yLFxuICAgICAgICAgICAgICAgICAgICBmaWxsQ29sb3IgPSBfcmVmOCRmaWxsQ29sb3IgPT09IHZvaWQgMCA/IHRoaXMudGhlbWUuZGVmYXVsdEJnQ29sb3IgOiBfcmVmOCRmaWxsQ29sb3I7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGNvbnRleHQuZ2V0UmVjdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd1dpdGhDbGlwKGNvbnRleHQsIGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcbiAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBfZ2V0U3R5bGVQcm9wZXJ0eShmaWxsQ29sb3IsIGNvbCwgcm93LCBfdGhpczMuX2dyaWQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICBjdHgucmVjdChyZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7XG4gICAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmaWxsQ2VsbFdpdGhTdGF0ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmlsbENlbGxXaXRoU3RhdGUoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuICAgICAgICAgICAgICAgIG9wdGlvbi5maWxsQ29sb3IgPSB0aGlzLmdldEZpbGxDb2xvclN0YXRlKGNvbnRleHQsIG9wdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5maWxsQ2VsbChjb250ZXh0LCBvcHRpb24pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmaWxsUmVjdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmlsbFJlY3QocmVjdCwgY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBfcmVmOSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge30sXG4gICAgICAgICAgICAgICAgICAgIF9yZWY5JGZpbGxDb2xvciA9IF9yZWY5LmZpbGxDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgZmlsbENvbG9yID0gX3JlZjkkZmlsbENvbG9yID09PSB2b2lkIDAgPyB0aGlzLnRoZW1lLmRlZmF1bHRCZ0NvbG9yIDogX3JlZjkkZmlsbENvbG9yO1xuXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNvbnRleHQuZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbnRleHQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IGNvbnRleHQucm93O1xuICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IF9nZXRTdHlsZVByb3BlcnR5KGZpbGxDb2xvciwgY29sLCByb3csIHRoaXMuX2dyaWQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICBjdHgucmVjdChyZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7XG4gICAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZmlsbFJlY3RXaXRoU3RhdGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpbGxSZWN0V2l0aFN0YXRlKHJlY3QsIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcbiAgICAgICAgICAgICAgICBvcHRpb24uZmlsbENvbG9yID0gdGhpcy5nZXRGaWxsQ29sb3JTdGF0ZShjb250ZXh0LCBvcHRpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsbFJlY3QocmVjdCwgY29udGV4dCwgb3B0aW9uKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0RmlsbENvbG9yU3RhdGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpbGxDb2xvclN0YXRlKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgICAgICAgICAgICAgICB2YXIgc2VsID0gY29udGV4dC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IGNvbnRleHQucm93O1xuXG4gICAgICAgICAgICAgICAgaWYgKCEoMCwgdXRpbHNfMS5jZWxsRXF1YWxzKShzZWwuc2VsZWN0LCBjb250ZXh0KSAmJiAoMCwgdXRpbHNfMS5jZWxsSW5SYW5nZSkoc2VsLnJhbmdlLCBjb2wsIHJvdykpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRoZW1lLnNlbGVjdGlvbkJnQ29sb3I7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbi5maWxsQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpb24uZmlsbENvbG9yO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5jZWxsRXF1YWxzKShzZWwuc2VsZWN0LCBjb250ZXh0KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGhlbWUuaGlnaGxpZ2h0QmdDb2xvcjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgaXNGcm96ZW5DZWxsID0gdGhpcy5fZ3JpZC5pc0Zyb3plbkNlbGwoY29sLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuQ2VsbCAmJiBpc0Zyb3plbkNlbGwucm93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50aGVtZS5mcm96ZW5Sb3dzQmdDb2xvcjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50aGVtZS5kZWZhdWx0QmdDb2xvcjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYm9yZGVyXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBib3JkZXIoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9yZWYxMCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge30sXG4gICAgICAgICAgICAgICAgICAgIF9yZWYxMCRib3JkZXJDb2xvciA9IF9yZWYxMC5ib3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSBfcmVmMTAkYm9yZGVyQ29sb3IgPT09IHZvaWQgMCA/IHRoaXMudGhlbWUuYm9yZGVyQ29sb3IgOiBfcmVmMTAkYm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIF9yZWYxMCRsaW5lV2lkdGggPSBfcmVmMTAubGluZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGggPSBfcmVmMTAkbGluZVdpZHRoID09PSB2b2lkIDAgPyAxIDogX3JlZjEwJGxpbmVXaWR0aDtcblxuICAgICAgICAgICAgICAgIHZhciByZWN0ID0gY29udGV4dC5nZXRSZWN0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Qm9yZGVyV2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbnRleHQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IGNvbnRleHQucm93O1xuXG4gICAgICAgICAgICAgICAgICB2YXIgYm9yZGVyQ29sb3JzID0gX2dldFN0eWxlUHJvcGVydHkoYm9yZGVyQ29sb3IsIGNvbCwgcm93LCBfdGhpczQuX2dyaWQsIGN0eCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChsaW5lV2lkdGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZVJlY3QoY3R4LCBib3JkZXJDb2xvcnMsIHJlY3QubGVmdCAtIDAuNSwgcmVjdC50b3AgLSAwLjUsIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZVdpZHRoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAyO1xuICAgICAgICAgICAgICAgICAgICBzdHJva2VSZWN0KGN0eCwgYm9yZGVyQ29sb3JzLCByZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoIC0gMSwgcmVjdC5oZWlnaHQgLSAxKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSBsaW5lV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydE9mZnNldCA9IGxpbmVXaWR0aCAvIDIgLSAxO1xuICAgICAgICAgICAgICAgICAgICBzdHJva2VSZWN0KGN0eCwgYm9yZGVyQ29sb3JzLCByZWN0LmxlZnQgKyBzdGFydE9mZnNldCwgcmVjdC50b3AgKyBzdGFydE9mZnNldCwgcmVjdC53aWR0aCAtIGxpbmVXaWR0aCArIDEsIHJlY3QuaGVpZ2h0IC0gbGluZVdpZHRoICsgMSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gLy8gVW51c2VkIGluIG1haW5cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYm9yZGVyV2l0aFN0YXRlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBib3JkZXJXaXRoU3RhdGUoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG4gICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBjb250ZXh0LmdldFJlY3QoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2VsID0gY29udGV4dC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IGNvbnRleHQucm93OyAvL+e9q+e3mlxuXG4gICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmNlbGxFcXVhbHMpKHNlbC5zZWxlY3QsIGNvbnRleHQpKSB7XG4gICAgICAgICAgICAgICAgICBvcHRpb24uYm9yZGVyQ29sb3IgPSB0aGlzLnRoZW1lLmhpZ2hsaWdodEJvcmRlckNvbG9yO1xuICAgICAgICAgICAgICAgICAgb3B0aW9uLmxpbmVXaWR0aCA9IDI7XG4gICAgICAgICAgICAgICAgICB0aGlzLmJvcmRlcihjb250ZXh0LCBvcHRpb24pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvLyBoZWFkZXIgY29sb3JcbiAgICAgICAgICAgICAgICAgIHZhciBpc0Zyb3plbkNlbGwgPSB0aGlzLl9ncmlkLmlzRnJvemVuQ2VsbChjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChpc0Zyb3plbkNlbGwgPT09IG51bGwgfHwgaXNGcm96ZW5DZWxsID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpc0Zyb3plbkNlbGwucm93KSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbi5ib3JkZXJDb2xvciA9IHRoaXMudGhlbWUuZnJvemVuUm93c0JvcmRlckNvbG9yO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBvcHRpb24ubGluZVdpZHRoID0gMTtcbiAgICAgICAgICAgICAgICAgIHRoaXMuYm9yZGVyKGNvbnRleHQsIG9wdGlvbik7IC8v6L+95Yqg5Yem55CGXG5cbiAgICAgICAgICAgICAgICAgIHZhciBfc2VsID0gdGhpcy5fZ3JpZC5zZWxlY3Rpb24uc2VsZWN0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoX3NlbC5jb2wgKyAxID09PSBjb2wgJiYgX3NlbC5yb3cgPT09IHJvdykge1xuICAgICAgICAgICAgICAgICAgICAvL+WPs+OBjOmBuOaKnuOBleOCjOOBpuOBhOOCi1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYXdCb3JkZXJXaXRoQ2xpcChjb250ZXh0LCBmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIGJvcmRlckNvbG9ycyA9IF90b0JveEFycmF5KF9nZXRTdHlsZVByb3BlcnR5KF90aGlzNS50aGVtZS5oaWdobGlnaHRCb3JkZXJDb2xvciwgX3NlbC5jb2wsIF9zZWwucm93LCBfdGhpczUuX2dyaWQsIGN0eCkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gYm9yZGVyQ29sb3JzWzFdIHx8IGN0eC5zdHJva2VTdHlsZTtcbiAgICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyhyZWN0LmxlZnQgLSAwLjUsIHJlY3QudG9wKTtcbiAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHJlY3QubGVmdCAtIDAuNSwgcmVjdC5ib3R0b20pO1xuICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9zZWwuY29sID09PSBjb2wgJiYgX3NlbC5yb3cgKyAxID09PSByb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgLy/kuIrjgYzpgbjmip7jgZXjgozjgabjgYTjgotcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3Qm9yZGVyV2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBib3JkZXJDb2xvcnMgPSBfdG9Cb3hBcnJheShfZ2V0U3R5bGVQcm9wZXJ0eShfdGhpczUudGhlbWUuaGlnaGxpZ2h0Qm9yZGVyQ29sb3IsIF9zZWwuY29sLCBfc2VsLnJvdywgX3RoaXM1Ll9ncmlkLCBjdHgpKTtcblxuICAgICAgICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxO1xuICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGJvcmRlckNvbG9yc1swXSB8fCBjdHguc3Ryb2tlU3R5bGU7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8ocmVjdC5sZWZ0LCByZWN0LnRvcCAtIDAuNSk7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhyZWN0LnJpZ2h0LCByZWN0LnRvcCAtIDAuNSk7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJ1aWxkQ2hlY2tCb3hJbmxpbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJ1aWxkQ2hlY2tCb3hJbmxpbmUoY2hlY2ssIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXNcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNvbnRleHQuZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgICAgIHZhciBib3hXaWR0aCA9IGNhbnZhc2hlbHBlci5tZWFzdXJlQ2hlY2tib3goY3R4KS53aWR0aDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IElubGluZURyYXdlcl8xLklubGluZURyYXdlcih7XG4gICAgICAgICAgICAgICAgICBkcmF3OiBkcmF3LFxuICAgICAgICAgICAgICAgICAgd2lkdGg6IGJveFdpZHRoICsgMyxcbiAgICAgICAgICAgICAgICAgIGhlaWdodDogYm94V2lkdGggKyAxLFxuICAgICAgICAgICAgICAgICAgY29sb3I6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZHJhdyhfcmVmMTEpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjdHggPSBfcmVmMTEuY3R4LFxuICAgICAgICAgICAgICAgICAgICAgIHJlY3QgPSBfcmVmMTEucmVjdCxcbiAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfcmVmMTEub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICAgIG9mZnNldExlZnQgPSBfcmVmMTEub2Zmc2V0TGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRSaWdodCA9IF9yZWYxMS5vZmZzZXRSaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3AgPSBfcmVmMTEub2Zmc2V0VG9wLFxuICAgICAgICAgICAgICAgICAgICAgIG9mZnNldEJvdHRvbSA9IF9yZWYxMS5vZmZzZXRCb3R0b207XG4gICAgICAgICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2hlY2tib3goY3R4LCByZWN0LCBjb2wsIHJvdywgY2hlY2ssIHNlbGYsIG9wdGlvbiwge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCArIChDSEVDS0JPWF9PRkZTRVQgLSBURVhUX09GRlNFVCksXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXRMZWZ0ICsgKENIRUNLQk9YX09GRlNFVCAtIFRFWFRfT0ZGU0VUKSxcbiAgICAgICAgICAgICAgICAgICAgICByaWdodDogb2Zmc2V0UmlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgdG9wOiBvZmZzZXRUb3AsXG4gICAgICAgICAgICAgICAgICAgICAgYm90dG9tOiBvZmZzZXRCb3R0b21cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjaGVja2JveFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tib3goY2hlY2ssIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBfcmVmMTIgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9LFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nID0gX3JlZjEyLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgIGFuaW1FbGFwc2VkVGltZSA9IF9yZWYxMi5hbmltRWxhcHNlZFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIF9yZWYxMiRvZmZzZXQgPSBfcmVmMTIub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfcmVmMTIkb2Zmc2V0ID09PSB2b2lkIDAgPyBDSEVDS0JPWF9PRkZTRVQgOiBfcmVmMTIkb2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvciA9IF9yZWYxMi51bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yID0gX3JlZjEyLmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSBfcmVmMTIuYm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbiA9IF9yZWYxMi50ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZSA9IF9yZWYxMi50ZXh0QmFzZWxpbmU7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdXaXRoQ2xpcChjb250ZXh0LCBmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2hlY2tib3goY3R4LCBnZXRQYWRkZWRSZWN0KGNvbnRleHQuZ2V0UmVjdCgpLCBwYWRkaW5nLCB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgIC8qIGZvbnQgKi9cbiAgICAgICAgICAgICAgICAgICwgX3RoaXM2LCBjb250ZXh0KSwgY29sLCByb3csIGNoZWNrLCBfdGhpczYsIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbUVsYXBzZWRUaW1lOiBhbmltRWxhcHNlZFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yOiB1bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yOiBjaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBib3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiB0ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZTogdGV4dEJhc2VsaW5lXG4gICAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgbGVmdDogQ0hFQ0tCT1hfT0ZGU0VUIC0gVEVYVF9PRkZTRVRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJhZGlvQnV0dG9uXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByYWRpb0J1dHRvbihjaGVjaywgY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9yZWYxMyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge30sXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBfcmVmMTMucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgYW5pbUVsYXBzZWRUaW1lID0gX3JlZjEzLmFuaW1FbGFwc2VkVGltZSxcbiAgICAgICAgICAgICAgICAgICAgX3JlZjEzJG9mZnNldCA9IF9yZWYxMy5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IF9yZWYxMyRvZmZzZXQgPT09IHZvaWQgMCA/IENIRUNLQk9YX09GRlNFVCA6IF9yZWYxMyRvZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrQ29sb3IgPSBfcmVmMTMuY2hlY2tDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdW5jaGVja0JvcmRlckNvbG9yID0gX3JlZjEzLnVuY2hlY2tCb3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tCb3JkZXJDb2xvciA9IF9yZWYxMy5jaGVja0JvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvciA9IF9yZWYxMy51bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yID0gX3JlZjEzLmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduID0gX3JlZjEzLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lID0gX3JlZjEzLnRleHRCYXNlbGluZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZHJhd1dpdGhDbGlwKGNvbnRleHQsIGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcbiAgICAgICAgICAgICAgICAgIGRyYXdSYWRpb0J1dHRvbihjdHgsIGdldFBhZGRlZFJlY3QoY29udGV4dC5nZXRSZWN0KCksIHBhZGRpbmcsIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgLyogZm9udCAqL1xuICAgICAgICAgICAgICAgICAgLCBfdGhpczcsIGNvbnRleHQpLCBjb2wsIHJvdywgY2hlY2ssIF90aGlzNywge1xuICAgICAgICAgICAgICAgICAgICBhbmltRWxhcHNlZFRpbWU6IGFuaW1FbGFwc2VkVGltZSxcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tDb2xvcjogY2hlY2tDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdW5jaGVja0JvcmRlckNvbG9yOiB1bmNoZWNrQm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrQm9yZGVyQ29sb3I6IGNoZWNrQm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yOiB1bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yOiBjaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogdGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmU6IHRleHRCYXNlbGluZVxuICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzoge1xuICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IENIRUNLQk9YX09GRlNFVCAtIFRFWFRfT0ZGU0VUXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJidXR0b25cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJ1dHRvbihjYXB0aW9uLCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgX3JlZjE0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgX3JlZjE0JGJnQ29sb3IgPSBfcmVmMTQuYmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvciA9IF9yZWYxNCRiZ0NvbG9yID09PSB2b2lkIDAgPyB0aGlzLnRoZW1lLmJ1dHRvbi5iZ0NvbG9yIDogX3JlZjE0JGJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBfcmVmMTQucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgX3JlZjE0JG9mZnNldCA9IF9yZWYxNC5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IF9yZWYxNCRvZmZzZXQgPT09IHZvaWQgMCA/IFRFWFRfT0ZGU0VUIDogX3JlZjE0JG9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgX3JlZjE0JGNvbG9yID0gX3JlZjE0LmNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IF9yZWYxNCRjb2xvciA9PT0gdm9pZCAwID8gdGhpcy50aGVtZS5idXR0b24uY29sb3IgOiBfcmVmMTQkY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIF9yZWYxNCR0ZXh0QWxpZ24gPSBfcmVmMTQudGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ24gPSBfcmVmMTQkdGV4dEFsaWduID09PSB2b2lkIDAgPyBcImNlbnRlclwiIDogX3JlZjE0JHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgX3JlZjE0JHRleHRCYXNlbGluZSA9IF9yZWYxNC50ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZSA9IF9yZWYxNCR0ZXh0QmFzZWxpbmUgPT09IHZvaWQgMCA/IFwibWlkZGxlXCIgOiBfcmVmMTQkdGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICBzaGFkb3cgPSBfcmVmMTQuc2hhZG93LFxuICAgICAgICAgICAgICAgICAgICBmb250ID0gX3JlZjE0LmZvbnQsXG4gICAgICAgICAgICAgICAgICAgIF9yZWYxNCR0ZXh0T3ZlcmZsb3cgPSBfcmVmMTQudGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3cgPSBfcmVmMTQkdGV4dE92ZXJmbG93ID09PSB2b2lkIDAgPyBcImNsaXBcIiA6IF9yZWYxNCR0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zID0gX3JlZjE0Lmljb25zO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBjb250ZXh0LmdldFJlY3QoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdXaXRoQ2xpcChjb250ZXh0LCBmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgICAgICAgICAgICBmb250ID0gZ2V0Rm9udChmb250LCBjb250ZXh0LmNvbCwgY29udGV4dC5yb3csIF90aGlzOC5fZ3JpZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcblxuICAgICAgICAgICAgICAgICAgdmFyIF9nZXRQYWRkZWRSZWN0ID0gZ2V0UGFkZGVkUmVjdChyZWN0LCBwYWRkaW5nIHx8IHJlY3QuaGVpZ2h0IC8gOCwgZm9udCwgX3RoaXM4LCBjb250ZXh0KSxcbiAgICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gX2dldFBhZGRlZFJlY3QubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBfZ2V0UGFkZGVkUmVjdC50b3AsXG4gICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBfZ2V0UGFkZGVkUmVjdC53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBfZ2V0UGFkZGVkUmVjdC5oZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBfZ2V0U3R5bGVQcm9wZXJ0eShiZ0NvbG9yLCBjb250ZXh0LmNvbCwgY29udGV4dC5yb3csIF90aGlzOC5fZ3JpZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgIGNhbnZhc2hlbHBlci5kcmF3QnV0dG9uKGN0eCwgbGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0LCB7XG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IGJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHJhZGl1czogcmVjdC5oZWlnaHQgLyA4LFxuICAgICAgICAgICAgICAgICAgICAvLyBvZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIHNoYWRvdzogc2hhZG93XG4gICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgX2lubGluZVJlY3QoX3RoaXM4Ll9ncmlkLCBjdHgsIGNhcHRpb24sIG5ldyBSZWN0XzEuUmVjdChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpLCBjb2wsIHJvdywge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdzogdGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgICAgICBpY29uczogaWNvbnNcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ0ZXN0Rm9udExvYWRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRlc3RGb250TG9hZChmb250LCB2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGVzdEZvbnRMb2FkKGZvbnQsIHZhbHVlLCBjb250ZXh0LCB0aGlzLl9ncmlkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gR3JpZENhbnZhc0hlbHBlcjtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLkdyaWRDYW52YXNIZWxwZXIgPSBHcmlkQ2FudmFzSGVscGVyO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL0xpc3RHcmlkLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vTGlzdEdyaWQuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBMaXN0R3JpZEpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTGlzdEdyaWQgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgaWNvbnMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC9pY29ucyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9pY29ucy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgdGhlbWVzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdGhlbWVzICovXG4gICAgICAgICAgXCIuL3RoZW1lcy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgZGF0YV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9kYXRhICovXG4gICAgICAgICAgXCIuL2RhdGEuanNcIik7XG5cbiAgICAgICAgICB2YXIgbGF5b3V0X21hcF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9saXN0LWdyaWQvbGF5b3V0LW1hcCAqL1xuICAgICAgICAgIFwiLi9saXN0LWdyaWQvbGF5b3V0LW1hcC9pbmRleC5qc1wiKTtcblxuICAgICAgICAgIHZhciBNZXNzYWdlSGFuZGxlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9jb2x1bW5zL21lc3NhZ2UvTWVzc2FnZUhhbmRsZXIgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9tZXNzYWdlL01lc3NhZ2VIYW5kbGVyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2NvbHVtbnMvc3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBEcmF3R3JpZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9jb3JlL0RyYXdHcmlkICovXG4gICAgICAgICAgXCIuL2NvcmUvRHJhd0dyaWQuanNcIik7XG5cbiAgICAgICAgICB2YXIgR3JpZENhbnZhc0hlbHBlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9HcmlkQ2FudmFzSGVscGVyICovXG4gICAgICAgICAgXCIuL0dyaWRDYW52YXNIZWxwZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgc3R5bGVfMiA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaGVhZGVyL3N0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBMR19FVkVOVF9UWVBFXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2xpc3QtZ3JpZC9MR19FVkVOVF9UWVBFICovXG4gICAgICAgICAgXCIuL2xpc3QtZ3JpZC9MR19FVkVOVF9UWVBFLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFJlY3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaW50ZXJuYWwvUmVjdCAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9SZWN0LmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFRvb2x0aXBIYW5kbGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3Rvb2x0aXAvVG9vbHRpcEhhbmRsZXIgKi9cbiAgICAgICAgICBcIi4vdG9vbHRpcC9Ub29sdGlwSGFuZGxlci5qc1wiKTsgLy9wcm90ZWN0ZWQgc3ltYm9sXG5cblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBwYXN0ZV91dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC9wYXN0ZS11dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9wYXN0ZS11dGlscy5qc1wiKTtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgdmFyIF8gPSAoMCwgc3ltYm9sTWFuYWdlcl8xLmdldFByb3RlY3RlZFN5bWJvbCkoKTsgLy9wcml2YXRlIG1ldGhvZHNcblxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0Q2VsbFJhbmdlKGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICByZXR1cm4gZ3JpZFtfXS5sYXlvdXRNYXAuZ2V0Q2VsbFJhbmdlKGNvbCwgcm93KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF91cGRhdGVSZWN0KGdyaWQsIGNvbCwgcm93LCBjb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0LnNldFJlY3RGaWx0ZXIoZnVuY3Rpb24gKHJlY3QpIHtcbiAgICAgICAgICAgICAgdmFyIGxlZnQgPSByZWN0LmxlZnQsXG4gICAgICAgICAgICAgICAgICByaWdodCA9IHJlY3QucmlnaHQsXG4gICAgICAgICAgICAgICAgICB0b3AgPSByZWN0LnRvcCxcbiAgICAgICAgICAgICAgICAgIGJvdHRvbSA9IHJlY3QuYm90dG9tO1xuXG4gICAgICAgICAgICAgIHZhciBfZ2V0Q2VsbFJhbmdlMiA9IF9nZXRDZWxsUmFuZ2UoZ3JpZCwgY29sLCByb3cpLFxuICAgICAgICAgICAgICAgICAgX2dldENlbGxSYW5nZTIkc3RhcnQgPSBfZ2V0Q2VsbFJhbmdlMi5zdGFydCxcbiAgICAgICAgICAgICAgICAgIHN0YXJ0Q29sID0gX2dldENlbGxSYW5nZTIkc3RhcnQuY29sLFxuICAgICAgICAgICAgICAgICAgc3RhcnRSb3cgPSBfZ2V0Q2VsbFJhbmdlMiRzdGFydC5yb3csXG4gICAgICAgICAgICAgICAgICBfZ2V0Q2VsbFJhbmdlMiRlbmQgPSBfZ2V0Q2VsbFJhbmdlMi5lbmQsXG4gICAgICAgICAgICAgICAgICBlbmRDb2wgPSBfZ2V0Q2VsbFJhbmdlMiRlbmQuY29sLFxuICAgICAgICAgICAgICAgICAgZW5kUm93ID0gX2dldENlbGxSYW5nZTIkZW5kLnJvdztcblxuICAgICAgICAgICAgICBmb3IgKHZhciBjID0gY29sIC0gMTsgYyA+PSBzdGFydENvbDsgYy0tKSB7XG4gICAgICAgICAgICAgICAgbGVmdCAtPSBncmlkLmdldENvbFdpZHRoKGMpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgX2MyID0gY29sICsgMTsgX2MyIDw9IGVuZENvbDsgX2MyKyspIHtcbiAgICAgICAgICAgICAgICByaWdodCArPSBncmlkLmdldENvbFdpZHRoKF9jMik7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBmb3IgKHZhciByID0gcm93IC0gMTsgciA+PSBzdGFydFJvdzsgci0tKSB7XG4gICAgICAgICAgICAgICAgdG9wIC09IGdyaWQuZ2V0Um93SGVpZ2h0KHIpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgX3IgPSByb3cgKyAxOyBfciA8PSBlbmRSb3c7IF9yKyspIHtcbiAgICAgICAgICAgICAgICBib3R0b20gKz0gZ3JpZC5nZXRSb3dIZWlnaHQoX3IpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIFJlY3RfMS5SZWN0LmJvdW5kcyhsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0Q2VsbFZhbHVlKGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICBpZiAocm93IDwgZ3JpZFtfXS5sYXlvdXRNYXAuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgdmFyIF9ncmlkJF8kbGF5b3V0TWFwJGdldCA9IGdyaWRbX10ubGF5b3V0TWFwLmdldEhlYWRlcihjb2wsIHJvdyksXG4gICAgICAgICAgICAgICAgICBjYXB0aW9uID0gX2dyaWQkXyRsYXlvdXRNYXAkZ2V0LmNhcHRpb247XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBjYXB0aW9uID09PSBcImZ1bmN0aW9uXCIgPyBjYXB0aW9uKCkgOiBjYXB0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIF9ncmlkJF8kbGF5b3V0TWFwJGdldDIgPSBncmlkW19dLmxheW91dE1hcC5nZXRCb2R5KGNvbCwgcm93KSxcbiAgICAgICAgICAgICAgICAgIGZpZWxkID0gX2dyaWQkXyRsYXlvdXRNYXAkZ2V0Mi5maWVsZDtcblxuICAgICAgICAgICAgICByZXR1cm4gX2dldEZpZWxkKGdyaWQsIGZpZWxkLCByb3cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX3NldENlbGxWYWx1ZShncmlkLCBjb2wsIHJvdywgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHJvdyA8IGdyaWRbX10ubGF5b3V0TWFwLmhlYWRlclJvd0NvdW50KSB7XG4gICAgICAgICAgICAgIC8vIG5vcFxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgX2dyaWQkXyRsYXlvdXRNYXAkZ2V0MyA9IGdyaWRbX10ubGF5b3V0TWFwLmdldEJvZHkoY29sLCByb3cpLFxuICAgICAgICAgICAgICAgICAgZmllbGQgPSBfZ3JpZCRfJGxheW91dE1hcCRnZXQzLmZpZWxkO1xuXG4gICAgICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIGluZGV4ID0gX2dldFJlY29yZEluZGV4QnlSb3coZ3JpZCwgcm93KTtcblxuICAgICAgICAgICAgICByZXR1cm4gZ3JpZFtfXS5kYXRhU291cmNlLnNldEZpZWxkKGluZGV4LCBmaWVsZCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldENlbGxNZXNzYWdlKGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICBpZiAocm93IDwgZ3JpZFtfXS5sYXlvdXRNYXAuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgX2dyaWQkXyRsYXlvdXRNYXAkZ2V0NCA9IGdyaWRbX10ubGF5b3V0TWFwLmdldEJvZHkoY29sLCByb3cpLFxuICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IF9ncmlkJF8kbGF5b3V0TWFwJGdldDQubWVzc2FnZTtcblxuICAgICAgICAgICAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShtZXNzYWdlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0RmllbGQoZ3JpZCwgbWVzc2FnZSwgcm93KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBtZXNzYWdlLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgIHZhciBtc2cgPSBfZ2V0RmllbGQoZ3JpZCwgbWVzc2FnZVtpbmRleF0sIHJvdyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoKDAsIHV0aWxzXzEuaXNQcm9taXNlKShtc2cpKSB7XG4gICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKG1zZyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoMCwgTWVzc2FnZUhhbmRsZXJfMS5oYXNNZXNzYWdlKShtc2cpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbXNnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICghcHJvbWlzZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHByb21pc2VzLmZvckVhY2goZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgICAgICAgIHAudGhlbihmdW5jdGlvbiAobXNnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoMCwgTWVzc2FnZUhhbmRsZXJfMS5oYXNNZXNzYWdlKShtc2cpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShtc2cpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0Q2VsbEljb24wKGdyaWQsIGljb24sIHJvdykge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaWNvbikpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGljb24ubWFwKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRDZWxsSWNvbjAoZ3JpZCwgaSwgcm93KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdXRpbHNfMS5vYmouaXNPYmplY3QoaWNvbikgfHwgdHlwZW9mIGljb24gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICByZXR1cm4gX2dldEZpZWxkKGdyaWQsIGljb24sIHJvdyk7XG4gICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cblxuICAgICAgICAgICAgdmFyIHJldEljb24gPSB7fTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgdmFyIGljb25PcHQgPSBpY29uO1xuICAgICAgICAgICAgaWNvbnMuaWNvblByb3BLZXlzLmZvckVhY2goZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICAgICAgaWYgKGljb25PcHRba10pIHtcbiAgICAgICAgICAgICAgICB2YXIgZiA9IF9nZXRGaWVsZChncmlkLCBpY29uT3B0W2tdLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGYgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmV0SWNvbltrXSA9IGY7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmICghX2hhc0ZpZWxkKGdyaWQsIGljb25PcHRba10sIHJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0SWNvbltrXSA9IGljb25PcHRba107XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXRJY29uO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldENlbGxJY29uKGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICBpZiAocm93IDwgZ3JpZFtfXS5sYXlvdXRNYXAuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgdmFyIF9ncmlkJF8kbGF5b3V0TWFwJGdldDUgPSBncmlkW19dLmxheW91dE1hcC5nZXRIZWFkZXIoY29sLCByb3cpLFxuICAgICAgICAgICAgICAgICAgaGVhZGVySWNvbiA9IF9ncmlkJF8kbGF5b3V0TWFwJGdldDUuaGVhZGVySWNvbjtcblxuICAgICAgICAgICAgICBpZiAoaGVhZGVySWNvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gaGVhZGVySWNvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBfZ3JpZCRfJGxheW91dE1hcCRnZXQ2ID0gZ3JpZFtfXS5sYXlvdXRNYXAuZ2V0Qm9keShjb2wsIHJvdyksXG4gICAgICAgICAgICAgICAgICBpY29uID0gX2dyaWQkXyRsYXlvdXRNYXAkZ2V0Ni5pY29uO1xuXG4gICAgICAgICAgICAgIGlmIChpY29uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBfZ2V0Q2VsbEljb24wKGdyaWQsIGljb24sIHJvdyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0RmllbGQoZ3JpZCwgZmllbGQsIHJvdykge1xuICAgICAgICAgICAgaWYgKGZpZWxkID09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChyb3cgPCBncmlkW19dLmxheW91dE1hcC5oZWFkZXJSb3dDb3VudCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IF9nZXRSZWNvcmRJbmRleEJ5Um93KGdyaWQsIHJvdyk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGdyaWRbX10uZGF0YVNvdXJjZS5nZXRGaWVsZChpbmRleCwgZmllbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2hhc0ZpZWxkKGdyaWQsIGZpZWxkLCByb3cpIHtcbiAgICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHJvdyA8IGdyaWRbX10ubGF5b3V0TWFwLmhlYWRlclJvd0NvdW50KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IF9nZXRSZWNvcmRJbmRleEJ5Um93KGdyaWQsIHJvdyk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGdyaWRbX10uZGF0YVNvdXJjZS5oYXNGaWVsZChpbmRleCwgZmllbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX29uRHJhd1ZhbHVlKGdyaWQsIGNlbGxWYWx1ZSwgY29udGV4dCwgX3JlZjE1LCBzdHlsZSwgZHJhdykge1xuICAgICAgICAgICAgdmFyIGNvbCA9IF9yZWYxNS5jb2wsXG4gICAgICAgICAgICAgICAgcm93ID0gX3JlZjE1LnJvdztcbiAgICAgICAgICAgIHZhciBoZWxwZXIgPSBncmlkW19dLmdyaWRDYW52YXNIZWxwZXI7XG5cbiAgICAgICAgICAgIHZhciBkcmF3Q2VsbEJnID0gZnVuY3Rpb24gZHJhd0NlbGxCZygpIHtcbiAgICAgICAgICAgICAgdmFyIF9yZWYxNiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge30sXG4gICAgICAgICAgICAgICAgICBiZ0NvbG9yID0gX3JlZjE2LmJnQ29sb3I7XG5cbiAgICAgICAgICAgICAgdmFyIGZpbGxPcHQgPSB7XG4gICAgICAgICAgICAgICAgZmlsbENvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgIH07IC8vY2VsbOWFqOS9k+OCkuaPj+eUu1xuXG4gICAgICAgICAgICAgIGhlbHBlci5maWxsQ2VsbFdpdGhTdGF0ZShjb250ZXh0LCBmaWxsT3B0KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBkcmF3Q2VsbEJvcmRlciA9IGZ1bmN0aW9uIGRyYXdDZWxsQm9yZGVyKCkge1xuICAgICAgICAgICAgICBpZiAoY29udGV4dC5jb2wgPT09IGdyaWQuZnJvemVuQ29sQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgLy/lm7rlrprliJfnvavnt5pcbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGNvbnRleHQuZ2V0UmVjdCgpO1xuICAgICAgICAgICAgICAgIGhlbHBlci5kcmF3V2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGJvcmRlckNvbG9yID0gY29udGV4dC5yb3cgPj0gZ3JpZC5mcm96ZW5Sb3dDb3VudCA/IGhlbHBlci50aGVtZS5ib3JkZXJDb2xvciA6IGhlbHBlci50aGVtZS5mcm96ZW5Sb3dzQm9yZGVyQ29sb3I7XG4gICAgICAgICAgICAgICAgICB2YXIgYm9yZGVyQ29sb3JzID0gaGVscGVyLnRvQm94QXJyYXkoaGVscGVyLmdldENvbG9yKGJvcmRlckNvbG9yLCBjb250ZXh0LmNvbCwgY29udGV4dC5yb3csIGN0eCkpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoYm9yZGVyQ29sb3JzWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxO1xuICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBib3JkZXJDb2xvcnNbMV07XG4gICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyhyZWN0LnJpZ2h0IC0gMi41LCByZWN0LnRvcCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ocmVjdC5yaWdodCAtIDIuNSwgcmVjdC5ib3R0b20pO1xuICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBfYm9yZGVyV2l0aFN0YXRlKGdyaWQsIGhlbHBlciwgY29udGV4dCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgZHJhd0NlbGxCYXNlID0gZnVuY3Rpb24gZHJhd0NlbGxCYXNlKCkge1xuICAgICAgICAgICAgICB2YXIgX3JlZjE3ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fSxcbiAgICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBfcmVmMTcuYmdDb2xvcjtcblxuICAgICAgICAgICAgICBkcmF3Q2VsbEJnKHtcbiAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBkcmF3Q2VsbEJvcmRlcigpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgICAgICAgIGdldFJlY29yZDogZnVuY3Rpb24gZ2V0UmVjb3JkKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBncmlkLmdldFJvd1JlY29yZChyb3cpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBnZXRJY29uOiBmdW5jdGlvbiBnZXRJY29uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0Q2VsbEljb24oZ3JpZCwgY29sLCByb3cpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBnZXRNZXNzYWdlOiBmdW5jdGlvbiBnZXRNZXNzYWdlKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0Q2VsbE1lc3NhZ2UoZ3JpZCwgY29sLCByb3cpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBtZXNzYWdlSGFuZGxlcjogZ3JpZFtfXS5tZXNzYWdlSGFuZGxlcixcbiAgICAgICAgICAgICAgc3R5bGU6IHN0eWxlLFxuICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2U6IGRyYXdDZWxsQmFzZSxcbiAgICAgICAgICAgICAgZHJhd0NlbGxCZzogZHJhd0NlbGxCZyxcbiAgICAgICAgICAgICAgZHJhd0NlbGxCb3JkZXI6IGRyYXdDZWxsQm9yZGVyXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGRyYXcoY2VsbFZhbHVlLCBpbmZvLCBjb250ZXh0LCBncmlkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9ib3JkZXJXaXRoU3RhdGUoZ3JpZCwgaGVscGVyLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICB2YXIgc2VsID0gZ3JpZC5zZWxlY3Rpb24uc2VsZWN0O1xuICAgICAgICAgICAgdmFyIGxheW91dE1hcCA9IGdyaWRbX10ubGF5b3V0TWFwO1xuICAgICAgICAgICAgdmFyIHJlY3QgPSBjb250ZXh0LmdldFJlY3QoKTtcbiAgICAgICAgICAgIHZhciBvcHRpb24gPSB7fTtcbiAgICAgICAgICAgIHZhciBzZWxSZWNvcmRJbmRleCA9IGxheW91dE1hcC5nZXRSZWNvcmRJbmRleEJ5Um93KHNlbC5yb3cpO1xuICAgICAgICAgICAgdmFyIHNlbElkID0gbGF5b3V0TWFwLmdldENlbGxJZChzZWwuY29sLCBzZWwucm93KTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gaXNTZWxlY3RDZWxsKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgIGlmIChjb2wgPT09IHNlbC5jb2wgJiYgcm93ID09PSBzZWwucm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gc2VsSWQgIT0gbnVsbCAmJiBsYXlvdXRNYXAuZ2V0Q2VsbElkKGNvbCwgcm93KSA9PT0gc2VsSWQgJiYgbGF5b3V0TWFwLmdldFJlY29yZEluZGV4QnlSb3cocm93KSA9PT0gc2VsUmVjb3JkSW5kZXg7XG4gICAgICAgICAgICB9IC8v572r57eaXG5cblxuICAgICAgICAgICAgaWYgKGlzU2VsZWN0Q2VsbChjb2wsIHJvdykpIHtcbiAgICAgICAgICAgICAgb3B0aW9uLmJvcmRlckNvbG9yID0gaGVscGVyLnRoZW1lLmhpZ2hsaWdodEJvcmRlckNvbG9yO1xuICAgICAgICAgICAgICBvcHRpb24ubGluZVdpZHRoID0gMjtcbiAgICAgICAgICAgICAgaGVscGVyLmJvcmRlcihjb250ZXh0LCBvcHRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgb3B0aW9uLmxpbmVXaWR0aCA9IDE7IC8vIGhlYWRlciBjb2xvclxuXG4gICAgICAgICAgICAgIHZhciBpc0Zyb3plbkNlbGwgPSBncmlkLmlzRnJvemVuQ2VsbChjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgaWYgKGlzRnJvemVuQ2VsbCA9PT0gbnVsbCB8fCBpc0Zyb3plbkNlbGwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGlzRnJvemVuQ2VsbC5yb3cpIHtcbiAgICAgICAgICAgICAgICBvcHRpb24uYm9yZGVyQ29sb3IgPSBoZWxwZXIudGhlbWUuZnJvemVuUm93c0JvcmRlckNvbG9yO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaGVscGVyLmJvcmRlcihjb250ZXh0LCBvcHRpb24pOyAvL+i/veWKoOWHpueQhlxuXG4gICAgICAgICAgICAgIGlmIChjb2wgPiAwICYmIGlzU2VsZWN0Q2VsbChjb2wgLSAxLCByb3cpKSB7XG4gICAgICAgICAgICAgICAgLy/lj7PjgYzpgbjmip7jgZXjgozjgabjgYTjgotcbiAgICAgICAgICAgICAgICBoZWxwZXIuZHJhd0JvcmRlcldpdGhDbGlwKGNvbnRleHQsIGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBib3JkZXJDb2xvcnMgPSBoZWxwZXIudG9Cb3hBcnJheShoZWxwZXIuZ2V0Q29sb3IoaGVscGVyLnRoZW1lLmhpZ2hsaWdodEJvcmRlckNvbG9yLCBzZWwuY29sLCBzZWwucm93LCBjdHgpKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGJvcmRlckNvbG9yc1sxXSkge1xuICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gYm9yZGVyQ29sb3JzWzFdO1xuICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8ocmVjdC5sZWZ0IC0gMC41LCByZWN0LnRvcCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ocmVjdC5sZWZ0IC0gMC41LCByZWN0LmJvdHRvbSk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyb3cgPiAwICYmIGlzU2VsZWN0Q2VsbChjb2wsIHJvdyAtIDEpKSB7XG4gICAgICAgICAgICAgICAgLy/kuIrjgYzpgbjmip7jgZXjgozjgabjgYTjgotcbiAgICAgICAgICAgICAgICBoZWxwZXIuZHJhd0JvcmRlcldpdGhDbGlwKGNvbnRleHQsIGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBib3JkZXJDb2xvcnMgPSBoZWxwZXIudG9Cb3hBcnJheShoZWxwZXIuZ2V0Q29sb3IoaGVscGVyLnRoZW1lLmhpZ2hsaWdodEJvcmRlckNvbG9yLCBzZWwuY29sLCBzZWwucm93LCBjdHgpKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGJvcmRlckNvbG9yc1swXSkge1xuICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gYm9yZGVyQ29sb3JzWzBdO1xuICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8ocmVjdC5sZWZ0LCByZWN0LnRvcCAtIDAuNSk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ocmVjdC5yaWdodCwgcmVjdC50b3AgLSAwLjUpO1xuICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9yZWZyZXNoSGVhZGVyKGdyaWQpIHtcbiAgICAgICAgICAgIHZhciBfYjtcblxuICAgICAgICAgICAgdmFyIHByb3RlY3RlZFNwYWNlID0gZ3JpZFtfXTtcblxuICAgICAgICAgICAgaWYgKHByb3RlY3RlZFNwYWNlLmhlYWRlckV2ZW50cykge1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5oZWFkZXJFdmVudHMuZm9yRWFjaChmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ3JpZC51bmxpc3RlbihpZCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaGVhZGVyRXZlbnRzID0gZ3JpZFtfXS5oZWFkZXJFdmVudHMgPSBbXTtcbiAgICAgICAgICAgIGhlYWRlckV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgICByZXR1cm4gZ3JpZC51bmxpc3RlbihpZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBsYXlvdXRNYXA7XG5cbiAgICAgICAgICAgIGlmIChwcm90ZWN0ZWRTcGFjZS5sYXlvdXQgJiYgKCFBcnJheS5pc0FycmF5KHByb3RlY3RlZFNwYWNlLmxheW91dCkgfHwgcHJvdGVjdGVkU3BhY2UubGF5b3V0Lmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICAgIGxheW91dE1hcCA9IHByb3RlY3RlZFNwYWNlLmxheW91dE1hcCA9IG5ldyBsYXlvdXRfbWFwXzEuTXVsdGlMYXlvdXRNYXAocHJvdGVjdGVkU3BhY2UubGF5b3V0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGxheW91dE1hcCA9IHByb3RlY3RlZFNwYWNlLmxheW91dE1hcCA9IG5ldyBsYXlvdXRfbWFwXzEuU2ltcGxlSGVhZGVyTGF5b3V0TWFwKChfYiA9IHByb3RlY3RlZFNwYWNlLmhlYWRlcikgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogW10pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsYXlvdXRNYXAuaGVhZGVyT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgICAgICAgIHZhciBpZHMgPSBjZWxsLmhlYWRlclR5cGUuYmluZEdyaWRFdmVudChncmlkLCBjZWxsLmlkKTtcbiAgICAgICAgICAgICAgaGVhZGVyRXZlbnRzLnB1c2guYXBwbHkoaGVhZGVyRXZlbnRzLCBfdG9Db25zdW1hYmxlQXJyYXkoaWRzKSk7XG5cbiAgICAgICAgICAgICAgaWYgKGNlbGwuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2VsbC5zdHlsZSBpbnN0YW5jZW9mIHN0eWxlXzIuQmFzZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgaWQgPSBjZWxsLnN0eWxlLmxpc3RlbihzdHlsZV8yLkJhc2VTdHlsZS5FVkVOVF9UWVBFLkNIQU5HRV9TVFlMRSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGUoKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgaGVhZGVyRXZlbnRzLnB1c2goaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChjZWxsLmFjdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBfaWRzID0gY2VsbC5hY3Rpb24uYmluZEdyaWRFdmVudChncmlkLCBjZWxsLmlkKTtcblxuICAgICAgICAgICAgICAgIGhlYWRlckV2ZW50cy5wdXNoLmFwcGx5KGhlYWRlckV2ZW50cywgX3RvQ29uc3VtYWJsZUFycmF5KF9pZHMpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsYXlvdXRNYXAuY29sdW1uT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgICAgICAgaWYgKGNvbC5hY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgaWRzID0gY29sLmFjdGlvbi5iaW5kR3JpZEV2ZW50KGdyaWQsIGNvbC5pZCk7XG4gICAgICAgICAgICAgICAgaGVhZGVyRXZlbnRzLnB1c2guYXBwbHkoaGVhZGVyRXZlbnRzLCBfdG9Db25zdW1hYmxlQXJyYXkoaWRzKSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoY29sLmNvbHVtblR5cGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2lkczIgPSBjb2wuY29sdW1uVHlwZS5iaW5kR3JpZEV2ZW50KGdyaWQsIGNvbC5pZCk7XG5cbiAgICAgICAgICAgICAgICBoZWFkZXJFdmVudHMucHVzaC5hcHBseShoZWFkZXJFdmVudHMsIF90b0NvbnN1bWFibGVBcnJheShfaWRzMikpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGNvbC5zdHlsZSkge1xuICAgICAgICAgICAgICAgIGlmIChjb2wuc3R5bGUgaW5zdGFuY2VvZiBzdHlsZV8xLkJhc2VTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGlkID0gY29sLnN0eWxlLmxpc3RlbihzdHlsZV8xLkJhc2VTdHlsZS5FVkVOVF9UWVBFLkNIQU5HRV9TVFlMRSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGUoKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgaGVhZGVyRXZlbnRzLnB1c2goaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IGxheW91dE1hcC5jb2x1bW5XaWR0aHMubGVuZ3RoOyBjb2wrKykge1xuICAgICAgICAgICAgICB2YXIgY29sdW1uID0gbGF5b3V0TWFwLmNvbHVtbldpZHRoc1tjb2xdO1xuICAgICAgICAgICAgICB2YXIgd2lkdGggPSBjb2x1bW4ud2lkdGgsXG4gICAgICAgICAgICAgICAgICBtaW5XaWR0aCA9IGNvbHVtbi5taW5XaWR0aCxcbiAgICAgICAgICAgICAgICAgIG1heFdpZHRoID0gY29sdW1uLm1heFdpZHRoO1xuXG4gICAgICAgICAgICAgIGlmICh3aWR0aCAmJiAodHlwZW9mIHdpZHRoID09PSBcInN0cmluZ1wiIHx8IHdpZHRoID4gMCkpIHtcbiAgICAgICAgICAgICAgICBncmlkLnNldENvbFdpZHRoKGNvbCwgd2lkdGgpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyaWQuc2V0Q29sV2lkdGgoY29sLCBudWxsKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChtaW5XaWR0aCAmJiAodHlwZW9mIG1pbldpZHRoID09PSBcInN0cmluZ1wiIHx8IG1pbldpZHRoID4gMCkpIHtcbiAgICAgICAgICAgICAgICBncmlkLnNldE1pbkNvbFdpZHRoKGNvbCwgbWluV2lkdGgpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyaWQuc2V0TWluQ29sV2lkdGgoY29sLCBudWxsKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChtYXhXaWR0aCAmJiAodHlwZW9mIG1heFdpZHRoID09PSBcInN0cmluZ1wiIHx8IG1heFdpZHRoID4gMCkpIHtcbiAgICAgICAgICAgICAgICBncmlkLnNldE1heENvbFdpZHRoKGNvbCwgbWF4V2lkdGgpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyaWQuc2V0TWF4Q29sV2lkdGgoY29sLCBudWxsKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaGVhZGVyUm93SGVpZ2h0ID0gZ3JpZFtfXS5oZWFkZXJSb3dIZWlnaHQ7XG5cbiAgICAgICAgICAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IGxheW91dE1hcC5oZWFkZXJSb3dDb3VudDsgcm93KyspIHtcbiAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IEFycmF5LmlzQXJyYXkoaGVhZGVyUm93SGVpZ2h0KSA/IGhlYWRlclJvd0hlaWdodFtyb3ddIDogaGVhZGVyUm93SGVpZ2h0O1xuXG4gICAgICAgICAgICAgIGlmIChoZWlnaHQgJiYgaGVpZ2h0ID4gMCkge1xuICAgICAgICAgICAgICAgIGdyaWQuc2V0Um93SGVpZ2h0KHJvdywgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBncmlkLnNldFJvd0hlaWdodChyb3csIG51bGwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdyaWQuY29sQ291bnQgPSBsYXlvdXRNYXAuY29sQ291bnQ7XG5cbiAgICAgICAgICAgIF9yZWZyZXNoUm93Q291bnQoZ3JpZCk7XG5cbiAgICAgICAgICAgIGdyaWQuZnJvemVuUm93Q291bnQgPSBsYXlvdXRNYXAuaGVhZGVyUm93Q291bnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfcmVmcmVzaFJvd0NvdW50KGdyaWQpIHtcbiAgICAgICAgICAgIHZhciBsYXlvdXRNYXAgPSBncmlkW19dLmxheW91dE1hcDtcbiAgICAgICAgICAgIGdyaWQucm93Q291bnQgPSBncmlkW19dLmRhdGFTb3VyY2UubGVuZ3RoICogbGF5b3V0TWFwLmJvZHlSb3dDb3VudCArIGxheW91dE1hcC5oZWFkZXJSb3dDb3VudDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF90cnlXaXRoVXBkYXRlRGF0YVNvdXJjZShncmlkLCBmbikge1xuICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2VFdmVudElkcyA9IGdyaWRbX10uZGF0YVNvdXJjZUV2ZW50SWRzO1xuXG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZUV2ZW50SWRzKSB7XG4gICAgICAgICAgICAgIGRhdGFTb3VyY2VFdmVudElkcy5mb3JFYWNoKGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBncmlkW19dLmhhbmRsZXIub2ZmKGlkKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZuKGdyaWQpO1xuICAgICAgICAgICAgZ3JpZFtfXS5kYXRhU291cmNlRXZlbnRJZHMgPSBbZ3JpZFtfXS5oYW5kbGVyLm9uKGdyaWRbX10uZGF0YVNvdXJjZSwgZGF0YV8xLkRhdGFTb3VyY2UuRVZFTlRfVFlQRS5VUERBVEVEX0xFTkdUSCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBfcmVmcmVzaFJvd0NvdW50KGdyaWQpO1xuXG4gICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZSgpO1xuICAgICAgICAgICAgfSksIGdyaWRbX10uaGFuZGxlci5vbihncmlkW19dLmRhdGFTb3VyY2UsIGRhdGFfMS5EYXRhU291cmNlLkVWRU5UX1RZUEUuVVBEQVRFRF9PUkRFUiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGUoKTtcbiAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9zZXRSZWNvcmRzKGdyaWQpIHtcbiAgICAgICAgICAgIHZhciByZWNvcmRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTtcblxuICAgICAgICAgICAgX3RyeVdpdGhVcGRhdGVEYXRhU291cmNlKGdyaWQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZ3JpZFtfXS5yZWNvcmRzID0gcmVjb3JkcztcbiAgICAgICAgICAgICAgdmFyIG5ld0RhdGFTb3VyY2UgPSBncmlkW19dLmRhdGFTb3VyY2UgPSBkYXRhXzEuQ2FjaGVkRGF0YVNvdXJjZS5vZkFycmF5KHJlY29yZHMpO1xuICAgICAgICAgICAgICBncmlkLmFkZERpc3Bvc2FibGUobmV3RGF0YVNvdXJjZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9zZXREYXRhU291cmNlKGdyaWQsIGRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgIF90cnlXaXRoVXBkYXRlRGF0YVNvdXJjZShncmlkLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGlmIChkYXRhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2UgaW5zdGFuY2VvZiBkYXRhXzEuRGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgZ3JpZFtfXS5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdmFyIG5ld0RhdGFTb3VyY2UgPSBncmlkW19dLmRhdGFTb3VyY2UgPSBuZXcgZGF0YV8xLkNhY2hlZERhdGFTb3VyY2UoZGF0YVNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICBncmlkLmFkZERpc3Bvc2FibGUobmV3RGF0YVNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyaWRbX10uZGF0YVNvdXJjZSA9IGRhdGFfMS5EYXRhU291cmNlLkVNUFRZO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZ3JpZFtfXS5yZWNvcmRzID0gbnVsbDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldFJlY29yZEluZGV4QnlSb3coZ3JpZCwgcm93KSB7XG4gICAgICAgICAgICB2YXIgbGF5b3V0TWFwID0gZ3JpZFtfXS5sYXlvdXRNYXA7XG4gICAgICAgICAgICByZXR1cm4gbGF5b3V0TWFwLmdldFJlY29yZEluZGV4QnlSb3cocm93KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9vblJhbmdlUGFzdGUodGV4dCkge1xuICAgICAgICAgICAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciB0ZXN0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIF9iO1xuXG4gICAgICAgICAgICB2YXIgbGF5b3V0TWFwID0gdGhpc1tfXS5sYXlvdXRNYXA7XG4gICAgICAgICAgICB2YXIgc2VsZWN0aW9uUmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5yYW5nZTtcblxuICAgICAgICAgICAgdmFyIF90aGlzJGdldENlbGxSYW5nZSA9IHRoaXMuZ2V0Q2VsbFJhbmdlKHNlbGVjdGlvblJhbmdlLnN0YXJ0LmNvbCwgc2VsZWN0aW9uUmFuZ2Uuc3RhcnQucm93KSxcbiAgICAgICAgICAgICAgICBzdGFydCA9IF90aGlzJGdldENlbGxSYW5nZS5zdGFydDtcblxuICAgICAgICAgICAgdmFyIF90aGlzJGdldENlbGxSYW5nZTIgPSB0aGlzLmdldENlbGxSYW5nZShzZWxlY3Rpb25SYW5nZS5lbmQuY29sLCBzZWxlY3Rpb25SYW5nZS5lbmQucm93KSxcbiAgICAgICAgICAgICAgICBlbmQgPSBfdGhpcyRnZXRDZWxsUmFuZ2UyLmVuZDtcblxuICAgICAgICAgICAgdmFyIHZhbHVlcyA9ICgwLCBwYXN0ZV91dGlsc18xLnBhcnNlUGFzdGVSYW5nZUJveFZhbHVlcykodGV4dCwge1xuICAgICAgICAgICAgICB0cmltT25QYXN0ZTogdGhpcy50cmltT25QYXN0ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgcGFzdGVSb3dDb3VudCA9IE1hdGgubWluKE1hdGgubWF4KGVuZC5yb3cgLSBzdGFydC5yb3cgKyAxLCB2YWx1ZXMucm93Q291bnQpLCB0aGlzLnJvd0NvdW50IC0gc3RhcnQucm93KTtcbiAgICAgICAgICAgIHZhciBwYXN0ZUNvbENvdW50ID0gTWF0aC5taW4oTWF0aC5tYXgoZW5kLmNvbCAtIHN0YXJ0LmNvbCArIDEsIHZhbHVlcy5jb2xDb3VudCksIHRoaXMuY29sQ291bnQgLSBzdGFydC5jb2wpO1xuICAgICAgICAgICAgdmFyIGhhc0VkaXRhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgYWN0aW9uQ29sdW1uc0JveCA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBib2R5Um93ID0gMDsgYm9keVJvdyA8IGxheW91dE1hcC5ib2R5Um93Q291bnQ7IGJvZHlSb3crKykge1xuICAgICAgICAgICAgICB2YXIgYWN0aW9uQ29sdW1uc1JvdyA9IFtdO1xuICAgICAgICAgICAgICBhY3Rpb25Db2x1bW5zQm94LnB1c2goYWN0aW9uQ29sdW1uc1Jvdyk7XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0Q29sID0gMDsgb2Zmc2V0Q29sIDwgcGFzdGVDb2xDb3VudDsgb2Zmc2V0Q29sKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keSA9IGxheW91dE1hcC5nZXRCb2R5KHN0YXJ0LmNvbCArIG9mZnNldENvbCwgYm9keVJvdyArIGxheW91dE1hcC5oZWFkZXJSb3dDb3VudCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uQ29sdW1uc1Jvd1tvZmZzZXRDb2xdID0gYm9keTtcblxuICAgICAgICAgICAgICAgIGlmICghaGFzRWRpdGFibGUgJiYgKChfYiA9IGJvZHkuYWN0aW9uKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZWRpdGFibGUpKSB7XG4gICAgICAgICAgICAgICAgICBoYXNFZGl0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghaGFzRWRpdGFibGUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3RhcnRSb3cgPSBsYXlvdXRNYXAuZ2V0UmVjb3JkU3RhcnRSb3dCeVJlY29yZEluZGV4KGxheW91dE1hcC5nZXRSZWNvcmRJbmRleEJ5Um93KHN0YXJ0LnJvdykpO1xuICAgICAgICAgICAgdmFyIHN0YXJ0Um93T2Zmc2V0ID0gc3RhcnQucm93IC0gc3RhcnRSb3c7XG4gICAgICAgICAgICB2YXIgcmVqZWN0ZWREZXRhaWwgPSBbXTtcblxuICAgICAgICAgICAgdmFyIGFkZFJlamVjdGVkRGV0YWlsID0gZnVuY3Rpb24gYWRkUmVqZWN0ZWREZXRhaWwoY2VsbCwgcmVjb3JkLCBkZWZpbmUsIHBhc3RlVmFsdWUpIHtcbiAgICAgICAgICAgICAgcmVqZWN0ZWREZXRhaWwucHVzaCh7XG4gICAgICAgICAgICAgICAgY29sOiBjZWxsLmNvbCxcbiAgICAgICAgICAgICAgICByb3c6IGNlbGwucm93LFxuICAgICAgICAgICAgICAgIHJlY29yZDogcmVjb3JkLFxuICAgICAgICAgICAgICAgIGRlZmluZTogZGVmaW5lLFxuICAgICAgICAgICAgICAgIHBhc3RlVmFsdWU6IHBhc3RlVmFsdWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgdGltZW91dCA9IG51bGw7XG5cbiAgICAgICAgICAgIHZhciBwcm9jZXNzUmVqZWN0ZWQgPSBmdW5jdGlvbiBwcm9jZXNzUmVqZWN0ZWQoKSB7XG4gICAgICAgICAgICAgIGlmICh0aW1lb3V0KSBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVqZWN0ZWREZXRhaWwubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgX3RoaXM5LmZpcmVMaXN0ZW5lcnMoTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuUkVKRUNURURfUEFTVEVfVkFMVUVTLCB7XG4gICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVqZWN0ZWREZXRhaWxcbiAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICByZWplY3RlZERldGFpbCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBfcmVqZWN0ID0gYWRkUmVqZWN0ZWREZXRhaWw7XG4gICAgICAgICAgICB2YXIgZHVwbGljYXRlID0ge307XG4gICAgICAgICAgICB2YXIgYWN0aW9uUm93ID0gc3RhcnRSb3dPZmZzZXQ7XG4gICAgICAgICAgICB2YXIgdmFsdWVzUm93ID0gMDtcblxuICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0Um93ID0gMDsgb2Zmc2V0Um93IDwgcGFzdGVSb3dDb3VudDsgb2Zmc2V0Um93KyspIHtcbiAgICAgICAgICAgICAgdmFyIHZhbHVlc0NvbCA9IDA7XG5cbiAgICAgICAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoX29mZnNldENvbCkge1xuICAgICAgICAgICAgICAgIHZhciBfYWN0aW9uQ29sdW1uc0JveCRhY3QgPSBhY3Rpb25Db2x1bW5zQm94W2FjdGlvblJvd11bX29mZnNldENvbF0sXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbiA9IF9hY3Rpb25Db2x1bW5zQm94JGFjdC5hY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGlkID0gX2FjdGlvbkNvbHVtbnNCb3gkYWN0LmlkLFxuICAgICAgICAgICAgICAgICAgICBkZWZpbmUgPSBfYWN0aW9uQ29sdW1uc0JveCRhY3QuZGVmaW5lO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkdXBsaWNhdGVbaWRdICYmIChhY3Rpb24gPT09IG51bGwgfHwgYWN0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhY3Rpb24uZWRpdGFibGUpKSB7XG4gICAgICAgICAgICAgICAgICBkdXBsaWNhdGVbaWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBzdGFydC5jb2wgKyBfb2Zmc2V0Q29sO1xuICAgICAgICAgICAgICAgICAgdmFyIHJvdyA9IHN0YXJ0LnJvdyArIG9mZnNldFJvdztcbiAgICAgICAgICAgICAgICAgIHZhciBjZWxsVmFsdWUgPSB2YWx1ZXMuZ2V0Q2VsbFZhbHVlKHZhbHVlc0NvbCwgdmFsdWVzUm93KTtcbiAgICAgICAgICAgICAgICAgICgwLCB1dGlsc18xLnRoZW4pKF90aGlzOS5nZXRSb3dSZWNvcmQocm93KSwgZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICAgICAgICAgICAgICAoMCwgdXRpbHNfMS50aGVuKShfZ2V0Q2VsbFZhbHVlKF90aGlzOSwgY29sLCByb3cpLCBmdW5jdGlvbiAob2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAodGVzdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBncmlkOiBfdGhpczksXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNvcmQ6IHJlY29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgcm93OiByb3csXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY2VsbFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkVmFsdWU6IG9sZFZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5vblBhc3RlQ2VsbFJhbmdlQm94KF90aGlzOSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGNlbGxWYWx1ZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVqZWN0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCByZWNvcmQsIGRlZmluZSwgY2VsbFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhbHVlc0NvbCsrO1xuXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc0NvbCA+PSB2YWx1ZXMuY29sQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlc0NvbCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIF9vZmZzZXRDb2wgPSAwOyBfb2Zmc2V0Q29sIDwgcGFzdGVDb2xDb3VudDsgX29mZnNldENvbCsrKSB7XG4gICAgICAgICAgICAgICAgX2xvb3AoX29mZnNldENvbCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBhY3Rpb25Sb3crKztcblxuICAgICAgICAgICAgICBpZiAoYWN0aW9uUm93ID49IGxheW91dE1hcC5ib2R5Um93Q291bnQpIHtcbiAgICAgICAgICAgICAgICBhY3Rpb25Sb3cgPSAwO1xuICAgICAgICAgICAgICAgIGR1cGxpY2F0ZSA9IHt9O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFsdWVzUm93Kys7XG5cbiAgICAgICAgICAgICAgaWYgKHZhbHVlc1JvdyA+PSB2YWx1ZXMucm93Q291bnQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZXNSb3cgPSAwO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBuZXdFbmQgPSB7XG4gICAgICAgICAgICAgIGNvbDogc3RhcnQuY29sICsgcGFzdGVDb2xDb3VudCAtIDEsXG4gICAgICAgICAgICAgIHJvdzogc3RhcnQucm93ICsgcGFzdGVSb3dDb3VudCAtIDFcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbi5yYW5nZSA9IHtcbiAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICAgICAgICBlbmQ6IG5ld0VuZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZUNlbGxSYW5nZSh0aGlzLnNlbGVjdGlvbi5yYW5nZSk7XG4gICAgICAgICAgICBwcm9jZXNzUmVqZWN0ZWQoKTtcblxuICAgICAgICAgICAgX3JlamVjdCA9IGZ1bmN0aW9uIF9yZWplY3QoY2VsbCwgcmVjb3JkLCBkZWZpbmUsIHBhc3RlVmFsdWUpIHtcbiAgICAgICAgICAgICAgYWRkUmVqZWN0ZWREZXRhaWwoY2VsbCwgcmVjb3JkLCBkZWZpbmUsIHBhc3RlVmFsdWUpO1xuICAgICAgICAgICAgICBwcm9jZXNzUmVqZWN0ZWQoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfb25SYW5nZURlbGV0ZSgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczEwID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIF9iO1xuXG4gICAgICAgICAgICB2YXIgbGF5b3V0TWFwID0gdGhpc1tfXS5sYXlvdXRNYXA7XG4gICAgICAgICAgICB2YXIgc2VsZWN0aW9uUmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5yYW5nZTtcblxuICAgICAgICAgICAgdmFyIF90aGlzJGdldENlbGxSYW5nZTMgPSB0aGlzLmdldENlbGxSYW5nZShzZWxlY3Rpb25SYW5nZS5zdGFydC5jb2wsIHNlbGVjdGlvblJhbmdlLnN0YXJ0LnJvdyksXG4gICAgICAgICAgICAgICAgc3RhcnQgPSBfdGhpcyRnZXRDZWxsUmFuZ2UzLnN0YXJ0O1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMkZ2V0Q2VsbFJhbmdlNCA9IHRoaXMuZ2V0Q2VsbFJhbmdlKHNlbGVjdGlvblJhbmdlLmVuZC5jb2wsIHNlbGVjdGlvblJhbmdlLmVuZC5yb3cpLFxuICAgICAgICAgICAgICAgIGVuZCA9IF90aGlzJGdldENlbGxSYW5nZTQuZW5kO1xuXG4gICAgICAgICAgICB2YXIgZGVsZXRlUm93Q291bnQgPSBNYXRoLm1pbihlbmQucm93IC0gc3RhcnQucm93ICsgMSwgdGhpcy5yb3dDb3VudCAtIHN0YXJ0LnJvdyk7XG4gICAgICAgICAgICB2YXIgZGVsZXRlQ29sQ291bnQgPSBNYXRoLm1pbihlbmQuY29sIC0gc3RhcnQuY29sICsgMSwgdGhpcy5jb2xDb3VudCAtIHN0YXJ0LmNvbCk7XG4gICAgICAgICAgICB2YXIgaGFzRWRpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBhY3Rpb25Db2x1bW5zQm94ID0gW107XG5cbiAgICAgICAgICAgIGZvciAodmFyIGJvZHlSb3cgPSAwOyBib2R5Um93IDwgbGF5b3V0TWFwLmJvZHlSb3dDb3VudDsgYm9keVJvdysrKSB7XG4gICAgICAgICAgICAgIHZhciBhY3Rpb25Db2x1bW5zUm93ID0gW107XG4gICAgICAgICAgICAgIGFjdGlvbkNvbHVtbnNCb3gucHVzaChhY3Rpb25Db2x1bW5zUm93KTtcblxuICAgICAgICAgICAgICBmb3IgKHZhciBvZmZzZXRDb2wgPSAwOyBvZmZzZXRDb2wgPCBkZWxldGVDb2xDb3VudDsgb2Zmc2V0Q29sKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keSA9IGxheW91dE1hcC5nZXRCb2R5KHN0YXJ0LmNvbCArIG9mZnNldENvbCwgYm9keVJvdyArIGxheW91dE1hcC5oZWFkZXJSb3dDb3VudCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uQ29sdW1uc1Jvd1tvZmZzZXRDb2xdID0gYm9keTtcblxuICAgICAgICAgICAgICAgIGlmICghaGFzRWRpdGFibGUgJiYgKChfYiA9IGJvZHkuYWN0aW9uKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZWRpdGFibGUpKSB7XG4gICAgICAgICAgICAgICAgICBoYXNFZGl0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghaGFzRWRpdGFibGUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3RhcnRSb3cgPSBsYXlvdXRNYXAuZ2V0UmVjb3JkU3RhcnRSb3dCeVJlY29yZEluZGV4KGxheW91dE1hcC5nZXRSZWNvcmRJbmRleEJ5Um93KHN0YXJ0LnJvdykpO1xuICAgICAgICAgICAgdmFyIHN0YXJ0Um93T2Zmc2V0ID0gc3RhcnQucm93IC0gc3RhcnRSb3c7XG4gICAgICAgICAgICB2YXIgZHVwbGljYXRlID0ge307XG4gICAgICAgICAgICB2YXIgYWN0aW9uUm93ID0gc3RhcnRSb3dPZmZzZXQ7XG5cbiAgICAgICAgICAgIGZvciAodmFyIG9mZnNldFJvdyA9IDA7IG9mZnNldFJvdyA8IGRlbGV0ZVJvd0NvdW50OyBvZmZzZXRSb3crKykge1xuICAgICAgICAgICAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKF9vZmZzZXRDb2wyKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hY3Rpb25Db2x1bW5zQm94JGFjdDIgPSBhY3Rpb25Db2x1bW5zQm94W2FjdGlvblJvd11bX29mZnNldENvbDJdLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24gPSBfYWN0aW9uQ29sdW1uc0JveCRhY3QyLmFjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaWQgPSBfYWN0aW9uQ29sdW1uc0JveCRhY3QyLmlkO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkdXBsaWNhdGVbaWRdICYmIChhY3Rpb24gPT09IG51bGwgfHwgYWN0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhY3Rpb24uZWRpdGFibGUpKSB7XG4gICAgICAgICAgICAgICAgICBkdXBsaWNhdGVbaWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBzdGFydC5jb2wgKyBfb2Zmc2V0Q29sMjtcbiAgICAgICAgICAgICAgICAgIHZhciByb3cgPSBzdGFydC5yb3cgKyBvZmZzZXRSb3c7XG4gICAgICAgICAgICAgICAgICAoMCwgdXRpbHNfMS50aGVuKShfdGhpczEwLmdldFJvd1JlY29yZChyb3cpLCBmdW5jdGlvbiAoX3JlY29yZCkge1xuICAgICAgICAgICAgICAgICAgICAoMCwgdXRpbHNfMS50aGVuKShfZ2V0Q2VsbFZhbHVlKF90aGlzMTAsIGNvbCwgcm93KSwgZnVuY3Rpb24gKF9vbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5vbkRlbGV0ZUNlbGxSYW5nZUJveChfdGhpczEwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIF9vZmZzZXRDb2wyID0gMDsgX29mZnNldENvbDIgPCBkZWxldGVDb2xDb3VudDsgX29mZnNldENvbDIrKykge1xuICAgICAgICAgICAgICAgIF9sb29wMihfb2Zmc2V0Q29sMik7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBhY3Rpb25Sb3crKztcblxuICAgICAgICAgICAgICBpZiAoYWN0aW9uUm93ID49IGxheW91dE1hcC5ib2R5Um93Q291bnQpIHtcbiAgICAgICAgICAgICAgICBhY3Rpb25Sb3cgPSAwO1xuICAgICAgICAgICAgICAgIGR1cGxpY2F0ZSA9IHt9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZUNlbGxSYW5nZShzZWxlY3Rpb25SYW5nZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIExpc3RHcmlkXG4gICAgICAgICAgICogQGNsYXNzZGVzYyBjaGVldGFoR3JpZC5MaXN0R3JpZFxuICAgICAgICAgICAqIEBtZW1iZXJvZiBjaGVldGFoR3JpZFxuICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICB2YXIgTGlzdEdyaWQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9EcmF3R3JpZF8xJERyYXdHcmlkKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoTGlzdEdyaWQsIF9EcmF3R3JpZF8xJERyYXdHcmlkKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihMaXN0R3JpZCk7XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29uc3RydWN0b3JcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICAgICAqIEBwYXJhbSBvcHRpb25zIENvbnN0cnVjdG9yIG9wdGlvbnNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gTGlzdEdyaWQoKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczExO1xuXG4gICAgICAgICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGlzdEdyaWQpO1xuXG4gICAgICAgICAgICAgIHZhciBfYjtcblxuICAgICAgICAgICAgICBfdGhpczExID0gX3N1cGVyLmNhbGwodGhpcywgKDAsIHV0aWxzXzEub21pdCkob3B0aW9ucywgW1wiY29sQ291bnRcIiwgXCJyb3dDb3VudFwiLCBcImZyb3plblJvd0NvdW50XCJdKSk7XG4gICAgICAgICAgICAgIF90aGlzMTFbX2FdID0gX3RoaXMxMVtfXTtcbiAgICAgICAgICAgICAgX3RoaXMxMS5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBfdGhpczExLnJlYWRPbmx5ID0gZmFsc2U7XG4gICAgICAgICAgICAgIHZhciBwcm90ZWN0ZWRTcGFjZSA9IF90aGlzMTFbX107XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmhlYWRlciA9IG9wdGlvbnMuaGVhZGVyIHx8IFtdO1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5sYXlvdXQgPSBvcHRpb25zLmxheW91dCB8fCBbXTtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuaGVhZGVyUm93SGVpZ2h0ID0gb3B0aW9ucy5oZWFkZXJSb3dIZWlnaHQgfHwgW107XG5cbiAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIF9zZXREYXRhU291cmNlKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMxMSksIG9wdGlvbnMuZGF0YVNvdXJjZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgX3NldFJlY29yZHMoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczExKSwgb3B0aW9ucy5yZWNvcmRzKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmFsbG93UmFuZ2VQYXN0ZSA9IChfYiA9IG9wdGlvbnMuYWxsb3dSYW5nZVBhc3RlKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBmYWxzZTtcblxuICAgICAgICAgICAgICBfcmVmcmVzaEhlYWRlcihfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMTEpKTtcblxuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5zb3J0U3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgY29sOiAtMSxcbiAgICAgICAgICAgICAgICByb3c6IC0xLFxuICAgICAgICAgICAgICAgIG9yZGVyOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuZ3JpZENhbnZhc0hlbHBlciA9IG5ldyBHcmlkQ2FudmFzSGVscGVyXzEuR3JpZENhbnZhc0hlbHBlcihfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMTEpKTtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UudGhlbWUgPSB0aGVtZXMub2Yob3B0aW9ucy50aGVtZSk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLm1lc3NhZ2VIYW5kbGVyID0gbmV3IE1lc3NhZ2VIYW5kbGVyXzEuTWVzc2FnZUhhbmRsZXIoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczExKSwgZnVuY3Rpb24gKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRDZWxsTWVzc2FnZShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMTEpLCBjb2wsIHJvdyk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS50b29sdGlwSGFuZGxlciA9IG5ldyBUb29sdGlwSGFuZGxlcl8xLlRvb2x0aXBIYW5kbGVyKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMxMSkpO1xuXG4gICAgICAgICAgICAgIF90aGlzMTEuaW52YWxpZGF0ZSgpO1xuXG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmhhbmRsZXIub24od2luZG93LCBcInJlc2l6ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMxMS51cGRhdGVTaXplKCk7XG5cbiAgICAgICAgICAgICAgICBfdGhpczExLnVwZGF0ZVNjcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMxMS5pbnZhbGlkYXRlKCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRGlzcG9zZSB0aGUgZ3JpZCBpbnN0YW5jZS5cbiAgICAgICAgICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAgICAgICAgICovXG5cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKExpc3RHcmlkLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiZGlzcG9zZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvdGVjdGVkU3BhY2UgPSB0aGlzW19dO1xuICAgICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLm1lc3NhZ2VIYW5kbGVyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS50b29sdGlwSGFuZGxlci5kaXNwb3NlKCk7XG5cbiAgICAgICAgICAgICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihMaXN0R3JpZC5wcm90b3R5cGUpLCBcImRpc3Bvc2VcIiwgdGhpcykuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0cyB0aGUgZGVmaW5lIG9mIHRoZSBoZWFkZXIuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoZWFkZXJcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10uaGVhZGVyO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXRzIHRoZSBkZWZpbmUgb2YgdGhlIGhlYWRlciB3aXRoIHRoZSBnaXZlbiBkYXRhLlxuICAgICAgICAgICAgICAgKiA8cHJlPlxuICAgICAgICAgICAgICAgKiBjb2x1bW4gb3B0aW9uc1xuICAgICAgICAgICAgICAgKiAtLS0tLVxuICAgICAgICAgICAgICAgKiBjYXB0aW9uOiBoZWFkZXIgY2FwdGlvblxuICAgICAgICAgICAgICAgKiBmaWVsZDogZmllbGQgbmFtZVxuICAgICAgICAgICAgICAgKiB3aWR0aDogY29sdW1uIHdpZHRoXG4gICAgICAgICAgICAgICAqIG1pbldpZHRoOiBjb2x1bW4gbWluIHdpZHRoXG4gICAgICAgICAgICAgICAqIG1heFdpZHRoOiBjb2x1bW4gbWF4IHdpZHRoXG4gICAgICAgICAgICAgICAqIGljb246IGljb24gZGVmaW5pdGlvblxuICAgICAgICAgICAgICAgKiBtZXNzYWdlOiBtZXNzYWdlIGtleSBuYW1lXG4gICAgICAgICAgICAgICAqIGNvbHVtblR5cGU6IGNvbHVtbiB0eXBlXG4gICAgICAgICAgICAgICAqIGFjdGlvbjogY29sdW1uIGFjdGlvblxuICAgICAgICAgICAgICAgKiBzdHlsZTogY29sdW1uIHN0eWxlXG4gICAgICAgICAgICAgICAqIGhlYWRlclR5cGU6IGhlYWRlciB0eXBlXG4gICAgICAgICAgICAgICAqIGhlYWRlclN0eWxlOiBoZWFkZXIgc3R5bGVcbiAgICAgICAgICAgICAgICogaGVhZGVyQWN0aW9uOiBoZWFkZXIgYWN0aW9uXG4gICAgICAgICAgICAgICAqIGhlYWRlckZpZWxkOiBoZWFkZXIgZmllbGQgbmFtZVxuICAgICAgICAgICAgICAgKiBoZWFkZXJJY29uOiBoZWFkZXIgaWNvbiBkZWZpbml0aW9uXG4gICAgICAgICAgICAgICAqIHNvcnQ6IGRlZmluZSBzb3J0IHNldHRpbmdcbiAgICAgICAgICAgICAgICogLS0tLS1cbiAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICogbXVsdGlsaW5lIGhlYWRlclxuICAgICAgICAgICAgICAgKiAtLS0tLVxuICAgICAgICAgICAgICAgKiBjYXB0aW9uOiBoZWFkZXIgY2FwdGlvblxuICAgICAgICAgICAgICAgKiBjb2x1bW5zOiBjb2x1bW5zIGRlZmluZVxuICAgICAgICAgICAgICAgKiAtLS0tLVxuICAgICAgICAgICAgICAgKiA8L3ByZT5cbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpc1tfXS5oZWFkZXIgPSBoZWFkZXI7XG5cbiAgICAgICAgICAgICAgICBfcmVmcmVzaEhlYWRlcih0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0cyB0aGUgZGVmaW5lIG9mIHRoZSBsYXlvdXQuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJsYXlvdXRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10ubGF5b3V0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXRzIHRoZSBkZWZpbmUgb2YgdGhlIGxheW91dCB3aXRoIHRoZSBnaXZlbiBkYXRhLlxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgLFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChsYXlvdXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzW19dLmxheW91dCA9IGxheW91dDtcblxuICAgICAgICAgICAgICAgIF9yZWZyZXNoSGVhZGVyKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXRzIHRoZSBkZWZpbmUgb2YgdGhlIGhlYWRlclJvd0hlaWdodC5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImhlYWRlclJvd0hlaWdodFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5oZWFkZXJSb3dIZWlnaHQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFNldHMgdGhlIGRlZmluZSBvZiB0aGUgaGVhZGVyUm93SGVpZ2h0IHdpdGggdGhlIGdpdmVuIGRhdGEuXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGhlYWRlclJvd0hlaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXNbX10uaGVhZGVyUm93SGVpZ2h0ID0gaGVhZGVyUm93SGVpZ2h0IHx8IFtdO1xuXG4gICAgICAgICAgICAgICAgX3JlZnJlc2hIZWFkZXIodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgcm93IGNvdW50IHBlciByZWNvcmRcbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJlY29yZFJvd0NvdW50XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW19dLmxheW91dE1hcC5ib2R5Um93Q291bnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgcmVjb3Jkcy5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJlY29yZHNcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10ucmVjb3JkcyB8fCBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXQgdGhlIHJlY29yZHMgZnJvbSBnaXZlblxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgLFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChyZWNvcmRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlY29yZHMgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF9zZXRSZWNvcmRzKHRoaXMsIHJlY29yZHMpO1xuXG4gICAgICAgICAgICAgICAgX3JlZnJlc2hSb3dDb3VudCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGRhdGEgc291cmNlLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZGF0YVNvdXJjZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5kYXRhU291cmNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXQgdGhlIGRhdGEgc291cmNlIGZyb20gZ2l2ZW5cbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIF9zZXREYXRhU291cmNlKHRoaXMsIGRhdGFTb3VyY2UpO1xuXG4gICAgICAgICAgICAgICAgX3JlZnJlc2hSb3dDb3VudCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIHRoZW1lLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidGhlbWVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10udGhlbWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFNldCB0aGUgdGhlbWUgZnJvbSBnaXZlblxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgLFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh0aGVtZSkge1xuICAgICAgICAgICAgICAgIHRoaXNbX10udGhlbWUgPSB0aGVtZXMub2YodGhlbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBJZiBzZXQgdG8gdHJ1ZSB0byBhbGxvdyBwYXN0aW5nIG9mIHJhbmdlcy5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImFsbG93UmFuZ2VQYXN0ZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5hbGxvd1JhbmdlUGFzdGU7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGFsbG93UmFuZ2VQYXN0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXNbX10uYWxsb3dSYW5nZVBhc3RlID0gYWxsb3dSYW5nZVBhc3RlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGZvbnQgZGVmaW5pdGlvbiBhcyBhIHN0cmluZy5cbiAgICAgICAgICAgICAgICogQG92ZXJyaWRlXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmb250XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0KF9nZXRQcm90b3R5cGVPZihMaXN0R3JpZC5wcm90b3R5cGUpLCBcImZvbnRcIiwgdGhpcykgfHwgdGhpc1tfXS5ncmlkQ2FudmFzSGVscGVyLnRoZW1lLmZvbnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFNldCB0aGUgZm9udCBkZWZpbml0aW9uIHdpdGggdGhlIGdpdmVuIHN0cmluZy5cbiAgICAgICAgICAgICAgICogQG92ZXJyaWRlXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGZvbnQpIHtcbiAgICAgICAgICAgICAgICBfc2V0KF9nZXRQcm90b3R5cGVPZihMaXN0R3JpZC5wcm90b3R5cGUpLCBcImZvbnRcIiwgZm9udCwgdGhpcywgdHJ1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgdW5kZXJsYXkuXG4gICAgICAgICAgICAgICAqIEBvdmVycmlkZVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidW5kZXJsYXlCYWNrZ3JvdW5kQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKExpc3RHcmlkLnByb3RvdHlwZSksIFwidW5kZXJsYXlCYWNrZ3JvdW5kQ29sb3JcIiwgdGhpcykgfHwgdGhpc1tfXS5ncmlkQ2FudmFzSGVscGVyLnRoZW1lLnVuZGVybGF5QmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXQgdGhlIGJhY2tncm91bmQgY29sb3Igb2YgdGhlIHVuZGVybGF5LlxuICAgICAgICAgICAgICAgKiBAb3ZlcnJpZGVcbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodW5kZXJsYXlCYWNrZ3JvdW5kQ29sb3IpIHtcbiAgICAgICAgICAgICAgICBfc2V0KF9nZXRQcm90b3R5cGVPZihMaXN0R3JpZC5wcm90b3R5cGUpLCBcInVuZGVybGF5QmFja2dyb3VuZENvbG9yXCIsIHVuZGVybGF5QmFja2dyb3VuZENvbG9yLCB0aGlzLCB0cnVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSBzb3J0IHN0YXRlLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic29ydFN0YXRlXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW19dLnNvcnRTdGF0ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0cyB0aGUgc29ydCBzdGF0ZS5cbiAgICAgICAgICAgICAgICogSWYgYG51bGxgIHRvIHNldCwgdGhlIHNvcnQgc3RhdGUgaXMgaW5pdGlhbGl6ZWQuXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHNvcnRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciBvbGRTdGF0ZSA9IHRoaXMuc29ydFN0YXRlO1xuICAgICAgICAgICAgICAgIHZhciBvbGRGaWVsZDtcblxuICAgICAgICAgICAgICAgIGlmIChvbGRTdGF0ZS5jb2wgPj0gMCAmJiBvbGRTdGF0ZS5yb3cgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgb2xkRmllbGQgPSB0aGlzLmdldEhlYWRlckZpZWxkKG9sZFN0YXRlLmNvbCwgb2xkU3RhdGUucm93KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV3U3RhdGUgPSB0aGlzW19dLnNvcnRTdGF0ZSA9IHNvcnRTdGF0ZSAhPSBudWxsID8gc29ydFN0YXRlIDoge1xuICAgICAgICAgICAgICAgICAgY29sOiAtMSxcbiAgICAgICAgICAgICAgICAgIHJvdzogLTEsXG4gICAgICAgICAgICAgICAgICBvcmRlcjogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3RmllbGQ7XG5cbiAgICAgICAgICAgICAgICBpZiAobmV3U3RhdGUuY29sID49IDAgJiYgbmV3U3RhdGUucm93ID49IDApIHtcbiAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gdGhpcy5nZXRIZWFkZXJGaWVsZChuZXdTdGF0ZS5jb2wsIG5ld1N0YXRlLnJvdyk7XG4gICAgICAgICAgICAgICAgfSAvLyBiaW5kIGhlYWRlciB2YWx1ZVxuXG5cbiAgICAgICAgICAgICAgICBpZiAob2xkRmllbGQgIT0gbnVsbCAmJiBvbGRGaWVsZCAhPT0gbmV3RmllbGQpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SGVhZGVyVmFsdWUob2xkU3RhdGUuY29sLCBvbGRTdGF0ZS5yb3csIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5ld0ZpZWxkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SGVhZGVyVmFsdWUobmV3U3RhdGUuY29sLCBuZXdTdGF0ZS5yb3csIG5ld1N0YXRlLm9yZGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgaGVhZGVyIHZhbHVlcy5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImhlYWRlclZhbHVlc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5oZWFkZXJWYWx1ZXMgfHwgKHRoaXNbX10uaGVhZGVyVmFsdWVzID0gbmV3IE1hcCgpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0cyB0aGUgaGVhZGVyIHZhbHVlcy5cbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoaGVhZGVyVmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgdGhpc1tfXS5oZWFkZXJWYWx1ZXMgPSBoZWFkZXJWYWx1ZXMgfHwgbmV3IE1hcCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGZpZWxkIG9mIHRoZSBnaXZlbiBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sIFRoZSBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gcm93IFRoZSByb3cgaW5kZXguXG4gICAgICAgICAgICAgICAqIEByZXR1cm4geyp9IFRoZSBmaWVsZCBvYmplY3QuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRGaWVsZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RmllbGQoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5sYXlvdXRNYXAuZ2V0Qm9keShjb2wsIHJvdyAhPT0gbnVsbCAmJiByb3cgIT09IHZvaWQgMCA/IHJvdyA6IHRoaXNbX10ubGF5b3V0TWFwLmhlYWRlclJvd0NvdW50KS5maWVsZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSBjb2x1bW4gZGVmaW5lIG9mIHRoZSBnaXZlbiBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sIFRoZSBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gcm93IFRoZSByb3cgaW5kZXguXG4gICAgICAgICAgICAgICAqIEByZXR1cm4geyp9IFRoZSBjb2x1bW4gZGVmaW5lIG9iamVjdC5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENvbHVtbkRlZmluZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29sdW1uRGVmaW5lKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10ubGF5b3V0TWFwLmdldEJvZHkoY29sLCByb3cgIT09IG51bGwgJiYgcm93ICE9PSB2b2lkIDAgPyByb3cgOiB0aGlzW19dLmxheW91dE1hcC5oZWFkZXJSb3dDb3VudCkuZGVmaW5lO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDb2x1bW5UeXBlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb2x1bW5UeXBlKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10ubGF5b3V0TWFwLmdldEJvZHkoY29sLCByb3cpLmNvbHVtblR5cGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENvbHVtbkFjdGlvblwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29sdW1uQWN0aW9uKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10ubGF5b3V0TWFwLmdldEJvZHkoY29sLCByb3cpLmFjdGlvbjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSBoZWFkZXIgZmllbGQgb2YgdGhlIGdpdmVuIGhlYWRlciBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGNvbCBUaGUgY29sdW1uIGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHJvdyBUaGUgaGVhZGVyIHJvdyBpbmRleC5cbiAgICAgICAgICAgICAgICogQHJldHVybiB7Kn0gVGhlIGZpZWxkIG9iamVjdC5cbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldEhlYWRlckZpZWxkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRIZWFkZXJGaWVsZChjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBoZCA9IHRoaXNbX10ubGF5b3V0TWFwLmdldEhlYWRlcihjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gaGQuZmllbGQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgaGVhZGVyIGRlZmluZSBvZiB0aGUgZ2l2ZW4gaGVhZGVyIGNlbGwuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sIFRoZSBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gcm93IFRoZSBoZWFkZXIgcm93IGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHsqfSBUaGUgaGVhZGVyIGRlZmluZSBvYmplY3QuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRIZWFkZXJEZWZpbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEhlYWRlckRlZmluZShjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBoZCA9IHRoaXNbX10ubGF5b3V0TWFwLmdldEhlYWRlcihjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gaGQuZGVmaW5lO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIHJlY29yZCBvZiB0aGUgZ2l2ZW4gcm93IGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHJvdyBUaGUgcm93IGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtvYmplY3R9IFRoZSByZWNvcmQuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRSb3dSZWNvcmRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJvd1JlY29yZChyb3cpIHtcbiAgICAgICAgICAgICAgICBpZiAocm93IDwgdGhpc1tfXS5sYXlvdXRNYXAuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5kYXRhU291cmNlLmdldChfZ2V0UmVjb3JkSW5kZXhCeVJvdyh0aGlzLCByb3cpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgcmVjb3JkIGluZGV4IG9mIHRoZSBnaXZlbiByb3cgaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gcm93IFRoZSByb3cgaW5kZXguXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRSZWNvcmRJbmRleEJ5Um93XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZWNvcmRJbmRleEJ5Um93KHJvdykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0UmVjb3JkSW5kZXhCeVJvdyh0aGlzLCByb3cpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXRzIHRoZSByb3cgaW5kZXggc3RhcnRpbmcgYXQgdGhlIGdpdmVuIHJlY29yZCBpbmRleC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBpbmRleCBUaGUgcmVjb3JkIGluZGV4LlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0UmVjb3JkU3RhcnRSb3dCeVJlY29yZEluZGV4XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZWNvcmRTdGFydFJvd0J5UmVjb3JkSW5kZXgoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5sYXlvdXRNYXAuZ2V0UmVjb3JkU3RhcnRSb3dCeVJlY29yZEluZGV4KGluZGV4KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSBjb2x1bW4gaW5kZXggb2YgdGhlIGdpdmVuIGZpZWxkLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHsqfSBmaWVsZCBUaGUgZmllbGQuXG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIGNvbHVtbiBpbmRleC5cbiAgICAgICAgICAgICAgICogQGRlcHJlY2F0ZWQgdXNlIGBnZXRDZWxsUmFuZ2VCeUZpZWxkYCBpbnN0ZWFkXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDb2x1bW5JbmRleEJ5RmllbGRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbHVtbkluZGV4QnlGaWVsZChmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBfYjtcblxuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuZ2V0Q2VsbFJhbmdlQnlGaWVsZChmaWVsZCwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChfYiA9IHJhbmdlID09PSBudWxsIHx8IHJhbmdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiByYW5nZS5zdGFydC5jb2wpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgY29sdW1uIGluZGV4IG9mIHRoZSBnaXZlbiBmaWVsZC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7Kn0gZmllbGQgVGhlIGZpZWxkLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGluZGV4IFRoZSByZWNvcmQgaW5kZXhcbiAgICAgICAgICAgICAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgY29sdW1uIGluZGV4LlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q2VsbFJhbmdlQnlGaWVsZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbFJhbmdlQnlGaWVsZChmaWVsZCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0TWFwID0gdGhpc1tfXS5sYXlvdXRNYXA7XG4gICAgICAgICAgICAgICAgdmFyIGNvbE9iaiA9IGxheW91dE1hcC5jb2x1bW5PYmplY3RzLmZpbmQoZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbC5maWVsZCA9PT0gZmllbGQ7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29sT2JqKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgbGF5b3V0UmFuZ2UgPSBsYXlvdXRNYXAuZ2V0Qm9keUxheW91dFJhbmdlQnlJZChjb2xPYmouaWQpO1xuICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0Um93ID0gbGF5b3V0TWFwLmdldFJlY29yZFN0YXJ0Um93QnlSZWNvcmRJbmRleChpbmRleCk7XG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgICAgICAgIGNvbDogbGF5b3V0UmFuZ2Uuc3RhcnQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogc3RhcnRSb3cgKyBsYXlvdXRSYW5nZS5zdGFydC5yb3dcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZW5kOiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBsYXlvdXRSYW5nZS5lbmQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogc3RhcnRSb3cgKyBsYXlvdXRSYW5nZS5lbmQucm93XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEZvY3VzIHRoZSBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHsqfSBmaWVsZCBUaGUgZmllbGQuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gaW5kZXggVGhlIHJlY29yZCBpbmRleFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZm9jdXNHcmlkQ2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9jdXNHcmlkQ2VsbChmaWVsZCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2I7XG5cbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkc2VsZWN0aW9uJHJhbmdlID0gdGhpcy5zZWxlY3Rpb24ucmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgIF90aGlzJHNlbGVjdGlvbiRyYW5nZTIgPSBfdGhpcyRzZWxlY3Rpb24kcmFuZ2Uuc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0Q29sID0gX3RoaXMkc2VsZWN0aW9uJHJhbmdlMi5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0Um93ID0gX3RoaXMkc2VsZWN0aW9uJHJhbmdlMi5yb3csXG4gICAgICAgICAgICAgICAgICAgIF90aGlzJHNlbGVjdGlvbiRyYW5nZTMgPSBfdGhpcyRzZWxlY3Rpb24kcmFuZ2UuZW5kLFxuICAgICAgICAgICAgICAgICAgICBlbmRDb2wgPSBfdGhpcyRzZWxlY3Rpb24kcmFuZ2UzLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgZW5kUm93ID0gX3RoaXMkc2VsZWN0aW9uJHJhbmdlMy5yb3c7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0ZvY3VzID0gKF9iID0gdGhpcy5nZXRDZWxsUmFuZ2VCeUZpZWxkKGZpZWxkLCBpbmRleCkpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zdGFydDtcblxuICAgICAgICAgICAgICAgIGlmIChuZXdGb2N1cyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c0NlbGwobmV3Rm9jdXMuY29sLCBuZXdGb2N1cy5yb3cpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uLnNlbGVjdCA9IG5ld0ZvY3VzO1xuICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZUdyaWRSZWN0KHN0YXJ0Q29sLCBzdGFydFJvdywgZW5kQ29sLCBlbmRSb3cpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZUNlbGwobmV3Rm9jdXMuY29sLCBuZXdGb2N1cy5yb3cpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTY3JvbGwgdG8gd2hlcmUgY2VsbCBpcyB2aXNpYmxlLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHsqfSBmaWVsZCBUaGUgZmllbGQuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gaW5kZXggVGhlIHJlY29yZCBpbmRleFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibWFrZVZpc2libGVHcmlkQ2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVZpc2libGVHcmlkQ2VsbChmaWVsZCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2IsIF9jLCBfZDtcblxuICAgICAgICAgICAgICAgIHZhciBjZWxsID0gKF9iID0gdGhpcy5nZXRDZWxsUmFuZ2VCeUZpZWxkKGZpZWxkLCBpbmRleCkpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zdGFydDtcbiAgICAgICAgICAgICAgICB0aGlzLm1ha2VWaXNpYmxlQ2VsbCgoX2MgPSBjZWxsID09PSBudWxsIHx8IGNlbGwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNlbGwuY29sKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiAwLCAoX2QgPSBjZWxsID09PSBudWxsIHx8IGNlbGwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNlbGwucm93KSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiB0aGlzW19dLmxheW91dE1hcC5oZWFkZXJSb3dDb3VudCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldEdyaWRDYW52YXNIZWxwZXJcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEdyaWRDYW52YXNIZWxwZXIoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10uZ3JpZENhbnZhc0hlbHBlcjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IGNlbGwgcmFuZ2UgaW5mb3JtYXRpb24gZm9yIGEgZ2l2ZW4gY2VsbC5cbiAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbCBjb2x1bW4gaW5kZXggb2YgdGhlIGNlbGxcbiAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdyByb3cgaW5kZXggb2YgdGhlIGNlbGxcbiAgICAgICAgICAgICAgICogQHJldHVybnMge29iamVjdH0gY2VsbCByYW5nZSBpbmZvXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDZWxsUmFuZ2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENlbGxSYW5nZShjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0Q2VsbFJhbmdlKHRoaXMsIGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IGhlYWRlciByYW5nZSBpbmZvcm1hdGlvbiBmb3IgYSBnaXZlbiBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gY29sIGNvbHVtbiBpbmRleCBvZiB0aGUgY2VsbFxuICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93IHJvdyBpbmRleCBvZiB0aGUgY2VsbFxuICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSBjZWxsIHJhbmdlIGluZm9cbiAgICAgICAgICAgICAgICogQGRlcHJlY2F0ZWQgdXNlIGBnZXRDZWxsUmFuZ2VgIGluc3RlYWRcbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldEhlYWRlckNlbGxSYW5nZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SGVhZGVyQ2VsbFJhbmdlKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbFJhbmdlKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q29weUNlbGxWYWx1ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29weUNlbGxWYWx1ZShjb2wsIHJvdywgcmFuZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbFJhbmdlID0gX2dldENlbGxSYW5nZSh0aGlzLCBjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RhcnRDb2wgPSByYW5nZSA/IE1hdGgubWF4KHJhbmdlLnN0YXJ0LmNvbCwgY2VsbFJhbmdlLnN0YXJ0LmNvbCkgOiBjZWxsUmFuZ2Uuc3RhcnQuY29sO1xuICAgICAgICAgICAgICAgIHZhciBzdGFydFJvdyA9IHJhbmdlID8gTWF0aC5tYXgocmFuZ2Uuc3RhcnQucm93LCBjZWxsUmFuZ2Uuc3RhcnQucm93KSA6IGNlbGxSYW5nZS5zdGFydC5yb3c7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRDb2wgIT09IGNvbCB8fCBzdGFydFJvdyAhPT0gcm93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBfZ2V0Q2VsbFZhbHVlKHRoaXMsIGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgIGlmIChyb3cgPCB0aGlzW19dLmxheW91dE1hcC5oZWFkZXJSb3dDb3VudCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlckRhdGEgPSB0aGlzW19dLmxheW91dE1hcC5nZXRIZWFkZXIoY29sLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgICByZXR1cm4gaGVhZGVyRGF0YS5oZWFkZXJUeXBlLmdldENvcHlDZWxsVmFsdWUodmFsdWUsIHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY29sdW1uRGF0YSA9IHRoaXNbX10ubGF5b3V0TWFwLmdldEJvZHkoY29sLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbHVtbkRhdGEuY29sdW1uVHlwZS5nZXRDb3B5Q2VsbFZhbHVlKHZhbHVlLCB0aGlzLCB7XG4gICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uRHJhd0NlbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uRHJhd0NlbGwoY29sLCByb3csIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0TWFwID0gdGhpc1tfXS5sYXlvdXRNYXA7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXc7XG4gICAgICAgICAgICAgICAgdmFyIHN0eWxlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJvdyA8IGxheW91dE1hcC5oZWFkZXJSb3dDb3VudCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGhkID0gbGF5b3V0TWFwLmdldEhlYWRlcihjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgICBkcmF3ID0gaGQuaGVhZGVyVHlwZS5vbkRyYXdDZWxsO1xuICAgICAgICAgICAgICAgICAgc3R5bGUgPSBoZC5zdHlsZTtcblxuICAgICAgICAgICAgICAgICAgX3VwZGF0ZVJlY3QodGhpcywgY29sLCByb3csIGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB2YXIgY29sdW1uID0gbGF5b3V0TWFwLmdldEJvZHkoY29sLCByb3cpO1xuICAgICAgICAgICAgICAgICAgZHJhdyA9IGNvbHVtbi5jb2x1bW5UeXBlLm9uRHJhd0NlbGw7XG4gICAgICAgICAgICAgICAgICBzdHlsZSA9IGNvbHVtbi5zdHlsZTtcblxuICAgICAgICAgICAgICAgICAgX3VwZGF0ZVJlY3QodGhpcywgY29sLCByb3csIGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjZWxsVmFsdWUgPSBfZ2V0Q2VsbFZhbHVlKHRoaXMsIGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvd0NvdW50IDw9IHJvdykge1xuICAgICAgICAgICAgICAgICAgLy8gRGVwZW5kaW5nIG9uIHRoZSBGaWx0ZXJEYXRhU291cmNlLCB0aGUgcm93Q291bnQgbWF5IGJlIHJlZHVjZWQuXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfb25EcmF3VmFsdWUodGhpcywgY2VsbFZhbHVlLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgfSwgc3R5bGUsIGRyYXcpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkb0dldENlbGxWYWx1ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZG9HZXRDZWxsVmFsdWUoY29sLCByb3csIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHZhbHVlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBpZiAocm93IDwgdGhpc1tfXS5sYXlvdXRNYXAuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgIC8vIG5vcFxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBfZ2V0Q2VsbFZhbHVlKHRoaXMsIGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8v6YGF5bu25Lit44Gv54Sh6KaWXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFsdWVDYWxsYmFjayh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRvQ2hhbmdlVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRvQ2hhbmdlVmFsdWUoY29sLCByb3csIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIGNoYW5nZVZhbHVlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBpZiAocm93IDwgdGhpc1tfXS5sYXlvdXRNYXAuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgIC8vIG5vcFxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gdGhpcy5nZXRSb3dSZWNvcmQocm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkocmVjb3JkKSkge1xuICAgICAgICAgICAgICAgICAgICAvL+mBheW7tuS4reOBr+eEoeimllxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBiZWZvcmUgPSBfZ2V0Q2VsbFZhbHVlKHRoaXMsIGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkoYmVmb3JlKSkge1xuICAgICAgICAgICAgICAgICAgICAvL+mBheW7tuS4reOBr+eEoeimllxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBhZnRlciA9IGNoYW5nZVZhbHVlQ2FsbGJhY2soYmVmb3JlKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGFmdGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXyRsYXlvdXRNYXAkZ2V0ID0gdGhpc1tfXS5sYXlvdXRNYXAuZ2V0Qm9keShjb2wsIHJvdyksXG4gICAgICAgICAgICAgICAgICAgICAgZmllbGQgPSBfdGhpcyRfJGxheW91dE1hcCRnZXQuZmllbGQ7XG5cbiAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZUxpc3RlbmVycyhMR19FVkVOVF9UWVBFXzEuTEdfRVZFTlRfVFlQRS5CRUZPUkVfQ0hBTkdFX1ZBTFVFLCB7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IHJvdyxcbiAgICAgICAgICAgICAgICAgICAgcmVjb3JkOiByZWNvcmQsXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBmaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZTogYmVmb3JlXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS50aGVuKShfc2V0Q2VsbFZhbHVlKHRoaXMsIGNvbCwgcm93LCBhZnRlciksIGZ1bmN0aW9uIChyZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJldCkge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGhpczEyJF8kbGF5b3V0TWFwJGcgPSBfdGhpczEyW19dLmxheW91dE1hcC5nZXRCb2R5KGNvbCwgcm93KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgX2ZpZWxkMiA9IF90aGlzMTIkXyRsYXlvdXRNYXAkZy5maWVsZDtcblxuICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTIuZmlyZUxpc3RlbmVycyhMR19FVkVOVF9UWVBFXzEuTEdfRVZFTlRfVFlQRS5DSEFOR0VEX1ZBTFVFLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogcm93LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkOiByZWNvcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogX2ZpZWxkMixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhZnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZFZhbHVlOiBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRvU2V0UGFzdGVWYWx1ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZG9TZXRQYXN0ZVZhbHVlKHRleHQsIHRlc3QpIHtcbiAgICAgICAgICAgICAgICBfb25SYW5nZVBhc3RlLmNhbGwodGhpcywgdGV4dCwgdGVzdCk7XG4gICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0SGVhZGVyVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEhlYWRlclZhbHVlKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5nZXRIZWFkZXJGaWVsZChjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyVmFsdWVzLmdldChmaWVsZCk7XG4gICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2V0SGVhZGVyVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldEhlYWRlclZhbHVlKGNvbCwgcm93LCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZ2V0SGVhZGVyRmllbGQoY29sLCByb3cpO1xuICAgICAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMuaGVhZGVyVmFsdWVzLmdldChmaWVsZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJWYWx1ZXMuc2V0KGZpZWxkLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5maXJlTGlzdGVuZXJzKExHX0VWRU5UX1RZUEVfMS5MR19FVkVOVF9UWVBFLkNIQU5HRURfSEVBREVSX1ZBTFVFLCB7XG4gICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogcm93LFxuICAgICAgICAgICAgICAgICAgZmllbGQ6IGZpZWxkLFxuICAgICAgICAgICAgICAgICAgdmFsdWU6IG5ld1ZhbHVlLFxuICAgICAgICAgICAgICAgICAgb2xkVmFsdWU6IG9sZFZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldExheW91dENlbGxJZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGF5b3V0Q2VsbElkKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10ubGF5b3V0TWFwLmdldENlbGxJZChjb2wsIHJvdyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJpbmRFdmVudHNJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZEV2ZW50c0ludGVybmFsKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczEzID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBncmlkID0gdGhpcztcbiAgICAgICAgICAgICAgICBncmlkLmxpc3RlbihMR19FVkVOVF9UWVBFXzEuTEdfRVZFTlRfVFlQRS5TRUxFQ1RFRF9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gX2dldENlbGxSYW5nZShfdGhpczEzLCBlLmNvbCwgZS5yb3cpO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgX3JhbmdlJHN0YXJ0ID0gcmFuZ2Uuc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgc3RhcnRDb2wgPSBfcmFuZ2Ukc3RhcnQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0Um93ID0gX3JhbmdlJHN0YXJ0LnJvdyxcbiAgICAgICAgICAgICAgICAgICAgICBfcmFuZ2UkZW5kID0gcmFuZ2UuZW5kLFxuICAgICAgICAgICAgICAgICAgICAgIGVuZENvbCA9IF9yYW5nZSRlbmQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIGVuZFJvdyA9IF9yYW5nZSRlbmQucm93O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoc3RhcnRDb2wgIT09IGVuZENvbCB8fCBzdGFydFJvdyAhPT0gZW5kUm93KSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMTMuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuUEFTVEVfQ0VMTCwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghX3RoaXMxM1tfXS5hbGxvd1JhbmdlUGFzdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgX3RoaXMxMyRzZWxlY3Rpb24kcmFuID0gX3RoaXMxMy5zZWxlY3Rpb24ucmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBfdGhpczEzJHNlbGVjdGlvbiRyYW4uc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgZW5kID0gX3RoaXMxMyRzZWxlY3Rpb24kcmFuLmVuZDtcblxuICAgICAgICAgICAgICAgICAgaWYgKCFlLm11bHRpICYmICgwLCB1dGlsc18xLmNlbGxFcXVhbHMpKHN0YXJ0LCBlbmQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIGxheW91dE1hcCA9IF90aGlzMTNbX10ubGF5b3V0TWFwO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoc3RhcnQucm93IDwgbGF5b3V0TWFwLmhlYWRlclJvd0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZS5ldmVudCk7XG5cbiAgICAgICAgICAgICAgICAgIF9vblJhbmdlUGFzdGUuY2FsbChfdGhpczEzLCBlLm5vcm1hbGl6ZVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBncmlkLmxpc3RlbihMR19FVkVOVF9UWVBFXzEuTEdfRVZFTlRfVFlQRS5ERUxFVEVfQ0VMTCwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IF90aGlzMTMuc2VsZWN0aW9uLnJhbmdlLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgdmFyIGxheW91dE1hcCA9IF90aGlzMTNbX10ubGF5b3V0TWFwO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoc3RhcnQucm93IDwgbGF5b3V0TWFwLmhlYWRlclJvd0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZS5ldmVudCk7XG5cbiAgICAgICAgICAgICAgICAgIF9vblJhbmdlRGVsZXRlLmNhbGwoX3RoaXMxMyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldE1vdmVMZWZ0Q29sQnlLZXlEb3duSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1vdmVMZWZ0Q29sQnlLZXlEb3duSW50ZXJuYWwoX3JlZjE4KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9yZWYxOC5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IF9yZWYxOC5yb3c7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2dldENlbGxSYW5nZTMgPSBfZ2V0Q2VsbFJhbmdlKHRoaXMsIGNvbCwgcm93KSxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRDb2wgPSBfZ2V0Q2VsbFJhbmdlMy5zdGFydC5jb2w7XG5cbiAgICAgICAgICAgICAgICBjb2wgPSBzdGFydENvbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoTGlzdEdyaWQucHJvdG90eXBlKSwgXCJnZXRNb3ZlTGVmdENvbEJ5S2V5RG93bkludGVybmFsXCIsIHRoaXMpLmNhbGwodGhpcywge1xuICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICByb3c6IHJvd1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRNb3ZlUmlnaHRDb2xCeUtleURvd25JbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TW92ZVJpZ2h0Q29sQnlLZXlEb3duSW50ZXJuYWwoX3JlZjE5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9yZWYxOS5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IF9yZWYxOS5yb3c7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2dldENlbGxSYW5nZTQgPSBfZ2V0Q2VsbFJhbmdlKHRoaXMsIGNvbCwgcm93KSxcbiAgICAgICAgICAgICAgICAgICAgZW5kQ29sID0gX2dldENlbGxSYW5nZTQuZW5kLmNvbDtcblxuICAgICAgICAgICAgICAgIGNvbCA9IGVuZENvbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoTGlzdEdyaWQucHJvdG90eXBlKSwgXCJnZXRNb3ZlUmlnaHRDb2xCeUtleURvd25JbnRlcm5hbFwiLCB0aGlzKS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0TW92ZVVwUm93QnlLZXlEb3duSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1vdmVVcFJvd0J5S2V5RG93bkludGVybmFsKF9yZWYyMCkge1xuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBfcmVmMjAuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3cgPSBfcmVmMjAucm93O1xuXG4gICAgICAgICAgICAgICAgdmFyIF9nZXRDZWxsUmFuZ2U1ID0gX2dldENlbGxSYW5nZSh0aGlzLCBjb2wsIHJvdyksXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0Um93ID0gX2dldENlbGxSYW5nZTUuc3RhcnQucm93O1xuXG4gICAgICAgICAgICAgICAgcm93ID0gc3RhcnRSb3c7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKExpc3RHcmlkLnByb3RvdHlwZSksIFwiZ2V0TW92ZVVwUm93QnlLZXlEb3duSW50ZXJuYWxcIiwgdGhpcykuY2FsbCh0aGlzLCB7XG4gICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldE1vdmVEb3duUm93QnlLZXlEb3duSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1vdmVEb3duUm93QnlLZXlEb3duSW50ZXJuYWwoX3JlZjIxKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9yZWYyMS5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IF9yZWYyMS5yb3c7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2dldENlbGxSYW5nZTYgPSBfZ2V0Q2VsbFJhbmdlKHRoaXMsIGNvbCwgcm93KSxcbiAgICAgICAgICAgICAgICAgICAgZW5kUm93ID0gX2dldENlbGxSYW5nZTYuZW5kLnJvdztcblxuICAgICAgICAgICAgICAgIHJvdyA9IGVuZFJvdztcbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoTGlzdEdyaWQucHJvdG90eXBlKSwgXCJnZXRNb3ZlRG93blJvd0J5S2V5RG93bkludGVybmFsXCIsIHRoaXMpLmNhbGwodGhpcywge1xuICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICByb3c6IHJvd1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRPZmZzZXRJbnZhbGlkYXRlQ2VsbHNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9mZnNldEludmFsaWRhdGVDZWxscygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q29weVJhbmdlSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvcHlSYW5nZUludGVybmFsKHJhbmdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJGdldENlbGxSYW5nZTUgPSB0aGlzLmdldENlbGxSYW5nZShyYW5nZS5zdGFydC5jb2wsIHJhbmdlLnN0YXJ0LnJvdyksXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gX3RoaXMkZ2V0Q2VsbFJhbmdlNS5zdGFydDtcblxuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRnZXRDZWxsUmFuZ2U2ID0gdGhpcy5nZXRDZWxsUmFuZ2UocmFuZ2UuZW5kLmNvbCwgcmFuZ2UuZW5kLnJvdyksXG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IF90aGlzJGdldENlbGxSYW5nZTYuZW5kO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICAgICAgICAgIGVuZDogZW5kXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZmlyZUxpc3RlbmVyc1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmlyZUxpc3RlbmVycyh0eXBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9nZXQyO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBldmVudCA9IG5ldyBBcnJheShfbGVuMyA+IDEgPyBfbGVuMyAtIDEgOiAwKSwgX2tleTMgPSAxOyBfa2V5MyA8IF9sZW4zOyBfa2V5MysrKSB7XG4gICAgICAgICAgICAgICAgICBldmVudFtfa2V5MyAtIDFdID0gYXJndW1lbnRzW19rZXkzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIHJldHVybiAoX2dldDIgPSBfZ2V0KF9nZXRQcm90b3R5cGVPZihMaXN0R3JpZC5wcm90b3R5cGUpLCBcImZpcmVMaXN0ZW5lcnNcIiwgdGhpcykpLmNhbGwuYXBwbHkoX2dldDIsIFt0aGlzLCB0eXBlXS5jb25jYXQoZXZlbnQpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJFVkVOVF9UWVBFXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBMR19FVkVOVF9UWVBFXzEuTEdfRVZFTlRfVFlQRTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTGlzdEdyaWQ7XG4gICAgICAgICAgfShEcmF3R3JpZF8xLkRyYXdHcmlkKTtcblxuICAgICAgICAgIGV4cG9ydHMuTGlzdEdyaWQgPSBMaXN0R3JpZDtcbiAgICAgICAgICBfYSA9IF87XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuc3R5bGUgPSBleHBvcnRzLnR5cGUgPSBleHBvcnRzLmFjdGlvbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBhY3Rpb24gPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9jb2x1bW5zL2FjdGlvbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi5qc1wiKSk7XG5cbiAgICAgICAgICBleHBvcnRzLmFjdGlvbiA9IGFjdGlvbjtcblxuICAgICAgICAgIHZhciBzdHlsZSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2NvbHVtbnMvc3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS5qc1wiKSk7XG5cbiAgICAgICAgICBleHBvcnRzLnN0eWxlID0gc3R5bGU7XG5cbiAgICAgICAgICB2YXIgdHlwZSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2NvbHVtbnMvdHlwZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUuanNcIikpO1xuXG4gICAgICAgICAgZXhwb3J0cy50eXBlID0gdHlwZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvYWN0aW9uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc0FjdGlvbkpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMub2YgPSBleHBvcnRzLklubGluZU1lbnVFZGl0b3IgPSBleHBvcnRzLklubGluZUlucHV0RWRpdG9yID0gZXhwb3J0cy5TbWFsbERpYWxvZ0lucHV0RWRpdG9yID0gZXhwb3J0cy5CdXR0b25BY3Rpb24gPSBleHBvcnRzLlJhZGlvRWRpdG9yID0gZXhwb3J0cy5DaGVja0VkaXRvciA9IGV4cG9ydHMuQWN0aW9uID0gZXhwb3J0cy5FZGl0b3IgPSBleHBvcnRzLkJhc2VBY3Rpb24gPSBleHBvcnRzLkFDVElPTlMgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQWN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2FjdGlvbi9BY3Rpb24gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vQWN0aW9uLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiQWN0aW9uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEFjdGlvbl8xLkFjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBCYXNlQWN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2FjdGlvbi9CYXNlQWN0aW9uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL0Jhc2VBY3Rpb24uanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJCYXNlQWN0aW9uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEJhc2VBY3Rpb25fMS5CYXNlQWN0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIEJ1dHRvbkFjdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb24vQnV0dG9uQWN0aW9uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL0J1dHRvbkFjdGlvbi5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkJ1dHRvbkFjdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBCdXR0b25BY3Rpb25fMS5CdXR0b25BY3Rpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgQ2hlY2tFZGl0b3JfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uL0NoZWNrRWRpdG9yICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL0NoZWNrRWRpdG9yLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiQ2hlY2tFZGl0b3JcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gQ2hlY2tFZGl0b3JfMS5DaGVja0VkaXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBFZGl0b3JfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uL0VkaXRvciAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9FZGl0b3IuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJFZGl0b3JcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gRWRpdG9yXzEuRWRpdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIElubGluZUlucHV0RWRpdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2FjdGlvbi9JbmxpbmVJbnB1dEVkaXRvciAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9JbmxpbmVJbnB1dEVkaXRvci5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIklubGluZUlucHV0RWRpdG9yXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIElubGluZUlucHV0RWRpdG9yXzEuSW5saW5lSW5wdXRFZGl0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgSW5saW5lTWVudUVkaXRvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb24vSW5saW5lTWVudUVkaXRvciAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9JbmxpbmVNZW51RWRpdG9yLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiSW5saW5lTWVudUVkaXRvclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBJbmxpbmVNZW51RWRpdG9yXzEuSW5saW5lTWVudUVkaXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBSYWRpb0VkaXRvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb24vUmFkaW9FZGl0b3IgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vUmFkaW9FZGl0b3IuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJSYWRpb0VkaXRvclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBSYWRpb0VkaXRvcl8xLlJhZGlvRWRpdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIFNtYWxsRGlhbG9nSW5wdXRFZGl0b3JfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uL1NtYWxsRGlhbG9nSW5wdXRFZGl0b3IgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vU21hbGxEaWFsb2dJbnB1dEVkaXRvci5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlNtYWxsRGlhbG9nSW5wdXRFZGl0b3JcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gU21hbGxEaWFsb2dJbnB1dEVkaXRvcl8xLlNtYWxsRGlhbG9nSW5wdXRFZGl0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICB2YXIgSW1tdXRhYmxlQ2hlY2tFZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9DaGVja0VkaXRvcl8xJENoZWNrRSkge1xuICAgICAgICAgICAgX2luaGVyaXRzKEltbXV0YWJsZUNoZWNrRWRpdG9yLCBfQ2hlY2tFZGl0b3JfMSRDaGVja0UpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMiA9IF9jcmVhdGVTdXBlcihJbW11dGFibGVDaGVja0VkaXRvcik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEltbXV0YWJsZUNoZWNrRWRpdG9yKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW1tdXRhYmxlQ2hlY2tFZGl0b3IpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXIyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbW11dGFibGVDaGVja0VkaXRvciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc2FibGVkXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kaXNhYmxlZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicmVhZE9ubHlcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRPbmx5O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbW11dGFibGVDaGVja0VkaXRvcjtcbiAgICAgICAgICB9KENoZWNrRWRpdG9yXzEuQ2hlY2tFZGl0b3IpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG5cbiAgICAgICAgICB2YXIgSW1tdXRhYmxlUmFkaW9FZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SYWRpb0VkaXRvcl8xJFJhZGlvRSkge1xuICAgICAgICAgICAgX2luaGVyaXRzKEltbXV0YWJsZVJhZGlvRWRpdG9yLCBfUmFkaW9FZGl0b3JfMSRSYWRpb0UpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMyA9IF9jcmVhdGVTdXBlcihJbW11dGFibGVSYWRpb0VkaXRvcik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEltbXV0YWJsZVJhZGlvRWRpdG9yKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW1tdXRhYmxlUmFkaW9FZGl0b3IpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXIzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbW11dGFibGVSYWRpb0VkaXRvciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc2FibGVkXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kaXNhYmxlZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicmVhZE9ubHlcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRPbmx5O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbW11dGFibGVSYWRpb0VkaXRvcjtcbiAgICAgICAgICB9KFJhZGlvRWRpdG9yXzEuUmFkaW9FZGl0b3IpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG5cbiAgICAgICAgICB2YXIgSW1tdXRhYmxlSW5wdXRFZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TbWFsbERpYWxvZ0lucHV0RWRpdCkge1xuICAgICAgICAgICAgX2luaGVyaXRzKEltbXV0YWJsZUlucHV0RWRpdG9yLCBfU21hbGxEaWFsb2dJbnB1dEVkaXQpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNCA9IF9jcmVhdGVTdXBlcihJbW11dGFibGVJbnB1dEVkaXRvcik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEltbXV0YWJsZUlucHV0RWRpdG9yKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW1tdXRhYmxlSW5wdXRFZGl0b3IpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbW11dGFibGVJbnB1dEVkaXRvciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc2FibGVkXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kaXNhYmxlZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicmVhZE9ubHlcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRPbmx5O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbW11dGFibGVJbnB1dEVkaXRvcjtcbiAgICAgICAgICB9KFNtYWxsRGlhbG9nSW5wdXRFZGl0b3JfMS5TbWFsbERpYWxvZ0lucHV0RWRpdG9yKTtcblxuICAgICAgICAgIGV4cG9ydHMuQUNUSU9OUyA9IHtcbiAgICAgICAgICAgIENIRUNLOiBuZXcgSW1tdXRhYmxlQ2hlY2tFZGl0b3IoKSxcbiAgICAgICAgICAgIElOUFVUOiBuZXcgSW1tdXRhYmxlSW5wdXRFZGl0b3IoKSxcbiAgICAgICAgICAgIFJBRElPOiBuZXcgSW1tdXRhYmxlUmFkaW9FZGl0b3IoKVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBmdW5jdGlvbiBvZihjb2x1bW5BY3Rpb24pIHtcbiAgICAgICAgICAgIGlmICghY29sdW1uQWN0aW9uKSB7XG4gICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb2x1bW5BY3Rpb24gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgdmFyIGtleSA9IGNvbHVtbkFjdGlvbi50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5BQ1RJT05TW2tleV0gfHwgb2YobnVsbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gY29sdW1uQWN0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMub2YgPSBvZjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9BY3Rpb24uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9hY3Rpb24vQWN0aW9uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNBY3Rpb25BY3Rpb25Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkFjdGlvbiA9IGV4cG9ydHMuQWJzdHJhY3RBY3Rpb24gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgYWN0aW9uQmluZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb25CaW5kICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL2FjdGlvbkJpbmQuanNcIik7XG5cbiAgICAgICAgICB2YXIgQmFzZUFjdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlQWN0aW9uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL0Jhc2VBY3Rpb24uanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGFjdGlvbl91dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb24tdXRpbHMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vYWN0aW9uLXV0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEFic3RyYWN0QWN0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZUFjdGlvbl8xJEJhc2VBY3QpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhBYnN0cmFjdEFjdGlvbiwgX0Jhc2VBY3Rpb25fMSRCYXNlQWN0KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjUgPSBfY3JlYXRlU3VwZXIoQWJzdHJhY3RBY3Rpb24pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBBYnN0cmFjdEFjdGlvbigpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzMTQ7XG5cbiAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFic3RyYWN0QWN0aW9uKTtcblxuICAgICAgICAgICAgICBfdGhpczE0ID0gX3N1cGVyNS5jYWxsKHRoaXMsIG9wdGlvbik7XG5cbiAgICAgICAgICAgICAgX3RoaXMxNC5fYWN0aW9uID0gb3B0aW9uLmFjdGlvbiB8fCBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEFic3RyYWN0QWN0aW9uLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiZWRpdGFibGVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhY3Rpb25cIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGlvbjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJiaW5kR3JpZEV2ZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kR3JpZEV2ZW50KGdyaWQsIGNlbGxJZCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczE1ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IHRoaXMuZ2V0U3RhdGUoZ3JpZCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gZnVuY3Rpb24gYWN0aW9uKGNlbGwpIHtcbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgYWN0aW9uX3V0aWxzXzEuaXNEaXNhYmxlZFJlY29yZCkoX3RoaXMxNS5kaXNhYmxlZCwgZ3JpZCwgY2VsbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IGdyaWQuZ2V0Um93UmVjb3JkKGNlbGwucm93KTtcblxuICAgICAgICAgICAgICAgICAgX3RoaXMxNS5fYWN0aW9uKHJlY29yZCwgKDAsIHV0aWxzXzEuZXh0ZW5kKShjZWxsLCB7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQ6IGdyaWRcbiAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoKDAsIGFjdGlvbkJpbmRfMS5iaW5kQ2VsbENsaWNrQWN0aW9uKShncmlkLCBjZWxsSWQsIHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgICAgbW91c2VPdmVyOiBmdW5jdGlvbiBtb3VzZU92ZXIoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKF90aGlzMTUuZGlzYWJsZWQsIGdyaWQsIGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlQWN0aXZlQ2VsbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb2w6IGUuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogZS5yb3dcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoZS5jb2wsIGUucm93KTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5pbnZhbGlkYXRlQ2VsbFJhbmdlKHJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgbW91c2VPdXQ6IGZ1bmN0aW9uIG1vdXNlT3V0KGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLm1vdXNlQWN0aXZlQ2VsbDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoZS5jb2wsIGUucm93KTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5pbnZhbGlkYXRlQ2VsbFJhbmdlKHJhbmdlKTtcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBhcmVhOiBmdW5jdGlvbiBhcmVhKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpczE1LmFyZWEpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBldmVudCA9IGUuZXZlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjbGllbnRYID0gZXZlbnQuY2xpZW50WCB8fCBldmVudC5wYWdlWCArIHdpbmRvdy5zY3JvbGxYO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2xpZW50WSA9IGV2ZW50LmNsaWVudFkgfHwgZXZlbnQucGFnZVkgKyB3aW5kb3cuc2Nyb2xsWTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhc1JlY3QgPSBncmlkLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhJbkNhbnZhcyA9IGNsaWVudFggLSBjYW52YXNSZWN0LmxlZnQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB5SW5DYW52YXMgPSBjbGllbnRZIC0gY2FudmFzUmVjdC50b3A7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWN0ID0gZ3JpZC5nZXRDZWxsUmVjdChlLmNvbCwgZS5yb3cpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNS5hcmVhKHtcbiAgICAgICAgICAgICAgICAgICAgICBjb2w6IGUuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogZS5yb3csXG4gICAgICAgICAgICAgICAgICAgICAgZ3JpZDogZ3JpZCxcbiAgICAgICAgICAgICAgICAgICAgICBwb2ludEluQ2VsbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogeEluQ2FudmFzIC0gcmVjdC5sZWZ0ICsgZ3JpZC5zY3JvbGxMZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogeUluQ2FudmFzIC0gcmVjdC50b3AgKyBncmlkLnNjcm9sbFRvcFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcG9pbnRJbkRyYXdpbmdDYW52YXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHhJbkNhbnZhcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHlJbkNhbnZhc1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpLCBfdG9Db25zdW1hYmxlQXJyYXkoKDAsIGFjdGlvbkJpbmRfMS5iaW5kQ2VsbEtleUFjdGlvbikoZ3JpZCwgY2VsbElkLCB7XG4gICAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvblxuICAgICAgICAgICAgICAgIH0pKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uUGFzdGVDZWxsUmFuZ2VCb3hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUGFzdGVDZWxsUmFuZ2VCb3goKSB7Ly8gbm9vcFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkRlbGV0ZUNlbGxSYW5nZUJveFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25EZWxldGVDZWxsUmFuZ2VCb3goKSB7Ly8gbm9vcFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBBYnN0cmFjdEFjdGlvbjtcbiAgICAgICAgICB9KEJhc2VBY3Rpb25fMS5CYXNlQWN0aW9uKTtcblxuICAgICAgICAgIGV4cG9ydHMuQWJzdHJhY3RBY3Rpb24gPSBBYnN0cmFjdEFjdGlvbjtcblxuICAgICAgICAgIHZhciBBY3Rpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9BYnN0cmFjdEFjdGlvbikge1xuICAgICAgICAgICAgX2luaGVyaXRzKEFjdGlvbiwgX0Fic3RyYWN0QWN0aW9uKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjYgPSBfY3JlYXRlU3VwZXIoQWN0aW9uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gQWN0aW9uKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXMxNjtcblxuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQWN0aW9uKTtcblxuICAgICAgICAgICAgICBfdGhpczE2ID0gX3N1cGVyNi5jYWxsKHRoaXMsIG9wdGlvbik7XG4gICAgICAgICAgICAgIF90aGlzMTYuX2FyZWEgPSBvcHRpb24uYXJlYTtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhBY3Rpb24sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJhcmVhXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcmVhO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChhcmVhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXJlYSA9IGFyZWE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFjdGlvbih0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0U3RhdGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0YXRlKF9ncmlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBBY3Rpb247XG4gICAgICAgICAgfShBYnN0cmFjdEFjdGlvbik7XG5cbiAgICAgICAgICBleHBvcnRzLkFjdGlvbiA9IEFjdGlvbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9CYXNlQWN0aW9uLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL2FjdGlvbi9CYXNlQWN0aW9uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uQmFzZUFjdGlvbkpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQmFzZUFjdGlvbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlQWN0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIEJhc2VBY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlQWN0aW9uKTtcblxuICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlZCA9IG9wdGlvbi5kaXNhYmxlZCB8fCBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEJhc2VBY3Rpb24sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNhYmxlZFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGRpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZWQgPSBkaXNhYmxlZDtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlRGlzYWJsZWRJbnRlcm5hbCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkNoYW5nZURpc2FibGVkSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlRGlzYWJsZWRJbnRlcm5hbCgpIHsvLyBhYnN0cmFjdFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCYXNlQWN0aW9uO1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuQmFzZUFjdGlvbiA9IEJhc2VBY3Rpb247XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vQmFzZUlucHV0RWRpdG9yLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvYWN0aW9uL0Jhc2VJbnB1dEVkaXRvci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uQmFzZUlucHV0RWRpdG9ySnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5CYXNlSW5wdXRFZGl0b3IgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGFjdGlvbl91dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb24tdXRpbHMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vYWN0aW9uLXV0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIERHX0VWRU5UX1RZUEVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2NvcmUvREdfRVZFTlRfVFlQRSAqL1xuICAgICAgICAgIFwiLi9jb3JlL0RHX0VWRU5UX1RZUEUuanNcIik7XG5cbiAgICAgICAgICB2YXIgRWRpdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0VkaXRvciAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9FZGl0b3IuanNcIik7XG5cbiAgICAgICAgICB2YXIgS0VZX0VOVEVSID0gMTM7XG4gICAgICAgICAgdmFyIEtFWV9GMiA9IDExMztcblxuICAgICAgICAgIHZhciBCYXNlSW5wdXRFZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9FZGl0b3JfMSRFZGl0b3IpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhCYXNlSW5wdXRFZGl0b3IsIF9FZGl0b3JfMSRFZGl0b3IpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNyA9IF9jcmVhdGVTdXBlcihCYXNlSW5wdXRFZGl0b3IpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBCYXNlSW5wdXRFZGl0b3IoKSB7XG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlSW5wdXRFZGl0b3IpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI3LmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEJhc2VJbnB1dEVkaXRvciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImJpbmRHcmlkRXZlbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJpbmRHcmlkRXZlbnQoZ3JpZCwgY2VsbElkKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMTcgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9wZW4gPSBmdW5jdGlvbiBvcGVuKGNlbGwpIHtcbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgYWN0aW9uX3V0aWxzXzEuaXNSZWFkT25seVJlY29yZCkoX3RoaXMxNy5yZWFkT25seSwgZ3JpZCwgY2VsbC5yb3cpIHx8ICgwLCBhY3Rpb25fdXRpbHNfMS5pc0Rpc2FibGVkUmVjb3JkKShfdGhpczE3LmRpc2FibGVkLCBncmlkLCBjZWxsLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBfdGhpczE3Lm9uT3BlbkNlbGxJbnRlcm5hbChncmlkLCBjZWxsKTtcblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IGZ1bmN0aW9uIGlucHV0KGNlbGwsIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzUmVhZE9ubHlSZWNvcmQpKF90aGlzMTcucmVhZE9ubHksIGdyaWQsIGNlbGwucm93KSB8fCAoMCwgYWN0aW9uX3V0aWxzXzEuaXNEaXNhYmxlZFJlY29yZCkoX3RoaXMxNy5kaXNhYmxlZCwgZ3JpZCwgY2VsbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX3RoaXMxNy5vbklucHV0Q2VsbEludGVybmFsKGdyaWQsIGNlbGwsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNUYXJnZXQoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBncmlkLmdldExheW91dENlbGxJZChjb2wsIHJvdykgPT09IGNlbGxJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gW2dyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLklOUFVUX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KGUuY29sLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpbnB1dCh7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogZS5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogZS5yb3dcbiAgICAgICAgICAgICAgICAgIH0sIGUudmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pLCBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5QQVNURV9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGUubXVsdGkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG11bHRpIGNlbGwgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvblJhbmdlID0gZ3JpZC5zZWxlY3Rpb24ucmFuZ2U7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzEuY2VsbEVxdWFscykoc2VsZWN0aW9uUmFuZ2Uuc3RhcnQsIHNlbGVjdGlvblJhbmdlLmVuZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG11bHRpIHBhc3RlIHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHV0aWxzXzEuZXZlbnQuY2FuY2VsKGUuZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgaW5wdXQoe1xuICAgICAgICAgICAgICAgICAgICBjb2w6IGUuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IGUucm93XG4gICAgICAgICAgICAgICAgICB9LCBlLm5vcm1hbGl6ZVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KSwgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuREJMQ0xJQ0tfQ0VMTCwgZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoY2VsbC5jb2wsIGNlbGwucm93KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIG9wZW4oe1xuICAgICAgICAgICAgICAgICAgICBjb2w6IGNlbGwuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IGNlbGwucm93XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KSwgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuREJMVEFQX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KGUuY29sLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBvcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBlLnJvd1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB1dGlsc18xLmV2ZW50LmNhbmNlbChlLmV2ZW50KTtcbiAgICAgICAgICAgICAgICB9KSwgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuS0VZRE9XTiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgIT09IEtFWV9GMiAmJiBlLmtleUNvZGUgIT09IEtFWV9FTlRFUikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBzZWwgPSBncmlkLnNlbGVjdGlvbi5zZWxlY3Q7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoc2VsLmNvbCwgc2VsLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpZiAob3Blbih7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogc2VsLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBzZWwucm93XG4gICAgICAgICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgICAgICBlLnN0b3BDZWxsTW92aW5nKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLlNFTEVDVEVEX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KGUuY29sLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBfdGhpczE3Lm9uQ2hhbmdlU2VsZWN0Q2VsbEludGVybmFsKGdyaWQsIHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBlLnJvd1xuICAgICAgICAgICAgICAgICAgfSwgZS5zZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgfSksIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLlNDUk9MTCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgX3RoaXMxNy5vbkdyaWRTY3JvbGxJbnRlcm5hbChncmlkKTtcbiAgICAgICAgICAgICAgICB9KSwgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuRURJVEFCTEVJTlBVVF9DRUxMLCBmdW5jdGlvbiAoY2VsbCkge1xuICAgICAgICAgICAgICAgICAgaWYgKCFpc1RhcmdldChjZWxsLmNvbCwgY2VsbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc1JlYWRPbmx5UmVjb3JkKShfdGhpczE3LnJlYWRPbmx5LCBncmlkLCBjZWxsLnJvdykgfHwgKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKF90aGlzMTcuZGlzYWJsZWQsIGdyaWQsIGNlbGwucm93KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH0pLCBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5NT0RJRllfU1RBVFVTX0VESVRBQkxFSU5QVVRfQ0VMTCwgZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoY2VsbC5jb2wsIGNlbGwucm93KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgYWN0aW9uX3V0aWxzXzEuaXNSZWFkT25seVJlY29yZCkoX3RoaXMxNy5yZWFkT25seSwgZ3JpZCwgY2VsbC5yb3cpIHx8ICgwLCBhY3Rpb25fdXRpbHNfMS5pc0Rpc2FibGVkUmVjb3JkKShfdGhpczE3LmRpc2FibGVkLCBncmlkLCBjZWxsLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBncmlkLmdldENlbGxSYW5nZShjZWxsLmNvbCwgY2VsbC5yb3cpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAocmFuZ2Uuc3RhcnQuY29sICE9PSByYW5nZS5lbmQuY29sIHx8IHJhbmdlLnN0YXJ0LnJvdyAhPT0gcmFuZ2UuZW5kLnJvdykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2lucHV0ID0gY2VsbC5pbnB1dDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2VSZWN0ID0gZ3JpZC5nZXRDZWxsUmVjdChjZWxsLmNvbCwgY2VsbC5yb3cpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZ2VSZWN0ID0gZ3JpZC5nZXRDZWxsUmFuZ2VSZWN0KHJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgX2lucHV0LnN0eWxlLnRvcCA9IFwiXCIuY29uY2F0KChwYXJzZUZsb2F0KF9pbnB1dC5zdHlsZS50b3ApICsgKHJhbmdlUmVjdC50b3AgLSBiYXNlUmVjdC50b3ApKS50b0ZpeGVkKCksIFwicHhcIik7XG4gICAgICAgICAgICAgICAgICAgIF9pbnB1dC5zdHlsZS5sZWZ0ID0gXCJcIi5jb25jYXQoKHBhcnNlRmxvYXQoX2lucHV0LnN0eWxlLmxlZnQpICsgKHJhbmdlUmVjdC5sZWZ0IC0gYmFzZVJlY3QubGVmdCkpLnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICAgICAgX2lucHV0LnN0eWxlLndpZHRoID0gXCJcIi5jb25jYXQocmFuZ2VSZWN0LndpZHRoLnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICAgICAgX2lucHV0LnN0eWxlLmhlaWdodCA9IFwiXCIuY29uY2F0KHJhbmdlUmVjdC5oZWlnaHQudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBfdGhpczE3Lm9uU2V0SW5wdXRBdHRyc0ludGVybmFsKGdyaWQsIHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjZWxsLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBjZWxsLnJvd1xuICAgICAgICAgICAgICAgICAgfSwgY2VsbC5pbnB1dCk7XG4gICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvblBhc3RlQ2VsbFJhbmdlQm94XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvblBhc3RlQ2VsbFJhbmdlQm94KGdyaWQsIGNlbGwsIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMTggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc1JlYWRPbmx5UmVjb3JkKSh0aGlzLnJlYWRPbmx5LCBncmlkLCBjZWxsLnJvdykgfHwgKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKHRoaXMuZGlzYWJsZWQsIGdyaWQsIGNlbGwucm93KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGdyaWQuZG9DaGFuZ2VWYWx1ZShjZWxsLmNvbCwgY2VsbC5yb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczE4LmlzU3VwcG9ydE11bHRpbGluZVZhbHVlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvXFxyP1xcbi9nLCBcIiBcIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uRGVsZXRlQ2VsbFJhbmdlQm94XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRlbGV0ZUNlbGxSYW5nZUJveChncmlkLCBjZWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc1JlYWRPbmx5UmVjb3JkKSh0aGlzLnJlYWRPbmx5LCBncmlkLCBjZWxsLnJvdykgfHwgKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKHRoaXMuZGlzYWJsZWQsIGdyaWQsIGNlbGwucm93KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGdyaWQuZG9DaGFuZ2VWYWx1ZShjZWxsLmNvbCwgY2VsbC5yb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJpc1N1cHBvcnRNdWx0aWxpbmVWYWx1ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNTdXBwb3J0TXVsdGlsaW5lVmFsdWUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCYXNlSW5wdXRFZGl0b3I7XG4gICAgICAgICAgfShFZGl0b3JfMS5FZGl0b3IpO1xuXG4gICAgICAgICAgZXhwb3J0cy5CYXNlSW5wdXRFZGl0b3IgPSBCYXNlSW5wdXRFZGl0b3I7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vQnV0dG9uQWN0aW9uLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvYWN0aW9uL0J1dHRvbkFjdGlvbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uQnV0dG9uQWN0aW9uSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5CdXR0b25BY3Rpb24gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQWN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0FjdGlvbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9BY3Rpb24uanNcIik7XG5cbiAgICAgICAgICB2YXIgc3ltYm9sTWFuYWdlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBCVVRUT05fQ09MVU1OX1NUQVRFX0lEID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRCdXR0b25Db2x1bW5TdGF0ZUlkKSgpO1xuXG4gICAgICAgICAgdmFyIEJ1dHRvbkFjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0FjdGlvbl8xJEFic3RyYWN0QWN0KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQnV0dG9uQWN0aW9uLCBfQWN0aW9uXzEkQWJzdHJhY3RBY3QpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyOCA9IF9jcmVhdGVTdXBlcihCdXR0b25BY3Rpb24pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBCdXR0b25BY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCdXR0b25BY3Rpb24pO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI4LmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEJ1dHRvbkFjdGlvbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImFyZWFcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoX2FyZWEpIHsvLyBub29wXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJ1dHRvbkFjdGlvbih0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0U3RhdGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0YXRlKGdyaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmlkW0JVVFRPTl9DT0xVTU5fU1RBVEVfSURdO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgc3RhdGUgPSB7fTtcbiAgICAgICAgICAgICAgICAgIHV0aWxzXzEub2JqLnNldFJlYWRvbmx5KGdyaWQsIEJVVFRPTl9DT0xVTU5fU1RBVEVfSUQsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEJ1dHRvbkFjdGlvbjtcbiAgICAgICAgICB9KEFjdGlvbl8xLkFic3RyYWN0QWN0aW9uKTtcblxuICAgICAgICAgIGV4cG9ydHMuQnV0dG9uQWN0aW9uID0gQnV0dG9uQWN0aW9uO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL0NoZWNrRWRpdG9yLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9hY3Rpb24vQ2hlY2tFZGl0b3IuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uQ2hlY2tFZGl0b3JKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkNoZWNrRWRpdG9yID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGFjdGlvbkJpbmRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uQmluZCAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9hY3Rpb25CaW5kLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBhY3Rpb25fdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uLXV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL2FjdGlvbi11dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBER19FVkVOVF9UWVBFXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9jb3JlL0RHX0VWRU5UX1RZUEUgKi9cbiAgICAgICAgICBcIi4vY29yZS9ER19FVkVOVF9UWVBFLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEVkaXRvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9FZGl0b3IgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vRWRpdG9yLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGFuaW1hdGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL2FuaW1hdGUgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvYW5pbWF0ZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgQ0hFQ0tfQ09MVU1OX1NUQVRFX0lEID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRDaGVja0NvbHVtblN0YXRlSWQpKCk7XG5cbiAgICAgICAgICB2YXIgQ2hlY2tFZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9FZGl0b3JfMSRFZGl0b3IyKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQ2hlY2tFZGl0b3IsIF9FZGl0b3JfMSRFZGl0b3IyKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjkgPSBfY3JlYXRlU3VwZXIoQ2hlY2tFZGl0b3IpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBDaGVja0VkaXRvcigpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENoZWNrRWRpdG9yKTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3N1cGVyOS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQ2hlY2tFZGl0b3IsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGVja0VkaXRvcih0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYmluZEdyaWRFdmVudFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZEdyaWRFdmVudChncmlkLCBjZWxsSWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxOSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgX3N0YXRlID0gZ3JpZFtDSEVDS19DT0xVTU5fU1RBVEVfSURdO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFfc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgIF9zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2s6IHt9LFxuICAgICAgICAgICAgICAgICAgICBlbGFwc2VkOiB7fVxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIHV0aWxzXzEub2JqLnNldFJlYWRvbmx5KGdyaWQsIENIRUNLX0NPTFVNTl9TVEFURV9JRCwgX3N0YXRlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBfc3RhdGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2FjdGlvbiA9IGZ1bmN0aW9uIGFjdGlvbihjZWxsKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBncmlkLmdldENlbGxSYW5nZShjZWxsLmNvbCwgY2VsbC5yb3cpO1xuICAgICAgICAgICAgICAgICAgdmFyIGNlbGxLZXkgPSBcIlwiLmNvbmNhdChyYW5nZS5zdGFydC5jb2wsIFwiOlwiKS5jb25jYXQocmFuZ2Uuc3RhcnQucm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc1JlYWRPbmx5UmVjb3JkKShfdGhpczE5LnJlYWRPbmx5LCBncmlkLCBjZWxsLnJvdykgfHwgKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKF90aGlzMTkuZGlzYWJsZWQsIGdyaWQsIGNlbGwucm93KSB8fCBzdGF0ZS5ibG9ja1tjZWxsS2V5XSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciByZXQgPSBncmlkLmRvQ2hhbmdlVmFsdWUoY2VsbC5jb2wsIGNlbGwucm93LCBhY3Rpb25fdXRpbHNfMS50b2dnbGVWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9uQ2hhbmdlID0gZnVuY3Rpb24gb25DaGFuZ2UoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2tib3ggYW5pbWF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgKDAsIGFuaW1hdGVfMS5hbmltYXRlKSgyMDAsIGZ1bmN0aW9uIChwb2ludCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5lbGFwc2VkW2NlbGxLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZWxhcHNlZFtjZWxsS2V5XSA9IHBvaW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGVDZWxsUmFuZ2UocmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKHJldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ibG9ja1tjZWxsS2V5XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0LnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLmJsb2NrW2NlbGxLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzVGFyZ2V0KGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZ3JpZC5nZXRMYXlvdXRDZWxsSWQoY29sLCByb3cpID09PSBjZWxsSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoKDAsIGFjdGlvbkJpbmRfMS5iaW5kQ2VsbENsaWNrQWN0aW9uKShncmlkLCBjZWxsSWQsIHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbjogX2FjdGlvbixcbiAgICAgICAgICAgICAgICAgIG1vdXNlT3ZlcjogZnVuY3Rpb24gbW91c2VPdmVyKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc0Rpc2FibGVkUmVjb3JkKShfdGhpczE5LmRpc2FibGVkLCBncmlkLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZUFjdGl2ZUNlbGwgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3c6IGUucm93XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGdyaWQuZ2V0Q2VsbFJhbmdlKGUuY29sLCBlLnJvdyk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIG1vdXNlT3V0OiBmdW5jdGlvbiBtb3VzZU91dChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5tb3VzZUFjdGl2ZUNlbGw7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGdyaWQuZ2V0Q2VsbFJhbmdlKGUuY29sLCBlLnJvdyk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpLCBfdG9Db25zdW1hYmxlQXJyYXkoKDAsIGFjdGlvbkJpbmRfMS5iaW5kQ2VsbEtleUFjdGlvbikoZ3JpZCwgY2VsbElkLCB7XG4gICAgICAgICAgICAgICAgICBhY3Rpb246IGZ1bmN0aW9uIGFjdGlvbihfZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VscmFuZ2UgPSBncmlkLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IGdyaWQuc2VsZWN0aW9uLnNlbGVjdC5jb2w7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcm93ID0gc2VscmFuZ2Uuc3RhcnQucm93OyByb3cgPD0gc2VscmFuZ2UuZW5kLnJvdzsgcm93KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KGNvbCwgcm93KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSksIFsvLyBwYXN0ZSB2YWx1ZVxuICAgICAgICAgICAgICAgIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLlBBU1RFX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZS5tdWx0aSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgbXVsdGkgY2VsbCB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0aW9uUmFuZ2UgPSBncmlkLnNlbGVjdGlvbi5yYW5nZTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCEoMCwgdXRpbHNfMS5jZWxsRXF1YWxzKShzZWxlY3Rpb25SYW5nZS5zdGFydCwgc2VsZWN0aW9uUmFuZ2UuZW5kKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgbXVsdGkgcGFzdGUgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWYgKCFpc1RhcmdldChlLmNvbCwgZS5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZS5ldmVudCk7XG4gICAgICAgICAgICAgICAgICB2YXIgcGFzdGVWYWx1ZSA9IGUubm9ybWFsaXplVmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgZ3JpZC5kb0dldENlbGxWYWx1ZShlLmNvbCwgZS5yb3csIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSAoMCwgYWN0aW9uX3V0aWxzXzEudG9nZ2xlVmFsdWUpKHZhbHVlKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJcIi5jb25jYXQobmV3VmFsdWUpLnRyaW0oKSA9PT0gcGFzdGVWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgIF9hY3Rpb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogZS5yb3dcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc1JlamVjdFZhbHVlKHZhbHVlLCBwYXN0ZVZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSBncmlkLmdldFJvd1JlY29yZChlLnJvdyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICBpZiAoISgwLCB1dGlsc18xLmlzUHJvbWlzZSkocmVjb3JkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKFwicmVqZWN0ZWRfcGFzdGVfdmFsdWVzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbDogZS5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93OiBlLnJvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNvcmQ6IHJlY29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmU6IGdyaWQuZ2V0Q29sdW1uRGVmaW5lKGUuY29sLCBlLnJvdyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGVWYWx1ZTogcGFzdGVWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KV0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvblBhc3RlQ2VsbFJhbmdlQm94XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvblBhc3RlQ2VsbFJhbmdlQm94KGdyaWQsIGNlbGwsIHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc1JlYWRPbmx5UmVjb3JkKSh0aGlzLnJlYWRPbmx5LCBncmlkLCBjZWxsLnJvdykgfHwgKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKHRoaXMuZGlzYWJsZWQsIGdyaWQsIGNlbGwucm93KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwYXN0ZVZhbHVlID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgIGdyaWQuZG9HZXRDZWxsVmFsdWUoY2VsbC5jb2wsIGNlbGwucm93LCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9ICgwLCBhY3Rpb25fdXRpbHNfMS50b2dnbGVWYWx1ZSkodmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoXCJcIi5jb25jYXQobmV3VmFsdWUpLnRyaW0oKSA9PT0gcGFzdGVWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBncmlkLmRvQ2hhbmdlVmFsdWUoY2VsbC5jb2wsIGNlbGwucm93LCBhY3Rpb25fdXRpbHNfMS50b2dnbGVWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzUmVqZWN0VmFsdWUodmFsdWUsIHBhc3RlVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVqZWN0KCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uRGVsZXRlQ2VsbFJhbmdlQm94XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRlbGV0ZUNlbGxSYW5nZUJveCgpIHsvLyBub29wXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIENoZWNrRWRpdG9yO1xuICAgICAgICAgIH0oRWRpdG9yXzEuRWRpdG9yKTtcblxuICAgICAgICAgIGV4cG9ydHMuQ2hlY2tFZGl0b3IgPSBDaGVja0VkaXRvcjtcblxuICAgICAgICAgIGZ1bmN0aW9uIGlzUmVqZWN0VmFsdWUob2xkVmFsdWUsIHBhc3RlVmFsdWUpIHtcbiAgICAgICAgICAgIGlmICgob2xkVmFsdWUgIT0gbnVsbCA/IFwiXCIuY29uY2F0KG9sZFZhbHVlKS50cmltKCkgOiBcIlwiKSA9PT0gcGFzdGVWYWx1ZSkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9ICgwLCBhY3Rpb25fdXRpbHNfMS50b2dnbGVWYWx1ZSkob2xkVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KG5ld1ZhbHVlKS50cmltKCkgIT09IHBhc3RlVmFsdWUgJiYgXCJcIi5jb25jYXQoKDAsIGFjdGlvbl91dGlsc18xLnRvZ2dsZVZhbHVlKShuZXdWYWx1ZSkpLnRyaW0oKSAhPT0gcGFzdGVWYWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqKi9cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9FZGl0b3IuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9hY3Rpb24vRWRpdG9yLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNBY3Rpb25FZGl0b3JKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkVkaXRvciA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlQWN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VBY3Rpb24gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vQmFzZUFjdGlvbi5qc1wiKTtcblxuICAgICAgICAgIHZhciBFZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlQWN0aW9uXzEkQmFzZUFjdDIpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhFZGl0b3IsIF9CYXNlQWN0aW9uXzEkQmFzZUFjdDIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMTAgPSBfY3JlYXRlU3VwZXIoRWRpdG9yKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gRWRpdG9yKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXMyMDtcblxuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRWRpdG9yKTtcblxuICAgICAgICAgICAgICBfdGhpczIwID0gX3N1cGVyMTAuY2FsbCh0aGlzLCBvcHRpb24pO1xuICAgICAgICAgICAgICBfdGhpczIwLl9yZWFkT25seSA9IG9wdGlvbi5yZWFkT25seSB8fCBmYWxzZTtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhFZGl0b3IsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJlZGl0YWJsZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicmVhZE9ubHlcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRPbmx5O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChyZWFkT25seSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRPbmx5ID0gcmVhZE9ubHk7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZVJlYWRPbmx5SW50ZXJuYWwoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25DaGFuZ2VSZWFkT25seUludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZVJlYWRPbmx5SW50ZXJuYWwoKSB7Ly8gYWJzdHJ1Y3RcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gRWRpdG9yO1xuICAgICAgICAgIH0oQmFzZUFjdGlvbl8xLkJhc2VBY3Rpb24pO1xuXG4gICAgICAgICAgZXhwb3J0cy5FZGl0b3IgPSBFZGl0b3I7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vSW5saW5lSW5wdXRFZGl0b3IuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL2FjdGlvbi9JbmxpbmVJbnB1dEVkaXRvci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNBY3Rpb25JbmxpbmVJbnB1dEVkaXRvckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuSW5saW5lSW5wdXRFZGl0b3IgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQmFzZUlucHV0RWRpdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VJbnB1dEVkaXRvciAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9CYXNlSW5wdXRFZGl0b3IuanNcIik7XG5cbiAgICAgICAgICB2YXIgSW5saW5lSW5wdXRFbGVtZW50XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL0lubGluZUlucHV0RWxlbWVudCAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVJbnB1dEVsZW1lbnQuanNcIik7XG5cbiAgICAgICAgICB2YXIgc3ltYm9sTWFuYWdlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBfID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRJbmxpbmVJbnB1dEVkaXRvclN0YXRlSWQpKCk7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRTdGF0ZShncmlkKSB7XG4gICAgICAgICAgICB2YXIgc3RhdGUgPSBncmlkW19dO1xuXG4gICAgICAgICAgICBpZiAoIXN0YXRlKSB7XG4gICAgICAgICAgICAgIHN0YXRlID0ge307XG4gICAgICAgICAgICAgIHV0aWxzXzEub2JqLnNldFJlYWRvbmx5KGdyaWQsIF8sIHN0YXRlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuXG4gICAgICAgICAgdmFyIGdsb2JhbEVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgIHZhciBiaW5kR3JpZENvdW50ID0gMDtcblxuICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaElucHV0KGdyaWQsIGNlbGwsIGVkaXRvciwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdldFN0YXRlKGdyaWQpO1xuXG4gICAgICAgICAgICBpZiAoIWdsb2JhbEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgZ2xvYmFsRWxlbWVudCA9IG5ldyBJbmxpbmVJbnB1dEVsZW1lbnRfMS5JbmxpbmVJbnB1dEVsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFzdGF0ZS5lbGVtZW50KSB7XG4gICAgICAgICAgICAgIHN0YXRlLmVsZW1lbnQgPSBnbG9iYWxFbGVtZW50O1xuICAgICAgICAgICAgICBiaW5kR3JpZENvdW50Kys7XG4gICAgICAgICAgICAgIGdyaWQuYWRkRGlzcG9zYWJsZSh7XG4gICAgICAgICAgICAgICAgZGlzcG9zZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgICAgICAgICAgIGJpbmRHcmlkQ291bnQtLTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCFiaW5kR3JpZENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbEVsZW1lbnQgPT09IG51bGwgfHwgZ2xvYmFsRWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ2xvYmFsRWxlbWVudC5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbEVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5lbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnbG9iYWxFbGVtZW50LmF0dGFjaChncmlkLCBlZGl0b3IsIGNlbGwuY29sLCBjZWxsLnJvdywgdmFsdWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGRldGFjaElucHV0KGdyaWRGb2N1cykge1xuICAgICAgICAgICAgaWYgKGdsb2JhbEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgZ2xvYmFsRWxlbWVudC5kZXRhY2goZ3JpZEZvY3VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBkb0NoYW5nZVZhbHVlKF9ncmlkKSB7XG4gICAgICAgICAgICBpZiAoZ2xvYmFsRWxlbWVudCkge1xuICAgICAgICAgICAgICBnbG9iYWxFbGVtZW50LmRvQ2hhbmdlVmFsdWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgSW5saW5lSW5wdXRFZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlSW5wdXRFZGl0b3JfMSRCYSkge1xuICAgICAgICAgICAgX2luaGVyaXRzKElubGluZUlucHV0RWRpdG9yLCBfQmFzZUlucHV0RWRpdG9yXzEkQmEpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMTEgPSBfY3JlYXRlU3VwZXIoSW5saW5lSW5wdXRFZGl0b3IpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBJbmxpbmVJbnB1dEVkaXRvcigpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzMjE7XG5cbiAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElubGluZUlucHV0RWRpdG9yKTtcblxuICAgICAgICAgICAgICBfdGhpczIxID0gX3N1cGVyMTEuY2FsbCh0aGlzLCBvcHRpb24pO1xuICAgICAgICAgICAgICBfdGhpczIxLl9jbGFzc0xpc3QgPSBvcHRpb24uY2xhc3NMaXN0O1xuICAgICAgICAgICAgICBfdGhpczIxLl90eXBlID0gb3B0aW9uLnR5cGU7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczIxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSW5saW5lSW5wdXRFZGl0b3IsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjbGFzc0xpc3RcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodGhpcy5fY2xhc3NMaXN0KSA/IHRoaXMuX2NsYXNzTGlzdCA6IFt0aGlzLl9jbGFzc0xpc3RdO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGFzc0xpc3QgPSBjbGFzc0xpc3Q7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInR5cGVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHR5cGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90eXBlID0gdHlwZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW5saW5lSW5wdXRFZGl0b3IodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uSW5wdXRDZWxsSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uSW5wdXRDZWxsSW50ZXJuYWwoZ3JpZCwgY2VsbCwgaW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGF0dGFjaElucHV0KGdyaWQsIGNlbGwsIHRoaXMsIGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbk9wZW5DZWxsSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uT3BlbkNlbGxJbnRlcm5hbChncmlkLCBjZWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMjIgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZ3JpZC5kb0dldENlbGxWYWx1ZShjZWxsLmNvbCwgY2VsbC5yb3csIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgYXR0YWNoSW5wdXQoZ3JpZCwgY2VsbCwgX3RoaXMyMiwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkNoYW5nZVNlbGVjdENlbGxJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2VTZWxlY3RDZWxsSW50ZXJuYWwoZ3JpZCwgX2NlbGwsIF9zZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgIGRvQ2hhbmdlVmFsdWUoZ3JpZCk7XG4gICAgICAgICAgICAgICAgZGV0YWNoSW5wdXQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25HcmlkU2Nyb2xsSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uR3JpZFNjcm9sbEludGVybmFsKGdyaWQpIHtcbiAgICAgICAgICAgICAgICBkb0NoYW5nZVZhbHVlKGdyaWQpO1xuICAgICAgICAgICAgICAgIGRldGFjaElucHV0KHRydWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkNoYW5nZURpc2FibGVkSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlRGlzYWJsZWRJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgICAgICAvLyBjYW5jZWwgaW5wdXRcbiAgICAgICAgICAgICAgICBkZXRhY2hJbnB1dCh0cnVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25DaGFuZ2VSZWFkT25seUludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZVJlYWRPbmx5SW50ZXJuYWwoKSB7XG4gICAgICAgICAgICAgICAgLy8gY2FuY2VsIGlucHV0XG4gICAgICAgICAgICAgICAgZGV0YWNoSW5wdXQodHJ1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uU2V0SW5wdXRBdHRyc0ludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvblNldElucHV0QXR0cnNJbnRlcm5hbChncmlkLCBfY2VsbCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICBJbmxpbmVJbnB1dEVsZW1lbnRfMS5JbmxpbmVJbnB1dEVsZW1lbnQuc2V0SW5wdXRBdHRycyh0aGlzLCBncmlkLCBpbnB1dCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIElubGluZUlucHV0RWRpdG9yO1xuICAgICAgICAgIH0oQmFzZUlucHV0RWRpdG9yXzEuQmFzZUlucHV0RWRpdG9yKTtcblxuICAgICAgICAgIGV4cG9ydHMuSW5saW5lSW5wdXRFZGl0b3IgPSBJbmxpbmVJbnB1dEVkaXRvcjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9JbmxpbmVNZW51RWRpdG9yLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL2FjdGlvbi9JbmxpbmVNZW51RWRpdG9yLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uSW5saW5lTWVudUVkaXRvckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuSW5saW5lTWVudUVkaXRvciA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgYWN0aW9uX3V0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2FjdGlvbi11dGlscyAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9hY3Rpb24tdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgREdfRVZFTlRfVFlQRV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vY29yZS9ER19FVkVOVF9UWVBFICovXG4gICAgICAgICAgXCIuL2NvcmUvREdfRVZFTlRfVFlQRS5qc1wiKTtcblxuICAgICAgICAgIHZhciBFZGl0b3JfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vRWRpdG9yICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL0VkaXRvci5qc1wiKTtcblxuICAgICAgICAgIHZhciBJbmxpbmVNZW51RWxlbWVudF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC9JbmxpbmVNZW51RWxlbWVudCAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVNZW51RWxlbWVudC5qc1wiKTtcblxuICAgICAgICAgIHZhciB0eXBlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi90eXBlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgbWVudV9pdGVtc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvbWVudS1pdGVtcyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9tZW51LWl0ZW1zLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIF8gPSAoMCwgc3ltYm9sTWFuYWdlcl8xLmdldElubGluZU1lbnVFZGl0b3JTdGF0ZUlkKSgpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0U3RhdGUoZ3JpZCkge1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JpZFtfXTtcblxuICAgICAgICAgICAgaWYgKCFzdGF0ZSkge1xuICAgICAgICAgICAgICBzdGF0ZSA9IHt9O1xuICAgICAgICAgICAgICB1dGlsc18xLm9iai5zZXRSZWFkb25seShncmlkLCBfLCBzdGF0ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cblxuICAgICAgICAgIHZhciBnbG9iYWxFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICB2YXIgYmluZEdyaWRDb3VudCA9IDA7XG5cbiAgICAgICAgICBmdW5jdGlvbiBhdHRhY2hNZW51KGdyaWQsIGNlbGwsIGVkaXRvciwgdmFsdWUsIHJlY29yZCkge1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gZ2V0U3RhdGUoZ3JpZCk7XG5cbiAgICAgICAgICAgIGlmICghZ2xvYmFsRWxlbWVudCkge1xuICAgICAgICAgICAgICBnbG9iYWxFbGVtZW50ID0gbmV3IElubGluZU1lbnVFbGVtZW50XzEuSW5saW5lTWVudUVsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFzdGF0ZS5lbGVtZW50KSB7XG4gICAgICAgICAgICAgIHN0YXRlLmVsZW1lbnQgPSBnbG9iYWxFbGVtZW50O1xuICAgICAgICAgICAgICBiaW5kR3JpZENvdW50Kys7XG4gICAgICAgICAgICAgIGdyaWQuYWRkRGlzcG9zYWJsZSh7XG4gICAgICAgICAgICAgICAgZGlzcG9zZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgICAgICAgICAgIGJpbmRHcmlkQ291bnQtLTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCFiaW5kR3JpZENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbEVsZW1lbnQgPT09IG51bGwgfHwgZ2xvYmFsRWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ2xvYmFsRWxlbWVudC5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbEVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5lbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnbG9iYWxFbGVtZW50LmF0dGFjaChncmlkLCBlZGl0b3IsIGNlbGwuY29sLCBjZWxsLnJvdywgdmFsdWUsIHJlY29yZCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZGV0YWNoTWVudShncmlkRm9jdXMpIHtcbiAgICAgICAgICAgIGlmIChnbG9iYWxFbGVtZW50KSB7XG4gICAgICAgICAgICAgIGdsb2JhbEVsZW1lbnQuZGV0YWNoKGdyaWRGb2N1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIEtFWV9FTlRFUiA9IDEzO1xuICAgICAgICAgIHZhciBLRVlfRjIgPSAxMTM7XG5cbiAgICAgICAgICB2YXIgSW5saW5lTWVudUVkaXRvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0VkaXRvcl8xJEVkaXRvcjMpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhJbmxpbmVNZW51RWRpdG9yLCBfRWRpdG9yXzEkRWRpdG9yMyk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXIxMiA9IF9jcmVhdGVTdXBlcihJbmxpbmVNZW51RWRpdG9yKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gSW5saW5lTWVudUVkaXRvcigpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzMjM7XG5cbiAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElubGluZU1lbnVFZGl0b3IpO1xuXG4gICAgICAgICAgICAgIF90aGlzMjMgPSBfc3VwZXIxMi5jYWxsKHRoaXMsIG9wdGlvbik7XG4gICAgICAgICAgICAgIF90aGlzMjMuX2NsYXNzTGlzdCA9IG9wdGlvbi5jbGFzc0xpc3Q7XG4gICAgICAgICAgICAgIF90aGlzMjMuX29wdGlvbnMgPSAoMCwgbWVudV9pdGVtc18xLm5vcm1hbGl6ZVRvRm4pKG9wdGlvbi5vcHRpb25zKTtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbmxpbmVNZW51RWRpdG9yLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiZGlzcG9zZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHsvLyBub29wXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsYXNzTGlzdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NsYXNzTGlzdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLl9jbGFzc0xpc3QpID8gdGhpcy5fY2xhc3NMaXN0IDogW3RoaXMuX2NsYXNzTGlzdF07XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNsYXNzTGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NsYXNzTGlzdCA9IGNsYXNzTGlzdDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMgPSAoMCwgbWVudV9pdGVtc18xLm5vcm1hbGl6ZVRvRm4pKG9wdGlvbnMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJbmxpbmVNZW51RWRpdG9yKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkNoYW5nZURpc2FibGVkSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlRGlzYWJsZWRJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgICAgICAvLyBjYW5jZWwgaW5wdXRcbiAgICAgICAgICAgICAgICBkZXRhY2hNZW51KHRydWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkNoYW5nZVJlYWRPbmx5SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlUmVhZE9ubHlJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgICAgICAvLyBjYW5jZWwgaW5wdXRcbiAgICAgICAgICAgICAgICBkZXRhY2hNZW51KHRydWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJiaW5kR3JpZEV2ZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kR3JpZEV2ZW50KGdyaWQsIGNlbGxJZCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczI0ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBvcGVuID0gZnVuY3Rpb24gb3BlbihjZWxsKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzUmVhZE9ubHlSZWNvcmQpKF90aGlzMjQucmVhZE9ubHksIGdyaWQsIGNlbGwucm93KSB8fCAoMCwgYWN0aW9uX3V0aWxzXzEuaXNEaXNhYmxlZFJlY29yZCkoX3RoaXMyNC5kaXNhYmxlZCwgZ3JpZCwgY2VsbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgZ3JpZC5kb0dldENlbGxWYWx1ZShjZWxsLmNvbCwgY2VsbC5yb3csIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gZ3JpZC5nZXRSb3dSZWNvcmQoY2VsbC5yb3cpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKHJlY29yZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBhdHRhY2hNZW51KGdyaWQsIGNlbGwsIF90aGlzMjQsIHZhbHVlLCByZWNvcmQpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNUYXJnZXQoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBncmlkLmdldExheW91dENlbGxJZChjb2wsIHJvdykgPT09IGNlbGxJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gW2dyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLkNMSUNLX0NFTEwsIGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KGNlbGwuY29sLCBjZWxsLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBvcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjZWxsLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBjZWxsLnJvd1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSksIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLktFWURPV04sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlICE9PSBLRVlfRjIgJiYgZS5rZXlDb2RlICE9PSBLRVlfRU5URVIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgc2VsID0gZ3JpZC5zZWxlY3Rpb24uc2VsZWN0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KHNlbC5jb2wsIHNlbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWYgKG9wZW4oe1xuICAgICAgICAgICAgICAgICAgICBjb2w6IHNlbC5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogc2VsLnJvd1xuICAgICAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wQ2VsbE1vdmluZygpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLCBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5TRUxFQ1RFRF9DRUxMLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICAgIGRldGFjaE1lbnUoKTtcbiAgICAgICAgICAgICAgICB9KSwgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuU0NST0xMLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBkZXRhY2hNZW51KHRydWUpO1xuICAgICAgICAgICAgICAgIH0pLCAvLyBtb3VzZSBtb3ZlXG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuTU9VU0VPVkVSX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KGUuY29sLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzUmVhZE9ubHlSZWNvcmQpKF90aGlzMjQucmVhZE9ubHksIGdyaWQsIGUucm93KSB8fCAoMCwgYWN0aW9uX3V0aWxzXzEuaXNEaXNhYmxlZFJlY29yZCkoX3RoaXMyNC5kaXNhYmxlZCwgZ3JpZCwgZS5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgZ3JpZC5nZXRFbGVtZW50KCkuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gICAgICAgICAgICAgICAgfSksIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLk1PVVNFTU9WRV9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKCFpc1RhcmdldChlLmNvbCwgZS5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc1JlYWRPbmx5UmVjb3JkKShfdGhpczI0LnJlYWRPbmx5LCBncmlkLCBlLnJvdykgfHwgKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKF90aGlzMjQuZGlzYWJsZWQsIGdyaWQsIGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmICghZ3JpZC5nZXRFbGVtZW50KCkuc3R5bGUuY3Vyc29yKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQuZ2V0RWxlbWVudCgpLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLCBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5NT1VTRU9VVF9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKCFpc1RhcmdldChlLmNvbCwgZS5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgZ3JpZC5nZXRFbGVtZW50KCkuc3R5bGUuY3Vyc29yID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9KSwgLy8gcGFzdGUgdmFsdWVcbiAgICAgICAgICAgICAgICBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5QQVNURV9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGUubXVsdGkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG11bHRpIGNlbGwgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvblJhbmdlID0gZ3JpZC5zZWxlY3Rpb24ucmFuZ2U7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzEuY2VsbEVxdWFscykoc2VsZWN0aW9uUmFuZ2Uuc3RhcnQsIHNlbGVjdGlvblJhbmdlLmVuZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG11bHRpIHBhc3RlIHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgYWN0aW9uX3V0aWxzXzEuaXNSZWFkT25seVJlY29yZCkoX3RoaXMyNC5yZWFkT25seSwgZ3JpZCwgZS5yb3cpIHx8ICgwLCBhY3Rpb25fdXRpbHNfMS5pc0Rpc2FibGVkUmVjb3JkKShfdGhpczI0LmRpc2FibGVkLCBncmlkLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gZ3JpZC5nZXRSb3dSZWNvcmQoZS5yb3cpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoKDAsIHV0aWxzXzEuaXNQcm9taXNlKShyZWNvcmQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIHBhc3RlT3B0ID0gX3RoaXMyNC5fcGFzdGVEYXRhVG9PcHRpb25WYWx1ZShlLm5vcm1hbGl6ZVZhbHVlLCBncmlkLCBlLCByZWNvcmQpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAocGFzdGVPcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZS5ldmVudCk7XG4gICAgICAgICAgICAgICAgICAgICgwLCB1dGlsc18xLnRoZW4pKGdyaWQuZG9DaGFuZ2VWYWx1ZShlLmNvbCwgZS5yb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFzdGVPcHQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoZS5jb2wsIGUucm93KTtcbiAgICAgICAgICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGVDZWxsUmFuZ2UocmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhcInJlamVjdGVkX3Bhc3RlX3ZhbHVlc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogZS5yb3csXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNvcmQ6IHJlY29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmluZTogZ3JpZC5nZXRDb2x1bW5EZWZpbmUoZS5jb2wsIGUucm93KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3RlVmFsdWU6IGUubm9ybWFsaXplVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uUGFzdGVDZWxsUmFuZ2VCb3hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUGFzdGVDZWxsUmFuZ2VCb3goZ3JpZCwgY2VsbCwgdmFsdWUsIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzUmVhZE9ubHlSZWNvcmQpKHRoaXMucmVhZE9ubHksIGdyaWQsIGNlbGwucm93KSB8fCAoMCwgYWN0aW9uX3V0aWxzXzEuaXNEaXNhYmxlZFJlY29yZCkodGhpcy5kaXNhYmxlZCwgZ3JpZCwgY2VsbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IGdyaWQuZ2V0Um93UmVjb3JkKGNlbGwucm93KTtcblxuICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKHJlY29yZCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFzdGVPcHQgPSB0aGlzLl9wYXN0ZURhdGFUb09wdGlvblZhbHVlKHZhbHVlLCBncmlkLCBjZWxsLCByZWNvcmQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBhc3RlT3B0KSB7XG4gICAgICAgICAgICAgICAgICBncmlkLmRvQ2hhbmdlVmFsdWUoY2VsbC5jb2wsIGNlbGwucm93LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXN0ZU9wdC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvLyB1bmtub3duXG4gICAgICAgICAgICAgICAgICBjb250ZXh0LnJlamVjdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25EZWxldGVDZWxsUmFuZ2VCb3hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uRGVsZXRlQ2VsbFJhbmdlQm94KGdyaWQsIGNlbGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzUmVhZE9ubHlSZWNvcmQpKHRoaXMucmVhZE9ubHksIGdyaWQsIGNlbGwucm93KSB8fCAoMCwgYWN0aW9uX3V0aWxzXzEuaXNEaXNhYmxlZFJlY29yZCkodGhpcy5kaXNhYmxlZCwgZ3JpZCwgY2VsbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IGdyaWQuZ2V0Um93UmVjb3JkKGNlbGwucm93KTtcblxuICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKHJlY29yZCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFzdGVPcHQgPSB0aGlzLl9wYXN0ZURhdGFUb09wdGlvblZhbHVlKFwiXCIsIGdyaWQsIGNlbGwsIHJlY29yZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGFzdGVPcHQpIHtcbiAgICAgICAgICAgICAgICAgIGdyaWQuZG9DaGFuZ2VWYWx1ZShjZWxsLmNvbCwgY2VsbC5yb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhc3RlT3B0LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfcGFzdGVEYXRhVG9PcHRpb25WYWx1ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3Bhc3RlRGF0YVRvT3B0aW9uVmFsdWUodmFsdWUsIGdyaWQsIGNlbGwsIHJlY29yZCkge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5fb3B0aW9ucyhyZWNvcmQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhc3RlT3B0ID0gX3RleHRUb09wdGlvblZhbHVlKHZhbHVlLCBvcHRpb25zKTtcblxuICAgICAgICAgICAgICAgIGlmIChwYXN0ZU9wdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhc3RlT3B0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5UeXBlID0gZ3JpZC5nZXRDb2x1bW5UeXBlKGNlbGwuY29sLCBjZWxsLnJvdyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaGFzT3B0aW9ucyhjb2x1bW5UeXBlKSkge1xuICAgICAgICAgICAgICAgICAgLy8gRmluZCB3aXRoIGNhcHRpb24uXG4gICAgICAgICAgICAgICAgICB2YXIgcGFzdGVWYWx1ZSA9IG5vcm1hbGl6ZVBhc3RlVmFsdWVTdHIodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgdmFyIGNhcHRpb25PcHQgPSB1dGlsc18xLmFycmF5LmZpbmQoY29sdW1uVHlwZS5vcHRpb25zLCBmdW5jdGlvbiAob3B0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBub3JtYWxpemVQYXN0ZVZhbHVlU3RyKG9wdC5sYWJlbCkgPT09IHBhc3RlVmFsdWU7XG4gICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGNhcHRpb25PcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90ZXh0VG9PcHRpb25WYWx1ZShjYXB0aW9uT3B0LnZhbHVlLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbmxpbmVNZW51RWRpdG9yO1xuICAgICAgICAgIH0oRWRpdG9yXzEuRWRpdG9yKTtcblxuICAgICAgICAgIGV4cG9ydHMuSW5saW5lTWVudUVkaXRvciA9IElubGluZU1lbnVFZGl0b3I7XG5cbiAgICAgICAgICBmdW5jdGlvbiBfdGV4dFRvT3B0aW9uVmFsdWUodmFsdWUsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBwYXN0ZVZhbHVlID0gbm9ybWFsaXplUGFzdGVWYWx1ZVN0cih2YWx1ZSk7XG4gICAgICAgICAgICB2YXIgcGFzdGVPcHQgPSB1dGlsc18xLmFycmF5LmZpbmQob3B0aW9ucywgZnVuY3Rpb24gKG9wdCkge1xuICAgICAgICAgICAgICByZXR1cm4gbm9ybWFsaXplUGFzdGVWYWx1ZVN0cihvcHQudmFsdWUpID09PSBwYXN0ZVZhbHVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChwYXN0ZU9wdCkge1xuICAgICAgICAgICAgICByZXR1cm4gcGFzdGVPcHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG5cbiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVQYXN0ZVZhbHVlU3RyKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KHZhbHVlKS50cmltKCk7XG4gICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG5cbiAgICAgICAgICBmdW5jdGlvbiBoYXNPcHRpb25zKGNvbHVtblR5cGUpIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW5UeXBlIGluc3RhbmNlb2YgdHlwZV8xLk1lbnVDb2x1bW4pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cblxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29sdW1uVHlwZS5vcHRpb25zKSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKioqL1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL1JhZGlvRWRpdG9yLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9hY3Rpb24vUmFkaW9FZGl0b3IuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uUmFkaW9FZGl0b3JKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlJhZGlvRWRpdG9yID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGFjdGlvbkJpbmRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uQmluZCAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9hY3Rpb25CaW5kLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBhY3Rpb25fdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uLXV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvYWN0aW9uL2FjdGlvbi11dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBER19FVkVOVF9UWVBFXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9jb3JlL0RHX0VWRU5UX1RZUEUgKi9cbiAgICAgICAgICBcIi4vY29yZS9ER19FVkVOVF9UWVBFLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEVkaXRvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9FZGl0b3IgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vRWRpdG9yLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGFuaW1hdGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL2FuaW1hdGUgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvYW5pbWF0ZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMiA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3V0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdXRpbHMvaW5kZXguanNcIik7XG5cbiAgICAgICAgICB2YXIgUkFESU9fQ09MVU1OX1NUQVRFX0lEID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRSYWRpb0NvbHVtblN0YXRlSWQpKCk7XG5cbiAgICAgICAgICB2YXIgUmFkaW9FZGl0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9FZGl0b3JfMSRFZGl0b3I0KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoUmFkaW9FZGl0b3IsIF9FZGl0b3JfMSRFZGl0b3I0KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjEzID0gX2NyZWF0ZVN1cGVyKFJhZGlvRWRpdG9yKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gUmFkaW9FZGl0b3IoKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczI1O1xuXG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSYWRpb0VkaXRvcik7XG5cbiAgICAgICAgICAgICAgX3RoaXMyNSA9IF9zdXBlcjEzLmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgICAgX3RoaXMyNS5fZ3JvdXAgPSBvcHRpb24uZ3JvdXA7XG4gICAgICAgICAgICAgIF90aGlzMjUuX2NoZWNrQWN0aW9uID0gb3B0aW9uLmNoZWNrQWN0aW9uO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyNTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFJhZGlvRWRpdG9yLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmFkaW9FZGl0b3IodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqIEBkZXByZWNhdGVkIFVzZSBjaGVja0FjdGlvbiBpbnN0ZWFkLiAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJncm91cFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ3JvdXA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqIEBkZXByZWNhdGVkIFVzZSBjaGVja0FjdGlvbiBpbnN0ZWFkLiAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGdyb3VwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZ3JvdXAgPSBncm91cDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2hlY2tBY3Rpb25cIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoZWNrQWN0aW9uO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjaGVja0FjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrQWN0aW9uID0gY2hlY2tBY3Rpb247XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJpbmRHcmlkRXZlbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJpbmRHcmlkRXZlbnQoZ3JpZCwgY2VsbElkKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMjYgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9zdGF0ZSA9IGdyaWRbUkFESU9fQ09MVU1OX1NUQVRFX0lEXTtcblxuICAgICAgICAgICAgICAgIGlmICghX3N0YXRlKSB7XG4gICAgICAgICAgICAgICAgICBfc3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgZWxhcHNlZDoge31cbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB1dGlsc18xLm9iai5zZXRSZWFkb25seShncmlkLCBSQURJT19DT0xVTU5fU1RBVEVfSUQsIF9zdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gX3N0YXRlO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGZ1bmN0aW9uIGFjdGlvbihjZWxsKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczI2Ll9hY3Rpb24oZ3JpZCwgY2VsbCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzVGFyZ2V0KGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZ3JpZC5nZXRMYXlvdXRDZWxsSWQoY29sLCByb3cpID09PSBjZWxsSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoKDAsIGFjdGlvbkJpbmRfMS5iaW5kQ2VsbENsaWNrQWN0aW9uKShncmlkLCBjZWxsSWQsIHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgICAgbW91c2VPdmVyOiBmdW5jdGlvbiBtb3VzZU92ZXIoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKF90aGlzMjYuZGlzYWJsZWQsIGdyaWQsIGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlQWN0aXZlQ2VsbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb2w6IGUuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogZS5yb3dcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoZS5jb2wsIGUucm93KTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5pbnZhbGlkYXRlQ2VsbFJhbmdlKHJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgbW91c2VPdXQ6IGZ1bmN0aW9uIG1vdXNlT3V0KGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLm1vdXNlQWN0aXZlQ2VsbDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoZS5jb2wsIGUucm93KTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5pbnZhbGlkYXRlQ2VsbFJhbmdlKHJhbmdlKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSksIF90b0NvbnN1bWFibGVBcnJheSgoMCwgYWN0aW9uQmluZF8xLmJpbmRDZWxsS2V5QWN0aW9uKShncmlkLCBjZWxsSWQsIHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uXG4gICAgICAgICAgICAgICAgfSkpLCBbLy8gcGFzdGUgdmFsdWVcbiAgICAgICAgICAgICAgICBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5QQVNURV9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGUubXVsdGkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG11bHRpIGNlbGwgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvblJhbmdlID0gZ3JpZC5zZWxlY3Rpb24ucmFuZ2U7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzEuY2VsbEVxdWFscykoc2VsZWN0aW9uUmFuZ2Uuc3RhcnQsIHNlbGVjdGlvblJhbmdlLmVuZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG11bHRpIHBhc3RlIHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHV0aWxzXzEuZXZlbnQuY2FuY2VsKGUuZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgdmFyIHBhc3RlVmFsdWUgPSBlLm5vcm1hbGl6ZVZhbHVlLnRyaW0oKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGlzUmVqZWN0VmFsdWUocGFzdGVWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm90IGEgYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gZ3JpZC5nZXRSb3dSZWNvcmQoZS5yb3cpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzEuaXNQcm9taXNlKShyZWNvcmQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKFwicmVqZWN0ZWRfcGFzdGVfdmFsdWVzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcm93OiBlLnJvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkOiByZWNvcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmluZTogZ3JpZC5nZXRDb2x1bW5EZWZpbmUoZS5jb2wsIGUucm93KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGVWYWx1ZTogcGFzdGVWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWYgKCEoMCwgdXRpbHNfMi50b0Jvb2xlYW4pKHBhc3RlVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgYWN0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBlLnJvd1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSldKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25QYXN0ZUNlbGxSYW5nZUJveFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25QYXN0ZUNlbGxSYW5nZUJveChncmlkLCBjZWxsLCB2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICAgICAgICAgIGlmICgoMCwgYWN0aW9uX3V0aWxzXzEuaXNSZWFkT25seVJlY29yZCkodGhpcy5yZWFkT25seSwgZ3JpZCwgY2VsbC5yb3cpIHx8ICgwLCBhY3Rpb25fdXRpbHNfMS5pc0Rpc2FibGVkUmVjb3JkKSh0aGlzLmRpc2FibGVkLCBncmlkLCBjZWxsLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFzdGVWYWx1ZSA9IHZhbHVlLnRyaW0oKTtcblxuICAgICAgICAgICAgICAgIGlmIChpc1JlamVjdFZhbHVlKHBhc3RlVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAvLyBOb3QgYSBib29sZWFuXG4gICAgICAgICAgICAgICAgICBjb250ZXh0LnJlamVjdCgpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzIudG9Cb29sZWFuKShwYXN0ZVZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbihncmlkLCB7XG4gICAgICAgICAgICAgICAgICBjb2w6IGNlbGwuY29sLFxuICAgICAgICAgICAgICAgICAgcm93OiBjZWxsLnJvd1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkRlbGV0ZUNlbGxSYW5nZUJveFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25EZWxldGVDZWxsUmFuZ2VCb3goKSB7Ly8gbm9vcFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfYWN0aW9uXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYWN0aW9uKGdyaWQsIGNlbGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMyNyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmlkW1JBRElPX0NPTFVNTl9TVEFURV9JRF07XG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoY2VsbC5jb2wsIGNlbGwucm93KTtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbEtleSA9IFwiXCIuY29uY2F0KHJhbmdlLnN0YXJ0LmNvbCwgXCI6XCIpLmNvbmNhdChyYW5nZS5zdGFydC5yb3cpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCgwLCBhY3Rpb25fdXRpbHNfMS5pc1JlYWRPbmx5UmVjb3JkKSh0aGlzLnJlYWRPbmx5LCBncmlkLCBjZWxsLnJvdykgfHwgKDAsIGFjdGlvbl91dGlsc18xLmlzRGlzYWJsZWRSZWNvcmQpKHRoaXMuZGlzYWJsZWQsIGdyaWQsIGNlbGwucm93KSB8fCBzdGF0ZS5ibG9ja1tjZWxsS2V5XSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGdyaWQuZG9HZXRDZWxsVmFsdWUoY2VsbC5jb2wsIGNlbGwucm93LCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMi50b0Jvb2xlYW4pKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczI3Ll9jaGVja0FjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2VyIGJlaGF2aW9yXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSBncmlkLmdldFJvd1JlY29yZChjZWxsLnJvdyk7XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyNy5fY2hlY2tBY3Rpb24ocmVjb3JkLCAoMCwgdXRpbHNfMS5leHRlbmQpKGNlbGwsIHtcbiAgICAgICAgICAgICAgICAgICAgICBncmlkOiBncmlkXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczI3Ll9ncm91cCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBCYWNrd2FyZCBjb21wYXRpYmlsaXR5XG4gICAgICAgICAgICAgICAgICAgIHZhciBfc3RhdGUyID0gZ3JpZFtSQURJT19DT0xVTU5fU1RBVEVfSURdO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRzID0gX3RoaXMyNy5fZ3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgIGdyaWQ6IGdyaWQsXG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBjZWxsLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3c6IGNlbGwucm93XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldHMuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjIyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9yZWYyMi5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IF9yZWYyMi5yb3c7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsS2V5ID0gXCJcIi5jb25jYXQocmFuZ2Uuc3RhcnQuY29sLCBcIjpcIikuY29uY2F0KHJhbmdlLnN0YXJ0LnJvdyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICBpZiAoKDAsIGFjdGlvbl91dGlsc18xLmlzUmVhZE9ubHlSZWNvcmQpKF90aGlzMjcucmVhZE9ubHksIGdyaWQsIGNlbGwucm93KSB8fCAoMCwgYWN0aW9uX3V0aWxzXzEuaXNEaXNhYmxlZFJlY29yZCkoX3RoaXMyNy5kaXNhYmxlZCwgZ3JpZCwgY2VsbC5yb3cpIHx8IF9zdGF0ZTIuYmxvY2tbY2VsbEtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25DZWxsKGdyaWQsIGNvbCwgcm93LCBjb2wgPT09IGNlbGwuY29sICYmIHJvdyA9PT0gY2VsbC5yb3cpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfSAvLyBkZWZhdWx0IGJlaGF2aW9yXG5cblxuICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gZ3JpZC5nZXRGaWVsZChjZWxsLmNvbCwgY2VsbC5yb3cpO1xuICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZFN0YXJ0Um93ID0gZ3JpZC5nZXRSZWNvcmRTdGFydFJvd0J5UmVjb3JkSW5kZXgoZ3JpZC5nZXRSZWNvcmRJbmRleEJ5Um93KGNlbGwucm93KSk7XG4gICAgICAgICAgICAgICAgICAvKiogT3JpZ2luYWwgRGF0YVNvdXJjZSAqL1xuXG4gICAgICAgICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IGdyaWQuZGF0YVNvdXJjZS5kYXRhU291cmNlO1xuICAgICAgICAgICAgICAgICAgdmFyIGdpcmRSZWNvcmRzID0gZ2V0QWxsUmVjb3Jkc0Zyb21HcmlkKGdyaWQpO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgX2xvb3AzID0gZnVuY3Rpb24gX2xvb3AzKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSBkYXRhU291cmNlLmdldChpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaG93RGF0YSA9IGdpcmRSZWNvcmRzLmZpbmQoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5yZWNvcmQgPT09IHJlY29yZDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNob3dEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQ2VsbChncmlkLCBjZWxsLmNvbCwgc2hvd0RhdGEucm93LCBzaG93RGF0YS5yb3cgPT09IHJlY29yZFN0YXJ0Um93KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBIaWRkZW4gcmVjb3JkXG4gICAgICAgICAgICAgICAgICAgICAgKDAsIHV0aWxzXzEudGhlbikoZGF0YVNvdXJjZS5nZXRGaWVsZChpbmRleCwgZmllbGQpLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzIudG9Cb29sZWFuKSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlLnNldEZpZWxkKGluZGV4LCBmaWVsZCwgKDAsIGFjdGlvbl91dGlsc18xLnRvZ2dsZVZhbHVlKSh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgZGF0YVNvdXJjZS5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvb3AzKGluZGV4KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gUmFkaW9FZGl0b3I7XG4gICAgICAgICAgfShFZGl0b3JfMS5FZGl0b3IpO1xuXG4gICAgICAgICAgZXhwb3J0cy5SYWRpb0VkaXRvciA9IFJhZGlvRWRpdG9yO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0QWxsUmVjb3Jkc0Zyb21HcmlkKGdyaWQpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgIHZhciByb3dDb3VudCA9IGdyaWQucm93Q291bnQsXG4gICAgICAgICAgICAgICAgcmVjb3JkUm93Q291bnQgPSBncmlkLnJlY29yZFJvd0NvdW50O1xuXG4gICAgICAgICAgICBmb3IgKHZhciB0YXJnZXRSb3cgPSBncmlkLmZyb3plblJvd0NvdW50OyB0YXJnZXRSb3cgPCByb3dDb3VudDsgdGFyZ2V0Um93ICs9IHJlY29yZFJvd0NvdW50KSB7XG4gICAgICAgICAgICAgIHZhciByZWNvcmQgPSBncmlkLmdldFJvd1JlY29yZCh0YXJnZXRSb3cpO1xuICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgcm93OiB0YXJnZXRSb3csXG4gICAgICAgICAgICAgICAgcmVjb3JkOiByZWNvcmRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gYWN0aW9uQ2VsbChncmlkLCBjb2wsIHJvdywgZmxhZykge1xuICAgICAgICAgICAgZ3JpZC5kb0dldENlbGxWYWx1ZShjb2wsIHJvdywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMi50b0Jvb2xlYW4pKHZhbHVlKSA9PT0gZmxhZykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyaWRbUkFESU9fQ09MVU1OX1NUQVRFX0lEXTtcbiAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpO1xuICAgICAgICAgICAgICB2YXIgY2VsbEtleSA9IFwiXCIuY29uY2F0KHJhbmdlLnN0YXJ0LmNvbCwgXCI6XCIpLmNvbmNhdChyYW5nZS5zdGFydC5yb3cpO1xuICAgICAgICAgICAgICB2YXIgcmV0ID0gZ3JpZC5kb0NoYW5nZVZhbHVlKGNvbCwgcm93LCBhY3Rpb25fdXRpbHNfMS50b2dnbGVWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgaWYgKHJldCkge1xuICAgICAgICAgICAgICAgIHZhciBvbkNoYW5nZSA9IGZ1bmN0aW9uIG9uQ2hhbmdlKCkge1xuICAgICAgICAgICAgICAgICAgLy8gY2hlY2tib3ggYW5pbWF0aW9uXG4gICAgICAgICAgICAgICAgICAoMCwgYW5pbWF0ZV8xLmFuaW1hdGUpKDIwMCwgZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2ludCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5lbGFwc2VkW2NlbGxLZXldO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmVsYXBzZWRbY2VsbEtleV0gPSBwb2ludDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkocmV0KSkge1xuICAgICAgICAgICAgICAgICAgc3RhdGUuYmxvY2tbY2VsbEtleV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgcmV0LnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgc3RhdGUuYmxvY2tbY2VsbEtleV07XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGlzUmVqZWN0VmFsdWUocGFzdGVWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuICgwLCBhY3Rpb25fdXRpbHNfMS50b2dnbGVWYWx1ZSkoKDAsIGFjdGlvbl91dGlsc18xLnRvZ2dsZVZhbHVlKShwYXN0ZVZhbHVlKSkgIT09IHBhc3RlVmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiovXG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vU21hbGxEaWFsb2dJbnB1dEVkaXRvci5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9hY3Rpb24vU21hbGxEaWFsb2dJbnB1dEVkaXRvci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc0FjdGlvblNtYWxsRGlhbG9nSW5wdXRFZGl0b3JKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlNtYWxsRGlhbG9nSW5wdXRFZGl0b3IgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQmFzZUlucHV0RWRpdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VJbnB1dEVkaXRvciAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9CYXNlSW5wdXRFZGl0b3IuanNcIik7XG5cbiAgICAgICAgICB2YXIgU21hbGxEaWFsb2dJbnB1dEVsZW1lbnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaW50ZXJuYWwvU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQuanNcIik7XG5cbiAgICAgICAgICB2YXIgc3ltYm9sTWFuYWdlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBfID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRTbWFsbERpYWxvZ0lucHV0RWRpdG9yU3RhdGVJZCkoKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldFN0YXRlKGdyaWQpIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyaWRbX107XG5cbiAgICAgICAgICAgIGlmICghc3RhdGUpIHtcbiAgICAgICAgICAgICAgc3RhdGUgPSB7fTtcbiAgICAgICAgICAgICAgdXRpbHNfMS5vYmouc2V0UmVhZG9ubHkoZ3JpZCwgXywgc3RhdGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG5cbiAgICAgICAgICB2YXIgZ2xvYmFsRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgdmFyIGJpbmRHcmlkQ291bnQgPSAwO1xuXG4gICAgICAgICAgZnVuY3Rpb24gYXR0YWNoSW5wdXQoZ3JpZCwgY2VsbCwgZWRpdG9yLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gZ2V0U3RhdGUoZ3JpZCk7XG5cbiAgICAgICAgICAgIGlmICghZ2xvYmFsRWxlbWVudCkge1xuICAgICAgICAgICAgICBnbG9iYWxFbGVtZW50ID0gbmV3IFNtYWxsRGlhbG9nSW5wdXRFbGVtZW50XzEuU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFzdGF0ZS5lbGVtZW50KSB7XG4gICAgICAgICAgICAgIHN0YXRlLmVsZW1lbnQgPSBnbG9iYWxFbGVtZW50O1xuICAgICAgICAgICAgICBiaW5kR3JpZENvdW50Kys7XG4gICAgICAgICAgICAgIGdyaWQuYWRkRGlzcG9zYWJsZSh7XG4gICAgICAgICAgICAgICAgZGlzcG9zZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgICAgICAgICAgIGJpbmRHcmlkQ291bnQtLTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCFiaW5kR3JpZENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbEVsZW1lbnQgPT09IG51bGwgfHwgZ2xvYmFsRWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ2xvYmFsRWxlbWVudC5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbEVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5lbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnbG9iYWxFbGVtZW50LmF0dGFjaChncmlkLCBlZGl0b3IsIGNlbGwuY29sLCBjZWxsLnJvdywgdmFsdWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGRldGFjaElucHV0KGdyaWRGb2N1cykge1xuICAgICAgICAgICAgaWYgKGdsb2JhbEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgZ2xvYmFsRWxlbWVudC5kZXRhY2goZ3JpZEZvY3VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgU21hbGxEaWFsb2dJbnB1dEVkaXRvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VJbnB1dEVkaXRvcl8xJEJhMikge1xuICAgICAgICAgICAgX2luaGVyaXRzKFNtYWxsRGlhbG9nSW5wdXRFZGl0b3IsIF9CYXNlSW5wdXRFZGl0b3JfMSRCYTIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMTQgPSBfY3JlYXRlU3VwZXIoU21hbGxEaWFsb2dJbnB1dEVkaXRvcik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIFNtYWxsRGlhbG9nSW5wdXRFZGl0b3IoKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczI4O1xuXG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTbWFsbERpYWxvZ0lucHV0RWRpdG9yKTtcblxuICAgICAgICAgICAgICBfdGhpczI4ID0gX3N1cGVyMTQuY2FsbCh0aGlzLCBvcHRpb24pO1xuICAgICAgICAgICAgICBfdGhpczI4Ll9oZWxwZXJUZXh0ID0gb3B0aW9uLmhlbHBlclRleHQ7XG4gICAgICAgICAgICAgIF90aGlzMjguX2lucHV0VmFsaWRhdG9yID0gb3B0aW9uLmlucHV0VmFsaWRhdG9yO1xuICAgICAgICAgICAgICBfdGhpczI4Ll92YWxpZGF0b3IgPSBvcHRpb24udmFsaWRhdG9yO1xuICAgICAgICAgICAgICBfdGhpczI4Ll9jbGFzc0xpc3QgPSBvcHRpb24uY2xhc3NMaXN0O1xuICAgICAgICAgICAgICBfdGhpczI4Ll90eXBlID0gb3B0aW9uLnR5cGU7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczI4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoU21hbGxEaWFsb2dJbnB1dEVkaXRvciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7Ly9ub29wXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsYXNzTGlzdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NsYXNzTGlzdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLl9jbGFzc0xpc3QpID8gdGhpcy5fY2xhc3NMaXN0IDogW3RoaXMuX2NsYXNzTGlzdF07XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNsYXNzTGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NsYXNzTGlzdCA9IGNsYXNzTGlzdDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidHlwZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodHlwZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoZWxwZXJUZXh0XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWxwZXJUZXh0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJpbnB1dFZhbGlkYXRvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRWYWxpZGF0b3I7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInZhbGlkYXRvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdmFsaWRhdG9yO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTbWFsbERpYWxvZ0lucHV0RWRpdG9yKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbklucHV0Q2VsbEludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbklucHV0Q2VsbEludGVybmFsKGdyaWQsIGNlbGwsIGlucHV0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBhdHRhY2hJbnB1dChncmlkLCBjZWxsLCB0aGlzLCBpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25PcGVuQ2VsbEludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbk9wZW5DZWxsSW50ZXJuYWwoZ3JpZCwgY2VsbCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczI5ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGdyaWQuZG9HZXRDZWxsVmFsdWUoY2VsbC5jb2wsIGNlbGwucm93LCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIGF0dGFjaElucHV0KGdyaWQsIGNlbGwsIF90aGlzMjksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25DaGFuZ2VTZWxlY3RDZWxsSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlU2VsZWN0Q2VsbEludGVybmFsKF9ncmlkLCBfY2VsbCwgX3NlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgLy8gY2FuY2VsIGlucHV0XG4gICAgICAgICAgICAgICAgZGV0YWNoSW5wdXQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25HcmlkU2Nyb2xsSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uR3JpZFNjcm9sbEludGVybmFsKF9ncmlkKSB7XG4gICAgICAgICAgICAgICAgLy8gY2FuY2VsIGlucHV0XG4gICAgICAgICAgICAgICAgZGV0YWNoSW5wdXQodHJ1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uQ2hhbmdlRGlzYWJsZWRJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2VEaXNhYmxlZEludGVybmFsKCkge1xuICAgICAgICAgICAgICAgIC8vIGNhbmNlbCBpbnB1dFxuICAgICAgICAgICAgICAgIGRldGFjaElucHV0KHRydWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkNoYW5nZVJlYWRPbmx5SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlUmVhZE9ubHlJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgICAgICAvLyBjYW5jZWwgaW5wdXRcbiAgICAgICAgICAgICAgICBkZXRhY2hJbnB1dCh0cnVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25TZXRJbnB1dEF0dHJzSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uU2V0SW5wdXRBdHRyc0ludGVybmFsKGdyaWQsIF9jZWxsLCBpbnB1dCkge1xuICAgICAgICAgICAgICAgIFNtYWxsRGlhbG9nSW5wdXRFbGVtZW50XzEuU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQuc2V0SW5wdXRBdHRycyh0aGlzLCBncmlkLCBpbnB1dCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFNtYWxsRGlhbG9nSW5wdXRFZGl0b3I7XG4gICAgICAgICAgfShCYXNlSW5wdXRFZGl0b3JfMS5CYXNlSW5wdXRFZGl0b3IpO1xuXG4gICAgICAgICAgZXhwb3J0cy5TbWFsbERpYWxvZ0lucHV0RWRpdG9yID0gU21hbGxEaWFsb2dJbnB1dEVkaXRvcjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9hY3Rpb24tdXRpbHMuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9hY3Rpb24vYWN0aW9uLXV0aWxzLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNBY3Rpb25BY3Rpb25VdGlsc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMudG9nZ2xlVmFsdWUgPSBleHBvcnRzLmlzUmVhZE9ubHlSZWNvcmQgPSBleHBvcnRzLmlzRGlzYWJsZWRSZWNvcmQgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gaXNEaXNhYmxlZFJlY29yZChvcHRpb24sIGdyaWQsIHJvdykge1xuICAgICAgICAgICAgaWYgKGdyaWQuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBnZXRCb29sZWFuT3B0aW9uT2ZSZWNvcmQob3B0aW9uLCBncmlkLCByb3cpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuaXNEaXNhYmxlZFJlY29yZCA9IGlzRGlzYWJsZWRSZWNvcmQ7XG5cbiAgICAgICAgICBmdW5jdGlvbiBpc1JlYWRPbmx5UmVjb3JkKG9wdGlvbiwgZ3JpZCwgcm93KSB7XG4gICAgICAgICAgICBpZiAoZ3JpZC5yZWFkT25seSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGdldEJvb2xlYW5PcHRpb25PZlJlY29yZChvcHRpb24sIGdyaWQsIHJvdyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5pc1JlYWRPbmx5UmVjb3JkID0gaXNSZWFkT25seVJlY29yZDtcblxuICAgICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVZhbHVlKHZhbCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgaWYgKHZhbCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgaWYgKHZhbCA9PT0gXCJmYWxzZVwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidHJ1ZVwiO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbCA9PT0gXCJvZmZcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIm9uXCI7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoL14wKyQvLmV4ZWModmFsKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWwucmVwbGFjZSgvXigwKikwJC8sIFwiJDExXCIpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbCA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJmYWxzZVwiO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbCA9PT0gXCJvblwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwib2ZmXCI7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoL14wKjEkLy5leGVjKHZhbCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsLnJlcGxhY2UoL14oMCopMSQvLCBcIiQxMFwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gIXZhbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLnRvZ2dsZVZhbHVlID0gdG9nZ2xlVmFsdWU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRCb29sZWFuT3B0aW9uT2ZSZWNvcmQob3B0aW9uLCBncmlkLCByb3cpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IGdyaWQuZ2V0Um93UmVjb3JkKHJvdyk7XG5cbiAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkocmVjb3JkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuICEhb3B0aW9uKHJlY29yZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAhIW9wdGlvbjtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqKi9cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9hY3Rpb25CaW5kLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL2FjdGlvbi9hY3Rpb25CaW5kLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uQWN0aW9uQmluZEpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuYmluZENlbGxLZXlBY3Rpb24gPSBleHBvcnRzLmJpbmRDZWxsQ2xpY2tBY3Rpb24gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIERHX0VWRU5UX1RZUEVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2NvcmUvREdfRVZFTlRfVFlQRSAqL1xuICAgICAgICAgIFwiLi9jb3JlL0RHX0VWRU5UX1RZUEUuanNcIik7XG5cbiAgICAgICAgICB2YXIgS0VZX0VOVEVSID0gMTM7XG4gICAgICAgICAgdmFyIEtFWV9TUEFDRSA9IDMyO1xuXG4gICAgICAgICAgZnVuY3Rpb24gYmluZENlbGxDbGlja0FjdGlvbihncmlkLCBjZWxsSWQsIF9yZWYyMykge1xuICAgICAgICAgICAgdmFyIGFjdGlvbiA9IF9yZWYyMy5hY3Rpb24sXG4gICAgICAgICAgICAgICAgbW91c2VPdmVyID0gX3JlZjIzLm1vdXNlT3ZlcixcbiAgICAgICAgICAgICAgICBtb3VzZU91dCA9IF9yZWYyMy5tb3VzZU91dCxcbiAgICAgICAgICAgICAgICBhcmVhID0gX3JlZjIzLmFyZWE7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzVGFyZ2V0KGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgIHJldHVybiBncmlkLmdldExheW91dENlbGxJZChjb2wsIHJvdykgPT09IGNlbGxJZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG1vdXNlSXNJbkNlbGwgPSBudWxsO1xuICAgICAgICAgICAgdmFyIG1vdXNlT3ZlcmVkID0gbnVsbDtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcHJvY2Vzc01vdXNlT3ZlcihlKSB7XG4gICAgICAgICAgICAgIG1vdXNlT3ZlcmVkID0gZTtcblxuICAgICAgICAgICAgICBpZiAobW91c2VPdmVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFtb3VzZU92ZXIoe1xuICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogZS5yb3dcbiAgICAgICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGdyaWQuZ2V0RWxlbWVudCgpLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBwcm9jZXNzTW91c2VPdXQoZSkge1xuICAgICAgICAgICAgICBpZiAobW91c2VPdXQpIHtcbiAgICAgICAgICAgICAgICBtb3VzZU91dCh7XG4gICAgICAgICAgICAgICAgICBjb2w6IGUuY29sLFxuICAgICAgICAgICAgICAgICAgcm93OiBlLnJvd1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgbW91c2VPdmVyZWQgPSBudWxsO1xuICAgICAgICAgICAgICBncmlkLmdldEVsZW1lbnQoKS5zdHlsZS5jdXJzb3IgPSBcIlwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZGlzcG9zYWJsZXMgPSBbLy8gY2xpY2tcbiAgICAgICAgICAgIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLkNMSUNLX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKGdyaWQuZ2V0Um93UmVjb3JkKGUucm93KSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoYXJlYSkge1xuICAgICAgICAgICAgICAgIGlmICghYXJlYShlKSkgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYWN0aW9uKHtcbiAgICAgICAgICAgICAgICBjb2w6IGUuY29sLFxuICAgICAgICAgICAgICAgIHJvdzogZS5yb3dcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSwgLy8gbW91c2UgbW92ZVxuICAgICAgICAgICAgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuTU9VU0VPVkVSX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKGdyaWQuZ2V0Um93UmVjb3JkKGUucm93KSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBtb3VzZUlzSW5DZWxsID0gZTtcblxuICAgICAgICAgICAgICBpZiAoYXJlYSkge1xuICAgICAgICAgICAgICAgIGlmICghYXJlYShlKSkgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcHJvY2Vzc01vdXNlT3ZlcihlKTtcbiAgICAgICAgICAgIH0pLCBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5NT1VTRU9VVF9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICBpZiAoIW1vdXNlSXNJbkNlbGwgfHwgbW91c2VJc0luQ2VsbC5jb2wgIT09IGUuY29sIHx8IG1vdXNlSXNJbkNlbGwucm93ICE9PSBlLnJvdykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICghbW91c2VPdmVyZWQpIHtcbiAgICAgICAgICAgICAgICBwcm9jZXNzTW91c2VPdXQoZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXTtcblxuICAgICAgICAgICAgaWYgKGFyZWEpIHtcbiAgICAgICAgICAgICAgZGlzcG9zYWJsZXMucHVzaChncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5NT1VTRU1PVkVfQ0VMTCwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW1vdXNlSXNJbkNlbGwgfHwgbW91c2VJc0luQ2VsbC5jb2wgIT09IGUuY29sIHx8IG1vdXNlSXNJbkNlbGwucm93ICE9PSBlLnJvdykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpc0luQXJlYSA9IGFyZWEoZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIW1vdXNlT3ZlcmVkKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWlzSW5BcmVhKSByZXR1cm47IC8vIG1vdXNlIG92ZXJcblxuICAgICAgICAgICAgICAgICAgcHJvY2Vzc01vdXNlT3ZlcihlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaWYgKGlzSW5BcmVhKSByZXR1cm47IC8vIG1vdXNlIG91dFxuXG4gICAgICAgICAgICAgICAgICBwcm9jZXNzTW91c2VPdXQoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlcztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmJpbmRDZWxsQ2xpY2tBY3Rpb24gPSBiaW5kQ2VsbENsaWNrQWN0aW9uO1xuXG4gICAgICAgICAgZnVuY3Rpb24gYmluZENlbGxLZXlBY3Rpb24oZ3JpZCwgY2VsbElkLCBfcmVmMjQpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpb24gPSBfcmVmMjQuYWN0aW9uLFxuICAgICAgICAgICAgICAgIF9yZWYyNCRhY2NlcHRLZXlzID0gX3JlZjI0LmFjY2VwdEtleXMsXG4gICAgICAgICAgICAgICAgYWNjZXB0S2V5cyA9IF9yZWYyNCRhY2NlcHRLZXlzID09PSB2b2lkIDAgPyBbXSA6IF9yZWYyNCRhY2NlcHRLZXlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBpc1RhcmdldChjb2wsIHJvdykge1xuICAgICAgICAgICAgICByZXR1cm4gZ3JpZC5nZXRMYXlvdXRDZWxsSWQoY29sLCByb3cpID09PSBjZWxsSWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFjY2VwdEtleXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFjY2VwdEtleXMpLCBbS0VZX0VOVEVSLCBLRVlfU1BBQ0VdKTtcbiAgICAgICAgICAgIHJldHVybiBbLy8gZW50ZXIga2V5IGRvd25cbiAgICAgICAgICAgIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLktFWURPV04sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICBpZiAoYWNjZXB0S2V5cy5pbmRleE9mKGUua2V5Q29kZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCgoX2EgPSBncmlkLmtleWJvYXJkT3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1vdmVDZWxsT25FbnRlcikgJiYgZS5rZXlDb2RlID09PSBLRVlfRU5URVIpIHtcbiAgICAgICAgICAgICAgICAvLyBXaGVuIG1vdmluZyB3aXRoIHRoZSBlbnRlciBrZXksIG5vIGFjdGlvbiBpcyB0YWtlbiB3aXRoIHRoZSBlbnRlciBrZXkuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIHNlbCA9IGdyaWQuc2VsZWN0aW9uLnNlbGVjdDtcblxuICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KHNlbC5jb2wsIHNlbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkoZ3JpZC5nZXRSb3dSZWNvcmQoc2VsLnJvdykpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYWN0aW9uKHtcbiAgICAgICAgICAgICAgICBjb2w6IHNlbC5jb2wsXG4gICAgICAgICAgICAgICAgcm93OiBzZWwucm93XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB1dGlsc18xLmV2ZW50LmNhbmNlbChlLmV2ZW50KTtcbiAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmJpbmRDZWxsS2V5QWN0aW9uID0gYmluZENlbGxLZXlBY3Rpb247XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvSW5saW5lSW5wdXRFbGVtZW50LmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL0lubGluZUlucHV0RWxlbWVudC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uSW50ZXJuYWxJbmxpbmVJbnB1dEVsZW1lbnRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLklubGluZUlucHV0RWxlbWVudCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBFdmVudEhhbmRsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2ludGVybmFsL0V2ZW50SGFuZGxlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgZG9tXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9pbnRlcm5hbC9kb20gKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvZG9tLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBpbnB1dF92YWx1ZV9oYW5kbGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2lucHV0LXZhbHVlLWhhbmRsZXIgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvaW5wdXQtdmFsdWUtaGFuZGxlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBLRVlfVEFCID0gOTtcbiAgICAgICAgICB2YXIgS0VZX0VOVEVSID0gMTM7XG4gICAgICAgICAgdmFyIENMQVNTTkFNRSA9IFwiY2hlZXRhaC1ncmlkX19pbmxpbmUtaW5wdXRcIjtcblxuICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUlucHV0RWxlbWVudCgpIHtcbiAgICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgICAvKiEgQC9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVJbnB1dEVsZW1lbnQuY3NzICovXG4gICAgICAgICAgICBcIi4uL3NyYy9qcy9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVJbnB1dEVsZW1lbnQuY3NzXCIpO1xuXG4gICAgICAgICAgICByZXR1cm4gKDAsIGRvbV8xLmNyZWF0ZUVsZW1lbnQpKFwiaW5wdXRcIiwge1xuICAgICAgICAgICAgICBjbGFzc0xpc3Q6IENMQVNTTkFNRVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gX3NldElucHV0QXR0cnMoZWRpdG9yLCBfZ3JpZCwgaW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBjbGFzc0xpc3QgPSBlZGl0b3IuY2xhc3NMaXN0LFxuICAgICAgICAgICAgICAgIHR5cGUgPSBlZGl0b3IudHlwZTtcblxuICAgICAgICAgICAgaWYgKGNsYXNzTGlzdCkge1xuICAgICAgICAgICAgICB2YXIgX2lucHV0JGNsYXNzTGlzdDtcblxuICAgICAgICAgICAgICAoX2lucHV0JGNsYXNzTGlzdCA9IGlucHV0LmNsYXNzTGlzdCkuYWRkLmFwcGx5KF9pbnB1dCRjbGFzc0xpc3QsIF90b0NvbnN1bWFibGVBcnJheShjbGFzc0xpc3QpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW5wdXQudHlwZSA9IHR5cGUgfHwgXCJcIjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgSW5saW5lSW5wdXRFbGVtZW50ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIElubGluZUlucHV0RWxlbWVudCgpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElubGluZUlucHV0RWxlbWVudCk7XG5cbiAgICAgICAgICAgICAgdGhpcy5faGFuZGxlciA9IG5ldyBFdmVudEhhbmRsZXJfMS5FdmVudEhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgdGhpcy5faW5wdXQgPSBjcmVhdGVJbnB1dEVsZW1lbnQoKTtcblxuICAgICAgICAgICAgICB0aGlzLl9iaW5kSW5wdXRFdmVudHMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKElubGluZUlucHV0RWxlbWVudCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5faW5wdXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2goKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIuZGlzcG9zZSgpOyAvLyBAdHMtZXhwZWN0LWVycm9yIC0tIGlnbm9yZVxuXG5cbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5faW5wdXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmVmb3JlUHJvcEVkaXRvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgKF9hID0gaW5wdXQucGFyZW50RWxlbWVudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlbW92ZUNoaWxkKGlucHV0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYXR0YWNoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdHRhY2goZ3JpZCwgZWRpdG9yLCBjb2wsIHJvdywgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMzMCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGlzLl9pbnB1dDtcbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXI7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYmVmb3JlUHJvcEVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzTGlzdCA9IHRoaXMuX2JlZm9yZVByb3BFZGl0b3IuY2xhc3NMaXN0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfaW5wdXQkY2xhc3NMaXN0MjtcblxuICAgICAgICAgICAgICAgICAgICAoX2lucHV0JGNsYXNzTGlzdDIgPSBpbnB1dC5jbGFzc0xpc3QpLnJlbW92ZS5hcHBseShfaW5wdXQkY2xhc3NMaXN0MiwgX3RvQ29uc3VtYWJsZUFycmF5KGNsYXNzTGlzdCkpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmZvbnQgPSBncmlkLmZvbnQgfHwgXCIxNnB4IHNhbnMtc2VyaWZcIjtcblxuICAgICAgICAgICAgICAgIHZhciBfZ3JpZCRnZXRBdHRhY2hDZWxsc0EgPSBncmlkLmdldEF0dGFjaENlbGxzQXJlYShncmlkLmdldENlbGxSYW5nZShjb2wsIHJvdykpLFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gX2dyaWQkZ2V0QXR0YWNoQ2VsbHNBLmVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIHJlY3QgPSBfZ3JpZCRnZXRBdHRhY2hDZWxsc0EucmVjdDtcblxuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLnRvcCA9IFwiXCIuY29uY2F0KHJlY3QudG9wLnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5sZWZ0ID0gXCJcIi5jb25jYXQocmVjdC5sZWZ0LnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS53aWR0aCA9IFwiXCIuY29uY2F0KHJlY3Qud2lkdGgudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmhlaWdodCA9IFwiXCIuY29uY2F0KHJlY3QuaGVpZ2h0LnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGlucHV0KTtcblxuICAgICAgICAgICAgICAgIF9zZXRJbnB1dEF0dHJzKGVkaXRvciwgZ3JpZCwgaW5wdXQpO1xuXG4gICAgICAgICAgICAgICAgKDAsIGlucHV0X3ZhbHVlX2hhbmRsZXJfMS5zZXRJbnB1dFZhbHVlKShpbnB1dCwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZURhdGEgPSB7XG4gICAgICAgICAgICAgICAgICBncmlkOiBncmlkLFxuICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICByb3c6IHJvdyxcbiAgICAgICAgICAgICAgICAgIGVkaXRvcjogZWRpdG9yXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLl9iZWZvcmVQcm9wRWRpdG9yID0gZWRpdG9yO1xuXG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzID0gZnVuY3Rpb24gZm9jdXMoKSB7XG4gICAgICAgICAgICAgICAgICBpbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgdmFyIGVuZCA9IGlucHV0LnZhbHVlLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC5zZWxlY3Rpb25TdGFydCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNlbGVjdGlvblN0YXJ0ID0gZW5kO1xuICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNlbGVjdGlvbkVuZCA9IGVuZDtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsvL2lnbm9yZVxuICAgICAgICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG5cbiAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gaW5wdXQuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlLm1vdmVFbmQoXCJjaGFyYWN0ZXJcIiwgZW5kKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW92ZVN0YXJ0KFwiY2hhcmFjdGVyXCIsIGVuZCk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdCgpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBoYW5kbGVyLnRyeVdpdGhPZmZFdmVudHMoaW5wdXQsIFwiYmx1clwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBmb2N1cygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2F0dGFjaGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMzMC5fYXR0YWNoaW5nO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkZXRhY2hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRldGFjaChncmlkRm9jdXMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIF90aGlzJF9hY3RpdmVEYXRhID0gdGhpcy5fYWN0aXZlRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICBncmlkID0gX3RoaXMkX2FjdGl2ZURhdGEuZ3JpZCxcbiAgICAgICAgICAgICAgICAgICAgICBjb2wgPSBfdGhpcyRfYWN0aXZlRGF0YS5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93ID0gX3RoaXMkX2FjdGl2ZURhdGEucm93O1xuICAgICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5faW5wdXQ7XG5cbiAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIudHJ5V2l0aE9mZkV2ZW50cyhpbnB1dCwgXCJibHVyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgICAgIChfYSA9IGlucHV0LnBhcmVudEVsZW1lbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yZW1vdmVDaGlsZChpbnB1dCk7XG4gICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpO1xuICAgICAgICAgICAgICAgICAgZ3JpZC5pbnZhbGlkYXRlQ2VsbFJhbmdlKHJhbmdlKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGdyaWRGb2N1cykge1xuICAgICAgICAgICAgICAgICAgICBncmlkLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRvQ2hhbmdlVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRvQ2hhbmdlVmFsdWUoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5faW5wdXQ7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gaW5wdXQudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF9hY3RpdmVEYXRhMiA9IHRoaXMuX2FjdGl2ZURhdGEsXG4gICAgICAgICAgICAgICAgICAgIGdyaWQgPSBfdGhpcyRfYWN0aXZlRGF0YTIuZ3JpZCxcbiAgICAgICAgICAgICAgICAgICAgY29sID0gX3RoaXMkX2FjdGl2ZURhdGEyLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gX3RoaXMkX2FjdGl2ZURhdGEyLnJvdztcbiAgICAgICAgICAgICAgICBncmlkLmRvQ2hhbmdlVmFsdWUoY29sLCByb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2lzQWN0aXZlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNBY3RpdmUoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5faW5wdXQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlucHV0IHx8ICFpbnB1dC5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9hY3RpdmVEYXRhKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9iaW5kSW5wdXRFdmVudHNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9iaW5kSW5wdXRFdmVudHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMzEgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLl9oYW5kbGVyO1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IHRoaXMuX2lucHV0O1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0b3BQcm9wYWdhdGlvbk9ubHkgPSBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb25Pbmx5KGUpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH07IC8vIGdyaWTjgavjgqTjg5njg7Pjg4jjgYzkvJ3mkq3jgZfjgarjgYTjgojjgYbjgatcblxuXG4gICAgICAgICAgICAgICAgaGFuZGxlci5vbihpbnB1dCwgXCJjbGlja1wiLCBzdG9wUHJvcGFnYXRpb25Pbmx5KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcIm1vdXNlZG93blwiLCBzdG9wUHJvcGFnYXRpb25Pbmx5KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcInRvdWNoc3RhcnRcIiwgc3RvcFByb3BhZ2F0aW9uT25seSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5vbihpbnB1dCwgXCJkYmxjbGlja1wiLCBzdG9wUHJvcGFnYXRpb25Pbmx5KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImNvbXBvc2l0aW9uc3RhcnRcIiwgZnVuY3Rpb24gKF9lKSB7XG4gICAgICAgICAgICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKFwiY29tcG9zaXRpb25cIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5vbihpbnB1dCwgXCJjb21wb3NpdGlvbmVuZFwiLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoXCJjb21wb3NpdGlvblwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoXCJjb21wb3NpdGlvblwiKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gdXRpbHNfMS5ldmVudC5nZXRLZXlDb2RlKGUpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoa2V5Q29kZSA9PT0gS0VZX0VOVEVSKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMzEuX29uS2V5ZG93bkVudGVyKGUpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBLRVlfVEFCKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMzEuX29uS2V5ZG93blRhYihlKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImJsdXJcIiwgZnVuY3Rpb24gKF9lKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczMxLmRvQ2hhbmdlVmFsdWUoKTtcblxuICAgICAgICAgICAgICAgICAgX3RoaXMzMS5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX29uS2V5ZG93bkVudGVyXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25LZXlkb3duRW50ZXIoZSkge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5faXNBY3RpdmUoKSB8fCB0aGlzLl9hdHRhY2hpbmcpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuX2FjdGl2ZURhdGEuZ3JpZDtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlVmFsdWUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFjaCh0cnVlKTtcbiAgICAgICAgICAgICAgICB1dGlsc18xLmV2ZW50LmNhbmNlbChlKTtcblxuICAgICAgICAgICAgICAgIGlmICgoX2EgPSBncmlkLmtleWJvYXJkT3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1vdmVDZWxsT25FbnRlcikge1xuICAgICAgICAgICAgICAgICAgZ3JpZC5vbktleURvd25Nb3ZlKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX29uS2V5ZG93blRhYlwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uS2V5ZG93blRhYihlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLl9hY3RpdmVEYXRhLmdyaWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoISgoX2EgPSBncmlkLmtleWJvYXJkT3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1vdmVDZWxsT25UYWIpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVZhbHVlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgZ3JpZC5vbktleURvd25Nb3ZlKGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcInNldElucHV0QXR0cnNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldElucHV0QXR0cnMoZWRpdG9yLCBncmlkLCBpbnB1dCkge1xuICAgICAgICAgICAgICAgIF9zZXRJbnB1dEF0dHJzKGVkaXRvciwgZ3JpZCwgaW5wdXQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbmxpbmVJbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5JbmxpbmVJbnB1dEVsZW1lbnQgPSBJbmxpbmVJbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvSW5saW5lTWVudUVsZW1lbnQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9JbmxpbmVNZW51RWxlbWVudC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNBY3Rpb25JbnRlcm5hbElubGluZU1lbnVFbGVtZW50SnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5JbmxpbmVNZW51RWxlbWVudCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBkb21fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2ludGVybmFsL2RvbSAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9kb20uanNcIik7XG5cbiAgICAgICAgICB2YXIgRXZlbnRIYW5kbGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvRXZlbnRIYW5kbGVyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBLRVlfVEFCID0gOTtcbiAgICAgICAgICB2YXIgS0VZX0VOVEVSID0gMTM7XG4gICAgICAgICAgdmFyIEtFWV9VUCA9IDM4O1xuICAgICAgICAgIHZhciBLRVlfRE9XTiA9IDQwO1xuICAgICAgICAgIHZhciBLRVlfRVNDID0gMjc7XG4gICAgICAgICAgdmFyIENMQVNTTkFNRSA9IFwiY2hlZXRhaC1ncmlkX19pbmxpbmUtbWVudVwiO1xuICAgICAgICAgIHZhciBJVEVNX0NMQVNTTkFNRSA9IFwiXCIuY29uY2F0KENMQVNTTkFNRSwgXCJfX21lbnUtaXRlbVwiKTtcbiAgICAgICAgICB2YXIgSElEREVOX0NMQVNTTkFNRSA9IFwiXCIuY29uY2F0KENMQVNTTkFNRSwgXCItLWhpZGRlblwiKTtcbiAgICAgICAgICB2YXIgU0hPV05fQ0xBU1NOQU1FID0gXCJcIi5jb25jYXQoQ0xBU1NOQU1FLCBcIi0tc2hvd25cIik7XG4gICAgICAgICAgdmFyIEVNUFRZX0lURU1fQ0xBU1NOQU1FID0gXCJcIi5jb25jYXQoSVRFTV9DTEFTU05BTUUsIFwiLS1lbXB0eVwiKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGZpbmRJdGVtUGFyZW50cyh0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBlbCA9IHRhcmdldDtcblxuICAgICAgICAgICAgd2hpbGUgKGVsICYmICFlbC5jbGFzc0xpc3QuY29udGFpbnMoSVRFTV9DTEFTU05BTUUpKSB7XG4gICAgICAgICAgICAgIGVsID0gZWwucGFyZW50RWxlbWVudDtcblxuICAgICAgICAgICAgICBpZiAoIWVsIHx8IGVsLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU05BTUUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGVsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU1lbnVFbGVtZW50KCkge1xuICAgICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgIC8qISBAL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL0lubGluZU1lbnVFbGVtZW50LmNzcyAqL1xuICAgICAgICAgICAgXCIuLi9zcmMvanMvY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvSW5saW5lTWVudUVsZW1lbnQuY3NzXCIpO1xuXG4gICAgICAgICAgICByZXR1cm4gKDAsIGRvbV8xLmNyZWF0ZUVsZW1lbnQpKFwidWxcIiwge1xuICAgICAgICAgICAgICBjbGFzc0xpc3Q6IENMQVNTTkFNRVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gYXR0YWNoRWxlbWVudChlbGVtZW50LCByZWN0LCBtZW51KSB7XG4gICAgICAgICAgICBtZW51LnN0eWxlLnRvcCA9IFwiXCIuY29uY2F0KHJlY3QudG9wLnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgIG1lbnUuc3R5bGUubGVmdCA9IFwiXCIuY29uY2F0KHJlY3QubGVmdC50b0ZpeGVkKCksIFwicHhcIik7XG4gICAgICAgICAgICBtZW51LnN0eWxlLndpZHRoID0gXCJcIi5jb25jYXQocmVjdC53aWR0aC50b0ZpeGVkKCksIFwicHhcIik7XG4gICAgICAgICAgICBtZW51LnN0eWxlLmxpbmVIZWlnaHQgPSBcIlwiLmNvbmNhdChyZWN0LmhlaWdodC50b0ZpeGVkKCksIFwicHhcIik7XG4gICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKG1lbnUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIG9wdGlvblRvTGkoX3JlZjI1LCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGNsYXNzTGlzdCA9IF9yZWYyNS5jbGFzc0xpc3QsXG4gICAgICAgICAgICAgICAgbGFiZWwgPSBfcmVmMjUubGFiZWwsXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBfcmVmMjUudmFsdWUsXG4gICAgICAgICAgICAgICAgaHRtbCA9IF9yZWYyNS5odG1sO1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSAoMCwgZG9tXzEuY3JlYXRlRWxlbWVudCkoXCJsaVwiLCB7XG4gICAgICAgICAgICAgIGNsYXNzTGlzdDogSVRFTV9DTEFTU05BTUVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaXRlbS50YWJJbmRleCA9IDA7XG4gICAgICAgICAgICBpdGVtLmRhdGFzZXQudmFsdWVpbmRleCA9IFwiXCIuY29uY2F0KGluZGV4KTtcblxuICAgICAgICAgICAgaWYgKGNsYXNzTGlzdCkge1xuICAgICAgICAgICAgICB2YXIgX2l0ZW0kY2xhc3NMaXN0O1xuXG4gICAgICAgICAgICAgIChfaXRlbSRjbGFzc0xpc3QgPSBpdGVtLmNsYXNzTGlzdCkuYWRkLmFwcGx5KF9pdGVtJGNsYXNzTGlzdCwgX3RvQ29uc3VtYWJsZUFycmF5KEFycmF5LmlzQXJyYXkoY2xhc3NMaXN0KSA/IGNsYXNzTGlzdCA6IFtjbGFzc0xpc3RdKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgICB2YXIgc3BhbiA9ICgwLCBkb21fMS5jcmVhdGVFbGVtZW50KShcInNwYW5cIiwge1xuICAgICAgICAgICAgICAgIHRleHQ6IGxhYmVsXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChodG1sKSB7XG4gICAgICAgICAgICAgICgwLCBkb21fMS5hcHBlbmRIdG1sKShpdGVtLCBodG1sKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBcIlwiIHx8IHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKEVNUFRZX0lURU1fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gb3Blbk1lbnUoZ3JpZCwgZWRpdG9yLCBjb2wsIHJvdywgdmFsdWUsIG9wdGlvbnMsIG1lbnUpIHtcbiAgICAgICAgICAgIHZhciBjbGFzc0xpc3QgPSBlZGl0b3IuY2xhc3NMaXN0O1xuICAgICAgICAgICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKFNIT1dOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICBtZW51LmNsYXNzTGlzdC5hZGQoSElEREVOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAoMCwgZG9tXzEuZW1wdHkpKG1lbnUpO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5mb250ID0gZ3JpZC5mb250IHx8IFwiMTZweCBzYW5zLXNlcmlmXCI7XG4gICAgICAgICAgICB2YXIgZW1wdHlJdGVtRWwgPSBudWxsO1xuICAgICAgICAgICAgdmFyIHZhbHVlSXRlbUVsID0gbnVsbDtcbiAgICAgICAgICAgIG9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAob3B0aW9uLCBpKSB7XG4gICAgICAgICAgICAgIHZhciBpdGVtID0gb3B0aW9uVG9MaShvcHRpb24sIGkpO1xuICAgICAgICAgICAgICBtZW51LmFwcGVuZENoaWxkKGl0ZW0pO1xuXG4gICAgICAgICAgICAgIGlmIChvcHRpb24udmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVJdGVtRWwgPSBpdGVtO1xuICAgICAgICAgICAgICAgIGl0ZW0uZGF0YXNldC5zZWxlY3QgPSBcInNlbGVjdFwiO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKEVNUFRZX0lURU1fQ0xBU1NOQU1FKSkge1xuICAgICAgICAgICAgICAgIGVtcHR5SXRlbUVsID0gaXRlbTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgZm9jdXNFbCA9IHZhbHVlSXRlbUVsIHx8IGVtcHR5SXRlbUVsIHx8IG1lbnUuY2hpbGRyZW5bMF07XG5cbiAgICAgICAgICAgIGlmIChjbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgdmFyIF9tZW51JGNsYXNzTGlzdDtcblxuICAgICAgICAgICAgICAoX21lbnUkY2xhc3NMaXN0ID0gbWVudS5jbGFzc0xpc3QpLmFkZC5hcHBseShfbWVudSRjbGFzc0xpc3QsIF90b0NvbnN1bWFibGVBcnJheShjbGFzc0xpc3QpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwobWVudS5jaGlsZHJlbiwgMCk7XG4gICAgICAgICAgICB2YXIgZm9jdXNJbmRleCA9IGNoaWxkcmVuLmluZGV4T2YoZm9jdXNFbCk7XG5cbiAgICAgICAgICAgIHZhciBfZ3JpZCRnZXRBdHRhY2hDZWxsc0EyID0gZ3JpZC5nZXRBdHRhY2hDZWxsc0FyZWEoZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpKSxcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gX2dyaWQkZ2V0QXR0YWNoQ2VsbHNBMi5lbGVtZW50LFxuICAgICAgICAgICAgICAgIHJlY3QgPSBfZ3JpZCRnZXRBdHRhY2hDZWxsc0EyLnJlY3Q7IC8vIENvdmVyIHRoZSByaWdodCBsaW5lXG5cblxuICAgICAgICAgICAgcmVjdC53aWR0aCsrOyAvLyBhcHBlbmQgZm9yIGNhbGN1bGF0aW9uXG5cbiAgICAgICAgICAgIGF0dGFjaEVsZW1lbnQoZWxlbWVudCwgcmVjdCwgbWVudSk7IC8vIE1ha2UgdGhlIHNlbGVjdGlvbiBpdGVtIGF0IHRoZSBtaWRkbGVcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDA7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZm9jdXNJbmRleDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBvZmZzZXRIZWlnaHQgPSBjaGlsZHJlbltpXS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICAgIG9mZnNldCArPSBvZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlY3Qub2Zmc2V0VG9wKC1vZmZzZXQpO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSBcImNlbnRlciBcIi5jb25jYXQob2Zmc2V0ICsgTWF0aC5jZWlsKGNoaWxkcmVuW2ZvY3VzSW5kZXhdLm9mZnNldEhlaWdodCAvIDIpLCBcInB4IDBweFwiKTtcbiAgICAgICAgICAgIGF0dGFjaEVsZW1lbnQoZWxlbWVudCwgcmVjdCwgbWVudSk7IC8vIENvbnRyb2wgbm90IHRvIG92ZXJmbG93IHRoZSBzY3JlZW4gcmFuZ2VcblxuICAgICAgICAgICAgdmFyIGJrVHJhbnNmb3JtID0gbWVudS5zdHlsZS50cmFuc2Zvcm07XG4gICAgICAgICAgICB2YXIgbWVudUNsaWVudFJlY3Q7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIC8vIFRvIGNhbGN1bGF0ZSB0aGUgb3JpZ2luYWwgcG9zaXRpb24sIHNldCBgdHJhbnNmb3JtYCB0byBgbm9uZWAuXG4gICAgICAgICAgICAgIG1lbnUuc3R5bGUudHJhbnNmb3JtID0gXCJub25lXCI7XG4gICAgICAgICAgICAgIG1lbnVDbGllbnRSZWN0ID0gbWVudS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgIG1lbnUuc3R5bGUudHJhbnNmb3JtID0gYmtUcmFuc2Zvcm07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBvcmdNZW51VG9wID0gbWVudUNsaWVudFJlY3QudG9wO1xuICAgICAgICAgICAgdmFyIG1lbnVUb3AgPSBvcmdNZW51VG9wO1xuICAgICAgICAgICAgdmFyIHdpbkJvdHRvbSA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICAgICAgICAgIHZhciB3aW5NYXJnaW4gPSAyMDtcblxuICAgICAgICAgICAgaWYgKG1lbnVDbGllbnRSZWN0LmJvdHRvbSA+IHdpbkJvdHRvbSAtIHdpbk1hcmdpbikge1xuICAgICAgICAgICAgICB2YXIgZGlmZiA9IG1lbnVDbGllbnRSZWN0LmJvdHRvbSAtIHdpbkJvdHRvbSArIHdpbk1hcmdpbjtcbiAgICAgICAgICAgICAgbWVudVRvcCAtPSBkaWZmO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobWVudVRvcCA8IDBcbiAgICAgICAgICAgIC8qd2luVG9wKi9cbiAgICAgICAgICAgICsgd2luTWFyZ2luKSB7XG4gICAgICAgICAgICAgIG1lbnVUb3AgPSB3aW5NYXJnaW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChtZW51VG9wICE9PSBvcmdNZW51VG9wKSB7XG4gICAgICAgICAgICAgIHJlY3Qub2Zmc2V0VG9wKC0ob3JnTWVudVRvcCAtIG1lbnVUb3ApKTsgLy8gU2V0cyB0aGUgY2VudGVyIG9mIHRoZSBtZW51IHNpbmNlIGl0IGlzIG5vdCBwb3NzaWJsZSB0byBkZXRlcm1pbmUgdGhlIGV4YWN0IGNlbnRlciBvZiB0aGUgc2VsZWN0ZWQgZWxlbWVudC5cblxuICAgICAgICAgICAgICBtZW51LnN0eWxlLnRyYW5zZm9ybU9yaWdpbiA9IFwiY2VudGVyXCI7IC8vIHJlIHVwZGF0ZVxuXG4gICAgICAgICAgICAgIGF0dGFjaEVsZW1lbnQoZWxlbWVudCwgcmVjdCwgbWVudSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb2N1c0VsKSB7XG4gICAgICAgICAgICAgIGZvY3VzRWwuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKEhJRERFTl9DTEFTU05BTUUpO1xuICAgICAgICAgICAgbWVudS5jbGFzc0xpc3QuYWRkKFNIT1dOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY2xvc2VNZW51KF9ncmlkLCBfY29sLCBfcm93LCBtZW51KSB7XG4gICAgICAgICAgICBtZW51LmNsYXNzTGlzdC5yZW1vdmUoU0hPV05fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgIG1lbnUuY2xhc3NMaXN0LmFkZChISURERU5fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICgwLCBkb21fMS5kaXNhYmxlRm9jdXMpKG1lbnUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBJbmxpbmVNZW51RWxlbWVudCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBJbmxpbmVNZW51RWxlbWVudCgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzMzIgPSB0aGlzO1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmxpbmVNZW51RWxlbWVudCk7XG5cbiAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLl9oYW5kbGVyID0gbmV3IEV2ZW50SGFuZGxlcl8xLkV2ZW50SGFuZGxlcigpO1xuICAgICAgICAgICAgICB0aGlzLl9tZW51ID0gY3JlYXRlTWVudUVsZW1lbnQoKTtcblxuICAgICAgICAgICAgICB0aGlzLl9iaW5kTWVudUV2ZW50cygpO1xuXG4gICAgICAgICAgICAgIHZhciBib2R5Q2xpY2tMaXN0ZW5lcklkO1xuXG4gICAgICAgICAgICAgIHZhciBkZXJlZ2lzdGVyQm9keUNsaWNrTGlzdGVuZXIgPSB0aGlzLl9kZXJlZ2lzdGVyQm9keUNsaWNrTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXIub2ZmKGJvZHlDbGlja0xpc3RlbmVySWQpO1xuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIHRoaXMuX3JlZ2lzdGVyQm9keUNsaWNrTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZGVyZWdpc3RlckJvZHlDbGlja0xpc3RlbmVyKCk7XG4gICAgICAgICAgICAgICAgYm9keUNsaWNrTGlzdGVuZXJJZCA9IGhhbmRsZXIub24oZG9jdW1lbnQuYm9keSwgXCJjbGlja1wiLCBfdGhpczMyLl9vbkJvZHlDbGljay5iaW5kKF90aGlzMzIpLCB7XG4gICAgICAgICAgICAgICAgICBjYXB0dXJlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbmxpbmVNZW51RWxlbWVudCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1lbnUgPSB0aGlzLl9tZW51O1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVyLmRpc3Bvc2UoKTsgLy8gQHRzLWV4cGVjdC1lcnJvciAtLSBpZ25vcmVcblxuXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX21lbnU7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmVmb3JlUHJvcEVkaXRvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgKF9hID0gbWVudS5wYXJlbnRFbGVtZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVtb3ZlQ2hpbGQobWVudSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImF0dGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoKGdyaWQsIGVkaXRvciwgY29sLCByb3csIHZhbHVlLCByZWNvcmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVudSA9IHRoaXMuX21lbnU7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYmVmb3JlUHJvcEVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzTGlzdCA9IHRoaXMuX2JlZm9yZVByb3BFZGl0b3IuY2xhc3NMaXN0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfbWVudSRjbGFzc0xpc3QyO1xuXG4gICAgICAgICAgICAgICAgICAgIChfbWVudSRjbGFzc0xpc3QyID0gbWVudS5jbGFzc0xpc3QpLnJlbW92ZS5hcHBseShfbWVudSRjbGFzc0xpc3QyLCBfdG9Db25zdW1hYmxlQXJyYXkoY2xhc3NMaXN0KSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBlZGl0b3Iub3B0aW9ucyhyZWNvcmQpO1xuICAgICAgICAgICAgICAgIG9wZW5NZW51KGdyaWQsIGVkaXRvciwgY29sLCByb3csIHZhbHVlLCBvcHRpb25zLCBtZW51KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmVEYXRhID0ge1xuICAgICAgICAgICAgICAgICAgZ3JpZDogZ3JpZCxcbiAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgcm93OiByb3csXG4gICAgICAgICAgICAgICAgICBlZGl0b3I6IGVkaXRvcixcbiAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuX2JlZm9yZVByb3BFZGl0b3IgPSBlZGl0b3I7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9yZWdpc3RlckJvZHlDbGlja0xpc3RlbmVyKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRldGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGV0YWNoKGdyaWRGb2N1cykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX3RoaXMkX2FjdGl2ZURhdGEzID0gdGhpcy5fYWN0aXZlRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICBncmlkID0gX3RoaXMkX2FjdGl2ZURhdGEzLmdyaWQsXG4gICAgICAgICAgICAgICAgICAgICAgY29sID0gX3RoaXMkX2FjdGl2ZURhdGEzLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3cgPSBfdGhpcyRfYWN0aXZlRGF0YTMucm93O1xuICAgICAgICAgICAgICAgICAgdmFyIG1lbnUgPSB0aGlzLl9tZW51O1xuICAgICAgICAgICAgICAgICAgY2xvc2VNZW51KGdyaWQsIGNvbCwgcm93LCBtZW51KTtcbiAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGdyaWQuZ2V0Q2VsbFJhbmdlKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChncmlkRm9jdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZURhdGEgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVyZWdpc3RlckJvZHlDbGlja0xpc3RlbmVyKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9kb0NoYW5nZVZhbHVlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9DaGFuZ2VWYWx1ZSh2YWx1ZWluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF9hY3RpdmVEYXRhNCA9IHRoaXMuX2FjdGl2ZURhdGEsXG4gICAgICAgICAgICAgICAgICAgIGdyaWQgPSBfdGhpcyRfYWN0aXZlRGF0YTQuZ3JpZCxcbiAgICAgICAgICAgICAgICAgICAgY29sID0gX3RoaXMkX2FjdGl2ZURhdGE0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gX3RoaXMkX2FjdGl2ZURhdGE0LnJvdyxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9IF90aGlzJF9hY3RpdmVEYXRhNC5vcHRpb25zO1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zW051bWJlcih2YWx1ZWluZGV4KV07XG5cbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBvcHRpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgICBncmlkLmRvQ2hhbmdlVmFsdWUoY29sLCByb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfaXNBY3RpdmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pc0FjdGl2ZSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVudSA9IHRoaXMuX21lbnU7XG5cbiAgICAgICAgICAgICAgICBpZiAoIW1lbnUgfHwgIW1lbnUucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fYWN0aXZlRGF0YSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfYmluZE1lbnVFdmVudHNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9iaW5kTWVudUV2ZW50cygpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXI7XG4gICAgICAgICAgICAgICAgdmFyIG1lbnUgPSB0aGlzLl9tZW51O1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0b3BQcm9wYWdhdGlvbk9ubHkgPSBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb25Pbmx5KGUpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH07IC8vIGdyaWTjgavjgqTjg5njg7Pjg4jjgYzkvJ3mkq3jgZfjgarjgYTjgojjgYbjgatcblxuXG4gICAgICAgICAgICAgICAgaGFuZGxlci5vbihtZW51LCBcIm1vdXNlZG93blwiLCBzdG9wUHJvcGFnYXRpb25Pbmx5KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKG1lbnUsIFwidG91Y2hzdGFydFwiLCBzdG9wUHJvcGFnYXRpb25Pbmx5KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKG1lbnUsIFwiZGJsY2xpY2tcIiwgc3RvcFByb3BhZ2F0aW9uT25seSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5vbihtZW51LCBcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBmaW5kSXRlbVBhcmVudHMoZS50YXJnZXQpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIWl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgdmFsdWVpbmRleCA9IGl0ZW0uZGF0YXNldC52YWx1ZWluZGV4O1xuXG4gICAgICAgICAgICAgICAgICBfdGhpczMzLl9kb0NoYW5nZVZhbHVlKHZhbHVlaW5kZXggfHwgXCJcIik7XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzMzMuZGV0YWNoKHRydWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGhhbmRsZXIub24obWVudSwgXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGZpbmRJdGVtUGFyZW50cyhlLnRhcmdldCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gdXRpbHNfMS5ldmVudC5nZXRLZXlDb2RlKGUpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoa2V5Q29kZSA9PT0gS0VZX0VOVEVSKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMzMuX29uS2V5ZG93bkVudGVyKG1lbnUsIGl0ZW0sIGUpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBLRVlfRVNDKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMzMuZGV0YWNoKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHV0aWxzXzEuZXZlbnQuY2FuY2VsKGUpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBLRVlfVVApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSAoMCwgZG9tXzEuZmluZFByZXZTaWJsaW5nRm9jdXNhYmxlKShpdGVtKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgICAgICAgICAgIG4uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICB1dGlsc18xLmV2ZW50LmNhbmNlbChlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBLRVlfRE9XTikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX24gPSAoMCwgZG9tXzEuZmluZE5leHRTaWJsaW5nRm9jdXNhYmxlKShpdGVtKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoX24pIHtcbiAgICAgICAgICAgICAgICAgICAgICBfbi5mb2N1cygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gS0VZX1RBQikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczMzLl9vbktleWRvd25UYWIobWVudSwgaXRlbSwgZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9vbkJvZHlDbGlja1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uQm9keUNsaWNrKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBlLnRhcmdldDtcblxuICAgICAgICAgICAgICAgIGlmICghZWwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVudS5jb250YWlucyhlbCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLl9hY3RpdmVEYXRhLmdyaWQ7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChncmlkLmdldEVsZW1lbnQoKS5jb250YWlucyhlbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9vbktleWRvd25FbnRlclwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uS2V5ZG93bkVudGVyKF9tZW51LCBpdGVtLCBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLl9pc0FjdGl2ZSgpID8gdGhpcy5fYWN0aXZlRGF0YS5ncmlkIDogbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVpbmRleCA9IGl0ZW0uZGF0YXNldC52YWx1ZWluZGV4O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9DaGFuZ2VWYWx1ZSh2YWx1ZWluZGV4IHx8IFwiXCIpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ3JpZCkge1xuICAgICAgICAgICAgICAgICAgaWYgKChfYSA9IGdyaWQua2V5Ym9hcmRPcHRpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubW92ZUNlbGxPbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQub25LZXlEb3duTW92ZShlKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9vbktleWRvd25UYWJcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbktleWRvd25UYWIobWVudSwgaXRlbSwgZSkge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuX2FjdGl2ZURhdGEuZ3JpZDtcblxuICAgICAgICAgICAgICAgICAgaWYgKChfYSA9IGdyaWQua2V5Ym9hcmRPcHRpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubW92ZUNlbGxPblRhYikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVpbmRleCA9IGl0ZW0uZGF0YXNldC52YWx1ZWluZGV4O1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RvQ2hhbmdlVmFsdWUodmFsdWVpbmRleCB8fCBcIlwiKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFjaCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5vbktleURvd25Nb3ZlKGUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgICBpZiAoISgwLCBkb21fMS5maW5kTmV4dFNpYmxpbmdGb2N1c2FibGUpKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuID0gbWVudS5xdWVyeVNlbGVjdG9yKFwiLlwiLmNvbmNhdChJVEVNX0NMQVNTTkFNRSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghKDAsIGRvbV8xLmlzRm9jdXNhYmxlKShuKSkge1xuICAgICAgICAgICAgICAgICAgICAgIG4gPSAoMCwgZG9tXzEuZmluZE5leHRTaWJsaW5nRm9jdXNhYmxlKShuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbi5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgIHV0aWxzXzEuZXZlbnQuY2FuY2VsKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmICghKDAsIGRvbV8xLmZpbmRQcmV2U2libGluZ0ZvY3VzYWJsZSkoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zID0gbWVudS5xdWVyeVNlbGVjdG9yQWxsKFwiLlwiLmNvbmNhdChJVEVNX0NMQVNTTkFNRSkpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgX24yID0gaXRlbXNbaXRlbXMubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoMCwgZG9tXzEuaXNGb2N1c2FibGUpKF9uMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICBfbjIgPSAoMCwgZG9tXzEuZmluZFByZXZTaWJsaW5nRm9jdXNhYmxlKShfbjIpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKF9uMikge1xuICAgICAgICAgICAgICAgICAgICAgIF9uMi5mb2N1cygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIElubGluZU1lbnVFbGVtZW50O1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuSW5saW5lTWVudUVsZW1lbnQgPSBJbmxpbmVNZW51RWxlbWVudDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9TbWFsbERpYWxvZ0lucHV0RWxlbWVudC5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL1NtYWxsRGlhbG9nSW5wdXRFbGVtZW50LmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc0FjdGlvbkludGVybmFsU21hbGxEaWFsb2dJbnB1dEVsZW1lbnRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlNtYWxsRGlhbG9nSW5wdXRFbGVtZW50ID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBFdmVudEhhbmRsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2ludGVybmFsL0V2ZW50SGFuZGxlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgZG9tXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9pbnRlcm5hbC9kb20gKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvZG9tLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGlucHV0X3ZhbHVlX2hhbmRsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaW5wdXQtdmFsdWUtaGFuZGxlciAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9pbnB1dC12YWx1ZS1oYW5kbGVyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIENMQVNTTkFNRSA9IFwiY2hlZXRhaC1ncmlkX19zbWFsbC1kaWFsb2ctaW5wdXRcIjtcbiAgICAgICAgICB2YXIgSU5QVVRfQ0xBU1NOQU1FID0gXCJcIi5jb25jYXQoQ0xBU1NOQU1FLCBcIl9faW5wdXRcIik7XG4gICAgICAgICAgdmFyIEhJRERFTl9DTEFTU05BTUUgPSBcIlwiLmNvbmNhdChDTEFTU05BTUUsIFwiLS1oaWRkZW5cIik7XG4gICAgICAgICAgdmFyIFNIT1dOX0NMQVNTTkFNRSA9IFwiXCIuY29uY2F0KENMQVNTTkFNRSwgXCItLXNob3duXCIpO1xuICAgICAgICAgIHZhciBLRVlfRU5URVIgPSAxMztcbiAgICAgICAgICB2YXIgS0VZX0VTQyA9IDI3O1xuXG4gICAgICAgICAgZnVuY3Rpb24gX2ZvY3VzKGlucHV0LCBoYW5kbGVyKSB7XG4gICAgICAgICAgICB2YXIgZm9jdXMgPSBmdW5jdGlvbiBmb2N1cygpIHtcbiAgICAgICAgICAgICAgaW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgdmFyIGVuZCA9IGlucHV0LnZhbHVlLmxlbmd0aDtcblxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQuc2VsZWN0aW9uU3RhcnQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgIGlucHV0LnNlbGVjdGlvblN0YXJ0ID0gZW5kO1xuICAgICAgICAgICAgICAgICAgaW5wdXQuc2VsZWN0aW9uRW5kID0gZW5kO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgey8vaWdub3JlXG4gICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuXG4gICAgICAgICAgICAgIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGlucHV0LmNyZWF0ZVRleHRSYW5nZSgpO1xuICAgICAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKCk7XG4gICAgICAgICAgICAgICAgcmFuZ2UubW92ZUVuZChcImNoYXJhY3RlclwiLCBlbmQpO1xuICAgICAgICAgICAgICAgIHJhbmdlLm1vdmVTdGFydChcImNoYXJhY3RlclwiLCBlbmQpO1xuICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBoYW5kbGVyLnRyeVdpdGhPZmZFdmVudHMoaW5wdXQsIFwiYmx1clwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGZvY3VzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVEaWFsb2dFbGVtZW50KCkge1xuICAgICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgIC8qISBAL2NvbHVtbnMvYWN0aW9uL2ludGVybmFsL1NtYWxsRGlhbG9nSW5wdXRFbGVtZW50LmNzcyAqL1xuICAgICAgICAgICAgXCIuLi9zcmMvanMvY29sdW1ucy9hY3Rpb24vaW50ZXJuYWwvU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQuY3NzXCIpO1xuXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9ICgwLCBkb21fMS5jcmVhdGVFbGVtZW50KShcImRpdlwiLCB7XG4gICAgICAgICAgICAgIGNsYXNzTGlzdDogW0NMQVNTTkFNRSwgSElEREVOX0NMQVNTTkFNRV1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGlucHV0ID0gKDAsIGRvbV8xLmNyZWF0ZUVsZW1lbnQpKFwiaW5wdXRcIiwge1xuICAgICAgICAgICAgICBjbGFzc0xpc3Q6IElOUFVUX0NMQVNTTkFNRVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpbnB1dC5yZWFkT25seSA9IHRydWU7XG4gICAgICAgICAgICBpbnB1dC50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBiaW5kUHJvcHMoZ3JpZCwgZGlhbG9nLCBpbnB1dCwgZWRpdG9yKSB7XG4gICAgICAgICAgICB2YXIgY2xhc3NMaXN0ID0gZWRpdG9yLmNsYXNzTGlzdCxcbiAgICAgICAgICAgICAgICBoZWxwZXJUZXh0ID0gZWRpdG9yLmhlbHBlclRleHQ7XG5cbiAgICAgICAgICAgIGlmIChjbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgdmFyIF9kaWFsb2ckY2xhc3NMaXN0O1xuXG4gICAgICAgICAgICAgIChfZGlhbG9nJGNsYXNzTGlzdCA9IGRpYWxvZy5jbGFzc0xpc3QpLmFkZC5hcHBseShfZGlhbG9nJGNsYXNzTGlzdCwgX3RvQ29uc3VtYWJsZUFycmF5KGNsYXNzTGlzdCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaGVscGVyVGV4dCAmJiB0eXBlb2YgaGVscGVyVGV4dCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIGRpYWxvZy5kYXRhc2V0LmhlbHBlclRleHQgPSBoZWxwZXJUZXh0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfc2V0SW5wdXRBdHRyczIoZWRpdG9yLCBncmlkLCBpbnB1dCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdW5iaW5kUHJvcHMoX2dyaWQsIGRpYWxvZywgaW5wdXQsIGVkaXRvcikge1xuICAgICAgICAgICAgdmFyIGNsYXNzTGlzdCA9IGVkaXRvci5jbGFzc0xpc3Q7XG5cbiAgICAgICAgICAgIGlmIChjbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgdmFyIF9kaWFsb2ckY2xhc3NMaXN0MjtcblxuICAgICAgICAgICAgICAoX2RpYWxvZyRjbGFzc0xpc3QyID0gZGlhbG9nLmNsYXNzTGlzdCkucmVtb3ZlLmFwcGx5KF9kaWFsb2ckY2xhc3NMaXN0MiwgX3RvQ29uc3VtYWJsZUFycmF5KGNsYXNzTGlzdCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWxldGUgZGlhbG9nLmRhdGFzZXQuaGVscGVyVGV4dDtcbiAgICAgICAgICAgIGlucHV0LnR5cGUgPSBcIlwiO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIF9zZXRJbnB1dEF0dHJzMihlZGl0b3IsIF9ncmlkLCBpbnB1dCkge1xuICAgICAgICAgICAgdmFyIHR5cGUgPSBlZGl0b3IudHlwZTtcbiAgICAgICAgICAgIGlucHV0LnR5cGUgPSB0eXBlIHx8IFwiXCI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIFNtYWxsRGlhbG9nSW5wdXRFbGVtZW50ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFNtYWxsRGlhbG9nSW5wdXRFbGVtZW50KCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIgPSBuZXcgRXZlbnRIYW5kbGVyXzEuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgICAgICAgIHRoaXMuX2RpYWxvZyA9IGNyZWF0ZURpYWxvZ0VsZW1lbnQoKTtcbiAgICAgICAgICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9kaWFsb2cucXVlcnlTZWxlY3RvcihcIi5cIi5jb25jYXQoSU5QVVRfQ0xBU1NOQU1FKSk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fYmluZERpYWxvZ0V2ZW50cygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIHZhciBkaWFsb2cgPSB0aGlzLl9kaWFsb2c7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2goKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIuZGlzcG9zZSgpOyAvLyBAdHMtZXhwZWN0LWVycm9yIC0tIGlnbm9yZVxuXG5cbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fZGlhbG9nOyAvLyBAdHMtZXhwZWN0LWVycm9yIC0tIGlnbm9yZVxuXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2lucHV0O1xuICAgICAgICAgICAgICAgIHRoaXMuX2JlZm9yZVByb3BFZGl0b3IgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRpYWxvZy5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICBkaWFsb2cucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChkaWFsb2cpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYXR0YWNoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdHRhY2goZ3JpZCwgZWRpdG9yLCBjb2wsIHJvdywgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMzNCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXI7XG4gICAgICAgICAgICAgICAgdmFyIGRpYWxvZyA9IHRoaXMuX2RpYWxvZztcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGlzLl9pbnB1dDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iZWZvcmVQcm9wRWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICB1bmJpbmRQcm9wcyhncmlkLCBkaWFsb2csIGlucHV0LCB0aGlzLl9iZWZvcmVQcm9wRWRpdG9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkZWxldGUgZGlhbG9nLmRhdGFzZXQuZXJyb3JNZXNzYWdlO1xuICAgICAgICAgICAgICAgIGRpYWxvZy5jbGFzc0xpc3QucmVtb3ZlKFNIT1dOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgZGlhbG9nLmNsYXNzTGlzdC5hZGQoSElEREVOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgaW5wdXQucmVhZE9ubHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlucHV0LnRhYkluZGV4ID0gMDtcblxuICAgICAgICAgICAgICAgIHZhciBfZ3JpZCRnZXRBdHRhY2hDZWxsc0EzID0gZ3JpZC5nZXRBdHRhY2hDZWxsc0FyZWEoZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpKSxcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IF9ncmlkJGdldEF0dGFjaENlbGxzQTMuZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgcmVjdCA9IF9ncmlkJGdldEF0dGFjaENlbGxzQTMucmVjdDtcblxuICAgICAgICAgICAgICAgIGRpYWxvZy5zdHlsZS50b3AgPSBcIlwiLmNvbmNhdChyZWN0LnRvcC50b0ZpeGVkKCksIFwicHhcIik7XG4gICAgICAgICAgICAgICAgZGlhbG9nLnN0eWxlLmxlZnQgPSBcIlwiLmNvbmNhdChyZWN0LmxlZnQudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgIGRpYWxvZy5zdHlsZS53aWR0aCA9IFwiXCIuY29uY2F0KHJlY3Qud2lkdGgudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmhlaWdodCA9IFwiXCIuY29uY2F0KHJlY3QuaGVpZ2h0LnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRpYWxvZyk7XG4gICAgICAgICAgICAgICAgKDAsIGlucHV0X3ZhbHVlX2hhbmRsZXJfMS5zZXRJbnB1dFZhbHVlKShpbnB1dCwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmZvbnQgPSBncmlkLmZvbnQgfHwgXCIxNnB4IHNhbnMtc2VyaWZcIjtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZlRGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgIGdyaWQ6IGdyaWQsXG4gICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogcm93LFxuICAgICAgICAgICAgICAgICAgZWRpdG9yOiBlZGl0b3JcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fb25JbnB1dFZhbHVlKGlucHV0LCBhY3RpdmVEYXRhKTtcblxuICAgICAgICAgICAgICAgIGlmICghdXRpbHNfMS5icm93c2VyLklFKSB7XG4gICAgICAgICAgICAgICAgICBfZm9jdXMoaW5wdXQsIGhhbmRsZXIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvLyBPbiB0aGUgcGFzdGUtZXZlbnQgb24gSUUsIHNpbmNlIGl0IG1heSBub3QgYmUgZm9jdXNlZCwgaXQgd2lsbCBiZSBkZWxheWVkIGFuZCBmb2N1c2VkLlxuICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfZm9jdXMoaW5wdXQsIGhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZGlhbG9nLmNsYXNzTGlzdC5hZGQoU0hPV05fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICAgICBkaWFsb2cuY2xhc3NMaXN0LnJlbW92ZShISURERU5fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICAgICBpbnB1dC5yZWFkT25seSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJpbmRQcm9wcyhncmlkLCBkaWFsb2csIGlucHV0LCBlZGl0b3IpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZURhdGEgPSBhY3RpdmVEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXMuX2JlZm9yZVByb3BFZGl0b3IgPSBlZGl0b3I7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpczM0Ll9hdHRhY2hpbmc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRldGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGV0YWNoKGdyaWRGb2N1cykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgZGlhbG9nID0gdGhpcy5fZGlhbG9nO1xuICAgICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5faW5wdXQ7XG4gICAgICAgICAgICAgICAgICBkaWFsb2cuY2xhc3NMaXN0LnJlbW92ZShTSE9XTl9DTEFTU05BTUUpO1xuICAgICAgICAgICAgICAgICAgZGlhbG9nLmNsYXNzTGlzdC5hZGQoSElEREVOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgICBpbnB1dC5yZWFkT25seSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICBpbnB1dC50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgICAgICAgdmFyIF90aGlzJF9hY3RpdmVEYXRhNSA9IHRoaXMuX2FjdGl2ZURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgZ3JpZCA9IF90aGlzJF9hY3RpdmVEYXRhNS5ncmlkLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbCA9IF90aGlzJF9hY3RpdmVEYXRhNS5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93ID0gX3RoaXMkX2FjdGl2ZURhdGE1LnJvdztcbiAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGdyaWQuZ2V0Q2VsbFJhbmdlKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChncmlkRm9jdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZURhdGEgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX2JlZm9yZVZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2RvQ2hhbmdlVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0NoYW5nZVZhbHVlKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczM1ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5faXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IHRoaXMuX2lucHV0O1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGlucHV0LnZhbHVlO1xuICAgICAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS50aGVuKSh0aGlzLl92YWxpZGF0ZSh2YWx1ZSksIGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgdmFsdWUgPT09IGlucHV0LnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpczM1JF9hY3RpdmVEYXRhID0gX3RoaXMzNS5fYWN0aXZlRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyaWQgPSBfdGhpczM1JF9hY3RpdmVEYXRhLmdyaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wgPSBfdGhpczM1JF9hY3RpdmVEYXRhLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IF90aGlzMzUkX2FjdGl2ZURhdGEucm93O1xuICAgICAgICAgICAgICAgICAgICBncmlkLmRvQ2hhbmdlVmFsdWUoY29sLCByb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfaXNBY3RpdmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pc0FjdGl2ZSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlhbG9nID0gdGhpcy5fZGlhbG9nO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkaWFsb2cgfHwgIWRpYWxvZy5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9hY3RpdmVEYXRhKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9iaW5kRGlhbG9nRXZlbnRzXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYmluZERpYWxvZ0V2ZW50cygpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMzNiA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXI7XG4gICAgICAgICAgICAgICAgdmFyIGRpYWxvZyA9IHRoaXMuX2RpYWxvZztcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGlzLl9pbnB1dDtcblxuICAgICAgICAgICAgICAgIHZhciBzdG9wUHJvcGFnYXRpb25Pbmx5ID0gZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uT25seShlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB9OyAvLyBncmlk44Gr44Kk44OZ44Oz44OI44GM5Lyd5pKt44GX44Gq44GE44KI44GG44GrXG5cblxuICAgICAgICAgICAgICAgIGhhbmRsZXIub24oZGlhbG9nLCBcImNsaWNrXCIsIHN0b3BQcm9wYWdhdGlvbk9ubHkpO1xuICAgICAgICAgICAgICAgIGhhbmRsZXIub24oZGlhbG9nLCBcImRibGNsaWNrXCIsIHN0b3BQcm9wYWdhdGlvbk9ubHkpO1xuICAgICAgICAgICAgICAgIGhhbmRsZXIub24oZGlhbG9nLCBcIm1vdXNlZG93blwiLCBzdG9wUHJvcGFnYXRpb25Pbmx5KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGRpYWxvZywgXCJ0b3VjaHN0YXJ0XCIsIHN0b3BQcm9wYWdhdGlvbk9ubHkpO1xuICAgICAgICAgICAgICAgIGhhbmRsZXIub24oaW5wdXQsIFwiY29tcG9zaXRpb25zdGFydFwiLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoXCJjb21wb3NpdGlvblwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImNvbXBvc2l0aW9uZW5kXCIsIGZ1bmN0aW9uIChfZSkge1xuICAgICAgICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcImNvbXBvc2l0aW9uXCIpO1xuXG4gICAgICAgICAgICAgICAgICBfdGhpczM2Ll9vbklucHV0VmFsdWUoaW5wdXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9uS2V5dXBBbmRQcmVzcyA9IGZ1bmN0aW9uIG9uS2V5dXBBbmRQcmVzcyhfZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGlucHV0LmNsYXNzTGlzdC5jb250YWlucyhcImNvbXBvc2l0aW9uXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX3RoaXMzNi5fb25JbnB1dFZhbHVlKGlucHV0KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaGFuZGxlci5vbihpbnB1dCwgXCJrZXl1cFwiLCBvbktleXVwQW5kUHJlc3MpO1xuICAgICAgICAgICAgICAgIGhhbmRsZXIub24oaW5wdXQsIFwia2V5cHJlc3NcIiwgb25LZXl1cEFuZFByZXNzKTtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoXCJjb21wb3NpdGlvblwiKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gdXRpbHNfMS5ldmVudC5nZXRLZXlDb2RlKGUpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoa2V5Q29kZSA9PT0gS0VZX0VTQykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczM2LmRldGFjaCh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICB1dGlsc18xLmV2ZW50LmNhbmNlbChlKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gS0VZX0VOVEVSKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMzYuX29uS2V5ZG93bkVudGVyKGUpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzNi5fb25JbnB1dFZhbHVlKGlucHV0KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX29uS2V5ZG93bkVudGVyXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25LZXlkb3duRW50ZXIoZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczM3ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdHRhY2hpbmcpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGlzLl9pbnB1dDtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBpbnB1dC52YWx1ZTtcbiAgICAgICAgICAgICAgICAoMCwgdXRpbHNfMS50aGVuKSh0aGlzLl9kb0NoYW5nZVZhbHVlKCksIGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChyICYmIHZhbHVlID09PSBpbnB1dC52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IF90aGlzMzcuX2lzQWN0aXZlKCkgPyBfdGhpczM3Ll9hY3RpdmVEYXRhLmdyaWQgOiBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMzcuZGV0YWNoKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgoX2EgPSBncmlkID09PSBudWxsIHx8IGdyaWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdyaWQua2V5Ym9hcmRPcHRpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubW92ZUNlbGxPbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZ3JpZC5vbktleURvd25Nb3ZlKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9vbklucHV0VmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbklucHV0VmFsdWUoaW5wdXQsIGFjdGl2ZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmVmb3JlID0gdGhpcy5fYmVmb3JlVmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gaW5wdXQudmFsdWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmVmb3JlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5fb25JbnB1dFZhbHVlQ2hhbmdlKHZhbHVlLCBhY3RpdmVEYXRhKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9iZWZvcmVWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfb25JbnB1dFZhbHVlQ2hhbmdlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25JbnB1dFZhbHVlQ2hhbmdlKGFmdGVyLCBhY3RpdmVEYXRhKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlRGF0YSA9IGFjdGl2ZURhdGEgfHwgdGhpcy5fYWN0aXZlRGF0YTtcbiAgICAgICAgICAgICAgICB2YXIgZGlhbG9nID0gdGhpcy5fZGlhbG9nO1xuICAgICAgICAgICAgICAgIHZhciBfYWN0aXZlRGF0YSA9IGFjdGl2ZURhdGEsXG4gICAgICAgICAgICAgICAgICAgIGdyaWQgPSBfYWN0aXZlRGF0YS5ncmlkLFxuICAgICAgICAgICAgICAgICAgICBjb2wgPSBfYWN0aXZlRGF0YS5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IF9hY3RpdmVEYXRhLnJvdyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yID0gX2FjdGl2ZURhdGEuZWRpdG9yO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlZGl0b3IuaGVscGVyVGV4dCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgaGVscGVyVGV4dCA9IGVkaXRvci5oZWxwZXJUZXh0KGFmdGVyLCB7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQ6IGdyaWQsXG4gICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IHJvd1xuICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChoZWxwZXJUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRpYWxvZy5kYXRhc2V0LmhlbHBlclRleHQgPSBoZWxwZXJUZXh0O1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRpYWxvZy5kYXRhc2V0LmhlbHBlclRleHQ7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKFwiZXJyb3JNZXNzYWdlXCIgaW4gZGlhbG9nLmRhdGFzZXQpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbGlkYXRlKGFmdGVyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl92YWxpZGF0ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKHZhbHVlLCBpbnB1dE9ubHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlhbG9nID0gdGhpcy5fZGlhbG9nO1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IHRoaXMuX2lucHV0O1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfYWN0aXZlRGF0YTYgPSB0aGlzLl9hY3RpdmVEYXRhLFxuICAgICAgICAgICAgICAgICAgICBncmlkID0gX3RoaXMkX2FjdGl2ZURhdGE2LmdyaWQsXG4gICAgICAgICAgICAgICAgICAgIGNvbCA9IF90aGlzJF9hY3RpdmVEYXRhNi5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IF90aGlzJF9hY3RpdmVEYXRhNi5yb3csXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvciA9IF90aGlzJF9hY3RpdmVEYXRhNi5lZGl0b3I7XG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvci5pbnB1dFZhbGlkYXRvcikge1xuICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IGVkaXRvci5pbnB1dFZhbGlkYXRvcih2YWx1ZSwge1xuICAgICAgICAgICAgICAgICAgICBncmlkOiBncmlkLFxuICAgICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS50aGVuKShtZXNzYWdlLCBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKCFtZXNzYWdlICYmIGVkaXRvci52YWxpZGF0b3IgJiYgIWlucHV0T25seSkge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gZWRpdG9yLnZhbGlkYXRvcih2YWx1ZSwge1xuICAgICAgICAgICAgICAgICAgICAgIGdyaWQ6IGdyaWQsXG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS50aGVuKShtZXNzYWdlLCBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZSAmJiB2YWx1ZSA9PT0gaW5wdXQudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBkaWFsb2cuZGF0YXNldC5lcnJvck1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBkaWFsb2cuZGF0YXNldC5lcnJvck1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIW1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJzZXRJbnB1dEF0dHJzXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRJbnB1dEF0dHJzKGVkaXRvciwgZ3JpZCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICBfc2V0SW5wdXRBdHRyczIoZWRpdG9yLCBncmlkLCBpbnB1dCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFNtYWxsRGlhbG9nSW5wdXRFbGVtZW50O1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuU21hbGxEaWFsb2dJbnB1dEVsZW1lbnQgPSBTbWFsbERpYWxvZ0lucHV0RWxlbWVudDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9pbnB1dC12YWx1ZS1oYW5kbGVyLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL2FjdGlvbi9pbnRlcm5hbC9pbnB1dC12YWx1ZS1oYW5kbGVyLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zQWN0aW9uSW50ZXJuYWxJbnB1dFZhbHVlSGFuZGxlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuc2V0SW5wdXRWYWx1ZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBFdmVudEhhbmRsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2ludGVybmFsL0V2ZW50SGFuZGxlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIuanNcIik7XG5cbiAgICAgICAgICBmdW5jdGlvbiBzZXRJbnB1dFZhbHVlKGlucHV0LCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHNpZ24gPSBpbnB1dC50eXBlID09PSBcIm51bWJlclwiICYmIHZhbHVlID09PSBcIi1cIjtcblxuICAgICAgICAgICAgaWYgKHNpZ24pIHtcbiAgICAgICAgICAgICAgLy8gV2hlbiBgdHlwZT1cIm51bWJlclwiYCwgdGhlIG1pbnVzIHNpZ24gaXMgbm90IGFjY2VwdGVkLCBzbyBjaGFuZ2UgaXQgdG8gYHR5cGU9XCJ0ZXh0XCJgIG9uY2UuXG4gICAgICAgICAgICAgIGlucHV0LnR5cGUgPSBcIlwiO1xuICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IG5ldyBFdmVudEhhbmRsZXJfMS5FdmVudEhhbmRsZXIoKTtcblxuICAgICAgICAgICAgICB2YXIgZGlzcG9zZSA9IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgIGhhbmRsZXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIGhhbmRsZXIub25jZShpbnB1dCwgXCJpbnB1dFwiLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBpbnB1dC50eXBlID0gXCJudW1iZXJcIjtcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBoYW5kbGVyLm9uY2UoaW5wdXQsIFwiYmx1clwiLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB2b2lkIDAgPyB2YWx1ZSA6IFwiXCI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5zZXRJbnB1dFZhbHVlID0gc2V0SW5wdXRWYWx1ZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2luZGljYXRvci9oYW5kbGVycy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvaW5kaWNhdG9yL2hhbmRsZXJzLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc0luZGljYXRvckhhbmRsZXJzSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5nZXREcmF3SW5kaWNhdG9yID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHRyaWFuZ2xlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3RyaWFuZ2xlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvaW5kaWNhdG9yL3RyaWFuZ2xlLmpzXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0RHJhd0luZGljYXRvcihpbmRpY2F0b3JTdHlsZSkge1xuICAgICAgICAgICAgdmFyIHN0eWxlID0gaW5kaWNhdG9yU3R5bGUuc3R5bGU7XG5cbiAgICAgICAgICAgIGlmIChzdHlsZSA9PT0gXCJ0cmlhbmdsZVwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cmlhbmdsZV8xLmRyYXdUcmlhbmdsZUluZGljYXRvcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5nZXREcmF3SW5kaWNhdG9yID0gZ2V0RHJhd0luZGljYXRvcjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL2luZGljYXRvci90cmlhbmdsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvaW5kaWNhdG9yL3RyaWFuZ2xlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc0luZGljYXRvclRyaWFuZ2xlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICB2YXIgX0tJTkRfUFJPQ0VTU19NQVA7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5kcmF3VHJpYW5nbGVJbmRpY2F0b3IgPSB2b2lkIDA7XG4gICAgICAgICAgdmFyIEtJTkRfUFJPQ0VTU19NQVAgPSAoX0tJTkRfUFJPQ0VTU19NQVAgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9LSU5EX1BST0NFU1NfTUFQLCAwXG4gICAgICAgICAgLyogRHJhd0luZGljYXRvcktpbmQudG9wTGVmdCAqL1xuICAgICAgICAgICwge1xuICAgICAgICAgICAgdGhlbWVDb2xvcjogZnVuY3Rpb24gdGhlbWVDb2xvcihoZWxwZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlci50aGVtZS5pbmRpY2F0b3JzLnRvcExlZnRDb2xvcjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGVtZVNpemU6IGZ1bmN0aW9uIHRoZW1lU2l6ZShoZWxwZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlci50aGVtZS5pbmRpY2F0b3JzLnRvcExlZnRTaXplO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRyYXdQYXRoOiBmdW5jdGlvbiBkcmF3UGF0aChjdHgsIHJlY3QsIHNpemUpIHtcbiAgICAgICAgICAgICAgdmFyIGJhc2VMZWZ0ID0gcmVjdC5sZWZ0ICsgMTtcbiAgICAgICAgICAgICAgdmFyIGJhc2VUb3AgPSByZWN0LnRvcCArIDE7XG4gICAgICAgICAgICAgIGN0eC5tb3ZlVG8oYmFzZUxlZnQsIGJhc2VUb3ApO1xuICAgICAgICAgICAgICBjdHgubGluZVRvKGJhc2VMZWZ0ICsgc2l6ZSwgYmFzZVRvcCk7XG4gICAgICAgICAgICAgIGN0eC5saW5lVG8oYmFzZUxlZnQsIGJhc2VUb3AgKyBzaXplKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSwgX2RlZmluZVByb3BlcnR5KF9LSU5EX1BST0NFU1NfTUFQLCAxXG4gICAgICAgICAgLyogRHJhd0luZGljYXRvcktpbmQudG9wUmlnaHQgKi9cbiAgICAgICAgICAsIHtcbiAgICAgICAgICAgIHRoZW1lQ29sb3I6IGZ1bmN0aW9uIHRoZW1lQ29sb3IoaGVscGVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoZWxwZXIudGhlbWUuaW5kaWNhdG9ycy50b3BSaWdodENvbG9yO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoZW1lU2l6ZTogZnVuY3Rpb24gdGhlbWVTaXplKGhlbHBlcikge1xuICAgICAgICAgICAgICByZXR1cm4gaGVscGVyLnRoZW1lLmluZGljYXRvcnMudG9wUmlnaHRTaXplO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRyYXdQYXRoOiBmdW5jdGlvbiBkcmF3UGF0aChjdHgsIHJlY3QsIHNpemUpIHtcbiAgICAgICAgICAgICAgdmFyIGJhc2VSaWdodCA9IHJlY3QucmlnaHQgLSAyO1xuICAgICAgICAgICAgICB2YXIgYmFzZVRvcCA9IHJlY3QudG9wICsgMTtcbiAgICAgICAgICAgICAgY3R4Lm1vdmVUbyhiYXNlUmlnaHQsIGJhc2VUb3ApO1xuICAgICAgICAgICAgICBjdHgubGluZVRvKGJhc2VSaWdodCAtIHNpemUsIGJhc2VUb3ApO1xuICAgICAgICAgICAgICBjdHgubGluZVRvKGJhc2VSaWdodCwgYmFzZVRvcCArIHNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pLCBfZGVmaW5lUHJvcGVydHkoX0tJTkRfUFJPQ0VTU19NQVAsIDJcbiAgICAgICAgICAvKiBEcmF3SW5kaWNhdG9yS2luZC5ib3R0b21SaWdodCAqL1xuICAgICAgICAgICwge1xuICAgICAgICAgICAgdGhlbWVDb2xvcjogZnVuY3Rpb24gdGhlbWVDb2xvcihoZWxwZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlci50aGVtZS5pbmRpY2F0b3JzLmJvdHRvbVJpZ2h0Q29sb3I7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhlbWVTaXplOiBmdW5jdGlvbiB0aGVtZVNpemUoaGVscGVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoZWxwZXIudGhlbWUuaW5kaWNhdG9ycy5ib3R0b21SaWdodFNpemU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZHJhd1BhdGg6IGZ1bmN0aW9uIGRyYXdQYXRoKGN0eCwgcmVjdCwgc2l6ZSkge1xuICAgICAgICAgICAgICB2YXIgYmFzZVJpZ2h0ID0gcmVjdC5yaWdodCAtIDI7XG4gICAgICAgICAgICAgIHZhciBiYXNlQm90dG9tID0gcmVjdC5ib3R0b20gLSAyO1xuICAgICAgICAgICAgICBjdHgubW92ZVRvKGJhc2VSaWdodCwgYmFzZUJvdHRvbSk7XG4gICAgICAgICAgICAgIGN0eC5saW5lVG8oYmFzZVJpZ2h0IC0gc2l6ZSwgYmFzZUJvdHRvbSk7XG4gICAgICAgICAgICAgIGN0eC5saW5lVG8oYmFzZVJpZ2h0LCBiYXNlQm90dG9tIC0gc2l6ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSksIF9kZWZpbmVQcm9wZXJ0eShfS0lORF9QUk9DRVNTX01BUCwgM1xuICAgICAgICAgIC8qIERyYXdJbmRpY2F0b3JLaW5kLmJvdHRvbUxlZnQgKi9cbiAgICAgICAgICAsIHtcbiAgICAgICAgICAgIHRoZW1lQ29sb3I6IGZ1bmN0aW9uIHRoZW1lQ29sb3IoaGVscGVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoZWxwZXIudGhlbWUuaW5kaWNhdG9ycy5ib3R0b21MZWZ0Q29sb3I7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhlbWVTaXplOiBmdW5jdGlvbiB0aGVtZVNpemUoaGVscGVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoZWxwZXIudGhlbWUuaW5kaWNhdG9ycy5ib3R0b21MZWZ0U2l6ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkcmF3UGF0aDogZnVuY3Rpb24gZHJhd1BhdGgoY3R4LCByZWN0LCBzaXplKSB7XG4gICAgICAgICAgICAgIHZhciBiYXNlTGVmdCA9IHJlY3QubGVmdCArIDE7XG4gICAgICAgICAgICAgIHZhciBiYXNlQm90dG9tID0gcmVjdC5ib3R0b20gLSAyO1xuICAgICAgICAgICAgICBjdHgubW92ZVRvKGJhc2VMZWZ0LCBiYXNlQm90dG9tKTtcbiAgICAgICAgICAgICAgY3R4LmxpbmVUbyhiYXNlTGVmdCArIHNpemUsIGJhc2VCb3R0b20pO1xuICAgICAgICAgICAgICBjdHgubGluZVRvKGJhc2VMZWZ0LCBiYXNlQm90dG9tIC0gc2l6ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSksIF9LSU5EX1BST0NFU1NfTUFQKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGRyYXdUcmlhbmdsZUluZGljYXRvcihjb250ZXh0LCBzdHlsZSwga2luZCwgaGVscGVyKSB7XG4gICAgICAgICAgICB2YXIgcHJvY2VzcyA9IEtJTkRfUFJPQ0VTU19NQVBba2luZF07XG5cbiAgICAgICAgICAgIGlmICghcHJvY2Vzcykge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGhlbHBlci5kcmF3Qm9yZGVyV2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICB2YXIgcmVjdCA9IGNvbnRleHQuZ2V0UmVjdCgpO1xuICAgICAgICAgICAgICB2YXIgY29sb3IgPSBzdHlsZS5jb2xvciB8fCBoZWxwZXIuZ2V0Q29sb3IocHJvY2Vzcy50aGVtZUNvbG9yKGhlbHBlciksIGNvbnRleHQuY29sLCBjb250ZXh0LnJvdywgY3R4KTtcbiAgICAgICAgICAgICAgdmFyIHNpemUgPSBzdHlsZS5zaXplICYmIE51bWJlcihzdHlsZS5zaXplKSB8fCBwcm9jZXNzLnRoZW1lU2l6ZShoZWxwZXIpIHx8IHJlY3QuaGVpZ2h0IC8gNjsgLy8gZHJhdyB0cmlhbmdsZVxuXG4gICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcbiAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICBwcm9jZXNzLmRyYXdQYXRoKGN0eCwgcmVjdCwgc2l6ZSk7XG4gICAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZHJhd1RyaWFuZ2xlSW5kaWNhdG9yID0gZHJhd1RyaWFuZ2xlSW5kaWNhdG9yO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9CYXNlTWVzc2FnZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL21lc3NhZ2UvQmFzZU1lc3NhZ2UuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc01lc3NhZ2VCYXNlTWVzc2FnZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQmFzZU1lc3NhZ2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQmFzZU1lc3NhZ2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gQmFzZU1lc3NhZ2UoZ3JpZCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZU1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX21lc3NhZ2VFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5fZ3JpZCA9IGdyaWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhCYXNlTWVzc2FnZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hNZXNzYWdlRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lc3NhZ2VFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLl9tZXNzYWdlRWxlbWVudC5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fbWVzc2FnZUVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfZ2V0TWVzc2FnZUVsZW1lbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRNZXNzYWdlRWxlbWVudCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVzc2FnZUVsZW1lbnQgfHwgKHRoaXMuX21lc3NhZ2VFbGVtZW50ID0gdGhpcy5jcmVhdGVNZXNzYWdlRWxlbWVudEludGVybmFsKCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhdHRhY2hNZXNzYWdlRWxlbWVudFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoTWVzc2FnZUVsZW1lbnQoY29sLCByb3csIG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9nZXRNZXNzYWdlRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgbWVzc2FnZUVsZW1lbnQuYXR0YWNoKHRoaXMuX2dyaWQsIGNvbCwgcm93LCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibW92ZU1lc3NhZ2VFbGVtZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlTWVzc2FnZUVsZW1lbnQoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9nZXRNZXNzYWdlRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgbWVzc2FnZUVsZW1lbnQubW92ZSh0aGlzLl9ncmlkLCBjb2wsIHJvdyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRldGFjaE1lc3NhZ2VFbGVtZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRhY2hNZXNzYWdlRWxlbWVudCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9nZXRNZXNzYWdlRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgbWVzc2FnZUVsZW1lbnQuX2RldGFjaCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3Q2VsbE1lc3NhZ2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdDZWxsTWVzc2FnZShtZXNzYWdlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Q2VsbE1lc3NhZ2VJbnRlcm5hbChtZXNzYWdlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gQmFzZU1lc3NhZ2U7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5CYXNlTWVzc2FnZSA9IEJhc2VNZXNzYWdlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9FcnJvck1lc3NhZ2UuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvbWVzc2FnZS9FcnJvck1lc3NhZ2UuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNNZXNzYWdlRXJyb3JNZXNzYWdlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICB2YXIgX19jcmVhdGVCaW5kaW5nID0gdGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZyB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcblxuICAgICAgICAgICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgICAgICAgICAgZGVzYyA9IHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ba107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICBvW2syXSA9IG1ba107XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gdGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHtcbiAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgdmFsdWU6IHZcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgb1tcImRlZmF1bHRcIl0gPSB2O1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9faW1wb3J0U3RhciA9IHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICAgICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIHtcbiAgICAgICAgICAgICAgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5FcnJvck1lc3NhZ2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgbWVzc2FnZVV0aWxzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vbWVzc2FnZVV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9tZXNzYWdlVXRpbHMuanNcIikpO1xuXG4gICAgICAgICAgdmFyIEJhc2VNZXNzYWdlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VNZXNzYWdlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9CYXNlTWVzc2FnZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBFcnJvck1lc3NhZ2VFbGVtZW50XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL0Vycm9yTWVzc2FnZUVsZW1lbnQgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL0Vycm9yTWVzc2FnZUVsZW1lbnQuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFJFRF9BMTAwID0gXCIjZmY4YTgwXCI7XG5cbiAgICAgICAgICB2YXIgRXJyb3JNZXNzYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZU1lc3NhZ2VfMSRCYXNlTWUpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhFcnJvck1lc3NhZ2UsIF9CYXNlTWVzc2FnZV8xJEJhc2VNZSk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXIxNSA9IF9jcmVhdGVTdXBlcihFcnJvck1lc3NhZ2UpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBFcnJvck1lc3NhZ2UoKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFcnJvck1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXIxNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoRXJyb3JNZXNzYWdlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiY3JlYXRlTWVzc2FnZUVsZW1lbnRJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlTWVzc2FnZUVsZW1lbnRJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yTWVzc2FnZUVsZW1lbnRfMS5FcnJvck1lc3NhZ2VFbGVtZW50KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdDZWxsTWVzc2FnZUludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3Q2VsbE1lc3NhZ2VJbnRlcm5hbChfbWVzc2FnZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgX2luZm8pIHtcbiAgICAgICAgICAgICAgICB2YXIgYmdDb2xvciA9IHN0eWxlLmJnQ29sb3I7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2NvbnRleHQkZ2V0U2VsZWN0aW9uID0gY29udGV4dC5nZXRTZWxlY3Rpb24oKSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ID0gX2NvbnRleHQkZ2V0U2VsZWN0aW9uLnNlbGVjdDtcblxuICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzEuY2VsbEluUmFuZ2UpKGdyaWQuZ2V0Q2VsbFJhbmdlKGNvbnRleHQuY29sLCBjb250ZXh0LnJvdyksIHNlbGVjdC5jb2wsIHNlbGVjdC5yb3cpIHx8ICFncmlkLmhhc0ZvY3VzR3JpZCgpKSB7XG4gICAgICAgICAgICAgICAgICBoZWxwZXIuZHJhd0JvcmRlcldpdGhDbGlwKGNvbnRleHQsIGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVV0aWxzLmRyYXdFeGNsYW1hdGlvbk1hcmtCb3goY29udGV4dCwge1xuICAgICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IGhlbHBlci5nZXRDb2xvcihoZWxwZXIudGhlbWUubWVzc2FnZXMuZXJyb3JCZ0NvbG9yLCBjb250ZXh0LmNvbCwgY29udGV4dC5yb3csIGN0eCkgfHwgUkVEX0ExMDAsXG4gICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgYm94V2lkdGg6IGhlbHBlci50aGVtZS5tZXNzYWdlcy5ib3hXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICBtYXJrSGVpZ2h0OiBoZWxwZXIudGhlbWUubWVzc2FnZXMubWFya0hlaWdodFxuICAgICAgICAgICAgICAgICAgICB9LCBoZWxwZXIpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBFcnJvck1lc3NhZ2U7XG4gICAgICAgICAgfShCYXNlTWVzc2FnZV8xLkJhc2VNZXNzYWdlKTtcblxuICAgICAgICAgIGV4cG9ydHMuRXJyb3JNZXNzYWdlID0gRXJyb3JNZXNzYWdlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9JbmZvTWVzc2FnZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL21lc3NhZ2UvSW5mb01lc3NhZ2UuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc01lc3NhZ2VJbmZvTWVzc2FnZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuSW5mb01lc3NhZ2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgbWVzc2FnZVV0aWxzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vbWVzc2FnZVV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9tZXNzYWdlVXRpbHMuanNcIikpO1xuXG4gICAgICAgICAgdmFyIEJhc2VNZXNzYWdlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VNZXNzYWdlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9CYXNlTWVzc2FnZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBNZXNzYWdlRWxlbWVudF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9pbnRlcm5hbC9NZXNzYWdlRWxlbWVudCAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvTWVzc2FnZUVsZW1lbnQuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEdSRVlfTDIgPSBcIiNlMGUwZTBcIjtcblxuICAgICAgICAgIHZhciBJbmZvTWVzc2FnZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VNZXNzYWdlXzEkQmFzZU1lMikge1xuICAgICAgICAgICAgX2luaGVyaXRzKEluZm9NZXNzYWdlLCBfQmFzZU1lc3NhZ2VfMSRCYXNlTWUyKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjE2ID0gX2NyZWF0ZVN1cGVyKEluZm9NZXNzYWdlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gSW5mb01lc3NhZ2UoKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmZvTWVzc2FnZSk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjE2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbmZvTWVzc2FnZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNyZWF0ZU1lc3NhZ2VFbGVtZW50SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2VFbGVtZW50SW50ZXJuYWwoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNZXNzYWdlRWxlbWVudF8xLk1lc3NhZ2VFbGVtZW50KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdDZWxsTWVzc2FnZUludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3Q2VsbE1lc3NhZ2VJbnRlcm5hbChfbWVzc2FnZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgX2luZm8pIHtcbiAgICAgICAgICAgICAgICB2YXIgYmdDb2xvciA9IHN0eWxlLmJnQ29sb3I7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2NvbnRleHQkZ2V0U2VsZWN0aW9uMiA9IGNvbnRleHQuZ2V0U2VsZWN0aW9uKCksXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdCA9IF9jb250ZXh0JGdldFNlbGVjdGlvbjIuc2VsZWN0O1xuXG4gICAgICAgICAgICAgICAgaWYgKCEoMCwgdXRpbHNfMS5jZWxsSW5SYW5nZSkoZ3JpZC5nZXRDZWxsUmFuZ2UoY29udGV4dC5jb2wsIGNvbnRleHQucm93KSwgc2VsZWN0LmNvbCwgc2VsZWN0LnJvdykgfHwgIWdyaWQuaGFzRm9jdXNHcmlkKCkpIHtcbiAgICAgICAgICAgICAgICAgIGhlbHBlci5kcmF3Qm9yZGVyV2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVXRpbHMuZHJhd0luZm9ybWF0aW9uTWFya0JveChjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogaGVscGVyLmdldENvbG9yKGhlbHBlci50aGVtZS5tZXNzYWdlcy5pbmZvQmdDb2xvciwgY29udGV4dC5jb2wsIGNvbnRleHQucm93LCBjdHgpIHx8IEdSRVlfTDIsXG4gICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgYm94V2lkdGg6IGhlbHBlci50aGVtZS5tZXNzYWdlcy5ib3hXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICBtYXJrSGVpZ2h0OiBoZWxwZXIudGhlbWUubWVzc2FnZXMubWFya0hlaWdodFxuICAgICAgICAgICAgICAgICAgICB9LCBoZWxwZXIpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbmZvTWVzc2FnZTtcbiAgICAgICAgICB9KEJhc2VNZXNzYWdlXzEuQmFzZU1lc3NhZ2UpO1xuXG4gICAgICAgICAgZXhwb3J0cy5JbmZvTWVzc2FnZSA9IEluZm9NZXNzYWdlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9NZXNzYWdlSGFuZGxlci5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL21lc3NhZ2UvTWVzc2FnZUhhbmRsZXIuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc01lc3NhZ2VNZXNzYWdlSGFuZGxlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTWVzc2FnZUhhbmRsZXIgPSBleHBvcnRzLmhhc01lc3NhZ2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgRXJyb3JNZXNzYWdlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Vycm9yTWVzc2FnZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL21lc3NhZ2UvRXJyb3JNZXNzYWdlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEluZm9NZXNzYWdlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0luZm9NZXNzYWdlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9JbmZvTWVzc2FnZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBMR19FVkVOVF9UWVBFXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9saXN0LWdyaWQvTEdfRVZFTlRfVFlQRSAqL1xuICAgICAgICAgIFwiLi9saXN0LWdyaWQvTEdfRVZFTlRfVFlQRS5qc1wiKTtcblxuICAgICAgICAgIHZhciBXYXJuaW5nTWVzc2FnZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9XYXJuaW5nTWVzc2FnZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL21lc3NhZ2UvV2FybmluZ01lc3NhZ2UuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEVNUFRZX01FU1NBR0UgPSB7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBtZXNzYWdlOiBudWxsXG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgTUVTU0FHRV9JTlNUQU5DRV9GQUNUT1JZID0ge1xuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKGdyaWQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvck1lc3NhZ2VfMS5FcnJvck1lc3NhZ2UoZ3JpZCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5mbzogZnVuY3Rpb24gaW5mbyhncmlkKSB7XG4gICAgICAgICAgICAgIHJldHVybiBuZXcgSW5mb01lc3NhZ2VfMS5JbmZvTWVzc2FnZShncmlkKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB3YXJuaW5nOiBmdW5jdGlvbiB3YXJuaW5nKGdyaWQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBXYXJuaW5nTWVzc2FnZV8xLldhcm5pbmdNZXNzYWdlKGdyaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGlmICghbWVzc2FnZSB8fCAoMCwgdXRpbHNfMS5pc1Byb21pc2UpKG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgIHJldHVybiBFTVBUWV9NRVNTQUdFO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbDogbWVzc2FnZVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdHlwZSA9IG1lc3NhZ2UudHlwZSB8fCBcImVycm9yXCI7XG5cbiAgICAgICAgICAgIGlmICh0eXBlICYmIHR5cGUgaW4gTUVTU0FHRV9JTlNUQU5DRV9GQUNUT1JZKSB7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UubWVzc2FnZSxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbDogbWVzc2FnZVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvcmVzdHJpY3QtdGVtcGxhdGUtZXhwcmVzc2lvbnNcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJcIi5jb25jYXQobWVzc2FnZSksXG4gICAgICAgICAgICAgIG9yaWdpbmFsOiBtZXNzYWdlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGhhc01lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICAgICAgcmV0dXJuICEhbm9ybWFsaXplTWVzc2FnZShtZXNzYWdlKS5tZXNzYWdlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuaGFzTWVzc2FnZSA9IGhhc01lc3NhZ2U7XG5cbiAgICAgICAgICB2YXIgTWVzc2FnZUhhbmRsZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gTWVzc2FnZUhhbmRsZXIoZ3JpZCwgZ2V0TWVzc2FnZSkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVzc2FnZUhhbmRsZXIpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX2F0dGFjaEluZm8gPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9ncmlkID0gZ3JpZDtcbiAgICAgICAgICAgICAgdGhpcy5fbWVzc2FnZUluc3RhbmNlcyA9IHt9O1xuXG4gICAgICAgICAgICAgIHRoaXMuX2JpbmRHcmlkRXZlbnQoZ3JpZCwgZ2V0TWVzc2FnZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhNZXNzYWdlSGFuZGxlciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VJbnN0YW5jZXMgPSB0aGlzLl9tZXNzYWdlSW5zdGFuY2VzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayBpbiBtZXNzYWdlSW5zdGFuY2VzKSB7XG4gICAgICAgICAgICAgICAgICAoX2EgPSBtZXNzYWdlSW5zdGFuY2VzW2tdKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIH0gLy8gQHRzLWV4cGVjdC1lcnJvciAtLSBpZ25vcmVcblxuXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX21lc3NhZ2VJbnN0YW5jZXM7IC8vIEB0cy1leHBlY3QtZXJyb3IgLS0gaWdub3JlXG5cbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fYXR0YWNoSW5mbztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd0NlbGxNZXNzYWdlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3Q2VsbE1lc3NhZ2UobWVzc2FnZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgaW5mbykge1xuICAgICAgICAgICAgICAgIGlmICghaGFzTWVzc2FnZShtZXNzYWdlKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXMuX2dldE1lc3NhZ2VJbnN0YW5jZU9mTWVzc2FnZShtZXNzYWdlKTtcblxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmRyYXdDZWxsTWVzc2FnZShub3JtYWxpemVNZXNzYWdlKG1lc3NhZ2UpLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2F0dGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2F0dGFjaChjb2wsIHJvdywgbWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIHZhciBpbmZvID0gdGhpcy5fYXR0YWNoSW5mbztcblxuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXMuX2dldE1lc3NhZ2VJbnN0YW5jZU9mTWVzc2FnZShtZXNzYWdlKTtcblxuICAgICAgICAgICAgICAgIGlmIChpbmZvICYmIGluZm8uaW5zdGFuY2UgIT09IGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICBpbmZvLmluc3RhbmNlLmRldGFjaE1lc3NhZ2VFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuYXR0YWNoTWVzc2FnZUVsZW1lbnQoY29sLCByb3csIG5vcm1hbGl6ZU1lc3NhZ2UobWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2F0dGFjaEluZm8gPSB7XG4gICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogcm93LFxuICAgICAgICAgICAgICAgICAgaW5zdGFuY2U6IGluc3RhbmNlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX21vdmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9tb3ZlKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSB0aGlzLl9hdHRhY2hJbmZvO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFpbmZvIHx8IGluZm8uY29sICE9PSBjb2wgfHwgaW5mby5yb3cgIT09IHJvdykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGluZm8uaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UubW92ZU1lc3NhZ2VFbGVtZW50KGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2RldGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2RldGFjaCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHRoaXMuX2F0dGFjaEluZm87XG5cbiAgICAgICAgICAgICAgICBpZiAoIWluZm8pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBpbmZvLmluc3RhbmNlO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlLmRldGFjaE1lc3NhZ2VFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoSW5mbyA9IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9iaW5kR3JpZEV2ZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYmluZEdyaWRFdmVudChncmlkLCBnZXRNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMzggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9uU2VsZWN0TWVzc2FnZSA9IGZ1bmN0aW9uIG9uU2VsZWN0TWVzc2FnZShzZWwpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBzZXRNZXNzYWdlRGF0YSA9IGZ1bmN0aW9uIHNldE1lc3NhZ2VEYXRhKG1zZykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc01lc3NhZ2UobXNnKSkge1xuICAgICAgICAgICAgICAgICAgICAgIF90aGlzMzguX2RldGFjaCgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIF90aGlzMzguX2F0dGFjaChzZWwuY29sLCBzZWwucm93LCBtc2cpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGdldE1lc3NhZ2Uoc2VsLmNvbCwgc2VsLnJvdyk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMzguX2RldGFjaCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UudGhlbihmdW5jdGlvbiAobXNnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlbCA9IGdyaWQuc2VsZWN0aW9uLnNlbGVjdDtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdTZWwuY29sICE9PSBzZWwuY29sIHx8IG5ld1NlbC5yb3cgIT09IHNlbC5yb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlRGF0YShtc2cpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlRGF0YShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuU0VMRUNURURfQ0VMTCwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghZS5zZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChlLmJlZm9yZS5jb2wgPT09IGUuY29sICYmIGUuYmVmb3JlLnJvdyA9PT0gZS5yb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBvblNlbGVjdE1lc3NhZ2UoZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuU0NST0xMLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgc2VsID0gZ3JpZC5zZWxlY3Rpb24uc2VsZWN0O1xuXG4gICAgICAgICAgICAgICAgICBfdGhpczM4Ll9tb3ZlKHNlbC5jb2wsIHNlbC5yb3cpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdyaWQubGlzdGVuKExHX0VWRU5UX1RZUEVfMS5MR19FVkVOVF9UWVBFLkNIQU5HRURfVkFMVUUsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWdyaWQuaGFzRm9jdXNHcmlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgc2VsID0gZ3JpZC5zZWxlY3Rpb24uc2VsZWN0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoc2VsLmNvbCAhPT0gZS5jb2wgfHwgc2VsLnJvdyAhPT0gZS5yb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBvblNlbGVjdE1lc3NhZ2UoZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuRk9DVVNfR1JJRCwgZnVuY3Rpb24gKF9lKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgc2VsID0gZ3JpZC5zZWxlY3Rpb24uc2VsZWN0O1xuICAgICAgICAgICAgICAgICAgb25TZWxlY3RNZXNzYWdlKHNlbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuQkxVUl9HUklELCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICAgIF90aGlzMzguX2RldGFjaCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfZ2V0TWVzc2FnZUluc3RhbmNlT2ZNZXNzYWdlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0TWVzc2FnZUluc3RhbmNlT2ZNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZUluc3RhbmNlcyA9IHRoaXMuX21lc3NhZ2VJbnN0YW5jZXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgX25vcm1hbGl6ZU1lc3NhZ2UgPSBub3JtYWxpemVNZXNzYWdlKG1lc3NhZ2UpLFxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gX25vcm1hbGl6ZU1lc3NhZ2UudHlwZTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlSW5zdGFuY2VzW3R5cGVdIHx8IChtZXNzYWdlSW5zdGFuY2VzW3R5cGVdID0gTUVTU0FHRV9JTlNUQU5DRV9GQUNUT1JZW3R5cGVdKHRoaXMuX2dyaWQpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTWVzc2FnZUhhbmRsZXI7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5NZXNzYWdlSGFuZGxlciA9IE1lc3NhZ2VIYW5kbGVyO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9XYXJuaW5nTWVzc2FnZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL21lc3NhZ2UvV2FybmluZ01lc3NhZ2UuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc01lc3NhZ2VXYXJuaW5nTWVzc2FnZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuV2FybmluZ01lc3NhZ2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgbWVzc2FnZVV0aWxzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vbWVzc2FnZVV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9tZXNzYWdlVXRpbHMuanNcIikpO1xuXG4gICAgICAgICAgdmFyIEJhc2VNZXNzYWdlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VNZXNzYWdlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9CYXNlTWVzc2FnZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBXYXJuaW5nTWVzc2FnZUVsZW1lbnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaW50ZXJuYWwvV2FybmluZ01lc3NhZ2VFbGVtZW50ICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9XYXJuaW5nTWVzc2FnZUVsZW1lbnQuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIERFRVBfT1JBTkdFX0ExMDAgPSBcIiNmZjllODBcIjtcblxuICAgICAgICAgIHZhciBXYXJuaW5nTWVzc2FnZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VNZXNzYWdlXzEkQmFzZU1lMykge1xuICAgICAgICAgICAgX2luaGVyaXRzKFdhcm5pbmdNZXNzYWdlLCBfQmFzZU1lc3NhZ2VfMSRCYXNlTWUzKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjE3ID0gX2NyZWF0ZVN1cGVyKFdhcm5pbmdNZXNzYWdlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gV2FybmluZ01lc3NhZ2UoKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXYXJuaW5nTWVzc2FnZSk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjE3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhXYXJuaW5nTWVzc2FnZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNyZWF0ZU1lc3NhZ2VFbGVtZW50SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2VFbGVtZW50SW50ZXJuYWwoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBXYXJuaW5nTWVzc2FnZUVsZW1lbnRfMS5XYXJuaW5nTWVzc2FnZUVsZW1lbnQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd0NlbGxNZXNzYWdlSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdDZWxsTWVzc2FnZUludGVybmFsKF9tZXNzYWdlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBfaW5mbykge1xuICAgICAgICAgICAgICAgIHZhciBiZ0NvbG9yID0gc3R5bGUuYmdDb2xvcjtcblxuICAgICAgICAgICAgICAgIHZhciBfY29udGV4dCRnZXRTZWxlY3Rpb24zID0gY29udGV4dC5nZXRTZWxlY3Rpb24oKSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ID0gX2NvbnRleHQkZ2V0U2VsZWN0aW9uMy5zZWxlY3Q7XG5cbiAgICAgICAgICAgICAgICBpZiAoISgwLCB1dGlsc18xLmNlbGxJblJhbmdlKShncmlkLmdldENlbGxSYW5nZShjb250ZXh0LmNvbCwgY29udGV4dC5yb3cpLCBzZWxlY3QuY29sLCBzZWxlY3Qucm93KSB8fCAhZ3JpZC5oYXNGb2N1c0dyaWQoKSkge1xuICAgICAgICAgICAgICAgICAgaGVscGVyLmRyYXdCb3JkZXJXaXRoQ2xpcChjb250ZXh0LCBmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VVdGlscy5kcmF3RXhjbGFtYXRpb25NYXJrQm94KGNvbnRleHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBoZWxwZXIuZ2V0Q29sb3IoaGVscGVyLnRoZW1lLm1lc3NhZ2VzLndhcm5CZ0NvbG9yLCBjb250ZXh0LmNvbCwgY29udGV4dC5yb3csIGN0eCkgfHwgREVFUF9PUkFOR0VfQTEwMCxcbiAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogYmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICBib3hXaWR0aDogaGVscGVyLnRoZW1lLm1lc3NhZ2VzLmJveFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgIG1hcmtIZWlnaHQ6IGhlbHBlci50aGVtZS5tZXNzYWdlcy5tYXJrSGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgIH0sIGhlbHBlcik7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFdhcm5pbmdNZXNzYWdlO1xuICAgICAgICAgIH0oQmFzZU1lc3NhZ2VfMS5CYXNlTWVzc2FnZSk7XG5cbiAgICAgICAgICBleHBvcnRzLldhcm5pbmdNZXNzYWdlID0gV2FybmluZ01lc3NhZ2U7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL0Vycm9yTWVzc2FnZUVsZW1lbnQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvRXJyb3JNZXNzYWdlRWxlbWVudC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNNZXNzYWdlSW50ZXJuYWxFcnJvck1lc3NhZ2VFbGVtZW50SnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5FcnJvck1lc3NhZ2VFbGVtZW50ID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIE1lc3NhZ2VFbGVtZW50XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL01lc3NhZ2VFbGVtZW50ICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9NZXNzYWdlRWxlbWVudC5qc1wiKTtcblxuICAgICAgICAgIHZhciBDTEFTU05BTUUgPSBcImNoZWV0YWgtZ3JpZF9fZXJyb3ItbWVzc2FnZS1lbGVtZW50XCI7XG4gICAgICAgICAgdmFyIE1FU1NBR0VfQ0xBU1NOQU1FID0gXCJcIi5jb25jYXQoQ0xBU1NOQU1FLCBcIl9fbWVzc2FnZVwiKTtcblxuICAgICAgICAgIHZhciBFcnJvck1lc3NhZ2VFbGVtZW50ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWVzc2FnZUVsZW1lbnRfMSRNZXMpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhFcnJvck1lc3NhZ2VFbGVtZW50LCBfTWVzc2FnZUVsZW1lbnRfMSRNZXMpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMTggPSBfY3JlYXRlU3VwZXIoRXJyb3JNZXNzYWdlRWxlbWVudCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEVycm9yTWVzc2FnZUVsZW1lbnQoKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczM5O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFcnJvck1lc3NhZ2VFbGVtZW50KTtcblxuICAgICAgICAgICAgICBfdGhpczM5ID0gX3N1cGVyMTguY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgICAgICAvKiEgQC9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvRXJyb3JNZXNzYWdlRWxlbWVudC5jc3MgKi9cbiAgICAgICAgICAgICAgXCIuLi9zcmMvanMvY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL0Vycm9yTWVzc2FnZUVsZW1lbnQuY3NzXCIpO1xuXG4gICAgICAgICAgICAgIF90aGlzMzkuX3Jvb3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoQ0xBU1NOQU1FKTtcblxuICAgICAgICAgICAgICBfdGhpczM5Ll9tZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKE1FU1NBR0VfQ0xBU1NOQU1FKTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzOTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIEVycm9yTWVzc2FnZUVsZW1lbnQ7XG4gICAgICAgICAgfShNZXNzYWdlRWxlbWVudF8xLk1lc3NhZ2VFbGVtZW50KTtcblxuICAgICAgICAgIGV4cG9ydHMuRXJyb3JNZXNzYWdlRWxlbWVudCA9IEVycm9yTWVzc2FnZUVsZW1lbnQ7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL01lc3NhZ2VFbGVtZW50LmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9NZXNzYWdlRWxlbWVudC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zTWVzc2FnZUludGVybmFsTWVzc2FnZUVsZW1lbnRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLk1lc3NhZ2VFbGVtZW50ID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEV2ZW50SGFuZGxlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vLi4vaW50ZXJuYWwvRXZlbnRIYW5kbGVyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL0V2ZW50SGFuZGxlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBkb21fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2ludGVybmFsL2RvbSAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9kb20uanNcIik7XG5cbiAgICAgICAgICB2YXIgQ0xBU1NOQU1FID0gXCJjaGVldGFoLWdyaWRfX21lc3NhZ2UtZWxlbWVudFwiO1xuICAgICAgICAgIHZhciBNRVNTQUdFX0NMQVNTTkFNRSA9IFwiXCIuY29uY2F0KENMQVNTTkFNRSwgXCJfX21lc3NhZ2VcIik7XG4gICAgICAgICAgdmFyIEhJRERFTl9DTEFTU05BTUUgPSBcIlwiLmNvbmNhdChDTEFTU05BTUUsIFwiLS1oaWRkZW5cIik7XG4gICAgICAgICAgdmFyIFNIT1dOX0NMQVNTTkFNRSA9IFwiXCIuY29uY2F0KENMQVNTTkFNRSwgXCItLXNob3duXCIpO1xuICAgICAgICAgIHZhciBMRUZUX0RJRkZfQ1NTX1BST1BfTkFNRSA9IFwiLS1jaGVldGFoLWdyaWQtbWVzc2FnZS1lbGVtZW50LWxlZnQtZGlmZlwiO1xuXG4gICAgICAgICAgZnVuY3Rpb24gY3JlYXRlTWVzc2FnZURvbUVsZW1lbnQoKSB7XG4gICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgICAgLyohIEAvY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL01lc3NhZ2VFbGVtZW50LmNzcyAqL1xuICAgICAgICAgICAgXCIuLi9zcmMvanMvY29sdW1ucy9tZXNzYWdlL2ludGVybmFsL01lc3NhZ2VFbGVtZW50LmNzc1wiKTtcblxuICAgICAgICAgICAgdmFyIHJvb3RFbGVtZW50ID0gKDAsIGRvbV8xLmNyZWF0ZUVsZW1lbnQpKFwiZGl2XCIsIHtcbiAgICAgICAgICAgICAgY2xhc3NMaXN0OiBbQ0xBU1NOQU1FLCBISURERU5fQ0xBU1NOQU1FXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZUVsZW1lbnQgPSAoMCwgZG9tXzEuY3JlYXRlRWxlbWVudCkoXCJzcGFuXCIsIHtcbiAgICAgICAgICAgICAgY2xhc3NMaXN0OiBbTUVTU0FHRV9DTEFTU05BTUVdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJvb3RFbGVtZW50LmFwcGVuZENoaWxkKG1lc3NhZ2VFbGVtZW50KTtcbiAgICAgICAgICAgIHJldHVybiByb290RWxlbWVudDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgTWVzc2FnZUVsZW1lbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gTWVzc2FnZUVsZW1lbnQoKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZXNzYWdlRWxlbWVudCk7XG5cbiAgICAgICAgICAgICAgdGhpcy5faGFuZGxlciA9IG5ldyBFdmVudEhhbmRsZXJfMS5FdmVudEhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgdmFyIHJvb3RFbGVtZW50ID0gdGhpcy5fcm9vdEVsZW1lbnQgPSBjcmVhdGVNZXNzYWdlRG9tRWxlbWVudCgpO1xuICAgICAgICAgICAgICB0aGlzLl9tZXNzYWdlRWxlbWVudCA9IHJvb3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuXCIuY29uY2F0KE1FU1NBR0VfQ0xBU1NOQU1FKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhNZXNzYWdlRWxlbWVudCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2goKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIuZGlzcG9zZSgpOyAvLyBAdHMtZXhwZWN0LWVycm9yIC0tIGlnbm9yZVxuXG5cbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcm9vdEVsZW1lbnQ7IC8vIEB0cy1leHBlY3QtZXJyb3IgLS0gaWdub3JlXG5cbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fbWVzc2FnZUVsZW1lbnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImF0dGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoKGdyaWQsIGNvbCwgcm93LCBtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvb3RFbGVtZW50ID0gdGhpcy5fcm9vdEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fbWVzc2FnZUVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShTSE9XTl9DTEFTU05BTUUpO1xuICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoSElEREVOX0NMQVNTTkFNRSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYXR0YWNoQ2VsbChncmlkLCBjb2wsIHJvdykpIHtcbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoU0hPV05fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoSElEREVOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2UubWVzc2FnZTtcblxuICAgICAgICAgICAgICAgICAgdGhpcy5fYWRqdXN0U3R5bGUoZ3JpZCwgY29sLCByb3cpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLl9kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm1vdmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmUoZ3JpZCwgY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm9vdEVsZW1lbnQgPSB0aGlzLl9yb290RWxlbWVudDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdHRhY2hDZWxsKGdyaWQsIGNvbCwgcm93KSkge1xuICAgICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQuY2xhc3NMaXN0LmFkZChTSE9XTl9DTEFTU05BTUUpO1xuICAgICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShISURERU5fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkZXRhY2hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRldGFjaCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZXRhY2goKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2RldGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2RldGFjaCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm9vdEVsZW1lbnQgPSB0aGlzLl9yb290RWxlbWVudDtcblxuICAgICAgICAgICAgICAgIGlmIChyb290RWxlbWVudC5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICByb290RWxlbWVudC5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHJvb3RFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoU0hPV05fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoSElEREVOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfYXR0YWNoQ2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2F0dGFjaENlbGwoZ3JpZCwgY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm9vdEVsZW1lbnQgPSB0aGlzLl9yb290RWxlbWVudDtcblxuICAgICAgICAgICAgICAgIHZhciBfZ3JpZCRnZXRBdHRhY2hDZWxsc0E0ID0gZ3JpZC5nZXRBdHRhY2hDZWxsc0FyZWEoZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpKSxcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IF9ncmlkJGdldEF0dGFjaENlbGxzQTQuZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgcmVjdCA9IF9ncmlkJGdldEF0dGFjaENlbGxzQTQucmVjdDtcblxuICAgICAgICAgICAgICAgIHZhciB0b3AgPSByZWN0LmJvdHRvbSxcbiAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHJlY3QubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSByZWN0LndpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBmcm96ZW5Sb3dDb3VudCA9IGdyaWQuZnJvemVuUm93Q291bnQsXG4gICAgICAgICAgICAgICAgICAgIGZyb3plbkNvbENvdW50ID0gZ3JpZC5mcm96ZW5Db2xDb3VudDtcblxuICAgICAgICAgICAgICAgIGlmIChyb3cgPj0gZnJvemVuUm93Q291bnQgJiYgZnJvemVuUm93Q291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX2dyaWQkZ2V0QXR0YWNoQ2VsbHNBNSA9IGdyaWQuZ2V0QXR0YWNoQ2VsbHNBcmVhKGdyaWQuZ2V0Q2VsbFJhbmdlKGNvbCwgZnJvemVuUm93Q291bnQgLSAxKSksXG4gICAgICAgICAgICAgICAgICAgICAgZnJvemVuUmVjdCA9IF9ncmlkJGdldEF0dGFjaENlbGxzQTUucmVjdDtcblxuICAgICAgICAgICAgICAgICAgaWYgKHRvcCA8IGZyb3plblJlY3QuYm90dG9tKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gT3V0c2lkZSB0aGUgcmVjdGFuZ2xlLlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBpZiAodG9wIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE91dHNpZGUgdGhlIHJlY3RhbmdsZS5cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoY29sID49IGZyb3plbkNvbENvdW50ICYmIGZyb3plbkNvbENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgdmFyIF9ncmlkJGdldEF0dGFjaENlbGxzQTYgPSBncmlkLmdldEF0dGFjaENlbGxzQXJlYShncmlkLmdldENlbGxSYW5nZShmcm96ZW5Db2xDb3VudCAtIDEsIHJvdykpLFxuICAgICAgICAgICAgICAgICAgICAgIF9mcm96ZW5SZWN0ID0gX2dyaWQkZ2V0QXR0YWNoQ2VsbHNBNi5yZWN0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAobGVmdCA8IF9mcm96ZW5SZWN0LnJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gT3V0c2lkZSB0aGUgcmVjdGFuZ2xlLlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBpZiAobGVmdCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBPdXRzaWRlIHRoZSByZWN0YW5nbGUuXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldEhlaWdodCA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRXaWR0aCA9IGVsZW1lbnQub2Zmc2V0V2lkdGg7XG5cbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0SGVpZ2h0IDwgdG9wKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE91dHNpZGUgdGhlIHJlY3RhbmdsZS5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0V2lkdGggPCBsZWZ0KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE91dHNpZGUgdGhlIHJlY3RhbmdsZS5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByb290RWxlbWVudC5zdHlsZS50b3AgPSBcIlwiLmNvbmNhdCh0b3AudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LnN0eWxlLmxlZnQgPSBcIlwiLmNvbmNhdChsZWZ0LnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICByb290RWxlbWVudC5zdHlsZS53aWR0aCA9IFwiXCIuY29uY2F0KHdpZHRoLnRvRml4ZWQoKSwgXCJweFwiKTtcblxuICAgICAgICAgICAgICAgIGlmIChyb290RWxlbWVudC5wYXJlbnRFbGVtZW50ICE9PSBlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKHJvb3RFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogSWYgdGhlIG1lc3NhZ2UgaXMgcGxhY2VkIG91dHNpZGUgdGhlIEdyaWQsIGFkanVzdCBpdHMgcG9zaXRpb24uXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfYWRqdXN0U3R5bGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hZGp1c3RTdHlsZShncmlkLCBjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciByb290RWxlbWVudCA9IHRoaXMuX3Jvb3RFbGVtZW50O1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZ3JpZC5nZXRFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VSZWN0ID0gcm9vdEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRSZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZUxlZnQgPSBtZXNzYWdlUmVjdC5sZWZ0O1xuXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRSZWN0LnJpZ2h0IDwgbWVzc2FnZVJlY3QucmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBvdmVyZmxvdyA9IG1lc3NhZ2VSZWN0LnJpZ2h0IC0gZWxlbWVudFJlY3QucmlnaHQ7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlTGVmdCAtPSBvdmVyZmxvdztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUxlZnQgPCBlbGVtZW50UmVjdC5sZWZ0KSB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlTGVmdCA9IGVsZW1lbnRSZWN0LmxlZnQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VMZWZ0ICE9PSBtZXNzYWdlUmVjdC5sZWZ0KSB7XG4gICAgICAgICAgICAgICAgICB2YXIgZGlmZiA9IG1lc3NhZ2VSZWN0LmxlZnQgLSBtZXNzYWdlTGVmdDtcblxuICAgICAgICAgICAgICAgICAgdmFyIF9ncmlkJGdldEF0dGFjaENlbGxzQTcgPSBncmlkLmdldEF0dGFjaENlbGxzQXJlYShncmlkLmdldENlbGxSYW5nZShjb2wsIHJvdykpLFxuICAgICAgICAgICAgICAgICAgICAgIHJlY3QgPSBfZ3JpZCRnZXRBdHRhY2hDZWxsc0E3LnJlY3Q7XG5cbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LnN0eWxlLmxlZnQgPSBcIlwiLmNvbmNhdCgocmVjdC5sZWZ0IC0gZGlmZikudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgICAgdmFyIGRpZmZDc3MgPSBcIlwiLmNvbmNhdChkaWZmLnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KExFRlRfRElGRl9DU1NfUFJPUF9OQU1FLCBkaWZmQ3NzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQuc3R5bGUucmVtb3ZlUHJvcGVydHkoTEVGVF9ESUZGX0NTU19QUk9QX05BTUUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTWVzc2FnZUVsZW1lbnQ7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5NZXNzYWdlRWxlbWVudCA9IE1lc3NhZ2VFbGVtZW50O1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9XYXJuaW5nTWVzc2FnZUVsZW1lbnQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvbWVzc2FnZS9pbnRlcm5hbC9XYXJuaW5nTWVzc2FnZUVsZW1lbnQuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNNZXNzYWdlSW50ZXJuYWxXYXJuaW5nTWVzc2FnZUVsZW1lbnRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLldhcm5pbmdNZXNzYWdlRWxlbWVudCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBNZXNzYWdlRWxlbWVudF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9NZXNzYWdlRWxlbWVudCAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvTWVzc2FnZUVsZW1lbnQuanNcIik7XG5cbiAgICAgICAgICB2YXIgQ0xBU1NOQU1FID0gXCJjaGVldGFoLWdyaWRfX3dhcm5pbmctbWVzc2FnZS1lbGVtZW50XCI7XG4gICAgICAgICAgdmFyIE1FU1NBR0VfQ0xBU1NOQU1FID0gXCJcIi5jb25jYXQoQ0xBU1NOQU1FLCBcIl9fbWVzc2FnZVwiKTtcblxuICAgICAgICAgIHZhciBXYXJuaW5nTWVzc2FnZUVsZW1lbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9NZXNzYWdlRWxlbWVudF8xJE1lczIpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhXYXJuaW5nTWVzc2FnZUVsZW1lbnQsIF9NZXNzYWdlRWxlbWVudF8xJE1lczIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMTkgPSBfY3JlYXRlU3VwZXIoV2FybmluZ01lc3NhZ2VFbGVtZW50KTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gV2FybmluZ01lc3NhZ2VFbGVtZW50KCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM0MDtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2FybmluZ01lc3NhZ2VFbGVtZW50KTtcblxuICAgICAgICAgICAgICBfdGhpczQwID0gX3N1cGVyMTkuY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgICAgICAvKiEgQC9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvV2FybmluZ01lc3NhZ2VFbGVtZW50LmNzcyAqL1xuICAgICAgICAgICAgICBcIi4uL3NyYy9qcy9jb2x1bW5zL21lc3NhZ2UvaW50ZXJuYWwvV2FybmluZ01lc3NhZ2VFbGVtZW50LmNzc1wiKTtcblxuICAgICAgICAgICAgICBfdGhpczQwLl9yb290RWxlbWVudC5jbGFzc0xpc3QuYWRkKENMQVNTTkFNRSk7XG5cbiAgICAgICAgICAgICAgX3RoaXM0MC5fbWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChNRVNTQUdFX0NMQVNTTkFNRSk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBXYXJuaW5nTWVzc2FnZUVsZW1lbnQ7XG4gICAgICAgICAgfShNZXNzYWdlRWxlbWVudF8xLk1lc3NhZ2VFbGVtZW50KTtcblxuICAgICAgICAgIGV4cG9ydHMuV2FybmluZ01lc3NhZ2VFbGVtZW50ID0gV2FybmluZ01lc3NhZ2VFbGVtZW50O1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvbWVzc2FnZS9tZXNzYWdlVXRpbHMuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvbWVzc2FnZS9tZXNzYWdlVXRpbHMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNNZXNzYWdlTWVzc2FnZVV0aWxzSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5kcmF3SW5mb3JtYXRpb25NYXJrQm94ID0gZXhwb3J0cy5kcmF3RXhjbGFtYXRpb25NYXJrQm94ID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFJlY3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL1JlY3QgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvUmVjdC5qc1wiKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGRyYXdFeGNsYW1hdGlvbk1hcmtCb3goY29udGV4dCwgc3R5bGUsIGhlbHBlcikge1xuICAgICAgICAgICAgdmFyIGJnQ29sb3IgPSBzdHlsZS5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gc3R5bGUuY29sb3IsXG4gICAgICAgICAgICAgICAgYm94V2lkdGggPSBzdHlsZS5ib3hXaWR0aCxcbiAgICAgICAgICAgICAgICBtYXJrSGVpZ2h0ID0gc3R5bGUubWFya0hlaWdodDtcbiAgICAgICAgICAgIHZhciBjdHggPSBjb250ZXh0LmdldENvbnRleHQoKTtcbiAgICAgICAgICAgIHZhciByZWN0ID0gY29udGV4dC5nZXRSZWN0KCk7IC8vIGRyYXcgYm94XG5cbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBiZ0NvbG9yO1xuICAgICAgICAgICAgdmFyIGJveFJlY3QgPSByZWN0LmNvcHkoKTtcbiAgICAgICAgICAgIGJveFJlY3QubGVmdCA9IGJveFJlY3QucmlnaHQgLSAoTnVtYmVyKGJveFdpZHRoKSB8fCAyNCk7XG4gICAgICAgICAgICBjdHguZmlsbFJlY3QoYm94UmVjdC5sZWZ0LCBib3hSZWN0LnRvcCwgYm94UmVjdC53aWR0aCwgYm94UmVjdC5oZWlnaHQgLSAxKTsgLy8gZHJhdyBleGNsYW1hdGlvbiBtYXJrXG5cbiAgICAgICAgICAgIHZhciBmaWxsQ29sb3IgPSBjb2xvcjtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSBOdW1iZXIobWFya0hlaWdodCkgfHwgMjA7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBoZWlnaHQgLyA1O1xuICAgICAgICAgICAgdmFyIGxlZnQgPSBib3hSZWN0LmxlZnQgKyAoYm94UmVjdC53aWR0aCAtIHdpZHRoKSAvIDI7XG4gICAgICAgICAgICB2YXIgdG9wID0gYm94UmVjdC50b3AgKyAoYm94UmVjdC5oZWlnaHQgLSBoZWlnaHQpIC8gMjtcbiAgICAgICAgICAgIGhlbHBlci5maWxsUmVjdFdpdGhTdGF0ZShuZXcgUmVjdF8xLlJlY3QobGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0IC8gNSAqIDMpLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgIGZpbGxDb2xvcjogZmlsbENvbG9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGhlbHBlci5maWxsUmVjdFdpdGhTdGF0ZShuZXcgUmVjdF8xLlJlY3QobGVmdCwgdG9wICsgaGVpZ2h0IC8gNSAqIDQsIHdpZHRoLCBoZWlnaHQgLyA1KSwgY29udGV4dCwge1xuICAgICAgICAgICAgICBmaWxsQ29sb3I6IGZpbGxDb2xvclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5kcmF3RXhjbGFtYXRpb25NYXJrQm94ID0gZHJhd0V4Y2xhbWF0aW9uTWFya0JveDtcblxuICAgICAgICAgIGZ1bmN0aW9uIGRyYXdJbmZvcm1hdGlvbk1hcmtCb3goY29udGV4dCwgc3R5bGUsIGhlbHBlcikge1xuICAgICAgICAgICAgdmFyIGJnQ29sb3IgPSBzdHlsZS5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gc3R5bGUuY29sb3IsXG4gICAgICAgICAgICAgICAgYm94V2lkdGggPSBzdHlsZS5ib3hXaWR0aCxcbiAgICAgICAgICAgICAgICBtYXJrSGVpZ2h0ID0gc3R5bGUubWFya0hlaWdodDtcbiAgICAgICAgICAgIHZhciBjdHggPSBjb250ZXh0LmdldENvbnRleHQoKTtcbiAgICAgICAgICAgIHZhciByZWN0ID0gY29udGV4dC5nZXRSZWN0KCk7IC8vIGRyYXcgYm94XG5cbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBiZ0NvbG9yO1xuICAgICAgICAgICAgdmFyIGJveFJlY3QgPSByZWN0LmNvcHkoKTtcbiAgICAgICAgICAgIGJveFJlY3QubGVmdCA9IGJveFJlY3QucmlnaHQgLSAoTnVtYmVyKGJveFdpZHRoKSB8fCAyNCk7XG4gICAgICAgICAgICBjdHguZmlsbFJlY3QoYm94UmVjdC5sZWZ0LCBib3hSZWN0LnRvcCwgYm94UmVjdC53aWR0aCwgYm94UmVjdC5oZWlnaHQgLSAxKTsgLy8gZHJhdyBpIG1hcmtcblxuICAgICAgICAgICAgdmFyIGZpbGxDb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IE51bWJlcihtYXJrSGVpZ2h0KSB8fCAyMDtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGhlaWdodCAvIDU7XG4gICAgICAgICAgICB2YXIgbGVmdCA9IGJveFJlY3QubGVmdCArIChib3hSZWN0LndpZHRoIC0gd2lkdGgpIC8gMjtcbiAgICAgICAgICAgIHZhciB0b3AgPSBib3hSZWN0LnRvcCArIChib3hSZWN0LmhlaWdodCAtIGhlaWdodCkgLyAyO1xuICAgICAgICAgICAgaGVscGVyLmZpbGxSZWN0V2l0aFN0YXRlKG5ldyBSZWN0XzEuUmVjdChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQgLyA1KSwgY29udGV4dCwge1xuICAgICAgICAgICAgICBmaWxsQ29sb3I6IGZpbGxDb2xvclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoZWxwZXIuZmlsbFJlY3RXaXRoU3RhdGUobmV3IFJlY3RfMS5SZWN0KGxlZnQsIHRvcCArIGhlaWdodCAvIDUgKiAyLCB3aWR0aCwgaGVpZ2h0IC8gNSAqIDMpLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgIGZpbGxDb2xvcjogZmlsbENvbG9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmRyYXdJbmZvcm1hdGlvbk1hcmtCb3ggPSBkcmF3SW5mb3JtYXRpb25NYXJrQm94O1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvc3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMub2YgPSBleHBvcnRzLlRyZWVTdHlsZSA9IGV4cG9ydHMuTWVudVN0eWxlID0gZXhwb3J0cy5NdWx0aWxpbmVUZXh0U3R5bGUgPSBleHBvcnRzLlBlcmNlbnRDb21wbGV0ZUJhclN0eWxlID0gZXhwb3J0cy5JY29uU3R5bGUgPSBleHBvcnRzLkltYWdlU3R5bGUgPSBleHBvcnRzLkJ1dHRvblN0eWxlID0gZXhwb3J0cy5SYWRpb1N0eWxlID0gZXhwb3J0cy5DaGVja1N0eWxlID0gZXhwb3J0cy5OdW1iZXJTdHlsZSA9IGV4cG9ydHMuU3R5bGUgPSBleHBvcnRzLkJhc2VTdHlsZSA9IGV4cG9ydHMuRVZFTlRfVFlQRSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvQmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvQmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiQmFzZVN0eWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEJhc2VTdHlsZV8xLkJhc2VTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBCdXR0b25TdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9zdHlsZS9CdXR0b25TdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL0J1dHRvblN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiQnV0dG9uU3R5bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gQnV0dG9uU3R5bGVfMS5CdXR0b25TdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBDaGVja1N0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3N0eWxlL0NoZWNrU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9DaGVja1N0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiQ2hlY2tTdHlsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBDaGVja1N0eWxlXzEuQ2hlY2tTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBJY29uU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvSWNvblN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvSWNvblN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiSWNvblN0eWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEljb25TdHlsZV8xLkljb25TdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBJbWFnZVN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3N0eWxlL0ltYWdlU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9JbWFnZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiSW1hZ2VTdHlsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBJbWFnZVN0eWxlXzEuSW1hZ2VTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBNZW51U3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvTWVudVN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvTWVudVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTWVudVN0eWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE1lbnVTdHlsZV8xLk1lbnVTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBNdWx0aWxpbmVUZXh0U3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvTXVsdGlsaW5lVGV4dFN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvTXVsdGlsaW5lVGV4dFN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTXVsdGlsaW5lVGV4dFN0eWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE11bHRpbGluZVRleHRTdHlsZV8xLk11bHRpbGluZVRleHRTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBOdW1iZXJTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9zdHlsZS9OdW1iZXJTdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL051bWJlclN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTnVtYmVyU3R5bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyU3R5bGVfMS5OdW1iZXJTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBQZXJjZW50Q29tcGxldGVCYXJTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9zdHlsZS9QZXJjZW50Q29tcGxldGVCYXJTdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL1BlcmNlbnRDb21wbGV0ZUJhclN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiUGVyY2VudENvbXBsZXRlQmFyU3R5bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gUGVyY2VudENvbXBsZXRlQmFyU3R5bGVfMS5QZXJjZW50Q29tcGxldGVCYXJTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBSYWRpb1N0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3N0eWxlL1JhZGlvU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9SYWRpb1N0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiUmFkaW9TdHlsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBSYWRpb1N0eWxlXzEuUmFkaW9TdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9zdHlsZS9TdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL1N0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiU3R5bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gU3R5bGVfMS5TdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBUcmVlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvVHJlZVN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvVHJlZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiVHJlZVN0eWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFRyZWVTdHlsZV8xLlRyZWVTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YXIgRVZFTlRfVFlQRSA9IEJhc2VTdHlsZV8xLkJhc2VTdHlsZS5FVkVOVF9UWVBFO1xuICAgICAgICAgIGV4cG9ydHMuRVZFTlRfVFlQRSA9IEVWRU5UX1RZUEU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBvZihjb2x1bW5TdHlsZSwgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICByZWNvcmQpIHtcbiAgICAgICAgICAgIHZhciBTdHlsZUNsYXNzRGVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBTdHlsZV8xLlN0eWxlO1xuXG4gICAgICAgICAgICBpZiAoY29sdW1uU3R5bGUpIHtcbiAgICAgICAgICAgICAgaWYgKGNvbHVtblN0eWxlIGluc3RhbmNlb2YgQmFzZVN0eWxlXzEuQmFzZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbHVtblN0eWxlO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb2x1bW5TdHlsZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9mKGNvbHVtblN0eWxlKHJlY29yZCksIHJlY29yZCwgU3R5bGVDbGFzc0RlZik7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVjb3JkICYmIGNvbHVtblN0eWxlIGluIHJlY29yZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvZihyZWNvcmRbY29sdW1uU3R5bGVdLCByZWNvcmQsIFN0eWxlQ2xhc3NEZWYpO1xuICAgICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cblxuICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0eWxlQ2xhc3NEZWYoY29sdW1uU3R5bGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFN0eWxlQ2xhc3NEZWYuREVGQVVMVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm9mID0gb2Y7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9CYXNlU3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3N0eWxlL0Jhc2VTdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNTdHlsZUJhc2VTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQmFzZVN0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEV2ZW50VGFyZ2V0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9jb3JlL0V2ZW50VGFyZ2V0ICovXG4gICAgICAgICAgXCIuL2NvcmUvRXZlbnRUYXJnZXQuanNcIik7XG5cbiAgICAgICAgICB2YXIgU1RZTEVfRVZFTlRfVFlQRSA9IHtcbiAgICAgICAgICAgIENIQU5HRV9TVFlMRTogXCJjaGFuZ2Vfc3R5bGVcIlxuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBCYXNlU3R5bGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9FdmVudFRhcmdldF8xJEV2ZW50VCkge1xuICAgICAgICAgICAgX2luaGVyaXRzKEJhc2VTdHlsZSwgX0V2ZW50VGFyZ2V0XzEkRXZlbnRUKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjIwID0gX2NyZWF0ZVN1cGVyKEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEJhc2VTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNDE7XG5cbiAgICAgICAgICAgICAgdmFyIF9yZWYyNiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge30sXG4gICAgICAgICAgICAgICAgICBiZ0NvbG9yID0gX3JlZjI2LmJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ID0gX3JlZjI2LnZpc2liaWxpdHksXG4gICAgICAgICAgICAgICAgICBpbmRpY2F0b3JUb3BMZWZ0ID0gX3JlZjI2LmluZGljYXRvclRvcExlZnQsXG4gICAgICAgICAgICAgICAgICBpbmRpY2F0b3JUb3BSaWdodCA9IF9yZWYyNi5pbmRpY2F0b3JUb3BSaWdodCxcbiAgICAgICAgICAgICAgICAgIGluZGljYXRvckJvdHRvbVJpZ2h0ID0gX3JlZjI2LmluZGljYXRvckJvdHRvbVJpZ2h0LFxuICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yQm90dG9tTGVmdCA9IF9yZWYyNi5pbmRpY2F0b3JCb3R0b21MZWZ0O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlU3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNDEgPSBfc3VwZXIyMC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICBfdGhpczQxLl9iZ0NvbG9yID0gYmdDb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM0MS5fdmlzaWJpbGl0eSA9IG5vcm1hbGl6ZVZpc2liaWxpdHkodmlzaWJpbGl0eSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgX3RoaXM0MS5faW5kaWNhdG9yVG9wTGVmdCA9IG5vcm1hbGl6ZUluZGljYXRvcihpbmRpY2F0b3JUb3BMZWZ0KTtcbiAgICAgICAgICAgICAgX3RoaXM0MS5faW5kaWNhdG9yVG9wUmlnaHQgPSBub3JtYWxpemVJbmRpY2F0b3IoaW5kaWNhdG9yVG9wUmlnaHQpO1xuICAgICAgICAgICAgICBfdGhpczQxLl9pbmRpY2F0b3JCb3R0b21SaWdodCA9IG5vcm1hbGl6ZUluZGljYXRvcihpbmRpY2F0b3JCb3R0b21SaWdodCk7XG4gICAgICAgICAgICAgIF90aGlzNDEuX2luZGljYXRvckJvdHRvbUxlZnQgPSBub3JtYWxpemVJbmRpY2F0b3IoaW5kaWNhdG9yQm90dG9tTGVmdCk7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczQxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQmFzZVN0eWxlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiYmdDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmdDb2xvcjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYmdDb2xvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JnQ29sb3IgPSBiZ0NvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ2aXNpYmlsaXR5XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl92aXNpYmlsaXR5O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2aXNpYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSBub3JtYWxpemVWaXNpYmlsaXR5KHZpc2liaWxpdHksIHRoaXMuX3Zpc2liaWxpdHkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Zpc2liaWxpdHkgPT09IG5vcm1hbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl92aXNpYmlsaXR5ID0gbm9ybWFsaXplZDtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaW5kaWNhdG9yVG9wTGVmdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faW5kaWNhdG9yVG9wTGVmdDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoaW5kaWNhdG9yVG9wTGVmdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2luZGljYXRvclRvcExlZnQgPSBub3JtYWxpemVJbmRpY2F0b3IoaW5kaWNhdG9yVG9wTGVmdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImluZGljYXRvclRvcFJpZ2h0XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmRpY2F0b3JUb3BSaWdodDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoaW5kaWNhdG9yVG9wUmlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbmRpY2F0b3JUb3BSaWdodCA9IG5vcm1hbGl6ZUluZGljYXRvcihpbmRpY2F0b3JUb3BSaWdodCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImluZGljYXRvckJvdHRvbVJpZ2h0XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmRpY2F0b3JCb3R0b21SaWdodDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoaW5kaWNhdG9yQm90dG9tUmlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbmRpY2F0b3JCb3R0b21SaWdodCA9IG5vcm1hbGl6ZUluZGljYXRvcihpbmRpY2F0b3JCb3R0b21SaWdodCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImluZGljYXRvckJvdHRvbUxlZnRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luZGljYXRvckJvdHRvbUxlZnQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGluZGljYXRvckJvdHRvbUxlZnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbmRpY2F0b3JCb3R0b21MZWZ0ID0gbm9ybWFsaXplSW5kaWNhdG9yKGluZGljYXRvckJvdHRvbUxlZnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkb0NoYW5nZVN0eWxlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkb0NoYW5nZVN0eWxlKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlyZUxpc3RlbmVycyhTVFlMRV9FVkVOVF9UWVBFLkNIQU5HRV9TVFlMRSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJhc2VTdHlsZSh0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJFVkVOVF9UWVBFXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBTVFlMRV9FVkVOVF9UWVBFO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJERUZBVUxUXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0U3R5bGUgPyBkZWZhdWx0U3R5bGUgOiBkZWZhdWx0U3R5bGUgPSBuZXcgQmFzZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEJhc2VTdHlsZTtcbiAgICAgICAgICB9KEV2ZW50VGFyZ2V0XzEuRXZlbnRUYXJnZXQpO1xuXG4gICAgICAgICAgZXhwb3J0cy5CYXNlU3R5bGUgPSBCYXNlU3R5bGU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVJbmRpY2F0b3IoaW5kaWNhdG9yKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGluZGljYXRvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0eWxlOiBpbmRpY2F0b3JcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGluZGljYXRvcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVWaXNpYmlsaXR5KHZpc2liaWxpdHksIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZpc2liaWxpdHkgJiYgdmlzaWJpbGl0eSAhPT0gXCJ2aXNpYmxlXCIgJiYgdmlzaWJpbGl0eSAhPT0gXCJoaWRkZW5cIikge1xuICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdmlzaWJpbGl0eTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqKi9cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL0JyYW5jaEdyYXBoU3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9zdHlsZS9CcmFuY2hHcmFwaFN0eWxlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNTdHlsZUJyYW5jaEdyYXBoU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkJyYW5jaEdyYXBoU3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQmFzZVN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VTdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL0Jhc2VTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBkZWZhdWx0U3R5bGU7XG5cbiAgICAgICAgICB2YXIgREVGQVVMVF9CUkFOQ0hfQ09MT1JTID0gZnVuY3Rpb24gREVGQVVMVF9CUkFOQ0hfQ09MT1JTKF9uYW1lLCBpbmRleCkge1xuICAgICAgICAgICAgc3dpdGNoIChpbmRleCAlIDMpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIiM5Nzk3OTdcIjtcblxuICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiIzAwOGZiNVwiO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCIjZjFjMTA5XCI7XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFwiIzk3OTc5N1wiO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgQnJhbmNoR3JhcGhTdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VTdHlsZV8xJEJhc2VTdHlsKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQnJhbmNoR3JhcGhTdHlsZSwgX0Jhc2VTdHlsZV8xJEJhc2VTdHlsKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjIxID0gX2NyZWF0ZVN1cGVyKEJyYW5jaEdyYXBoU3R5bGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBCcmFuY2hHcmFwaFN0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM0MjtcblxuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCcmFuY2hHcmFwaFN0eWxlKTtcblxuICAgICAgICAgICAgICBfdGhpczQyID0gX3N1cGVyMjEuY2FsbCh0aGlzLCBzdHlsZSk7XG4gICAgICAgICAgICAgIF90aGlzNDIuX2JyYW5jaENvbG9ycyA9IHN0eWxlLmJyYW5jaENvbG9ycyB8fCBERUZBVUxUX0JSQU5DSF9DT0xPUlM7XG4gICAgICAgICAgICAgIF90aGlzNDIuX21hcmdpbiA9IHN0eWxlLm1hcmdpbiB8fCA0O1xuICAgICAgICAgICAgICBfdGhpczQyLl9jaXJjbGVTaXplID0gc3R5bGUuY2lyY2xlU2l6ZSB8fCAxNjtcbiAgICAgICAgICAgICAgX3RoaXM0Mi5fYnJhbmNoTGluZVdpZHRoID0gc3R5bGUuYnJhbmNoTGluZVdpZHRoIHx8IDQ7XG4gICAgICAgICAgICAgIF90aGlzNDIuX21lcmdlU3R5bGUgPSBzdHlsZS5tZXJnZVN0eWxlID09PSBcInN0cmFpZ2h0XCIgPyBcInN0cmFpZ2h0XCIgOiBcImJlemllclwiO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0MjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEJyYW5jaEdyYXBoU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJicmFuY2hDb2xvcnNcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JyYW5jaENvbG9ycztcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYnJhbmNoQ29sb3JzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYnJhbmNoQ29sb3JzID0gYnJhbmNoQ29sb3JzO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJtYXJnaW5cIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21hcmdpbjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobWFyZ2luKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWFyZ2luID0gbWFyZ2luO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjaXJjbGVTaXplXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaXJjbGVTaXplO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjaXJjbGVTaXplKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2lyY2xlU2l6ZSA9IGNpcmNsZVNpemU7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJyYW5jaExpbmVXaWR0aFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYnJhbmNoTGluZVdpZHRoO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChicmFuY2hMaW5lV2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9icmFuY2hMaW5lV2lkdGggPSBicmFuY2hMaW5lV2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm1lcmdlU3R5bGVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lcmdlU3R5bGU7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KG1lcmdlU3R5bGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZXJnZVN0eWxlID0gbWVyZ2VTdHlsZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQnJhbmNoR3JhcGhTdHlsZSh0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJERUZBVUxUXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0U3R5bGUgPyBkZWZhdWx0U3R5bGUgOiBkZWZhdWx0U3R5bGUgPSBuZXcgQnJhbmNoR3JhcGhTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCcmFuY2hHcmFwaFN0eWxlO1xuICAgICAgICAgIH0oQmFzZVN0eWxlXzEuQmFzZVN0eWxlKTtcblxuICAgICAgICAgIGV4cG9ydHMuQnJhbmNoR3JhcGhTdHlsZSA9IEJyYW5jaEdyYXBoU3R5bGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9CdXR0b25TdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9zdHlsZS9CdXR0b25TdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1N0eWxlQnV0dG9uU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkJ1dHRvblN0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL1N0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBCdXR0b25TdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0eWxlXzEkU3R5bGUpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhCdXR0b25TdHlsZSwgX1N0eWxlXzEkU3R5bGUpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMjIgPSBfY3JlYXRlU3VwZXIoQnV0dG9uU3R5bGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBCdXR0b25TdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNDM7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQnV0dG9uU3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNDMgPSBfc3VwZXIyMi5jYWxsKHRoaXMsICgwLCB1dGlsc18xLmRlZmF1bHRzKShzdHlsZSwge1xuICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIlxuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIHZhciBidXR0b25CZ0NvbG9yID0gc3R5bGUuYnV0dG9uQmdDb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM0My5fYnV0dG9uQmdDb2xvciA9IGJ1dHRvbkJnQ29sb3I7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczQzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQnV0dG9uU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJidXR0b25CZ0NvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9idXR0b25CZ0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChidXR0b25CZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYnV0dG9uQmdDb2xvciA9IGJ1dHRvbkJnQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJ1dHRvblN0eWxlKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBCdXR0b25TdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCdXR0b25TdHlsZTtcbiAgICAgICAgICB9KFN0eWxlXzEuU3R5bGUpO1xuXG4gICAgICAgICAgZXhwb3J0cy5CdXR0b25TdHlsZSA9IEJ1dHRvblN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvQ2hlY2tTdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3N0eWxlL0NoZWNrU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1N0eWxlQ2hlY2tTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQ2hlY2tTdHlsZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBTdGRCYXNlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vU3RkQmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvU3RkQmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBkZWZhdWx0U3R5bGU7XG5cbiAgICAgICAgICB2YXIgQ2hlY2tTdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0ZEJhc2VTdHlsZV8xJFN0ZEJhKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQ2hlY2tTdHlsZSwgX1N0ZEJhc2VTdHlsZV8xJFN0ZEJhKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjIzID0gX2NyZWF0ZVN1cGVyKENoZWNrU3R5bGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBDaGVja1N0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM0NDtcblxuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaGVja1N0eWxlKTtcblxuICAgICAgICAgICAgICBfdGhpczQ0ID0gX3N1cGVyMjMuY2FsbCh0aGlzLCAoMCwgdXRpbHNfMS5kZWZhdWx0cykoc3R5bGUsIHtcbiAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwiY2VudGVyXCJcbiAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICB2YXIgdW5jaGVja0JnQ29sb3IgPSBzdHlsZS51bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgIGNoZWNrQmdDb2xvciA9IHN0eWxlLmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yID0gc3R5bGUuYm9yZGVyQ29sb3I7XG4gICAgICAgICAgICAgIF90aGlzNDQuX3VuY2hlY2tCZ0NvbG9yID0gdW5jaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgIF90aGlzNDQuX2NoZWNrQmdDb2xvciA9IGNoZWNrQmdDb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM0NC5fYm9yZGVyQ29sb3IgPSBib3JkZXJDb2xvcjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNDQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhDaGVja1N0eWxlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwidW5jaGVja0JnQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh1bmNoZWNrQmdDb2xvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VuY2hlY2tCZ0NvbG9yID0gdW5jaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNoZWNrQmdDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjaGVja0JnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0JnQ29sb3IgPSBjaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJvcmRlckNvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ib3JkZXJDb2xvcjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYm9yZGVyQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ib3JkZXJDb2xvciA9IGJvcmRlckNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGVja1N0eWxlKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBDaGVja1N0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIENoZWNrU3R5bGU7XG4gICAgICAgICAgfShTdGRCYXNlU3R5bGVfMS5TdGRCYXNlU3R5bGUpO1xuXG4gICAgICAgICAgZXhwb3J0cy5DaGVja1N0eWxlID0gQ2hlY2tTdHlsZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL0ljb25TdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvc3R5bGUvSWNvblN0eWxlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1N0eWxlSWNvblN0eWxlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5JY29uU3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9TdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgZGVmYXVsdFN0eWxlO1xuXG4gICAgICAgICAgdmFyIEljb25TdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0eWxlXzEkU3R5bGUyKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoSWNvblN0eWxlLCBfU3R5bGVfMSRTdHlsZTIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMjQgPSBfY3JlYXRlU3VwZXIoSWNvblN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gSWNvblN0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJY29uU3R5bGUpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXIyNC5jYWxsKHRoaXMsICgwLCB1dGlsc18xLmRlZmF1bHRzKShzdHlsZSwge1xuICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIlxuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJY29uU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJY29uU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IEljb25TdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJY29uU3R5bGU7XG4gICAgICAgICAgfShTdHlsZV8xLlN0eWxlKTtcblxuICAgICAgICAgIGV4cG9ydHMuSWNvblN0eWxlID0gSWNvblN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvSW1hZ2VTdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3N0eWxlL0ltYWdlU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1N0eWxlSW1hZ2VTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuSW1hZ2VTdHlsZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBTdGRCYXNlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vU3RkQmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvU3RkQmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBkZWZhdWx0U3R5bGU7XG5cbiAgICAgICAgICB2YXIgSW1hZ2VTdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0ZEJhc2VTdHlsZV8xJFN0ZEJhMikge1xuICAgICAgICAgICAgX2luaGVyaXRzKEltYWdlU3R5bGUsIF9TdGRCYXNlU3R5bGVfMSRTdGRCYTIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMjUgPSBfY3JlYXRlU3VwZXIoSW1hZ2VTdHlsZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEltYWdlU3R5bGUoKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczQ1O1xuXG4gICAgICAgICAgICAgIHZhciBzdHlsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEltYWdlU3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNDUgPSBfc3VwZXIyNS5jYWxsKHRoaXMsICgwLCB1dGlsc18xLmRlZmF1bHRzKShzdHlsZSwge1xuICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIlxuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIF90aGlzNDUuX2ltYWdlU2l6aW5nID0gc3R5bGUuaW1hZ2VTaXppbmc7XG4gICAgICAgICAgICAgIF90aGlzNDUuX21hcmdpbiA9IHN0eWxlLm1hcmdpbiB8fCA0O1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0NTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEltYWdlU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJpbWFnZVNpemluZ1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faW1hZ2VTaXppbmc7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGltYWdlU2l6aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW1hZ2VTaXppbmcgPSBpbWFnZVNpemluZztcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibWFyZ2luXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXJnaW47XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KG1hcmdpbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX21hcmdpbiA9IG1hcmdpbjtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW1hZ2VTdHlsZSh0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJERUZBVUxUXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0U3R5bGUgPyBkZWZhdWx0U3R5bGUgOiBkZWZhdWx0U3R5bGUgPSBuZXcgSW1hZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbWFnZVN0eWxlO1xuICAgICAgICAgIH0oU3RkQmFzZVN0eWxlXzEuU3RkQmFzZVN0eWxlKTtcblxuICAgICAgICAgIGV4cG9ydHMuSW1hZ2VTdHlsZSA9IEltYWdlU3R5bGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9NZW51U3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3N0eWxlL01lbnVTdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNTdHlsZU1lbnVTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTWVudVN0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL1N0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgZGVmYXVsdFN0eWxlO1xuXG4gICAgICAgICAgdmFyIE1lbnVTdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0eWxlXzEkU3R5bGUzKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoTWVudVN0eWxlLCBfU3R5bGVfMSRTdHlsZTMpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMjYgPSBfY3JlYXRlU3VwZXIoTWVudVN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gTWVudVN0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM0NjtcblxuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZW51U3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNDYgPSBfc3VwZXIyNi5jYWxsKHRoaXMsIHN0eWxlKTtcbiAgICAgICAgICAgICAgdmFyIGFwcGVhcmFuY2UgPSBzdHlsZS5hcHBlYXJhbmNlO1xuICAgICAgICAgICAgICBfdGhpczQ2Ll9hcHBlYXJhbmNlID0gYXBwZWFyYW5jZTtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNDY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhNZW51U3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJhcHBlYXJhbmNlXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBlYXJhbmNlIHx8IFwibWVudWxpc3QtYnV0dG9uXCI7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGFwcGVhcmFuY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hcHBlYXJhbmNlID0gYXBwZWFyYW5jZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWVudVN0eWxlKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBNZW51U3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTWVudVN0eWxlO1xuICAgICAgICAgIH0oU3R5bGVfMS5TdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLk1lbnVTdHlsZSA9IE1lbnVTdHlsZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL011bHRpbGluZVRleHRTdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvc3R5bGUvTXVsdGlsaW5lVGV4dFN0eWxlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1N0eWxlTXVsdGlsaW5lVGV4dFN0eWxlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5NdWx0aWxpbmVUZXh0U3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9TdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgZGVmYXVsdFN0eWxlO1xuXG4gICAgICAgICAgdmFyIE11bHRpbGluZVRleHRTdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0eWxlXzEkU3R5bGU0KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoTXVsdGlsaW5lVGV4dFN0eWxlLCBfU3R5bGVfMSRTdHlsZTQpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMjcgPSBfY3JlYXRlU3VwZXIoTXVsdGlsaW5lVGV4dFN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gTXVsdGlsaW5lVGV4dFN0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM0NztcblxuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNdWx0aWxpbmVUZXh0U3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNDcgPSBfc3VwZXIyNy5jYWxsKHRoaXMsICgwLCB1dGlsc18xLmRlZmF1bHRzKShzdHlsZSwge1xuICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZTogXCJ0b3BcIlxuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIF90aGlzNDcuX2xpbmVIZWlnaHQgPSBzdHlsZS5saW5lSGVpZ2h0IHx8IFwiMWVtXCI7XG4gICAgICAgICAgICAgIF90aGlzNDcuX2F1dG9XcmFwVGV4dCA9IHN0eWxlLmF1dG9XcmFwVGV4dCB8fCBmYWxzZTtcbiAgICAgICAgICAgICAgX3RoaXM0Ny5fbGluZUNsYW1wID0gc3R5bGUubGluZUNsYW1wO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0NztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKE11bHRpbGluZVRleHRTdHlsZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE11bHRpbGluZVRleHRTdHlsZSh0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibGluZUhlaWdodFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGluZUhlaWdodDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobGluZUhlaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xpbmVIZWlnaHQgPSBsaW5lSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJsaW5lQ2xhbXBcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpbmVDbGFtcDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobGluZUNsYW1wKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGluZUNsYW1wID0gbGluZUNsYW1wO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhdXRvV3JhcFRleHRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2F1dG9XcmFwVGV4dDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYXV0b1dyYXBUZXh0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXV0b1dyYXBUZXh0ID0gYXV0b1dyYXBUZXh0O1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBNdWx0aWxpbmVUZXh0U3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTXVsdGlsaW5lVGV4dFN0eWxlO1xuICAgICAgICAgIH0oU3R5bGVfMS5TdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLk11bHRpbGluZVRleHRTdHlsZSA9IE11bHRpbGluZVRleHRTdHlsZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL051bWJlclN0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3N0eWxlL051bWJlclN0eWxlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zU3R5bGVOdW1iZXJTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTnVtYmVyU3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9TdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgZGVmYXVsdFN0eWxlO1xuXG4gICAgICAgICAgdmFyIE51bWJlclN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3R5bGVfMSRTdHlsZTUpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhOdW1iZXJTdHlsZSwgX1N0eWxlXzEkU3R5bGU1KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjI4ID0gX2NyZWF0ZVN1cGVyKE51bWJlclN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gTnVtYmVyU3R5bGUoKSB7XG4gICAgICAgICAgICAgIHZhciBzdHlsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE51bWJlclN0eWxlKTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3N1cGVyMjguY2FsbCh0aGlzLCAoMCwgdXRpbHNfMS5kZWZhdWx0cykoc3R5bGUsIHtcbiAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwicmlnaHRcIlxuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhOdW1iZXJTdHlsZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE51bWJlclN0eWxlKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBOdW1iZXJTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBOdW1iZXJTdHlsZTtcbiAgICAgICAgICB9KFN0eWxlXzEuU3R5bGUpO1xuXG4gICAgICAgICAgZXhwb3J0cy5OdW1iZXJTdHlsZSA9IE51bWJlclN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvUGVyY2VudENvbXBsZXRlQmFyU3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvc3R5bGUvUGVyY2VudENvbXBsZXRlQmFyU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNTdHlsZVBlcmNlbnRDb21wbGV0ZUJhclN0eWxlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5QZXJjZW50Q29tcGxldGVCYXJTdHlsZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9TdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL1N0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBERUZBVUxUX0JBUl9DT0xPUiA9IGZ1bmN0aW9uIERFRkFVTFRfQkFSX0NPTE9SKG51bSkge1xuICAgICAgICAgICAgaWYgKG51bSA+IDgwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBcIiMyMGE4ZDhcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG51bSA+IDUwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBcIiM0ZGJkNzRcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG51bSA+IDIwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBcIiNmZmMxMDdcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFwiI2Y4NmM2YlwiO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgUGVyY2VudENvbXBsZXRlQmFyU3R5bGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdHlsZV8xJFN0eWxlNikge1xuICAgICAgICAgICAgX2luaGVyaXRzKFBlcmNlbnRDb21wbGV0ZUJhclN0eWxlLCBfU3R5bGVfMSRTdHlsZTYpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMjkgPSBfY3JlYXRlU3VwZXIoUGVyY2VudENvbXBsZXRlQmFyU3R5bGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBQZXJjZW50Q29tcGxldGVCYXJTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNDg7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGVyY2VudENvbXBsZXRlQmFyU3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNDggPSBfc3VwZXIyOS5jYWxsKHRoaXMsIHN0eWxlKTtcbiAgICAgICAgICAgICAgX3RoaXM0OC5fYmFyQ29sb3IgPSBzdHlsZS5iYXJDb2xvciB8fCBERUZBVUxUX0JBUl9DT0xPUjtcbiAgICAgICAgICAgICAgX3RoaXM0OC5fYmFyQmdDb2xvciA9IHN0eWxlLmJhckJnQ29sb3IgfHwgXCIjZjBmM2Y1XCI7XG4gICAgICAgICAgICAgIF90aGlzNDguX2JhckhlaWdodCA9IHN0eWxlLmJhckhlaWdodCB8fCAzO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0ODtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFBlcmNlbnRDb21wbGV0ZUJhclN0eWxlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiYmFyQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhckNvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChiYXJDb2xvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JhckNvbG9yID0gYmFyQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJhckJnQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhckJnQ29sb3I7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGJhckJnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYXJCZ0NvbG9yID0gYmFyQmdDb2xvcjtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYmFySGVpZ2h0XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYXJIZWlnaHQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGJhckhlaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JhckhlaWdodCA9IGJhckhlaWdodDtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUGVyY2VudENvbXBsZXRlQmFyU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IFBlcmNlbnRDb21wbGV0ZUJhclN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFBlcmNlbnRDb21wbGV0ZUJhclN0eWxlO1xuICAgICAgICAgIH0oU3R5bGVfMS5TdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLlBlcmNlbnRDb21wbGV0ZUJhclN0eWxlID0gUGVyY2VudENvbXBsZXRlQmFyU3R5bGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9SYWRpb1N0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvc3R5bGUvUmFkaW9TdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zU3R5bGVSYWRpb1N0eWxlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5SYWRpb1N0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFN0ZEJhc2VTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9TdGRCYXNlU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9TdGRCYXNlU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBSYWRpb1N0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RkQmFzZVN0eWxlXzEkU3RkQmEzKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoUmFkaW9TdHlsZSwgX1N0ZEJhc2VTdHlsZV8xJFN0ZEJhMyk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXIzMCA9IF9jcmVhdGVTdXBlcihSYWRpb1N0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gUmFkaW9TdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNDk7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmFkaW9TdHlsZSk7XG5cbiAgICAgICAgICAgICAgX3RoaXM0OSA9IF9zdXBlcjMwLmNhbGwodGhpcywgKDAsIHV0aWxzXzEuZGVmYXVsdHMpKHN0eWxlLCB7XG4gICAgICAgICAgICAgICAgdGV4dEFsaWduOiBcImNlbnRlclwiXG4gICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgdmFyIGNoZWNrQ29sb3IgPSBzdHlsZS5jaGVja0NvbG9yLFxuICAgICAgICAgICAgICAgICAgdW5jaGVja0JvcmRlckNvbG9yID0gc3R5bGUudW5jaGVja0JvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgICAgY2hlY2tCb3JkZXJDb2xvciA9IHN0eWxlLmNoZWNrQm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvciA9IHN0eWxlLnVuY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yID0gc3R5bGUuY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICBfdGhpczQ5Ll9jaGVja0NvbG9yID0gY2hlY2tDb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM0OS5fdW5jaGVja0JvcmRlckNvbG9yID0gdW5jaGVja0JvcmRlckNvbG9yO1xuICAgICAgICAgICAgICBfdGhpczQ5Ll9jaGVja0JvcmRlckNvbG9yID0gY2hlY2tCb3JkZXJDb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM0OS5fdW5jaGVja0JnQ29sb3IgPSB1bmNoZWNrQmdDb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM0OS5fY2hlY2tCZ0NvbG9yID0gY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0OTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFJhZGlvU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjaGVja0NvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGVja0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjaGVja0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tDb2xvciA9IGNoZWNrQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInVuY2hlY2tCb3JkZXJDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdW5jaGVja0JvcmRlckNvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh1bmNoZWNrQm9yZGVyQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl91bmNoZWNrQm9yZGVyQ29sb3IgPSB1bmNoZWNrQm9yZGVyQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNoZWNrQm9yZGVyQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoZWNrQm9yZGVyQ29sb3I7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNoZWNrQm9yZGVyQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0JvcmRlckNvbG9yID0gY2hlY2tCb3JkZXJDb2xvcjtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidW5jaGVja0JnQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh1bmNoZWNrQmdDb2xvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VuY2hlY2tCZ0NvbG9yID0gdW5jaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNoZWNrQmdDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjaGVja0JnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0JnQ29sb3IgPSBjaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJhZGlvU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IFJhZGlvU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gUmFkaW9TdHlsZTtcbiAgICAgICAgICB9KFN0ZEJhc2VTdHlsZV8xLlN0ZEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLlJhZGlvU3R5bGUgPSBSYWRpb1N0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvU3RkQmFzZVN0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9zdHlsZS9TdGRCYXNlU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zU3R5bGVTdGRCYXNlU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlN0ZEJhc2VTdHlsZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vQmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvQmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBTdGRCYXNlU3R5bGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlU3R5bGVfMSRCYXNlU3R5bDIpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhTdGRCYXNlU3R5bGUsIF9CYXNlU3R5bGVfMSRCYXNlU3R5bDIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMzEgPSBfY3JlYXRlU3VwZXIoU3RkQmFzZVN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gU3RkQmFzZVN0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM1MDtcblxuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdGRCYXNlU3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNTAgPSBfc3VwZXIzMS5jYWxsKHRoaXMsIHN0eWxlKTtcbiAgICAgICAgICAgICAgX3RoaXM1MC5fdGV4dEFsaWduID0gc3R5bGUudGV4dEFsaWduIHx8IFwibGVmdFwiO1xuICAgICAgICAgICAgICBfdGhpczUwLl90ZXh0QmFzZWxpbmUgPSBzdHlsZS50ZXh0QmFzZWxpbmUgfHwgXCJtaWRkbGVcIjtcbiAgICAgICAgICAgICAgX3RoaXM1MC5fcGFkZGluZyA9IHN0eWxlLnBhZGRpbmc7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczUwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoU3RkQmFzZVN0eWxlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwidGV4dEFsaWduXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZXh0QWxpZ247XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHRleHRBbGlnbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RleHRBbGlnbiA9IHRleHRBbGlnbjtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidGV4dEJhc2VsaW5lXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZXh0QmFzZWxpbmU7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHRleHRCYXNlbGluZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RleHRCYXNlbGluZSA9IHRleHRCYXNlbGluZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicGFkZGluZ1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcGFkZGluZztcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQocGFkZGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BhZGRpbmcgPSBwYWRkaW5nO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdGRCYXNlU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IFN0ZEJhc2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBTdGRCYXNlU3R5bGU7XG4gICAgICAgICAgfShCYXNlU3R5bGVfMS5CYXNlU3R5bGUpO1xuXG4gICAgICAgICAgZXhwb3J0cy5TdGRCYXNlU3R5bGUgPSBTdGRCYXNlU3R5bGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9TdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy9zdHlsZS9TdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1N0eWxlU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlN0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFN0ZEJhc2VTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9TdGRCYXNlU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9TdGRCYXNlU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgZGVmYXVsdFN0eWxlO1xuXG4gICAgICAgICAgdmFyIFN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RkQmFzZVN0eWxlXzEkU3RkQmE0KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoU3R5bGUsIF9TdGRCYXNlU3R5bGVfMSRTdGRCYTQpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMzIgPSBfY3JlYXRlU3VwZXIoU3R5bGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNTE7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNTEgPSBfc3VwZXIzMi5jYWxsKHRoaXMsIHN0eWxlKTtcbiAgICAgICAgICAgICAgX3RoaXM1MS5fY29sb3IgPSBzdHlsZS5jb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM1MS5fZm9udCA9IHN0eWxlLmZvbnQ7XG4gICAgICAgICAgICAgIF90aGlzNTEuX3RleHRPdmVyZmxvdyA9IHN0eWxlLnRleHRPdmVyZmxvdyB8fCBcImNsaXBcIjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhTdHlsZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb2xvcjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmb250XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mb250O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChmb250KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZm9udCA9IGZvbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRleHRPdmVyZmxvd1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdGV4dE92ZXJmbG93O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh0ZXh0T3ZlcmZsb3cpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXh0T3ZlcmZsb3cgPSB0ZXh0T3ZlcmZsb3c7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0eWxlKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBTdHlsZTtcbiAgICAgICAgICB9KFN0ZEJhc2VTdHlsZV8xLlN0ZEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLlN0eWxlID0gU3R5bGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9UcmVlU3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3N0eWxlL1RyZWVTdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNTdHlsZVRyZWVTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuVHJlZVN0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL1N0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgZGVmYXVsdFN0eWxlO1xuXG4gICAgICAgICAgdmFyIFRyZWVTdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0eWxlXzEkU3R5bGU3KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoVHJlZVN0eWxlLCBfU3R5bGVfMSRTdHlsZTcpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMzMgPSBfY3JlYXRlU3VwZXIoVHJlZVN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gVHJlZVN0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM1MjtcblxuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmVlU3R5bGUpO1xuXG4gICAgICAgICAgICAgIF90aGlzNTIgPSBfc3VwZXIzMy5jYWxsKHRoaXMsIHN0eWxlKTtcbiAgICAgICAgICAgICAgX3RoaXM1Mi5fbGluZVN0eWxlID0gc3R5bGUubGluZVN0eWxlO1xuICAgICAgICAgICAgICBfdGhpczUyLl9saW5lQ29sb3IgPSBzdHlsZS5saW5lQ29sb3I7XG4gICAgICAgICAgICAgIF90aGlzNTIuX2xpbmVXaWR0aCA9IHN0eWxlLmxpbmVXaWR0aDtcbiAgICAgICAgICAgICAgX3RoaXM1Mi5fdHJlZUljb24gPSBzdHlsZS50cmVlSWNvbjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNTI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhUcmVlU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUcmVlU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImxpbmVTdHlsZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGluZVN0eWxlO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChsaW5lU3R5bGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9saW5lU3R5bGUgPSBsaW5lU3R5bGU7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImxpbmVDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGluZUNvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChsaW5lQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9saW5lQ29sb3IgPSBsaW5lQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImxpbmVXaWR0aFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGluZVdpZHRoO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChsaW5lV2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9saW5lV2lkdGggPSBsaW5lV2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRyZWVJY29uXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90cmVlSWNvbjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodHJlZUljb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmVlSWNvbiA9IHRyZWVJY29uO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBUcmVlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gVHJlZVN0eWxlO1xuICAgICAgICAgIH0oU3R5bGVfMS5TdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLlRyZWVTdHlsZSA9IFRyZWVTdHlsZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3R5cGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy90eXBlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNUeXBlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5vZiA9IGV4cG9ydHMuVHJlZUNvbHVtbiA9IGV4cG9ydHMuTXVsdGlsaW5lVGV4dENvbHVtbiA9IGV4cG9ydHMuTWVudUNvbHVtbiA9IGV4cG9ydHMuQnJhbmNoR3JhcGhDb2x1bW4gPSBleHBvcnRzLkljb25Db2x1bW4gPSBleHBvcnRzLlBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbiA9IGV4cG9ydHMuSW1hZ2VDb2x1bW4gPSBleHBvcnRzLkJ1dHRvbkNvbHVtbiA9IGV4cG9ydHMuUmFkaW9Db2x1bW4gPSBleHBvcnRzLkNoZWNrQ29sdW1uID0gZXhwb3J0cy5OdW1iZXJDb2x1bW4gPSBleHBvcnRzLkNvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCcmFuY2hHcmFwaENvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90eXBlL0JyYW5jaEdyYXBoQ29sdW1uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9CcmFuY2hHcmFwaENvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkJyYW5jaEdyYXBoQ29sdW1uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEJyYW5jaEdyYXBoQ29sdW1uXzEuQnJhbmNoR3JhcGhDb2x1bW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgQnV0dG9uQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3R5cGUvQnV0dG9uQ29sdW1uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9CdXR0b25Db2x1bW4uanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJCdXR0b25Db2x1bW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gQnV0dG9uQ29sdW1uXzEuQnV0dG9uQ29sdW1uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIENoZWNrQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3R5cGUvQ2hlY2tDb2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0NoZWNrQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiQ2hlY2tDb2x1bW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gQ2hlY2tDb2x1bW5fMS5DaGVja0NvbHVtbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBDb2x1bW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdHlwZS9Db2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0NvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkNvbHVtblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBDb2x1bW5fMS5Db2x1bW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgSWNvbkNvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90eXBlL0ljb25Db2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0ljb25Db2x1bW4uanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJJY29uQ29sdW1uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEljb25Db2x1bW5fMS5JY29uQ29sdW1uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIEltYWdlQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3R5cGUvSW1hZ2VDb2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0ltYWdlQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiSW1hZ2VDb2x1bW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gSW1hZ2VDb2x1bW5fMS5JbWFnZUNvbHVtbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBNZW51Q29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3R5cGUvTWVudUNvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvTWVudUNvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIk1lbnVDb2x1bW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gTWVudUNvbHVtbl8xLk1lbnVDb2x1bW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgTXVsdGlsaW5lVGV4dENvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90eXBlL011bHRpbGluZVRleHRDb2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL011bHRpbGluZVRleHRDb2x1bW4uanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJNdWx0aWxpbmVUZXh0Q29sdW1uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE11bHRpbGluZVRleHRDb2x1bW5fMS5NdWx0aWxpbmVUZXh0Q29sdW1uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIE51bWJlckNvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90eXBlL051bWJlckNvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvTnVtYmVyQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTnVtYmVyQ29sdW1uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE51bWJlckNvbHVtbl8xLk51bWJlckNvbHVtbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBQZXJjZW50Q29tcGxldGVCYXJDb2x1bW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdHlwZS9QZXJjZW50Q29tcGxldGVCYXJDb2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL1BlcmNlbnRDb21wbGV0ZUJhckNvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlBlcmNlbnRDb21wbGV0ZUJhckNvbHVtblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBQZXJjZW50Q29tcGxldGVCYXJDb2x1bW5fMS5QZXJjZW50Q29tcGxldGVCYXJDb2x1bW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgUmFkaW9Db2x1bW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdHlwZS9SYWRpb0NvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvUmFkaW9Db2x1bW4uanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJSYWRpb0NvbHVtblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBSYWRpb0NvbHVtbl8xLlJhZGlvQ29sdW1uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIFRyZWVDb2x1bW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdHlwZS9UcmVlQ29sdW1uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9UcmVlQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiVHJlZUNvbHVtblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBUcmVlQ29sdW1uXzEuVHJlZUNvbHVtbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YXIgVFlQRVMgPSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgREVGQVVMVDogbmV3IENvbHVtbl8xLkNvbHVtbigpLFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIE5VTUJFUjogbmV3IE51bWJlckNvbHVtbl8xLk51bWJlckNvbHVtbigpLFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIENIRUNLOiBuZXcgQ2hlY2tDb2x1bW5fMS5DaGVja0NvbHVtbigpLFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIFJBRElPOiBuZXcgUmFkaW9Db2x1bW5fMS5SYWRpb0NvbHVtbigpLFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIEJVVFRPTjogbmV3IEJ1dHRvbkNvbHVtbl8xLkJ1dHRvbkNvbHVtbigpLFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIElNQUdFOiBuZXcgSW1hZ2VDb2x1bW5fMS5JbWFnZUNvbHVtbigpLFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIE1VTFRJTElORVRFWFQ6IG5ldyBNdWx0aWxpbmVUZXh0Q29sdW1uXzEuTXVsdGlsaW5lVGV4dENvbHVtbigpXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGZ1bmN0aW9uIG9mKGNvbHVtblR5cGUpIHtcbiAgICAgICAgICAgIGlmICghY29sdW1uVHlwZSkge1xuICAgICAgICAgICAgICByZXR1cm4gVFlQRVMuREVGQVVMVDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbHVtblR5cGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgdmFyIGtleSA9IGNvbHVtblR5cGUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIFRZUEVTW2tleV0gfHwgb2YobnVsbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gY29sdW1uVHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm9mID0gb2Y7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy90eXBlL0Jhc2VDb2x1bW4uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3R5cGUvQmFzZUNvbHVtbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNUeXBlQmFzZUNvbHVtbkpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQmFzZUNvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBzdHlsZUNvbnRlbnRzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3N0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUuanNcIikpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBCYXNlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3N0eWxlL0Jhc2VTdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL0Jhc2VTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBhbmltYXRlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9hbmltYXRlICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL2FuaW1hdGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgc3ltYm9sTWFuYWdlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGhhbmRsZXJzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbmRpY2F0b3IvaGFuZGxlcnMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9pbmRpY2F0b3IvaGFuZGxlcnMuanNcIik7XG5cbiAgICAgICAgICB2YXIgc2V0UmVhZG9ubHkgPSB1dGlsc18xLm9iai5zZXRSZWFkb25seTtcbiAgICAgICAgICB2YXIgQ09MVU1OX0ZBREVJTl9TVEFURV9JRCA9ICgwLCBzeW1ib2xNYW5hZ2VyXzEuZ2V0Q29sdW1uRmFkZWluU3RhdGVJZCkoKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGlzRmFkZWluV2hlbkNhbGxiYWNrSW5Qcm9taXNlKGNvbHVtbiwgZ3JpZCkge1xuICAgICAgICAgICAgaWYgKGNvbHVtbi5mYWRlaW5XaGVuQ2FsbGJhY2tJblByb21pc2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gY29sdW1uLmZhZGVpbldoZW5DYWxsYmFja0luUHJvbWlzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICEhZ3JpZC5jb25maWd1cmUoXCJmYWRlaW5XaGVuQ2FsbGJhY2tJblByb21pc2VcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0RmFkZWluU3RhdGUoZ3JpZCkge1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JpZFtDT0xVTU5fRkFERUlOX1NUQVRFX0lEXTtcblxuICAgICAgICAgICAgaWYgKCFzdGF0ZSkge1xuICAgICAgICAgICAgICBzdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBjZWxsczoge31cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgc2V0UmVhZG9ubHkoZ3JpZCwgQ09MVU1OX0ZBREVJTl9TVEFURV9JRCwgc3RhdGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dlbmVyYXRlRmFkZWluUG9pbnRBY3Rpb24oZ3JpZCwgY29sLCByb3csIGNvbnRleHQsIGRyYXdJbnRlcm5hbCwgZHJhd0NlbGxCYXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdldEZhZGVpblN0YXRlKGdyaWQpO1xuICAgICAgICAgICAgICB2YXIgc3RhdGVLZXkgPSBcIlwiLmNvbmNhdChyb3csIFwiOlwiKS5jb25jYXQoY29sKTtcblxuICAgICAgICAgICAgICBpZiAocG9pbnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgc3RhdGUuY2VsbHNbc3RhdGVLZXldO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0YXRlLmNlbGxzW3N0YXRlS2V5XSA9IHtcbiAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IHBvaW50XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGRyYXdDZWxsQmFzZSgpO1xuICAgICAgICAgICAgICBkcmF3SW50ZXJuYWwoKTtcbiAgICAgICAgICAgICAgdmFyIGNlbGxTdGF0ZSA9IHN0YXRlLmNlbGxzW3N0YXRlS2V5XTtcblxuICAgICAgICAgICAgICBpZiAoY2VsbFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgLy/pgI/pgY7jgZnjgovjgZ/jgoHog4zmma/jgpLpgI/pgY7jgafkuIrmm7jjgY1cbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gY29udGV4dC5nZXRDb250ZXh0KCk7XG4gICAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMSAtIGNlbGxTdGF0ZS5vcGFjaXR5O1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGRyYXdDZWxsQmFzZSgpO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgZmFkZWluTWdyID0ge1xuICAgICAgICAgICAgYW5pbWF0ZTogZnVuY3Rpb24gYW5pbWF0ZShncmlkLCBjb2wsIHJvdywgY29udGV4dCwgZHJhd0ludGVybmFsLCBkcmF3Q2VsbEJhc2UpIHtcbiAgICAgICAgICAgICAgLy8gZmFkZWluIGFuaW1hdGlvblxuICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBnZXRGYWRlaW5TdGF0ZShncmlkKTtcbiAgICAgICAgICAgICAgdmFyIGFjdGl2ZUZhZGVpbnMgPSBbX2dlbmVyYXRlRmFkZWluUG9pbnRBY3Rpb24oZ3JpZCwgY29sLCByb3csIGNvbnRleHQsIGRyYXdJbnRlcm5hbCwgZHJhd0NlbGxCYXNlKV07XG4gICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZUZhZGVpbnMgPSBhY3RpdmVGYWRlaW5zO1xuICAgICAgICAgICAgICAoMCwgYW5pbWF0ZV8xLmFuaW1hdGUpKDUwMCwgZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlRmFkZWlucy5mb3JFYWNoKGZ1bmN0aW9uIChmKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZihwb2ludCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocG9pbnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5hY3RpdmVGYWRlaW5zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWFyZ2VBbmltYXRlOiBmdW5jdGlvbiBtYXJnZUFuaW1hdGUoZ3JpZCwgY29sLCByb3csIGNvbnRleHQsIGRyYXdJbnRlcm5hbCwgZHJhd0NlbGxCYXNlKSB7XG4gICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdldEZhZGVpblN0YXRlKGdyaWQpO1xuXG4gICAgICAgICAgICAgIGlmIChzdGF0ZS5hY3RpdmVGYWRlaW5zKSB7XG4gICAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlRmFkZWlucy5wdXNoKF9nZW5lcmF0ZUZhZGVpblBvaW50QWN0aW9uKGdyaWQsIGNvbCwgcm93LCBjb250ZXh0LCBkcmF3SW50ZXJuYWwsIGRyYXdDZWxsQmFzZSkpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRyYXdJbnRlcm5hbCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHZhciBCYXNlQ29sdW1uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIEJhc2VDb2x1bW4ob3B0aW9uKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlQ29sdW1uKTtcblxuICAgICAgICAgICAgICB0aGlzLm9uRHJhd0NlbGwgPSB0aGlzLm9uRHJhd0NlbGwuYmluZCh0aGlzKTsgLy/jgrnjgrPjg7zjg5fjgpLlm7rlrprjgZXjgZvjgotcbiAgICAgICAgICAgICAgLy9Qcm9taXNl44GuY2FsbGJhY2vjgafjg5Xjgqfjg7zjg4njgqTjg7PooajnpLrjgZnjgotcblxuICAgICAgICAgICAgICB0aGlzLl9mYWRlaW5XaGVuQ2FsbGJhY2tJblByb21pc2UgPSBvcHRpb24gPT09IG51bGwgfHwgb3B0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb24uZmFkZWluV2hlbkNhbGxiYWNrSW5Qcm9taXNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQmFzZUNvbHVtbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImZhZGVpbldoZW5DYWxsYmFja0luUHJvbWlzZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmFkZWluV2hlbkNhbGxiYWNrSW5Qcm9taXNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJTdHlsZUNsYXNzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBCYXNlU3R5bGVfMS5CYXNlU3R5bGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uRHJhd0NlbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uRHJhd0NlbGwoY2VsbFZhbHVlLCBpbmZvLCBjb250ZXh0LCBncmlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzNTMgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0eWxlID0gaW5mby5zdHlsZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0UmVjb3JkID0gaW5mby5nZXRSZWNvcmQsXG4gICAgICAgICAgICAgICAgICAgIGRyYXdDZWxsQmFzZSA9IGluZm8uZHJhd0NlbGxCYXNlO1xuICAgICAgICAgICAgICAgIHZhciBoZWxwZXIgPSBncmlkLmdldEdyaWRDYW52YXNIZWxwZXIoKTtcbiAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2UoKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gZ2V0UmVjb3JkKCk7XG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2U7XG5cbiAgICAgICAgICAgICAgICBpZiAoKDAsIHV0aWxzXzEuaXNQcm9taXNlKShyZWNvcmQpKSB7XG4gICAgICAgICAgICAgICAgICBwcm9taXNlID0gcmVjb3JkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDAsIHV0aWxzXzEuaXNQcm9taXNlKShjZWxsVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICBwcm9taXNlID0gY2VsbFZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB2YXIgbXNnID0gaW5mby5nZXRNZXNzYWdlKCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKG1zZykpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZSA9IG1zZztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IC8v5paH5a2X5o+P55S7XG5cblxuICAgICAgICAgICAgICAgIGlmIChwcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtyZWNvcmQsIGNlbGxWYWx1ZSwgcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbGxWYWx1ZTtcbiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5mby5nZXRNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgICB9KV0pLnRoZW4oZnVuY3Rpb24gKF9yZWYyNykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gX3JlZjI3WzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsID0gX3JlZjI3WzFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IF9yZWYyN1syXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRDb250ZXh0ID0gY29udGV4dC50b0N1cnJlbnRDb250ZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkcmF3UmVjdCA9IGN1cnJlbnRDb250ZXh0LmdldERyYXdSZWN0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkcmF3UmVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciB0aW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkcmF3SW50ZXJuYWwgPSBmdW5jdGlvbiBkcmF3SW50ZXJuYWwoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRDb250ZXh0ID0gY29udGV4dC50b0N1cnJlbnRDb250ZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIGRyYXdSZWN0ID0gY3VycmVudENvbnRleHQuZ2V0RHJhd1JlY3QoKTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmICghZHJhd1JlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0U3R5bGUgPSBzdHlsZUNvbnRlbnRzLm9mKHN0eWxlLCByZWNvcmQsIF90aGlzNTMuU3R5bGVDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUzLmRyYXdJbnRlcm5hbChfdGhpczUzLmNvbnZlcnRJbnRlcm5hbCh2YWwpLCBjdXJyZW50Q29udGV4dCwgYWN0U3R5bGUsIGhlbHBlciwgZ3JpZCwgaW5mbyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUzLmRyYXdNZXNzYWdlSW50ZXJuYWwobWVzc2FnZSwgY3VycmVudENvbnRleHQsIGFjdFN0eWxlLCBoZWxwZXIsIGdyaWQsIGluZm8pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgX3RoaXM1My5kcmF3SW5kaWNhdG9yc0ludGVybmFsKGN1cnJlbnRDb250ZXh0LCBhY3RTdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRmFkZWluV2hlbkNhbGxiYWNrSW5Qcm9taXNlKF90aGlzNTMsIGdyaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZHJhd0ludGVybmFsKCk7IC8v5Y2Y57SU44Gq5o+P55S7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbnRleHQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcblxuICAgICAgICAgICAgICAgICAgICAgIGlmICh0aW1lIDwgODApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vODBtc+S7peWGheOBrlByb21pc2VDYWxsYmFja+OBr+WJjeOCouODi+ODoeODvOOCt+ODp+ODs+OBq+e1seWQiFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFkZWluTWdyLm1hcmdlQW5pbWF0ZShncmlkLCBjb2wsIHJvdywgY29udGV4dCwgZHJhd0ludGVybmFsLCBkcmF3Q2VsbEJhc2UpO1xuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+OCouODi+ODoeODvOOCt+ODp+ODs1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFkZWluTWdyLmFuaW1hdGUoZ3JpZCwgY29sLCByb3csIGNvbnRleHQsIGRyYXdJbnRlcm5hbCwgZHJhd0NlbGxCYXNlKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB2YXIgYWN0U3R5bGUgPSBzdHlsZUNvbnRlbnRzLm9mKHN0eWxlLCByZWNvcmQsIHRoaXMuU3R5bGVDbGFzcyk7XG4gICAgICAgICAgICAgICAgICB0aGlzLmRyYXdJbnRlcm5hbCh0aGlzLmNvbnZlcnRJbnRlcm5hbChjZWxsVmFsdWUpLCBjb250ZXh0LCBhY3RTdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKTtcbiAgICAgICAgICAgICAgICAgIHRoaXMuZHJhd01lc3NhZ2VJbnRlcm5hbChpbmZvLmdldE1lc3NhZ2UoKSwgY29udGV4dCwgYWN0U3R5bGUsIGhlbHBlciwgZ3JpZCwgaW5mbyk7XG4gICAgICAgICAgICAgICAgICB0aGlzLmRyYXdJbmRpY2F0b3JzSW50ZXJuYWwoY29udGV4dCwgYWN0U3R5bGUsIGhlbHBlciwgZ3JpZCwgaW5mbyk7IC8v44OV44Kn44O844OJ44Kk44Oz44Gu5aC05ZCI6YCP6YGO44GZ44KL44Gf44KB6IOM5pmv44KS6YCP6YGO44Gn5LiK5pu444GNXG5cbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcbiAgICAgICAgICAgICAgICAgIHZhciBzdGF0ZUtleSA9IFwiXCIuY29uY2F0KGNvbCwgXCI6XCIpLmNvbmNhdChyb3cpO1xuICAgICAgICAgICAgICAgICAgdmFyIGNlbGxTdGF0ZSA9IChfYSA9IGdyaWRbQ09MVU1OX0ZBREVJTl9TVEFURV9JRF0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jZWxsc1tzdGF0ZUtleV07XG5cbiAgICAgICAgICAgICAgICAgIGlmIChjZWxsU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNvbnRleHQuZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxIC0gY2VsbFN0YXRlLm9wYWNpdHk7XG5cbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb252ZXJ0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnZlcnRJbnRlcm5hbCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsID8gdmFsdWUgOiBcIlwiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3TWVzc2FnZUludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3TWVzc2FnZUludGVybmFsKG1lc3NhZ2UsIGNvbnRleHQsIHN0eWxlLCBoZWxwZXIsIGdyaWQsIGluZm8pIHtcbiAgICAgICAgICAgICAgICBpbmZvLm1lc3NhZ2VIYW5kbGVyLmRyYXdDZWxsTWVzc2FnZShtZXNzYWdlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd0luZGljYXRvcnNJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0luZGljYXRvcnNJbnRlcm5hbChjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclRvcExlZnQgPSBzdHlsZS5pbmRpY2F0b3JUb3BMZWZ0LFxuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JUb3BSaWdodCA9IHN0eWxlLmluZGljYXRvclRvcFJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JCb3R0b21SaWdodCA9IHN0eWxlLmluZGljYXRvckJvdHRvbVJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JCb3R0b21MZWZ0ID0gc3R5bGUuaW5kaWNhdG9yQm90dG9tTGVmdDtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pMiA9IDAsIF9hcnIgPSBbW2luZGljYXRvclRvcExlZnQsIDBcbiAgICAgICAgICAgICAgICAvKiBEcmF3SW5kaWNhdG9yS2luZC50b3BMZWZ0ICovXG4gICAgICAgICAgICAgICAgXSwgW2luZGljYXRvclRvcFJpZ2h0LCAxXG4gICAgICAgICAgICAgICAgLyogRHJhd0luZGljYXRvcktpbmQudG9wUmlnaHQgKi9cbiAgICAgICAgICAgICAgICBdLCBbaW5kaWNhdG9yQm90dG9tUmlnaHQsIDJcbiAgICAgICAgICAgICAgICAvKiBEcmF3SW5kaWNhdG9yS2luZC5ib3R0b21SaWdodCAqL1xuICAgICAgICAgICAgICAgIF0sIFtpbmRpY2F0b3JCb3R0b21MZWZ0LCAzXG4gICAgICAgICAgICAgICAgLyogRHJhd0luZGljYXRvcktpbmQuYm90dG9tTGVmdCAqL1xuICAgICAgICAgICAgICAgIF1dOyBfaTIgPCBfYXJyLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfYXJyJF9pID0gX2FycltfaTJdLFxuICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvclN0eWxlID0gX2FyciRfaVswXSxcbiAgICAgICAgICAgICAgICAgICAgICBraW5kID0gX2FyciRfaVsxXTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvclN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIChfYSA9ICgwLCBoYW5kbGVyc18xLmdldERyYXdJbmRpY2F0b3IpKGluZGljYXRvclN0eWxlKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hKGNvbnRleHQsIGluZGljYXRvclN0eWxlLCBraW5kLCBoZWxwZXIsIGdyaWQsIGluZm8pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYmluZEdyaWRFdmVudFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZEdyaWRFdmVudChfZ3JpZCwgX2NlbGxJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q29weUNlbGxWYWx1ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29weUNlbGxWYWx1ZSh2YWx1ZSwgX2dyaWQsIF9jZWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCYXNlQ29sdW1uO1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuQmFzZUNvbHVtbiA9IEJhc2VDb2x1bW47XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy90eXBlL0JyYW5jaEdyYXBoQ29sdW1uLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvdHlwZS9CcmFuY2hHcmFwaENvbHVtbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zVHlwZUJyYW5jaEdyYXBoQ29sdW1uSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5CcmFuY2hHcmFwaENvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgQmFzZUNvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlQ29sdW1uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9CYXNlQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEJyYW5jaEdyYXBoU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3N0eWxlL0JyYW5jaEdyYXBoU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9CcmFuY2hHcmFwaFN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHN5bWJvbE1hbmFnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3N5bWJvbE1hbmFnZXIgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBfID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRCcmFuY2hHcmFwaENvbHVtblN0YXRlSWQpKCk7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRBbGxDb2x1bW5EYXRhKGdyaWQsIGZpZWxkLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBncmlkLmRhdGFTb3VyY2U7XG4gICAgICAgICAgICB2YXIgYWxsRGF0YSA9IFtdO1xuICAgICAgICAgICAgdmFyIHByb21pc2U7XG5cbiAgICAgICAgICAgIHZhciBfbG9vcDQgPSBmdW5jdGlvbiBfbG9vcDQoaW5kZXgpIHtcbiAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhU291cmNlLmdldEZpZWxkKGluZGV4LCBmaWVsZCk7XG5cbiAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YUluZGV4ID0gYWxsRGF0YS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgYWxsRGF0YS5wdXNoKHVuZGVmaW5lZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgIHByb21pc2UgPSBkYXRhLnRoZW4oZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxsRGF0YVtkYXRhSW5kZXhdID0gZDtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsbERhdGFbZGF0YUluZGV4XSA9IGQ7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWxsRGF0YS5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgZGF0YVNvdXJjZS5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgX2xvb3A0KGluZGV4KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHByb21pc2UpIHtcbiAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soYWxsRGF0YSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2soYWxsRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIEJyYW5jaExpbmUgPSBmdW5jdGlvbiBCcmFuY2hMaW5lKF9yZWYyOCkge1xuICAgICAgICAgICAgdmFyIGZyb21JbmRleCA9IF9yZWYyOC5mcm9tSW5kZXgsXG4gICAgICAgICAgICAgICAgdG9JbmRleCA9IF9yZWYyOC50b0luZGV4LFxuICAgICAgICAgICAgICAgIGNvbG9ySW5kZXggPSBfcmVmMjguY29sb3JJbmRleCxcbiAgICAgICAgICAgICAgICBwb2ludCA9IF9yZWYyOC5wb2ludDtcblxuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJyYW5jaExpbmUpO1xuXG4gICAgICAgICAgICB0aGlzLmZyb21JbmRleCA9IGZyb21JbmRleDtcbiAgICAgICAgICAgIHRoaXMudG9JbmRleCA9IHRvSW5kZXg7XG4gICAgICAgICAgICB0aGlzLmNvbG9ySW5kZXggPSBjb2xvckluZGV4O1xuICAgICAgICAgICAgdGhpcy5wb2ludCA9IHBvaW50O1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgQnJhbmNoUG9pbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gQnJhbmNoUG9pbnQoX3JlZjI5KSB7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IF9yZWYyOS5pbmRleCxcbiAgICAgICAgICAgICAgICAgIF9yZWYyOSRjb21taXQgPSBfcmVmMjkuY29tbWl0LFxuICAgICAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZjI5JGNvbW1pdCA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMjkkY29tbWl0LFxuICAgICAgICAgICAgICAgICAgX3JlZjI5JGxpbmVzID0gX3JlZjI5LmxpbmVzLFxuICAgICAgICAgICAgICAgICAgbGluZXMgPSBfcmVmMjkkbGluZXMgPT09IHZvaWQgMCA/IFtdIDogX3JlZjI5JGxpbmVzLFxuICAgICAgICAgICAgICAgICAgdGFnID0gX3JlZjI5LnRhZztcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQnJhbmNoUG9pbnQpO1xuXG4gICAgICAgICAgICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgdGhpcy5jb21taXQgPSBjb21taXQ7XG4gICAgICAgICAgICAgIHRoaXMubGluZXMgPSBsaW5lcztcbiAgICAgICAgICAgICAgdGhpcy50YWcgPSB0YWc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhCcmFuY2hQb2ludCwgbnVsbCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIm1lcmdlTGluZXNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1lcmdlTGluZXMobGluZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gbGluZXMuZmlsdGVyKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbC5mcm9tSW5kZXggIT0gbnVsbCAmJiBsLnRvSW5kZXggIT0gbnVsbDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbUxpc3QgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBsLmZyb21JbmRleCAhPSBudWxsICYmIGwudG9JbmRleCA9PSBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciB0b0xpc3QgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBsLmZyb21JbmRleCA9PSBudWxsICYmIGwudG9JbmRleCAhPSBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZyb21MaXN0LmZvckVhY2goZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9MaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ID0gdG9MaXN0W2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnBvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZi5jb2xvckluZGV4ID09PSB0LmNvbG9ySW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICBmLnRvSW5kZXggPSB0LnRvSW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgdG9MaXN0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChmKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmNvbmNhdCh0b0xpc3QpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJtZXJnZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWVyZ2UoYSwgYikge1xuICAgICAgICAgICAgICAgIGlmICghYSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCcmFuY2hQb2ludCh7XG4gICAgICAgICAgICAgICAgICBpbmRleDogYS5pbmRleCxcbiAgICAgICAgICAgICAgICAgIGNvbW1pdDogYS5jb21taXQgfHwgYi5jb21taXQsXG4gICAgICAgICAgICAgICAgICBsaW5lczogQnJhbmNoUG9pbnQubWVyZ2VMaW5lcyhhLmxpbmVzLmNvbmNhdChiLmxpbmVzKSksXG4gICAgICAgICAgICAgICAgICB0YWc6IGEudGFnIHx8IGIudGFnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEJyYW5jaFBvaW50O1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGpvaW5MaW5lKHRpbWVsaW5lLCBicmFuY2hJbmRleCkge1xuICAgICAgICAgICAgdmFyIHJldmVyc2UgPSBfdG9Db25zdW1hYmxlQXJyYXkodGltZWxpbmUpLnJldmVyc2UoKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXZlcnNlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBmID0gcmV2ZXJzZVtpXVticmFuY2hJbmRleF07XG5cbiAgICAgICAgICAgICAgaWYgKGYpIHtcbiAgICAgICAgICAgICAgICBmLmxpbmVzID0gQnJhbmNoUG9pbnQubWVyZ2VMaW5lcyhmLmxpbmVzLmNvbmNhdChbbmV3IEJyYW5jaExpbmUoe1xuICAgICAgICAgICAgICAgICAgdG9JbmRleDogYnJhbmNoSW5kZXgsXG4gICAgICAgICAgICAgICAgICBjb2xvckluZGV4OiBicmFuY2hJbmRleFxuICAgICAgICAgICAgICAgIH0pXSkpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgIHZhciB0bCA9IHJldmVyc2Vbal07XG4gICAgICAgICAgICAgICAgICB0bFticmFuY2hJbmRleF0gPSBuZXcgQnJhbmNoUG9pbnQoe1xuICAgICAgICAgICAgICAgICAgICBpbmRleDogYnJhbmNoSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVzOiBbbmV3IEJyYW5jaExpbmUoe1xuICAgICAgICAgICAgICAgICAgICAgIGZyb21JbmRleDogYnJhbmNoSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgdG9JbmRleDogYnJhbmNoSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgY29sb3JJbmRleDogYnJhbmNoSW5kZXhcbiAgICAgICAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gYnJhbmNoKF9yZWYzMCwgZnJvbSwgdG8pIHtcbiAgICAgICAgICAgIHZhciB0aW1lbGluZSA9IF9yZWYzMC50aW1lbGluZSxcbiAgICAgICAgICAgICAgICBicmFuY2hlcyA9IF9yZWYzMC5icmFuY2hlcztcbiAgICAgICAgICAgIHZhciBmcm9tSW5kZXggPSBmcm9tICE9IG51bGwgPyBicmFuY2hlcy5pbmRleE9mKGZyb20pIDogLTE7XG4gICAgICAgICAgICB2YXIgdG9JbmRleCA9IGJyYW5jaGVzLmluZGV4T2YodG8pO1xuXG4gICAgICAgICAgICBpZiAodG9JbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgdG9JbmRleCA9IGJyYW5jaGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgYnJhbmNoZXMucHVzaCh0byk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbmRCcmFuY2hSb290SW5kZXgoKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gdGltZWxpbmUubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgaW5kZXgtLSkge1xuICAgICAgICAgICAgICAgIHZhciB0bCA9IHRpbWVsaW5lW2luZGV4XTtcbiAgICAgICAgICAgICAgICB2YXIgX2Zyb20gPSB0bFtmcm9tSW5kZXhdO1xuXG4gICAgICAgICAgICAgICAgaWYgKF9mcm9tICYmIF9mcm9tLmNvbW1pdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCcmFuY2hQb2ludCh7XG4gICAgICAgICAgICAgICAgaW5kZXg6IHRvSW5kZXhcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgZnJvbVRhcmdldEluZGV4ID0gZmluZEJyYW5jaFJvb3RJbmRleCgpO1xuXG4gICAgICAgICAgICAgIGlmIChmcm9tVGFyZ2V0SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgYnJhbmNoVGFyZ2V0RnJvbUluZGV4ID0gZnJvbVRhcmdldEluZGV4ICsgMTtcbiAgICAgICAgICAgICAgdmFyIGJyYW5jaFBvaW50ID0gbmV3IEJyYW5jaFBvaW50KHtcbiAgICAgICAgICAgICAgICBpbmRleDogdG9JbmRleCxcbiAgICAgICAgICAgICAgICBsaW5lczogW25ldyBCcmFuY2hMaW5lKHtcbiAgICAgICAgICAgICAgICAgIGZyb21JbmRleDogZnJvbUluZGV4LFxuICAgICAgICAgICAgICAgICAgY29sb3JJbmRleDogdG9JbmRleFxuICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdmFyIHBvaW50O1xuICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcblxuICAgICAgICAgICAgICBpZiAoYnJhbmNoVGFyZ2V0RnJvbUluZGV4IDwgdGltZWxpbmUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldExpbmUgPSB0aW1lbGluZVticmFuY2hUYXJnZXRGcm9tSW5kZXhdO1xuICAgICAgICAgICAgICAgIHBvaW50ID0gdGFyZ2V0TGluZVt0b0luZGV4XSA9IEJyYW5jaFBvaW50Lm1lcmdlKHRhcmdldExpbmVbdG9JbmRleF0sIGJyYW5jaFBvaW50KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwb2ludCA9IGJyYW5jaFBvaW50O1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGJyYW5jaFBvaW50O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIF9mcm9tMiA9IHRpbWVsaW5lW2Zyb21UYXJnZXRJbmRleF1bZnJvbUluZGV4XTtcbiAgICAgICAgICAgICAgX2Zyb20yLmxpbmVzID0gQnJhbmNoUG9pbnQubWVyZ2VMaW5lcyhfZnJvbTIubGluZXMuY29uY2F0KFtuZXcgQnJhbmNoTGluZSh7XG4gICAgICAgICAgICAgICAgdG9JbmRleDogdG9JbmRleCxcbiAgICAgICAgICAgICAgICBjb2xvckluZGV4OiB0b0luZGV4LFxuICAgICAgICAgICAgICAgIHBvaW50OiBwb2ludFxuICAgICAgICAgICAgICB9KV0pKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBjb21taXQoX3JlZjMxLCBuYW1lKSB7XG4gICAgICAgICAgICB2YXIgdGltZWxpbmUgPSBfcmVmMzEudGltZWxpbmUsXG4gICAgICAgICAgICAgICAgYnJhbmNoZXMgPSBfcmVmMzEuYnJhbmNoZXM7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBicmFuY2hlcy5pbmRleE9mKG5hbWUpO1xuXG4gICAgICAgICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEJyYW5jaFBvaW50KHtcbiAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICBjb21taXQ6IHRydWVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoam9pbkxpbmUodGltZWxpbmUsIGluZGV4KSkge1xuICAgICAgICAgICAgICByZXN1bHQubGluZXMgPSBCcmFuY2hQb2ludC5tZXJnZUxpbmVzKHJlc3VsdC5saW5lcy5jb25jYXQoW25ldyBCcmFuY2hMaW5lKHtcbiAgICAgICAgICAgICAgICBmcm9tSW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICAgIGNvbG9ySW5kZXg6IGluZGV4XG4gICAgICAgICAgICAgIH0pXSkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNvbW1pdFRhZyhfcmVmMzIsIG5hbWUsIHRhZykge1xuICAgICAgICAgICAgdmFyIGJyYW5jaGVzID0gX3JlZjMyLmJyYW5jaGVzO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gYnJhbmNoZXMuaW5kZXhPZihuYW1lKTtcblxuICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgICBpbmRleCA9IGJyYW5jaGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgYnJhbmNoZXMucHVzaChuYW1lKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBCcmFuY2hQb2ludCh7XG4gICAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgICAgdGFnOiB0YWdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNvbW1pdE1lcmdlKF9yZWYzMywgZnJvbSwgdG8pIHtcbiAgICAgICAgICAgIHZhciB0aW1lbGluZSA9IF9yZWYzMy50aW1lbGluZSxcbiAgICAgICAgICAgICAgICBicmFuY2hlcyA9IF9yZWYzMy5icmFuY2hlcztcbiAgICAgICAgICAgIHZhciBmcm9tSW5kZXggPSBicmFuY2hlcy5pbmRleE9mKGZyb20pO1xuICAgICAgICAgICAgdmFyIHRvSW5kZXggPSBicmFuY2hlcy5pbmRleE9mKHRvKTtcblxuICAgICAgICAgICAgaWYgKHRvSW5kZXggPCAwIHx8IGZyb21JbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCcmFuY2hQb2ludCh7XG4gICAgICAgICAgICAgICAgaW5kZXg6IHRvSW5kZXgsXG4gICAgICAgICAgICAgICAgY29tbWl0OiB0cnVlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEJyYW5jaFBvaW50KHtcbiAgICAgICAgICAgICAgaW5kZXg6IHRvSW5kZXgsXG4gICAgICAgICAgICAgIGNvbW1pdDogdHJ1ZSxcbiAgICAgICAgICAgICAgbGluZXM6IFtuZXcgQnJhbmNoTGluZSh7XG4gICAgICAgICAgICAgICAgZnJvbUluZGV4OiBmcm9tSW5kZXgsXG4gICAgICAgICAgICAgICAgY29sb3JJbmRleDogZnJvbUluZGV4XG4gICAgICAgICAgICAgIH0pLCBuZXcgQnJhbmNoTGluZSh7XG4gICAgICAgICAgICAgICAgZnJvbUluZGV4OiB0b0luZGV4LFxuICAgICAgICAgICAgICAgIGNvbG9ySW5kZXg6IHRvSW5kZXhcbiAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmFyIGZyb21MaXN0ID0gX3RvQ29uc3VtYWJsZUFycmF5KHRpbWVsaW5lKTtcblxuICAgICAgICAgICAgdmFyIGZyb21UYXJnZXRMaW5lID0gZnJvbUxpc3QucG9wKCk7XG5cbiAgICAgICAgICAgIGlmIChmcm9tVGFyZ2V0TGluZSkge1xuICAgICAgICAgICAgICBmcm9tVGFyZ2V0TGluZVtmcm9tSW5kZXhdID0gQnJhbmNoUG9pbnQubWVyZ2UoZnJvbVRhcmdldExpbmVbZnJvbUluZGV4XSwgbmV3IEJyYW5jaFBvaW50KHtcbiAgICAgICAgICAgICAgICBpbmRleDogdG9JbmRleCxcbiAgICAgICAgICAgICAgICBsaW5lczogW25ldyBCcmFuY2hMaW5lKHtcbiAgICAgICAgICAgICAgICAgIHRvSW5kZXg6IHRvSW5kZXgsXG4gICAgICAgICAgICAgICAgICBjb2xvckluZGV4OiBmcm9tSW5kZXhcbiAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoam9pbkxpbmUoZnJvbUxpc3QsIGZyb21JbmRleCkgJiYgZnJvbVRhcmdldExpbmUpIHtcbiAgICAgICAgICAgICAgZnJvbVRhcmdldExpbmVbZnJvbUluZGV4XS5saW5lcyA9IEJyYW5jaFBvaW50Lm1lcmdlTGluZXMoZnJvbVRhcmdldExpbmVbZnJvbUluZGV4XS5saW5lcy5jb25jYXQoW25ldyBCcmFuY2hMaW5lKHtcbiAgICAgICAgICAgICAgICBmcm9tSW5kZXg6IGZyb21JbmRleCxcbiAgICAgICAgICAgICAgICBjb2xvckluZGV4OiBmcm9tSW5kZXhcbiAgICAgICAgICAgICAgfSldKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGpvaW5MaW5lKHRpbWVsaW5lLCB0b0luZGV4KTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY2FsY0NvbW1hbmQoaW5mbywgY29tbWFuZCkge1xuICAgICAgICAgICAgdmFyIHRpbWVsaW5lID0gaW5mby50aW1lbGluZTtcbiAgICAgICAgICAgIHZhciB0aW1lbGluZURhdGEgPSBbXTsgLy8gY29uc3QgbGFzdCA9IHRpbWVsaW5lLmxlbmd0aCA+IDAgPyB0aW1lbGluZVt0aW1lbGluZS5sZW5ndGggLSAxXSA6IG51bGw7XG5cbiAgICAgICAgICAgIHZhciBjb21tYW5kcyA9IEFycmF5LmlzQXJyYXkoY29tbWFuZCkgPyBjb21tYW5kIDogW2NvbW1hbmRdO1xuICAgICAgICAgICAgY29tbWFuZHMuZm9yRWFjaChmdW5jdGlvbiAoY21kKSB7XG4gICAgICAgICAgICAgIGlmICghY21kKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIHBvaW50O1xuXG4gICAgICAgICAgICAgIGlmIChjbWQuY29tbWFuZCA9PT0gXCJicmFuY2hcIikge1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gdXRpbHNfMS5vYmouaXNPYmplY3QoY21kLmJyYW5jaCkgPyBjbWQuYnJhbmNoLmZyb20gOiBudWxsO1xuICAgICAgICAgICAgICAgIHZhciB0byA9IHV0aWxzXzEub2JqLmlzT2JqZWN0KGNtZC5icmFuY2gpID8gY21kLmJyYW5jaC50byA6IGNtZC5icmFuY2g7XG4gICAgICAgICAgICAgICAgcG9pbnQgPSBicmFuY2goaW5mbywgZnJvbSwgdG8pO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNtZC5jb21tYW5kID09PSBcImNvbW1pdFwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9icmFuY2ggPSBjbWQuYnJhbmNoO1xuICAgICAgICAgICAgICAgIHBvaW50ID0gY29tbWl0KGluZm8sIF9icmFuY2gpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNtZC5jb21tYW5kID09PSBcIm1lcmdlXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NtZCRicmFuY2ggPSBjbWQuYnJhbmNoLFxuICAgICAgICAgICAgICAgICAgICBfZnJvbTMgPSBfY21kJGJyYW5jaC5mcm9tLFxuICAgICAgICAgICAgICAgICAgICBfdG8gPSBfY21kJGJyYW5jaC50bztcbiAgICAgICAgICAgICAgICBwb2ludCA9IGNvbW1pdE1lcmdlKGluZm8sIF9mcm9tMywgX3RvKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChjbWQuY29tbWFuZCA9PT0gXCJ0YWdcIikge1xuICAgICAgICAgICAgICAgIHZhciBfYnJhbmNoMiA9IGNtZC5icmFuY2gsXG4gICAgICAgICAgICAgICAgICAgIHRhZyA9IGNtZC50YWc7XG4gICAgICAgICAgICAgICAgcG9pbnQgPSBjb21taXRUYWcoaW5mbywgX2JyYW5jaDIsIHRhZyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAocG9pbnQgJiYgcG9pbnQuaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgIHRpbWVsaW5lRGF0YVtwb2ludC5pbmRleF0gPSBCcmFuY2hQb2ludC5tZXJnZSh0aW1lbGluZURhdGFbcG9pbnQuaW5kZXhdLCBwb2ludCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGltZWxpbmUucHVzaCh0aW1lbGluZURhdGEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNhbGNCcmFuY2hlc0luZm8oc3RhcnQsIGdyaWQsIGZpZWxkKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICBicmFuY2hlczogW10sXG4gICAgICAgICAgICAgIHRpbWVsaW5lOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdldEFsbENvbHVtbkRhdGEoZ3JpZCwgZmllbGQsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIGlmIChzdGFydCAhPT0gXCJ0b3BcIikge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBfdG9Db25zdW1hYmxlQXJyYXkoZGF0YSkucmV2ZXJzZSgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChjb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgY2FsY0NvbW1hbmQocmVzdWx0LCBjb21tYW5kKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY2FsY0JyYW5jaFhQb2ludHMoY3R4LCBsZWZ0LCB3aWR0aCwgcmFkaXVzLCBicmFuY2hlcywgdGltZWxpbmUpIHtcbiAgICAgICAgICAgIHZhciB3ID0gTWF0aC5tYXgod2lkdGggLyBicmFuY2hlcy5sZW5ndGggKyAxLCA1KTtcbiAgICAgICAgICAgIHRpbWVsaW5lLmZvckVhY2goZnVuY3Rpb24gKHRsKSB7XG4gICAgICAgICAgICAgIHRsLmZvckVhY2goZnVuY3Rpb24gKHAsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4IDw9IDApIHtcbiAgICAgICAgICAgICAgICAgIC8vIOioiOeul+OBruaEj+WRs+OBjOeEoeOBhFxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChwLnRhZykge1xuICAgICAgICAgICAgICAgICAgdmFyIHRleHRXaWR0aCA9IGN0eC5tZWFzdXJlVGV4dChwLnRhZykud2lkdGg7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh3ICogaW5kZXggKyByYWRpdXMgKiAyICsgNCArIHRleHRXaWR0aCA+IHdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHcgPSBNYXRoLm1heCgod2lkdGggLSByYWRpdXMgKiAyIC0gNCAtIHRleHRXaWR0aCkgLyBpbmRleCwgNSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICAgICAgdmFyIHggPSBsZWZ0O1xuICAgICAgICAgICAgYnJhbmNoZXMuZm9yRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJlc3VsdC5wdXNoKE1hdGguY2VpbCh4ICsgcmFkaXVzKSk7XG4gICAgICAgICAgICAgIHggKz0gdztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiByZW5kZXJNZXJnZShncmlkLCBjdHgsIHgsIHksIHVwTGluZUluZGV4LCBkb3duTGluZUluZGV4LCBjb2xvckluZGV4LCBfcmVmMzQsIF9yZWYzNSkge1xuICAgICAgICAgICAgdmFyIGJyYW5jaFhQb2ludHMgPSBfcmVmMzQuYnJhbmNoWFBvaW50cyxcbiAgICAgICAgICAgICAgICBicmFuY2hDb2xvcnMgPSBfcmVmMzQuYnJhbmNoQ29sb3JzLFxuICAgICAgICAgICAgICAgIGJyYW5jaExpbmVXaWR0aCA9IF9yZWYzNC5icmFuY2hMaW5lV2lkdGgsXG4gICAgICAgICAgICAgICAgbWVyZ2VTdHlsZSA9IF9yZWYzNC5tZXJnZVN0eWxlO1xuICAgICAgICAgICAgdmFyIGNvbCA9IF9yZWYzNS5jb2wsXG4gICAgICAgICAgICAgICAgcm93ID0gX3JlZjM1LnJvdyxcbiAgICAgICAgICAgICAgICBicmFuY2hlcyA9IF9yZWYzNS5icmFuY2hlcztcblxuICAgICAgICAgICAgaWYgKHVwTGluZUluZGV4ICE9IG51bGwgfHwgZG93bkxpbmVJbmRleCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICgwLCB1dGlsc18xLmdldE9yQXBwbHkpKGJyYW5jaENvbG9ycywgYnJhbmNoZXNbY29sb3JJbmRleF0sIGNvbG9ySW5kZXgpO1xuICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gYnJhbmNoTGluZVdpZHRoO1xuICAgICAgICAgICAgICBjdHgubGluZUNhcCA9IFwicm91bmRcIjtcbiAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuXG4gICAgICAgICAgICAgIGlmICh1cExpbmVJbmRleCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVwWCA9IGJyYW5jaFhQb2ludHNbdXBMaW5lSW5kZXhdO1xuICAgICAgICAgICAgICAgIHZhciB1cFJlY3QgPSBncmlkLmdldENlbGxSZWxhdGl2ZVJlY3QoY29sLCByb3cgLSAxKTtcbiAgICAgICAgICAgICAgICB2YXIgdXBZID0gdXBSZWN0LnRvcCArIHVwUmVjdC5oZWlnaHQgLyAyO1xuICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8odXBYLCB1cFkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1lcmdlU3R5bGUgPT09IFwiYmV6aWVyXCIpIHtcbiAgICAgICAgICAgICAgICAgIGN0eC5iZXppZXJDdXJ2ZVRvKHVwWCwgKHkgKyB1cFkpIC8gMiwgeCwgKHkgKyB1cFkpIC8gMiwgeCwgeSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8oeCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oeCwgeSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoZG93bkxpbmVJbmRleCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRvd25YID0gYnJhbmNoWFBvaW50c1tkb3duTGluZUluZGV4XTtcbiAgICAgICAgICAgICAgICB2YXIgZG93blJlY3QgPSBncmlkLmdldENlbGxSZWxhdGl2ZVJlY3QoY29sLCByb3cgKyAxKTtcbiAgICAgICAgICAgICAgICB2YXIgZG93blkgPSBkb3duUmVjdC50b3AgKyBkb3duUmVjdC5oZWlnaHQgLyAyO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1lcmdlU3R5bGUgPT09IFwiYmV6aWVyXCIpIHtcbiAgICAgICAgICAgICAgICAgIGN0eC5iZXppZXJDdXJ2ZVRvKHgsICh5ICsgZG93blkpIC8gMiwgZG93blgsICh5ICsgZG93blkpIC8gMiwgZG93blgsIGRvd25ZKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhkb3duWCwgZG93blkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQnJhbmNoR3JhcGhDb2x1bW5cbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIERhdGEgY29tbWFuZHNcbiAgICAgICAgICAgKiAtIG1hc3RlciBicmFuY2ggb3Igb3JwaGFuIGJyYW5jaFxuICAgICAgICAgICAqXG4gICAgICAgICAgICogYGBganNcbiAgICAgICAgICAgKiB7XG4gICAgICAgICAgICogXHRjb21tYW5kOiAnYnJhbmNoJyxcbiAgICAgICAgICAgKiBcdGJyYW5jaDogJ2JyYW5jaCBuYW1lIEEnLFxuICAgICAgICAgICAqIH1cbiAgICAgICAgICAgKiBgYGBcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIC0gY29tbWl0XG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBgYGBqc1xuICAgICAgICAgICAqIHtcbiAgICAgICAgICAgKiBcdGNvbW1hbmQ6ICdjb21taXQnLFxuICAgICAgICAgICAqIFx0YnJhbmNoOiAnYnJhbmNoIG5hbWUgQSdcbiAgICAgICAgICAgKiB9XG4gICAgICAgICAgICogYGBgXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiAtIGJyYW5jaFxuICAgICAgICAgICAqXG4gICAgICAgICAgICogYGBganNcbiAgICAgICAgICAgKiB7XG4gICAgICAgICAgICogXHRjb21tYW5kOiAnYnJhbmNoJyxcbiAgICAgICAgICAgKiBcdGJyYW5jaDoge1xuICAgICAgICAgICAqIFx0XHRmcm9tOiAnYnJhbmNoIG5hbWUgQScsXG4gICAgICAgICAgICogXHRcdHRvOiAnYnJhbmNoIG5hbWUgQidcbiAgICAgICAgICAgKiBcdH1cbiAgICAgICAgICAgKiB9XG4gICAgICAgICAgICogYGBgXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiAtIG1lcmdlXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBgYGBqc1xuICAgICAgICAgICAqIHtcbiAgICAgICAgICAgKiBcdGNvbW1hbmQ6ICdtZXJnZScsXG4gICAgICAgICAgICogXHRicmFuY2g6IHtcbiAgICAgICAgICAgKiBcdFx0ZnJvbTogJ2JyYW5jaCBuYW1lIEInLFxuICAgICAgICAgICAqIFx0XHR0bzogJ2JyYW5jaCBuYW1lIEEnXG4gICAgICAgICAgICogXHR9XG4gICAgICAgICAgICogfVxuICAgICAgICAgICAqIGBgYFxuICAgICAgICAgICAqXG4gICAgICAgICAgICogLSB0YWdcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIGBgYGpzXG4gICAgICAgICAgICoge1xuICAgICAgICAgICAqIFx0Y29tbWFuZDogJ3RhZycsXG4gICAgICAgICAgICogXHRicmFuY2g6ICdicmFuY2ggbmFtZSBBJyxcbiAgICAgICAgICAgKiBcdHRhZzogJ3RhZyBuYW1lJ1xuICAgICAgICAgICAqIH1cbiAgICAgICAgICAgKiBgYGBcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIEBtZW1iZXJvZiBjaGVldGFoR3JpZC5jb2x1bW5zLnR5cGVcbiAgICAgICAgICAgKi9cblxuXG4gICAgICAgICAgdmFyIEJyYW5jaEdyYXBoQ29sdW1uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZUNvbHVtbl8xJEJhc2VDb2wpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhCcmFuY2hHcmFwaENvbHVtbiwgX0Jhc2VDb2x1bW5fMSRCYXNlQ29sKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjM0ID0gX2NyZWF0ZVN1cGVyKEJyYW5jaEdyYXBoQ29sdW1uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gQnJhbmNoR3JhcGhDb2x1bW4oKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczU0O1xuXG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCcmFuY2hHcmFwaENvbHVtbik7XG5cbiAgICAgICAgICAgICAgX3RoaXM1NCA9IF9zdXBlcjM0LmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgICAgX3RoaXM1NC5fc3RhcnQgPSBvcHRpb24uc3RhcnQgfHwgXCJib3R0b21cIjtcbiAgICAgICAgICAgICAgX3RoaXM1NC5fY2FjaGUgPSBvcHRpb24uY2FjaGUgIT0gbnVsbCA/IG9wdGlvbi5jYWNoZSA6IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1NDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEJyYW5jaEdyYXBoQ29sdW1uLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiU3R5bGVDbGFzc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQnJhbmNoR3JhcGhTdHlsZV8xLkJyYW5jaEdyYXBoU3R5bGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsZWFyQ2FjaGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyQ2FjaGUoZ3JpZCkge1xuICAgICAgICAgICAgICAgIHZhciBpbnRlcm5hbCA9IGdyaWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGludGVybmFsW19dO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkRyYXdDZWxsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyYXdDZWxsKGNlbGxWYWx1ZSwgaW5mbywgY29udGV4dCwgZ3JpZCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jYWNoZSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JpZFtfXSB8fCAoZ3JpZFtfXSA9IG5ldyBNYXAoKSk7XG4gICAgICAgICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICAgICAgICB2YXIgZmllbGQgPSBncmlkLmdldEZpZWxkKGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCFzdGF0ZS5oYXMoZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnNldChmaWVsZCwgY2FsY0JyYW5jaGVzSW5mbyh0aGlzLl9zdGFydCwgZ3JpZCwgZmllbGQpKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoQnJhbmNoR3JhcGhDb2x1bW4ucHJvdG90eXBlKSwgXCJvbkRyYXdDZWxsXCIsIHRoaXMpLmNhbGwodGhpcywgY2VsbFZhbHVlLCBpbmZvLCBjb250ZXh0LCBncmlkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQnJhbmNoR3JhcGhDb2x1bW4odGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInN0YXJ0XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGFydDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FjaGVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbChfdmFsdWUsIGNvbnRleHQsIHN0eWxlLCBoZWxwZXIsIGdyaWQsIF9yZWYzNikge1xuICAgICAgICAgICAgICAgIHZhciBkcmF3Q2VsbEJhc2UgPSBfcmVmMzYuZHJhd0NlbGxCYXNlO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9hLCBfYjtcblxuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gZ3JpZC5nZXRGaWVsZChjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgX3JlZjM3ID0gKF9iID0gdGhpcy5fY2FjaGUgPyAoX2EgPSBncmlkW19dKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0KGZpZWxkKSA6IG51bGwpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IGNhbGNCcmFuY2hlc0luZm8odGhpcy5fc3RhcnQsIGdyaWQsIGZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgdGltZWxpbmUgPSBfcmVmMzcudGltZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaGVzID0gX3JlZjM3LmJyYW5jaGVzO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9yZWYzOCA9IHRoaXMuX3N0YXJ0ICE9PSBcInRvcFwiID8ge1xuICAgICAgICAgICAgICAgICAgdXBMaW5lSW5kZXhLZXk6IFwidG9JbmRleFwiLFxuICAgICAgICAgICAgICAgICAgZG93bkxpbmVJbmRleEtleTogXCJmcm9tSW5kZXhcIlxuICAgICAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgICB1cExpbmVJbmRleEtleTogXCJmcm9tSW5kZXhcIixcbiAgICAgICAgICAgICAgICAgIGRvd25MaW5lSW5kZXhLZXk6IFwidG9JbmRleFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXBMaW5lSW5kZXhLZXkgPSBfcmVmMzgudXBMaW5lSW5kZXhLZXksXG4gICAgICAgICAgICAgICAgICAgIGRvd25MaW5lSW5kZXhLZXkgPSBfcmVmMzguZG93bkxpbmVJbmRleEtleTtcblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5fc3RhcnQgIT09IFwidG9wXCIgPyB0aW1lbGluZVt0aW1lbGluZS5sZW5ndGggLSAocm93IC0gZ3JpZC5mcm96ZW5Sb3dDb3VudCkgLSAxXSA6IHRpbWVsaW5lW3JvdyAtIGdyaWQuZnJvemVuUm93Q291bnRdO1xuICAgICAgICAgICAgICAgIHZhciBicmFuY2hDb2xvcnMgPSBzdHlsZS5icmFuY2hDb2xvcnMsXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaExpbmVXaWR0aCA9IHN0eWxlLmJyYW5jaExpbmVXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgY2lyY2xlU2l6ZSA9IHN0eWxlLmNpcmNsZVNpemUsXG4gICAgICAgICAgICAgICAgICAgIG1lcmdlU3R5bGUgPSBzdHlsZS5tZXJnZVN0eWxlLFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW4gPSBzdHlsZS5tYXJnaW4sXG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBzdHlsZS5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ID0gc3R5bGUudmlzaWJpbGl0eTtcblxuICAgICAgICAgICAgICAgIGlmIChiZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2Uoe1xuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gXCJoaWRkZW5cIikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZWN0ID0gY29udGV4dC5nZXRSZWN0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IGNpcmNsZVNpemUgLyAyO1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHJlY3Qud2lkdGggLSBtYXJnaW4gKiAyO1xuICAgICAgICAgICAgICAgIGhlbHBlci5kcmF3V2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9IFwibGVmdFwiO1xuICAgICAgICAgICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9IFwibWlkZGxlXCI7XG4gICAgICAgICAgICAgICAgICB2YXIgYnJhbmNoWFBvaW50cyA9IGNhbGNCcmFuY2hYUG9pbnRzKGN0eCwgcmVjdC5sZWZ0ICsgbWFyZ2luLCB3aWR0aCwgcmFkaXVzLCBicmFuY2hlcywgdGltZWxpbmUpO1xuICAgICAgICAgICAgICAgICAgdmFyIHkgPSByZWN0LnRvcCArIHJlY3QuaGVpZ2h0IC8gMjsgLy8gZHJhdyBqb2luIGxpbmVzXG5cbiAgICAgICAgICAgICAgICAgIGRhdGEubWFwKGZ1bmN0aW9uIChwb2ludCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvaW50ID8gcG9pbnQubGluZXMubWFwKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9ySW5kZXg6IGxpbmUuY29sb3JJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwTGluZUluZGV4OiBsaW5lW3VwTGluZUluZGV4S2V5XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25MaW5lSW5kZXg6IGxpbmVbZG93bkxpbmVJbmRleEtleV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludEluZGV4OiBpbmRleFxuICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pIDogW107XG4gICAgICAgICAgICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKHAsIGMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHAuY29uY2F0KGMpO1xuICAgICAgICAgICAgICAgICAgfSwgW10pIC8vIGZsYXRNYXBcbiAgICAgICAgICAgICAgICAgIC8vIG9yZGVyIG9mIG92ZXJsYXBcbiAgICAgICAgICAgICAgICAgIC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiLmNvbG9ySW5kZXggLSBhLmNvbG9ySW5kZXg7XG4gICAgICAgICAgICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gYnJhbmNoWFBvaW50c1tsaW5lLnBvaW50SW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJNZXJnZShncmlkLCBjdHgsIHgsIHksIGxpbmUudXBMaW5lSW5kZXgsIGxpbmUuZG93bkxpbmVJbmRleCwgbGluZS5jb2xvckluZGV4LCB7XG4gICAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiBtYXJnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgYnJhbmNoWFBvaW50czogYnJhbmNoWFBvaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICBicmFuY2hMaW5lV2lkdGg6IGJyYW5jaExpbmVXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICBicmFuY2hDb2xvcnM6IGJyYW5jaENvbG9ycyxcbiAgICAgICAgICAgICAgICAgICAgICBtZXJnZVN0eWxlOiBtZXJnZVN0eWxlXG4gICAgICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93OiByb3csXG4gICAgICAgICAgICAgICAgICAgICAgYnJhbmNoZXM6IGJyYW5jaGVzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSk7IC8vIGRyYXcgY29tbWl0IHBvaW50c1xuXG4gICAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKHAsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwICYmIHAuY29tbWl0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBicmFuY2hYUG9pbnRzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gKDAsIHV0aWxzXzEuZ2V0T3JBcHBseSkoYnJhbmNoQ29sb3JzLCBicmFuY2hlc1tpbmRleF0sIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyh4LCB5LCByYWRpdXMsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7IC8vIGRyYXcgdGFnc1xuXG4gICAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKHAsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwICYmIHAudGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICgwLCB1dGlsc18xLmdldE9yQXBwbHkpKGJyYW5jaENvbG9ycywgYnJhbmNoZXNbaW5kZXhdLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KHAudGFnLCBicmFuY2hYUG9pbnRzW2luZGV4XSArIHJhZGl1cyArIDQsIHkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gQnJhbmNoR3JhcGhDb2x1bW47XG4gICAgICAgICAgfShCYXNlQ29sdW1uXzEuQmFzZUNvbHVtbik7XG5cbiAgICAgICAgICBleHBvcnRzLkJyYW5jaEdyYXBoQ29sdW1uID0gQnJhbmNoR3JhcGhDb2x1bW47XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy90eXBlL0J1dHRvbkNvbHVtbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy90eXBlL0J1dHRvbkNvbHVtbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1R5cGVCdXR0b25Db2x1bW5Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkJ1dHRvbkNvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlscyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2NvbHVtblV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9jb2x1bW5VdGlscy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgQnV0dG9uU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3N0eWxlL0J1dHRvblN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvQnV0dG9uU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0NvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgQlVUVE9OX0NPTFVNTl9TVEFURV9JRCA9ICgwLCBzeW1ib2xNYW5hZ2VyXzEuZ2V0QnV0dG9uQ29sdW1uU3RhdGVJZCkoKTtcblxuICAgICAgICAgIHZhciBCdXR0b25Db2x1bW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db2x1bW5fMSRDb2x1bW4pIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhCdXR0b25Db2x1bW4sIF9Db2x1bW5fMSRDb2x1bW4pO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyMzUgPSBfY3JlYXRlU3VwZXIoQnV0dG9uQ29sdW1uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gQnV0dG9uQ29sdW1uKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM1NTtcblxuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQnV0dG9uQ29sdW1uKTtcblxuICAgICAgICAgICAgICBfdGhpczU1ID0gX3N1cGVyMzUuY2FsbCh0aGlzLCBvcHRpb24pO1xuICAgICAgICAgICAgICBfdGhpczU1Ll9jYXB0aW9uID0gb3B0aW9uLmNhcHRpb247XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczU1O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQnV0dG9uQ29sdW1uLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiU3R5bGVDbGFzc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQnV0dG9uU3R5bGVfMS5CdXR0b25TdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FwdGlvblwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FwdGlvbjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwid2l0aENhcHRpb25cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpdGhDYXB0aW9uKGNhcHRpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICBjLl9jYXB0aW9uID0gY2FwdGlvbjtcbiAgICAgICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQnV0dG9uQ29sdW1uKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb252ZXJ0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnZlcnRJbnRlcm5hbCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYXB0aW9uIHx8IF9nZXQoX2dldFByb3RvdHlwZU9mKEJ1dHRvbkNvbHVtbi5wcm90b3R5cGUpLCBcImNvbnZlcnRJbnRlcm5hbFwiLCB0aGlzKS5jYWxsKHRoaXMsIHZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q29weUNlbGxWYWx1ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29weUNlbGxWYWx1ZSh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYXB0aW9uIHx8IHZhbHVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgX3JlZjM5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXdDZWxsQmFzZSA9IF9yZWYzOS5kcmF3Q2VsbEJhc2UsXG4gICAgICAgICAgICAgICAgICAgIGdldEljb24gPSBfcmVmMzkuZ2V0SWNvbjtcbiAgICAgICAgICAgICAgICB2YXIgdGV4dEFsaWduID0gc3R5bGUudGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBzdHlsZS50ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBzdHlsZS5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHN0eWxlLmNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBidXR0b25CZ0NvbG9yID0gc3R5bGUuYnV0dG9uQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgZm9udCA9IHN0eWxlLmZvbnQsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBzdHlsZS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3cgPSBzdHlsZS50ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHkgPSBzdHlsZS52aXNpYmlsaXR5O1xuXG4gICAgICAgICAgICAgICAgaWYgKGJnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgIGRyYXdDZWxsQmFzZSh7XG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IGJnQ29sb3JcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh2aXNpYmlsaXR5ID09PSBcImhpZGRlblwiKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRleHRWYWx1ZSA9IHZhbHVlICE9IG51bGwgPyBTdHJpbmcodmFsdWUpIDogXCJcIjtcbiAgICAgICAgICAgICAgICBoZWxwZXIudGVzdEZvbnRMb2FkKGZvbnQsIHRleHRWYWx1ZSwgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbnRleHQuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBncmlkLmdldENlbGxSYW5nZShjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyaWRbQlVUVE9OX0NPTFVNTl9TVEFURV9JRF07XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5tb3VzZUFjdGl2ZUNlbGwgJiYgKDAsIHV0aWxzXzEuY2VsbEluUmFuZ2UpKHJhbmdlLCBzdGF0ZS5tb3VzZUFjdGl2ZUNlbGwuY29sLCBzdGF0ZS5tb3VzZUFjdGl2ZUNlbGwucm93KSkge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jb250ZXh0JGdldFNlbGVjdGlvbjQgPSBjb250ZXh0LmdldFNlbGVjdGlvbigpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ID0gX2NvbnRleHQkZ2V0U2VsZWN0aW9uNC5zZWxlY3Q7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmNlbGxJblJhbmdlKShyYW5nZSwgc2VsZWN0LmNvbCwgc2VsZWN0LnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdXRpbHMubG9hZEljb25zKGdldEljb24oKSwgY29udGV4dCwgaGVscGVyLCBmdW5jdGlvbiAoaWNvbnMsIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgIGhlbHBlci5idXR0b24odGV4dFZhbHVlLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogdGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmU6IHRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogYnV0dG9uQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBmb250OiBmb250LFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBzaGFkb3c6IGFjdGl2ZSA/IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDAuNDgpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgYmx1cjogNixcbiAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRZOiAzXG4gICAgICAgICAgICAgICAgICAgIH0gOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zOiBpY29uc1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEJ1dHRvbkNvbHVtbjtcbiAgICAgICAgICB9KENvbHVtbl8xLkNvbHVtbik7XG5cbiAgICAgICAgICBleHBvcnRzLkJ1dHRvbkNvbHVtbiA9IEJ1dHRvbkNvbHVtbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvQ2hlY2tDb2x1bW4uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy90eXBlL0NoZWNrQ29sdW1uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNUeXBlQ2hlY2tDb2x1bW5Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkNoZWNrQ29sdW1uID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEJhc2VDb2x1bW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vQmFzZUNvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvQmFzZUNvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIHZhciBDaGVja1N0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9zdHlsZS9DaGVja1N0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvQ2hlY2tTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3V0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdXRpbHMvaW5kZXguanNcIik7XG5cbiAgICAgICAgICB2YXIgQ0hFQ0tfQ09MVU1OX1NUQVRFX0lEID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRDaGVja0NvbHVtblN0YXRlSWQpKCk7XG5cbiAgICAgICAgICB2YXIgQ2hlY2tDb2x1bW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlQ29sdW1uXzEkQmFzZUNvbDIpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhDaGVja0NvbHVtbiwgX0Jhc2VDb2x1bW5fMSRCYXNlQ29sMik7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXIzNiA9IF9jcmVhdGVTdXBlcihDaGVja0NvbHVtbik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIENoZWNrQ29sdW1uKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2hlY2tDb2x1bW4pO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXIzNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQ2hlY2tDb2x1bW4sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJTdHlsZUNsYXNzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDaGVja1N0eWxlXzEuQ2hlY2tTdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hlY2tDb2x1bW4odGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbnZlcnRJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29udmVydEludGVybmFsKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgwLCB1dGlsc18xLnRvQm9vbGVhbikodmFsdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgX3JlZjQwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXdDZWxsQmFzZSA9IF9yZWY0MC5kcmF3Q2VsbEJhc2U7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGV4dEFsaWduID0gc3R5bGUudGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBzdHlsZS50ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBzdHlsZS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvciA9IHN0eWxlLmJvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBjaGVja0JnQ29sb3IgPSBzdHlsZS5jaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yID0gc3R5bGUudW5jaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBzdHlsZS5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ID0gc3R5bGUudmlzaWJpbGl0eTtcblxuICAgICAgICAgICAgICAgIGlmIChiZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2Uoe1xuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gXCJoaWRkZW5cIikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpO1xuICAgICAgICAgICAgICAgIHZhciBjZWxsS2V5ID0gXCJcIi5jb25jYXQocmFuZ2Uuc3RhcnQuY29sLCBcIjpcIikuY29uY2F0KHJhbmdlLnN0YXJ0LnJvdyk7XG4gICAgICAgICAgICAgICAgdmFyIGVsYXBzZWQgPSAoX2EgPSBncmlkW0NIRUNLX0NPTFVNTl9TVEFURV9JRF0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5lbGFwc2VkW2NlbGxLZXldO1xuICAgICAgICAgICAgICAgIHZhciBvcHQgPSB7XG4gICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZTogdGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IGJvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yOiBjaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvcjogdW5jaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgICBwYWRkaW5nOiBwYWRkaW5nXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmIChlbGFwc2VkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIG9wdC5hbmltRWxhcHNlZFRpbWUgPSBlbGFwc2VkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGhlbHBlci5jaGVja2JveCh2YWx1ZSwgY29udGV4dCwgb3B0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gQ2hlY2tDb2x1bW47XG4gICAgICAgICAgfShCYXNlQ29sdW1uXzEuQmFzZUNvbHVtbik7XG5cbiAgICAgICAgICBleHBvcnRzLkNoZWNrQ29sdW1uID0gQ2hlY2tDb2x1bW47XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy90eXBlL0NvbHVtbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy90eXBlL0NvbHVtbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1R5cGVDb2x1bW5Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkNvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlscyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2NvbHVtblV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9jb2x1bW5VdGlscy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgQmFzZUNvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlQ29sdW1uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9CYXNlQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9zdHlsZS9TdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL1N0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIENvbHVtbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VDb2x1bW5fMSRCYXNlQ29sMykge1xuICAgICAgICAgICAgX2luaGVyaXRzKENvbHVtbiwgX0Jhc2VDb2x1bW5fMSRCYXNlQ29sMyk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXIzNyA9IF9jcmVhdGVTdXBlcihDb2x1bW4pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBDb2x1bW4oKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb2x1bW4pO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXIzNy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQ29sdW1uLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiU3R5bGVDbGFzc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gU3R5bGVfMS5TdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sdW1uKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgX2dyaWQsIF9yZWY0MSkge1xuICAgICAgICAgICAgICAgIHZhciBkcmF3Q2VsbEJhc2UgPSBfcmVmNDEuZHJhd0NlbGxCYXNlLFxuICAgICAgICAgICAgICAgICAgICBnZXRJY29uID0gX3JlZjQxLmdldEljb247XG4gICAgICAgICAgICAgICAgdmFyIHRleHRBbGlnbiA9IHN0eWxlLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lID0gc3R5bGUudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHN0eWxlLmNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBmb250ID0gc3R5bGUuZm9udCxcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvciA9IHN0eWxlLmJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBzdHlsZS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3cgPSBzdHlsZS50ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHkgPSBzdHlsZS52aXNpYmlsaXR5O1xuXG4gICAgICAgICAgICAgICAgaWYgKGJnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgIGRyYXdDZWxsQmFzZSh7XG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IGJnQ29sb3JcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh2aXNpYmlsaXR5ID09PSBcImhpZGRlblwiKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRleHRWYWx1ZSA9IHZhbHVlICE9IG51bGwgPyBTdHJpbmcodmFsdWUpIDogXCJcIjtcbiAgICAgICAgICAgICAgICBoZWxwZXIudGVzdEZvbnRMb2FkKGZvbnQsIHRleHRWYWx1ZSwgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgdXRpbHMubG9hZEljb25zKGdldEljb24oKSwgY29udGV4dCwgaGVscGVyLCBmdW5jdGlvbiAoaWNvbnMsIGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgIGhlbHBlci50ZXh0KHRleHRWYWx1ZSwgY29udGV4dCwge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgZm9udDogZm9udCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogcGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zOiBpY29uc1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIENvbHVtbjtcbiAgICAgICAgICB9KEJhc2VDb2x1bW5fMS5CYXNlQ29sdW1uKTtcblxuICAgICAgICAgIGV4cG9ydHMuQ29sdW1uID0gQ29sdW1uO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9JY29uQ29sdW1uLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy90eXBlL0ljb25Db2x1bW4uanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zVHlwZUljb25Db2x1bW5Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkljb25Db2x1bW4gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgaWNvbnMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvaWNvbnMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvaWNvbnMuanNcIikpO1xuXG4gICAgICAgICAgdmFyIENvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9Db2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0NvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIHZhciBJY29uU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3N0eWxlL0ljb25TdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL0ljb25TdHlsZS5qc1wiKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIHJlcGVhdEFycmF5KHZhbCwgY291bnQpIHtcbiAgICAgICAgICAgIGlmIChjb3VudCA9PT0gSW5maW5pdHkpIHtcbiAgICAgICAgICAgICAgY291bnQgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYSA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgYS5wdXNoKHZhbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBJY29uQ29sdW1uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29sdW1uXzEkQ29sdW1uMikge1xuICAgICAgICAgICAgX2luaGVyaXRzKEljb25Db2x1bW4sIF9Db2x1bW5fMSRDb2x1bW4yKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjM4ID0gX2NyZWF0ZVN1cGVyKEljb25Db2x1bW4pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBJY29uQ29sdW1uKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM1NjtcblxuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSWNvbkNvbHVtbik7XG5cbiAgICAgICAgICAgICAgX3RoaXM1NiA9IF9zdXBlcjM4LmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgICAgX3RoaXM1Ni5fdGFnTmFtZSA9IG9wdGlvbi50YWdOYW1lIHx8IFwiaVwiO1xuICAgICAgICAgICAgICBfdGhpczU2Ll9jbGFzc05hbWUgPSBvcHRpb24uY2xhc3NOYW1lO1xuICAgICAgICAgICAgICBfdGhpczU2Ll9jb250ZW50ID0gb3B0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgIF90aGlzNTYuX25hbWUgPSBvcHRpb24ubmFtZTtcbiAgICAgICAgICAgICAgX3RoaXM1Ni5faWNvbldpZHRoID0gb3B0aW9uLmljb25XaWR0aDtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNTY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJY29uQ29sdW1uLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiU3R5bGVDbGFzc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSWNvblN0eWxlXzEuSWNvblN0eWxlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJY29uQ29sdW1uKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ0YWdOYW1lXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90YWdOYW1lO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbGFzc05hbWVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NsYXNzTmFtZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY29udGVudFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibmFtZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaWNvbldpZHRoXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pY29uV2lkdGg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0ludGVybmFsKHZhbHVlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKSB7XG4gICAgICAgICAgICAgICAgdmFyIG51bSA9IE51bWJlcih2YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBpY29uID0ge307XG4gICAgICAgICAgICAgICAgICBpY29ucy5pY29uUHJvcEtleXMuZm9yRWFjaChmdW5jdGlvbiAoaykge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgICAgICBpY29uW2tdID0gc3R5bGVba107XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIGljb24uY2xhc3NOYW1lID0gdGhpcy5fY2xhc3NOYW1lO1xuICAgICAgICAgICAgICAgICAgaWNvbi50YWdOYW1lID0gdGhpcy5fdGFnTmFtZTtcblxuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWNvbi5jb250ZW50ID0gdGhpcy5fY29udGVudDtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWNvbi5uYW1lID0gdGhpcy5fbmFtZTtcblxuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2ljb25XaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICBpY29uLndpZHRoID0gdGhpcy5faWNvbldpZHRoO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpbmZvLmdldEljb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXBlYXRBcnJheShpY29uLCBudW0pO1xuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaW5mby5nZXRJY29uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoSWNvbkNvbHVtbi5wcm90b3R5cGUpLCBcImRyYXdJbnRlcm5hbFwiLCB0aGlzKS5jYWxsKHRoaXMsIFwiXCIsIGNvbnRleHQsIHN0eWxlLCBoZWxwZXIsIGdyaWQsIGluZm8pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJY29uQ29sdW1uO1xuICAgICAgICAgIH0oQ29sdW1uXzEuQ29sdW1uKTtcblxuICAgICAgICAgIGV4cG9ydHMuSWNvbkNvbHVtbiA9IEljb25Db2x1bW47XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy90eXBlL0ltYWdlQ29sdW1uLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvdHlwZS9JbWFnZUNvbHVtbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb2x1bW5zVHlwZUltYWdlQ29sdW1uSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5JbWFnZUNvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VDb2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0Jhc2VDb2x1bW4uanNcIik7XG5cbiAgICAgICAgICB2YXIgSW1hZ2VTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vc3R5bGUvSW1hZ2VTdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL0ltYWdlU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgUmVjdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvUmVjdCAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9SZWN0LmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGNhbnZhc2VzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9jYW52YXNlcyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9jYW52YXNlcy5qc1wiKTtcblxuICAgICAgICAgIHZhciBpbWdzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9pbWdzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL2ltZ3MuanNcIik7XG5cbiAgICAgICAgICB2YXIgTUFYX0xSVV9DQUNIRV9TSVpFID0gNTA7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRJbWFnZSh1cmwpIHtcbiAgICAgICAgICAgIHJldHVybiAoMCwgaW1nc18xLmdldENhY2hlT3JMb2FkKShcIkltYWdlQ29sdW1uXCIsIE1BWF9MUlVfQ0FDSEVfU0laRSwgdXJsKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBjYWxjS2VlcEFzcGVjdFJhdGlvU2l6ZSh3aWR0aCwgaGVpZ2h0LCBtYXhXaWR0aCwgbWF4SGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgbmV3V2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIHZhciBuZXdIZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgICAgIGlmIChuZXdXaWR0aCA+IG1heFdpZHRoKSB7XG4gICAgICAgICAgICAgIG5ld1dpZHRoID0gbWF4V2lkdGg7XG4gICAgICAgICAgICAgIG5ld0hlaWdodCA9IG5ld1dpZHRoICogaGVpZ2h0IC8gd2lkdGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuZXdIZWlnaHQgPiBtYXhIZWlnaHQpIHtcbiAgICAgICAgICAgICAgbmV3SGVpZ2h0ID0gbWF4SGVpZ2h0O1xuICAgICAgICAgICAgICBuZXdXaWR0aCA9IG5ld0hlaWdodCAqIHdpZHRoIC8gaGVpZ2h0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB3aWR0aDogbmV3V2lkdGgsXG4gICAgICAgICAgICAgIGhlaWdodDogbmV3SGVpZ2h0XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBJbWFnZUNvbHVtbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VDb2x1bW5fMSRCYXNlQ29sNCkge1xuICAgICAgICAgICAgX2luaGVyaXRzKEltYWdlQ29sdW1uLCBfQmFzZUNvbHVtbl8xJEJhc2VDb2w0KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjM5ID0gX2NyZWF0ZVN1cGVyKEltYWdlQ29sdW1uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gSW1hZ2VDb2x1bW4oKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbWFnZUNvbHVtbik7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjM5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbWFnZUNvbHVtbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIlN0eWxlQ2xhc3NcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEltYWdlU3R5bGVfMS5JbWFnZVN0eWxlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkRyYXdDZWxsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyYXdDZWxsKGNlbGxWYWx1ZSwgaW5mbywgY29udGV4dCwgZ3JpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0KF9nZXRQcm90b3R5cGVPZihJbWFnZUNvbHVtbi5wcm90b3R5cGUpLCBcIm9uRHJhd0NlbGxcIiwgdGhpcykuY2FsbCh0aGlzLCBnZXRJbWFnZShjZWxsVmFsdWUpLCBpbmZvLCBjb250ZXh0LCBncmlkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW1hZ2VDb2x1bW4odGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0ludGVybmFsKHZhbHVlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBfZ3JpZCwgX3JlZjQyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXdDZWxsQmFzZSA9IF9yZWY0Mi5kcmF3Q2VsbEJhc2U7XG4gICAgICAgICAgICAgICAgdmFyIHRleHRBbGlnbiA9IHN0eWxlLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lID0gc3R5bGUudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nID0gc3R5bGUucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luID0gc3R5bGUubWFyZ2luLFxuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yID0gc3R5bGUuYmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eSA9IHN0eWxlLnZpc2liaWxpdHk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmdDb2xvcikge1xuICAgICAgICAgICAgICAgICAgZHJhd0NlbGxCYXNlKHtcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogYmdDb2xvclxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHZpc2liaWxpdHkgPT09IFwiaGlkZGVuXCIpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIGhlbHBlci5kcmF3V2l0aENsaXAoY29udGV4dCwgZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gdGV4dEFsaWduO1xuICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gdGV4dEJhc2VsaW5lO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGNvbnRleHQuZ2V0UmVjdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWRkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHBhZGRpbmdOdW1zID0gaGVscGVyLnRvQm94UGl4ZWxBcnJheShwYWRkaW5nLCBjb250ZXh0LCB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAvKiBmb250ICovXG4gICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgbGVmdCA9IHJlY3QubGVmdCArIHBhZGRpbmdOdW1zWzNdO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSByZWN0LnRvcCArIHBhZGRpbmdOdW1zWzBdO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHJlY3Qud2lkdGggLSBwYWRkaW5nTnVtc1sxXSAtIHBhZGRpbmdOdW1zWzNdO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSByZWN0LmhlaWdodCAtIHBhZGRpbmdOdW1zWzBdIC0gcGFkZGluZ051bXNbMl07XG4gICAgICAgICAgICAgICAgICAgICAgcmVjdCA9IG5ldyBSZWN0XzEuUmVjdChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0eWxlLmltYWdlU2l6aW5nID09PSBcImtlZXAtYXNwZWN0LXJhdGlvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGNLZWVwQXNwZWN0UmF0aW9TID0gY2FsY0tlZXBBc3BlY3RSYXRpb1NpemUodmFsdWUud2lkdGgsIHZhbHVlLmhlaWdodCwgcmVjdC53aWR0aCAtIG1hcmdpbiAqIDIsIHJlY3QuaGVpZ2h0IC0gbWFyZ2luICogMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIF93aWR0aCA9IF9jYWxjS2VlcEFzcGVjdFJhdGlvUy53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgX2hlaWdodCA9IF9jYWxjS2VlcEFzcGVjdFJhdGlvUy5oZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gKDAsIGNhbnZhc2VzXzEuY2FsY1N0YXJ0UG9zaXRpb24pKGN0eCwgcmVjdCwgX3dpZHRoLCBfaGVpZ2h0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG1hcmdpblxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UodmFsdWUsIDAsIDAsIHZhbHVlLndpZHRoLCB2YWx1ZS5oZWlnaHQsIHBvcy54LCBwb3MueSwgX3dpZHRoLCBfaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHZhbHVlLCAwLCAwLCB2YWx1ZS53aWR0aCwgdmFsdWUuaGVpZ2h0LCByZWN0LmxlZnQgKyBtYXJnaW4sIHJlY3QudG9wICsgbWFyZ2luLCByZWN0LndpZHRoIC0gbWFyZ2luICogMiwgcmVjdC5oZWlnaHQgLSBtYXJnaW4gKiAyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbWFnZUNvbHVtbjtcbiAgICAgICAgICB9KEJhc2VDb2x1bW5fMS5CYXNlQ29sdW1uKTtcblxuICAgICAgICAgIGV4cG9ydHMuSW1hZ2VDb2x1bW4gPSBJbWFnZUNvbHVtbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvTWVudUNvbHVtbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvdHlwZS9NZW51Q29sdW1uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1R5cGVNZW51Q29sdW1uSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICB2YXIgX19jcmVhdGVCaW5kaW5nID0gdGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZyB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcblxuICAgICAgICAgICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgICAgICAgICAgZGVzYyA9IHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ba107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICBvW2syXSA9IG1ba107XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gdGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHtcbiAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgdmFsdWU6IHZcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgb1tcImRlZmF1bHRcIl0gPSB2O1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9faW1wb3J0U3RhciA9IHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICAgICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIHtcbiAgICAgICAgICAgICAgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5NZW51Q29sdW1uID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHV0aWxzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vY29sdW1uVXRpbHMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL2NvbHVtblV0aWxzLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBCYXNlQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VDb2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0Jhc2VDb2x1bW4uanNcIik7XG5cbiAgICAgICAgICB2YXIgTWVudVN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9zdHlsZS9NZW51U3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9NZW51U3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgbWVudV9pdGVtc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvbWVudS1pdGVtcyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9tZW51LWl0ZW1zLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIE1lbnVDb2x1bW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlQ29sdW1uXzEkQmFzZUNvbDUpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhNZW51Q29sdW1uLCBfQmFzZUNvbHVtbl8xJEJhc2VDb2w1KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjQwID0gX2NyZWF0ZVN1cGVyKE1lbnVDb2x1bW4pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBNZW51Q29sdW1uKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM1NztcblxuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVudUNvbHVtbik7XG5cbiAgICAgICAgICAgICAgX3RoaXM1NyA9IF9zdXBlcjQwLmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgICAgX3RoaXM1Ny5fb3B0aW9ucyA9ICgwLCBtZW51X2l0ZW1zXzEubm9ybWFsaXplKShvcHRpb24ub3B0aW9ucyk7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczU3O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoTWVudUNvbHVtbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIlN0eWxlQ2xhc3NcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1lbnVTdHlsZV8xLk1lbnVTdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWVudUNvbHVtbih0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwid2l0aE9wdGlvbnNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpdGhPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICBjLl9vcHRpb25zID0gKDAsIG1lbnVfaXRlbXNfMS5ub3JtYWxpemUpKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgX2dyaWQsIF9yZWY0Mykge1xuICAgICAgICAgICAgICAgIHZhciBkcmF3Q2VsbEJhc2UgPSBfcmVmNDMuZHJhd0NlbGxCYXNlLFxuICAgICAgICAgICAgICAgICAgICBnZXRJY29uID0gX3JlZjQzLmdldEljb247XG4gICAgICAgICAgICAgICAgdmFyIHRleHRBbGlnbiA9IHN0eWxlLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lID0gc3R5bGUudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICBmb250ID0gc3R5bGUuZm9udCxcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvciA9IHN0eWxlLmJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBzdHlsZS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3cgPSBzdHlsZS50ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGFwcGVhcmFuY2UgPSBzdHlsZS5hcHBlYXJhbmNlLFxuICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ID0gc3R5bGUudmlzaWJpbGl0eTtcbiAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSBzdHlsZS5jb2xvcjtcblxuICAgICAgICAgICAgICAgIGlmIChiZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2Uoe1xuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gXCJoaWRkZW5cIikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjb252ZXJ0ZWRWYWx1ZSA9IHRoaXMuX2NvbnZlcnRJbnRlcm5hbCh2YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IGNvbnZlcnRlZFZhbHVlICE9IG51bGwgPyBTdHJpbmcoY29udmVydGVkVmFsdWUpIDogXCJcIjtcbiAgICAgICAgICAgICAgICBoZWxwZXIudGVzdEZvbnRMb2FkKGZvbnQsIHRleHQsIGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIHV0aWxzLmxvYWRJY29ucyhnZXRJY29uKCksIGNvbnRleHQsIGhlbHBlciwgZnVuY3Rpb24gKGljb25zLCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICB2YXIgYmFzZVBhZGRpbmcgPSBoZWxwZXIudG9Cb3hQaXhlbEFycmF5KHBhZGRpbmcgfHwgMCwgY29udGV4dCwgZm9udCk7XG4gICAgICAgICAgICAgICAgICB2YXIgdGV4dFBhZGRpbmcgPSBiYXNlUGFkZGluZy5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICAgIHRleHRQYWRkaW5nWzFdICs9IDI2OyAvLyBpY29uIHBhZGRpbmdcblxuICAgICAgICAgICAgICAgICAgdmFyIGljb25QYWRkaW5nID0gYmFzZVBhZGRpbmcuc2xpY2UoMCk7XG4gICAgICAgICAgICAgICAgICBpY29uUGFkZGluZ1sxXSArPSA4O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoY29sb3IgPT0gbnVsbCAmJiAodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gXCJcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBcInJnYmEoMCwgMCwgMCwgLjM4KVwiO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBoZWxwZXIudGV4dCh0ZXh0LCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogdGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmU6IHRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBmb250OiBmb250LFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiB0ZXh0UGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zOiBpY29uc1xuICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChhcHBlYXJhbmNlID09PSBcIm1lbnVsaXN0LWJ1dHRvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRyYXcgZHJvcGRvd24gYXJyb3cgaWNvblxuICAgICAgICAgICAgICAgICAgICBoZWxwZXIudGV4dChcIlwiLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICAgICAgICAgICAgICAgICAgaWNvbnM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBcIk0wIDIgNSA3IDEwIDJ6XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCJyZ2JhKDAsIDAsIDAsIC41NClcIlxuICAgICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IGljb25QYWRkaW5nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhcHBlYXJhbmNlICE9PSBcIm5vbmVcIikge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3Jlc3RyaWN0LXRlbXBsYXRlLWV4cHJlc3Npb25zXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcInVuc3VwcG9ydGVkIGFwcGVhcmFuY2U6XCIuY29uY2F0KGFwcGVhcmFuY2UpKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY29udmVydEludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb252ZXJ0SW50ZXJuYWwodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9jb252ZXJ0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jb252ZXJ0SW50ZXJuYWwodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuX29wdGlvbnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9wdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zW2ldO1xuXG4gICAgICAgICAgICAgICAgICBpZiAob3B0aW9uLnZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9wdGlvbi5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKE1lbnVDb2x1bW4ucHJvdG90eXBlKSwgXCJjb252ZXJ0SW50ZXJuYWxcIiwgdGhpcykuY2FsbCh0aGlzLCB2YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENvcHlDZWxsVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvcHlDZWxsVmFsdWUodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydEludGVybmFsKHZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTWVudUNvbHVtbjtcbiAgICAgICAgICB9KEJhc2VDb2x1bW5fMS5CYXNlQ29sdW1uKTtcblxuICAgICAgICAgIGV4cG9ydHMuTWVudUNvbHVtbiA9IE1lbnVDb2x1bW47XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29sdW1ucy90eXBlL011bHRpbGluZVRleHRDb2x1bW4uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3R5cGUvTXVsdGlsaW5lVGV4dENvbHVtbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNUeXBlTXVsdGlsaW5lVGV4dENvbHVtbkpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTXVsdGlsaW5lVGV4dENvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlscyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2NvbHVtblV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9jb2x1bW5VdGlscy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgQmFzZUNvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlQ29sdW1uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9CYXNlQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIE11bHRpbGluZVRleHRTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vc3R5bGUvTXVsdGlsaW5lVGV4dFN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvTXVsdGlsaW5lVGV4dFN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIE11bHRpbGluZVRleHRDb2x1bW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlQ29sdW1uXzEkQmFzZUNvbDYpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhNdWx0aWxpbmVUZXh0Q29sdW1uLCBfQmFzZUNvbHVtbl8xJEJhc2VDb2w2KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjQxID0gX2NyZWF0ZVN1cGVyKE11bHRpbGluZVRleHRDb2x1bW4pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBNdWx0aWxpbmVUZXh0Q29sdW1uKCkge1xuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTXVsdGlsaW5lVGV4dENvbHVtbik7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjQxLmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKE11bHRpbGluZVRleHRDb2x1bW4sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJTdHlsZUNsYXNzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBNdWx0aWxpbmVUZXh0U3R5bGVfMS5NdWx0aWxpbmVUZXh0U3R5bGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE11bHRpbGluZVRleHRDb2x1bW4odGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0ludGVybmFsKHZhbHVlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBfZ3JpZCwgX3JlZjQ0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXdDZWxsQmFzZSA9IF9yZWY0NC5kcmF3Q2VsbEJhc2UsXG4gICAgICAgICAgICAgICAgICAgIGdldEljb24gPSBfcmVmNDQuZ2V0SWNvbjtcbiAgICAgICAgICAgICAgICB2YXIgdGV4dEFsaWduID0gc3R5bGUudGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBzdHlsZS50ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gc3R5bGUuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQgPSBzdHlsZS5mb250LFxuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yID0gc3R5bGUuYmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZyA9IHN0eWxlLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQgPSBzdHlsZS5saW5lSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBhdXRvV3JhcFRleHQgPSBzdHlsZS5hdXRvV3JhcFRleHQsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVDbGFtcCA9IHN0eWxlLmxpbmVDbGFtcCxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93ID0gc3R5bGUudGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ID0gc3R5bGUudmlzaWJpbGl0eTtcblxuICAgICAgICAgICAgICAgIGlmIChiZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2Uoe1xuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gXCJoaWRkZW5cIikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0ZXh0VmFsdWUgPSB2YWx1ZSAhPSBudWxsID8gU3RyaW5nKHZhbHVlKSA6IFwiXCI7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmVzID0gdGV4dFZhbHVlLnJlcGxhY2UoL1xccj9cXG4vZywgXCJcXG5cIikucmVwbGFjZSgvXFxyL2csIFwiXFxuXCIpLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgICAgICAgIGhlbHBlci50ZXN0Rm9udExvYWQoZm9udCwgdGV4dFZhbHVlLCBjb250ZXh0KTtcbiAgICAgICAgICAgICAgICB1dGlscy5sb2FkSWNvbnMoZ2V0SWNvbigpLCBjb250ZXh0LCBoZWxwZXIsIGZ1bmN0aW9uIChpY29ucywgY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgaGVscGVyLm11bHRpbGluZVRleHQobGluZXMsIGNvbnRleHQsIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiB0ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZTogdGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6IGxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIGF1dG9XcmFwVGV4dDogYXV0b1dyYXBUZXh0LFxuICAgICAgICAgICAgICAgICAgICBsaW5lQ2xhbXA6IGxpbmVDbGFtcCxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgIGljb25zOiBpY29uc1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIE11bHRpbGluZVRleHRDb2x1bW47XG4gICAgICAgICAgfShCYXNlQ29sdW1uXzEuQmFzZUNvbHVtbik7XG5cbiAgICAgICAgICBleHBvcnRzLk11bHRpbGluZVRleHRDb2x1bW4gPSBNdWx0aWxpbmVUZXh0Q29sdW1uO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9OdW1iZXJDb2x1bW4uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvdHlwZS9OdW1iZXJDb2x1bW4uanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNUeXBlTnVtYmVyQ29sdW1uSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5OdW1iZXJDb2x1bW4gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0NvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvQ29sdW1uLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIE51bWJlclN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9zdHlsZS9OdW1iZXJTdHlsZSAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3N0eWxlL051bWJlclN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRGb3JtYXQ7XG5cbiAgICAgICAgICB2YXIgTnVtYmVyQ29sdW1uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29sdW1uXzEkQ29sdW1uMykge1xuICAgICAgICAgICAgX2luaGVyaXRzKE51bWJlckNvbHVtbiwgX0NvbHVtbl8xJENvbHVtbjMpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNDIgPSBfY3JlYXRlU3VwZXIoTnVtYmVyQ29sdW1uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gTnVtYmVyQ29sdW1uKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM1ODtcblxuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTnVtYmVyQ29sdW1uKTtcblxuICAgICAgICAgICAgICBfdGhpczU4ID0gX3N1cGVyNDIuY2FsbCh0aGlzLCBvcHRpb24pO1xuICAgICAgICAgICAgICBfdGhpczU4Ll9mb3JtYXQgPSBvcHRpb24uZm9ybWF0O1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1ODtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKE51bWJlckNvbHVtbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIlN0eWxlQ2xhc3NcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlclN0eWxlXzEuTnVtYmVyU3R5bGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE51bWJlckNvbHVtbih0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZm9ybWF0XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mb3JtYXQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIndpdGhGb3JtYXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpdGhGb3JtYXQoZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgYy5fZm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb252ZXJ0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnZlcnRJbnRlcm5hbCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBudW0gPSBOdW1iZXIodmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKG51bSkpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjb252ZXJ0ZWRWYWx1ZSA9IF9nZXQoX2dldFByb3RvdHlwZU9mKE51bWJlckNvbHVtbi5wcm90b3R5cGUpLCBcImNvbnZlcnRJbnRlcm5hbFwiLCB0aGlzKS5jYWxsKHRoaXMsIHZhbHVlKTtcblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnZlcnRlZFZhbHVlICE9IG51bGwgPyBTdHJpbmcoY29udmVydGVkVmFsdWUpIDogXCJcIjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZm9ybWF0ID0gdGhpcy5fZm9ybWF0IHx8IE51bWJlckNvbHVtbi5kZWZhdWx0Rm9ybWF0O1xuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXQuZm9ybWF0KG51bSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiZGVmYXVsdEZvcm1hdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdEZvcm1hdCB8fCAoZGVmYXVsdEZvcm1hdCA9IG5ldyBJbnRsLk51bWJlckZvcm1hdCgpKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZm10KSB7XG4gICAgICAgICAgICAgICAgZGVmYXVsdEZvcm1hdCA9IGZtdDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogQGRlcHJlY2F0ZWQgVXNlIGRlZmF1bHRGb3JtYXQgaW5zdGVhZFxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZGVmYXVsdEZvdG1hdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Rm9ybWF0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBAZGVwcmVjYXRlZCBVc2UgZGVmYXVsdEZvcm1hdCBpbnN0ZWFkXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGZtdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVmYXVsdEZvcm1hdCA9IGZtdDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTnVtYmVyQ29sdW1uO1xuICAgICAgICAgIH0oQ29sdW1uXzEuQ29sdW1uKTtcblxuICAgICAgICAgIGV4cG9ydHMuTnVtYmVyQ29sdW1uID0gTnVtYmVyQ29sdW1uO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9QZXJjZW50Q29tcGxldGVCYXJDb2x1bW4uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvdHlwZS9QZXJjZW50Q29tcGxldGVCYXJDb2x1bW4uanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNUeXBlUGVyY2VudENvbXBsZXRlQmFyQ29sdW1uSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5QZXJjZW50Q29tcGxldGVCYXJDb2x1bW4gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIENvbHVtbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9Db2x1bW4gKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL0NvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIHZhciBQZXJjZW50Q29tcGxldGVCYXJTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vc3R5bGUvUGVyY2VudENvbXBsZXRlQmFyU3R5bGUgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy9zdHlsZS9QZXJjZW50Q29tcGxldGVCYXJTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBNQVJHSU4gPSAyO1xuXG4gICAgICAgICAgdmFyIFBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbHVtbl8xJENvbHVtbjQpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhQZXJjZW50Q29tcGxldGVCYXJDb2x1bW4sIF9Db2x1bW5fMSRDb2x1bW40KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjQzID0gX2NyZWF0ZVN1cGVyKFBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIFBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbigpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNTk7XG5cbiAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbik7XG5cbiAgICAgICAgICAgICAgX3RoaXM1OSA9IF9zdXBlcjQzLmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgICAgX3RoaXM1OS5fbWluID0gb3B0aW9uLm1pbiB8fCAwO1xuICAgICAgICAgICAgICBfdGhpczU5Ll9tYXggPSBvcHRpb24ubWF4IHx8IF90aGlzNTkuX21pbiArIDEwMDtcblxuICAgICAgICAgICAgICBfdGhpczU5Ll9mb3JtYXR0ZXIgPSBvcHRpb24uZm9ybWF0dGVyIHx8IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHY7XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNTk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhQZXJjZW50Q29tcGxldGVCYXJDb2x1bW4sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJTdHlsZUNsYXNzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQZXJjZW50Q29tcGxldGVCYXJTdHlsZV8xLlBlcmNlbnRDb21wbGV0ZUJhclN0eWxlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQZXJjZW50Q29tcGxldGVCYXJDb2x1bW4odGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm1pblwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5taW47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm1heFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tYXg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZvcm1hdHRlclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXR0ZXI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0ludGVybmFsKHZhbHVlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBpbmZvKSB7XG4gICAgICAgICAgICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoUGVyY2VudENvbXBsZXRlQmFyQ29sdW1uLnByb3RvdHlwZSksIFwiZHJhd0ludGVybmFsXCIsIHRoaXMpLmNhbGwodGhpcywgdGhpcy5fZm9ybWF0dGVyKHZhbHVlKSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgaW5mbyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYmFyQ29sb3IgPSBzdHlsZS5iYXJDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgYmFyQmdDb2xvciA9IHN0eWxlLmJhckJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGJhckhlaWdodCA9IHN0eWxlLmJhckhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eSA9IHN0eWxlLnZpc2liaWxpdHk7XG5cbiAgICAgICAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gXCJoaWRkZW5cIikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0ZXh0VmFsdWUgPSB2YWx1ZSAhPSBudWxsID8gU3RyaW5nKHZhbHVlKSA6IFwiXCI7XG5cbiAgICAgICAgICAgICAgICBpZiAodXRpbHNfMS5zdHIuZW5kc1dpdGgodGV4dFZhbHVlLCBcIiVcIikpIHtcbiAgICAgICAgICAgICAgICAgIHRleHRWYWx1ZSA9IHRleHRWYWx1ZS5zbGljZSgwLCAtMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG51bSA9IE51bWJlcih0ZXh0VmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKG51bSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmF0ZSA9IG51bSA8IHRoaXMuX21pbiA/IDAgOiBudW0gPiB0aGlzLl9tYXggPyAxIDogKG51bSAtIHRoaXMuX21pbikgLyAodGhpcy5fbWF4IC0gdGhpcy5fbWluKTtcbiAgICAgICAgICAgICAgICBoZWxwZXIuZHJhd1dpdGhDbGlwKGNvbnRleHQsIGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciByZWN0ID0gY29udGV4dC5nZXRSZWN0KCk7XG4gICAgICAgICAgICAgICAgICB2YXIgYmFyTWF4V2lkdGggPSByZWN0LndpZHRoIC0gTUFSR0lOICogMiAtIDE7XG4gICAgICAgICAgICAgICAgICAvKue9q+e3miovXG5cbiAgICAgICAgICAgICAgICAgIHZhciBiYXJUb3AgPSByZWN0LmJvdHRvbSAtIE1BUkdJTiAtIGJhckhlaWdodCAtIDE7XG4gICAgICAgICAgICAgICAgICAvKue9q+e3miovXG5cbiAgICAgICAgICAgICAgICAgIHZhciBiYXJMZWZ0ID0gcmVjdC5sZWZ0ICsgTUFSR0lOO1xuICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICgwLCB1dGlsc18xLmdldE9yQXBwbHkpKGJhckJnQ29sb3IsIHJhdGUgKiAxMDApIHx8IFwiI2YwZjNmNVwiO1xuICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgY3R4LnJlY3QoYmFyTGVmdCwgYmFyVG9wLCBiYXJNYXhXaWR0aCwgYmFySGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgICB2YXIgYmFyU2l6ZSA9IE1hdGgubWluKGJhck1heFdpZHRoICogcmF0ZSwgYmFyTWF4V2lkdGgpO1xuICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICgwLCB1dGlsc18xLmdldE9yQXBwbHkpKGJhckNvbG9yLCByYXRlICogMTAwKSB8fCBcIiMyMGE4ZDhcIjtcbiAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICAgIGN0eC5yZWN0KGJhckxlZnQsIGJhclRvcCwgYmFyU2l6ZSwgYmFySGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbjtcbiAgICAgICAgICB9KENvbHVtbl8xLkNvbHVtbik7XG5cbiAgICAgICAgICBleHBvcnRzLlBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbiA9IFBlcmNlbnRDb21wbGV0ZUJhckNvbHVtbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvUmFkaW9Db2x1bW4uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vY29sdW1ucy90eXBlL1JhZGlvQ29sdW1uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNUeXBlUmFkaW9Db2x1bW5Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlJhZGlvQ29sdW1uID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEJhc2VDb2x1bW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vQmFzZUNvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvQmFzZUNvbHVtbi5qc1wiKTtcblxuICAgICAgICAgIHZhciBSYWRpb1N0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9zdHlsZS9SYWRpb1N0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvUmFkaW9TdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3V0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdXRpbHMvaW5kZXguanNcIik7XG5cbiAgICAgICAgICB2YXIgUkFESU9fQ09MVU1OX1NUQVRFX0lEID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRSYWRpb0NvbHVtblN0YXRlSWQpKCk7XG5cbiAgICAgICAgICB2YXIgUmFkaW9Db2x1bW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlQ29sdW1uXzEkQmFzZUNvbDcpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhSYWRpb0NvbHVtbiwgX0Jhc2VDb2x1bW5fMSRCYXNlQ29sNyk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI0NCA9IF9jcmVhdGVTdXBlcihSYWRpb0NvbHVtbik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIFJhZGlvQ29sdW1uKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmFkaW9Db2x1bW4pO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI0NC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoUmFkaW9Db2x1bW4sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJTdHlsZUNsYXNzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBSYWRpb1N0eWxlXzEuUmFkaW9TdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmFkaW9Db2x1bW4odGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbnZlcnRJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29udmVydEludGVybmFsKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgwLCB1dGlsc18xLnRvQm9vbGVhbikodmFsdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgX3JlZjQ1KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXdDZWxsQmFzZSA9IF9yZWY0NS5kcmF3Q2VsbEJhc2U7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGV4dEFsaWduID0gc3R5bGUudGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBzdHlsZS50ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBzdHlsZS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBjaGVja0NvbG9yID0gc3R5bGUuY2hlY2tDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdW5jaGVja0JvcmRlckNvbG9yID0gc3R5bGUudW5jaGVja0JvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBjaGVja0JvcmRlckNvbG9yID0gc3R5bGUuY2hlY2tCb3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdW5jaGVja0JnQ29sb3IgPSBzdHlsZS51bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yID0gc3R5bGUuY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yID0gc3R5bGUuYmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eSA9IHN0eWxlLnZpc2liaWxpdHk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmdDb2xvcikge1xuICAgICAgICAgICAgICAgICAgZHJhd0NlbGxCYXNlKHtcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogYmdDb2xvclxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHZpc2liaWxpdHkgPT09IFwiaGlkZGVuXCIpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IGNvbnRleHQucm93O1xuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGdyaWQuZ2V0Q2VsbFJhbmdlKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbEtleSA9IFwiXCIuY29uY2F0KHJhbmdlLnN0YXJ0LmNvbCwgXCI6XCIpLmNvbmNhdChyYW5nZS5zdGFydC5yb3cpO1xuICAgICAgICAgICAgICAgIHZhciBlbGFwc2VkID0gKF9hID0gZ3JpZFtSQURJT19DT0xVTU5fU1RBVEVfSURdKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZWxhcHNlZFtjZWxsS2V5XTtcbiAgICAgICAgICAgICAgICB2YXIgb3B0ID0ge1xuICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiB0ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmU6IHRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgIGNoZWNrQ29sb3I6IGNoZWNrQ29sb3IsXG4gICAgICAgICAgICAgICAgICB1bmNoZWNrQm9yZGVyQ29sb3I6IHVuY2hlY2tCb3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICAgIGNoZWNrQm9yZGVyQ29sb3I6IGNoZWNrQm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvcjogdW5jaGVja0JnQ29sb3IsXG4gICAgICAgICAgICAgICAgICBjaGVja0JnQ29sb3I6IGNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKGVsYXBzZWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgb3B0LmFuaW1FbGFwc2VkVGltZSA9IGVsYXBzZWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaGVscGVyLnJhZGlvQnV0dG9uKHZhbHVlLCBjb250ZXh0LCBvcHQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBSYWRpb0NvbHVtbjtcbiAgICAgICAgICB9KEJhc2VDb2x1bW5fMS5CYXNlQ29sdW1uKTtcblxuICAgICAgICAgIGV4cG9ydHMuUmFkaW9Db2x1bW4gPSBSYWRpb0NvbHVtbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvVHJlZUNvbHVtbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvdHlwZS9UcmVlQ29sdW1uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1R5cGVUcmVlQ29sdW1uSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICB2YXIgX19jcmVhdGVCaW5kaW5nID0gdGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZyB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcblxuICAgICAgICAgICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgICAgICAgICAgZGVzYyA9IHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ba107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICBvW2syXSA9IG1ba107XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gdGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHtcbiAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgdmFsdWU6IHZcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgb1tcImRlZmF1bHRcIl0gPSB2O1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9faW1wb3J0U3RhciA9IHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICAgICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIHtcbiAgICAgICAgICAgICAgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5nZXRUcmVlTm9kZUluZm9BdCA9IGV4cG9ydHMuVHJlZUNvbHVtbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBpbmxpbmVVdGlscyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9lbGVtZW50L2lubGluZXMgKi9cbiAgICAgICAgICBcIi4vZWxlbWVudC9pbmxpbmVzLmpzXCIpKTtcblxuICAgICAgICAgIHZhciB1dGlscyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9jb2x1bW5zL3R5cGUvY29sdW1uVXRpbHMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL2NvbHVtblV0aWxzLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBDb2x1bW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vQ29sdW1uICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9Db2x1bW4uanNcIik7XG5cbiAgICAgICAgICB2YXIgUmVjdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvUmVjdCAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9SZWN0LmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFRyZWVTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vc3R5bGUvVHJlZVN0eWxlICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvc3R5bGUvVHJlZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGNhbnZhc2VzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9jYW52YXNlcyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9jYW52YXNlcy5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIF8gPSAoMCwgc3ltYm9sTWFuYWdlcl8xLmdldFRyZWVDb2x1bW5TdGF0ZUlkKSgpO1xuXG4gICAgICAgICAgdmFyIFRyZWVDb2x1bW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db2x1bW5fMSRDb2x1bW41KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoVHJlZUNvbHVtbiwgX0NvbHVtbl8xJENvbHVtbjUpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNDUgPSBfY3JlYXRlU3VwZXIoVHJlZUNvbHVtbik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIFRyZWVDb2x1bW4oKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczYwO1xuXG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmVlQ29sdW1uKTtcblxuICAgICAgICAgICAgICBfdGhpczYwID0gX3N1cGVyNDUuY2FsbCh0aGlzLCBvcHRpb24pO1xuICAgICAgICAgICAgICBfdGhpczYwLl9jYWNoZSA9IG9wdGlvbi5jYWNoZSAhPSBudWxsID8gb3B0aW9uLmNhY2hlIDogZmFsc2U7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczYwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoVHJlZUNvbHVtbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIlN0eWxlQ2xhc3NcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRyZWVTdHlsZV8xLlRyZWVTdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xlYXJDYWNoZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXJDYWNoZShncmlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGludGVybmFsID0gZ3JpZDtcbiAgICAgICAgICAgICAgICBpZiAoIWludGVybmFsW19dKSByZXR1cm47XG4gICAgICAgICAgICAgICAgZGVsZXRlIGludGVybmFsW19dLmNhY2hlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3bkljb25BY3Rpb25BcmVhXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgICAgICAgIHZhciBpbnRlcm5hbCA9IHBhcmFtLmdyaWQ7XG4gICAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBpbnRlcm5hbFtfXTtcbiAgICAgICAgICAgICAgICAgIGlmICghKHN0YXRlID09PSBudWxsIHx8IHN0YXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdGF0ZS5kcmF3bkljb25zKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgdmFyIGRyYXduSWNvbnMgPSBzdGF0ZS5kcmF3bkljb25zO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRyYXduSWNvbnMuYXJlYShwYXJhbSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25EcmF3Q2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25EcmF3Q2VsbChjZWxsVmFsdWUsIGluZm8sIGNvbnRleHQsIGdyaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmlkW19dIHx8IChncmlkW19dID0ge30pO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NhY2hlICYmICFzdGF0ZS5jYWNoZSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlID0gc3RhdGUuY2FjaGUgfHwgKHN0YXRlLmNhY2hlID0gbmV3IE1hcCgpKTtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb250ZXh0LmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcbiAgICAgICAgICAgICAgICAgIHZhciBmaWVsZCA9IGdyaWQuZ2V0RmllbGQoY29sLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIWNhY2hlLmhhcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUuc2V0KGZpZWxkLCBuZXcgVHJlZUNvbHVtbkluZm8oZ3JpZCwgZmllbGQpKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoVHJlZUNvbHVtbi5wcm90b3R5cGUpLCBcIm9uRHJhd0NlbGxcIiwgdGhpcykuY2FsbCh0aGlzLCBjZWxsVmFsdWUsIGluZm8sIGNvbnRleHQsIGdyaWQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUcmVlQ29sdW1uKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjYWNoZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FjaGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENvcHlDZWxsVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvcHlDZWxsVmFsdWUodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJlZURhdGEgPSBnZXRUcmVlRGF0YUZyb21WYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyZWVEYXRhLmNhcHRpb247XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0ludGVybmFsKHZhbHVlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCBncmlkLCBfcmVmNDYpIHtcbiAgICAgICAgICAgICAgICB2YXIgZHJhd0NlbGxCYXNlID0gX3JlZjQ2LmRyYXdDZWxsQmFzZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0SWNvbiA9IF9yZWY0Ni5nZXRJY29uO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9hLCBfYjtcblxuICAgICAgICAgICAgICAgIHZhciB0ZXh0QWxpZ24gPSBzdHlsZS50ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZSA9IHN0eWxlLnRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvciA9IHN0eWxlLmJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBzdHlsZS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHN0eWxlLmNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBmb250ID0gc3R5bGUuZm9udCxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93ID0gc3R5bGUudGV4dE92ZXJmbG93O1xuXG4gICAgICAgICAgICAgICAgaWYgKGJnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgIGRyYXdDZWxsQmFzZSh7XG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IGJnQ29sb3JcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyaWRbX10gfHwgKGdyaWRbX10gPSB7fSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZHJhd25JY29ucykge1xuICAgICAgICAgICAgICAgICAgdmFyIGRyYXduSWNvbnMgPSBzdGF0ZS5kcmF3bkljb25zO1xuICAgICAgICAgICAgICAgICAgZHJhd25JY29ucy5kZWxldGUoY29udGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbnRleHQuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcbiAgICAgICAgICAgICAgICB2YXIgZmllbGQgPSBncmlkLmdldEZpZWxkKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICB2YXIgdGNpID0gKF9iID0gdGhpcy5fY2FjaGUgPyAoX2EgPSBzdGF0ZS5jYWNoZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmdldChmaWVsZCkgOiBudWxsKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBuZXcgVHJlZUNvbHVtbkluZm8oZ3JpZCwgZmllbGQpO1xuICAgICAgICAgICAgICAgIHZhciBpbmZvID0gdGNpLmdldEluZm8odmFsdWUsIHJvdyk7XG4gICAgICAgICAgICAgICAgaGVscGVyLnRlc3RGb250TG9hZChmb250LCBpbmZvLmNhcHRpb24sIGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIHV0aWxzLmxvYWRJY29ucyhnZXRJY29uKCksIGNvbnRleHQsIGhlbHBlciwgZnVuY3Rpb24gKGljb25zLCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGNvbnRleHQuZ2V0UmVjdCgpO1xuICAgICAgICAgICAgICAgICAgdmFyIGJhc2VQYWRkaW5nID0gaGVscGVyLnRvQm94UGl4ZWxBcnJheShwYWRkaW5nIHx8IDAsIGNvbnRleHQsIGZvbnQpO1xuICAgICAgICAgICAgICAgICAgdmFyIG5lc3RMZXZlbCA9IGluZm8ucGF0aC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICBoZWxwZXIuZHJhd1dpdGhDbGlwKGNvbnRleHQsIGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gKDAsIGNhbnZhc2VzXzEuZ2V0Rm9udFNpemUpKGN0eCwgZm9udCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRlbnRTaXplID0gZm9udFNpemUud2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSByZWN0LnRvcCArIGJhc2VQYWRkaW5nWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGVmdCA9IHJlY3QubGVmdCArIGJhc2VQYWRkaW5nWzNdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gcmVjdC5oZWlnaHQgLSBiYXNlUGFkZGluZ1swXSAtIGJhc2VQYWRkaW5nWzJdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGluZUJhc2VsaW5lID0gdGV4dEJhc2VsaW5lICE9PSBudWxsICYmIHRleHRCYXNlbGluZSAhPT0gdm9pZCAwID8gdGV4dEJhc2VsaW5lIDogY3R4LnRleHRCYXNlbGluZSB8fCBcIm1pZGRsZVwiOyAvLyBDYWxjdWxhdGUgaG9yaXpvbnRhbCBsaW5lIHBvc2l0aW9uXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGhMaW5lWSA9IHRvcCArIGhlaWdodCAvIDI7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVCYXNlbGluZSA9PT0gXCJib3R0b21cIiB8fCBsaW5lQmFzZWxpbmUgPT09IFwiYWxwaGFiZXRpY1wiIHx8IGxpbmVCYXNlbGluZSA9PT0gXCJpZGVvZ3JhcGhpY1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gYm90dG9tXG4gICAgICAgICAgICAgICAgICAgICAgaExpbmVZID0gdG9wICsgaGVpZ2h0IC0gZm9udFNpemUuaGVpZ2h0IC8gMjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZXh0QmFzZWxpbmUgPT09IFwibWlkZGxlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICBoTGluZVkgPSB0b3AgKyBoZWlnaHQgLyAyO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIHRvcFxuICAgICAgICAgICAgICAgICAgICAgIGhMaW5lWSA9IHRvcCArIGZvbnRTaXplLmhlaWdodCAvIDI7XG4gICAgICAgICAgICAgICAgICAgIH0gLy8gR2V0IHRoZSB0cmVlIGljb25cblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZpbmVkVHJlZUljb24gPSBzdHlsZS50cmVlSWNvbiB8fCBoZWxwZXIuZ2V0U3R5bGVQcm9wZXJ0eShoZWxwZXIudGhlbWUudHJlZS50cmVlSWNvbiwgY29sLCByb3csIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmVlSWNvbiA9IGRlZmluZWRUcmVlSWNvbiA9PT0gXCJub25lXCIgPyBudWxsIDogZGVmaW5lZFRyZWVJY29uID09PSBcImNoZXZyb25fcmlnaHRcIiB8fCBkZWZpbmVkVHJlZUljb24gPT09IFwiZXhwYW5kX21vcmVcIiA/IHtcbiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBkZWZpbmVkVHJlZUljb24sXG4gICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGZvbnRTaXplLndpZHRoXG4gICAgICAgICAgICAgICAgICAgIH0gOiBkZWZpbmVkVHJlZUljb247IC8vIENhbGN1bGF0ZSBpY29uIHJlY3RcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaWNvblJlY3QgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0cmVlSWNvbikge1xuICAgICAgICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyZWVMaW5lTGVmdCA9IGxlZnQgKyBpbmRlbnRTaXplICogKG5lc3RMZXZlbCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZMaW5lWCA9IHRyZWVMaW5lTGVmdCArIGluZGVudFNpemUgLyAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSBpbmxpbmVVdGlscy5pY29uT2YodHJlZUljb24pLndpZHRoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4OiBjdHhcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWNvblJlY3QgPSBuZXcgUmVjdF8xLlJlY3QodkxpbmVYIC0gc2l6ZSAvIDIsIGhMaW5lWSAtIHNpemUgLyAyLCBzaXplLCBzaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IC8vIEl0IHByZXNlcnZlcyB0aGUgcG9zaXRpb24gb2YgdGhlIGRyYXduIGljb25cbiAgICAgICAgICAgICAgICAgICAgICAvLyBiZWNhdXNlIGl0IGlzIHVzZWQgZm9yIHRoZSBgYXJlYWAgb3B0aW9uIG9mIHRoZSBgQWN0aW9uYCBjbGFzcy5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgdmFyIF9kcmF3bkljb25zID0gc3RhdGUuZHJhd25JY29ucyB8fCAoc3RhdGUuZHJhd25JY29ucyA9IG5ldyBEcmF3bkljb25zKCkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgX2RyYXduSWNvbnMuc2V0KGNvbnRleHQsIGljb25SZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfSAvLyBHZXQgdHJlZSBsaW5lIGNvbG9yXG5cblxuICAgICAgICAgICAgICAgICAgICB2YXIgbGluZVN0eWxlID0gc3R5bGUubGluZVN0eWxlIHx8IGhlbHBlci50aGVtZS50cmVlLmxpbmVTdHlsZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobGluZVN0eWxlICE9PSBcIm5vbmVcIikge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW5lV2lkdGggPSBzdHlsZS5saW5lV2lkdGggfHwgaGVscGVyLnRoZW1lLnRyZWUubGluZVdpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW5lQ29sb3IgPSBzdHlsZS5saW5lQ29sb3IgfHwgaGVscGVyLmdldENvbG9yKGhlbHBlci50aGVtZS50cmVlLmxpbmVDb2xvciwgY29sLCByb3csIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgICAgY3R4LnNhdmUoKTtcblxuICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBsaW5lQ29sb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gbGluZVdpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVDYXAgPSBcInJvdW5kXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpY29uUmVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDbGlwIGljb24gYXJlYVxuICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5yZWN0KDAsIDAsIGN0eC5jYW52YXMud2lkdGgsIGN0eC5jYW52YXMuaGVpZ2h0KTsgLy8gRHJhdyBhIHNxdWFyZSBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uIHRvIGhvbGxvdyBvdXQgdGhlIGluc2lkZS5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgucmVjdChpY29uUmVjdC5yaWdodCwgaWNvblJlY3QudG9wLCAtaWNvblJlY3Qud2lkdGgsIGljb25SZWN0LmhlaWdodCk7IC8vIC8vIEZvciBkZWJ1Z1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjdHguZmlsbFN0eWxlID0gXCIjMDAwMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjdHguZmlsbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5jbGlwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IC8vIERyYXcgdHJlZSBsaW5lc1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm8uZ2V0TGluZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChsaW5lLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJlZUxpbmVMZWZ0ID0gbGVmdCArIGluZGVudFNpemUgKiBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZMaW5lWCA9IHRyZWVMaW5lTGVmdCArIGluZGVudFNpemUgLyAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJlZUxpbmVSaWdodCA9IHRyZWVMaW5lTGVmdCArIGluZGVudFNpemU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmUgIT09IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLyogVHJlZUxpbmVLaW5kLm5vbmUgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lID09PSAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQudmVydGljYWwgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8odkxpbmVYLCByZWN0LnRvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh2TGluZVgsIHJlY3QuYm90dG9tKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lID09PSAyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQubGFzdCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyh2TGluZVgsIHJlY3QudG9wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHZMaW5lWCwgaExpbmVZKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHRyZWVMaW5lUmlnaHQsIGhMaW5lWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZSA9PT0gM1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogVHJlZUxpbmVLaW5kLnN0YXJ0ICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHRyZWVMaW5lUmlnaHQsIGhMaW5lWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh2TGluZVgsIGhMaW5lWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh2TGluZVgsIHJlY3QuYm90dG9tKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lID09PSA0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQudmVydGljYWxCcmFuY2ggKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8odkxpbmVYLCByZWN0LnRvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh2TGluZVgsIHJlY3QuYm90dG9tKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHZMaW5lWCwgaExpbmVZKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHRyZWVMaW5lUmlnaHQsIGhMaW5lWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZSA9PT0gNVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogVHJlZUxpbmVLaW5kLmhvcml6b250YWwgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8odHJlZUxpbmVMZWZ0LCBoTGluZVkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8odHJlZUxpbmVSaWdodCwgaExpbmVZKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lID09PSA2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQuaG9yaXpvbnRhbEJyYW5jaCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyh0cmVlTGluZUxlZnQsIGhMaW5lWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh0cmVlTGluZVJpZ2h0LCBoTGluZVkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8odkxpbmVYLCBoTGluZVkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8odkxpbmVYLCByZWN0LmJvdHRvbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZSA9PT0gN1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogVHJlZUxpbmVLaW5kLmxvbmUgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8odkxpbmVYLCBoTGluZVkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8odHJlZUxpbmVSaWdodCwgaExpbmVZKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyZWVJY29uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gRHJhdyB0cmVlIGljb25cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWNvbkxlZnRPZmZzZXQgPSBpbmRlbnRTaXplICogKG5lc3RMZXZlbCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBpY29uV2lkdGggPSBpbmRlbnRTaXplO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBpY29uUGFkZGluZyA9IGJhc2VQYWRkaW5nLnNsaWNlKDApO1xuICAgICAgICAgICAgICAgICAgICAgIGljb25QYWRkaW5nWzNdICs9IGljb25MZWZ0T2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgIGljb25QYWRkaW5nWzFdID0gcmVjdC53aWR0aCAtIGljb25XaWR0aCAtIGljb25QYWRkaW5nWzNdOyAvLyBwYWRkaW5nIHJpZ2h0XG5cbiAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIudGV4dChcIlwiLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmU6IHRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uczogW3RyZWVJY29uXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IGljb25QYWRkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dFBhZGRpbmcgPSBiYXNlUGFkZGluZy5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICAgICAgdGV4dFBhZGRpbmdbM10gKz0gbmVzdExldmVsICogaW5kZW50U2l6ZTsgLy8gVHJlZSBpbmRlbnQgcGFkZGluZ1xuXG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci50ZXh0KGluZm8uY2FwdGlvbiwgY29udGV4dCwge1xuICAgICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogdGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZTogdGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICBmb250OiBmb250LFxuICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHRleHRQYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdzogdGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgICAgICAgIGljb25zOiBpY29uc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBUcmVlQ29sdW1uO1xuICAgICAgICAgIH0oQ29sdW1uXzEuQ29sdW1uKTtcblxuICAgICAgICAgIGV4cG9ydHMuVHJlZUNvbHVtbiA9IFRyZWVDb2x1bW47XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogSWYgdGhlIGNlbGwgaXMgYSBUcmVlQ29sdW1uLCBnZXRzIHRoZSB0cmVlIG5vZGUgaW5mb3JtYXRpb24gZnJvbSB0aGUgZ2l2ZW4gY2VsbC5cbiAgICAgICAgICAgKi9cblxuICAgICAgICAgIGZ1bmN0aW9uIGdldFRyZWVOb2RlSW5mb0F0KF9yZWY0Nykge1xuICAgICAgICAgICAgdmFyIGdyaWQgPSBfcmVmNDcuZ3JpZCxcbiAgICAgICAgICAgICAgICBjb2wgPSBfcmVmNDcuY29sLFxuICAgICAgICAgICAgICAgIHJvdyA9IF9yZWY0Ny5yb3c7XG4gICAgICAgICAgICB2YXIgZmllbGQgPSBncmlkLmdldEZpZWxkKGNvbCwgcm93KTtcbiAgICAgICAgICAgIGlmICghZmllbGQpIHJldHVybiB7XG4gICAgICAgICAgICAgIGhhc0NoaWxkcmVuOiBmYWxzZSxcbiAgICAgICAgICAgICAgbm9kZVR5cGU6IFwibGVhZlwiXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBncmlkLmRhdGFTb3VyY2U7XG4gICAgICAgICAgICB2YXIgY3VyckluZGV4ID0gZ3JpZC5nZXRSZWNvcmRJbmRleEJ5Um93KHJvdyk7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhU291cmNlLmdldEZpZWxkKGN1cnJJbmRleCwgZmllbGQpO1xuICAgICAgICAgICAgdmFyIHRyZWVEYXRhID0gZ2V0VHJlZURhdGFGcm9tVmFsdWUodmFsdWUpO1xuICAgICAgICAgICAgdmFyIGhhc0NoaWxkcmVuID0gaGFzQ2hpbGRyZW5CeVJlY29yZCh0cmVlRGF0YSwgZGF0YVNvdXJjZSwgZmllbGQsIGN1cnJJbmRleCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBub2RlVHlwZTogaGFzQ2hpbGRyZW4gPyBcImJyYW5jaFwiIDogdHJlZURhdGEubm9kZVR5cGUgfHwgXCJsZWFmXCIsXG4gICAgICAgICAgICAgIGhhc0NoaWxkcmVuOiBoYXNDaGlsZHJlblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmdldFRyZWVOb2RlSW5mb0F0ID0gZ2V0VHJlZU5vZGVJbmZvQXQ7XG5cbiAgICAgICAgICBmdW5jdGlvbiBoYXNDaGlsZHJlbkJ5UmVjb3JkKHRyZWVEYXRhLCBkYXRhU291cmNlLCBmaWVsZCwgcmVjb3JkSW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBuZXh0ID0gZGF0YVNvdXJjZS5nZXRGaWVsZChyZWNvcmRJbmRleCArIDEsIGZpZWxkKTtcbiAgICAgICAgICAgIGlmICghbmV4dCB8fCAoMCwgdXRpbHNfMS5pc1Byb21pc2UpKG5leHQpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbmV4dFBhcmVudFBhdGggPSBnZXRQYXJlbnRQYXRoKG5leHQpO1xuICAgICAgICAgICAgcmV0dXJuIHRyZWVEYXRhLnBhdGgubGVuZ3RoID09PSBuZXh0UGFyZW50UGF0aC5sZW5ndGggJiYgbmV4dFBhcmVudFBhdGguZXZlcnkoZnVuY3Rpb24gKHAsIGkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHAgPT09IHRyZWVEYXRhLnBhdGhbaV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgVHJlZUNvbHVtbkluZm8gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gVHJlZUNvbHVtbkluZm8oZ3JpZCwgZmllbGQpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRyZWVDb2x1bW5JbmZvKTtcblxuICAgICAgICAgICAgICB0aGlzLl9jYWNoZSA9IHt9O1xuICAgICAgICAgICAgICB0aGlzLl9ncmlkID0gZ3JpZDtcbiAgICAgICAgICAgICAgdGhpcy5fZmllbGQgPSBmaWVsZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFRyZWVDb2x1bW5JbmZvLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0SW5mb1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SW5mbyh2YWx1ZSwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5fZmllbGQsXG4gICAgICAgICAgICAgICAgICAgIGdyaWQgPSB0aGlzLl9ncmlkLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZSA9IHRoaXMuX2NhY2hlO1xuICAgICAgICAgICAgICAgIHZhciBjdXJySW5kZXggPSBncmlkLmdldFJlY29yZEluZGV4QnlSb3cocm93KTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IGdyaWQuZGF0YVNvdXJjZTtcbiAgICAgICAgICAgICAgICB2YXIgdHJlZURhdGEgPSBnZXRUcmVlRGF0YUZyb21WYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIGhhc0NoaWxkcmVuID0gaGFzQ2hpbGRyZW5CeVJlY29yZCh0cmVlRGF0YSwgZGF0YVNvdXJjZSwgZmllbGQsIGN1cnJJbmRleCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIGNhcHRpb246IHRyZWVEYXRhLmNhcHRpb24sXG4gICAgICAgICAgICAgICAgICBwYXRoOiB0cmVlRGF0YS5wYXRoLFxuICAgICAgICAgICAgICAgICAgZ2V0TGluZXM6IGZ1bmN0aW9uIGdldExpbmVzKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VyclBhdGggPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudFBhdGggPSB0cmVlRGF0YS5wYXRoLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudExpbmVzID0gcGFyZW50UGF0aC5tYXAoZnVuY3Rpb24gKHAsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgY3VyclBhdGgucHVzaChwKTtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNMYXN0ID0gaW5kZXggPT09IHBhcmVudFBhdGgubGVuZ3RoIC0gMTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNOZXh0U2libGluZ1dpdGhDYWNoZShjdXJyUGF0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpc0xhc3QgPyA0XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQudmVydGljYWxCcmFuY2ggKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIDogMVxuICAgICAgICAgICAgICAgICAgICAgICAgLyogVHJlZUxpbmVLaW5kLnZlcnRpY2FsICovXG4gICAgICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpc0xhc3QgPyAyXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQubGFzdCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQubm9uZSAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxmTGluZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzQ2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmTGluZSA9IHBhcmVudFBhdGgubGVuZ3RoID4gMCA/IDZcbiAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQuaG9yaXpvbnRhbEJyYW5jaCAqL1xuICAgICAgICAgICAgICAgICAgICAgIDogM1xuICAgICAgICAgICAgICAgICAgICAgIC8qIFRyZWVMaW5lS2luZC5zdGFydCAqL1xuICAgICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmTGluZSA9IHBhcmVudFBhdGgubGVuZ3RoID4gMCA/IDVcbiAgICAgICAgICAgICAgICAgICAgICAvKiBUcmVlTGluZUtpbmQuaG9yaXpvbnRhbCAqL1xuICAgICAgICAgICAgICAgICAgICAgIDogN1xuICAgICAgICAgICAgICAgICAgICAgIC8qIFRyZWVMaW5lS2luZC5sb25lICovXG4gICAgICAgICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudExpbmVzLmNvbmNhdChzZWxmTGluZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGhhc05leHRTaWJsaW5nV2l0aENhY2hlKHBhcmVudFBhdGgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBoYXMgPSBoYXNOZXh0U2libGluZ0Zyb21DYWNoZShjdXJySW5kZXgsIHBhcmVudFBhdGgubGVuZ3RoKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGhhcyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBoYXM7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBoYXNOZXh0U2libGluZyhwYXJlbnRQYXRoKTtcblxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSBjdXJySW5kZXg7IGluZGV4IDwgcmVzdWx0LmVuZDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICBzZXROZXh0U2libGluZ1RvQ2FjaGUoaW5kZXgsIHBhcmVudFBhdGgubGVuZ3RoLCByZXN1bHQuaGFzKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5oYXM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaGFzTmV4dFNpYmxpbmdGcm9tQ2FjaGUoaW5kZXgsIGxldmVsKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX3JlZjQ4ID0gY2FjaGVbaW5kZXhdIHx8IChjYWNoZVtpbmRleF0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGhhc05leHRTaWJsaW5nczogW11cbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgIGhhc05leHRTaWJsaW5ncyA9IF9yZWY0OC5oYXNOZXh0U2libGluZ3M7XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiBoYXNOZXh0U2libGluZ3NbbGV2ZWxdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNldE5leHRTaWJsaW5nVG9DYWNoZShpbmRleCwgbGV2ZWwsIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX3JlZjQ5ID0gY2FjaGVbaW5kZXhdIHx8IChjYWNoZVtpbmRleF0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGhhc05leHRTaWJsaW5nczogW11cbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgIGhhc05leHRTaWJsaW5ncyA9IF9yZWY0OS5oYXNOZXh0U2libGluZ3M7XG5cbiAgICAgICAgICAgICAgICAgIGhhc05leHRTaWJsaW5nc1tsZXZlbF0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBoYXNOZXh0U2libGluZyhwYXJlbnRQYXRoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgc3RhcnRJbmRleCA9IGN1cnJJbmRleCArIDE7XG5cbiAgICAgICAgICAgICAgICAgIHZhciBfbG9vcDUgPSBmdW5jdGlvbiBfbG9vcDUoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhU291cmNlLmdldEZpZWxkKGluZGV4LCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKGRhdGEpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgIHY6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXM6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dFBhdGggPSBnZXRQYXJlbnRQYXRoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW5leHRQYXRoLmxlbmd0aCkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICB2OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aC5ldmVyeShmdW5jdGlvbiAocCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwID09PSBuZXh0UGF0aFtpXTtcbiAgICAgICAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBBbGwgbWF0Y2hlcyFcbiAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aC5sZW5ndGggPCBuZXh0UGF0aC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEl0J3MgYSBjaGlsZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGUuZy5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOKUnCB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOKUgiDilJwgbmV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhcyA9IGhhc05leHRTaWJsaW5nRnJvbUNhY2hlKGluZGV4LCBwYXJlbnRQYXRoLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzICE9IG51bGwpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHY6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhczogaGFzXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgICAgICAgICAgIH0gLy8gVGhlcmUgaXMgbmV4dCBzaWJsaW5nLlxuICAgICAgICAgICAgICAgICAgICAgIC8vIGUuZy5cbiAgICAgICAgICAgICAgICAgICAgICAvLyDilJwgdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgICAgLy8g4pSCIOKUnCB4XG4gICAgICAgICAgICAgICAgICAgICAgLy8g4pSCIOKUlCB4XG4gICAgICAgICAgICAgICAgICAgICAgLy8g4pSUIG5leHRcblxuXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHY6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBpbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSAvLyBUaGVyZSBpcyBubyBuZXh0IHNpYmxpbmcuXG4gICAgICAgICAgICAgICAgICAgIC8vIGUuZy5cbiAgICAgICAgICAgICAgICAgICAgLy8g4pSCIOKUlCB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgLy8g4pSCICAg4pScIHhcbiAgICAgICAgICAgICAgICAgICAgLy8g4pSCICAg4pSUIHhcbiAgICAgICAgICAgICAgICAgICAgLy8g4pSUIG5leHRcblxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgdjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBpbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhczogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IHN0YXJ0SW5kZXg7IGluZGV4IDwgZGF0YVNvdXJjZS5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZXQgPSBfbG9vcDUoaW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChfcmV0ID09PSBcImNvbnRpbnVlXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3R5cGVvZihfcmV0KSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQudjtcbiAgICAgICAgICAgICAgICAgIH0gLy8gVGhlcmUgaXMgbm8gbmV4dCBzaWJsaW5nLlxuXG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGVuZDogZGF0YVNvdXJjZS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIGhhczogZmFsc2VcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBUcmVlQ29sdW1uSW5mbztcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRUcmVlRGF0YUZyb21WYWx1ZSh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcblxuICAgICAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFRyZWVEYXRhRnJvbVZhbHVlKHtcbiAgICAgICAgICAgICAgICAgIHBhdGg6IHZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUucGF0aCkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBjYXB0aW9uOiBTdHJpbmcoKF9iID0gKF9hID0gdmFsdWUuY2FwdGlvbikgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogdmFsdWUucGF0aFt2YWx1ZS5wYXRoLmxlbmd0aCAtIDFdKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBcIlwiKSxcbiAgICAgICAgICAgICAgICAgIHBhdGg6IHZhbHVlLnBhdGgsXG4gICAgICAgICAgICAgICAgICBub2RlVHlwZTogdmFsdWUubm9kZVR5cGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUucGF0aCA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gZ2V0VHJlZURhdGFGcm9tVmFsdWUoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB2YWx1ZSksIHtcbiAgICAgICAgICAgICAgICAgIHBhdGg6IHZhbHVlLnBhdGgoKVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBjYXB0aW9uOiBTdHJpbmcodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHZvaWQgMCA/IHZhbHVlIDogXCJcIiksXG4gICAgICAgICAgICAgIHBhdGg6IFt2YWx1ZV1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0UGFyZW50UGF0aCh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFRyZWVEYXRhRnJvbVZhbHVlKHZhbHVlKS5wYXRoLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgRHJhd25JY29ucyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBEcmF3bkljb25zKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRHJhd25JY29ucyk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fZHJhd25JY29ucyA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKERyYXduSWNvbnMsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJzZXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldChjZWxsLCBjbGlwUmVjdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RyYXduSWNvbnMuc2V0KFwiXCIuY29uY2F0KGNlbGwuY29sLCBcIjpcIikuY29uY2F0KGNlbGwucm93KSwgY2xpcFJlY3QpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkZWxldGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoY2VsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RyYXduSWNvbnMuZGVsZXRlKFwiXCIuY29uY2F0KGNlbGwuY29sLCBcIjpcIikuY29uY2F0KGNlbGwucm93KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImFyZWFcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFyZWEoX3JlZjUwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9yZWY1MC5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IF9yZWY1MC5yb3csXG4gICAgICAgICAgICAgICAgICAgIHBvaW50ID0gX3JlZjUwLnBvaW50SW5EcmF3aW5nQ2FudmFzO1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBcIlwiLmNvbmNhdChjb2wsIFwiOlwiKS5jb25jYXQocm93KTtcblxuICAgICAgICAgICAgICAgIHZhciByZWN0ID0gdGhpcy5fZHJhd25JY29ucy5nZXQoa2V5KTtcblxuICAgICAgICAgICAgICAgIGlmICghcmVjdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZWN0LmxlZnQgPD0gcG9pbnQueCAmJiBwb2ludC54IDw9IHJlY3QucmlnaHQgJiYgcmVjdC50b3AgPD0gcG9pbnQueSAmJiBwb2ludC55IDw9IHJlY3QuYm90dG9tO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBEcmF3bkljb25zO1xuICAgICAgICAgIH0oKTtcbiAgICAgICAgICAvKioqL1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9jb2x1bW5VdGlscy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb2x1bW5zL3R5cGUvY29sdW1uVXRpbHMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gY29sdW1uc1R5cGVDb2x1bW5VdGlsc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMubG9hZEljb25zID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGljb25zID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL2ljb25zICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL2ljb25zLmpzXCIpKTtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICBmdW5jdGlvbiBsb2FkSWNvbnMoaWNvbiwgY29udGV4dCwgaGVscGVyLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgdmFyIGFyZ0ljb24gPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIGlmIChpY29uKSB7XG4gICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKGljb24pKSB7XG4gICAgICAgICAgICAgICAgaWNvbi50aGVuKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICAgICAgICBsb2FkSWNvbnMoaSwgY29udGV4dC50b0N1cnJlbnRDb250ZXh0KCksIGhlbHBlciwgY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBpY29uTGlzdCA9IGljb25zLnRvTm9ybWFsaXplQXJyYXkoaWNvbik7XG4gICAgICAgICAgICAgICAgaWNvbkxpc3QuZm9yRWFjaChmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGkuZm9udCAmJiBpLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLnRlc3RGb250TG9hZChpLmZvbnQsIGkuY29udGVudCwgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYXJnSWNvbiA9IGljb25MaXN0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKGFyZ0ljb24sIGNvbnRleHQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMubG9hZEljb25zID0gbG9hZEljb25zO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2NvbHVtbnMvdXRpbHMvaW5kZXguanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvbHVtbnMvdXRpbHMvaW5kZXguanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGNvbHVtbnNVdGlsc0luZGV4SnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy50b0Jvb2xlYW4gPSB2b2lkIDA7XG5cbiAgICAgICAgICBmdW5jdGlvbiB0b0Jvb2xlYW4odmFsKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICBpZiAodmFsID09PSBcImZhbHNlXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsID09PSBcIm9mZlwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKC9eMCskLy5leGVjKHZhbCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4odmFsKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLnRvQm9vbGVhbiA9IHRvQm9vbGVhbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb3JlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb3JlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb3JlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5FVkVOVF9UWVBFID0gZXhwb3J0cy5EcmF3R3JpZCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBEcmF3R3JpZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9jb3JlL0RyYXdHcmlkICovXG4gICAgICAgICAgXCIuL2NvcmUvRHJhd0dyaWQuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJEcmF3R3JpZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBEcmF3R3JpZF8xLkRyYXdHcmlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIERHX0VWRU5UX1RZUEVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vY29yZS9ER19FVkVOVF9UWVBFICovXG4gICAgICAgICAgXCIuL2NvcmUvREdfRVZFTlRfVFlQRS5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkVWRU5UX1RZUEVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vY29yZS9ER19FVkVOVF9UWVBFLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2NvcmUvREdfRVZFTlRfVFlQRS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb3JlREdfRVZFTlRfVFlQRUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuREdfRVZFTlRfVFlQRSA9IHZvaWQgMDtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBEcmF3R3JpZCBldmVudCB0eXBlc1xuICAgICAgICAgICAqIEBjbGFzc2Rlc2MgY2hlZXRhaEdyaWQuY29yZS5FVkVOVF9UWVBFXG4gICAgICAgICAgICogQG1lbWJlcm9mIGNoZWV0YWhHcmlkLmNvcmVcbiAgICAgICAgICAgKi9cblxuICAgICAgICAgIGV4cG9ydHMuREdfRVZFTlRfVFlQRSA9IHtcbiAgICAgICAgICAgIENMSUNLX0NFTEw6IFwiY2xpY2tfY2VsbFwiLFxuICAgICAgICAgICAgREJMQ0xJQ0tfQ0VMTDogXCJkYmxjbGlja19jZWxsXCIsXG4gICAgICAgICAgICBEQkxUQVBfQ0VMTDogXCJkYmx0YXBfY2VsbFwiLFxuICAgICAgICAgICAgTU9VU0VET1dOX0NFTEw6IFwibW91c2Vkb3duX2NlbGxcIixcbiAgICAgICAgICAgIE1PVVNFVVBfQ0VMTDogXCJtb3VzZXVwX2NlbGxcIixcbiAgICAgICAgICAgIFNFTEVDVEVEX0NFTEw6IFwic2VsZWN0ZWRfY2VsbFwiLFxuICAgICAgICAgICAgS0VZRE9XTjogXCJrZXlkb3duXCIsXG4gICAgICAgICAgICBNT1VTRU1PVkVfQ0VMTDogXCJtb3VzZW1vdmVfY2VsbFwiLFxuICAgICAgICAgICAgTU9VU0VFTlRFUl9DRUxMOiBcIm1vdXNlZW50ZXJfY2VsbFwiLFxuICAgICAgICAgICAgTU9VU0VMRUFWRV9DRUxMOiBcIm1vdXNlbGVhdmVfY2VsbFwiLFxuICAgICAgICAgICAgTU9VU0VPVkVSX0NFTEw6IFwibW91c2VvdmVyX2NlbGxcIixcbiAgICAgICAgICAgIE1PVVNFT1VUX0NFTEw6IFwibW91c2VvdXRfY2VsbFwiLFxuICAgICAgICAgICAgVE9VQ0hTVEFSVF9DRUxMOiBcInRvdWNoc3RhcnRfY2VsbFwiLFxuICAgICAgICAgICAgQ09OVEVYVE1FTlVfQ0VMTDogXCJjb250ZXh0bWVudV9jZWxsXCIsXG4gICAgICAgICAgICBJTlBVVF9DRUxMOiBcImlucHV0X2NlbGxcIixcbiAgICAgICAgICAgIFBBU1RFX0NFTEw6IFwicGFzdGVfY2VsbFwiLFxuICAgICAgICAgICAgREVMRVRFX0NFTEw6IFwiZGVsZXRlX2NlbGxcIixcbiAgICAgICAgICAgIEVESVRBQkxFSU5QVVRfQ0VMTDogXCJlZGl0YWJsZWlucHV0X2NlbGxcIixcbiAgICAgICAgICAgIE1PRElGWV9TVEFUVVNfRURJVEFCTEVJTlBVVF9DRUxMOiBcIm1vZGlmeV9zdGF0dXNfZWRpdGFibGVpbnB1dF9jZWxsXCIsXG4gICAgICAgICAgICBSRVNJWkVfQ09MVU1OOiBcInJlc2l6ZV9jb2x1bW5cIixcbiAgICAgICAgICAgIFNDUk9MTDogXCJzY3JvbGxcIixcbiAgICAgICAgICAgIEZPQ1VTX0dSSUQ6IFwiZm9jdXNfZ3JpZFwiLFxuICAgICAgICAgICAgQkxVUl9HUklEOiBcImJsdXJfZ3JpZFwiXG4gICAgICAgICAgfTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb3JlL0RyYXdHcmlkLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb3JlL0RyYXdHcmlkLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb3JlRHJhd0dyaWRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkRyYXdHcmlkID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGNhbGMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvY2FsYyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9jYWxjLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBoaURQSSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbnRlcm5hbC9oaURQSSAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9oaURQSS5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgc3R5bGUgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvc3R5bGUgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvc3R5bGUuanNcIikpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBwYXN0ZV91dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvcGFzdGUtdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvcGFzdGUtdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgREdfRVZFTlRfVFlQRV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9ER19FVkVOVF9UWVBFICovXG4gICAgICAgICAgXCIuL2NvcmUvREdfRVZFTlRfVFlQRS5qc1wiKTtcblxuICAgICAgICAgIHZhciBFdmVudEhhbmRsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL0V2ZW50SGFuZGxlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgRXZlbnRUYXJnZXRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vRXZlbnRUYXJnZXQgKi9cbiAgICAgICAgICBcIi4vY29yZS9FdmVudFRhcmdldC5qc1wiKTtcblxuICAgICAgICAgIHZhciBOdW1iZXJNYXBfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL051bWJlck1hcCAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9OdW1iZXJNYXAuanNcIik7XG5cbiAgICAgICAgICB2YXIgUmVjdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvUmVjdCAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9SZWN0LmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFNjcm9sbGFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL1Njcm9sbGFibGUgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvU2Nyb2xsYWJsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBjYW52YXNlc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvY2FudmFzZXMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvY2FudmFzZXMuanNcIik7IC8vcHJvdGVjdGVkIHN5bWJvbFxuXG5cbiAgICAgICAgICB2YXIgc3ltYm9sTWFuYWdlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIF91dGlsc18xJGV2ZW50ID0gdXRpbHNfMS5ldmVudCxcbiAgICAgICAgICAgICAgaXNUb3VjaEV2ZW50ID0gX3V0aWxzXzEkZXZlbnQuaXNUb3VjaEV2ZW50LFxuICAgICAgICAgICAgICBnZXRNb3VzZUJ1dHRvbnMgPSBfdXRpbHNfMSRldmVudC5nZXRNb3VzZUJ1dHRvbnMsXG4gICAgICAgICAgICAgIGdldEtleUNvZGUgPSBfdXRpbHNfMSRldmVudC5nZXRLZXlDb2RlLFxuICAgICAgICAgICAgICBjYW5jZWxFdmVudCA9IF91dGlsc18xJGV2ZW50LmNhbmNlbDtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuICAgICAgICAgIHZhciBfID0gKDAsIHN5bWJvbE1hbmFnZXJfMS5nZXRQcm90ZWN0ZWRTeW1ib2wpKCk7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVJvb3RFbGVtZW50KCkge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiY2hlZXRhaC1ncmlkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICB2YXIgS0VZX0JTID0gODtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuICAgICAgICAgIHZhciBLRVlfVEFCID0gOTtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuICAgICAgICAgIHZhciBLRVlfRU5URVIgPSAxMztcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuICAgICAgICAgIHZhciBLRVlfRU5EID0gMzU7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cbiAgICAgICAgICB2YXIgS0VZX0hPTUUgPSAzNjtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuICAgICAgICAgIHZhciBLRVlfTEVGVCA9IDM3O1xuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG4gICAgICAgICAgdmFyIEtFWV9VUCA9IDM4O1xuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG4gICAgICAgICAgdmFyIEtFWV9SSUdIVCA9IDM5O1xuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG4gICAgICAgICAgdmFyIEtFWV9ET1dOID0gNDA7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cbiAgICAgICAgICB2YXIgS0VZX0RFTCA9IDQ2O1xuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG4gICAgICAgICAgdmFyIEtFWV9BTFBIQV9BID0gNjU7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cbiAgICAgICAgICB2YXIgS0VZX0FMUEhBX0MgPSA2NztcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuICAgICAgICAgIHZhciBLRVlfQUxQSEFfViA9IDg2OyAvL3ByaXZhdGUgbWV0aG9kc1xuXG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cbiAgICAgICAgICBmdW5jdGlvbiBfdmlicmF0ZShlKSB7XG4gICAgICAgICAgICBpZiAobmF2aWdhdG9yLnZpYnJhdGUgJiYgaXNUb3VjaEV2ZW50KGUpKSB7XG4gICAgICAgICAgICAgIG5hdmlnYXRvci52aWJyYXRlKDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRUYXJnZXRSb3dBdChhYnNvbHV0ZVkpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczYxID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGludGVybmFsID0gdGhpcy5nZXRUYXJnZXRSb3dBdEludGVybmFsKGFic29sdXRlWSk7XG5cbiAgICAgICAgICAgIGlmIChpbnRlcm5hbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBpbnRlcm5hbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGZpbmRCZWZvcmUgPSBmdW5jdGlvbiBmaW5kQmVmb3JlKHN0YXJ0Um93LCBzdGFydEJvdHRvbSkge1xuICAgICAgICAgICAgICB2YXIgYm90dG9tID0gc3RhcnRCb3R0b207XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgcm93ID0gc3RhcnRSb3c7IHJvdyA+PSAwOyByb3ctLSkge1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBfZ2V0Um93SGVpZ2h0LmNhbGwoX3RoaXM2MSwgcm93KTtcblxuICAgICAgICAgICAgICAgIHZhciB0b3AgPSBib3R0b20gLSBoZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodG9wIDw9IGFic29sdXRlWSAmJiBhYnNvbHV0ZVkgPCBib3R0b20pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHRvcDogdG9wLFxuICAgICAgICAgICAgICAgICAgICByb3c6IHJvd1xuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBib3R0b20gPSB0b3A7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBmaW5kQWZ0ZXIgPSBmdW5jdGlvbiBmaW5kQWZ0ZXIoc3RhcnRSb3csIHN0YXJ0Qm90dG9tKSB7XG4gICAgICAgICAgICAgIHZhciB0b3AgPSBzdGFydEJvdHRvbSAtIF9nZXRSb3dIZWlnaHQuY2FsbChfdGhpczYxLCBzdGFydFJvdyk7XG5cbiAgICAgICAgICAgICAgdmFyIHJvd0NvdW50ID0gX3RoaXM2MVtfXS5yb3dDb3VudDtcblxuICAgICAgICAgICAgICBmb3IgKHZhciByb3cgPSBzdGFydFJvdzsgcm93IDwgcm93Q291bnQ7IHJvdysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IF9nZXRSb3dIZWlnaHQuY2FsbChfdGhpczYxLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9ib3R0b20gPSB0b3AgKyBoZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodG9wIDw9IGFic29sdXRlWSAmJiBhYnNvbHV0ZVkgPCBfYm90dG9tKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0b3A6IHRvcCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdG9wID0gX2JvdHRvbTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGNhbmRpZGF0ZVJvdyA9IE1hdGgubWluKE1hdGguY2VpbChhYnNvbHV0ZVkgLyB0aGlzW19dLmRlZmF1bHRSb3dIZWlnaHQpLCB0aGlzLnJvd0NvdW50IC0gMSk7XG5cbiAgICAgICAgICAgIHZhciBib3R0b20gPSBfZ2V0Um93c0hlaWdodC5jYWxsKHRoaXMsIDAsIGNhbmRpZGF0ZVJvdyk7XG5cbiAgICAgICAgICAgIGlmIChhYnNvbHV0ZVkgPj0gYm90dG9tKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmaW5kQWZ0ZXIoY2FuZGlkYXRlUm93LCBib3R0b20pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZpbmRCZWZvcmUoY2FuZGlkYXRlUm93LCBib3R0b20pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldFRhcmdldENvbEF0KGdyaWQsIGFic29sdXRlWCkge1xuICAgICAgICAgICAgdmFyIGxlZnQgPSAwO1xuICAgICAgICAgICAgdmFyIGNvbENvdW50ID0gZ3JpZFtfXS5jb2xDb3VudDtcblxuICAgICAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgY29sQ291bnQ7IGNvbCsrKSB7XG4gICAgICAgICAgICAgIHZhciB3aWR0aCA9IF9nZXRDb2xXaWR0aChncmlkLCBjb2wpO1xuXG4gICAgICAgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDtcblxuICAgICAgICAgICAgICBpZiAocmlnaHQgPiBhYnNvbHV0ZVgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgICAgICAgICAgIGNvbDogY29sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGxlZnQgPSByaWdodDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0VGFyZ2V0RnJvemVuUm93QXQoZ3JpZCwgYWJzb2x1dGVZKSB7XG4gICAgICAgICAgICBpZiAoIWdyaWRbX10uZnJvemVuUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0b3AgPSBncmlkW19dLnNjcm9sbC50b3A7XG4gICAgICAgICAgICB2YXIgcm93Q291bnQgPSBncmlkW19dLmZyb3plblJvd0NvdW50O1xuXG4gICAgICAgICAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCByb3dDb3VudDsgcm93KyspIHtcbiAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IF9nZXRSb3dIZWlnaHQuY2FsbChncmlkLCByb3cpO1xuXG4gICAgICAgICAgICAgIHZhciBib3R0b20gPSB0b3AgKyBoZWlnaHQ7XG5cbiAgICAgICAgICAgICAgaWYgKGJvdHRvbSA+IGFic29sdXRlWSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICB0b3A6IHRvcCxcbiAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRvcCA9IGJvdHRvbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0VGFyZ2V0RnJvemVuQ29sQXQoZ3JpZCwgYWJzb2x1dGVYKSB7XG4gICAgICAgICAgICBpZiAoIWdyaWRbX10uZnJvemVuQ29sQ291bnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsZWZ0ID0gZ3JpZFtfXS5zY3JvbGwubGVmdDtcbiAgICAgICAgICAgIHZhciBjb2xDb3VudCA9IGdyaWRbX10uZnJvemVuQ29sQ291bnQ7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IGNvbENvdW50OyBjb2wrKykge1xuICAgICAgICAgICAgICB2YXIgd2lkdGggPSBfZ2V0Q29sV2lkdGgoZ3JpZCwgY29sKTtcblxuICAgICAgICAgICAgICB2YXIgcmlnaHQgPSBsZWZ0ICsgd2lkdGg7XG5cbiAgICAgICAgICAgICAgaWYgKHJpZ2h0ID4gYWJzb2x1dGVYKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgICAgICAgICBjb2w6IGNvbFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBsZWZ0ID0gcmlnaHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldEZyb3plblJvd3NSZWN0KGdyaWQpIHtcbiAgICAgICAgICAgIGlmICghZ3JpZFtfXS5mcm96ZW5Sb3dDb3VudCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRvcCA9IGdyaWRbX10uc2Nyb2xsLnRvcDtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSAwO1xuICAgICAgICAgICAgdmFyIHJvd0NvdW50ID0gZ3JpZFtfXS5mcm96ZW5Sb3dDb3VudDtcblxuICAgICAgICAgICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgcm93Q291bnQ7IHJvdysrKSB7XG4gICAgICAgICAgICAgIGhlaWdodCArPSBfZ2V0Um93SGVpZ2h0LmNhbGwoZ3JpZCwgcm93KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWN0XzEuUmVjdChncmlkW19dLnNjcm9sbC5sZWZ0LCB0b3AsIGdyaWRbX10uY2FudmFzLndpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldEZyb3plbkNvbHNSZWN0KGdyaWQpIHtcbiAgICAgICAgICAgIGlmICghZ3JpZFtfXS5mcm96ZW5Db2xDb3VudCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxlZnQgPSBncmlkW19dLnNjcm9sbC5sZWZ0O1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gMDtcbiAgICAgICAgICAgIHZhciBjb2xDb3VudCA9IGdyaWRbX10uZnJvemVuQ29sQ291bnQ7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IGNvbENvdW50OyBjb2wrKykge1xuICAgICAgICAgICAgICB3aWR0aCArPSBfZ2V0Q29sV2lkdGgoZ3JpZCwgY29sKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWN0XzEuUmVjdChsZWZ0LCBncmlkW19dLnNjcm9sbC50b3AsIHdpZHRoLCBncmlkW19dLmNhbnZhcy5oZWlnaHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldENlbGxEcmF3aW5nKGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICBpZiAoIWdyaWRbX10uZHJhd0NlbGxzW3Jvd10pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBncmlkW19dLmRyYXdDZWxsc1tyb3ddW2NvbF07XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfcHV0Q2VsbERyYXdpbmcoZ3JpZCwgY29sLCByb3csIGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmICghZ3JpZFtfXS5kcmF3Q2VsbHNbcm93XSkge1xuICAgICAgICAgICAgICBncmlkW19dLmRyYXdDZWxsc1tyb3ddID0ge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdyaWRbX10uZHJhd0NlbGxzW3Jvd11bY29sXSA9IGNvbnRleHQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfcmVtb3ZlQ2VsbERyYXdpbmcoZ3JpZCwgY29sLCByb3cpIHtcbiAgICAgICAgICAgIGlmICghZ3JpZFtfXS5kcmF3Q2VsbHNbcm93XSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlbGV0ZSBncmlkW19dLmRyYXdDZWxsc1tyb3ddW2NvbF07XG5cbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhncmlkW19dLmRyYXdDZWxsc1tyb3ddKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgZGVsZXRlIGdyaWRbX10uZHJhd0NlbGxzW3Jvd107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZHJhd0NlbGwoY3R4LCBjb2wsIGFic29sdXRlTGVmdCwgd2lkdGgsIHJvdywgYWJzb2x1dGVUb3AsIGhlaWdodCwgdmlzaWJsZVJlY3QsIHNraXBBYnNvbHV0ZVRvcCwgc2tpcEFic29sdXRlTGVmdCwgZHJhd0xheWVycykge1xuICAgICAgICAgICAgdmFyIF90aGlzNjIgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgcmVjdCA9IG5ldyBSZWN0XzEuUmVjdChhYnNvbHV0ZUxlZnQgLSB2aXNpYmxlUmVjdC5sZWZ0LCBhYnNvbHV0ZVRvcCAtIHZpc2libGVSZWN0LnRvcCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB2YXIgZHJhd1JlY3QgPSBSZWN0XzEuUmVjdC5ib3VuZHMoTWF0aC5tYXgoYWJzb2x1dGVMZWZ0LCBza2lwQWJzb2x1dGVMZWZ0KSAtIHZpc2libGVSZWN0LmxlZnQsIE1hdGgubWF4KGFic29sdXRlVG9wLCBza2lwQWJzb2x1dGVUb3ApIC0gdmlzaWJsZVJlY3QudG9wLCByZWN0LnJpZ2h0LCByZWN0LmJvdHRvbSk7XG5cbiAgICAgICAgICAgIGlmIChkcmF3UmVjdC5oZWlnaHQgPiAwICYmIGRyYXdSZWN0LndpZHRoID4gMCkge1xuICAgICAgICAgICAgICBjdHguc2F2ZSgpO1xuXG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGNlbGxEcmF3aW5nID0gX2dldENlbGxEcmF3aW5nKHRoaXMsIGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgIGlmIChjZWxsRHJhd2luZykge1xuICAgICAgICAgICAgICAgICAgY2VsbERyYXdpbmcuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGRjQ29udGV4dCA9IG5ldyBEcmF3Q2VsbENvbnRleHQoY29sLCByb3csIGN0eCwgcmVjdCwgZHJhd1JlY3QsICEhY2VsbERyYXdpbmcsIHRoaXNbX10uc2VsZWN0aW9uLCBkcmF3TGF5ZXJzKTtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IHRoaXMub25EcmF3Q2VsbChjb2wsIHJvdywgZGNDb250ZXh0KTtcblxuICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKHApKSB7XG4gICAgICAgICAgICAgICAgICAvL+mBheW7tuaPj+eUu1xuICAgICAgICAgICAgICAgICAgX3B1dENlbGxEcmF3aW5nKHRoaXMsIGNvbCwgcm93LCBkY0NvbnRleHQpO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgcENvbCA9IGNvbDtcblxuICAgICAgICAgICAgICAgICAgZGNDb250ZXh0Ll9kZWxheU1vZGUodGhpcywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfcmVtb3ZlQ2VsbERyYXdpbmcoX3RoaXM2MiwgcENvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICBwLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBkY0NvbnRleHQudGVybWluYXRlKCk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2RyYXdSb3coZ3JpZCwgY3R4LCBpbml0RnJvemVuQ29sLCBpbml0Q29sLCBkcmF3UmlnaHQsIHJvdywgYWJzb2x1dGVUb3AsIGhlaWdodCwgdmlzaWJsZVJlY3QsIHNraXBBYnNvbHV0ZVRvcCwgZHJhd0xheWVycykge1xuICAgICAgICAgICAgdmFyIGNvbENvdW50ID0gZ3JpZFtfXS5jb2xDb3VudDtcblxuICAgICAgICAgICAgdmFyIGRyYXdPdXRlciA9IGZ1bmN0aW9uIGRyYXdPdXRlcihjb2wsIGFic29sdXRlTGVmdCkge1xuICAgICAgICAgICAgICAvL+ODh+ODvOOCv+evhOWbsuWkluOBruaPj+eUu1xuICAgICAgICAgICAgICBpZiAoY29sID49IGNvbENvdW50IC0gMSAmJiBncmlkW19dLmNhbnZhcy53aWR0aCA+IGFic29sdXRlTGVmdCAtIHZpc2libGVSZWN0LmxlZnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0ZXJMZWZ0ID0gYWJzb2x1dGVMZWZ0IC0gdmlzaWJsZVJlY3QubGVmdDtcbiAgICAgICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gZ3JpZC51bmRlcmxheUJhY2tncm91bmRDb2xvciB8fCBcIiNGNkY2RjZcIjtcbiAgICAgICAgICAgICAgICBjdHgucmVjdChvdXRlckxlZnQsIGFic29sdXRlVG9wIC0gdmlzaWJsZVJlY3QudG9wLCBncmlkW19dLmNhbnZhcy53aWR0aCAtIG91dGVyTGVmdCwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBza2lwQWJzb2x1dGVMZWZ0ID0gMDtcblxuICAgICAgICAgICAgaWYgKGluaXRGcm96ZW5Db2wpIHtcbiAgICAgICAgICAgICAgdmFyIF9hYnNvbHV0ZUxlZnQgPSBpbml0RnJvemVuQ29sLmxlZnQ7XG4gICAgICAgICAgICAgIHZhciBjb3VudCA9IGdyaWRbX10uZnJvemVuQ29sQ291bnQ7XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgY29sID0gaW5pdEZyb3plbkNvbC5jb2w7IGNvbCA8IGNvdW50OyBjb2wrKykge1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IF9nZXRDb2xXaWR0aChncmlkLCBjb2wpO1xuXG4gICAgICAgICAgICAgICAgX2RyYXdDZWxsLmNhbGwoZ3JpZCwgY3R4LCBjb2wsIF9hYnNvbHV0ZUxlZnQsIHdpZHRoLCByb3csIGFic29sdXRlVG9wLCBoZWlnaHQsIHZpc2libGVSZWN0LCBza2lwQWJzb2x1dGVUb3AsIDAsIGRyYXdMYXllcnMpO1xuXG4gICAgICAgICAgICAgICAgX2Fic29sdXRlTGVmdCArPSB3aWR0aDtcblxuICAgICAgICAgICAgICAgIGlmIChkcmF3UmlnaHQgPD0gX2Fic29sdXRlTGVmdCkge1xuICAgICAgICAgICAgICAgICAgLy/mj4/nlLvnr4Tlm7LlpJbvvIjntYLkuobvvIlcbiAgICAgICAgICAgICAgICAgIGRyYXdPdXRlcihjb2wsIF9hYnNvbHV0ZUxlZnQpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHNraXBBYnNvbHV0ZUxlZnQgPSBfYWJzb2x1dGVMZWZ0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYWJzb2x1dGVMZWZ0ID0gaW5pdENvbC5sZWZ0O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBfY29sMiA9IGluaXRDb2wuY29sOyBfY29sMiA8IGNvbENvdW50OyBfY29sMisrKSB7XG4gICAgICAgICAgICAgIHZhciBfd2lkdGgyID0gX2dldENvbFdpZHRoKGdyaWQsIF9jb2wyKTtcblxuICAgICAgICAgICAgICBfZHJhd0NlbGwuY2FsbChncmlkLCBjdHgsIF9jb2wyLCBhYnNvbHV0ZUxlZnQsIF93aWR0aDIsIHJvdywgYWJzb2x1dGVUb3AsIGhlaWdodCwgdmlzaWJsZVJlY3QsIHNraXBBYnNvbHV0ZVRvcCwgc2tpcEFic29sdXRlTGVmdCwgZHJhd0xheWVycyk7XG5cbiAgICAgICAgICAgICAgYWJzb2x1dGVMZWZ0ICs9IF93aWR0aDI7XG5cbiAgICAgICAgICAgICAgaWYgKGRyYXdSaWdodCA8PSBhYnNvbHV0ZUxlZnQpIHtcbiAgICAgICAgICAgICAgICAvL+aPj+eUu+evhOWbsuWklu+8iOe1guS6hu+8iVxuICAgICAgICAgICAgICAgIGRyYXdPdXRlcihfY29sMiwgYWJzb2x1dGVMZWZ0KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZHJhd091dGVyKGNvbENvdW50IC0gMSwgYWJzb2x1dGVMZWZ0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRJbml0Q29udGV4dCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRJbml0Q29udGV4dCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2ludmFsaWRhdGVSZWN0KGdyaWQsIGRyYXdSZWN0KSB7XG4gICAgICAgICAgICB2YXIgdmlzaWJsZVJlY3QgPSBfZ2V0VmlzaWJsZVJlY3QoZ3JpZCk7XG5cbiAgICAgICAgICAgIHZhciByb3dDb3VudCA9IGdyaWRbX10ucm93Q291bnQ7XG5cbiAgICAgICAgICAgIHZhciBjdHggPSBfZ2V0SW5pdENvbnRleHQuY2FsbChncmlkKTtcblxuICAgICAgICAgICAgdmFyIGluaXRSb3cgPSBfZ2V0VGFyZ2V0Um93QXQuY2FsbChncmlkLCBNYXRoLm1heCh2aXNpYmxlUmVjdC50b3AsIGRyYXdSZWN0LnRvcCkpIHx8IHtcbiAgICAgICAgICAgICAgdG9wOiBfZ2V0Um93c0hlaWdodC5jYWxsKGdyaWQsIDAsIHJvd0NvdW50IC0gMSksXG4gICAgICAgICAgICAgIHJvdzogcm93Q291bnRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgaW5pdENvbCA9IF9nZXRUYXJnZXRDb2xBdChncmlkLCBNYXRoLm1heCh2aXNpYmxlUmVjdC5sZWZ0LCBkcmF3UmVjdC5sZWZ0KSkgfHwge1xuICAgICAgICAgICAgICBsZWZ0OiBfZ2V0Q29sc1dpZHRoKGdyaWQsIDAsIGdyaWRbX10uY29sQ291bnQgLSAxKSxcbiAgICAgICAgICAgICAgY29sOiBncmlkW19dLmNvbENvdW50XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGRyYXdCb3R0b20gPSBNYXRoLm1pbih2aXNpYmxlUmVjdC5ib3R0b20sIGRyYXdSZWN0LmJvdHRvbSk7XG4gICAgICAgICAgICB2YXIgZHJhd1JpZ2h0ID0gTWF0aC5taW4odmlzaWJsZVJlY3QucmlnaHQsIGRyYXdSZWN0LnJpZ2h0KTtcblxuICAgICAgICAgICAgdmFyIGluaXRGcm96ZW5Sb3cgPSBfZ2V0VGFyZ2V0RnJvemVuUm93QXQoZ3JpZCwgTWF0aC5tYXgodmlzaWJsZVJlY3QudG9wLCBkcmF3UmVjdC50b3ApKTtcblxuICAgICAgICAgICAgdmFyIGluaXRGcm96ZW5Db2wgPSBfZ2V0VGFyZ2V0RnJvemVuQ29sQXQoZ3JpZCwgTWF0aC5tYXgodmlzaWJsZVJlY3QubGVmdCwgZHJhd1JlY3QubGVmdCkpO1xuXG4gICAgICAgICAgICB2YXIgZHJhd0xheWVycyA9IG5ldyBEcmF3TGF5ZXJzKCk7XG5cbiAgICAgICAgICAgIHZhciBkcmF3T3V0ZXIgPSBmdW5jdGlvbiBkcmF3T3V0ZXIocm93LCBhYnNvbHV0ZVRvcCkge1xuICAgICAgICAgICAgICAvL+ODh+ODvOOCv+evhOWbsuWkluOBruaPj+eUu1xuICAgICAgICAgICAgICBpZiAocm93ID49IHJvd0NvdW50IC0gMSAmJiBncmlkW19dLmNhbnZhcy5oZWlnaHQgPiBhYnNvbHV0ZVRvcCAtIHZpc2libGVSZWN0LnRvcCkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRlclRvcCA9IGFic29sdXRlVG9wIC0gdmlzaWJsZVJlY3QudG9wO1xuICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBncmlkLnVuZGVybGF5QmFja2dyb3VuZENvbG9yIHx8IFwiI0Y2RjZGNlwiO1xuICAgICAgICAgICAgICAgIGN0eC5yZWN0KDAsIG91dGVyVG9wLCBncmlkW19dLmNhbnZhcy53aWR0aCwgZ3JpZFtfXS5jYW52YXMuaGVpZ2h0IC0gb3V0ZXJUb3ApO1xuICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIHNraXBBYnNvbHV0ZVRvcCA9IDA7XG5cbiAgICAgICAgICAgIGlmIChpbml0RnJvemVuUm93KSB7XG4gICAgICAgICAgICAgIHZhciBfYWJzb2x1dGVUb3AgPSBpbml0RnJvemVuUm93LnRvcDtcbiAgICAgICAgICAgICAgdmFyIGNvdW50ID0gZ3JpZFtfXS5mcm96ZW5Sb3dDb3VudDtcblxuICAgICAgICAgICAgICBmb3IgKHZhciByb3cgPSBpbml0RnJvemVuUm93LnJvdzsgcm93IDwgY291bnQ7IHJvdysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IF9nZXRSb3dIZWlnaHQuY2FsbChncmlkLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgX2RyYXdSb3coZ3JpZCwgY3R4LCBpbml0RnJvemVuQ29sLCBpbml0Q29sLCBkcmF3UmlnaHQsIHJvdywgX2Fic29sdXRlVG9wLCBoZWlnaHQsIHZpc2libGVSZWN0LCAwLCBkcmF3TGF5ZXJzKTtcblxuICAgICAgICAgICAgICAgIF9hYnNvbHV0ZVRvcCArPSBoZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoZHJhd0JvdHRvbSA8PSBfYWJzb2x1dGVUb3ApIHtcbiAgICAgICAgICAgICAgICAgIC8v5o+P55S756+E5Zuy5aSW77yI57WC5LqG77yJXG4gICAgICAgICAgICAgICAgICBkcmF3T3V0ZXIocm93LCBfYWJzb2x1dGVUb3ApO1xuICAgICAgICAgICAgICAgICAgZHJhd0xheWVycy5kcmF3KGN0eCk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgc2tpcEFic29sdXRlVG9wID0gX2Fic29sdXRlVG9wO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYWJzb2x1dGVUb3AgPSBpbml0Um93LnRvcDtcblxuICAgICAgICAgICAgZm9yICh2YXIgX3JvdzIgPSBpbml0Um93LnJvdzsgX3JvdzIgPCByb3dDb3VudDsgX3JvdzIrKykge1xuICAgICAgICAgICAgICB2YXIgX2hlaWdodDIgPSBfZ2V0Um93SGVpZ2h0LmNhbGwoZ3JpZCwgX3JvdzIpOyAvL+ihjOOBruaPj+eUu1xuXG5cbiAgICAgICAgICAgICAgX2RyYXdSb3coZ3JpZCwgY3R4LCBpbml0RnJvemVuQ29sLCBpbml0Q29sLCBkcmF3UmlnaHQsIF9yb3cyLCBhYnNvbHV0ZVRvcCwgX2hlaWdodDIsIHZpc2libGVSZWN0LCBza2lwQWJzb2x1dGVUb3AsIGRyYXdMYXllcnMpO1xuXG4gICAgICAgICAgICAgIGFic29sdXRlVG9wICs9IF9oZWlnaHQyO1xuXG4gICAgICAgICAgICAgIGlmIChkcmF3Qm90dG9tIDw9IGFic29sdXRlVG9wKSB7XG4gICAgICAgICAgICAgICAgLy/mj4/nlLvnr4Tlm7LlpJbvvIjntYLkuobvvIlcbiAgICAgICAgICAgICAgICBkcmF3T3V0ZXIoX3JvdzIsIGFic29sdXRlVG9wKTtcbiAgICAgICAgICAgICAgICBkcmF3TGF5ZXJzLmRyYXcoY3R4KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZHJhd091dGVyKHJvd0NvdW50IC0gMSwgYWJzb2x1dGVUb3ApO1xuICAgICAgICAgICAgZHJhd0xheWVycy5kcmF3KGN0eCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfdG9QeFdpZHRoKGdyaWQsIHdpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChjYWxjLnRvUHgod2lkdGgsIGdyaWRbX10uY2FsY1dpZHRoQ29udGV4dCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2FkanVzdENvbFdpZHRoKGdyaWQsIGNvbCwgb3JnV2lkdGgpIHtcbiAgICAgICAgICAgIHZhciBsaW1pdHMgPSBfZ2V0Q29sV2lkdGhMaW1pdHMoZ3JpZCwgY29sKTtcblxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KF9hcHBseUNvbFdpZHRoTGltaXRzKGxpbWl0cywgb3JnV2lkdGgpLCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9hcHBseUNvbFdpZHRoTGltaXRzKGxpbWl0cywgb3JnV2lkdGgpIHtcbiAgICAgICAgICAgIGlmICghbGltaXRzKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvcmdXaWR0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGxpbWl0cy5taW4pIHtcbiAgICAgICAgICAgICAgaWYgKGxpbWl0cy5taW4gPiBvcmdXaWR0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW1pdHMubWluO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChsaW1pdHMubWF4KSB7XG4gICAgICAgICAgICAgIGlmIChsaW1pdHMubWF4IDwgb3JnV2lkdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGltaXRzLm1heDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb3JnV2lkdGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEdldHMgdGhlIGRlZmluaXRpb24gb2YgdGhlIGNvbHVtbiB3aWR0aC5cbiAgICAgICAgICAgKiBAcGFyYW0ge0RyYXdHcmlkfSBncmlkIGdyaWQgaW5zdGFuY2VcbiAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gY29sIG51bWJlciBvZiBjb2x1bW5cbiAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfG51bWJlcn0gd2lkdGggZGVmaW5pdGlvblxuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRDb2xXaWR0aERlZmluZShncmlkLCBjb2wpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGdyaWRbX10uY29sV2lkdGhzTWFwLmdldChjb2wpO1xuXG4gICAgICAgICAgICBpZiAod2lkdGgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHdpZHRoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZ3JpZC5kZWZhdWx0Q29sV2lkdGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEdldHMgdGhlIGNvbHVtbiB3aWR0aCBsaW1pdHMuXG4gICAgICAgICAgICogQHBhcmFtIHtEcmF3R3JpZH0gZ3JpZCBncmlkIGluc3RhbmNlXG4gICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbCBudW1iZXIgb2YgY29sdW1uXG4gICAgICAgICAgICogQHJldHVybnMge29iamVjdHxudWxsfSB0aGUgY29sdW1uIHdpZHRoIGxpbWl0c1xuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRDb2xXaWR0aExpbWl0cyhncmlkLCBjb2wpIHtcbiAgICAgICAgICAgIHZhciBsaW1pdCA9IGdyaWRbX10uY29sV2lkdGhzTGltaXRbY29sXTtcblxuICAgICAgICAgICAgaWYgKCFsaW1pdCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuXG4gICAgICAgICAgICBpZiAobGltaXQubWluKSB7XG4gICAgICAgICAgICAgIHJlc3VsdC5taW4gPSBfdG9QeFdpZHRoKGdyaWQsIGxpbWl0Lm1pbik7XG4gICAgICAgICAgICAgIHJlc3VsdC5taW5EZWYgPSBsaW1pdC5taW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChsaW1pdC5tYXgpIHtcbiAgICAgICAgICAgICAgcmVzdWx0Lm1heCA9IF90b1B4V2lkdGgoZ3JpZCwgbGltaXQubWF4KTtcbiAgICAgICAgICAgICAgcmVzdWx0Lm1heERlZiA9IGxpbWl0Lm1heDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQ2hlY2tzIGlmIHRoZSBnaXZlbiB3aWR0aCBkZWZpbml0aW9uIGlzIGBhdXRvYC5cbiAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IHdpZHRoIHdpZHRoIGRlZmluaXRpb24gdG8gY2hlY2tcbiAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gYHRydWUgYCBpZiB0aGUgZ2l2ZW4gd2lkdGggZGVmaW5pdGlvbiBpcyBgYXV0b2BcbiAgICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBpc0F1dG9EZWZpbmUod2lkdGgpIHtcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuKHdpZHRoICYmIHR5cGVvZiB3aWR0aCA9PT0gXCJzdHJpbmdcIiAmJiB3aWR0aC50b0xvd2VyQ2FzZSgpID09PSBcImF1dG9cIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIENyZWF0ZXMgYSBmb3JtdWxhIHRvIGNhbGN1bGF0ZSB0aGUgYXV0byB3aWR0aC5cbiAgICAgICAgICAgKiBAcGFyYW0ge0RyYXdHcmlkfSBncmlkIGdyaWQgaW5zdGFuY2VcbiAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBmb3JtdWxhXG4gICAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICAgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2NhbGNBdXRvQ29sV2lkdGhFeHByKGdyaWQpIHtcbiAgICAgICAgICAgIHZhciBzaG9ydENpcmN1aXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRydWU7XG4gICAgICAgICAgICB2YXIgZnVsbFdpZHRoID0gZ3JpZFtfXS5jYWxjV2lkdGhDb250ZXh0LmZ1bGw7XG4gICAgICAgICAgICB2YXIgc3VtTWluID0gMDtcbiAgICAgICAgICAgIHZhciBvdGhlcnMgPSBbXTtcbiAgICAgICAgICAgIHZhciBhdXRvQ291bnQgPSAwO1xuICAgICAgICAgICAgdmFyIGhhc0xpbWl0c09uQXV0byA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCBncmlkW19dLmNvbENvdW50OyBjb2wrKykge1xuICAgICAgICAgICAgICB2YXIgZGVmID0gX2dldENvbFdpZHRoRGVmaW5lKGdyaWQsIGNvbCk7XG5cbiAgICAgICAgICAgICAgdmFyIGxpbWl0cyA9IF9nZXRDb2xXaWR0aExpbWl0cyhncmlkLCBjb2wpO1xuXG4gICAgICAgICAgICAgIGlmIChpc0F1dG9EZWZpbmUoZGVmKSkge1xuICAgICAgICAgICAgICAgIGlmIChsaW1pdHMpIHtcbiAgICAgICAgICAgICAgICAgIGhhc0xpbWl0c09uQXV0by5wdXNoKGxpbWl0cyk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChsaW1pdHMubWluKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1bU1pbiArPSBsaW1pdHMubWluO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGF1dG9Db3VudCsrO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBleHByID0gZGVmO1xuXG4gICAgICAgICAgICAgICAgaWYgKGxpbWl0cykge1xuICAgICAgICAgICAgICAgICAgdmFyIG9yZ1dpZHRoID0gX3RvUHhXaWR0aChncmlkLCBleHByKTtcblxuICAgICAgICAgICAgICAgICAgdmFyIG5ld1dpZHRoID0gX2FwcGx5Q29sV2lkdGhMaW1pdHMobGltaXRzLCBvcmdXaWR0aCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChvcmdXaWR0aCAhPT0gbmV3V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZXhwciA9IFwiXCIuY29uY2F0KG5ld1dpZHRoLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBzdW1NaW4gKz0gbmV3V2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgb3RoZXJzLnB1c2goZXhwcik7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoc2hvcnRDaXJjdWl0ICYmIHN1bU1pbiA+IGZ1bGxXaWR0aCkge1xuICAgICAgICAgICAgICAgIC8vIFJldHVybnMgMHB4IGJlY2F1c2UgaXQgaGFzIGNvbnN1bWVkIHRoZSBmdWxsIHdpZHRoLlxuICAgICAgICAgICAgICAgIHJldHVybiBcIjBweFwiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChoYXNMaW1pdHNPbkF1dG8ubGVuZ3RoICYmIG90aGVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgdmFyIGF1dG9QeCA9IChmdWxsV2lkdGggLSBfdG9QeFdpZHRoKGdyaWQsIFwiY2FsYyhcIi5jb25jYXQob3RoZXJzLm1hcChmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYyA9PT0gXCJudW1iZXJcIiA/IFwiXCIuY29uY2F0KGMsIFwicHhcIikgOiBjO1xuICAgICAgICAgICAgICB9KS5qb2luKFwiICsgXCIpLCBcIilcIikpKSAvIGF1dG9Db3VudDtcbiAgICAgICAgICAgICAgaGFzTGltaXRzT25BdXRvLmZvckVhY2goZnVuY3Rpb24gKGxpbWl0cykge1xuICAgICAgICAgICAgICAgIGlmIChsaW1pdHMubWluICYmIGF1dG9QeCA8IGxpbWl0cy5taW4pIHtcbiAgICAgICAgICAgICAgICAgIG90aGVycy5wdXNoKGxpbWl0cy5taW5EZWYpO1xuICAgICAgICAgICAgICAgICAgYXV0b0NvdW50LS07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW1pdHMubWF4ICYmIGxpbWl0cy5tYXggPCBhdXRvUHgpIHtcbiAgICAgICAgICAgICAgICAgIG90aGVycy5wdXNoKGxpbWl0cy5tYXhEZWYpO1xuICAgICAgICAgICAgICAgICAgYXV0b0NvdW50LS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBpZiAoc2hvcnRDaXJjdWl0ICYmIGF1dG9Db3VudCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KGF1dG9QeCwgXCJweFwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3RoZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICB2YXIgc3RyRGVmcyA9IFtdO1xuICAgICAgICAgICAgICB2YXIgbnVtID0gMDtcbiAgICAgICAgICAgICAgb3RoZXJzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICAgIG51bSArPSBjO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBzdHJEZWZzLnB1c2goYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgc3RyRGVmcy5wdXNoKFwiXCIuY29uY2F0KG51bSwgXCJweFwiKSk7XG4gICAgICAgICAgICAgIHJldHVybiBcImNhbGMoKDEwMCUgLSAoXCIuY29uY2F0KHN0ckRlZnMuam9pbihcIiArIFwiKSwgXCIpKSAvIFwiKS5jb25jYXQoYXV0b0NvdW50LCBcIilcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gXCJcIi5jb25jYXQoMTAwIC8gYXV0b0NvdW50LCBcIiVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIENhbGN1bGF0ZSB0aGUgcGl4ZWxzIG9mIHdpZHRoIGZyb20gdGhlIGRlZmluaXRpb24gb2Ygd2lkdGguXG4gICAgICAgICAgICogQHBhcmFtIHtEcmF3R3JpZH0gZ3JpZCBncmlkIGluc3RhbmNlXG4gICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSB3aWR0aCB3aWR0aCBkZWZpbml0aW9uXG4gICAgICAgICAgICogQHJldHVybnMge251bWJlcn0gdGhlIHBpeGVscyBvZiB3aWR0aFxuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9jb2xXaWR0aERlZmluZVRvUHhXaWR0aChncmlkLCB3aWR0aCkge1xuICAgICAgICAgICAgaWYgKGlzQXV0b0RlZmluZSh3aWR0aCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90b1B4V2lkdGgoZ3JpZCwgX2NhbGNBdXRvQ29sV2lkdGhFeHByKGdyaWQpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF90b1B4V2lkdGgoZ3JpZCwgd2lkdGgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldENvbFdpZHRoKGdyaWQsIGNvbCkge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gX2dldENvbFdpZHRoRGVmaW5lKGdyaWQsIGNvbCk7XG5cbiAgICAgICAgICAgIHJldHVybiBfYWRqdXN0Q29sV2lkdGgoZ3JpZCwgY29sLCBfY29sV2lkdGhEZWZpbmVUb1B4V2lkdGgoZ3JpZCwgd2lkdGgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9zZXRDb2xXaWR0aChncmlkLCBjb2wsIHdpZHRoKSB7XG4gICAgICAgICAgICBpZiAod2lkdGggIT0gbnVsbCkge1xuICAgICAgICAgICAgICBncmlkW19dLmNvbFdpZHRoc01hcC5wdXQoY29sLCB3aWR0aCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBncmlkW19dLmNvbFdpZHRoc01hcC5yZW1vdmUoY29sKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgZGVmaW5pdGlvbiBvZiBhIGNvbHVtbiB3aG9zZSB3aWR0aCBpcyBzZXQgdG8gYGF1dG9gIHdpdGggdGhlIGN1cnJlbnQgYXV0byB3aWR0aCBmb3JtdWxhLlxuICAgICAgICAgICAqIEBwYXJhbSB7RHJhd0dyaWR9IGdyaWQgZ3JpZCBpbnN0YW5jZVxuICAgICAgICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9zdG9yZUF1dG9Db2xXaWR0aEV4cHJzKGdyaWQpIHtcbiAgICAgICAgICAgIHZhciBleHByID0gbnVsbDtcblxuICAgICAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgZ3JpZFtfXS5jb2xDb3VudDsgY29sKyspIHtcbiAgICAgICAgICAgICAgdmFyIGRlZiA9IF9nZXRDb2xXaWR0aERlZmluZShncmlkLCBjb2wpO1xuXG4gICAgICAgICAgICAgIGlmIChpc0F1dG9EZWZpbmUoZGVmKSkge1xuICAgICAgICAgICAgICAgIF9zZXRDb2xXaWR0aChncmlkLCBjb2wsIGV4cHIgfHwgKGV4cHIgPSBfY2FsY0F1dG9Db2xXaWR0aEV4cHIoZ3JpZCwgZmFsc2UpKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRDb2xzV2lkdGgoZ3JpZCwgc3RhcnRDb2wsIGVuZENvbCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRDb2xQeFdpZHRoID0gX2NvbFdpZHRoRGVmaW5lVG9QeFdpZHRoKGdyaWQsIGdyaWQuZGVmYXVsdENvbFdpZHRoKTtcblxuICAgICAgICAgICAgdmFyIGNvbENvdW50ID0gZW5kQ29sIC0gc3RhcnRDb2wgKyAxO1xuICAgICAgICAgICAgdmFyIHcgPSBkZWZhdWx0Q29sUHhXaWR0aCAqIGNvbENvdW50O1xuXG4gICAgICAgICAgICBncmlkW19dLmNvbFdpZHRoc01hcC5lYWNoKHN0YXJ0Q29sLCBlbmRDb2wsIGZ1bmN0aW9uICh3aWR0aCwgY29sKSB7XG4gICAgICAgICAgICAgIHcgKz0gX2FkanVzdENvbFdpZHRoKGdyaWQsIGNvbCwgX2NvbFdpZHRoRGVmaW5lVG9QeFdpZHRoKGdyaWQsIHdpZHRoKSkgLSBkZWZhdWx0Q29sUHhXaWR0aDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBjb2wgPSBzdGFydENvbDsgY29sIDw9IGVuZENvbDsgY29sKyspIHtcbiAgICAgICAgICAgICAgaWYgKGdyaWRbX10uY29sV2lkdGhzTWFwLmhhcyhjb2wpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgYWRqID0gX2FkanVzdENvbFdpZHRoKGdyaWQsIGNvbCwgZGVmYXVsdENvbFB4V2lkdGgpO1xuXG4gICAgICAgICAgICAgIGlmIChhZGogIT09IGRlZmF1bHRDb2xQeFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgdyArPSBhZGogLSBkZWZhdWx0Q29sUHhXaWR0aDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdztcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRSb3dIZWlnaHQocm93KSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJuYWwgPSB0aGlzLmdldFJvd0hlaWdodEludGVybmFsKHJvdyk7XG5cbiAgICAgICAgICAgIGlmIChpbnRlcm5hbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBpbnRlcm5hbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHRoaXNbX10ucm93SGVpZ2h0c01hcC5nZXQocm93KTtcblxuICAgICAgICAgICAgaWYgKGhlaWdodCkge1xuICAgICAgICAgICAgICByZXR1cm4gaGVpZ2h0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5kZWZhdWx0Um93SGVpZ2h0O1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX3NldFJvd0hlaWdodChncmlkLCByb3csIGhlaWdodCkge1xuICAgICAgICAgICAgaWYgKGhlaWdodCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIGdyaWRbX10ucm93SGVpZ2h0c01hcC5wdXQocm93LCBoZWlnaHQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZ3JpZFtfXS5yb3dIZWlnaHRzTWFwLnJlbW92ZShyb3cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldFJvd3NIZWlnaHQoc3RhcnRSb3csIGVuZFJvdykge1xuICAgICAgICAgICAgdmFyIF90aGlzNjMgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgaW50ZXJuYWwgPSB0aGlzLmdldFJvd3NIZWlnaHRJbnRlcm5hbChzdGFydFJvdywgZW5kUm93KTtcblxuICAgICAgICAgICAgaWYgKGludGVybmFsICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGludGVybmFsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcm93Q291bnQgPSBlbmRSb3cgLSBzdGFydFJvdyArIDE7XG4gICAgICAgICAgICB2YXIgaCA9IHRoaXNbX10uZGVmYXVsdFJvd0hlaWdodCAqIHJvd0NvdW50O1xuXG4gICAgICAgICAgICB0aGlzW19dLnJvd0hlaWdodHNNYXAuZWFjaChzdGFydFJvdywgZW5kUm93LCBmdW5jdGlvbiAoaGVpZ2h0KSB7XG4gICAgICAgICAgICAgIGggKz0gaGVpZ2h0IC0gX3RoaXM2M1tfXS5kZWZhdWx0Um93SGVpZ2h0O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBoO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldFNjcm9sbFdpZHRoKGdyaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBfZ2V0Q29sc1dpZHRoKGdyaWQsIDAsIGdyaWRbX10uY29sQ291bnQgLSAxKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRTY3JvbGxIZWlnaHQocm93KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM2NCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBpbnRlcm5hbCA9IHRoaXMuZ2V0U2Nyb2xsSGVpZ2h0SW50ZXJuYWwocm93KTtcblxuICAgICAgICAgICAgaWYgKGludGVybmFsICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGludGVybmFsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaCA9IHRoaXNbX10uZGVmYXVsdFJvd0hlaWdodCAqIHRoaXNbX10ucm93Q291bnQ7XG5cbiAgICAgICAgICAgIHRoaXNbX10ucm93SGVpZ2h0c01hcC5lYWNoKDAsIHRoaXNbX10ucm93Q291bnQgLSAxLCBmdW5jdGlvbiAoaGVpZ2h0KSB7XG4gICAgICAgICAgICAgIGggKz0gaGVpZ2h0IC0gX3RoaXM2NFtfXS5kZWZhdWx0Um93SGVpZ2h0O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBoO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX29uU2Nyb2xsKGdyaWQsIF9lKSB7XG4gICAgICAgICAgICB2YXIgbGFzdExlZnQgPSBncmlkW19dLnNjcm9sbC5sZWZ0O1xuICAgICAgICAgICAgdmFyIGxhc3RUb3AgPSBncmlkW19dLnNjcm9sbC50b3A7XG4gICAgICAgICAgICB2YXIgbW92ZVggPSBncmlkW19dLnNjcm9sbGFibGUuc2Nyb2xsTGVmdCAtIGxhc3RMZWZ0O1xuICAgICAgICAgICAgdmFyIG1vdmVZID0gZ3JpZFtfXS5zY3JvbGxhYmxlLnNjcm9sbFRvcCAtIGxhc3RUb3A7IC8v5qyh5Zue6KiI566X55So5oOF5aCx44KS5L+d5oyBXG5cbiAgICAgICAgICAgIGdyaWRbX10uc2Nyb2xsID0ge1xuICAgICAgICAgICAgICBsZWZ0OiBncmlkW19dLnNjcm9sbGFibGUuc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgICAgdG9wOiBncmlkW19dLnNjcm9sbGFibGUuc2Nyb2xsVG9wXG4gICAgICAgICAgICB9OyAvLyBJZiB0aGUgZm9jdXMgaXMgb24gdGhlIGhlYWRlciwgcmVjYWxjdWxhdGUgYW5kIG1vdmUgdGhlIGZvY3VzIHBvc2l0aW9uLlxuXG4gICAgICAgICAgICB2YXIgZm9jdXMgPSBncmlkW19dLnNlbGVjdGlvbi5mb2N1cztcbiAgICAgICAgICAgIHZhciBpc0Zyb3plbkNlbGwgPSBncmlkLmlzRnJvemVuQ2VsbChmb2N1cy5jb2wsIGZvY3VzLnJvdyk7XG5cbiAgICAgICAgICAgIGlmIChpc0Zyb3plbkNlbGwgJiYgKChpc0Zyb3plbkNlbGwgPT09IG51bGwgfHwgaXNGcm96ZW5DZWxsID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpc0Zyb3plbkNlbGwuY29sKSAmJiBtb3ZlWCB8fCAoaXNGcm96ZW5DZWxsID09PSBudWxsIHx8IGlzRnJvemVuQ2VsbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXNGcm96ZW5DZWxsLnJvdykgJiYgbW92ZVkpKSB7XG4gICAgICAgICAgICAgIGdyaWQuc2V0Rm9jdXNDdXJzb3IoZm9jdXMuY29sLCBmb2N1cy5yb3cpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdmlzaWJsZVJlY3QgPSBfZ2V0VmlzaWJsZVJlY3QoZ3JpZCk7XG5cbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb3ZlWCkgPj0gdmlzaWJsZVJlY3Qud2lkdGggfHwgTWF0aC5hYnMobW92ZVkpID49IHZpc2libGVSZWN0LmhlaWdodCkge1xuICAgICAgICAgICAgICAvL+WFqOWGjeaPj+eUu1xuICAgICAgICAgICAgICBfaW52YWxpZGF0ZVJlY3QoZ3JpZCwgdmlzaWJsZVJlY3QpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy/lt67liIblho3mj4/nlLtcbiAgICAgICAgICAgICAgZ3JpZFtfXS5jb250ZXh0LmRyYXdJbWFnZShncmlkW19dLmNhbnZhcywgLW1vdmVYLCAtbW92ZVkpO1xuXG4gICAgICAgICAgICAgIGlmIChtb3ZlWCAhPT0gMCkge1xuICAgICAgICAgICAgICAgIC8v5qiq56e75YuV44Gu5YaN5o+P55S756+E5Zuy44KS6KiI566XXG4gICAgICAgICAgICAgICAgdmFyIHJlZHJhd1JlY3QgPSB2aXNpYmxlUmVjdC5jb3B5KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAobW92ZVggPCAwKSB7XG4gICAgICAgICAgICAgICAgICByZWRyYXdSZWN0LndpZHRoID0gLW1vdmVYO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoZ3JpZFtfXS5mcm96ZW5Db2xDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy/lm7rlrprliJfjgYzjgYLjgovloLTlkIjlm7rlrprliJfliIbmj4/nlLtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZyb3plblJlY3QgPSBfZ2V0RnJvemVuQ29sc1JlY3QoZ3JpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVkcmF3UmVjdC53aWR0aCArPSBmcm96ZW5SZWN0LndpZHRoO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobW92ZVggPiAwKSB7XG4gICAgICAgICAgICAgICAgICByZWRyYXdSZWN0LmxlZnQgPSByZWRyYXdSZWN0LnJpZ2h0IC0gbW92ZVg7XG4gICAgICAgICAgICAgICAgfSAvL+WGjeaPj+eUu1xuXG5cbiAgICAgICAgICAgICAgICBfaW52YWxpZGF0ZVJlY3QoZ3JpZCwgcmVkcmF3UmVjdCk7XG5cbiAgICAgICAgICAgICAgICBpZiAobW92ZVggPiAwKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZ3JpZFtfXS5mcm96ZW5Db2xDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy/lm7rlrprliJfjgYzjgYLjgovloLTlkIjlm7rlrprliJfmj4/nlLtcbiAgICAgICAgICAgICAgICAgICAgX2ludmFsaWRhdGVSZWN0KGdyaWQsIF9nZXRGcm96ZW5Db2xzUmVjdChncmlkKSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKG1vdmVZICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgLy/nuKbnp7vli5Xjga7lho3mj4/nlLvnr4Tlm7LjgpLoqIjnrpdcbiAgICAgICAgICAgICAgICB2YXIgX3JlZHJhd1JlY3QgPSB2aXNpYmxlUmVjdC5jb3B5KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAobW92ZVkgPCAwKSB7XG4gICAgICAgICAgICAgICAgICBfcmVkcmF3UmVjdC5oZWlnaHQgPSAtbW92ZVk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChncmlkW19dLmZyb3plblJvd0NvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvL+WbuuWumuihjOOBjOOBguOCi+WgtOWQiOWbuuWumuihjOWIhuaPj+eUu1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2Zyb3plblJlY3QyID0gX2dldEZyb3plblJvd3NSZWN0KGdyaWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIF9yZWRyYXdSZWN0LmhlaWdodCArPSBfZnJvemVuUmVjdDIuaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobW92ZVkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICBfcmVkcmF3UmVjdC50b3AgPSBfcmVkcmF3UmVjdC5ib3R0b20gLSBtb3ZlWTtcbiAgICAgICAgICAgICAgICB9IC8v5YaN5o+P55S7XG5cblxuICAgICAgICAgICAgICAgIF9pbnZhbGlkYXRlUmVjdChncmlkLCBfcmVkcmF3UmVjdCk7XG5cbiAgICAgICAgICAgICAgICBpZiAobW92ZVkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZ3JpZFtfXS5mcm96ZW5Sb3dDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy/lm7rlrprooYzjgYzjgYLjgovloLTlkIjlm7rlrprooYzmj4/nlLtcbiAgICAgICAgICAgICAgICAgICAgX2ludmFsaWRhdGVSZWN0KGdyaWQsIF9nZXRGcm96ZW5Sb3dzUmVjdChncmlkKSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb21wbGV4aXR5XG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9vbktleURvd25Nb3ZlKGUpIHtcbiAgICAgICAgICAgIHZhciBfYSwgX2IsIF9jO1xuXG4gICAgICAgICAgICB2YXIga2V5Q29kZSA9IGdldEtleUNvZGUoZSk7XG4gICAgICAgICAgICB2YXIgZm9jdXNDZWxsID0gZS5zaGlmdEtleSA/IHRoaXMuc2VsZWN0aW9uLmZvY3VzIDogdGhpcy5zZWxlY3Rpb24uc2VsZWN0O1xuICAgICAgICAgICAgdmFyIGN0cmxPck1ldGEgPSBlLmN0cmxLZXkgfHwgZS5tZXRhS2V5O1xuXG4gICAgICAgICAgICBpZiAoa2V5Q29kZSA9PT0gS0VZX0xFRlQpIHtcbiAgICAgICAgICAgICAgaWYgKGUuYWx0S2V5KSByZXR1cm47IC8vIHVua25vd24gbW9kaWZpZXIga2V5XG5cbiAgICAgICAgICAgICAgaWYgKGN0cmxPck1ldGEpIHtcbiAgICAgICAgICAgICAgICBtb3ZlKHRoaXMsIG51bGwsIFwiV1wiLCBlLnNoaWZ0S2V5KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIWhNb3ZlLmNhbGwodGhpcywgXCJXXCIsIGUuc2hpZnRLZXkpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY2FuY2VsRXZlbnQoZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleUNvZGUgPT09IEtFWV9VUCkge1xuICAgICAgICAgICAgICBpZiAoZS5hbHRLZXkpIHJldHVybjsgLy8gdW5rbm93biBtb2RpZmllciBrZXlcblxuICAgICAgICAgICAgICBpZiAoY3RybE9yTWV0YSkge1xuICAgICAgICAgICAgICAgIG1vdmUodGhpcywgXCJOXCIsIG51bGwsIGUuc2hpZnRLZXkpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghdk1vdmUuY2FsbCh0aGlzLCBcIk5cIiwgZS5zaGlmdEtleSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBjYW5jZWxFdmVudChlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gS0VZX1JJR0hUKSB7XG4gICAgICAgICAgICAgIGlmIChlLmFsdEtleSkgcmV0dXJuOyAvLyB1bmtub3duIG1vZGlmaWVyIGtleVxuXG4gICAgICAgICAgICAgIGlmIChjdHJsT3JNZXRhKSB7XG4gICAgICAgICAgICAgICAgbW92ZSh0aGlzLCBudWxsLCBcIkVcIiwgZS5zaGlmdEtleSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCFoTW92ZS5jYWxsKHRoaXMsIFwiRVwiLCBlLnNoaWZ0S2V5KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBLRVlfRE9XTikge1xuICAgICAgICAgICAgICBpZiAoZS5hbHRLZXkpIHJldHVybjsgLy8gdW5rbm93biBtb2RpZmllciBrZXlcblxuICAgICAgICAgICAgICBpZiAoY3RybE9yTWV0YSkge1xuICAgICAgICAgICAgICAgIG1vdmUodGhpcywgXCJTXCIsIG51bGwsIGUuc2hpZnRLZXkpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghdk1vdmUuY2FsbCh0aGlzLCBcIlNcIiwgZS5zaGlmdEtleSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBjYW5jZWxFdmVudChlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gS0VZX0hPTUUpIHtcbiAgICAgICAgICAgICAgaWYgKGUuYWx0S2V5KSByZXR1cm47IC8vIHVua25vd24gbW9kaWZpZXIga2V5XG5cbiAgICAgICAgICAgICAgaWYgKGN0cmxPck1ldGEpIHtcbiAgICAgICAgICAgICAgICBtb3ZlKHRoaXMsIFwiTlwiLCBcIldcIiwgZS5zaGlmdEtleSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbW92ZSh0aGlzLCBudWxsLCBcIldcIiwgZS5zaGlmdEtleSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBjYW5jZWxFdmVudChlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gS0VZX0VORCkge1xuICAgICAgICAgICAgICBpZiAoZS5hbHRLZXkpIHJldHVybjsgLy8gdW5rbm93biBtb2RpZmllciBrZXlcblxuICAgICAgICAgICAgICBpZiAoY3RybE9yTWV0YSkge1xuICAgICAgICAgICAgICAgIG1vdmUodGhpcywgXCJTXCIsIFwiRVwiLCBlLnNoaWZ0S2V5KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtb3ZlKHRoaXMsIG51bGwsIFwiRVwiLCBlLnNoaWZ0S2V5KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoKF9hID0gdGhpcy5rZXlib2FyZE9wdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5tb3ZlQ2VsbE9uVGFiKSAmJiBrZXlDb2RlID09PSBLRVlfVEFCKSB7XG4gICAgICAgICAgICAgIGlmIChlLmFsdEtleSB8fCBjdHJsT3JNZXRhKSByZXR1cm47IC8vIHVua25vd24gbW9kaWZpZXIga2V5XG5cbiAgICAgICAgICAgICAgdmFyIG5ld0NlbGwgPSBudWxsO1xuXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5rZXlib2FyZE9wdGlvbnMubW92ZUNlbGxPblRhYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgbmV3Q2VsbCA9IHRoaXMua2V5Ym9hcmRPcHRpb25zLm1vdmVDZWxsT25UYWIoe1xuICAgICAgICAgICAgICAgICAgY2VsbDogZm9jdXNDZWxsLFxuICAgICAgICAgICAgICAgICAgZ3JpZDogdGhpcyxcbiAgICAgICAgICAgICAgICAgIGV2ZW50OiBlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAobmV3Q2VsbCkge1xuICAgICAgICAgICAgICAgIF9tb3ZlRm9jdXNDZWxsLmNhbGwodGhpcywgbmV3Q2VsbC5jb2wsIG5ld0NlbGwucm93LCBmYWxzZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgIGlmICghaE1vdmUuY2FsbCh0aGlzLCBcIldcIiwgZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgcm93ID0gdGhpcy5nZXRNb3ZlVXBSb3dCeUtleURvd25JbnRlcm5hbChmb2N1c0NlbGwpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoMCA+IHJvdykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIF9tb3ZlRm9jdXNDZWxsLmNhbGwodGhpcywgdGhpcy5jb2xDb3VudCAtIDEsIHJvdywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIWhNb3ZlLmNhbGwodGhpcywgXCJFXCIsIGZhbHNlKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIF9yb3czID0gdGhpcy5nZXRNb3ZlRG93blJvd0J5S2V5RG93bkludGVybmFsKGZvY3VzQ2VsbCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvd0NvdW50IDw9IF9yb3czKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX21vdmVGb2N1c0NlbGwuY2FsbCh0aGlzLCAwLCBfcm93MywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoKF9iID0gdGhpcy5rZXlib2FyZE9wdGlvbnMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5tb3ZlQ2VsbE9uRW50ZXIpICYmIGtleUNvZGUgPT09IEtFWV9FTlRFUikge1xuICAgICAgICAgICAgICBpZiAoZS5hbHRLZXkgfHwgY3RybE9yTWV0YSkgcmV0dXJuOyAvLyB1bmtub3duIG1vZGlmaWVyIGtleVxuXG4gICAgICAgICAgICAgIHZhciBfbmV3Q2VsbCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmtleWJvYXJkT3B0aW9ucy5tb3ZlQ2VsbE9uRW50ZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIF9uZXdDZWxsID0gdGhpcy5rZXlib2FyZE9wdGlvbnMubW92ZUNlbGxPbkVudGVyKHtcbiAgICAgICAgICAgICAgICAgIGNlbGw6IGZvY3VzQ2VsbCxcbiAgICAgICAgICAgICAgICAgIGdyaWQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgICBldmVudDogZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKF9uZXdDZWxsKSB7XG4gICAgICAgICAgICAgICAgX21vdmVGb2N1c0NlbGwuY2FsbCh0aGlzLCBfbmV3Q2VsbC5jb2wsIF9uZXdDZWxsLnJvdywgZmFsc2UpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXZNb3ZlLmNhbGwodGhpcywgXCJOXCIsIGZhbHNlKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IHRoaXMuZ2V0TW92ZUxlZnRDb2xCeUtleURvd25JbnRlcm5hbChmb2N1c0NlbGwpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoMCA+IGNvbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIF9tb3ZlRm9jdXNDZWxsLmNhbGwodGhpcywgY29sLCB0aGlzLnJvd0NvdW50IC0gMSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIXZNb3ZlLmNhbGwodGhpcywgXCJTXCIsIGZhbHNlKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIF9jb2wzID0gdGhpcy5nZXRNb3ZlUmlnaHRDb2xCeUtleURvd25JbnRlcm5hbChmb2N1c0NlbGwpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2xDb3VudCA8PSBfY29sMykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIF9tb3ZlRm9jdXNDZWxsLmNhbGwodGhpcywgX2NvbDMsIE1hdGgubWluKHRoaXMuZnJvemVuUm93Q291bnQsIHRoaXMucm93Q291bnQgLSAxKSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoKF9jID0gdGhpcy5rZXlib2FyZE9wdGlvbnMpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5zZWxlY3RBbGxPbkN0cmxBKSAmJiBrZXlDb2RlID09PSBLRVlfQUxQSEFfQSkge1xuICAgICAgICAgICAgICBpZiAoZS5hbHRLZXkgfHwgZS5zaGlmdEtleSkgcmV0dXJuOyAvLyB1bmtub3duIG1vZGlmaWVyIGtleVxuXG4gICAgICAgICAgICAgIGlmICghY3RybE9yTWV0YSkgcmV0dXJuO1xuICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbi5yYW5nZSA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgICAgY29sOiAwLFxuICAgICAgICAgICAgICAgICAgcm93OiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbmQ6IHtcbiAgICAgICAgICAgICAgICAgIGNvbDogdGhpcy5jb2xDb3VudCAtIDEsXG4gICAgICAgICAgICAgICAgICByb3c6IHRoaXMucm93Q291bnQgLSAxXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICAgICAgICAgICAgY2FuY2VsRXZlbnQoZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1vdmUoZ3JpZCwgdkRpciwgaERpciwgc2hpZnRLZXlGbGcpIHtcbiAgICAgICAgICAgICAgdmFyIHJvdyA9IHZEaXIgPT09IFwiU1wiID8gZ3JpZC5yb3dDb3VudCAtIDEgOiB2RGlyID09PSBcIk5cIiA/IDAgOiBmb2N1c0NlbGwucm93O1xuICAgICAgICAgICAgICB2YXIgY29sID0gaERpciA9PT0gXCJFXCIgPyBncmlkLmNvbENvdW50IC0gMSA6IGhEaXIgPT09IFwiV1wiID8gMCA6IGZvY3VzQ2VsbC5jb2w7XG5cbiAgICAgICAgICAgICAgX21vdmVGb2N1c0NlbGwuY2FsbChncmlkLCBjb2wsIHJvdywgc2hpZnRLZXlGbGcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB2TW92ZSh2RGlyLCBzaGlmdEtleUZsZykge1xuICAgICAgICAgICAgICB2YXIgY29sID0gZm9jdXNDZWxsLmNvbDtcbiAgICAgICAgICAgICAgdmFyIHJvdztcblxuICAgICAgICAgICAgICBpZiAodkRpciA9PT0gXCJTXCIpIHtcbiAgICAgICAgICAgICAgICByb3cgPSB0aGlzLmdldE1vdmVEb3duUm93QnlLZXlEb3duSW50ZXJuYWwoZm9jdXNDZWxsKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvd0NvdW50IDw9IHJvdykge1xuICAgICAgICAgICAgICAgICAgLy8gQXZvaWRzIHRoZSBwcm9ibGVtIG9mIHRoZSBzY3JvbGwgcG9zaXRpb24gYnJlYWtpbmcgZHVlIHRvIGEgZGVsYXllZCBzY3JvbGxpbmcgZXZlbnQgaWYgdXNlciBob2xkIGRvd24gdGhlIGFycm93IGtleXMuXG4gICAgICAgICAgICAgICAgICB0aGlzLm1ha2VWaXNpYmxlQ2VsbChjb2wsIHRoaXMucm93Q291bnQgLSAxKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcm93ID0gdGhpcy5nZXRNb3ZlVXBSb3dCeUtleURvd25JbnRlcm5hbChmb2N1c0NlbGwpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJvdyA8IDApIHtcbiAgICAgICAgICAgICAgICAgIC8vIEF2b2lkcyB0aGUgcHJvYmxlbSBvZiB0aGUgc2Nyb2xsIHBvc2l0aW9uIGJyZWFraW5nIGR1ZSB0byBhIGRlbGF5ZWQgc2Nyb2xsaW5nIGV2ZW50IGlmIHVzZXIgaG9sZCBkb3duIHRoZSBhcnJvdyBrZXlzLlxuICAgICAgICAgICAgICAgICAgdGhpcy5tYWtlVmlzaWJsZUNlbGwoY29sLCAwKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBfbW92ZUZvY3VzQ2VsbC5jYWxsKHRoaXMsIGNvbCwgcm93LCBzaGlmdEtleUZsZyk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhNb3ZlKGhEaXIsIHNoaWZ0S2V5RmxnKSB7XG4gICAgICAgICAgICAgIHZhciByb3cgPSBmb2N1c0NlbGwucm93O1xuICAgICAgICAgICAgICB2YXIgY29sO1xuXG4gICAgICAgICAgICAgIGlmIChoRGlyID09PSBcIkVcIikge1xuICAgICAgICAgICAgICAgIGNvbCA9IHRoaXMuZ2V0TW92ZVJpZ2h0Q29sQnlLZXlEb3duSW50ZXJuYWwoZm9jdXNDZWxsKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbENvdW50IDw9IGNvbCkge1xuICAgICAgICAgICAgICAgICAgLy8gQXZvaWRzIHRoZSBwcm9ibGVtIG9mIHRoZSBzY3JvbGwgcG9zaXRpb24gYnJlYWtpbmcgZHVlIHRvIGEgZGVsYXllZCBzY3JvbGxpbmcgZXZlbnQgaWYgdXNlciBob2xkIGRvd24gdGhlIGFycm93IGtleXMuXG4gICAgICAgICAgICAgICAgICB0aGlzLm1ha2VWaXNpYmxlQ2VsbCh0aGlzLmNvbENvdW50IC0gMSwgcm93KTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29sID0gdGhpcy5nZXRNb3ZlTGVmdENvbEJ5S2V5RG93bkludGVybmFsKGZvY3VzQ2VsbCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29sIDwgMCkge1xuICAgICAgICAgICAgICAgICAgLy8gQXZvaWRzIHRoZSBwcm9ibGVtIG9mIHRoZSBzY3JvbGwgcG9zaXRpb24gYnJlYWtpbmcgZHVlIHRvIGEgZGVsYXllZCBzY3JvbGxpbmcgZXZlbnQgaWYgdXNlciBob2xkIGRvd24gdGhlIGFycm93IGtleXMuXG4gICAgICAgICAgICAgICAgICB0aGlzLm1ha2VWaXNpYmxlQ2VsbCgwLCByb3cpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF9tb3ZlRm9jdXNDZWxsLmNhbGwodGhpcywgY29sLCByb3csIHNoaWZ0S2V5RmxnKTtcblxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9tb3ZlRm9jdXNDZWxsKGNvbCwgcm93LCBzaGlmdEtleSkge1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMuZ2V0T2Zmc2V0SW52YWxpZGF0ZUNlbGxzKCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGV4dGVuZFJhbmdlKHJhbmdlKSB7XG4gICAgICAgICAgICAgIGlmIChvZmZzZXQgPiAwKSB7XG4gICAgICAgICAgICAgICAgcmFuZ2Uuc3RhcnQuY29sIC09IG9mZnNldDtcbiAgICAgICAgICAgICAgICByYW5nZS5zdGFydC5yb3cgLT0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgIHJhbmdlLmVuZC5jb2wgKz0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgIHJhbmdlLmVuZC5yb3cgKz0gb2Zmc2V0O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHJhbmdlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYmVmb3JlUmFuZ2UgPSBleHRlbmRSYW5nZSh0aGlzLnNlbGVjdGlvbi5yYW5nZSk7XG4gICAgICAgICAgICB2YXIgYmVmb3JlUmVjdCA9IHRoaXMuZ2V0Q2VsbFJhbmdlUmVjdChiZWZvcmVSYW5nZSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uLl9zZXRGb2N1c0NlbGwoY29sLCByb3csIHNoaWZ0S2V5KTtcblxuICAgICAgICAgICAgdGhpcy5tYWtlVmlzaWJsZUNlbGwoY29sLCByb3cpO1xuICAgICAgICAgICAgdGhpcy5mb2N1c0NlbGwoY29sLCByb3cpO1xuICAgICAgICAgICAgdmFyIGFmdGVyUmFuZ2UgPSBleHRlbmRSYW5nZSh0aGlzLnNlbGVjdGlvbi5yYW5nZSk7XG4gICAgICAgICAgICB2YXIgYWZ0ZXJSZWN0ID0gdGhpcy5nZXRDZWxsUmFuZ2VSZWN0KGFmdGVyUmFuZ2UpO1xuXG4gICAgICAgICAgICBpZiAoYWZ0ZXJSZWN0LmludGVyc2VjdGlvbihiZWZvcmVSZWN0KSkge1xuICAgICAgICAgICAgICB2YXIgaW52YWxpZGF0ZVJlY3QgPSBSZWN0XzEuUmVjdC5tYXgoYWZ0ZXJSZWN0LCBiZWZvcmVSZWN0KTtcblxuICAgICAgICAgICAgICBfaW52YWxpZGF0ZVJlY3QodGhpcywgaW52YWxpZGF0ZVJlY3QpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX2ludmFsaWRhdGVSZWN0KHRoaXMsIGJlZm9yZVJlY3QpO1xuXG4gICAgICAgICAgICAgIF9pbnZhbGlkYXRlUmVjdCh0aGlzLCBhZnRlclJlY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZWRTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgZm9jdXNDb250cm9sID0gdGhpc1tfXS5mb2N1c0NvbnRyb2w7XG4gICAgICAgICAgICB2YXIgX3RoaXMkXyRzZWxlY3Rpb24kc2VsID0gdGhpc1tfXS5zZWxlY3Rpb24uc2VsZWN0LFxuICAgICAgICAgICAgICAgIHNlbENvbCA9IF90aGlzJF8kc2VsZWN0aW9uJHNlbC5jb2wsXG4gICAgICAgICAgICAgICAgc2VsUm93ID0gX3RoaXMkXyRzZWxlY3Rpb24kc2VsLnJvdztcbiAgICAgICAgICAgIHZhciByZXN1bHRzID0gdGhpcy5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLkVESVRBQkxFSU5QVVRfQ0VMTCwge1xuICAgICAgICAgICAgICBjb2w6IHNlbENvbCxcbiAgICAgICAgICAgICAgcm93OiBzZWxSb3dcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGVkaXRNb2RlID0gdXRpbHNfMS5hcnJheS5maW5kSW5kZXgocmVzdWx0cywgZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgICAgcmV0dXJuICEhdjtcbiAgICAgICAgICAgIH0pID49IDA7XG4gICAgICAgICAgICBmb2N1c0NvbnRyb2wuZWRpdE1vZGUgPSBlZGl0TW9kZTtcblxuICAgICAgICAgICAgaWYgKGVkaXRNb2RlKSB7XG4gICAgICAgICAgICAgIGZvY3VzQ29udHJvbC5zdG9yZUlucHV0U3RhdHVzKCk7XG4gICAgICAgICAgICAgIGZvY3VzQ29udHJvbC5zZXREZWZhdWx0SW5wdXRTdGF0dXMoKTtcbiAgICAgICAgICAgICAgdGhpcy5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLk1PRElGWV9TVEFUVVNfRURJVEFCTEVJTlBVVF9DRUxMLCB7XG4gICAgICAgICAgICAgICAgY29sOiBzZWxDb2wsXG4gICAgICAgICAgICAgICAgcm93OiBzZWxSb3csXG4gICAgICAgICAgICAgICAgaW5wdXQ6IGZvY3VzQ29udHJvbC5pbnB1dFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9nZXRNb3VzZUFic3RyYWN0UG9pbnQoZ3JpZCwgZXZ0KSB7XG4gICAgICAgICAgICB2YXIgZTtcblxuICAgICAgICAgICAgaWYgKGlzVG91Y2hFdmVudChldnQpKSB7XG4gICAgICAgICAgICAgIGUgPSBldnQuY2hhbmdlZFRvdWNoZXNbMF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlID0gZXZ0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY2xpZW50WCA9IGUuY2xpZW50WCB8fCBlLnBhZ2VYICsgd2luZG93LnNjcm9sbFg7XG4gICAgICAgICAgICB2YXIgY2xpZW50WSA9IGUuY2xpZW50WSB8fCBlLnBhZ2VZICsgd2luZG93LnNjcm9sbFk7XG5cbiAgICAgICAgICAgIHZhciByZWN0ID0gZ3JpZFtfXS5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgICAgIGlmIChyZWN0LnJpZ2h0IDw9IGNsaWVudFgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChyZWN0LmJvdHRvbSA8PSBjbGllbnRZKSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgeCA9IGNsaWVudFggLSByZWN0LmxlZnQgKyBncmlkW19dLnNjcm9sbC5sZWZ0O1xuICAgICAgICAgICAgdmFyIHkgPSBjbGllbnRZIC0gcmVjdC50b3AgKyBncmlkW19dLnNjcm9sbC50b3A7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgICB5OiB5XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2JpbmRFdmVudHMoKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29uc2lzdGVudC10aGlzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIF9ncmlkJF8gPSBncmlkW19dLFxuICAgICAgICAgICAgICAgIGhhbmRsZXIgPSBfZ3JpZCRfLmhhbmRsZXIsXG4gICAgICAgICAgICAgICAgZWxlbWVudCA9IF9ncmlkJF8uZWxlbWVudCxcbiAgICAgICAgICAgICAgICBzY3JvbGxhYmxlID0gX2dyaWQkXy5zY3JvbGxhYmxlO1xuXG4gICAgICAgICAgICB2YXIgZ2V0Q2VsbEV2ZW50QXJnc1NldCA9IGZ1bmN0aW9uIGdldENlbGxFdmVudEFyZ3NTZXQoZSkge1xuICAgICAgICAgICAgICB2YXIgYWJzdHJhY3RQb3MgPSBfZ2V0TW91c2VBYnN0cmFjdFBvaW50KGdyaWQsIGUpO1xuXG4gICAgICAgICAgICAgIGlmICghYWJzdHJhY3RQb3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgY2VsbCA9IGdyaWQuZ2V0Q2VsbEF0KGFic3RyYWN0UG9zLngsIGFic3RyYWN0UG9zLnkpO1xuXG4gICAgICAgICAgICAgIGlmIChjZWxsLmNvbCA8IDAgfHwgY2VsbC5yb3cgPCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIGFic3RyYWN0UG9zOiBhYnN0cmFjdFBvcyxcbiAgICAgICAgICAgICAgICAgIGNlbGw6IGNlbGxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIGV2ZW50QXJncyA9IHtcbiAgICAgICAgICAgICAgICBjb2w6IGNlbGwuY29sLFxuICAgICAgICAgICAgICAgIHJvdzogY2VsbC5yb3csXG4gICAgICAgICAgICAgICAgZXZlbnQ6IGVcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBhYnN0cmFjdFBvczogYWJzdHJhY3RQb3MsXG4gICAgICAgICAgICAgICAgY2VsbDogY2VsbCxcbiAgICAgICAgICAgICAgICBldmVudEFyZ3M6IGV2ZW50QXJnc1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGNhblJlc2l6ZUNvbHVtbiA9IGZ1bmN0aW9uIGNhblJlc2l6ZUNvbHVtbihjb2wpIHtcbiAgICAgICAgICAgICAgaWYgKGdyaWRbX10uZGlzYWJsZUNvbHVtblJlc2l6ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBsaW1pdCA9IGdyaWRbX10uY29sV2lkdGhzTGltaXRbY29sXTtcblxuICAgICAgICAgICAgICBpZiAoIWxpbWl0IHx8ICFsaW1pdC5taW4gfHwgIWxpbWl0Lm1heCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGxpbWl0Lm1heCAhPT0gbGltaXQubWluO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaGFuZGxlci5vbihlbGVtZW50LCBcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICB2YXIgZXZlbnRBcmdzU2V0ID0gZ2V0Q2VsbEV2ZW50QXJnc1NldChlKTtcbiAgICAgICAgICAgICAgdmFyIGFic3RyYWN0UG9zID0gZXZlbnRBcmdzU2V0LmFic3RyYWN0UG9zLFxuICAgICAgICAgICAgICAgICAgZXZlbnRBcmdzID0gZXZlbnRBcmdzU2V0LmV2ZW50QXJncztcblxuICAgICAgICAgICAgICBpZiAoIWFic3RyYWN0UG9zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGV2ZW50QXJncykge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLk1PVVNFRE9XTl9DRUxMLCBldmVudEFyZ3MpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHV0aWxzXzEuYXJyYXkuZmluZEluZGV4KHJlc3VsdHMsIGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gIXY7XG4gICAgICAgICAgICAgICAgfSkgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChnZXRNb3VzZUJ1dHRvbnMoZSkgIT09IDEgJiYgLy8gRm9yIG1vYmlsZSBzYWZhcmkuIElmIHdlIGRvIG5vdCBwb3N0LXByb2Nlc3MgaGVyZSwgdGhlIGtleWJvYXJkIHdpbGwgbm90IHN0YXJ0IGluIE1vYmlsZSBTYWZhcmkuXG4gICAgICAgICAgICAgIGUuYnV0dG9ucyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciByZXNpemVDb2wgPSBfZ2V0UmVzaXplQ29sQXQoZ3JpZCwgYWJzdHJhY3RQb3MueCwgYWJzdHJhY3RQb3MueSk7XG5cbiAgICAgICAgICAgICAgaWYgKHJlc2l6ZUNvbCA+PSAwICYmIGNhblJlc2l6ZUNvbHVtbihyZXNpemVDb2wpKSB7XG4gICAgICAgICAgICAgICAgLy/luYXlpInmm7RcbiAgICAgICAgICAgICAgICBncmlkW19dLmNvbHVtblJlc2l6ZXIuc3RhcnQocmVzaXplQ29sLCBlKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL+mBuOaKnlxuICAgICAgICAgICAgICAgIGdyaWRbX10uY2VsbFNlbGVjdG9yLnN0YXJ0KGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGhhbmRsZXIub24oZWxlbWVudCwgXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGlmICghZ3JpZC5oYXNMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuTU9VU0VVUF9DRUxMKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBfZ2V0Q2VsbEV2ZW50QXJnc1NldCA9IGdldENlbGxFdmVudEFyZ3NTZXQoZSksXG4gICAgICAgICAgICAgICAgICBldmVudEFyZ3MgPSBfZ2V0Q2VsbEV2ZW50QXJnc1NldC5ldmVudEFyZ3M7XG5cbiAgICAgICAgICAgICAgaWYgKGV2ZW50QXJncykge1xuICAgICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5NT1VTRVVQX0NFTEwsIGV2ZW50QXJncyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGRvdWJsZVRhcEJlZm9yZSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgbG9uZ1RvdWNoSWQgPSBudWxsO1xuICAgICAgICAgICAgdmFyIHVzZVRvdWNoID0gbnVsbDtcblxuICAgICAgICAgICAgZnVuY3Rpb24gdXNlVG91Y2hTdGFydCgpIHtcbiAgICAgICAgICAgICAgaWYgKCh1c2VUb3VjaCA9PT0gbnVsbCB8fCB1c2VUb3VjaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlVG91Y2gudGltZW91dElkKSAhPSBudWxsKSBjbGVhclRpbWVvdXQodXNlVG91Y2gudGltZW91dElkKTtcbiAgICAgICAgICAgICAgdXNlVG91Y2ggPSB7fTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gdXNlVG91Y2hFbmQoKSB7XG4gICAgICAgICAgICAgIGlmICh1c2VUb3VjaCkge1xuICAgICAgICAgICAgICAgIGlmICh1c2VUb3VjaC50aW1lb3V0SWQgIT0gbnVsbCkgY2xlYXJUaW1lb3V0KHVzZVRvdWNoLnRpbWVvdXRJZCk7XG4gICAgICAgICAgICAgICAgdXNlVG91Y2gudGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB1c2VUb3VjaCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfSwgMzUwKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBoYW5kbGVyLm9uKGVsZW1lbnQsIFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAvLyBTaW5jZSBpdCBpcyBhbiBlbnZpcm9ubWVudCB3aGVyZSB0b3VjaCBzdGFydCBjYW4gYmUgdXNlZCwgaXQgYmxvY2tzIG1vdXNlbW92ZSB0aGF0IG9jY3VycyBhZnRlciB0aGlzLlxuICAgICAgICAgICAgICB1c2VUb3VjaFN0YXJ0KCk7XG5cbiAgICAgICAgICAgICAgdmFyIF9nZXRDZWxsRXZlbnRBcmdzU2V0MiA9IGdldENlbGxFdmVudEFyZ3NTZXQoZSksXG4gICAgICAgICAgICAgICAgICBldmVudEFyZ3MgPSBfZ2V0Q2VsbEV2ZW50QXJnc1NldDIuZXZlbnRBcmdzO1xuXG4gICAgICAgICAgICAgIGlmIChldmVudEFyZ3MpIHtcbiAgICAgICAgICAgICAgICBncmlkLmZpcmVMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuVE9VQ0hTVEFSVF9DRUxMLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCFkb3VibGVUYXBCZWZvcmUpIHtcbiAgICAgICAgICAgICAgICBkb3VibGVUYXBCZWZvcmUgPSBldmVudEFyZ3M7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBkb3VibGVUYXBCZWZvcmUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0sIDM1MCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50QXJncyAmJiBldmVudEFyZ3MuY29sID09PSBkb3VibGVUYXBCZWZvcmUuY29sICYmIGV2ZW50QXJncy5yb3cgPT09IGRvdWJsZVRhcEJlZm9yZS5yb3cpIHtcbiAgICAgICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5EQkxUQVBfQ0VMTCwgZXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkb3VibGVUYXBCZWZvcmUgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgaWYgKGUuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChlLnRhcmdldFRvdWNoZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRvdWNoc3RhcnQgd2l0aCBtdWx0aXBsZSBmaW5nZXJzLFxuICAgICAgICAgICAgICAgIC8vIGl0IGlzIG5vdCBjb25zaWRlcmVkIGFzIGFuIG9wZXJhdGlvbiBldmVudC5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBsb25nVG91Y2hJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8v6ZW35oq844GX44GX44Gf5aC05ZCI6YG45oqe44Oi44O844OJXG4gICAgICAgICAgICAgICAgbG9uZ1RvdWNoSWQgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFic3RyYWN0UG9zID0gX2dldE1vdXNlQWJzdHJhY3RQb2ludChncmlkLCBlKTtcblxuICAgICAgICAgICAgICAgIGlmICghYWJzdHJhY3RQb3MpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVzaXplQ29sID0gX2dldFJlc2l6ZUNvbEF0KGdyaWQsIGFic3RyYWN0UG9zLngsIGFic3RyYWN0UG9zLnksIDE1KTtcblxuICAgICAgICAgICAgICAgIGlmIChyZXNpemVDb2wgPj0gMCAmJiBjYW5SZXNpemVDb2x1bW4ocmVzaXplQ29sKSkge1xuICAgICAgICAgICAgICAgICAgLy/luYXlpInmm7RcbiAgICAgICAgICAgICAgICAgIGdyaWRbX10uY29sdW1uUmVzaXplci5zdGFydChyZXNpemVDb2wsIGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvL+mBuOaKnlxuICAgICAgICAgICAgICAgICAgZ3JpZFtfXS5jZWxsU2VsZWN0b3Iuc3RhcnQoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbChfZSkge1xuICAgICAgICAgICAgICBpZiAobG9uZ1RvdWNoSWQpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobG9uZ1RvdWNoSWQpO1xuICAgICAgICAgICAgICAgIGxvbmdUb3VjaElkID0gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBoYW5kbGVyLm9uKGVsZW1lbnQsIFwidG91Y2hjYW5jZWxcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgY2FuY2VsKGUpO1xuICAgICAgICAgICAgICB1c2VUb3VjaEVuZCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoYW5kbGVyLm9uKGVsZW1lbnQsIFwidG91Y2htb3ZlXCIsIGNhbmNlbCk7XG4gICAgICAgICAgICBoYW5kbGVyLm9uKGVsZW1lbnQsIFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgdXNlVG91Y2hFbmQoKTtcblxuICAgICAgICAgICAgICBpZiAobG9uZ1RvdWNoSWQpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobG9uZ1RvdWNoSWQpO1xuXG4gICAgICAgICAgICAgICAgZ3JpZFtfXS5jZWxsU2VsZWN0b3Iuc2VsZWN0KGUpO1xuXG4gICAgICAgICAgICAgICAgbG9uZ1RvdWNoSWQgPSBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBpc01vdXNlb3ZlciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIG1vdXNlRW50ZXJDZWxsID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBtb3VzZU92ZXJDZWxsID0gbnVsbDtcblxuICAgICAgICAgICAgZnVuY3Rpb24gb25Nb3VzZWVudGVyQ2VsbChjZWxsLCBwcm9wcykge1xuICAgICAgICAgICAgICBncmlkLmZpcmVMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuTU9VU0VFTlRFUl9DRUxMLCBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHByb3BzKSwge1xuICAgICAgICAgICAgICAgIGNvbDogY2VsbC5jb2wsXG4gICAgICAgICAgICAgICAgcm93OiBjZWxsLnJvd1xuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIG1vdXNlRW50ZXJDZWxsID0gY2VsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gb25Nb3VzZWxlYXZlQ2VsbChwcm9wcykge1xuICAgICAgICAgICAgICB2YXIgYmVmb3JlTW91c2VDZWxsID0gbW91c2VFbnRlckNlbGw7XG4gICAgICAgICAgICAgIG1vdXNlRW50ZXJDZWxsID0gbnVsbDtcblxuICAgICAgICAgICAgICBpZiAoYmVmb3JlTW91c2VDZWxsKSB7XG4gICAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLk1PVVNFTEVBVkVfQ0VMTCwgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBwcm9wcyksIHtcbiAgICAgICAgICAgICAgICAgIGNvbDogYmVmb3JlTW91c2VDZWxsLmNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdzogYmVmb3JlTW91c2VDZWxsLnJvd1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBiZWZvcmVNb3VzZUNlbGwgfHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk1vdXNlb3ZlckNlbGwoY2VsbCwgcHJvcHMpIHtcbiAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLk1PVVNFT1ZFUl9DRUxMLCBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHByb3BzKSwge1xuICAgICAgICAgICAgICAgIGNvbDogY2VsbC5jb2wsXG4gICAgICAgICAgICAgICAgcm93OiBjZWxsLnJvd1xuICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIG1vdXNlT3ZlckNlbGwgPSBjZWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk1vdXNlb3V0Q2VsbChwcm9wcykge1xuICAgICAgICAgICAgICB2YXIgYmVmb3JlTW91c2VDZWxsID0gbW91c2VPdmVyQ2VsbDtcbiAgICAgICAgICAgICAgbW91c2VPdmVyQ2VsbCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgaWYgKGJlZm9yZU1vdXNlQ2VsbCkge1xuICAgICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5NT1VTRU9VVF9DRUxMLCBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHByb3BzKSwge1xuICAgICAgICAgICAgICAgICAgY29sOiBiZWZvcmVNb3VzZUNlbGwuY29sLFxuICAgICAgICAgICAgICAgICAgcm93OiBiZWZvcmVNb3VzZUNlbGwucm93XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGJlZm9yZU1vdXNlQ2VsbCB8fCB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzY3JvbGxFbGVtZW50ID0gc2Nyb2xsYWJsZS5nZXRFbGVtZW50KCk7XG4gICAgICAgICAgICBoYW5kbGVyLm9uKHNjcm9sbEVsZW1lbnQsIFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChfZSkge1xuICAgICAgICAgICAgICBpc01vdXNlb3ZlciA9IHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGhhbmRsZXIub24oc2Nyb2xsRWxlbWVudCwgXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgaXNNb3VzZW92ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgb25Nb3VzZW91dENlbGwoe1xuICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGFuZGxlci5vbihlbGVtZW50LCBcIm1vdXNlbGVhdmVcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgIG9uTW91c2VsZWF2ZUNlbGwoe1xuICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGFuZGxlci5vbihlbGVtZW50LCBcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICBpZiAodXNlVG91Y2gpIHtcbiAgICAgICAgICAgICAgICAvLyBQcm9iYWJseSBhIG1vdXNlbW92ZSBldmVudCB0cmlnZ2VyZWQgYnkgYSB0b3VjaHN0YXJ0LiBUaGVyZWZvcmUsIHRoaXMgZXZlbnQgaXMgYmxvY2tlZC5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgZXZlbnRBcmdzU2V0ID0gZ2V0Q2VsbEV2ZW50QXJnc1NldChlKTtcbiAgICAgICAgICAgICAgdmFyIGFic3RyYWN0UG9zID0gZXZlbnRBcmdzU2V0LmFic3RyYWN0UG9zLFxuICAgICAgICAgICAgICAgICAgZXZlbnRBcmdzID0gZXZlbnRBcmdzU2V0LmV2ZW50QXJncztcblxuICAgICAgICAgICAgICBpZiAoZXZlbnRBcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJlZm9yZU1vdXNlQ2VsbCA9IG1vdXNlRW50ZXJDZWxsO1xuXG4gICAgICAgICAgICAgICAgaWYgKGJlZm9yZU1vdXNlQ2VsbCkge1xuICAgICAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLk1PVVNFTU9WRV9DRUxMLCBldmVudEFyZ3MpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoYmVmb3JlTW91c2VDZWxsLmNvbCAhPT0gZXZlbnRBcmdzLmNvbCB8fCBiZWZvcmVNb3VzZUNlbGwucm93ICE9PSBldmVudEFyZ3Mucm93KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbnRlckNlbGwgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBldmVudEFyZ3MuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogZXZlbnRBcmdzLnJvd1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3V0Q2VsbCA9IG9uTW91c2VvdXRDZWxsKHtcbiAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkOiBlbnRlckNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsZWF2ZUNlbGwgPSBvbk1vdXNlbGVhdmVDZWxsKHtcbiAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkOiBlbnRlckNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VlbnRlckNlbGwoZW50ZXJDZWxsLCB7XG4gICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZDogbGVhdmVDZWxsLFxuICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc01vdXNlb3Zlcikge1xuICAgICAgICAgICAgICAgICAgICAgIG9uTW91c2VvdmVyQ2VsbChlbnRlckNlbGwsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWQ6IG91dENlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZVxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzTW91c2VvdmVyICYmICFtb3VzZU92ZXJDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VvdmVyQ2VsbCh7XG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBldmVudEFyZ3MuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogZXZlbnRBcmdzLnJvd1xuICAgICAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfZW50ZXJDZWxsID0ge1xuICAgICAgICAgICAgICAgICAgICBjb2w6IGV2ZW50QXJncy5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogZXZlbnRBcmdzLnJvd1xuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIG9uTW91c2VlbnRlckNlbGwoX2VudGVyQ2VsbCwge1xuICAgICAgICAgICAgICAgICAgICBldmVudDogZVxuICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChpc01vdXNlb3Zlcikge1xuICAgICAgICAgICAgICAgICAgICBvbk1vdXNlb3ZlckNlbGwoX2VudGVyQ2VsbCwge1xuICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBncmlkLmZpcmVMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuTU9VU0VNT1ZFX0NFTEwsIGV2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9uTW91c2VvdXRDZWxsKHtcbiAgICAgICAgICAgICAgICAgIGV2ZW50OiBlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgb25Nb3VzZWxlYXZlQ2VsbCh7XG4gICAgICAgICAgICAgICAgICBldmVudDogZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGdyaWRbX10uY29sdW1uUmVzaXplci5tb3ZpbmcoZSkgfHwgZ3JpZFtfXS5jZWxsU2VsZWN0b3IubW92aW5nKGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gZWxlbWVudC5zdHlsZTtcblxuICAgICAgICAgICAgICBpZiAoIWFic3RyYWN0UG9zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlLmN1cnNvciA9PT0gXCJjb2wtcmVzaXplXCIpIHtcbiAgICAgICAgICAgICAgICAgIHN0eWxlLmN1cnNvciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIHJlc2l6ZUNvbCA9IF9nZXRSZXNpemVDb2xBdChncmlkLCBhYnN0cmFjdFBvcy54LCBhYnN0cmFjdFBvcy55KTtcblxuICAgICAgICAgICAgICBpZiAocmVzaXplQ29sID49IDAgJiYgY2FuUmVzaXplQ29sdW1uKHJlc2l6ZUNvbCkpIHtcbiAgICAgICAgICAgICAgICBzdHlsZS5jdXJzb3IgPSBcImNvbC1yZXNpemVcIjtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUuY3Vyc29yID09PSBcImNvbC1yZXNpemVcIikge1xuICAgICAgICAgICAgICAgICAgc3R5bGUuY3Vyc29yID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGFuZGxlci5vbihlbGVtZW50LCBcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGlmIChncmlkW19dLmNvbHVtblJlc2l6ZXIubGFzdE1vdmluZyhlKSB8fCBncmlkW19dLmNlbGxTZWxlY3Rvci5sYXN0TW92aW5nKGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCFncmlkLmhhc0xpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5DTElDS19DRUxMKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBfZ2V0Q2VsbEV2ZW50QXJnc1NldDMgPSBnZXRDZWxsRXZlbnRBcmdzU2V0KGUpLFxuICAgICAgICAgICAgICAgICAgZXZlbnRBcmdzID0gX2dldENlbGxFdmVudEFyZ3NTZXQzLmV2ZW50QXJncztcblxuICAgICAgICAgICAgICBpZiAoIWV2ZW50QXJncykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5DTElDS19DRUxMLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoYW5kbGVyLm9uKGVsZW1lbnQsIFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgaWYgKCFncmlkLmhhc0xpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5DT05URVhUTUVOVV9DRUxMKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBfZ2V0Q2VsbEV2ZW50QXJnc1NldDQgPSBnZXRDZWxsRXZlbnRBcmdzU2V0KGUpLFxuICAgICAgICAgICAgICAgICAgZXZlbnRBcmdzID0gX2dldENlbGxFdmVudEFyZ3NTZXQ0LmV2ZW50QXJncztcblxuICAgICAgICAgICAgICBpZiAoIWV2ZW50QXJncykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5DT05URVhUTUVOVV9DRUxMLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoYW5kbGVyLm9uKGVsZW1lbnQsIFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgaWYgKCFncmlkLmhhc0xpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5EQkxDTElDS19DRUxMKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBfZ2V0Q2VsbEV2ZW50QXJnc1NldDUgPSBnZXRDZWxsRXZlbnRBcmdzU2V0KGUpLFxuICAgICAgICAgICAgICAgICAgZXZlbnRBcmdzID0gX2dldENlbGxFdmVudEFyZ3NTZXQ1LmV2ZW50QXJncztcblxuICAgICAgICAgICAgICBpZiAoIWV2ZW50QXJncykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5EQkxDTElDS19DRUxMLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdyaWRbX10uZm9jdXNDb250cm9sLm9uS2V5RG93bihmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgICAgICAgIGdyaWQuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5LRVlET1dOLCBldnQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdyaWRbX10uc2VsZWN0aW9uLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5TRUxFQ1RFRF9DRUxMLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICBncmlkLmZpcmVMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuU0VMRUNURURfQ0VMTCwgZGF0YSwgZGF0YS5zZWxlY3RlZCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2Nyb2xsYWJsZS5vblNjcm9sbChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICBfb25TY3JvbGwoZ3JpZCwgZSk7XG5cbiAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLlNDUk9MTCwge1xuICAgICAgICAgICAgICAgIGV2ZW50OiBlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdyaWRbX10uZm9jdXNDb250cm9sLm9uS2V5RG93bk1vdmUoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgX29uS2V5RG93bk1vdmUuY2FsbChncmlkLCBlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBncmlkLmxpc3RlbihcImNvcHlkYXRhXCIsIGZ1bmN0aW9uIChyYW5nZSkge1xuICAgICAgICAgICAgICB2YXIgY29weVJhbmdlID0gZ3JpZC5nZXRDb3B5UmFuZ2VJbnRlcm5hbChyYW5nZSk7XG4gICAgICAgICAgICAgIHZhciBjb3B5TGluZXMgPSBbXTtcblxuICAgICAgICAgICAgICBmb3IgKHZhciByb3cgPSBjb3B5UmFuZ2Uuc3RhcnQucm93OyByb3cgPD0gY29weVJhbmdlLmVuZC5yb3c7IHJvdysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvcHlMaW5lID0gXCJcIjtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGNvbCA9IGNvcHlSYW5nZS5zdGFydC5jb2w7IGNvbCA8PSBjb3B5UmFuZ2UuZW5kLmNvbDsgY29sKyspIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjb3B5Q2VsbFZhbHVlID0gZ3JpZC5nZXRDb3B5Q2VsbFZhbHVlKGNvbCwgcm93LCBjb3B5UmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgdmFyIHN0ckNlbGxWYWx1ZSA9IHZvaWQgMDtcblxuICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb3B5Q2VsbFZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ckNlbGxWYWx1ZSA9IGNvcHlDZWxsVmFsdWU7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvcHlDZWxsVmFsdWUgPT0gbnVsbCB8fCAvLyBBc3luY2hyb25vdXMgZGF0YSBpcyB0cmVhdGVkIGFzIGVtcHR5LlxuICAgICAgICAgICAgICAgICAgdHlwZW9mIFByb21pc2UgIT09IFwidW5kZWZpbmVkXCIgJiYgY29weUNlbGxWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyQ2VsbFZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvcmVzdHJpY3QtdGVtcGxhdGUtZXhwcmVzc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgc3RyQ2VsbFZhbHVlID0gXCJcIi5jb25jYXQoY29weUNlbGxWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKC9eXFxbb2JqZWN0IC4qXFxdJC8uZXhlYyhzdHJDZWxsVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIG1heWJlIG9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgIHN0ckNlbGxWYWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgY29weUxpbmUgKz0gL1tcXHRcXG5dLy50ZXN0KHN0ckNlbGxWYWx1ZSkgPyAvLyBOZWVkIHF1b3RlXG4gICAgICAgICAgICAgICAgICBcIlxcXCJcIi5jb25jYXQoc3RyQ2VsbFZhbHVlLnJlcGxhY2UoL1wiL2csICdcIlwiJyksIFwiXFxcIlwiKSA6IHN0ckNlbGxWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGNvbCA8IGNvcHlSYW5nZS5lbmQuY29sKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvcHlMaW5lICs9IFwiXFx0XCI7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29weUxpbmVzLnB1c2goY29weUxpbmUpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGNvcHlMaW5lcy5qb2luKFwiXFxuXCIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdyaWRbX10uZm9jdXNDb250cm9sLm9uQ29weShmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHV0aWxzXzEuYXJyYXkuZmluZChncmlkLmZpcmVMaXN0ZW5lcnMoXCJjb3B5ZGF0YVwiLCBncmlkW19dLnNlbGVjdGlvbi5yYW5nZSksIGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHIgIT0gbnVsbDtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ3JpZFtfXS5mb2N1c0NvbnRyb2wub25QYXN0ZShmdW5jdGlvbiAoX3JlZjUxKSB7XG4gICAgICAgICAgICAgIHZhciB2YWx1ZSA9IF9yZWY1MS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgIGV2ZW50ID0gX3JlZjUxLmV2ZW50O1xuICAgICAgICAgICAgICB2YXIgdHJpbU9uUGFzdGUgPSBncmlkLnRyaW1PblBhc3RlO1xuICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplZFZhbHVlID0gKDAsIHBhc3RlX3V0aWxzXzEubm9ybWFsaXplUGFzdGVWYWx1ZSkodmFsdWUpO1xuICAgICAgICAgICAgICB2YXIgX2dyaWQkXyRzZWxlY3Rpb24kc2VsID0gZ3JpZFtfXS5zZWxlY3Rpb24uc2VsZWN0LFxuICAgICAgICAgICAgICAgICAgY29sID0gX2dyaWQkXyRzZWxlY3Rpb24kc2VsLmNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdyA9IF9ncmlkJF8kc2VsZWN0aW9uJHNlbC5yb3c7XG4gICAgICAgICAgICAgIHZhciBtdWx0aSA9IC9bXFxyXFxuXFx1MjAyOFxcdTIwMjlcXHRdLy50ZXN0KG5vcm1hbGl6ZWRWYWx1ZSk7IC8vIGlzIG11bHRpIGNlbGwgdmFsdWVzXG5cbiAgICAgICAgICAgICAgdmFyIHJhbmdlQm94VmFsdWVzID0gbnVsbDtcbiAgICAgICAgICAgICAgdmFyIHBhc3RlQ2VsbEV2ZW50ID0ge1xuICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgIHJvdzogcm93LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICBub3JtYWxpemVWYWx1ZTogdHJpbU9uUGFzdGUgPyBub3JtYWxpemVkVmFsdWUudHJpbSgpIDogbm9ybWFsaXplZFZhbHVlLFxuICAgICAgICAgICAgICAgIG11bHRpOiBtdWx0aSxcblxuICAgICAgICAgICAgICAgIGdldCByYW5nZUJveFZhbHVlcygpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByYW5nZUJveFZhbHVlcyAhPT0gbnVsbCAmJiByYW5nZUJveFZhbHVlcyAhPT0gdm9pZCAwID8gcmFuZ2VCb3hWYWx1ZXMgOiByYW5nZUJveFZhbHVlcyA9ICgwLCBwYXN0ZV91dGlsc18xLnBhcnNlUGFzdGVSYW5nZUJveFZhbHVlcykobm9ybWFsaXplZFZhbHVlLCB7XG4gICAgICAgICAgICAgICAgICAgIHRyaW1PblBhc3RlOiB0cmltT25QYXN0ZVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICBncmlkLmZpcmVMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuUEFTVEVfQ0VMTCwgcGFzdGVDZWxsRXZlbnQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdyaWRbX10uZm9jdXNDb250cm9sLm9uSW5wdXQoZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgIHZhciBfZ3JpZCRfJHNlbGVjdGlvbiRzZWwyID0gZ3JpZFtfXS5zZWxlY3Rpb24uc2VsZWN0LFxuICAgICAgICAgICAgICAgICAgY29sID0gX2dyaWQkXyRzZWxlY3Rpb24kc2VsMi5jb2wsXG4gICAgICAgICAgICAgICAgICByb3cgPSBfZ3JpZCRfJHNlbGVjdGlvbiRzZWwyLnJvdztcbiAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLklOUFVUX0NFTEwsIHtcbiAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICByb3c6IHJvdyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ3JpZFtfXS5mb2N1c0NvbnRyb2wub25EZWxldGUoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgIHZhciBfZ3JpZCRfJHNlbGVjdGlvbiRzZWwzID0gZ3JpZFtfXS5zZWxlY3Rpb24uc2VsZWN0LFxuICAgICAgICAgICAgICAgICAgY29sID0gX2dyaWQkXyRzZWxlY3Rpb24kc2VsMy5jb2wsXG4gICAgICAgICAgICAgICAgICByb3cgPSBfZ3JpZCRfJHNlbGVjdGlvbiRzZWwzLnJvdztcbiAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLkRFTEVURV9DRUxMLCB7XG4gICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgcm93OiByb3csXG4gICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdyaWRbX10uZm9jdXNDb250cm9sLm9uRm9jdXMoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLkZPQ1VTX0dSSUQsIGUpO1xuICAgICAgICAgICAgICBncmlkW19dLmZvY3VzZWRHcmlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgdmFyIF9ncmlkJF8kc2VsZWN0aW9uJHNlbDQgPSBncmlkW19dLnNlbGVjdGlvbi5zZWxlY3QsXG4gICAgICAgICAgICAgICAgICBjb2wgPSBfZ3JpZCRfJHNlbGVjdGlvbiRzZWw0LmNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdyA9IF9ncmlkJF8kc2VsZWN0aW9uJHNlbDQucm93O1xuICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGVDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBncmlkW19dLmZvY3VzQ29udHJvbC5vbkJsdXIoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZ3JpZC5maXJlTGlzdGVuZXJzKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLkJMVVJfR1JJRCwgZSk7XG4gICAgICAgICAgICAgIGdyaWRbX10uZm9jdXNlZEdyaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgdmFyIF9ncmlkJF8kc2VsZWN0aW9uJHNlbDUgPSBncmlkW19dLnNlbGVjdGlvbi5zZWxlY3QsXG4gICAgICAgICAgICAgICAgICBjb2wgPSBfZ3JpZCRfJHNlbGVjdGlvbiRzZWw1LmNvbCxcbiAgICAgICAgICAgICAgICAgIHJvdyA9IF9ncmlkJF8kc2VsZWN0aW9uJHNlbDUucm93O1xuICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGVDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gX2dldFJlc2l6ZUNvbEF0KGdyaWQsIGFic3RyYWN0WCwgYWJzdHJhY3RZKSB7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiA1O1xuXG4gICAgICAgICAgICBpZiAoZ3JpZFtfXS5mcm96ZW5Sb3dDb3VudCA8PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGZyb3plblJlY3QgPSBfZ2V0RnJvemVuUm93c1JlY3QoZ3JpZCk7XG5cbiAgICAgICAgICAgIGlmICghZnJvemVuUmVjdC5pblBvaW50KGFic3RyYWN0WCwgYWJzdHJhY3RZKSkge1xuICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjZWxsID0gZ3JpZC5nZXRDZWxsQXQoYWJzdHJhY3RYLCBhYnN0cmFjdFkpO1xuICAgICAgICAgICAgdmFyIGNlbGxSZWN0ID0gZ3JpZC5nZXRDZWxsUmVjdChjZWxsLmNvbCwgY2VsbC5yb3cpO1xuXG4gICAgICAgICAgICBpZiAoYWJzdHJhY3RYIDwgY2VsbFJlY3QubGVmdCArIG9mZnNldCkge1xuICAgICAgICAgICAgICByZXR1cm4gY2VsbC5jb2wgLSAxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2VsbFJlY3QucmlnaHQgLSBvZmZzZXQgPCBhYnN0cmFjdFgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNlbGwuY29sO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0VmlzaWJsZVJlY3QoZ3JpZCkge1xuICAgICAgICAgICAgdmFyIF9ncmlkJF8yID0gZ3JpZFtfXSxcbiAgICAgICAgICAgICAgICBfZ3JpZCRfMiRzY3JvbGwgPSBfZ3JpZCRfMi5zY3JvbGwsXG4gICAgICAgICAgICAgICAgbGVmdCA9IF9ncmlkJF8yJHNjcm9sbC5sZWZ0LFxuICAgICAgICAgICAgICAgIHRvcCA9IF9ncmlkJF8yJHNjcm9sbC50b3AsXG4gICAgICAgICAgICAgICAgX2dyaWQkXzIkY2FudmFzID0gX2dyaWQkXzIuY2FudmFzLFxuICAgICAgICAgICAgICAgIHdpZHRoID0gX2dyaWQkXzIkY2FudmFzLndpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IF9ncmlkJF8yJGNhbnZhcy5oZWlnaHQ7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlY3RfMS5SZWN0KGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0U2Nyb2xsYWJsZVZpc2libGVSZWN0KGdyaWQpIHtcbiAgICAgICAgICAgIHZhciBmcm96ZW5Db2xzV2lkdGggPSAwO1xuXG4gICAgICAgICAgICBpZiAoZ3JpZFtfXS5mcm96ZW5Db2xDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgLy/lm7rlrprliJfjgYzjgYLjgovloLTlkIjlm7rlrprliJfliIbmj4/nlLtcbiAgICAgICAgICAgICAgdmFyIGZyb3plblJlY3QgPSBfZ2V0RnJvemVuQ29sc1JlY3QoZ3JpZCk7XG5cbiAgICAgICAgICAgICAgZnJvemVuQ29sc1dpZHRoID0gZnJvemVuUmVjdC53aWR0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGZyb3plblJvd3NIZWlnaHQgPSAwO1xuXG4gICAgICAgICAgICBpZiAoZ3JpZFtfXS5mcm96ZW5Sb3dDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgLy/lm7rlrprliJfjgYzjgYLjgovloLTlkIjlm7rlrprliJfliIbmj4/nlLtcbiAgICAgICAgICAgICAgdmFyIF9mcm96ZW5SZWN0MyA9IF9nZXRGcm96ZW5Sb3dzUmVjdChncmlkKTtcblxuICAgICAgICAgICAgICBmcm96ZW5Sb3dzSGVpZ2h0ID0gX2Zyb3plblJlY3QzLmhlaWdodDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWN0XzEuUmVjdChncmlkW19dLnNjcm9sbGFibGUuc2Nyb2xsTGVmdCArIGZyb3plbkNvbHNXaWR0aCwgZ3JpZFtfXS5zY3JvbGxhYmxlLnNjcm9sbFRvcCArIGZyb3plblJvd3NIZWlnaHQsIGdyaWRbX10uY2FudmFzLndpZHRoIC0gZnJvemVuQ29sc1dpZHRoLCBncmlkW19dLmNhbnZhcy5oZWlnaHQgLSBmcm96ZW5Sb3dzSGVpZ2h0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF90b1JlbGF0aXZlUmVjdChncmlkLCBhYnNvbHV0ZVJlY3QpIHtcbiAgICAgICAgICAgIHZhciByZWN0ID0gYWJzb2x1dGVSZWN0LmNvcHkoKTtcblxuICAgICAgICAgICAgdmFyIHZpc2libGVSZWN0ID0gX2dldFZpc2libGVSZWN0KGdyaWQpO1xuXG4gICAgICAgICAgICByZWN0Lm9mZnNldExlZnQoLXZpc2libGVSZWN0LmxlZnQpO1xuICAgICAgICAgICAgcmVjdC5vZmZzZXRUb3AoLXZpc2libGVSZWN0LnRvcCk7XG4gICAgICAgICAgICByZXR1cm4gcmVjdDtcbiAgICAgICAgICB9IC8vZW5kIHByaXZhdGUgbWV0aG9kc1xuICAgICAgICAgIC8vXG4gICAgICAgICAgLy9cbiAgICAgICAgICAvL1xuICAgICAgICAgIC8vXG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBtYW5hZ2luZyBtb3VzZSBkb3duIG1vdmluZ1xuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIHZhciBCYXNlTW91c2VEb3duTW92ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gQmFzZU1vdXNlRG93bk1vdmVyKGdyaWQpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VNb3VzZURvd25Nb3Zlcik7XG5cbiAgICAgICAgICAgICAgdGhpcy5fZ3JpZCA9IGdyaWQ7XG4gICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIgPSBuZXcgRXZlbnRIYW5kbGVyXzEuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgICAgICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuICAgICAgICAgICAgICB0aGlzLl9zdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgIHRoaXMuX21vdmVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhCYXNlTW91c2VEb3duTW92ZXIsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJtb3ZpbmdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmluZyhfZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAhIXRoaXMuX3N0YXJ0ZWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImxhc3RNb3ZpbmdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxhc3RNb3ZpbmcoZSkge1xuICAgICAgICAgICAgICAgIC8vIG1vdXNldXDlvozjgZnjgZDjgavjgIFjbGlja+OCpOODmeODs+ODiOOCkuWPjeW/nOOBl+OBquOBhOOCiOOBhuOBq+OBmeOCi+WItuW+oeimgVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vdmluZyhlKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSB0aGlzLl9tb3VzZUVuZFBvaW50O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFsYXN0KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHB0ID0gX2dldE1vdXNlQWJzdHJhY3RQb2ludCh0aGlzLl9ncmlkLCBlKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBwdCAhPSBudWxsICYmIHB0LnggPT09IGxhc3QueCAmJiBwdC55ID09PSBsYXN0Lnk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9iaW5kTW92ZUFuZFVwXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYmluZE1vdmVBbmRVcChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzNjUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXI7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlzVG91Y2hFdmVudChlKSkge1xuICAgICAgICAgICAgICAgICAgZXZlbnRzLm1vdXNlbW92ZSA9IGhhbmRsZXIub24oZG9jdW1lbnQuYm9keSwgXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNjUuX21vdXNlTW92ZShlKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgZXZlbnRzLm1vdXNldXAgPSBoYW5kbGVyLm9uKGRvY3VtZW50LmJvZHksIFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2NS5fbW91c2VVcChlKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBldmVudHMudG91Y2htb3ZlID0gaGFuZGxlci5vbihkb2N1bWVudC5ib2R5LCBcInRvdWNobW92ZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2NS5fbW91c2VNb3ZlKGUpO1xuICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICBwYXNzaXZlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBldmVudHMudG91Y2hlbmQgPSBoYW5kbGVyLm9uKGRvY3VtZW50LmJvZHksIFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNjUuX21vdXNlVXAoZSk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIGV2ZW50cy50b3VjaGNhbmNlbCA9IGhhbmRsZXIub24oZG9jdW1lbnQuYm9keSwgXCJ0b3VjaGNhbmNlbFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2NS5fbW91c2VVcChlKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX21vdmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9tb3VzZU1vdmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9tb3VzZU1vdmUoZSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNUb3VjaEV2ZW50KGUpKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZ2V0TW91c2VCdXR0b25zKGUpICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21vdXNlVXAoZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX21vdmVkID0gdGhpcy5fbW92ZUludGVybmFsKGUpIHx8IHRoaXMuX21vdmVkXG4gICAgICAgICAgICAgICAgLypjYWxjdWxhdGlvbiBvbiBhZnRlciovXG4gICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfbW92ZUludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbW92ZUludGVybmFsKF9lKSB7XG4gICAgICAgICAgICAgICAgLy9wcm90ZWN0ZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9tb3VzZVVwXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbW91c2VVcChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzNjYgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXI7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5vZmYoZXZlbnRzLm1vdXNlbW92ZSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5vZmYoZXZlbnRzLnRvdWNobW92ZSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5vZmYoZXZlbnRzLm1vdXNldXApO1xuICAgICAgICAgICAgICAgIGhhbmRsZXIub2ZmKGV2ZW50cy50b3VjaGVuZCk7IC8vIGhhbmRsZXIub2ZmKHRoaXMuX2V2ZW50cy5tb3VzZWxlYXZlKTtcblxuICAgICAgICAgICAgICAgIGhhbmRsZXIub2ZmKGV2ZW50cy50b3VjaGNhbmNlbCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhcnRlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBJbnRlcm5hbChlKTsgLy8gbW91c2V1cOW+jOOBmeOBkOOBq+OAgWNsaWNr44Kk44OZ44Oz44OI44KS5Y+N5b+c44GX44Gq44GE44KI44GG44Gr44GZ44KL5Yi25b6h6KaBXG5cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tb3ZlZCkge1xuICAgICAgICAgICAgICAgICAgLy/np7vli5XjgYznmbrnlJ/jgZfjgabjgYTjgZ/jgolcbiAgICAgICAgICAgICAgICAgIHRoaXMuX21vdXNlRW5kUG9pbnQgPSBfZ2V0TW91c2VBYnN0cmFjdFBvaW50KHRoaXMuX2dyaWQsIGUpO1xuICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzNjYuX21vdXNlRW5kUG9pbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgfSwgMTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX3VwSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF91cEludGVybmFsKF9lKSB7Ly9wcm90ZWN0ZWRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZGlzcG9zZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gQmFzZU1vdXNlRG93bk1vdmVyO1xuICAgICAgICAgIH0oKTtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBtYW5hZ2luZyBjZWxsIHNlbGVjdGlvbiBvcGVyYXRpb24gd2l0aCBtb3VzZVxuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIHZhciBDZWxsU2VsZWN0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlTW91c2VEb3duTW92ZXIpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhDZWxsU2VsZWN0b3IsIF9CYXNlTW91c2VEb3duTW92ZXIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNDYgPSBfY3JlYXRlU3VwZXIoQ2VsbFNlbGVjdG9yKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gQ2VsbFNlbGVjdG9yKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2VsbFNlbGVjdG9yKTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3N1cGVyNDYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKENlbGxTZWxlY3RvciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcInN0YXJ0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNlbGwgPSB0aGlzLl9nZXRUYXJnZXRDZWxsKGUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjZWxsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX21vdmVGb2N1c0NlbGwuY2FsbCh0aGlzLl9ncmlkLCBjZWxsLmNvbCwgY2VsbC5yb3csIGUuc2hpZnRLZXkpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fYmluZE1vdmVBbmRVcChlKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2NlbGwgPSBjZWxsO1xuICAgICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuXG4gICAgICAgICAgICAgICAgX3ZpYnJhdGUoZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNlbGVjdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0KGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IHRoaXMuX2dldFRhcmdldENlbGwoZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNlbGwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfbW92ZUZvY3VzQ2VsbC5jYWxsKHRoaXMuX2dyaWQsIGNlbGwuY29sLCBjZWxsLnJvdywgZS5zaGlmdEtleSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9jZWxsID0gY2VsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX21vdmVJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX21vdmVJbnRlcm5hbChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNlbGwgPSB0aGlzLl9nZXRUYXJnZXRDZWxsKGUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjZWxsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF9jZWxsID0gdGhpcy5fY2VsbCxcbiAgICAgICAgICAgICAgICAgICAgb2xkQ29sID0gX3RoaXMkX2NlbGwuY29sLFxuICAgICAgICAgICAgICAgICAgICBvbGRSb3cgPSBfdGhpcyRfY2VsbC5yb3c7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0NvbCA9IGNlbGwuY29sLFxuICAgICAgICAgICAgICAgICAgICBuZXdSb3cgPSBjZWxsLnJvdztcblxuICAgICAgICAgICAgICAgIGlmIChvbGRDb2wgPT09IG5ld0NvbCAmJiBvbGRSb3cgPT09IG5ld1Jvdykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBncmlkID0gdGhpcy5fZ3JpZDtcblxuICAgICAgICAgICAgICAgIF9tb3ZlRm9jdXNDZWxsLmNhbGwoZ3JpZCwgbmV3Q29sLCBuZXdSb3csIHRydWUpOyAvL21ha2UgdmlzaWJsZVxuXG5cbiAgICAgICAgICAgICAgICB2YXIgbWFrZVZpc2libGVDb2wgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBpZiAobmV3Q29sIDwgb2xkQ29sICYmIDAgPCBuZXdDb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbW92ZSBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdDb2wgLSAxO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvbGRDb2wgPCBuZXdDb2wgJiYgbmV3Q29sICsgMSA8IGdyaWQuY29sQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbW92ZSByaWdodFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q29sICsgMTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NvbDtcbiAgICAgICAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWFrZVZpc2libGVSb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBpZiAobmV3Um93IDwgb2xkUm93ICYmIDAgPCBuZXdSb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbW92ZSB1cFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3Um93IC0gMTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob2xkUm93IDwgbmV3Um93ICYmIG5ld1JvdyArIDEgPCBncmlkLnJvd0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgZG93blxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3Um93ICsgMTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld1JvdztcbiAgICAgICAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWFrZVZpc2libGVDb2wgIT09IG5ld0NvbCB8fCBtYWtlVmlzaWJsZVJvdyAhPT0gbmV3Um93KSB7XG4gICAgICAgICAgICAgICAgICBncmlkLm1ha2VWaXNpYmxlQ2VsbChtYWtlVmlzaWJsZUNvbCwgbWFrZVZpc2libGVSb3cpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX2NlbGwgPSBjZWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfZ2V0VGFyZ2V0Q2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2dldFRhcmdldENlbGwoZSkge1xuICAgICAgICAgICAgICAgIHZhciBncmlkID0gdGhpcy5fZ3JpZDtcblxuICAgICAgICAgICAgICAgIHZhciBhYnN0cmFjdFBvcyA9IF9nZXRNb3VzZUFic3RyYWN0UG9pbnQoZ3JpZCwgZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWFic3RyYWN0UG9zKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IGdyaWQuZ2V0Q2VsbEF0KGFic3RyYWN0UG9zLngsIGFic3RyYWN0UG9zLnkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNlbGwuY29sIDwgMCB8fCBjZWxsLnJvdyA8IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBjZWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBDZWxsU2VsZWN0b3I7XG4gICAgICAgICAgfShCYXNlTW91c2VEb3duTW92ZXIpO1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIG1hbmFnaW5nIHJvdyB3aWR0aCBjaGFuZ2luZyBvcGVyYXRpb24gd2l0aCBtb3VzZVxuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIHZhciBDb2x1bW5SZXNpemVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZU1vdXNlRG93bk1vdmVyMikge1xuICAgICAgICAgICAgX2luaGVyaXRzKENvbHVtblJlc2l6ZXIsIF9CYXNlTW91c2VEb3duTW92ZXIyKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjQ3ID0gX2NyZWF0ZVN1cGVyKENvbHVtblJlc2l6ZXIpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBDb2x1bW5SZXNpemVyKGdyaWQpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNjc7XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbHVtblJlc2l6ZXIpO1xuXG4gICAgICAgICAgICAgIF90aGlzNjcgPSBfc3VwZXI0Ny5jYWxsKHRoaXMsIGdyaWQpO1xuICAgICAgICAgICAgICBfdGhpczY3Ll94ID0gLTE7XG4gICAgICAgICAgICAgIF90aGlzNjcuX3ByZVggPSAtMTtcbiAgICAgICAgICAgICAgX3RoaXM2Ny5faW52YWxpZGF0ZUFic29sdXRlTGVmdCA9IC0xO1xuICAgICAgICAgICAgICBfdGhpczY3Ll90YXJnZXRDb2wgPSAtMTtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNjc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhDb2x1bW5SZXNpemVyLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KGNvbCwgZSkge1xuICAgICAgICAgICAgICAgIHZhciBwYWdlWDtcblxuICAgICAgICAgICAgICAgIGlmICghaXNUb3VjaEV2ZW50KGUpKSB7XG4gICAgICAgICAgICAgICAgICBwYWdlWCA9IGUucGFnZVg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHBhZ2VYID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl94ID0gcGFnZVg7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJlWCA9IDA7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9iaW5kTW92ZUFuZFVwKGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fdGFyZ2V0Q29sID0gY29sO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludmFsaWRhdGVBYnNvbHV0ZUxlZnQgPSBfZ2V0Q29sc1dpZHRoKHRoaXMuX2dyaWQsIDAsIGNvbCAtIDEpO1xuICAgICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuXG4gICAgICAgICAgICAgICAgX3ZpYnJhdGUoZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9tb3ZlSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9tb3ZlSW50ZXJuYWwoZSkge1xuICAgICAgICAgICAgICAgIHZhciBwYWdlWCA9IGlzVG91Y2hFdmVudChlKSA/IGUuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVggOiBlLnBhZ2VYO1xuICAgICAgICAgICAgICAgIHZhciB4ID0gcGFnZVggLSB0aGlzLl94O1xuICAgICAgICAgICAgICAgIHZhciBtb3ZlWCA9IHggLSB0aGlzLl9wcmVYO1xuICAgICAgICAgICAgICAgIHRoaXMuX3ByZVggPSB4O1xuXG4gICAgICAgICAgICAgICAgdmFyIHByZSA9IHRoaXMuX2dyaWQuZ2V0Q29sV2lkdGgodGhpcy5fdGFyZ2V0Q29sKTtcblxuICAgICAgICAgICAgICAgIHZhciBhZnRlclNpemUgPSBfYWRqdXN0Q29sV2lkdGgodGhpcy5fZ3JpZCwgdGhpcy5fdGFyZ2V0Q29sLCBwcmUgKyBtb3ZlWCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYWZ0ZXJTaXplIDwgMTAgJiYgbW92ZVggPCAwKSB7XG4gICAgICAgICAgICAgICAgICBhZnRlclNpemUgPSAxMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfc3RvcmVBdXRvQ29sV2lkdGhFeHBycyh0aGlzLl9ncmlkKTtcblxuICAgICAgICAgICAgICAgIF9zZXRDb2xXaWR0aCh0aGlzLl9ncmlkLCB0aGlzLl90YXJnZXRDb2wsIGFmdGVyU2l6ZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IF9nZXRWaXNpYmxlUmVjdCh0aGlzLl9ncmlkKTtcblxuICAgICAgICAgICAgICAgIHJlY3QubGVmdCA9IHRoaXMuX2ludmFsaWRhdGVBYnNvbHV0ZUxlZnQ7XG5cbiAgICAgICAgICAgICAgICBfaW52YWxpZGF0ZVJlY3QodGhpcy5fZ3JpZCwgcmVjdCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9ncmlkLmZpcmVMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuUkVTSVpFX0NPTFVNTiwge1xuICAgICAgICAgICAgICAgICAgY29sOiB0aGlzLl90YXJnZXRDb2xcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfdXBJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3VwSW50ZXJuYWwoX2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuX2dyaWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ3JpZC51cGRhdGVTY3JvbGwoKSkge1xuICAgICAgICAgICAgICAgICAgZ3JpZC5pbnZhbGlkYXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBDb2x1bW5SZXNpemVyO1xuICAgICAgICAgIH0oQmFzZU1vdXNlRG93bk1vdmVyKTtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gc2V0U2FmZUlucHV0VmFsdWUoaW5wdXQsIHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IGlucHV0LnR5cGU7XG4gICAgICAgICAgICBpbnB1dC50eXBlID0gXCJcIjtcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gdmFsdWU7XG5cbiAgICAgICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICAgIGlucHV0LnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBJR05PUkVfU1RPUkVfQVRUUlMgPSBbXCJzdHlsZVwiLCBcInJlYWRvbmx5XCJdO1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIE1hbmFnZSBmb2N1c1xuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cbiAgICAgICAgICB2YXIgRm9jdXNDb250cm9sID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXZlbnRUYXJnZXRfMSRFdmVudFQyKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoRm9jdXNDb250cm9sLCBfRXZlbnRUYXJnZXRfMSRFdmVudFQyKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjQ4ID0gX2NyZWF0ZVN1cGVyKEZvY3VzQ29udHJvbCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEZvY3VzQ29udHJvbChncmlkLCBwYXJlbnRFbGVtZW50LCBzY3JvbGxhYmxlLCBzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNjg7XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZvY3VzQ29udHJvbCk7XG5cbiAgICAgICAgICAgICAgX3RoaXM2OCA9IF9zdXBlcjQ4LmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgIF90aGlzNjguX2dyaWQgPSBncmlkO1xuICAgICAgICAgICAgICBfdGhpczY4Ll9zY3JvbGxhYmxlID0gc2Nyb2xsYWJsZTtcbiAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBfdGhpczY4Ll9oYW5kbGVyID0gbmV3IEV2ZW50SGFuZGxlcl8xLkV2ZW50SGFuZGxlcigpO1xuICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBfdGhpczY4Ll9pbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZChcImdyaWQtZm9jdXMtY29udHJvbFwiKTtcbiAgICAgICAgICAgICAgaW5wdXQucmVhZE9ubHkgPSB0cnVlO1xuICAgICAgICAgICAgICBwYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGlucHV0KTtcbiAgICAgICAgICAgICAgaGFuZGxlci5vbihpbnB1dCwgXCJjb21wb3NpdGlvbnN0YXJ0XCIsIGZ1bmN0aW9uIChfZSkge1xuICAgICAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoXCJjb21wb3NpdGlvblwiKTtcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5mb250ID0gZ3JpZC5mb250IHx8IFwiMTZweCBzYW5zLXNlcmlmXCI7XG4gICAgICAgICAgICAgICAgX3RoaXM2OC5faXNDb21wb3NpdGlvbiA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2OC5fY29tcG9zaXRpb25FbmQpIHtcbiAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChfdGhpczY4Ll9jb21wb3NpdGlvbkVuZCk7XG4gICAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXM2OC5fY29tcG9zaXRpb25FbmQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZ3JpZC5mb2N1cygpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdmFyIGxhc3RJbnB1dFZhbHVlO1xuXG4gICAgICAgICAgICAgIHZhciBpbnB1dENsZWFyID0gZnVuY3Rpb24gaW5wdXRDbGVhcihzdG9yZUxhc3RJbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbGFzdElucHV0VmFsdWUgPSBpbnB1dC52YWx1ZTtcblxuICAgICAgICAgICAgICAgIGlmIChfdGhpczY4Ll9pc0NvbXBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGxhc3RJbnB1dFZhbHVlICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICBzZXRTYWZlSW5wdXRWYWx1ZShpbnB1dCwgXCJcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFzdG9yZUxhc3RJbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICBsYXN0SW5wdXRWYWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIHZhciBoYW5kbGVDb21wb3NpdGlvbkVuZCA9IGZ1bmN0aW9uIGhhbmRsZUNvbXBvc2l0aW9uRW5kKCkge1xuICAgICAgICAgICAgICAgIF90aGlzNjguX2lzQ29tcG9zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKFwiY29tcG9zaXRpb25cIik7XG4gICAgICAgICAgICAgICAgaW5wdXQuc3R5bGUuZm9udCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gaW5wdXQudmFsdWU7XG4gICAgICAgICAgICAgICAgaW5wdXRDbGVhcihmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlucHV0LnJlYWRPbmx5KSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczY4LmZpcmVMaXN0ZW5lcnMoXCJpbnB1dFwiLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzNjguX2NvbXBvc2l0aW9uRW5kKSB7XG4gICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXM2OC5fY29tcG9zaXRpb25FbmQpO1xuICAgICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzNjguX2NvbXBvc2l0aW9uRW5kO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImNvbXBvc2l0aW9uZW5kXCIsIGZ1bmN0aW9uIChfZSkge1xuICAgICAgICAgICAgICAgIF90aGlzNjguX2NvbXBvc2l0aW9uRW5kID0gc2V0VGltZW91dChoYW5kbGVDb21wb3NpdGlvbkVuZCwgMSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBzZWxlY3Rpb24ubGlzdGVuKFwiYmVmb3JlX2hvb2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczY4Ll9jb21wb3NpdGlvbkVuZCkge1xuICAgICAgICAgICAgICAgICAgaGFuZGxlQ29tcG9zaXRpb25FbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImtleXByZXNzXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzNjguX2lzQ29tcG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlucHV0LnJlYWRPbmx5ICYmIGUua2V5ICYmIGUua2V5Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5ID09PSBcImNcIikgey8vY29weSEgZm9yIEZpcmVmb3ggJiBTYWZhcmlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gXCJ2XCIpIHsvL3Bhc3RlISBmb3IgRmlyZWZveCAmIFNhZmFyaVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiIFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gU2luY2UgdGhlIGZ1bGwtd2lkdGggc3BhY2UgY2Fubm90IGJlIGRldGVybWluZWQsIGl0IGlzIHByb2Nlc3NlZCBieSBcImlucHV0XCIuXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXM2OC5maXJlTGlzdGVuZXJzKFwiaW5wdXRcIiwgZS5rZXkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlucHV0Q2xlYXIodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2OC5faXNDb21wb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgaWYgKF90aGlzNjguX2NvbXBvc2l0aW9uRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUNvbXBvc2l0aW9uRW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbEV2ZW50KGUpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGtleUNvZGUgPSBnZXRLZXlDb2RlKGUpO1xuICAgICAgICAgICAgICAgIHZhciBzdG9wQ2VsbE1vdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgZXZ0ID0ge1xuICAgICAgICAgICAgICAgICAga2V5Q29kZToga2V5Q29kZSxcbiAgICAgICAgICAgICAgICAgIGV2ZW50OiBlLFxuICAgICAgICAgICAgICAgICAgc3RvcENlbGxNb3Zpbmc6IGZ1bmN0aW9uIHN0b3BDZWxsTW92aW5nKCkge1xuICAgICAgICAgICAgICAgICAgICBzdG9wQ2VsbE1vdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBfdGhpczY4LmZpcmVMaXN0ZW5lcnMoXCJrZXlkb3duXCIsIGV2dCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlucHV0LnJlYWRPbmx5ICYmIGxhc3RJbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAvLyBmb3IgU2FmYXJpXG4gICAgICAgICAgICAgICAgICBfdGhpczY4LmZpcmVMaXN0ZW5lcnMoXCJpbnB1dFwiLCBsYXN0SW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFzdG9wQ2VsbE1vdmUpIF90aGlzNjguZmlyZUtleURvd25Nb3ZlKGtleUNvZGUsIGUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCgoX2EgPSBfdGhpczY4Ll9ncmlkLmtleWJvYXJkT3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRlbGV0ZUNlbGxWYWx1ZU9uRGVsKSAmJiAoa2V5Q29kZSA9PT0gS0VZX0RFTCB8fCBrZXlDb2RlID09PSBLRVlfQlMpKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczY4LmZpcmVMaXN0ZW5lcnMoXCJkZWxldGVcIiwgZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaW5wdXRDbGVhcih0cnVlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGhhbmRsZXIub24oaW5wdXQsIFwia2V5dXBcIiwgZnVuY3Rpb24gKF9lKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzNjguX2lzQ29tcG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczY4Ll9jb21wb3NpdGlvbkVuZCkge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVDb21wb3NpdGlvbkVuZCgpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlucHV0Q2xlYXIodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBoYW5kbGVyLm9uKGlucHV0LCBcImlucHV0XCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGUuZGF0YSA9PT0gXCIgXCIgfHwgZS5kYXRhID09PSBcIuOAgFwiKSB7XG4gICAgICAgICAgICAgICAgICAvLyBTaW5jZSB0aGUgZnVsbC13aWR0aCBzcGFjZSBjYW5ub3QgYmUgZGV0ZXJtaW5lZCBvbiBcImtleXByZXNzXCIsIGl0IGlzIHByb2Nlc3NlZCBieSBcImlucHV0XCIuXG4gICAgICAgICAgICAgICAgICBfdGhpczY4LmZpcmVMaXN0ZW5lcnMoXCJpbnB1dFwiLCBlLmRhdGEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlucHV0Q2xlYXIodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGlmICh1dGlsc18xLmJyb3dzZXIuSUUpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uKGRvY3VtZW50LCBcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldCAhPT0gaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGdldEtleUNvZGUoZSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChrZXlDb2RlID09PSBLRVlfQUxQSEFfQyAmJiBlLmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2hlbiB0ZXh0IGlzIG5vdCBzZWxlY3RlZCBjb3B5LWV2ZW50IGlzIG5vdCBlbWl0LCBvbiBJRS5cbiAgICAgICAgICAgICAgICAgICAgc2V0U2FmZUlucHV0VmFsdWUoaW5wdXQsIFwiZHVtbXlcIik7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0LnNlbGVjdCgpO1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZXRTYWZlSW5wdXRWYWx1ZShpbnB1dCwgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGtleUNvZGUgPT09IEtFWV9BTFBIQV9WICYmIGUuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXaGVuIGlucHV0IGlzIHJlYWQtb25seSBwYXN0ZS1ldmVudCBpcyBub3QgZW1pdCwgb24gSUUuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5yZWFkT25seSkge1xuICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnJlYWRPbmx5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5yZWFkT25seSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRTYWZlSW5wdXRWYWx1ZShpbnB1dCwgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgfSwgMTApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAodXRpbHNfMS5icm93c2VyLkVkZ2UpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLm9uY2UoZG9jdW1lbnQsIFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoISgwLCB1dGlsc18xLmlzRGVzY2VuZGFudEVsZW1lbnQpKHBhcmVudEVsZW1lbnQsIGUudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9IC8vIFdoZW4gdGhlIGlucHV0IGhhcyBmb2N1cyBvbiB0aGUgZmlyc3QgcGFnZSBvcGVuaW5nLCB0aGUgcGFzdGUtZXZlbnQgYW5kIGNvcHktZXZlbnQgaXMgbm90IGVtaXQsIG9uIEVkZ2UuXG5cblxuICAgICAgICAgICAgICAgICAgdmFyIGR1bW15SW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgICAgICAgICAgICAgICBncmlkLmdldEVsZW1lbnQoKS5hcHBlbmRDaGlsZChkdW1teUlucHV0KTtcbiAgICAgICAgICAgICAgICAgIGR1bW15SW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAoX2EgPSBkdW1teUlucHV0LnBhcmVudEVsZW1lbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yZW1vdmVDaGlsZChkdW1teUlucHV0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGhhbmRsZXIub24oZG9jdW1lbnQsIFwicGFzdGVcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoISgwLCB1dGlsc18xLmlzRGVzY2VuZGFudEVsZW1lbnQpKHBhcmVudEVsZW1lbnQsIGUudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwYXN0ZVRleHQgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodXRpbHNfMS5icm93c2VyLklFKSB7XG4gICAgICAgICAgICAgICAgICAvLyBJRVxuICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAgIHBhc3RlVGV4dCA9IHdpbmRvdy5jbGlwYm9hcmREYXRhLmdldERhdGEoXCJUZXh0XCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB2YXIgY2xpcGJvYXJkRGF0YSA9IGUuY2xpcGJvYXJkRGF0YTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGNsaXBib2FyZERhdGEuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hyb21lICYgRmlyZWZveCAmIEVkZ2VcbiAgICAgICAgICAgICAgICAgICAgcGFzdGVUZXh0ID0gY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwidGV4dC9wbGFpblwiKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNhZmFyaVxuICAgICAgICAgICAgICAgICAgICBpZiAoLTEgIT09IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoY2xpcGJvYXJkRGF0YS50eXBlcywgXCJ0ZXh0L3BsYWluXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcGFzdGVUZXh0ID0gY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwiVGV4dFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChwYXN0ZVRleHQgIT0gbnVsbCAmJiBwYXN0ZVRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczY4LmZpcmVMaXN0ZW5lcnMoXCJwYXN0ZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwYXN0ZVRleHQsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50OiBlXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBoYW5kbGVyLm9uKGRvY3VtZW50LCBcImNvcHlcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2OC5faXNDb21wb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghKDAsIHV0aWxzXzEuaXNEZXNjZW5kYW50RWxlbWVudCkocGFyZW50RWxlbWVudCwgZS50YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2V0U2FmZUlucHV0VmFsdWUoaW5wdXQsIFwiXCIpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdXRpbHNfMS5hcnJheS5maW5kKF90aGlzNjguZmlyZUxpc3RlbmVycyhcImNvcHlcIiksIGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gciAhPSBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgY2FuY2VsRXZlbnQoZSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh1dGlsc18xLmJyb3dzZXIuSUUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsaXBib2FyZERhdGEuc2V0RGF0YShcIlRleHRcIiwgZGF0YSk7IC8vIElFXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlLmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgZGF0YSk7IC8vIENocm9tZSwgRmlyZWZveFxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGhhbmRsZXIub24oaW5wdXQsIFwiZm9jdXNcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBfdGhpczY4LmZpcmVMaXN0ZW5lcnMoXCJmb2N1c1wiLCBlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGhhbmRsZXIub24oaW5wdXQsIFwiYmx1clwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzNjguZmlyZUxpc3RlbmVycyhcImJsdXJcIiwgZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2ODtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEZvY3VzQ29udHJvbCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImZpcmVLZXlEb3duTW92ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmlyZUtleURvd25Nb3ZlKGtleUNvZGUsIGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2EsIF9iLCBfYztcblxuICAgICAgICAgICAgICAgIHZhciBmbiA9IHRoaXMuX2tleURvd25Nb3ZlQ2FsbGJhY2s7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWZuKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzQ29tcG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoa2V5Q29kZSA9PT0gS0VZX0xFRlQgfHwga2V5Q29kZSA9PT0gS0VZX1VQIHx8IGtleUNvZGUgPT09IEtFWV9SSUdIVCB8fCBrZXlDb2RlID09PSBLRVlfRE9XTiB8fCBrZXlDb2RlID09PSBLRVlfSE9NRSB8fCBrZXlDb2RlID09PSBLRVlfRU5EKSB7XG4gICAgICAgICAgICAgICAgICBmbihlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCgoX2EgPSB0aGlzLl9ncmlkLmtleWJvYXJkT3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1vdmVDZWxsT25UYWIpICYmIGtleUNvZGUgPT09IEtFWV9UQUIpIHtcbiAgICAgICAgICAgICAgICAgIGZuKGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKChfYiA9IHRoaXMuX2dyaWQua2V5Ym9hcmRPcHRpb25zKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IubW92ZUNlbGxPbkVudGVyKSAmJiBrZXlDb2RlID09PSBLRVlfRU5URVIpIHtcbiAgICAgICAgICAgICAgICAgIGZuKGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKChfYyA9IHRoaXMuX2dyaWQua2V5Ym9hcmRPcHRpb25zKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Muc2VsZWN0QWxsT25DdHJsQSkgJiYga2V5Q29kZSA9PT0gS0VZX0FMUEhBX0EgJiYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpKSB7XG4gICAgICAgICAgICAgICAgICBmbihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uS2V5RG93bk1vdmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uS2V5RG93bk1vdmUoZm4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9rZXlEb3duTW92ZUNhbGxiYWNrID0gZm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uS2V5RG93blwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25LZXlEb3duKGZuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuKFwia2V5ZG93blwiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uSW5wdXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uSW5wdXQoZm4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW4oXCJpbnB1dFwiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uRGVsZXRlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRlbGV0ZShmbikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxpc3RlbihcImRlbGV0ZVwiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uQ29weVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25Db3B5KGZuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuKFwiY29weVwiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uUGFzdGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUGFzdGUoZm4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW4oXCJwYXN0ZVwiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uRm9jdXNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uRm9jdXMoZm4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW4oXCJmb2N1c1wiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uQmx1clwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25CbHVyKGZuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuKFwiYmx1clwiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZvY3VzXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb2N1cygpIHtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLl9pbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNldEZvY3VzUmVjdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Rm9jdXNSZWN0KHJlY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGlzLl9pbnB1dDtcblxuICAgICAgICAgICAgICAgIHZhciB0b3AgPSB0aGlzLl9zY3JvbGxhYmxlLmNhbGNUb3AocmVjdC50b3ApO1xuXG4gICAgICAgICAgICAgICAgaW5wdXQuc3R5bGUudG9wID0gXCJcIi5jb25jYXQoKHRvcCAtIHN0eWxlLmdldFNjcm9sbEJhclNpemUoKSkudG9GaXhlZCgpLCBcInB4XCIpOyAvL3Bvc2l0aW9uOnJlbGF0aXZlIOOBoOOBqOOBmuOCjOOCi+OBjOOAgUlF44GvIHBvc2l0aW9uOnJlbGF0aXZl44GY44KD44Gq44GE44Go5pyA5aSn5YCk44G+44Gn5Yip55So44Gn44GN44Gq44GEXG5cbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5sZWZ0ID0gXCJcIi5jb25jYXQocmVjdC5sZWZ0LnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS53aWR0aCA9IFwiXCIuY29uY2F0KHJlY3Qud2lkdGgudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmhlaWdodCA9IFwiXCIuY29uY2F0KHJlY3QuaGVpZ2h0LnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZWRpdE1vZGVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICF0aGlzLl9pbnB1dC5yZWFkT25seTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZWRpdE1vZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dC5yZWFkT25seSA9ICFlZGl0TW9kZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicmVzZXRJbnB1dFN0YXR1c1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRJbnB1dFN0YXR1cygpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICB2YXIgZWwgPSB0aGlzLl9pbnB1dDtcblxuICAgICAgICAgICAgICAgIGlmICghZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZ3JpZC1mb2N1cy1jb250cm9sLS1zdG9yZWQtc3RhdHVzXCIpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNvbXBvc2l0aW9uID0gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY29tcG9zaXRpb25cIik7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJzID0gZWwuYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3ZlTmFtZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBuID0gYXR0cnMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgYXR0ciA9IGF0dHJzW2ldO1xuICAgICAgICAgICAgICAgICAgaWYgKElHTk9SRV9TVE9SRV9BVFRSUy5pbmRleE9mKGF0dHIubmFtZSkgPj0gMCkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghKChfYSA9IHRoaXMuX2lucHV0U3RhdHVzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaGFzT3duUHJvcGVydHkoYXR0ci5ub2RlTmFtZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZU5hbWVzLnB1c2goYXR0ci5uYW1lKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZW1vdmVOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChyZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUocmVtb3ZlTmFtZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMuX2lucHV0U3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUobmFtZSwgdGhpcy5faW5wdXRTdGF0dXNbbmFtZV0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChjb21wb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImNvbXBvc2l0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgZWwuc3R5bGUuZm9udCA9IHRoaXMuX2dyaWQuZm9udCB8fCBcIjE2cHggc2Fucy1zZXJpZlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29tcG9zaXRpb25cIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShcImdyaWQtZm9jdXMtY29udHJvbC0tc3RvcmVkLXN0YXR1c1wiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic3RvcmVJbnB1dFN0YXR1c1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcmVJbnB1dFN0YXR1cygpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSB0aGlzLl9pbnB1dDtcblxuICAgICAgICAgICAgICAgIGlmIChlbC5jbGFzc0xpc3QuY29udGFpbnMoXCJncmlkLWZvY3VzLWNvbnRyb2wtLXN0b3JlZC1zdGF0dXNcIikpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5wdXRTdGF0dXMgPSB0aGlzLl9pbnB1dFN0YXR1cyA9IHt9O1xuICAgICAgICAgICAgICAgIHZhciBhdHRycyA9IGVsLmF0dHJpYnV0ZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbiA9IGF0dHJzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgICAgICAgdmFyIGF0dHIgPSBhdHRyc1tpXTtcbiAgICAgICAgICAgICAgICAgIGlmIChJR05PUkVfU1RPUkVfQVRUUlMuaW5kZXhPZihhdHRyLm5hbWUpID49IDApIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgaW5wdXRTdGF0dXNbYXR0ci5uYW1lXSA9IGF0dHIudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImdyaWQtZm9jdXMtY29udHJvbC0tc3RvcmVkLXN0YXR1c1wiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2V0RGVmYXVsdElucHV0U3RhdHVzXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREZWZhdWx0SW5wdXRTdGF0dXMoKSB7Ly8g44Gq44Gc44GL44K544Kv44Ot44O844Or44GM5bCR44GX44Ga44Gk44Ga44KM44Gm44GE44GP44GT44Go44GM44GC44KL44Gu44Gn44GT44GT44Gn44Gv44K744OD44OI44GX44Gq44GE44CCXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5faW5wdXQuc3R5bGUuZm9udCA9IHRoaXMuX2dyaWQuZm9udCB8fCAnMTZweCBzYW5zLXNlcmlmJztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaW5wdXRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKEZvY3VzQ29udHJvbC5wcm90b3R5cGUpLCBcImRpc3Bvc2VcIiwgdGhpcykuY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBGb2N1c0NvbnRyb2w7XG4gICAgICAgICAgfShFdmVudFRhcmdldF8xLkV2ZW50VGFyZ2V0KTtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBTZWxlY3RlZCBhcmVhIG1hbmFnZW1lbnRcbiAgICAgICAgICAgKi9cblxuXG4gICAgICAgICAgdmFyIFNlbGVjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0V2ZW50VGFyZ2V0XzEkRXZlbnRUMykge1xuICAgICAgICAgICAgX2luaGVyaXRzKFNlbGVjdGlvbiwgX0V2ZW50VGFyZ2V0XzEkRXZlbnRUMyk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI0OSA9IF9jcmVhdGVTdXBlcihTZWxlY3Rpb24pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBTZWxlY3Rpb24oZ3JpZCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM2OTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2VsZWN0aW9uKTtcblxuICAgICAgICAgICAgICBfdGhpczY5ID0gX3N1cGVyNDkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgX3RoaXM2OS5fZ3JpZCA9IGdyaWQ7XG4gICAgICAgICAgICAgIF90aGlzNjkuX3NlbCA9IHtcbiAgICAgICAgICAgICAgICBjb2w6IDAsXG4gICAgICAgICAgICAgICAgcm93OiAwXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIF90aGlzNjkuX2ZvY3VzID0ge1xuICAgICAgICAgICAgICAgIGNvbDogMCxcbiAgICAgICAgICAgICAgICByb3c6IDBcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgX3RoaXM2OS5fc3RhcnQgPSB7XG4gICAgICAgICAgICAgICAgY29sOiAwLFxuICAgICAgICAgICAgICAgIHJvdzogMFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICBfdGhpczY5Ll9lbmQgPSB7XG4gICAgICAgICAgICAgICAgY29sOiAwLFxuICAgICAgICAgICAgICAgIHJvdzogMFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2OTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFNlbGVjdGlvbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcInJhbmdlXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IHRoaXMuX3N0YXJ0O1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLl9lbmQ7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0Q29sID0gTWF0aC5taW4oc3RhcnQuY29sLCBlbmQuY29sKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnRSb3cgPSBNYXRoLm1pbihzdGFydC5yb3csIGVuZC5yb3cpO1xuICAgICAgICAgICAgICAgIHZhciBlbmRDb2wgPSBNYXRoLm1heChzdGFydC5jb2wsIGVuZC5jb2wpO1xuICAgICAgICAgICAgICAgIHZhciBlbmRSb3cgPSBNYXRoLm1heChzdGFydC5yb3csIGVuZC5yb3cpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgICAgICBjb2w6IHN0YXJ0Q29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IHN0YXJ0Um93XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgZW5kOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogZW5kQ29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IGVuZFJvd1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHJhbmdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzNzAgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsbEJlZm9yZUhvb2tzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RhcnRDb2wgPSBNYXRoLm1pbihyYW5nZS5zdGFydC5jb2wsIHJhbmdlLmVuZC5jb2wpO1xuICAgICAgICAgICAgICAgIHZhciBzdGFydFJvdyA9IE1hdGgubWluKHJhbmdlLnN0YXJ0LnJvdywgcmFuZ2UuZW5kLnJvdyk7XG4gICAgICAgICAgICAgICAgdmFyIGVuZENvbCA9IE1hdGgubWF4KHJhbmdlLnN0YXJ0LmNvbCwgcmFuZ2UuZW5kLmNvbCk7XG4gICAgICAgICAgICAgICAgdmFyIGVuZFJvdyA9IE1hdGgubWF4KHJhbmdlLnN0YXJ0LnJvdywgcmFuZ2UuZW5kLnJvdyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl93cmFwRmlyZVNlbGVjdGVkRXZlbnQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgX3RoaXM3MC5fc2VsID0ge1xuICAgICAgICAgICAgICAgICAgICBjb2w6IHN0YXJ0Q29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IHN0YXJ0Um93XG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgX3RoaXM3MC5fZm9jdXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogc3RhcnRDb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogc3RhcnRSb3dcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICBfdGhpczcwLl9zdGFydCA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBzdGFydENvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBzdGFydFJvd1xuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIF90aGlzNzAuX2VuZCA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBlbmRDb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogZW5kUm93XG4gICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICBfdXBkYXRlZFNlbGVjdGlvbi5jYWxsKF90aGlzNzAuX2dyaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmb2N1c1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkX2ZvY3VzID0gdGhpcy5fZm9jdXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbCA9IF90aGlzJF9mb2N1cy5jb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IF90aGlzJF9mb2N1cy5yb3c7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzZWxlY3RcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF9zZWwgPSB0aGlzLl9zZWwsXG4gICAgICAgICAgICAgICAgICAgIGNvbCA9IF90aGlzJF9zZWwuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3cgPSBfdGhpcyRfc2VsLnJvdztcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICByb3c6IHJvd1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNlbGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXM3MSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9jYWxsQmVmb3JlSG9va3MoKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3dyYXBGaXJlU2VsZWN0ZWRFdmVudChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX2NlbGwkY29sID0gY2VsbC5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgY29sID0gX2NlbGwkY29sID09PSB2b2lkIDAgPyAwIDogX2NlbGwkY29sLFxuICAgICAgICAgICAgICAgICAgICAgIF9jZWxsJHJvdyA9IGNlbGwucm93LFxuICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IF9jZWxsJHJvdyA9PT0gdm9pZCAwID8gMCA6IF9jZWxsJHJvdztcblxuICAgICAgICAgICAgICAgICAgX3RoaXM3MS5fc2V0U2VsZWN0Q2VsbChjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzNzEuX3NldEZvY3VzQ2VsbChjb2wsIHJvdywgdHJ1ZSwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgIF91cGRhdGVkU2VsZWN0aW9uLmNhbGwoX3RoaXM3MS5fZ3JpZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9zZXRTZWxlY3RDZWxsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0U2VsZWN0Q2VsbChjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczcyID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXMuX3dyYXBGaXJlU2VsZWN0ZWRFdmVudChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczcyLl9zZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IHJvd1xuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIF90aGlzNzIuX3N0YXJ0ID0ge1xuICAgICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9zZXRGb2N1c0NlbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRGb2N1c0NlbGwoY29sLCByb3csIGtlZXBTZWxlY3QsIGlnbm9yZUJlZm9yZUhvb2spIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXM3MyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZUJlZm9yZUhvb2spIHRoaXMuX2NhbGxCZWZvcmVIb29rcygpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fd3JhcEZpcmVTZWxlY3RlZEV2ZW50KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIGlmICgha2VlcFNlbGVjdCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczczLl9zZXRTZWxlY3RDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX3RoaXM3My5fZm9jdXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IHJvd1xuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIF90aGlzNzMuX2VuZCA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfd3JhcEZpcmVTZWxlY3RlZEV2ZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfd3JhcEZpcmVTZWxlY3RlZEV2ZW50KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzV3JhcHBlZCkge1xuICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdGhpcy5faXNXcmFwcGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJlZm9yZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb2w6IHRoaXMuX3NlbC5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93OiB0aGlzLl9zZWwucm93LFxuICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICBhZnRlcjogbnVsbFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWZ0ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgY29sOiB0aGlzLl9zZWwuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogdGhpcy5fc2VsLnJvdyxcbiAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICBiZWZvcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbDogYmVmb3JlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogYmVmb3JlLnJvd1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlLmFmdGVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgIGNvbDogYWZ0ZXIuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogYWZ0ZXIucm93XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZUxpc3RlbmVycyhER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5TRUxFQ1RFRF9DRUxMLCBiZWZvcmUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmVMaXN0ZW5lcnMoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuU0VMRUNURURfQ0VMTCwgYWZ0ZXIpO1xuICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNXcmFwcGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfdXBkYXRlR3JpZFJhbmdlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlR3JpZFJhbmdlKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfZ3JpZCA9IHRoaXMuX2dyaWQsXG4gICAgICAgICAgICAgICAgICAgIHJvd0NvdW50ID0gX3RoaXMkX2dyaWQucm93Q291bnQsXG4gICAgICAgICAgICAgICAgICAgIGNvbENvdW50ID0gX3RoaXMkX2dyaWQuY29sQ291bnQ7XG4gICAgICAgICAgICAgICAgdmFyIHBvaW50cyA9IFt0aGlzLl9zZWwsIHRoaXMuX2ZvY3VzLCB0aGlzLl9zdGFydCwgdGhpcy5fZW5kXTtcbiAgICAgICAgICAgICAgICB2YXIgbmVlZENoYW5nZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgIGlmIChjb2xDb3VudCA8PSBwb2ludHNbaV0uY29sIHx8IHJvd0NvdW50IDw9IHBvaW50c1tpXS5yb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgbmVlZENoYW5nZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghbmVlZENoYW5nZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX3dyYXBGaXJlU2VsZWN0ZWRFdmVudChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgICAgICAgICBwLmNvbCA9IE1hdGgubWluKGNvbENvdW50IC0gMSwgcC5jb2wpO1xuICAgICAgICAgICAgICAgICAgICBwLnJvdyA9IE1hdGgubWluKHJvd0NvdW50IC0gMSwgcC5yb3cpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2NhbGxCZWZvcmVIb29rc1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2NhbGxCZWZvcmVIb29rcygpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmVMaXN0ZW5lcnMoXCJiZWZvcmVfaG9va1wiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gU2VsZWN0aW9uO1xuICAgICAgICAgIH0oRXZlbnRUYXJnZXRfMS5FdmVudFRhcmdldCk7XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogVGhpcyBjbGFzcyBtYW5hZ2VzIHRoZSBkcmF3aW5nIHByb2Nlc3MgZm9yIGVhY2ggbGF5ZXJcbiAgICAgICAgICAgKi9cblxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICB2YXIgRHJhd0xheWVycyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBEcmF3TGF5ZXJzKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRHJhd0xheWVycyk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fbGF5ZXJzID0ge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhEcmF3TGF5ZXJzLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiYWRkRHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkRHJhdyhsZXZlbCwgZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IHRoaXMuX2xheWVyc1tsZXZlbF0gfHwgKHRoaXMuX2xheWVyc1tsZXZlbF0gPSBuZXcgRHJhd0xheWVyKGxldmVsKSk7XG4gICAgICAgICAgICAgICAgbC5hZGREcmF3KGZuKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhdyhjdHgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayBpbiB0aGlzLl9sYXllcnMpIHtcbiAgICAgICAgICAgICAgICAgIGxpc3QucHVzaCh0aGlzLl9sYXllcnNba10pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGxpc3Quc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGEubGV2ZWwgLSBiLmxldmVsO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGwuZHJhdyhjdHgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBEcmF3TGF5ZXJzO1xuICAgICAgICAgIH0oKTtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgdmFyIERyYXdMYXllciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBEcmF3TGF5ZXIobGV2ZWwpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERyYXdMYXllcik7XG5cbiAgICAgICAgICAgICAgdGhpcy5fbGV2ZWwgPSBsZXZlbDtcbiAgICAgICAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoRHJhd0xheWVyLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwibGV2ZWxcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xldmVsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhZGREcmF3XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGREcmF3KGZuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGlzdC5wdXNoKGZuKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhdyhjdHgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9saXN0LmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgICAgICAgICAgICBjdHguc2F2ZSgpO1xuXG4gICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBmbihjdHgpO1xuICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gRHJhd0xheWVyO1xuICAgICAgICAgIH0oKTtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBDb250ZXh0IG9mIGNlbGwgZHJhd2luZ1xuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIHZhciBEcmF3Q2VsbENvbnRleHQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gIHByaXZhdGUgX2dyaWQ6IGFueTtcbiAgICAgICAgICAgIC8vICBwcml2YXRlIF9vblRlcm1pbmF0ZTogYW55O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gY29sIGluZGV4IG9mIGNvbHVtblxuICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdyBpbmRleCBvZiByb3dcbiAgICAgICAgICAgICAqIEBwYXJhbSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSBjdHggY29udGV4dFxuICAgICAgICAgICAgICogQHBhcmFtIHtSZWN0fSByZWN0IHJlY3Qgb2YgY2VsbCBhcmVhXG4gICAgICAgICAgICAgKiBAcGFyYW0ge1JlY3R9IGRyYXdSZWN0IHJlY3Qgb2YgZHJhd2luZyBhcmVhXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRyYXdpbmcgYHRydWVgIGlmIGRyYXdpbmcgaXMgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzZWxlY3Rpb24gdGhlIHNlbGVjdGlvblxuICAgICAgICAgICAgICogQHBhcmFtIHtBcnJheX0gZHJhd0xheWVycyBhcnJheSBvZiBkcmF3IGxheWVyc1xuICAgICAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gRHJhd0NlbGxDb250ZXh0KGNvbCwgcm93LCBjdHgsIHJlY3QsIGRyYXdSZWN0LCBkcmF3aW5nLCBzZWxlY3Rpb24sIGRyYXdMYXllcnMpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERyYXdDZWxsQ29udGV4dCk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fcmVjdEZpbHRlciA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMuX2NvbCA9IGNvbDtcbiAgICAgICAgICAgICAgdGhpcy5fcm93ID0gcm93O1xuICAgICAgICAgICAgICB0aGlzLl9tb2RlID0gMDtcbiAgICAgICAgICAgICAgdGhpcy5fY3R4ID0gY3R4O1xuICAgICAgICAgICAgICB0aGlzLl9yZWN0ID0gcmVjdDtcbiAgICAgICAgICAgICAgdGhpcy5fZHJhd1JlY3QgPSBkcmF3UmVjdDtcbiAgICAgICAgICAgICAgdGhpcy5fZHJhd2luZyA9IGRyYXdpbmc7XG4gICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbiA9IHNlbGVjdGlvbjtcbiAgICAgICAgICAgICAgdGhpcy5fZHJhd0xheWVycyA9IGRyYXdMYXllcnM7XG4gICAgICAgICAgICAgIHRoaXMuX2NoaWxkQ29udGV4dHMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKERyYXdDZWxsQ29udGV4dCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdpbmdcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21vZGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kcmF3aW5nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJvd1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcm93O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb2xcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FuY2VsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5jZWwoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2FuY2VsID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkQ29udGV4dHMuZm9yRWFjaChmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgICAgICAgICAgICBjdHguY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIHNlbGVjdCBzdGF0dXMuXG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge29iamVjdH0gc2VsZWN0IHN0YXR1c1xuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0U2VsZWN0aW9uXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIHNlbGVjdDogdGhpcy5fc2VsZWN0aW9uLnNlbGVjdCxcbiAgICAgICAgICAgICAgICAgIHJhbmdlOiB0aGlzLl9zZWxlY3Rpb24ucmFuZ2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBDYW52YXMgY29udGV4dC5cbiAgICAgICAgICAgICAgICogQHJldHVybiB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSBDYW52YXMgY29udGV4dC5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENvbnRleHRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbnRleHQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21vZGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdHg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0SW5pdENvbnRleHQuY2FsbCh0aGlzLl9ncmlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFJlY3RhbmdsZSBvZiBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtSZWN0fSByZWN0IFJlY3RhbmdsZSBvZiBjZWxsLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0UmVjdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVjdCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVjdEZpbHRlciA9IHRoaXMuX3JlY3RGaWx0ZXI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3RGaWx0ZXIgPyByZWN0RmlsdGVyKHRoaXMuX2dldFJlY3RJbnRlcm5hbCgpKSA6IHRoaXMuX2dldFJlY3RJbnRlcm5hbCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzZXRSZWN0RmlsdGVyXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRSZWN0RmlsdGVyKHJlY3RGaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWN0RmlsdGVyID0gcmVjdEZpbHRlcjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogUmVjdGFuZ2xlIG9mIERyYXdpbmcgcmFuZ2UuXG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge1JlY3R9IFJlY3RhbmdsZSBvZiBEcmF3aW5nIHJhbmdlLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0RHJhd1JlY3RcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldERyYXdSZWN0KCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tb2RlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZHJhd1JlY3Q7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc091dE9mUmFuZ2UoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIGFic29sdXRlUmVjdCA9IHRoaXMuX2dyaWQuZ2V0Q2VsbFJlY3QodGhpcy5fY29sLCB0aGlzLl9yb3cpO1xuXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdG9SZWxhdGl2ZURyYXdSZWN0KGFic29sdXRlUmVjdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfaXNPdXRPZlJhbmdlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNPdXRPZlJhbmdlKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfZ3JpZDIgPSB0aGlzLl9ncmlkLFxuICAgICAgICAgICAgICAgICAgICBjb2xDb3VudCA9IF90aGlzJF9ncmlkMi5jb2xDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgcm93Q291bnQgPSBfdGhpcyRfZ3JpZDIucm93Q291bnQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbENvdW50IDw9IHRoaXMuX2NvbCB8fCByb3dDb3VudCA8PSB0aGlzLl9yb3c7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIGdldCBDb250ZXh0IG9mIGN1cnJlbnQgc3RhdGVcbiAgICAgICAgICAgICAgICogQHJldHVybiB7RHJhd0NlbGxDb250ZXh0fSBjdXJyZW50IERyYXdDZWxsQ29udGV4dC5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRvQ3VycmVudENvbnRleHRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvQ3VycmVudENvbnRleHQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21vZGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB2YXIgYWJzb2x1dGVSZWN0ID0gdGhpcy5fZ3JpZC5nZXRDZWxsUmVjdCh0aGlzLl9jb2wsIHRoaXMuX3Jvdyk7XG5cbiAgICAgICAgICAgICAgICAgIHZhciByZWN0ID0gX3RvUmVsYXRpdmVSZWN0KHRoaXMuX2dyaWQsIGFic29sdXRlUmVjdCk7XG5cbiAgICAgICAgICAgICAgICAgIHZhciBkcmF3UmVjdCA9IHRoaXMuX2lzT3V0T2ZSYW5nZSgpID8gbnVsbCA6IHRoaXMuX3RvUmVsYXRpdmVEcmF3UmVjdChhYnNvbHV0ZVJlY3QpO1xuICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgRHJhd0NlbGxDb250ZXh0KHRoaXMuX2NvbCwgdGhpcy5fcm93LCB0aGlzLmdldENvbnRleHQoKSwgcmVjdCwgZHJhd1JlY3QsIHRoaXMuZHJhd2luZywgdGhpcy5fc2VsZWN0aW9uLCB0aGlzLl9kcmF3TGF5ZXJzKTsgLy8gdG9DdXJyZW50Q29udGV4dCDjga/oh6rliIbjga4gdG9DdXJyZW50Q29udGV4dOOCkuWRvOOBsOOBm+OCi1xuXG4gICAgICAgICAgICAgICAgICBjb250ZXh0LnRvQ3VycmVudENvbnRleHQgPSB0aGlzLnRvQ3VycmVudENvbnRleHQuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRDb250ZXh0cy5wdXNoKGNvbnRleHQpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5fY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGNvbnRleHQuX3JlY3RGaWx0ZXIgPSB0aGlzLl9yZWN0RmlsdGVyO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhZGRMYXllckRyYXdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZExheWVyRHJhdyhsZXZlbCwgZm4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kcmF3TGF5ZXJzLmFkZERyYXcobGV2ZWwsIGZuKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX3RvUmVsYXRpdmVEcmF3UmVjdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3RvUmVsYXRpdmVEcmF3UmVjdChhYnNvbHV0ZVJlY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmlzaWJsZVJlY3QgPSBfZ2V0VmlzaWJsZVJlY3QodGhpcy5fZ3JpZCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGFic29sdXRlUmVjdC5jb3B5KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXJlY3QuaW50ZXJzZWN0aW9uKHZpc2libGVSZWN0KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLl9ncmlkO1xuICAgICAgICAgICAgICAgIHZhciBpc0Zyb3plbkNlbGwgPSBncmlkLmlzRnJvemVuQ2VsbCh0aGlzLl9jb2wsIHRoaXMuX3Jvdyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ3JpZC5mcm96ZW5Db2xDb3VudCA+PSAwICYmICghaXNGcm96ZW5DZWxsIHx8ICFpc0Zyb3plbkNlbGwuY29sKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGZSZWN0ID0gZ3JpZC5nZXRDZWxsUmVjdChncmlkLmZyb3plbkNvbENvdW50IC0gMSwgdGhpcy5fcm93KTtcbiAgICAgICAgICAgICAgICAgIHJlY3QgPSBSZWN0XzEuUmVjdC5ib3VuZHMoTWF0aC5tYXgocmVjdC5sZWZ0LCBmUmVjdC5yaWdodCksIHJlY3QudG9wLCByZWN0LnJpZ2h0LCByZWN0LmJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGdyaWQuZnJvemVuUm93Q291bnQgPj0gMCAmJiAoIWlzRnJvemVuQ2VsbCB8fCAhaXNGcm96ZW5DZWxsLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfZlJlY3QgPSBncmlkLmdldENlbGxSZWN0KHRoaXMuX2NvbCwgZ3JpZC5mcm96ZW5Sb3dDb3VudCAtIDEpO1xuXG4gICAgICAgICAgICAgICAgICByZWN0ID0gUmVjdF8xLlJlY3QuYm91bmRzKHJlY3QubGVmdCwgTWF0aC5tYXgocmVjdC50b3AsIF9mUmVjdC5ib3R0b20pLCByZWN0LnJpZ2h0LCByZWN0LmJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFyZWN0LmludGVyc2VjdGlvbih2aXNpYmxlUmVjdCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlY3Qub2Zmc2V0TGVmdCgtdmlzaWJsZVJlY3QubGVmdCk7XG4gICAgICAgICAgICAgICAgcmVjdC5vZmZzZXRUb3AoLXZpc2libGVSZWN0LnRvcCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Q7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9kZWxheU1vZGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxheU1vZGUoZ3JpZCwgb25UZXJtaW5hdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RlID0gMTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdHggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlY3QgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RyYXdSZWN0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9ncmlkID0gZ3JpZDtcbiAgICAgICAgICAgICAgICB0aGlzLl9vblRlcm1pbmF0ZSA9IG9uVGVybWluYXRlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiB0ZXJtaW5hdGVcbiAgICAgICAgICAgICAgICogQHJldHVybiB7dm9pZH1cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRlcm1pbmF0ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdGVybWluYXRlKCkge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAoX2EgPSB0aGlzLl9vblRlcm1pbmF0ZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfZ2V0UmVjdEludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0UmVjdEludGVybmFsKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tb2RlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjdDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3JlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlY3Q7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ncmlkLmdldENlbGxSZWxhdGl2ZVJlY3QodGhpcy5fY29sLCB0aGlzLl9yb3cpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gRHJhd0NlbGxDb250ZXh0O1xuICAgICAgICAgIH0oKTtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgdmFyIHByb3RlY3RlZEtleSA9IF87XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogRHJhd0dyaWRcbiAgICAgICAgICAgKiBAY2xhc3NkZXNjIGNoZWV0YWhHcmlkLmNvcmUuRHJhd0dyaWRcbiAgICAgICAgICAgKiBAbWVtYmVyb2YgY2hlZXRhaEdyaWQuY29yZVxuICAgICAgICAgICAqL1xuXG4gICAgICAgICAgdmFyIERyYXdHcmlkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXZlbnRUYXJnZXRfMSRFdmVudFQ0KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoRHJhd0dyaWQsIF9FdmVudFRhcmdldF8xJEV2ZW50VDQpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNTAgPSBfY3JlYXRlU3VwZXIoRHJhd0dyaWQpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBEcmF3R3JpZCgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNzQ7XG5cbiAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEcmF3R3JpZCk7XG5cbiAgICAgICAgICAgICAgX3RoaXM3NCA9IF9zdXBlcjUwLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgIHZhciBfb3B0aW9ucyRyb3dDb3VudCA9IG9wdGlvbnMucm93Q291bnQsXG4gICAgICAgICAgICAgICAgICByb3dDb3VudCA9IF9vcHRpb25zJHJvd0NvdW50ID09PSB2b2lkIDAgPyAxMCA6IF9vcHRpb25zJHJvd0NvdW50LFxuICAgICAgICAgICAgICAgICAgX29wdGlvbnMkY29sQ291bnQgPSBvcHRpb25zLmNvbENvdW50LFxuICAgICAgICAgICAgICAgICAgY29sQ291bnQgPSBfb3B0aW9ucyRjb2xDb3VudCA9PT0gdm9pZCAwID8gMTAgOiBfb3B0aW9ucyRjb2xDb3VudCxcbiAgICAgICAgICAgICAgICAgIF9vcHRpb25zJGZyb3plbkNvbENvdSA9IG9wdGlvbnMuZnJvemVuQ29sQ291bnQsXG4gICAgICAgICAgICAgICAgICBmcm96ZW5Db2xDb3VudCA9IF9vcHRpb25zJGZyb3plbkNvbENvdSA9PT0gdm9pZCAwID8gMCA6IF9vcHRpb25zJGZyb3plbkNvbENvdSxcbiAgICAgICAgICAgICAgICAgIF9vcHRpb25zJGZyb3plblJvd0NvdSA9IG9wdGlvbnMuZnJvemVuUm93Q291bnQsXG4gICAgICAgICAgICAgICAgICBmcm96ZW5Sb3dDb3VudCA9IF9vcHRpb25zJGZyb3plblJvd0NvdSA9PT0gdm9pZCAwID8gMCA6IF9vcHRpb25zJGZyb3plblJvd0NvdSxcbiAgICAgICAgICAgICAgICAgIF9vcHRpb25zJGRlZmF1bHRSb3dIZSA9IG9wdGlvbnMuZGVmYXVsdFJvd0hlaWdodCxcbiAgICAgICAgICAgICAgICAgIGRlZmF1bHRSb3dIZWlnaHQgPSBfb3B0aW9ucyRkZWZhdWx0Um93SGUgPT09IHZvaWQgMCA/IDQwIDogX29wdGlvbnMkZGVmYXVsdFJvd0hlLFxuICAgICAgICAgICAgICAgICAgX29wdGlvbnMkZGVmYXVsdENvbFdpID0gb3B0aW9ucy5kZWZhdWx0Q29sV2lkdGgsXG4gICAgICAgICAgICAgICAgICBkZWZhdWx0Q29sV2lkdGggPSBfb3B0aW9ucyRkZWZhdWx0Q29sV2kgPT09IHZvaWQgMCA/IDgwIDogX29wdGlvbnMkZGVmYXVsdENvbFdpLFxuICAgICAgICAgICAgICAgICAgZm9udCA9IG9wdGlvbnMuZm9udCxcbiAgICAgICAgICAgICAgICAgIHVuZGVybGF5QmFja2dyb3VuZENvbG9yID0gb3B0aW9ucy51bmRlcmxheUJhY2tncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICAgIGtleWJvYXJkT3B0aW9ucyA9IG9wdGlvbnMua2V5Ym9hcmRPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudCA9IG9wdGlvbnMucGFyZW50RWxlbWVudCxcbiAgICAgICAgICAgICAgICAgIGRpc2FibGVDb2x1bW5SZXNpemUgPSBvcHRpb25zLmRpc2FibGVDb2x1bW5SZXNpemUsXG4gICAgICAgICAgICAgICAgICB0cmltT25QYXN0ZSA9IG9wdGlvbnMudHJpbU9uUGFzdGU7XG4gICAgICAgICAgICAgIHZhciBwcm90ZWN0ZWRTcGFjZSA9IF90aGlzNzRbX10gPSB7fTtcbiAgICAgICAgICAgICAgc3R5bGUuaW5pdERvY3VtZW50KCk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmVsZW1lbnQgPSBjcmVhdGVSb290RWxlbWVudCgpO1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5zY3JvbGxhYmxlID0gbmV3IFNjcm9sbGFibGVfMS5TY3JvbGxhYmxlKCk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmhhbmRsZXIgPSBuZXcgRXZlbnRIYW5kbGVyXzEuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLnNlbGVjdGlvbiA9IG5ldyBTZWxlY3Rpb24oX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczc0KSk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmZvY3VzQ29udHJvbCA9IG5ldyBGb2N1c0NvbnRyb2woX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczc0KSwgcHJvdGVjdGVkU3BhY2Uuc2Nyb2xsYWJsZS5nZXRFbGVtZW50KCksIHByb3RlY3RlZFNwYWNlLnNjcm9sbGFibGUsIHByb3RlY3RlZFNwYWNlLnNlbGVjdGlvbik7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmNhbnZhcyA9IGhpRFBJLnRyYW5zZm9ybShkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpKTtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuY29udGV4dCA9IHByb3RlY3RlZFNwYWNlLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiwge1xuICAgICAgICAgICAgICAgIGFscGhhOiBmYWxzZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2Uucm93Q291bnQgPSByb3dDb3VudDtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuY29sQ291bnQgPSBjb2xDb3VudDtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuZnJvemVuQ29sQ291bnQgPSBmcm96ZW5Db2xDb3VudDtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuZnJvemVuUm93Q291bnQgPSBmcm96ZW5Sb3dDb3VudDtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuZGVmYXVsdFJvd0hlaWdodCA9IGRlZmF1bHRSb3dIZWlnaHQ7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmRlZmF1bHRDb2xXaWR0aCA9IGRlZmF1bHRDb2xXaWR0aDtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuZm9udCA9IGZvbnQ7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLnVuZGVybGF5QmFja2dyb3VuZENvbG9yID0gdW5kZXJsYXlCYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmtleWJvYXJkT3B0aW9ucyA9IGtleWJvYXJkT3B0aW9ucztcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuZGlzYWJsZUNvbHVtblJlc2l6ZSA9IGRpc2FibGVDb2x1bW5SZXNpemU7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLnRyaW1PblBhc3RlID0gdHJpbU9uUGFzdGUgIT09IG51bGwgJiYgdHJpbU9uUGFzdGUgIT09IHZvaWQgMCA/IHRyaW1PblBhc3RlIDogZmFsc2U7IC8vLy8vXG5cbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2Uucm93SGVpZ2h0c01hcCA9IG5ldyBOdW1iZXJNYXBfMS5OdW1iZXJNYXAoKTtcbiAgICAgICAgICAgICAgcHJvdGVjdGVkU3BhY2UuY29sV2lkdGhzTWFwID0gbmV3IE51bWJlck1hcF8xLk51bWJlck1hcCgpO1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5jb2xXaWR0aHNMaW1pdCA9IHt9O1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5jYWxjV2lkdGhDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgIF86IHByb3RlY3RlZFNwYWNlLFxuXG4gICAgICAgICAgICAgICAgZ2V0IGZ1bGwoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fLmNhbnZhcy53aWR0aDtcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgZ2V0IGVtKCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuICgwLCBjYW52YXNlc18xLmdldEZvbnRTaXplKSh0aGlzLl8uY29udGV4dCwgdGhpcy5fLmZvbnQpLndpZHRoO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5jb2x1bW5SZXNpemVyID0gbmV3IENvbHVtblJlc2l6ZXIoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczc0KSk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmNlbGxTZWxlY3RvciA9IG5ldyBDZWxsU2VsZWN0b3IoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczc0KSk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmRyYXdDZWxscyA9IHt9O1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5jZWxsVGV4dE92ZXJmbG93cyA9IHt9O1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5mb2N1c2VkR3JpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5lbGVtZW50LmFwcGVuZENoaWxkKHByb3RlY3RlZFNwYWNlLmNhbnZhcyk7XG4gICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmVsZW1lbnQuYXBwZW5kQ2hpbGQocHJvdGVjdGVkU3BhY2Uuc2Nyb2xsYWJsZS5nZXRFbGVtZW50KCkpO1xuICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5zY3JvbGwgPSB7XG4gICAgICAgICAgICAgICAgbGVmdDogMCxcbiAgICAgICAgICAgICAgICB0b3A6IDBcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICBfdGhpczc0LnVwZGF0ZVNjcm9sbCgpO1xuXG4gICAgICAgICAgICAgIGlmIChwYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChwcm90ZWN0ZWRTcGFjZS5lbGVtZW50KTtcblxuICAgICAgICAgICAgICAgIF90aGlzNzQudXBkYXRlU2l6ZSgpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzNzQudXBkYXRlU2l6ZSgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2JpbmRFdmVudHMuY2FsbChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzNzQpKTtcblxuICAgICAgICAgICAgICBfdGhpczc0LmJpbmRFdmVudHNJbnRlcm5hbCgpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczc0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZXQgcm9vdCBlbGVtZW50LlxuICAgICAgICAgICAgICogQHJldHVybnMge0hUTUxFbGVtZW50fSByb290IGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhEcmF3R3JpZCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImdldEVsZW1lbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVsZW1lbnQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10uZWxlbWVudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IGNhbnZhcyBlbGVtZW50LlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FudmFzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW19dLmNhbnZhcztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogRm9jdXMgdGhlIGdyaWQuXG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmb2N1c1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9jdXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF8kc2VsZWN0aW9uJHNlbDIgPSB0aGlzW19dLnNlbGVjdGlvbi5zZWxlY3QsXG4gICAgICAgICAgICAgICAgICAgIGNvbCA9IF90aGlzJF8kc2VsZWN0aW9uJHNlbDIuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3cgPSBfdGhpcyRfJHNlbGVjdGlvbiRzZWwyLnJvdztcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzQ2VsbChjb2wsIHJvdyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImhhc0ZvY3VzR3JpZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFzRm9jdXNHcmlkKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW19dLmZvY3VzZWRHcmlkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIHNlbGVjdGlvbiBpbnN0YW5jZS5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNlbGVjdGlvblwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5zZWxlY3Rpb247XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgbnVtYmVyIG9mIHJvd3MuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJyb3dDb3VudFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5yb3dDb3VudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0IHRoZSBudW1iZXIgb2Ygcm93cy5cbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQocm93Q291bnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzW19dLnJvd0NvdW50ID0gcm93Q291bnQ7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzW19dLnNlbGVjdGlvbi5fdXBkYXRlR3JpZFJhbmdlKCkpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfJHNlbGVjdGlvbiRmb2MgPSB0aGlzW19dLnNlbGVjdGlvbi5mb2N1cyxcbiAgICAgICAgICAgICAgICAgICAgICBjb2wgPSBfdGhpcyRfJHNlbGVjdGlvbiRmb2MuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IF90aGlzJF8kc2VsZWN0aW9uJGZvYy5yb3c7XG4gICAgICAgICAgICAgICAgICB0aGlzLm1ha2VWaXNpYmxlQ2VsbChjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldEZvY3VzQ3Vyc29yKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgbnVtYmVyIG9mIGNvbHVtbnMuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb2xDb3VudFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5jb2xDb3VudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0IHRoZSBudW1iZXIgb2YgY29sdW1ucy5cbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY29sQ291bnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzW19dLmNvbENvdW50ID0gY29sQ291bnQ7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzW19dLnNlbGVjdGlvbi5fdXBkYXRlR3JpZFJhbmdlKCkpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfJHNlbGVjdGlvbiRmb2MyID0gdGhpc1tfXS5zZWxlY3Rpb24uZm9jdXMsXG4gICAgICAgICAgICAgICAgICAgICAgY29sID0gX3RoaXMkXyRzZWxlY3Rpb24kZm9jMi5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93ID0gX3RoaXMkXyRzZWxlY3Rpb24kZm9jMi5yb3c7XG4gICAgICAgICAgICAgICAgICB0aGlzLm1ha2VWaXNpYmxlQ2VsbChjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldEZvY3VzQ3Vyc29yKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgbnVtYmVyIG9mIGZyb3plbiBjb2x1bW5zLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZnJvemVuQ29sQ291bnRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10uZnJvemVuQ29sQ291bnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFNldCB0aGUgbnVtYmVyIG9mIGZyb3plbiBjb2x1bW5zLlxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgLFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChmcm96ZW5Db2xDb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXNbX10uZnJvemVuQ29sQ291bnQgPSBmcm96ZW5Db2xDb3VudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSBudW1iZXIgb2YgZnJvemVuIHJvd3MuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmcm96ZW5Sb3dDb3VudFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5mcm96ZW5Sb3dDb3VudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0IHRoZSBudW1iZXIgb2YgZnJvemVuIHJvd3MuXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGZyb3plblJvd0NvdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpc1tfXS5mcm96ZW5Sb3dDb3VudCA9IGZyb3plblJvd0NvdW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGRlZmF1bHQgcm93IGhlaWdodC5cbiAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRlZmF1bHRSb3dIZWlnaHRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10uZGVmYXVsdFJvd0hlaWdodDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0IHRoZSBkZWZhdWx0IHJvdyBoZWlnaHQuXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGRlZmF1bHRSb3dIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzW19dLmRlZmF1bHRSb3dIZWlnaHQgPSBkZWZhdWx0Um93SGVpZ2h0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGRlZmF1bHQgY29sdW1uIHdpZHRoLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZGVmYXVsdENvbFdpZHRoXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW19dLmRlZmF1bHRDb2xXaWR0aDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0IHRoZSBkZWZhdWx0IGNvbHVtbiB3aWR0aC5cbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZGVmYXVsdENvbFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgdGhpc1tfXS5kZWZhdWx0Q29sV2lkdGggPSBkZWZhdWx0Q29sV2lkdGg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgZm9udCBkZWZpbml0aW9uIGFzIGEgc3RyaW5nLlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZm9udFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5mb250O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXQgdGhlIGZvbnQgZGVmaW5pdGlvbiB3aXRoIHRoZSBnaXZlbiBzdHJpbmcuXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGZvbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzW19dLmZvbnQgPSBmb250O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGJhY2tncm91bmQgY29sb3Igb2YgdGhlIHVuZGVybGF5LlxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidW5kZXJsYXlCYWNrZ3JvdW5kQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10udW5kZXJsYXlCYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFNldCB0aGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgdW5kZXJsYXkuXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAsXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHVuZGVybGF5QmFja2dyb3VuZENvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpc1tfXS51bmRlcmxheUJhY2tncm91bmRDb2xvciA9IHVuZGVybGF5QmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdHJpbSB0aGUgcGFzdGVkIHRleHQgb24gcGFzdGluZy5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRyaW1PblBhc3RlXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW19dLnRyaW1PblBhc3RlO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh0cmltT25QYXN0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXNbX10udHJpbU9uUGFzdGUgPSB0cmltT25QYXN0ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwia2V5Ym9hcmRPcHRpb25zXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICAgIHJldHVybiAoX2EgPSB0aGlzW19dLmtleWJvYXJkT3B0aW9ucykgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbnVsbDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoa2V5Ym9hcmRPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpc1tfXS5rZXlib2FyZE9wdGlvbnMgPSBrZXlib2FyZE9wdGlvbnMgIT09IG51bGwgJiYga2V5Ym9hcmRPcHRpb25zICE9PSB2b2lkIDAgPyBrZXlib2FyZE9wdGlvbnMgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY29uZmlndXJlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb25maWd1cmUobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2ZnID0gdGhpc1tfXS5jb25maWcgfHwgKHRoaXNbX10uY29uZmlnID0ge30pO1xuXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIGNmZ1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBjZmdbbmFtZV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEFwcGx5IHRoZSBjaGFuZ2VkIHNpemUuXG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ1cGRhdGVTaXplXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVTaXplKCkge1xuICAgICAgICAgICAgICAgIC8v44K544K/44Kk44Or44KS44Kv44Oq44Ki44GX44Gm44K144Kk44K65YCk44KS5Y+W5b6XXG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IHRoaXNbX10uY2FudmFzO1xuICAgICAgICAgICAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gTWF0aC5mbG9vcihjYW52YXMub2Zmc2V0V2lkdGggfHwgY2FudmFzLnBhcmVudEVsZW1lbnQub2Zmc2V0V2lkdGggLSBzdHlsZS5nZXRTY3JvbGxCYXJTaXplKClcbiAgICAgICAgICAgICAgICAvKmZvciBsZWdhY3kqL1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IE1hdGguZmxvb3IoY2FudmFzLm9mZnNldEhlaWdodCB8fCBjYW52YXMucGFyZW50RWxlbWVudC5vZmZzZXRIZWlnaHQgLSBzdHlsZS5nZXRTY3JvbGxCYXJTaXplKClcbiAgICAgICAgICAgICAgICAvKmZvciBsZWdhY3kqL1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDsgLy/mlbTmlbDjgafkuIDoh7TjgZXjgZvjgovjgZ/jgoFzdHlsZeOCkuOCu+ODg+ODiOOBl+OBpui/lOOBmVxuXG4gICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlLndpZHRoID0gXCJcIi5jb25jYXQod2lkdGgsIFwicHhcIik7XG4gICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IFwiXCIuY29uY2F0KGhlaWdodCwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9jdXMgPSB0aGlzW19dLnNlbGVjdGlvbi5mb2N1cztcblxuICAgICAgICAgICAgICAgIHRoaXNbX10uZm9jdXNDb250cm9sLnNldEZvY3VzUmVjdCh0aGlzLmdldENlbGxSZWN0KGZvY3VzLmNvbCwgZm9jdXMucm93KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEFwcGx5IHRoZSBjaGFuZ2VkIHNjcm9sbCBzaXplLlxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBgdHJ1ZWAgaWYgdGhlcmUgd2FzIGEgY2hhbmdlIGluIHRoZSBzY3JvbGwgc2l6ZVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidXBkYXRlU2Nyb2xsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVTY3JvbGwoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbGFibGUgPSB0aGlzW19dLnNjcm9sbGFibGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV3SGVpZ2h0ID0gX2dldFNjcm9sbEhlaWdodC5jYWxsKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ld1dpZHRoID0gX2dldFNjcm9sbFdpZHRoKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG5ld0hlaWdodCA9PT0gc2Nyb2xsYWJsZS5zY3JvbGxIZWlnaHQgJiYgbmV3V2lkdGggPT09IHNjcm9sbGFibGUuc2Nyb2xsV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzY3JvbGxhYmxlLnNldFNjcm9sbFNpemUobmV3V2lkdGgsIG5ld0hlaWdodCk7XG4gICAgICAgICAgICAgICAgdGhpc1tfXS5zY3JvbGwgPSB7XG4gICAgICAgICAgICAgICAgICBsZWZ0OiBzY3JvbGxhYmxlLnNjcm9sbExlZnQsXG4gICAgICAgICAgICAgICAgICB0b3A6IHNjcm9sbGFibGUuc2Nyb2xsVG9wXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgZm9jdXMgPSB0aGlzW19dLnNlbGVjdGlvbi5mb2N1cztcblxuICAgICAgICAgICAgICAgIHRoaXNbX10uZm9jdXNDb250cm9sLnNldEZvY3VzUmVjdCh0aGlzLmdldENlbGxSZWN0KGZvY3VzLmNvbCwgZm9jdXMucm93KSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSByb3cgaGVpZ2h0IG9mIHRoZSBnaXZlbiB0aGUgcm93IGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHJvdyBUaGUgcm93IGluZGV4XG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIHJvdyBoZWlnaHRcbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldFJvd0hlaWdodFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Um93SGVpZ2h0KHJvdykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0Um93SGVpZ2h0LmNhbGwodGhpcywgcm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0IHRoZSByb3cgaGVpZ2h0IG9mIHRoZSBnaXZlbiB0aGUgcm93IGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHJvdyBUaGUgcm93IGluZGV4XG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gaGVpZ2h0IFRoZSByb3cgaGVpZ2h0XG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzZXRSb3dIZWlnaHRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFJvd0hlaWdodChyb3csIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIF9zZXRSb3dIZWlnaHQodGhpcywgcm93LCBoZWlnaHQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGNvbHVtbiB3aWR0aCBvZiB0aGUgZ2l2ZW4gdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBjb2wgVGhlIGNvbHVtbiBpbmRleFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBjb2x1bW4gd2lkdGhcbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENvbFdpZHRoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb2xXaWR0aChjb2wpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldENvbFdpZHRoKHRoaXMsIGNvbCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFNldCB0aGUgY29sdW1uIHdpZHRoIG9mIHRoZSBnaXZlbiB0aGUgY29sdW1uIGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGNvbCBUaGUgY29sdW1uIGluZGV4XG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gd2lkdGggVGhlIGNvbHVtbiB3aWR0aFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2V0Q29sV2lkdGhcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbFdpZHRoKGNvbCwgd2lkdGgpIHtcbiAgICAgICAgICAgICAgICBfc2V0Q29sV2lkdGgodGhpcywgY29sLCB3aWR0aCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgY29sdW1uIG1heCB3aWR0aCBvZiB0aGUgZ2l2ZW4gdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBjb2wgVGhlIGNvbHVtbiBpbmRleFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBjb2x1bW4gbWF4IHdpZHRoXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRNYXhDb2xXaWR0aFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWF4Q29sV2lkdGgoY29sKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHRoaXNbX10uY29sV2lkdGhzTGltaXRbY29sXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqICYmIG9iai5tYXggfHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXQgdGhlIGNvbHVtbiBtYXggd2lkdGggb2YgdGhlIGdpdmVuIHRoZSBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sIFRoZSBjb2x1bW4gaW5kZXhcbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBtYXh3aWR0aCBUaGUgY29sdW1uIG1heCB3aWR0aFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2V0TWF4Q29sV2lkdGhcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1heENvbFdpZHRoKGNvbCwgbWF4d2lkdGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gdGhpc1tfXS5jb2xXaWR0aHNMaW1pdFtjb2xdIHx8ICh0aGlzW19dLmNvbFdpZHRoc0xpbWl0W2NvbF0gPSB7fSk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWF4d2lkdGggIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgb2JqLm1heCA9IG1heHdpZHRoO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBkZWxldGUgb2JqLm1heDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgY29sdW1uIG1pbiB3aWR0aCBvZiB0aGUgZ2l2ZW4gdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBjb2wgVGhlIGNvbHVtbiBpbmRleFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBjb2x1bW4gbWluIHdpZHRoXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRNaW5Db2xXaWR0aFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWluQ29sV2lkdGgoY29sKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHRoaXNbX10uY29sV2lkdGhzTGltaXRbY29sXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqICYmIG9iai5taW4gfHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBTZXQgdGhlIGNvbHVtbiBtaW4gd2lkdGggb2YgdGhlIGdpdmVuIHRoZSBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sIFRoZSBjb2x1bW4gaW5kZXhcbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBtaW53aWR0aCBUaGUgY29sdW1uIG1pbiB3aWR0aFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2V0TWluQ29sV2lkdGhcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1pbkNvbFdpZHRoKGNvbCwgbWlud2lkdGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gdGhpc1tfXS5jb2xXaWR0aHNMaW1pdFtjb2xdIHx8ICh0aGlzW19dLmNvbFdpZHRoc0xpbWl0W2NvbF0gPSB7fSk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWlud2lkdGggIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgb2JqLm1pbiA9IG1pbndpZHRoO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBkZWxldGUgb2JqLm1pbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgcmVjdCBvZiB0aGUgY2VsbC5cbiAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbCBpbmRleCBvZiBjb2x1bW4sIG9mIHRoZSBjZWxsXG4gICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSByb3cgaW5kZXggb2Ygcm93LCBvZiB0aGUgY2VsbFxuICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7UmVjdH0gdGhlIHJlY3Qgb2YgdGhlIGNlbGwuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDZWxsUmVjdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbFJlY3QoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNGcm96ZW5DZWxsID0gdGhpcy5pc0Zyb3plbkNlbGwoY29sLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFic29sdXRlTGVmdCA9IF9nZXRDb2xzV2lkdGgodGhpcywgMCwgY29sIC0gMSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBfZ2V0Q29sV2lkdGgodGhpcywgY29sKTtcblxuICAgICAgICAgICAgICAgIGlmIChpc0Zyb3plbkNlbGwgJiYgaXNGcm96ZW5DZWxsLmNvbCkge1xuICAgICAgICAgICAgICAgICAgYWJzb2x1dGVMZWZ0ICs9IHRoaXNbX10uc2Nyb2xsLmxlZnQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGFic29sdXRlVG9wID0gX2dldFJvd3NIZWlnaHQuY2FsbCh0aGlzLCAwLCByb3cgLSAxKTtcblxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBfZ2V0Um93SGVpZ2h0LmNhbGwodGhpcywgcm93KTtcblxuICAgICAgICAgICAgICAgIGlmIChpc0Zyb3plbkNlbGwgJiYgaXNGcm96ZW5DZWxsLnJvdykge1xuICAgICAgICAgICAgICAgICAgYWJzb2x1dGVUb3AgKz0gdGhpc1tfXS5zY3JvbGwudG9wO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjdF8xLlJlY3QoYWJzb2x1dGVMZWZ0LCBhYnNvbHV0ZVRvcCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgcmVsYXRpdmUgcmVjdGFuZ2xlIG9mIHRoZSBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gY29sIGluZGV4IG9mIGNvbHVtbiwgb2YgdGhlIGNlbGxcbiAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdyBpbmRleCBvZiByb3csIG9mIHRoZSBjZWxsXG4gICAgICAgICAgICAgICAqIEByZXR1cm5zIHtSZWN0fSB0aGUgcmVjdCBvZiB0aGUgY2VsbC5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENlbGxSZWxhdGl2ZVJlY3RcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENlbGxSZWxhdGl2ZVJlY3QoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RvUmVsYXRpdmVSZWN0KHRoaXMsIHRoaXMuZ2V0Q2VsbFJlY3QoY29sLCByb3cpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSByZWN0YW5nbGUgb2YgdGhlIGNlbGxzIGFyZWEuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydENvbCBpbmRleCBvZiB0aGUgc3RhcnRpbmcgY29sdW1uLCBvZiB0aGUgY2VsbFxuICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRSb3cgaW5kZXggb2YgdGhlIHN0YXJ0aW5nIHJvdywgb2YgdGhlIGNlbGxcbiAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZENvbCBpbmRleCBvZiB0aGUgZW5kaW5nIGNvbHVtbiwgb2YgdGhlIGNlbGxcbiAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZFJvdyBpbmRleCBvZiB0aGUgZW5kaW5nIHJvdywgb2YgdGhlIGNlbGxcbiAgICAgICAgICAgICAgICogQHJldHVybnMge1JlY3R9IHRoZSByZWN0IG9mIHRoZSBjZWxscy5cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENlbGxzUmVjdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbHNSZWN0KHN0YXJ0Q29sLCBzdGFydFJvdywgZW5kQ29sLCBlbmRSb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNGcm96ZW5TdGFydENlbGwgPSB0aGlzLmlzRnJvemVuQ2VsbChzdGFydENvbCwgc3RhcnRSb3cpO1xuICAgICAgICAgICAgICAgIHZhciBpc0Zyb3plbkVuZENlbGwgPSB0aGlzLmlzRnJvemVuQ2VsbChlbmRDb2wsIGVuZFJvdyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYWJzb2x1dGVMZWZ0ID0gX2dldENvbHNXaWR0aCh0aGlzLCAwLCBzdGFydENvbCAtIDEpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gX2dldENvbHNXaWR0aCh0aGlzLCBzdGFydENvbCwgZW5kQ29sKTtcblxuICAgICAgICAgICAgICAgIGlmIChpc0Zyb3plblN0YXJ0Q2VsbCAmJiBpc0Zyb3plblN0YXJ0Q2VsbC5jb2wpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBzY3JvbGxMZWZ0ID0gdGhpc1tfXS5zY3JvbGwubGVmdDtcbiAgICAgICAgICAgICAgICAgIGFic29sdXRlTGVmdCArPSBzY3JvbGxMZWZ0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIWlzRnJvemVuRW5kQ2VsbCB8fCAhaXNGcm96ZW5FbmRDZWxsLmNvbCkge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAtPSBzY3JvbGxMZWZ0O1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IE1hdGgubWF4KHdpZHRoLCBfZ2V0Q29sc1dpZHRoKHRoaXMsIHN0YXJ0Q29sLCB0aGlzLmZyb3plbkNvbENvdW50IC0gMSkpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBhYnNvbHV0ZVRvcCA9IF9nZXRSb3dzSGVpZ2h0LmNhbGwodGhpcywgMCwgc3RhcnRSb3cgLSAxKTtcblxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBfZ2V0Um93c0hlaWdodC5jYWxsKHRoaXMsIHN0YXJ0Um93LCBlbmRSb3cpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuU3RhcnRDZWxsICYmIGlzRnJvemVuU3RhcnRDZWxsLnJvdykge1xuICAgICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9IHRoaXNbX10uc2Nyb2xsLnRvcDtcbiAgICAgICAgICAgICAgICAgIGFic29sdXRlVG9wICs9IHNjcm9sbFRvcDtcblxuICAgICAgICAgICAgICAgICAgaWYgKCFpc0Zyb3plbkVuZENlbGwgfHwgIWlzRnJvemVuRW5kQ2VsbC5yb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IC09IHNjcm9sbFRvcDtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5tYXgoaGVpZ2h0LCBfZ2V0Q29sc1dpZHRoKHRoaXMsIHN0YXJ0Um93LCB0aGlzLmZyb3plblJvd0NvdW50IC0gMSkpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjdF8xLlJlY3QoYWJzb2x1dGVMZWZ0LCBhYnNvbHV0ZVRvcCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENlbGxSYW5nZVJlY3RcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENlbGxSYW5nZVJlY3QocmFuZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDZWxsc1JlY3QocmFuZ2Uuc3RhcnQuY29sLCByYW5nZS5zdGFydC5yb3csIHJhbmdlLmVuZC5jb2wsIHJhbmdlLmVuZC5yb3cpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJpc0Zyb3plbkNlbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzRnJvemVuQ2VsbChjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfID0gdGhpc1tfXSxcbiAgICAgICAgICAgICAgICAgICAgZnJvemVuUm93Q291bnQgPSBfdGhpcyRfLmZyb3plblJvd0NvdW50LFxuICAgICAgICAgICAgICAgICAgICBmcm96ZW5Db2xDb3VudCA9IF90aGlzJF8uZnJvemVuQ29sQ291bnQ7XG4gICAgICAgICAgICAgICAgdmFyIGlzRnJvemVuUm93ID0gZnJvemVuUm93Q291bnQgPiAwICYmIHJvdyA8IGZyb3plblJvd0NvdW50O1xuICAgICAgICAgICAgICAgIHZhciBpc0Zyb3plbkNvbCA9IGZyb3plbkNvbENvdW50ID4gMCAmJiBjb2wgPCBmcm96ZW5Db2xDb3VudDtcblxuICAgICAgICAgICAgICAgIGlmIChpc0Zyb3plblJvdyB8fCBpc0Zyb3plbkNvbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcm93OiBpc0Zyb3plblJvdyxcbiAgICAgICAgICAgICAgICAgICAgY29sOiBpc0Zyb3plbkNvbFxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRSb3dBdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Um93QXQoYWJzb2x1dGVZKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyb3plbiA9IF9nZXRUYXJnZXRGcm96ZW5Sb3dBdCh0aGlzLCBhYnNvbHV0ZVkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZyb3plbikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZyb3plbi5yb3c7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJvdyA9IF9nZXRUYXJnZXRSb3dBdC5jYWxsKHRoaXMsIGFic29sdXRlWSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcm93ID8gcm93LnJvdyA6IC0xO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDb2xBdFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29sQXQoYWJzb2x1dGVYKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyb3plbiA9IF9nZXRUYXJnZXRGcm96ZW5Db2xBdCh0aGlzLCBhYnNvbHV0ZVgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZyb3plbikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZyb3plbi5jb2w7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9nZXRUYXJnZXRDb2xBdCh0aGlzLCBhYnNvbHV0ZVgpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbCA/IGNvbC5jb2wgOiAtMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q2VsbEF0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDZWxsQXQoYWJzb2x1dGVYLCBhYnNvbHV0ZVkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgcm93OiB0aGlzLmdldFJvd0F0KGFic29sdXRlWSksXG4gICAgICAgICAgICAgICAgICBjb2w6IHRoaXMuZ2V0Q29sQXQoYWJzb2x1dGVYKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFNjcm9sbCB0byB3aGVyZSBjZWxsIGlzIHZpc2libGUuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sIFRoZSBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gcm93IFRoZSByb3cgaW5kZXhcbiAgICAgICAgICAgICAgICogQHJldHVybiB7dm9pZH1cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm1ha2VWaXNpYmxlQ2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVZpc2libGVDZWxsKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIGlzRnJvemVuQ2VsbCA9IHRoaXMuaXNGcm96ZW5DZWxsKGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgIGlmIChpc0Zyb3plbkNlbGwgJiYgaXNGcm96ZW5DZWxsLmNvbCAmJiBpc0Zyb3plbkNlbGwucm93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJlY3QgPSB0aGlzLmdldENlbGxSZWN0KGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgIHZhciB2aXNpYmxlUmVjdCA9IF9nZXRTY3JvbGxhYmxlVmlzaWJsZVJlY3QodGhpcyk7XG5cbiAgICAgICAgICAgICAgICBpZiAodmlzaWJsZVJlY3QuY29udGFpbnMocmVjdCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsYWJsZSA9IHRoaXNbX10uc2Nyb2xsYWJsZTtcblxuICAgICAgICAgICAgICAgIGlmICghaXNGcm96ZW5DZWxsIHx8ICFpc0Zyb3plbkNlbGwuY29sKSB7XG4gICAgICAgICAgICAgICAgICBpZiAocmVjdC5sZWZ0IDwgdmlzaWJsZVJlY3QubGVmdCkge1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGxhYmxlLnNjcm9sbExlZnQgLT0gdmlzaWJsZVJlY3QubGVmdCAtIHJlY3QubGVmdDtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmlzaWJsZVJlY3QucmlnaHQgPCByZWN0LnJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbGFibGUuc2Nyb2xsTGVmdCAtPSB2aXNpYmxlUmVjdC5yaWdodCAtIHJlY3QucmlnaHQ7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFpc0Zyb3plbkNlbGwgfHwgIWlzRnJvemVuQ2VsbC5yb3cpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChyZWN0LnRvcCA8IHZpc2libGVSZWN0LnRvcCkge1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGxhYmxlLnNjcm9sbFRvcCAtPSB2aXNpYmxlUmVjdC50b3AgLSByZWN0LnRvcDtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmlzaWJsZVJlY3QuYm90dG9tIDwgcmVjdC5ib3R0b20pIHtcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsYWJsZS5zY3JvbGxUb3AgLT0gdmlzaWJsZVJlY3QuYm90dG9tIC0gcmVjdC5ib3R0b207XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBNb3ZlcyB0aGUgZm9jdXMgY3Vyc29yIHRvIHRoZSBnaXZlbiBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGNvbCBUaGUgY29sdW1uIGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHJvdyBUaGUgcm93IGluZGV4XG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzZXRGb2N1c0N1cnNvclwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Rm9jdXNDdXJzb3IoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNDb250cm9sID0gdGhpc1tfXS5mb2N1c0NvbnRyb2w7XG4gICAgICAgICAgICAgICAgdmFyIG9sZEVkaXRNb2RlID0gZm9jdXNDb250cm9sLmVkaXRNb2RlO1xuICAgICAgICAgICAgICAgIGZvY3VzQ29udHJvbC5zZXRGb2N1c1JlY3QodGhpcy5nZXRDZWxsUmVjdChjb2wsIHJvdykpO1xuXG4gICAgICAgICAgICAgICAgX3VwZGF0ZWRTZWxlY3Rpb24uY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIGlmIChvbGRFZGl0TW9kZSAmJiAhZm9jdXNDb250cm9sLmVkaXRNb2RlKSB7XG4gICAgICAgICAgICAgICAgICBmb2N1c0NvbnRyb2wucmVzZXRJbnB1dFN0YXR1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogRm9jdXMgdGhlIGNlbGwuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sIFRoZSBjb2x1bW4gaW5kZXguXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0gcm93IFRoZSByb3cgaW5kZXhcbiAgICAgICAgICAgICAgICogQHJldHVybiB7dm9pZH1cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZvY3VzQ2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9jdXNDZWxsKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGb2N1c0N1cnNvcihjb2wsIHJvdyk7IC8vIEZhaWx1cmUgb2NjdXJzIGluIElFIGlmIGZvY3VzIGlzIG5vdCBsYXN0XG5cbiAgICAgICAgICAgICAgICB0aGlzW19dLmZvY3VzQ29udHJvbC5mb2N1cygpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBSZWRyYXdzIHRoZSByYW5nZSBvZiB0aGUgZ2l2ZW4gY2VsbC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBjb2wgVGhlIGNvbHVtbiBpbmRleCBvZiBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHJvdyBUaGUgcm93IGluZGV4IG9mIGNlbGwuXG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJpbnZhbGlkYXRlQ2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW52YWxpZGF0ZUNlbGwoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRhdGVHcmlkUmVjdChjb2wsIHJvdyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIFJlZHJhd3MgdGhlIHJhbmdlIG9mIHRoZSBnaXZlbiBjZWxscy5cbiAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0Q29sIGluZGV4IG9mIHRoZSBzdGFydGluZyBjb2x1bW4sIG9mIHRoZSBjZWxsXG4gICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydFJvdyBpbmRleCBvZiB0aGUgc3RhcnRpbmcgcm93LCBvZiB0aGUgY2VsbFxuICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kQ29sIGluZGV4IG9mIHRoZSBlbmRpbmcgY29sdW1uLCBvZiB0aGUgY2VsbFxuICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kUm93IGluZGV4IG9mIHRoZSBlbmRpbmcgcm93LCBvZiB0aGUgY2VsbFxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaW52YWxpZGF0ZUdyaWRSZWN0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZhbGlkYXRlR3JpZFJlY3Qoc3RhcnRDb2wsIHN0YXJ0Um93KSB7XG4gICAgICAgICAgICAgICAgdmFyIGVuZENvbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogc3RhcnRDb2w7XG4gICAgICAgICAgICAgICAgdmFyIGVuZFJvdyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogc3RhcnRSb3c7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMuZ2V0T2Zmc2V0SW52YWxpZGF0ZUNlbGxzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ID4gMCkge1xuICAgICAgICAgICAgICAgICAgc3RhcnRDb2wgLT0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgc3RhcnRSb3cgLT0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgZW5kQ29sICs9IG9mZnNldDtcbiAgICAgICAgICAgICAgICAgIGVuZFJvdyArPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHZpc2libGVSZWN0ID0gX2dldFZpc2libGVSZWN0KHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNlbGxzUmVjdCA9IHRoaXMuZ2V0Q2VsbHNSZWN0KHN0YXJ0Q29sLCBzdGFydFJvdywgZW5kQ29sLCBlbmRSb3cpO1xuICAgICAgICAgICAgICAgIHZhciBpbnZhbGlkYXRlVGFyZ2V0ID0gdmlzaWJsZVJlY3QuaW50ZXJzZWN0aW9uKGNlbGxzUmVjdCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW52YWxpZGF0ZVRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgdmFyIF90aGlzJF8yID0gdGhpc1tfXSxcbiAgICAgICAgICAgICAgICAgICAgICBmcm96ZW5Db2xDb3VudCA9IF90aGlzJF8yLmZyb3plbkNvbENvdW50LFxuICAgICAgICAgICAgICAgICAgICAgIGZyb3plblJvd0NvdW50ID0gX3RoaXMkXzIuZnJvemVuUm93Q291bnQ7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChmcm96ZW5Db2xDb3VudCA+IDAgJiYgZW5kQ29sID49IGZyb3plbkNvbENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmcm96ZW5SZWN0ID0gX2dldEZyb3plbkNvbHNSZWN0KHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChmcm96ZW5SZWN0LmludGVyc2VjdGlvbihpbnZhbGlkYXRlVGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGVUYXJnZXQubGVmdCA9IE1hdGgubWluKGZyb3plblJlY3QucmlnaHQgLSAxLCBpbnZhbGlkYXRlVGFyZ2V0LmxlZnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChmcm96ZW5Sb3dDb3VudCA+IDAgJiYgZW5kUm93ID49IGZyb3plblJvd0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfZnJvemVuUmVjdDQgPSBfZ2V0RnJvemVuUm93c1JlY3QodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKF9mcm96ZW5SZWN0NC5pbnRlcnNlY3Rpb24oaW52YWxpZGF0ZVRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRlVGFyZ2V0LnRvcCA9IE1hdGgubWluKF9mcm96ZW5SZWN0NC5ib3R0b20gLSAxLCBpbnZhbGlkYXRlVGFyZ2V0LnRvcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX2ludmFsaWRhdGVSZWN0KHRoaXMsIGludmFsaWRhdGVUYXJnZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaW52YWxpZGF0ZUNlbGxSYW5nZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZUdyaWRSZWN0KHJhbmdlLnN0YXJ0LmNvbCwgcmFuZ2Uuc3RhcnQucm93LCByYW5nZS5lbmQuY29sLCByYW5nZS5lbmQucm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogUmVkcmF3cyB0aGUgd2hvbGUgZ3JpZC5cbiAgICAgICAgICAgICAgICogQHJldHVybiB7dm9pZH1cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImludmFsaWRhdGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGludmFsaWRhdGUoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZpc2libGVSZWN0ID0gX2dldFZpc2libGVSZWN0KHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgX2ludmFsaWRhdGVSZWN0KHRoaXMsIHZpc2libGVSZWN0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSBudW1iZXIgb2Ygc2Nyb2xsYWJsZSByb3dzIGZ1bGx5IHZpc2libGUgaW4gdGhlIGdyaWQuIHZpc2libGVSb3dDb3VudCBkb2VzIG5vdCBpbmNsdWRlIHRoZSBmcm96ZW4gcm93cyBjb3VudGVkIGJ5IHRoZSBmcm96ZW5Sb3dDb3VudCBwcm9wZXJ0eS4gSXQgZG9lcyBub3QgaW5jbHVkZSBhbnkgcGFydGlhbGx5IHZpc2libGUgcm93cyBvbiB0aGUgYm90dG9tIG9mIHRoZSBncmlkLlxuICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidmlzaWJsZVJvd0NvdW50XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBmcm96ZW5Sb3dDb3VudCA9IHRoaXMuZnJvemVuUm93Q291bnQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgdmlzaWJsZVJlY3QgPSBfZ2V0VmlzaWJsZVJlY3QodGhpcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdmlzaWJsZVRvcCA9IGZyb3plblJvd0NvdW50ID4gMCA/IHZpc2libGVSZWN0LnRvcCArIF9nZXRSb3dzSGVpZ2h0LmNhbGwodGhpcywgMCwgZnJvemVuUm93Q291bnQgLSAxKSA6IHZpc2libGVSZWN0LnRvcDtcblxuICAgICAgICAgICAgICAgIHZhciBpbml0Um93ID0gX2dldFRhcmdldFJvd0F0LmNhbGwodGhpcywgdmlzaWJsZVRvcCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWluaXRSb3cpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzdGFydFJvdyA9IE1hdGgubWF4KGluaXRSb3cudG9wID49IHZpc2libGVUb3AgPyBpbml0Um93LnJvdyA6IGluaXRSb3cucm93ICsgMSwgZnJvemVuUm93Q291bnQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFic29sdXRlVG9wID0gX2dldFJvd3NIZWlnaHQuY2FsbCh0aGlzLCAwLCBzdGFydFJvdyAtIDEpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgcm93Q291bnQgPSB0aGlzLnJvd0NvdW50O1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcm93ID0gc3RhcnRSb3c7IHJvdyA8IHJvd0NvdW50OyByb3crKykge1xuICAgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IF9nZXRSb3dIZWlnaHQuY2FsbCh0aGlzLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgYm90dG9tID0gYWJzb2x1dGVUb3AgKyBoZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh2aXNpYmxlUmVjdC5ib3R0b20gPCBib3R0b20pIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICBhYnNvbHV0ZVRvcCA9IGJvdHRvbTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgbnVtYmVyIG9mIHNjcm9sbGFibGUgY29sdW1ucyBmdWxseSB2aXNpYmxlIGluIHRoZSBncmlkLiB2aXNpYmxlQ29sQ291bnQgZG9lcyBub3QgaW5jbHVkZSB0aGUgZnJvemVuIGNvbHVtbnMgY291bnRlZCBieSB0aGUgZnJvemVuQ29sQ291bnQgcHJvcGVydHkuIEl0IGRvZXMgbm90IGluY2x1ZGUgYW55IHBhcnRpYWxseSB2aXNpYmxlIGNvbHVtbnMgb24gdGhlIHJpZ2h0IG9mIHRoZSBncmlkLlxuICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidmlzaWJsZUNvbENvdW50XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBmcm96ZW5Db2xDb3VudCA9IHRoaXMuZnJvemVuQ29sQ291bnQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgdmlzaWJsZVJlY3QgPSBfZ2V0VmlzaWJsZVJlY3QodGhpcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdmlzaWJsZUxlZnQgPSBmcm96ZW5Db2xDb3VudCA+IDAgPyB2aXNpYmxlUmVjdC5sZWZ0ICsgX2dldENvbHNXaWR0aCh0aGlzLCAwLCBmcm96ZW5Db2xDb3VudCAtIDEpIDogdmlzaWJsZVJlY3QubGVmdDtcblxuICAgICAgICAgICAgICAgIHZhciBpbml0Q29sID0gX2dldFRhcmdldENvbEF0KHRoaXMsIHZpc2libGVMZWZ0KTtcblxuICAgICAgICAgICAgICAgIGlmICghaW5pdENvbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0Q29sID0gTWF0aC5tYXgoaW5pdENvbC5sZWZ0ID49IHZpc2libGVMZWZ0ID8gaW5pdENvbC5jb2wgOiBpbml0Q29sLmNvbCArIDEsIGZyb3plbkNvbENvdW50KTtcblxuICAgICAgICAgICAgICAgIHZhciBhYnNvbHV0ZUxlZnQgPSBfZ2V0Q29sc1dpZHRoKHRoaXMsIDAsIHN0YXJ0Q29sIC0gMSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBjb2xDb3VudCA9IHRoaXMuY29sQ291bnQ7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSBzdGFydENvbDsgY29sIDwgY29sQ291bnQ7IGNvbCsrKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBfZ2V0Q29sV2lkdGgodGhpcywgY29sKTtcblxuICAgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gYWJzb2x1dGVMZWZ0ICsgd2lkdGg7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh2aXNpYmxlUmVjdC5yaWdodCA8IHJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgYWJzb2x1dGVMZWZ0ID0gcmlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBHZXQgdGhlIGluZGV4IG9mIHRoZSBmaXJzdCByb3cgaW4gdGhlIHNjcm9sbGFibGUgcmVnaW9uIHRoYXQgaXMgdmlzaWJsZS5cbiAgICAgICAgICAgICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRvcFJvd1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJvemVuUm93Q291bnQgPSB0aGlzLmZyb3plblJvd0NvdW50O1xuXG4gICAgICAgICAgICAgICAgdmFyIHZpc2libGVSZWN0ID0gX2dldFZpc2libGVSZWN0KHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHZpc2libGVUb3AgPSBmcm96ZW5Sb3dDb3VudCA+IDAgPyB2aXNpYmxlUmVjdC50b3AgKyBfZ2V0Um93c0hlaWdodC5jYWxsKHRoaXMsIDAsIGZyb3plblJvd0NvdW50IC0gMSkgOiB2aXNpYmxlUmVjdC50b3A7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5pdFJvdyA9IF9nZXRUYXJnZXRSb3dBdC5jYWxsKHRoaXMsIHZpc2libGVUb3ApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFpbml0Um93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoaW5pdFJvdy50b3AgPj0gdmlzaWJsZVRvcCA/IGluaXRSb3cucm93IDogaW5pdFJvdy5yb3cgKyAxLCBmcm96ZW5Sb3dDb3VudCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGNvbHVtbiBpbiB0aGUgc2Nyb2xsYWJsZSByZWdpb24gdGhhdCBpcyB2aXNpYmxlLlxuICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibGVmdENvbFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJvemVuQ29sQ291bnQgPSB0aGlzLmZyb3plbkNvbENvdW50O1xuXG4gICAgICAgICAgICAgICAgdmFyIHZpc2libGVSZWN0ID0gX2dldFZpc2libGVSZWN0KHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHZpc2libGVMZWZ0ID0gZnJvemVuQ29sQ291bnQgPiAwID8gdmlzaWJsZVJlY3QubGVmdCArIF9nZXRDb2xzV2lkdGgodGhpcywgMCwgZnJvemVuQ29sQ291bnQgLSAxKSA6IHZpc2libGVSZWN0LmxlZnQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5pdENvbCA9IF9nZXRUYXJnZXRDb2xBdCh0aGlzLCB2aXNpYmxlTGVmdCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWluaXRDb2wpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChpbml0Q29sLmxlZnQgPj0gdmlzaWJsZUxlZnQgPyBpbml0Q29sLmNvbCA6IGluaXRDb2wuY29sICsgMSwgZnJvemVuQ29sQ291bnQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBnZXRzIG9yIHNldHMgdGhlIG51bWJlciBvZiBwaXhlbHMgdGhhdCBhbiBlbGVtZW50J3MgY29udGVudCBpcyBzY3JvbGxlZCB2ZXJ0aWNhbGx5XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzY3JvbGxUb3BcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbX10uc2Nyb2xsYWJsZS5zY3JvbGxUb3A7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHNjcm9sbFRvcCkge1xuICAgICAgICAgICAgICAgIHRoaXNbX10uc2Nyb2xsYWJsZS5zY3JvbGxUb3AgPSBzY3JvbGxUb3A7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIGdldHMgb3Igc2V0cyB0aGUgbnVtYmVyIG9mIHBpeGVscyB0aGF0IGFuIGVsZW1lbnQncyBjb250ZW50IGlzIHNjcm9sbGVkIGZyb20gaXRzIGxlZnQgZWRnZVxuICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2Nyb2xsTGVmdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tfXS5zY3JvbGxhYmxlLnNjcm9sbExlZnQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHNjcm9sbExlZnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzW19dLnNjcm9sbGFibGUuc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEdldCB0aGUgdmFsdWUgb2YgY2VsbCB3aXRoIHRoZSBjb3B5IGFjdGlvbi5cbiAgICAgICAgICAgICAgICogPHA+XG4gICAgICAgICAgICAgICAqIFBsZWFzZSBpbXBsZW1lbnRcbiAgICAgICAgICAgICAgICogPC9wPlxuICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAgICAgICAqIEBwYXJhbSBjb2wgQ29sdW1uIGluZGV4IG9mIGNlbGwuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSByb3cgUm93IGluZGV4IG9mIGNlbGwuXG4gICAgICAgICAgICAgICAqIEBwYXJhbSByYW5nZSBDb3B5IHJhbmdlLlxuICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IHRoZSB2YWx1ZSBvZiBjZWxsXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDb3B5Q2VsbFZhbHVlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb3B5Q2VsbFZhbHVlKF9jb2wsIF9yb3csIF9yYW5nZSkge1xuICAgICAgICAgICAgICAgIC8vUGxlYXNlIGltcGxlbWVudCBnZXQgY2VsbCB2YWx1ZSEhXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogR2V0IHRoZSBvdmVyZmxvd2VkIHRleHQgaW4gdGhlIGNlbGwgcmVjdGFuZ2xlLCBmcm9tIHRoZSBnaXZlbiBjZWxsLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGNvbCBUaGUgY29sdW1uIGluZGV4LlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHJvdyBUaGUgcm93IGluZGV4XG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge3N0cmluZyB8IG51bGx9IFRoZSB0ZXh0IG92ZXJmbG93aW5nIHRoZSBjZWxsIHJlY3QuXG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDZWxsT3ZlcmZsb3dUZXh0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDZWxsT3ZlcmZsb3dUZXh0KGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IFwiXCIuY29uY2F0KGNvbCwgXCI6XCIpLmNvbmNhdChyb3cpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW19dLmNlbGxUZXh0T3ZlcmZsb3dzW2tleV0gfHwgbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogU2V0IHRoZSBvdmVyZmxvd2VkIHRleHQgaW4gdGhlIGNlbGwgcmVjdGFuZ2xlLCB0byB0aGUgZ2l2ZW4gY2VsbC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBjb2wgVGhlIGNvbHVtbiBpbmRleC5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSByb3cgVGhlIHJvdyBpbmRleFxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IG92ZXJmbG93VGV4dCBUaGUgb3ZlcmZsb3dlZCB0ZXh0IGluIHRoZSBjZWxsIHJlY3RhbmdsZS5cbiAgICAgICAgICAgICAgICogQHJldHVybiB7dm9pZH1cbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNldENlbGxPdmVyZmxvd1RleHRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldENlbGxPdmVyZmxvd1RleHQoY29sLCByb3csIG92ZXJmbG93VGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBcIlwiLmNvbmNhdChjb2wsIFwiOlwiKS5jb25jYXQocm93KTtcblxuICAgICAgICAgICAgICAgIGlmIChvdmVyZmxvd1RleHQpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXNbX10uY2VsbFRleHRPdmVyZmxvd3Nba2V5XSA9IHR5cGVvZiBvdmVyZmxvd1RleHQgPT09IFwic3RyaW5nXCIgPyBvdmVyZmxvd1RleHQudHJpbSgpIDogb3ZlcmZsb3dUZXh0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tfXS5jZWxsVGV4dE92ZXJmbG93c1trZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYWRkRGlzcG9zYWJsZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkRGlzcG9zYWJsZShkaXNwb3NhYmxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFkaXNwb3NhYmxlIHx8ICFkaXNwb3NhYmxlLmRpc3Bvc2UgfHwgdHlwZW9mIGRpc3Bvc2FibGUuZGlzcG9zZSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJub3QgZGlzcG9zYWJsZSFcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGRpc3Bvc2FibGVzID0gdGhpc1tfXS5kaXNwb3NhYmxlcyA9IHRoaXNbX10uZGlzcG9zYWJsZXMgfHwgW107XG4gICAgICAgICAgICAgICAgZGlzcG9zYWJsZXMucHVzaChkaXNwb3NhYmxlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogRGlzcG9zZSB0aGUgZ3JpZCBpbnN0YW5jZS5cbiAgICAgICAgICAgICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKERyYXdHcmlkLnByb3RvdHlwZSksIFwiZGlzcG9zZVwiLCB0aGlzKS5jYWxsKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb3RlY3RlZFNwYWNlID0gdGhpc1tfXTtcbiAgICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5oYW5kbGVyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5zY3JvbGxhYmxlLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5mb2N1c0NvbnRyb2wuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmNvbHVtblJlc2l6ZXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmNlbGxTZWxlY3Rvci5kaXNwb3NlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocHJvdGVjdGVkU3BhY2UuZGlzcG9zYWJsZXMpIHtcbiAgICAgICAgICAgICAgICAgIHByb3RlY3RlZFNwYWNlLmRpc3Bvc2FibGVzLmZvckVhY2goZnVuY3Rpb24gKGRpc3Bvc2FibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGUuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBwcm90ZWN0ZWRTcGFjZS5kaXNwb3NhYmxlcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudEVsZW1lbnQgPSBwcm90ZWN0ZWRTcGFjZS5lbGVtZW50LnBhcmVudEVsZW1lbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAocGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChwcm90ZWN0ZWRTcGFjZS5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldEF0dGFjaENlbGxzQXJlYVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QXR0YWNoQ2VsbHNBcmVhKHJhbmdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMuZ2V0RWxlbWVudCgpLFxuICAgICAgICAgICAgICAgICAgcmVjdDogX3RvUmVsYXRpdmVSZWN0KHRoaXMsIHRoaXMuZ2V0Q2VsbFJhbmdlUmVjdChyYW5nZSkpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25LZXlEb3duTW92ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25LZXlEb3duTW92ZShldnQpIHtcbiAgICAgICAgICAgICAgICBfb25LZXlEb3duTW92ZS5jYWxsKHRoaXMsIGV2dCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJpbmRFdmVudHNJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZEV2ZW50c0ludGVybmFsKCkgey8vbm9wXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldFRhcmdldFJvd0F0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRhcmdldFJvd0F0SW50ZXJuYWwoX2Fic29sdXRlWSkgey8v57aZ5om/55SoIOioreWumuOCkueEoeimluOBl+OBpuioiOeul+OBmeOCi+WgtOWQiOe2meaJv+OBl+OBpuWun+ijhVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRSb3dzSGVpZ2h0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJvd3NIZWlnaHRJbnRlcm5hbChfc3RhcnRSb3csIF9lbmRSb3cpIHsvL+e2meaJv+eUqCDoqK3lrprjgpLnhKHoppbjgZfjgaboqIjnrpfjgZnjgovloLTlkIjntpnmib/jgZfjgablrp/oo4VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Um93SGVpZ2h0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJvd0hlaWdodEludGVybmFsKF9yb3cpIHsvL+e2meaJv+eUqCDoqK3lrprjgpLnhKHoppbjgZfjgaboqIjnrpfjgZnjgovloLTlkIjntpnmib/jgZfjgablrp/oo4VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0U2Nyb2xsSGVpZ2h0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNjcm9sbEhlaWdodEludGVybmFsKF9yb3cpIHsvL+e2meaJv+eUqCDoqK3lrprjgpLnhKHoppbjgZfjgaboqIjnrpfjgZnjgovloLTlkIjntpnmib/jgZfjgablrp/oo4VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0TW92ZUxlZnRDb2xCeUtleURvd25JbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TW92ZUxlZnRDb2xCeUtleURvd25JbnRlcm5hbChfcmVmNTIpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29sID0gX3JlZjUyLmNvbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29sIC0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0TW92ZVJpZ2h0Q29sQnlLZXlEb3duSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1vdmVSaWdodENvbEJ5S2V5RG93bkludGVybmFsKF9yZWY1Mykge1xuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBfcmVmNTMuY29sO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2wgKyAxO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRNb3ZlVXBSb3dCeUtleURvd25JbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TW92ZVVwUm93QnlLZXlEb3duSW50ZXJuYWwoX3JlZjU0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdyA9IF9yZWY1NC5yb3c7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdyAtIDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldE1vdmVEb3duUm93QnlLZXlEb3duSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1vdmVEb3duUm93QnlLZXlEb3duSW50ZXJuYWwoX3JlZjU1KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdyA9IF9yZWY1NS5yb3c7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdyArIDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldE9mZnNldEludmFsaWRhdGVDZWxsc1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0T2Zmc2V0SW52YWxpZGF0ZUNlbGxzKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDb3B5UmFuZ2VJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29weVJhbmdlSW50ZXJuYWwocmFuZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9nZXRJbml0Q29udGV4dFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2dldEluaXRDb250ZXh0KCkge1xuICAgICAgICAgICAgICAgIHZhciBjdHggPSB0aGlzW19dLmNvbnRleHQ7IC8v5Yid5pyf5YyWXG5cbiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCJ3aGl0ZVwiO1xuICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gXCJsZWZ0XCI7XG4gICAgICAgICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9IFwidG9wXCI7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7XG4gICAgICAgICAgICAgICAgY3R4LmZvbnQgPSB0aGlzLmZvbnQgfHwgXCIxNnB4IHNhbnMtc2VyaWZcIjtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3R4O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmaXJlTGlzdGVuZXJzXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmaXJlTGlzdGVuZXJzKHR5cGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2dldDM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIGV2ZW50ID0gbmV3IEFycmF5KF9sZW40ID4gMSA/IF9sZW40IC0gMSA6IDApLCBfa2V5NCA9IDE7IF9rZXk0IDwgX2xlbjQ7IF9rZXk0KyspIHtcbiAgICAgICAgICAgICAgICAgIGV2ZW50W19rZXk0IC0gMV0gPSBhcmd1bWVudHNbX2tleTRdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiAoX2dldDMgPSBfZ2V0KF9nZXRQcm90b3R5cGVPZihEcmF3R3JpZC5wcm90b3R5cGUpLCBcImZpcmVMaXN0ZW5lcnNcIiwgdGhpcykpLmNhbGwuYXBwbHkoX2dldDMsIFt0aGlzLCB0eXBlXS5jb25jYXQoZXZlbnQpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJFVkVOVF9UWVBFXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gRHJhd0dyaWQ7XG4gICAgICAgICAgfShFdmVudFRhcmdldF8xLkV2ZW50VGFyZ2V0KTtcblxuICAgICAgICAgIGV4cG9ydHMuRHJhd0dyaWQgPSBEcmF3R3JpZDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9jb3JlL0V2ZW50VGFyZ2V0LmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9jb3JlL0V2ZW50VGFyZ2V0LmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBjb3JlRXZlbnRUYXJnZXRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkV2ZW50VGFyZ2V0ID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7IC8vcHJpdmF0ZSBzeW1ib2xcblxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICB2YXIgXyA9ICgwLCBzeW1ib2xNYW5hZ2VyXzEuZ2V0KSgpO1xuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICB2YXIgbmV4dElkID0gMTtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBldmVudCB0YXJnZXQuXG4gICAgICAgICAgICovXG5cbiAgICAgICAgICB2YXIgRXZlbnRUYXJnZXQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRXZlbnRUYXJnZXQoKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFdmVudFRhcmdldCk7XG5cbiAgICAgICAgICAgICAgdGhpc1tfYV0gPSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXJzOiB7fSxcbiAgICAgICAgICAgICAgICBsaXN0ZW5lckRhdGE6IHt9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgYW4gZXZlbnQgbGlzdGVuZXIuXG4gICAgICAgICAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IHR5cGUgVGhlIGV2ZW50IHR5cGUgaWQuXG4gICAgICAgICAgICAgKiBAcGFyYW0gIHtmdW5jdGlvbn0gbGlzdGVuZXIgQ2FsbGJhY2sgbWV0aG9kLlxuICAgICAgICAgICAgICogQHJldHVybiB7bnVtYmVyfSB1bmlxdWUgaWQgZm9yIHRoZSBsaXN0ZW5lci5cbiAgICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhFdmVudFRhcmdldCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImxpc3RlblwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbGlzdGVuKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzNzUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzW19dLmxpc3RlbmVyc1t0eXBlXSB8fCAodGhpc1tfXS5saXN0ZW5lcnNbdHlwZV0gPSBbXSk7XG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBuZXh0SWQrKztcbiAgICAgICAgICAgICAgICB0aGlzW19dLmxpc3RlbmVyRGF0YVtpZF0gPSB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgICAgbGlzdGVuZXI6IGxpc3RlbmVyLFxuICAgICAgICAgICAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpczc1W19dLmxpc3RlbmVyRGF0YVtpZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGxpc3QuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgICAgIGxpc3Quc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIV90aGlzNzVbX10ubGlzdGVuZXJzW3R5cGVdLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpczc1W19dLmxpc3RlbmVyc1t0eXBlXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBSZW1vdmVzIGFuIGV2ZW50IGxpc3RlbmVyIHdoaWNoIHdhcyBhZGRlZCB3aXRoIGxpc3RlbigpIGJ5IHRoZSBpZCByZXR1cm5lZCBieSBsaXN0ZW4oKS5cbiAgICAgICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBpZCB0aGUgaWQgcmV0dXJuZWQgYnkgbGlzdGVuKCkuXG4gICAgICAgICAgICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ1bmxpc3RlblwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5saXN0ZW4oaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXNbX10pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzW19dLmxpc3RlbmVyRGF0YVtpZF0ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImFkZEV2ZW50TGlzdGVuZXJcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Rlbih0eXBlLCBsaXN0ZW5lcik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJlbW92ZUV2ZW50TGlzdGVuZXJcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXM3NiA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXNbX10pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAoMCwgdXRpbHNfMS5lYWNoKSh0aGlzW19dLmxpc3RlbmVyRGF0YSwgZnVuY3Rpb24gKG9iaiwgaWQpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChvYmoudHlwZSA9PT0gdHlwZSAmJiBvYmoubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzNzYudW5saXN0ZW4oaWQpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoYXNMaXN0ZW5lcnNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhc0xpc3RlbmVycyh0eXBlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzW19dKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhdGhpc1tfXS5saXN0ZW5lcnNbdHlwZV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqIEZpcmVzIGFsbCByZWdpc3RlcmVkIGxpc3RlbmVyc1xuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgIHR5cGUgVGhlIHR5cGUgb2YgdGhlIGxpc3RlbmVycyB0byBmaXJlLlxuICAgICAgICAgICAgICAgKiBAcGFyYW0gIHsuLi4qfSBhcmdzIGZpcmUgYXJndW1lbnRzXG4gICAgICAgICAgICAgICAqIEByZXR1cm4geyp9IHRoZSByZXN1bHQgb2YgdGhlIGxhc3QgbGlzdGVuZXJcbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZpcmVMaXN0ZW5lcnNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpcmVMaXN0ZW5lcnModHlwZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczc3ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW41ID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuNSA+IDEgPyBfbGVuNSAtIDEgOiAwKSwgX2tleTUgPSAxOyBfa2V5NSA8IF9sZW41OyBfa2V5NSsrKSB7XG4gICAgICAgICAgICAgICAgICBhcmdzW19rZXk1IC0gMV0gPSBhcmd1bWVudHNbX2tleTVdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghdGhpc1tfXSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpc1tfXS5saXN0ZW5lcnNbdHlwZV07XG5cbiAgICAgICAgICAgICAgICBpZiAoIWxpc3QpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdC5tYXAoZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdGVuZXIuY2FsbC5hcHBseShsaXN0ZW5lciwgW190aGlzNzddLmNvbmNhdChhcmdzKSk7XG4gICAgICAgICAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gciAhPSBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLS0gaWdub3JlXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbX107XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEV2ZW50VGFyZ2V0O1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuRXZlbnRUYXJnZXQgPSBFdmVudFRhcmdldDtcbiAgICAgICAgICBfYSA9IF87XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vZGF0YS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vZGF0YS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gZGF0YUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuRmlsdGVyRGF0YVNvdXJjZSA9IGV4cG9ydHMuQ2FjaGVkRGF0YVNvdXJjZSA9IGV4cG9ydHMuRGF0YVNvdXJjZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBEYXRhU291cmNlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2RhdGEvRGF0YVNvdXJjZSAqL1xuICAgICAgICAgIFwiLi9kYXRhL0RhdGFTb3VyY2UuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJEYXRhU291cmNlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIERhdGFTb3VyY2VfMS5EYXRhU291cmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIENhY2hlZERhdGFTb3VyY2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vZGF0YS9DYWNoZWREYXRhU291cmNlICovXG4gICAgICAgICAgXCIuL2RhdGEvQ2FjaGVkRGF0YVNvdXJjZS5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkNhY2hlZERhdGFTb3VyY2VcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gQ2FjaGVkRGF0YVNvdXJjZV8xLkNhY2hlZERhdGFTb3VyY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgRmlsdGVyRGF0YVNvdXJjZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9kYXRhL0ZpbHRlckRhdGFTb3VyY2UgKi9cbiAgICAgICAgICBcIi4vZGF0YS9GaWx0ZXJEYXRhU291cmNlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiRmlsdGVyRGF0YVNvdXJjZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBGaWx0ZXJEYXRhU291cmNlXzEuRmlsdGVyRGF0YVNvdXJjZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9kYXRhL0NhY2hlZERhdGFTb3VyY2UuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vZGF0YS9DYWNoZWREYXRhU291cmNlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGRhdGFDYWNoZWREYXRhU291cmNlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5DYWNoZWREYXRhU291cmNlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIERhdGFTb3VyY2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vRGF0YVNvdXJjZSAqL1xuICAgICAgICAgIFwiLi9kYXRhL0RhdGFTb3VyY2UuanNcIik7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIF9zZXRGaWVsZENhY2hlKCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgIGZDYWNoZSwgaW5kZXgsIGZpZWxkLCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgIHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcmVjQ2FjaGUgPSBmQ2FjaGVbaW5kZXhdIHx8IChmQ2FjaGVbaW5kZXhdID0gbmV3IE1hcCgpKTtcbiAgICAgICAgICAgIHJlY0NhY2hlLnNldChmaWVsZCwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBncmlkIGRhdGEgc291cmNlIGZvciBjYWNoaW5nIFByb21pc2UgZGF0YVxuICAgICAgICAgICAqXG4gICAgICAgICAgICogQGNsYXNzZGVzYyBjaGVldGFoR3JpZC5kYXRhLkNhY2hlZERhdGFTb3VyY2VcbiAgICAgICAgICAgKiBAbWVtYmVyb2YgY2hlZXRhaEdyaWQuZGF0YVxuICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICB2YXIgQ2FjaGVkRGF0YVNvdXJjZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0RhdGFTb3VyY2VfMSREYXRhU291KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQ2FjaGVkRGF0YVNvdXJjZSwgX0RhdGFTb3VyY2VfMSREYXRhU291KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjUxID0gX2NyZWF0ZVN1cGVyKENhY2hlZERhdGFTb3VyY2UpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBDYWNoZWREYXRhU291cmNlKG9wdCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM3ODtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2FjaGVkRGF0YVNvdXJjZSk7XG5cbiAgICAgICAgICAgICAgX3RoaXM3OCA9IF9zdXBlcjUxLmNhbGwodGhpcywgb3B0KTtcbiAgICAgICAgICAgICAgX3RoaXM3OC5fckNhY2hlID0ge307XG4gICAgICAgICAgICAgIF90aGlzNzguX2ZDYWNoZSA9IHt9O1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM3ODtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKENhY2hlZERhdGFTb3VyY2UsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRPcmlnaW5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0T3JpZ2luYWwoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fckNhY2hlICYmIHRoaXMuX3JDYWNoZVtpbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yQ2FjaGVbaW5kZXhdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0KF9nZXRQcm90b3R5cGVPZihDYWNoZWREYXRhU291cmNlLnByb3RvdHlwZSksIFwiZ2V0T3JpZ2luYWxcIiwgdGhpcykuY2FsbCh0aGlzLCBpbmRleCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldE9yaWdpbmFsRmllbGRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9yaWdpbmFsRmllbGQoaW5kZXgsIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd0NhY2hlID0gdGhpcy5fZkNhY2hlICYmIHRoaXMuX2ZDYWNoZVtpbmRleF07XG5cbiAgICAgICAgICAgICAgICBpZiAocm93Q2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjYWNoZSA9IHJvd0NhY2hlLmdldChmaWVsZCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChjYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGU7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKENhY2hlZERhdGFTb3VyY2UucHJvdG90eXBlKSwgXCJnZXRPcmlnaW5hbEZpZWxkXCIsIHRoaXMpLmNhbGwodGhpcywgaW5kZXgsIGZpZWxkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2V0T3JpZ2luYWxGaWVsZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0T3JpZ2luYWxGaWVsZChpbmRleCwgZmllbGQsIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZDYWNoZSA9IHRoaXMuX2ZDYWNoZTtcblxuICAgICAgICAgICAgICAgIGlmIChmQ2FjaGUgJiYgZkNhY2hlW2luZGV4XSkge1xuICAgICAgICAgICAgICAgICAgZGVsZXRlIGZDYWNoZVtpbmRleF07IC8vIGNsZWFyIHJvdyBjYWNoZVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0KF9nZXRQcm90b3R5cGVPZihDYWNoZWREYXRhU291cmNlLnByb3RvdHlwZSksIFwic2V0T3JpZ2luYWxGaWVsZFwiLCB0aGlzKS5jYWxsKHRoaXMsIGluZGV4LCBmaWVsZCwgdmFsdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbGVhckNhY2hlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckNhY2hlKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX3JDYWNoZSA9IHt9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9mQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX2ZDYWNoZSA9IHt9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZmllbGRQcm9taXNlQ2FsbEJhY2tJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmllbGRQcm9taXNlQ2FsbEJhY2tJbnRlcm5hbChpbmRleCwgZmllbGQsIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgX3NldEZpZWxkQ2FjaGUodGhpcy5fZkNhY2hlLCBpbmRleCwgZmllbGQsIHZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicmVjb3JkUHJvbWlzZUNhbGxCYWNrSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlY29yZFByb21pc2VDYWxsQmFja0ludGVybmFsKGluZGV4LCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICByZWNvcmQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yQ2FjaGVbaW5kZXhdID0gcmVjb3JkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKENhY2hlZERhdGFTb3VyY2UucHJvdG90eXBlKSwgXCJkaXNwb3NlXCIsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiRVZFTlRfVFlQRVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVNvdXJjZV8xLkRhdGFTb3VyY2UuRVZFTlRfVFlQRTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib2ZBcnJheVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb2ZBcnJheShhcnJheSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2FjaGVkRGF0YVNvdXJjZSh7XG4gICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXlbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGxlbmd0aDogYXJyYXkubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgc291cmNlOiBhcnJheVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBDYWNoZWREYXRhU291cmNlO1xuICAgICAgICAgIH0oRGF0YVNvdXJjZV8xLkRhdGFTb3VyY2UpO1xuXG4gICAgICAgICAgZXhwb3J0cy5DYWNoZWREYXRhU291cmNlID0gQ2FjaGVkRGF0YVNvdXJjZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9kYXRhL0RhdGFTb3VyY2UuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vZGF0YS9EYXRhU291cmNlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGRhdGFEYXRhU291cmNlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICB2YXIgX19jcmVhdGVCaW5kaW5nID0gdGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZyB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcblxuICAgICAgICAgICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgICAgICAgICAgZGVzYyA9IHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ba107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICBvW2syXSA9IG1ba107XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gdGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHtcbiAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgdmFsdWU6IHZcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgb1tcImRlZmF1bHRcIl0gPSB2O1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9faW1wb3J0U3RhciA9IHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICAgICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIHtcbiAgICAgICAgICAgICAgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5EYXRhU291cmNlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIF9zb3J0ID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3NvcnQgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvc29ydC5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEV2ZW50VGFyZ2V0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9jb3JlL0V2ZW50VGFyZ2V0ICovXG4gICAgICAgICAgXCIuL2NvcmUvRXZlbnRUYXJnZXQuanNcIik7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIGlzRmllbGRBc3Nlc3NvcihmaWVsZCkge1xuICAgICAgICAgICAgaWYgKHV0aWxzXzEub2JqLmlzT2JqZWN0KGZpZWxkKSkge1xuICAgICAgICAgICAgICBpZiAoZmllbGQuZ2V0ICYmIGZpZWxkLnNldCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIHZhciBFVkVOVF9UWVBFID0ge1xuICAgICAgICAgICAgVVBEQVRFX0xFTkdUSDogXCJ1cGRhdGVfbGVuZ3RoXCIsXG4gICAgICAgICAgICBVUERBVEVEX0xFTkdUSDogXCJ1cGRhdGVkX2xlbmd0aFwiLFxuICAgICAgICAgICAgVVBEQVRFRF9PUkRFUjogXCJ1cGRhdGVkX29yZGVyXCJcbiAgICAgICAgICB9O1xuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG4gICAgICAgICAgZnVuY3Rpb24gYXNjT3JkZXJGbih2MSwgdjIpIHtcbiAgICAgICAgICAgIGlmICh2MSA9PT0gdjIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh2MSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiB2MiA9PSBudWxsID8gLy8gSWYgYm90aCBhcmUgbnVsbGlzaCwgY29uc2lkZXIgYSBtYXRjaC5cbiAgICAgICAgICAgICAgMCA6IC8vIE51bGxzIGZpcnN0XG4gICAgICAgICAgICAgIC0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodjIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAvLyBOdWxscyBmaXJzdFxuICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHYxID4gdjIgPyAxIDogLTE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZGVzY09yZGVyRm4odjEsIHYyKSB7XG4gICAgICAgICAgICByZXR1cm4gYXNjT3JkZXJGbih2MSwgdjIpICogLTE7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRWYWx1ZSh2YWx1ZSwgc2V0UHJvbWlzZUJhY2spIHtcbiAgICAgICAgICAgIHZhciBtYXliZVByb21pc2VWYWx1ZSA9ICgwLCB1dGlsc18xLmdldE9yQXBwbHkpKHZhbHVlKTtcblxuICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkobWF5YmVQcm9taXNlVmFsdWUpKSB7XG4gICAgICAgICAgICAgIHZhciBwcm9taXNlVmFsdWUgPSBtYXliZVByb21pc2VWYWx1ZS50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICAgICAgc2V0UHJvbWlzZUJhY2socik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICAgIH0pOyAvL+S4gOaZgueahOOBq+OCreODo+ODg+OCt+ODpVxuXG4gICAgICAgICAgICAgIHNldFByb21pc2VCYWNrKHByb21pc2VWYWx1ZSk7XG4gICAgICAgICAgICAgIHJldHVybiBwcm9taXNlVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRGaWVsZChyZWNvcmQsIGZpZWxkLCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgIHNldFByb21pc2VCYWNrKSB7XG4gICAgICAgICAgICBpZiAocmVjb3JkID09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkocmVjb3JkKSkge1xuICAgICAgICAgICAgICByZXR1cm4gcmVjb3JkLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RmllbGQociwgZmllbGQsIHNldFByb21pc2VCYWNrKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBmaWVsZEdldCA9IGlzRmllbGRBc3Nlc3NvcihmaWVsZCkgPyBmaWVsZC5nZXQgOiBmaWVsZDtcblxuICAgICAgICAgICAgaWYgKGZpZWxkR2V0IGluIHJlY29yZCkge1xuICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICB2YXIgX2ZpZWxkUmVzdWx0ID0gcmVjb3JkW2ZpZWxkR2V0XTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgICByZXR1cm4gZ2V0VmFsdWUoX2ZpZWxkUmVzdWx0LCBzZXRQcm9taXNlQmFjayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGRHZXQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICB2YXIgX2ZpZWxkUmVzdWx0MiA9IGZpZWxkR2V0KHJlY29yZCk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGdldFZhbHVlKF9maWVsZFJlc3VsdDIsIHNldFByb21pc2VCYWNrKTtcbiAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9yZXN0cmljdC10ZW1wbGF0ZS1leHByZXNzaW9uc1xuXG5cbiAgICAgICAgICAgIHZhciBzcyA9IFN0cmluZyhmaWVsZEdldCkuc3BsaXQoXCIuXCIpO1xuXG4gICAgICAgICAgICBpZiAoc3MubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgdmFyIF9maWVsZFJlc3VsdDMgPSByZWNvcmRbZmllbGRHZXRdO1xuICAgICAgICAgICAgICByZXR1cm4gZ2V0VmFsdWUoX2ZpZWxkUmVzdWx0Mywgc2V0UHJvbWlzZUJhY2spO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZmllbGRSZXN1bHQgPSAoMCwgdXRpbHNfMS5hcHBseUNoYWluU2FmZSkuYXBwbHkodm9pZCAwLCBbcmVjb3JkLCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgZnVuY3Rpb24gKHZhbCwgbmFtZSkge1xuICAgICAgICAgICAgICByZXR1cm4gZ2V0RmllbGQodmFsLCBuYW1lLCB1dGlsc18xLmVtcHR5Rm4pO1xuICAgICAgICAgICAgfV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShzcykpKTtcbiAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZShmaWVsZFJlc3VsdCwgc2V0UHJvbWlzZUJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gc2V0RmllbGQocmVjb3JkLCBmaWVsZCwgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHJlY29yZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGZpZWxkU2V0ID0gaXNGaWVsZEFzc2Vzc29yKGZpZWxkKSA/IGZpZWxkLnNldCA6IGZpZWxkO1xuXG4gICAgICAgICAgICBpZiAoZmllbGRTZXQgaW4gcmVjb3JkKSB7XG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHJlY29yZFtmaWVsZFNldF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGZpZWxkU2V0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkU2V0KHJlY29yZCwgdmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZmllbGRTZXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgdmFyIHNzID0gXCJcIi5jb25jYXQoZmllbGRTZXQpLnNwbGl0KFwiLlwiKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgICB2YXIgb2JqID0gcmVjb3JkO1xuICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gc3MubGVuZ3RoO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZiA9IHNzW2ldO1xuXG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IGxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgIG9ialtmXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBvYmogPSBvYmpbZl0gfHwgKG9ialtmXSA9IHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHJlY29yZFtmaWVsZFNldF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBfZ2V0SW5kZXgoc29ydGVkSW5kZXhNYXAsIGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoIXNvcnRlZEluZGV4TWFwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG1hcEluZGV4ID0gc29ydGVkSW5kZXhNYXBbaW5kZXhdO1xuICAgICAgICAgICAgcmV0dXJuIG1hcEluZGV4ICE9IG51bGwgPyBtYXBJbmRleCA6IGluZGV4O1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBncmlkIGRhdGEgc291cmNlXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBAY2xhc3NkZXNjIGNoZWV0YWhHcmlkLmRhdGEuRGF0YVNvdXJjZVxuICAgICAgICAgICAqIEBtZW1iZXJvZiBjaGVldGFoR3JpZC5kYXRhXG4gICAgICAgICAgICovXG5cblxuICAgICAgICAgIHZhciBEYXRhU291cmNlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXZlbnRUYXJnZXRfMSRFdmVudFQ1KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoRGF0YVNvdXJjZSwgX0V2ZW50VGFyZ2V0XzEkRXZlbnRUNSk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI1MiA9IF9jcmVhdGVTdXBlcihEYXRhU291cmNlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gRGF0YVNvdXJjZShvYmopIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzNzk7XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGFTb3VyY2UpO1xuXG4gICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICBfdGhpczc5ID0gX3N1cGVyNTIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgX3RoaXM3OS5fc29ydGVkSW5kZXhNYXAgPSBudWxsOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gICAgICAgICAgICAgIF90aGlzNzkuX2dldCA9IChvYmogPT09IG51bGwgfHwgb2JqID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvYmouZ2V0LmJpbmQob2JqKSkgfHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgICBfdGhpczc5Ll9sZW5ndGggPSAob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JqLmxlbmd0aCkgfHwgMDtcbiAgICAgICAgICAgICAgX3RoaXM3OS5fc291cmNlID0gKF9hID0gb2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JqLnNvdXJjZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogb2JqO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM3OTtcbiAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoRGF0YVNvdXJjZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcInNvdXJjZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldChpbmRleCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE9yaWdpbmFsKF9nZXRJbmRleCh0aGlzLl9zb3J0ZWRJbmRleE1hcCwgaW5kZXgpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0RmllbGRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpZWxkKGluZGV4LCBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE9yaWdpbmFsRmllbGQoX2dldEluZGV4KHRoaXMuX3NvcnRlZEluZGV4TWFwLCBpbmRleCksIGZpZWxkKTtcbiAgICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoYXNGaWVsZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFzRmllbGQoaW5kZXgsIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFzT3JpZ2luYWxGaWVsZChfZ2V0SW5kZXgodGhpcy5fc29ydGVkSW5kZXhNYXAsIGluZGV4KSwgZmllbGQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzZXRGaWVsZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RmllbGQoaW5kZXgsIGZpZWxkLCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldE9yaWdpbmFsRmllbGQoX2dldEluZGV4KHRoaXMuX3NvcnRlZEluZGV4TWFwLCBpbmRleCksIGZpZWxkLCB2YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNvcnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNvcnQoZmllbGQsIG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzODAgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNvcnRlZEluZGV4TWFwID0gbmV3IEFycmF5KHRoaXMuX2xlbmd0aCk7XG4gICAgICAgICAgICAgICAgdmFyIG9yZGVyRm4gPSBvcmRlciAhPT0gXCJkZXNjXCIgPyBhc2NPcmRlckZuIDogZGVzY09yZGVyRm47XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zb3J0LnNvcnRQcm9taXNlKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHNvcnRlZEluZGV4TWFwW2luZGV4XSAhPSBudWxsID8gc29ydGVkSW5kZXhNYXBbaW5kZXhdIDogc29ydGVkSW5kZXhNYXBbaW5kZXhdID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGluZGV4LCByZWwpIHtcbiAgICAgICAgICAgICAgICAgIHNvcnRlZEluZGV4TWFwW2luZGV4XSA9IHJlbDtcbiAgICAgICAgICAgICAgICB9LCB0aGlzLl9sZW5ndGgsIG9yZGVyRm4sIGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzODAuZ2V0T3JpZ2luYWxGaWVsZChpbmRleCwgZmllbGQpO1xuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgX3RoaXM4MC5fc29ydGVkSW5kZXhNYXAgPSBzb3J0ZWRJbmRleE1hcDtcblxuICAgICAgICAgICAgICAgICAgX3RoaXM4MC5maXJlTGlzdGVuZXJzKEVWRU5UX1RZUEUuVVBEQVRFRF9PUkRFUik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImxlbmd0aFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbGVuZ3RoID09PSBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHRoaXMuZmlyZUxpc3RlbmVycyhFVkVOVF9UWVBFLlVQREFURV9MRU5HVEgsIGxlbmd0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodXRpbHNfMS5hcnJheS5maW5kSW5kZXgocmVzdWx0cywgZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAhdjtcbiAgICAgICAgICAgICAgICB9KSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fbGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICAgICAgICAgIHRoaXMuZmlyZUxpc3RlbmVycyhFVkVOVF9UWVBFLlVQREFURURfTEVOR1RILCB0aGlzLl9sZW5ndGgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkYXRhU291cmNlXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKERhdGFTb3VyY2UucHJvdG90eXBlKSwgXCJkaXNwb3NlXCIsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldE9yaWdpbmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPcmlnaW5hbChpbmRleCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczgxID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZSh0aGlzLl9nZXQoaW5kZXgpLCBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczgxLnJlY29yZFByb21pc2VDYWxsQmFja0ludGVybmFsKGluZGV4LCB2YWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRPcmlnaW5hbEZpZWxkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPcmlnaW5hbEZpZWxkKGluZGV4LCBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczgyID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSB0aGlzLmdldE9yaWdpbmFsKGluZGV4KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RmllbGQocmVjb3JkLCBmaWVsZCwgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgX3RoaXM4Mi5maWVsZFByb21pc2VDYWxsQmFja0ludGVybmFsKGluZGV4LCBmaWVsZCwgdmFsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaGFzT3JpZ2luYWxGaWVsZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFzT3JpZ2luYWxGaWVsZChpbmRleCwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHRoaXMuZ2V0T3JpZ2luYWwoaW5kZXgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuKHJlY29yZCAmJiBmaWVsZCBpbiByZWNvcmQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJzZXRPcmlnaW5hbEZpZWxkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRPcmlnaW5hbEZpZWxkKGluZGV4LCBmaWVsZCwgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSB0aGlzLmdldE9yaWdpbmFsKGluZGV4KTtcblxuICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKHJlY29yZCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZWNvcmQudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0RmllbGQociwgZmllbGQsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBzZXRGaWVsZChyZWNvcmQsIGZpZWxkLCB2YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZpZWxkUHJvbWlzZUNhbGxCYWNrSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpZWxkUHJvbWlzZUNhbGxCYWNrSW50ZXJuYWwoX2luZGV4LCBfZmllbGQsIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIF92YWx1ZSkgey8vXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJlY29yZFByb21pc2VDYWxsQmFja0ludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWNvcmRQcm9taXNlQ2FsbEJhY2tJbnRlcm5hbChfaW5kZXgsIF9yZWNvcmQpIHsvL1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkVWRU5UX1RZUEVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVWRU5UX1RZUEU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9mQXJyYXlcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mQXJyYXkoYXJyYXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGFTb3VyY2Uoe1xuICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5W2luZGV4XTtcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBsZW5ndGg6IGFycmF5Lmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgIHNvdXJjZTogYXJyYXlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gRGF0YVNvdXJjZTtcbiAgICAgICAgICB9KEV2ZW50VGFyZ2V0XzEuRXZlbnRUYXJnZXQpO1xuXG4gICAgICAgICAgZXhwb3J0cy5EYXRhU291cmNlID0gRGF0YVNvdXJjZTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgIERhdGFTb3VyY2UuRU1QVFkgPSBuZXcgRGF0YVNvdXJjZSh7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgLypub29wICovXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVuZ3RoOiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vZGF0YS9GaWx0ZXJEYXRhU291cmNlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2RhdGEvRmlsdGVyRGF0YVNvdXJjZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBkYXRhRmlsdGVyRGF0YVNvdXJjZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuRmlsdGVyRGF0YVNvdXJjZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgRGF0YVNvdXJjZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9EYXRhU291cmNlICovXG4gICAgICAgICAgXCIuL2RhdGEvRGF0YVNvdXJjZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBFdmVudEhhbmRsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL0V2ZW50SGFuZGxlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIuanNcIik7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cblxuICAgICAgICAgIHZhciBEYXRhU291cmNlSXRlcmF0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRGF0YVNvdXJjZUl0ZXJhdG9yKGRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGFTb3VyY2VJdGVyYXRvcik7XG5cbiAgICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG4gICAgICAgICAgICAgIHRoaXMuX2N1ckluZGV4ID0gLTE7XG4gICAgICAgICAgICAgIHRoaXMuX2RhdGEgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKERhdGFTb3VyY2VJdGVyYXRvciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImhhc05leHRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhc05leHQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5leHQgPSB0aGlzLl9jdXJJbmRleCArIDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFTb3VyY2UubGVuZ3RoID4gbmV4dDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibmV4dFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dCA9IHRoaXMuX2N1ckluZGV4ICsgMTtcblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5fZ2V0SW5kZXhEYXRhKG5leHQpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VySW5kZXggPSBuZXh0O1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJtb3ZlUHJldlwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZVByZXYoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VySW5kZXgtLTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2dldEluZGV4RGF0YVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2dldEluZGV4RGF0YShpbmRleCwgbmVzdCkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhU291cmNlID0gdGhpcy5fZGF0YVNvdXJjZTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2RhdGE7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCBkYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFbaW5kZXhdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChkYXRhU291cmNlLmxlbmd0aCA8PSBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gdGhpcy5fZGF0YVNvdXJjZS5nZXQoaW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgZGF0YVtpbmRleF0gPSByZWNvcmQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoKDAsIHV0aWxzXzEuaXNQcm9taXNlKShyZWNvcmQpKSB7XG4gICAgICAgICAgICAgICAgICByZWNvcmQudGhlbihmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbaW5kZXhdID0gdmFsO1xuICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghbmVzdCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSAxMDA7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldEluZGV4RGF0YShpbmRleCArIGksIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY29yZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gRGF0YVNvdXJjZUl0ZXJhdG9yO1xuICAgICAgICAgIH0oKTtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgdmFyIEZpbHRlckRhdGEgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRmlsdGVyRGF0YShkYywgb3JpZ2luYWwsIGZpbHRlcikge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmlsdGVyRGF0YSk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fY2FuY2VsID0gZmFsc2U7XG4gICAgICAgICAgICAgIHRoaXMuX293bmVyID0gZGM7XG4gICAgICAgICAgICAgIHRoaXMuX2RhdGFTb3VyY2VJdHIgPSBuZXcgRGF0YVNvdXJjZUl0ZXJhdG9yKG9yaWdpbmFsKTtcbiAgICAgICAgICAgICAgdGhpcy5fZmlsdGVyID0gZmlsdGVyO1xuICAgICAgICAgICAgICB0aGlzLl9maWx0ZXJlZExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgdGhpcy5fcXVldWVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhGaWx0ZXJEYXRhLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJlZExpc3QgPSB0aGlzLl9maWx0ZXJlZExpc3Q7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCBmaWx0ZXJlZExpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyZWRMaXN0W2luZGV4XTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcXVldWVzID0gdGhpcy5fcXVldWVzO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleFF1ZXVlID0gcXVldWVzW2luZGV4XTtcblxuICAgICAgICAgICAgICAgIGlmIChpbmRleFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXhRdWV1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcXVldWVzW2luZGV4XSB8fCB0aGlzLl9maW5kSW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjYW5jZWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYW5jZWwgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfZmluZEluZGV4XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZEluZGV4KGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5Qcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgdGltZW91dCA9IERhdGUubm93KCkgKyAxMDA7XG4gICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbmRJbmRleFdpdGhUaW1lb3V0KGluZGV4LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ID49IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGltZW91dCA8IERhdGUubm93KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmluZEluZGV4V2l0aFRpbWVvdXQoaW5kZXgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2ZpbmRJbmRleFdpdGhUaW1lb3V0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZEluZGV4V2l0aFRpbWVvdXQoaW5kZXgsIHRlc3RUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzODMgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGZpbHRlcmVkTGlzdCA9IHRoaXMuX2ZpbHRlcmVkTGlzdDtcbiAgICAgICAgICAgICAgICB2YXIgZmlsdGVyID0gdGhpcy5fZmlsdGVyO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhU291cmNlSXRyID0gdGhpcy5fZGF0YVNvdXJjZUl0cjtcbiAgICAgICAgICAgICAgICB2YXIgcXVldWVzID0gdGhpcy5fcXVldWVzO1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKGRhdGFTb3VyY2VJdHIuaGFzTmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5fY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSBkYXRhU291cmNlSXRyLm5leHQoKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkocmVjb3JkKSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSXRyLm1vdmVQcmV2KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBxdWV1ZSA9IHJlY29yZC50aGVuKGZ1bmN0aW9uIChfdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBxdWV1ZXNbaW5kZXhdID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM4My5nZXQoaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcXVldWVzW2luZGV4XSA9IHF1ZXVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcXVldWU7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXIocmVjb3JkKSkge1xuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZExpc3QucHVzaChyZWNvcmQpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA8IGZpbHRlcmVkTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyZWRMaXN0W2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpZiAodGVzdFRpbWVvdXQoKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIF9xdWV1ZSA9IHByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcXVldWVzW2luZGV4XSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzODMuZ2V0KGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcXVldWVzW2luZGV4XSA9IF9xdWV1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9xdWV1ZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZGMgPSB0aGlzLl9vd25lcjtcbiAgICAgICAgICAgICAgICBkYy5sZW5ndGggPSBmaWx0ZXJlZExpc3QubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEZpbHRlckRhdGE7XG4gICAgICAgICAgfSgpO1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIGdyaWQgZGF0YSBzb3VyY2UgZm9yIGZpbHRlclxuICAgICAgICAgICAqXG4gICAgICAgICAgICogQGNsYXNzZGVzYyBjaGVldGFoR3JpZC5kYXRhLkZpbHRlckRhdGFTb3VyY2VcbiAgICAgICAgICAgKiBAbWVtYmVyb2YgY2hlZXRhaEdyaWQuZGF0YVxuICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICB2YXIgRmlsdGVyRGF0YVNvdXJjZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0RhdGFTb3VyY2VfMSREYXRhU291Mikge1xuICAgICAgICAgICAgX2luaGVyaXRzKEZpbHRlckRhdGFTb3VyY2UsIF9EYXRhU291cmNlXzEkRGF0YVNvdTIpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNTMgPSBfY3JlYXRlU3VwZXIoRmlsdGVyRGF0YVNvdXJjZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEZpbHRlckRhdGFTb3VyY2UoZGF0YVNvdXJjZSwgZmlsdGVyKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczg0O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGaWx0ZXJEYXRhU291cmNlKTtcblxuICAgICAgICAgICAgICBfdGhpczg0ID0gX3N1cGVyNTMuY2FsbCh0aGlzLCBkYXRhU291cmNlKTtcbiAgICAgICAgICAgICAgX3RoaXM4NC5fZmlsdGVyRGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgIF90aGlzODQuX2RhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgICBfdGhpczg0LmZpbHRlciA9IGZpbHRlcjtcbiAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBfdGhpczg0Ll9oYW5kbGVyID0gbmV3IEV2ZW50SGFuZGxlcl8xLkV2ZW50SGFuZGxlcigpO1xuICAgICAgICAgICAgICBoYW5kbGVyLm9uKGRhdGFTb3VyY2UsIERhdGFTb3VyY2VfMS5EYXRhU291cmNlLkVWRU5UX1RZUEUuVVBEQVRFRF9PUkRFUiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIHJlc2V0XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtYXNzaWduXG4gICAgICAgICAgICAgICAgX3RoaXM4NC5maWx0ZXIgPSBfdGhpczg0LmZpbHRlcjtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICgwLCB1dGlsc18xLmVhY2gpKERhdGFTb3VyY2VfMS5EYXRhU291cmNlLkVWRU5UX1RZUEUsIGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5vbihkYXRhU291cmNlLCB0eXBlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX3RoaXM4NTtcblxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjYgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW42KSwgX2tleTYgPSAwOyBfa2V5NiA8IF9sZW42OyBfa2V5NisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTZdID0gYXJndW1lbnRzW19rZXk2XTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIChfdGhpczg1ID0gX3RoaXM4NCkuZmlyZUxpc3RlbmVycy5hcHBseShfdGhpczg1LCBbdHlwZV0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczg0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoRmlsdGVyRGF0YVNvdXJjZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImZpbHRlclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKChfYSA9IHRoaXMuX2ZpbHRlckRhdGEpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5fZmlsdGVyKSB8fCBudWxsO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChmaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZmlsdGVyRGF0YSkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5fZmlsdGVyRGF0YS5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9maWx0ZXJEYXRhID0gZmlsdGVyID8gbmV3IEZpbHRlckRhdGEodGhpcywgdGhpcy5fZGF0YVNvdXJjZSwgZmlsdGVyKSA6IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLl9kYXRhU291cmNlLmxlbmd0aDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0T3JpZ2luYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9yaWdpbmFsKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9maWx0ZXJEYXRhKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoRmlsdGVyRGF0YVNvdXJjZS5wcm90b3R5cGUpLCBcImdldE9yaWdpbmFsXCIsIHRoaXMpLmNhbGwodGhpcywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9maWx0ZXJEYXRhLmdldChpbmRleCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNvcnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNvcnQoZmllbGQsIG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFTb3VyY2Uuc29ydChmaWVsZCwgb3JkZXIpO1xuICAgICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNvdXJjZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YVNvdXJjZS5zb3VyY2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRhdGFTb3VyY2VcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFTb3VyY2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlci5kaXNwb3NlKCk7XG5cbiAgICAgICAgICAgICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihGaWx0ZXJEYXRhU291cmNlLnByb3RvdHlwZSksIFwiZGlzcG9zZVwiLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkVWRU5UX1RZUEVcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIERhdGFTb3VyY2VfMS5EYXRhU291cmNlLkVWRU5UX1RZUEU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEZpbHRlckRhdGFTb3VyY2U7XG4gICAgICAgICAgfShEYXRhU291cmNlXzEuRGF0YVNvdXJjZSk7XG5cbiAgICAgICAgICBleHBvcnRzLkZpbHRlckRhdGFTb3VyY2UgPSBGaWx0ZXJEYXRhU291cmNlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2VsZW1lbnQvSW5saW5lLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vZWxlbWVudC9JbmxpbmUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBlbGVtZW50SW5saW5lSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5JbmxpbmUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0V2lkdGgoY3R4LCBjb250ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lm1lYXN1cmVUZXh0KGNvbnRlbnQpLndpZHRoO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGJyZWFrV2lkdGgoY3R4LCBjb250ZW50LCBpdHIsIGNhbmRpZGF0ZUluZGV4LCB3aWR0aCkge1xuICAgICAgICAgICAgdmFyIGNoYXJzID0gW107XG4gICAgICAgICAgICB2YXIgcmV0ID0gaXRyLm5leHQoKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYW5kaWRhdGVJbmRleCAmJiByZXQgIT09IG51bGw7IGkrKywgcmV0ID0gaXRyLm5leHQoKSkge1xuICAgICAgICAgICAgICBjaGFycy5wdXNoKHJldCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBiZWZvcmVXaWR0aCA9IGdldFdpZHRoKGN0eCwgY2hhcnMuam9pbihcIlwiKSk7XG5cbiAgICAgICAgICAgIGlmIChiZWZvcmVXaWR0aCA+IHdpZHRoKSB7XG4gICAgICAgICAgICAgIHdoaWxlIChjaGFycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGNoYXJzLnBvcCgpO1xuICAgICAgICAgICAgICAgIGJlZm9yZVdpZHRoIC09IGdldFdpZHRoKGN0eCwgYyB8fCBcIlwiKTtcblxuICAgICAgICAgICAgICAgIGlmIChiZWZvcmVXaWR0aCA8PSB3aWR0aCkge1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVdpZHRoIDwgd2lkdGgpIHtcbiAgICAgICAgICAgICAgd2hpbGUgKHJldCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBjaGFyV2lkdGggPSBnZXRXaWR0aChjdHgsIHJldCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmVmb3JlV2lkdGggKyBjaGFyV2lkdGggPiB3aWR0aCkge1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2hhcnMucHVzaChyZXQpO1xuICAgICAgICAgICAgICAgIGJlZm9yZVdpZHRoICs9IGNoYXJXaWR0aDtcbiAgICAgICAgICAgICAgICByZXQgPSBpdHIubmV4dCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBiZWZvcmVDb250ZW50ID0gY2hhcnMuam9pbihcIlwiKS5yZXBsYWNlKC9cXHMrJC8sIFwiXCIpO1xuICAgICAgICAgICAgdmFyIGFmdGVyQ29udGVudCA9IGNvbnRlbnQuc2xpY2UoYmVmb3JlQ29udGVudC5sZW5ndGgpLnJlcGxhY2UoL15cXHMrLywgXCJcIik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBiZWZvcmU6IGJlZm9yZUNvbnRlbnQgPyBuZXcgSW5saW5lKGJlZm9yZUNvbnRlbnQpIDogbnVsbCxcbiAgICAgICAgICAgICAgYWZ0ZXI6IGFmdGVyQ29udGVudCA/IG5ldyBJbmxpbmUoYWZ0ZXJDb250ZW50KSA6IG51bGxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIElubGluZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBJbmxpbmUoY29udGVudCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW5saW5lKTtcblxuICAgICAgICAgICAgICB0aGlzLl9jb250ZW50ID0gY29udGVudCAhPSBudWxsID8gY29udGVudCA6IFwiXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbmxpbmUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJ3aWR0aFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2lkdGgoX3JlZjU2KSB7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IF9yZWY1Ni5jdHg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFdpZHRoKGN0eCwgdGhpcy5fY29udGVudCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZvbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZvbnQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb2xvcigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FuRHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2FuRHJhdygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uUmVhZHlcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVhZHkoX2NhbGxiYWNrKSB7fVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhdyhfcmVmNTcpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gX3JlZjU3LmN0eCxcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzaGVscGVyID0gX3JlZjU3LmNhbnZhc2hlbHBlcixcbiAgICAgICAgICAgICAgICAgICAgcmVjdCA9IF9yZWY1Ny5yZWN0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfcmVmNTcub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRMZWZ0ID0gX3JlZjU3Lm9mZnNldExlZnQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFJpZ2h0ID0gX3JlZjU3Lm9mZnNldFJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3AgPSBfcmVmNTcub2Zmc2V0VG9wLFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRCb3R0b20gPSBfcmVmNTcub2Zmc2V0Qm90dG9tO1xuICAgICAgICAgICAgICAgIGNhbnZhc2hlbHBlci5maWxsVGV4dFJlY3QoY3R4LCB0aGlzLl9jb250ZW50LCByZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCwge1xuICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQgKyAxLFxuICAgICAgICAgICAgICAgICAgcGFkZGluZzoge1xuICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXRMZWZ0LFxuICAgICAgICAgICAgICAgICAgICByaWdodDogb2Zmc2V0UmlnaHQsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogb2Zmc2V0VG9wLFxuICAgICAgICAgICAgICAgICAgICBib3R0b206IG9mZnNldEJvdHRvbVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjYW5CcmVha1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2FuQnJlYWsoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5fY29udGVudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic3BsaXRJbmRleFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXRJbmRleChpbmRleCkge1xuICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5fY29udGVudDtcbiAgICAgICAgICAgICAgICB2YXIgaXRyID0gdXRpbHNfMS5zdHIuZ2VuQ2hhcnMoY29udGVudCk7XG4gICAgICAgICAgICAgICAgdmFyIGNoYXJzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IGl0ci5uZXh0KCk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGV4ICYmIHJldCAhPT0gbnVsbDsgaSsrLCByZXQgPSBpdHIubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICBjaGFycy5wdXNoKHJldCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGJlZm9yZUNvbnRlbnQgPSBjaGFycy5qb2luKFwiXCIpO1xuICAgICAgICAgICAgICAgIHZhciBhZnRlckNvbnRlbnQgPSBjb250ZW50LnNsaWNlKGJlZm9yZUNvbnRlbnQubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgYmVmb3JlOiBiZWZvcmVDb250ZW50ID8gbmV3IElubGluZShiZWZvcmVDb250ZW50KSA6IG51bGwsXG4gICAgICAgICAgICAgICAgICBhZnRlcjogYWZ0ZXJDb250ZW50ID8gbmV3IElubGluZShhZnRlckNvbnRlbnQpIDogbnVsbFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJyZWFrV29yZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYnJlYWtXb3JkKGN0eCwgd2lkdGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHRoaXMuX2NvbnRlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIGFsbFdpZHRoID0gdGhpcy53aWR0aCh7XG4gICAgICAgICAgICAgICAgICBjdHg6IGN0eFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBjYW5kaWRhdGUgPSBNYXRoLmZsb29yKHRoaXMuX2NvbnRlbnQubGVuZ3RoICogd2lkdGggLyBhbGxXaWR0aCk7XG4gICAgICAgICAgICAgICAgdmFyIGl0ciA9IHV0aWxzXzEuc3RyLmdlbldvcmRzKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBicmVha1dpZHRoKGN0eCwgY29udGVudCwgaXRyLCBjYW5kaWRhdGUsIHdpZHRoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYnJlYWtBbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJyZWFrQWxsKGN0eCwgd2lkdGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHRoaXMuX2NvbnRlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIGFsbFdpZHRoID0gdGhpcy53aWR0aCh7XG4gICAgICAgICAgICAgICAgICBjdHg6IGN0eFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBjYW5kaWRhdGUgPSBNYXRoLmZsb29yKHRoaXMuX2NvbnRlbnQubGVuZ3RoICogd2lkdGggLyBhbGxXaWR0aCk7XG4gICAgICAgICAgICAgICAgdmFyIGl0ciA9IHV0aWxzXzEuc3RyLmdlbkNoYXJzKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBicmVha1dpZHRoKGN0eCwgY29udGVudCwgaXRyLCBjYW5kaWRhdGUsIHdpZHRoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidG9TdHJpbmdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbmxpbmU7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5JbmxpbmUgPSBJbmxpbmU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vZWxlbWVudC9JbmxpbmVEcmF3ZXIuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9lbGVtZW50L0lubGluZURyYXdlci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGVsZW1lbnRJbmxpbmVEcmF3ZXJKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLklubGluZURyYXdlciA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBJbmxpbmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vSW5saW5lICovXG4gICAgICAgICAgXCIuL2VsZW1lbnQvSW5saW5lLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIElubGluZURyYXdlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0lubGluZV8xJElubGluZSkge1xuICAgICAgICAgICAgX2luaGVyaXRzKElubGluZURyYXdlciwgX0lubGluZV8xJElubGluZSk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI1NCA9IF9jcmVhdGVTdXBlcihJbmxpbmVEcmF3ZXIpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBJbmxpbmVEcmF3ZXIoX3JlZjU4KSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczg2O1xuXG4gICAgICAgICAgICAgIHZhciBkcmF3ID0gX3JlZjU4LmRyYXcsXG4gICAgICAgICAgICAgICAgICB3aWR0aCA9IF9yZWY1OC53aWR0aCxcbiAgICAgICAgICAgICAgICAgIGNvbG9yID0gX3JlZjU4LmNvbG9yO1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmxpbmVEcmF3ZXIpO1xuXG4gICAgICAgICAgICAgIF90aGlzODYgPSBfc3VwZXI1NC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICBfdGhpczg2Ll9kcmF3ID0gZHJhdztcbiAgICAgICAgICAgICAgX3RoaXM4Ni5fd2lkdGggPSB3aWR0aDsgLy8gdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgICAgICAgIF90aGlzODYuX2NvbG9yID0gY29sb3I7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczg2O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSW5saW5lRHJhd2VyLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwid2lkdGhcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpZHRoKF9hcmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZvbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZvbnQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb2xvcigpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKF9hID0gdGhpcy5fY29sb3IpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNhbkRyYXdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhbkRyYXcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvblJlYWR5XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlYWR5KF9jYWxsYmFjaykge31cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXcoX3JlZjU5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IF9yZWY1OS5jdHgsXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc2hlbHBlciA9IF9yZWY1OS5jYW52YXNoZWxwZXIsXG4gICAgICAgICAgICAgICAgICAgIHJlY3QgPSBfcmVmNTkucmVjdCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gX3JlZjU5Lm9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0TGVmdCA9IF9yZWY1OS5vZmZzZXRMZWZ0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRSaWdodCA9IF9yZWY1OS5vZmZzZXRSaWdodCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0VG9wID0gX3JlZjU5Lm9mZnNldFRvcCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0Qm90dG9tID0gX3JlZjU5Lm9mZnNldEJvdHRvbTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2RyYXcoe1xuICAgICAgICAgICAgICAgICAgY3R4OiBjdHgsXG4gICAgICAgICAgICAgICAgICBjYW52YXNoZWxwZXI6IGNhbnZhc2hlbHBlcixcbiAgICAgICAgICAgICAgICAgIHJlY3Q6IHJlY3QsXG4gICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICAgIG9mZnNldExlZnQ6IG9mZnNldExlZnQsXG4gICAgICAgICAgICAgICAgICBvZmZzZXRSaWdodDogb2Zmc2V0UmlnaHQsXG4gICAgICAgICAgICAgICAgICBvZmZzZXRUb3A6IG9mZnNldFRvcCxcbiAgICAgICAgICAgICAgICAgIG9mZnNldEJvdHRvbTogb2Zmc2V0Qm90dG9tXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNhbkJyZWFrXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5CcmVhaygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRvU3RyaW5nXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gSW5saW5lRHJhd2VyO1xuICAgICAgICAgIH0oSW5saW5lXzEuSW5saW5lKTtcblxuICAgICAgICAgIGV4cG9ydHMuSW5saW5lRHJhd2VyID0gSW5saW5lRHJhd2VyO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2VsZW1lbnQvSW5saW5lSWNvbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9lbGVtZW50L0lubGluZUljb24uanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gZWxlbWVudElubGluZUljb25Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLklubGluZUljb24gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgZm9udHMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvZm9udHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvZm9udHMuanNcIikpO1xuXG4gICAgICAgICAgdmFyIElubGluZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9JbmxpbmUgKi9cbiAgICAgICAgICBcIi4vZWxlbWVudC9JbmxpbmUuanNcIik7XG5cbiAgICAgICAgICB2YXIgSW5saW5lSWNvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0lubGluZV8xJElubGluZTIpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhJbmxpbmVJY29uLCBfSW5saW5lXzEkSW5saW5lMik7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI1NSA9IF9jcmVhdGVTdXBlcihJbmxpbmVJY29uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gSW5saW5lSWNvbihpY29uKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczg3O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmxpbmVJY29uKTtcblxuICAgICAgICAgICAgICBfdGhpczg3ID0gX3N1cGVyNTUuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgX3RoaXM4Ny5faWNvbiA9IGljb24gfHwge307XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczg3O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSW5saW5lSWNvbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIndpZHRoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aWR0aChfcmVmNjApIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gX3JlZjYwLmN0eDtcbiAgICAgICAgICAgICAgICB2YXIgaWNvbiA9IHRoaXMuX2ljb247XG5cbiAgICAgICAgICAgICAgICBpZiAoaWNvbi53aWR0aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGljb24ud2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGljb24uZm9udCAmJiBmb250cy5jaGVjayhpY29uLmZvbnQsIGljb24uY29udGVudCB8fCBcIlwiKSkge1xuICAgICAgICAgICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgIGN0eC5jYW52YXMuc3R5bGUubGV0dGVyU3BhY2luZyA9IFwibm9ybWFsXCI7XG5cbiAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gaWNvbi5mb250IHx8IGN0eC5mb250O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3R4Lm1lYXN1cmVUZXh0KGljb24uY29udGVudCB8fCBcIlwiKS53aWR0aDtcbiAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5jYW52YXMuc3R5bGUubGV0dGVyU3BhY2luZyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7IC8vdW5rbm93blxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmb250XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb250KCkge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICAgIHJldHVybiAoX2EgPSB0aGlzLl9pY29uLmZvbnQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb2xvcigpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKF9hID0gdGhpcy5faWNvbi5jb2xvcikgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FuRHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2FuRHJhdygpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWNvbiA9IHRoaXMuX2ljb247XG4gICAgICAgICAgICAgICAgcmV0dXJuIGljb24uZm9udCA/IGZvbnRzLmNoZWNrKGljb24uZm9udCwgaWNvbi5jb250ZW50IHx8IFwiXCIpIDogdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25SZWFkeVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkeShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciBpY29uID0gdGhpcy5faWNvbjtcblxuICAgICAgICAgICAgICAgIGlmIChpY29uLmZvbnQgJiYgIWZvbnRzLmNoZWNrKGljb24uZm9udCwgaWNvbi5jb250ZW50IHx8IFwiXCIpKSB7XG4gICAgICAgICAgICAgICAgICBmb250cy5sb2FkKGljb24uZm9udCwgaWNvbi5jb250ZW50IHx8IFwiXCIsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXcoX3JlZjYxKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IF9yZWY2MS5jdHgsXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhc2hlbHBlciA9IF9yZWY2MS5jYW52YXNoZWxwZXIsXG4gICAgICAgICAgICAgICAgICAgIHJlY3QgPSBfcmVmNjEucmVjdCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gX3JlZjYxLm9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0TGVmdCA9IF9yZWY2MS5vZmZzZXRMZWZ0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRSaWdodCA9IF9yZWY2MS5vZmZzZXRSaWdodCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0VG9wID0gX3JlZjYxLm9mZnNldFRvcCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0Qm90dG9tID0gX3JlZjYxLm9mZnNldEJvdHRvbTtcbiAgICAgICAgICAgICAgICB2YXIgaWNvbiA9IHRoaXMuX2ljb247XG5cbiAgICAgICAgICAgICAgICBpZiAoaWNvbi5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICBjdHguY2FudmFzLnN0eWxlLmxldHRlclNwYWNpbmcgPSBcIm5vcm1hbFwiO1xuXG4gICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1hc3NpZ25cbiAgICAgICAgICAgICAgICAgICAgY3R4LmZvbnQgPSBjdHguZm9udDsgLy8gVG8gYXBwbHkgbGV0dGVyU3BhY2luZywgd2UgbmVlZCB0byByZXNldCBpdC5cblxuICAgICAgICAgICAgICAgICAgICBjYW52YXNoZWxwZXIuZmlsbFRleHRSZWN0KGN0eCwgaWNvbi5jb250ZW50LCByZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCwge1xuICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXRMZWZ0ICsgKHRoaXMuX2ljb24ub2Zmc2V0TGVmdCB8fCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBvZmZzZXRSaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogb2Zmc2V0VG9wICsgKHRoaXMuX2ljb24ub2Zmc2V0VG9wIHx8IDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tOiBvZmZzZXRCb3R0b21cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmNhbnZhcy5zdHlsZS5sZXR0ZXJTcGFjaW5nID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNhbkJyZWFrXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5CcmVhaygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRvU3RyaW5nXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gSW5saW5lSWNvbjtcbiAgICAgICAgICB9KElubGluZV8xLklubGluZSk7XG5cbiAgICAgICAgICBleHBvcnRzLklubGluZUljb24gPSBJbmxpbmVJY29uO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2VsZW1lbnQvSW5saW5lSW1hZ2UuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2VsZW1lbnQvSW5saW5lSW1hZ2UuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGVsZW1lbnRJbmxpbmVJbWFnZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuSW5saW5lSW1hZ2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgSW5saW5lXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0lubGluZSAqL1xuICAgICAgICAgIFwiLi9lbGVtZW50L0lubGluZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBpbWdzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbnRlcm5hbC9pbWdzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL2ltZ3MuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIElubGluZUltYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfSW5saW5lXzEkSW5saW5lMykge1xuICAgICAgICAgICAgX2luaGVyaXRzKElubGluZUltYWdlLCBfSW5saW5lXzEkSW5saW5lMyk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI1NiA9IF9jcmVhdGVTdXBlcihJbmxpbmVJbWFnZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIElubGluZUltYWdlKF9yZWY2Mikge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM4ODtcblxuICAgICAgICAgICAgICB2YXIgc3JjID0gX3JlZjYyLnNyYyxcbiAgICAgICAgICAgICAgICAgIHdpZHRoID0gX3JlZjYyLndpZHRoLFxuICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gX3JlZjYyLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgIGltYWdlTGVmdCA9IF9yZWY2Mi5pbWFnZUxlZnQsXG4gICAgICAgICAgICAgICAgICBpbWFnZVRvcCA9IF9yZWY2Mi5pbWFnZVRvcCxcbiAgICAgICAgICAgICAgICAgIGltYWdlV2lkdGggPSBfcmVmNjIuaW1hZ2VXaWR0aCxcbiAgICAgICAgICAgICAgICAgIGltYWdlSGVpZ2h0ID0gX3JlZjYyLmltYWdlSGVpZ2h0O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmxpbmVJbWFnZSk7XG5cbiAgICAgICAgICAgICAgX3RoaXM4OCA9IF9zdXBlcjU2LmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgIF90aGlzODguX2lubGluZUltZ1Byb21pc2UgPSBudWxsO1xuICAgICAgICAgICAgICBfdGhpczg4Ll9pbmxpbmVJbWcgPSBudWxsO1xuICAgICAgICAgICAgICBfdGhpczg4Ll9zcmMgPSBzcmM7XG4gICAgICAgICAgICAgIF90aGlzODguX3dpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICAgIF90aGlzODguX2hlaWdodCA9IGhlaWdodDtcbiAgICAgICAgICAgICAgX3RoaXM4OC5faW1hZ2VMZWZ0ID0gaW1hZ2VMZWZ0O1xuICAgICAgICAgICAgICBfdGhpczg4Ll9pbWFnZVRvcCA9IGltYWdlVG9wO1xuICAgICAgICAgICAgICBfdGhpczg4Ll9pbWFnZVdpZHRoID0gaW1hZ2VXaWR0aDtcbiAgICAgICAgICAgICAgX3RoaXM4OC5faW1hZ2VIZWlnaHQgPSBpbWFnZUhlaWdodDtcbiAgICAgICAgICAgICAgX3RoaXM4OC5fb25sb2FkZWQgPSBbXTtcblxuICAgICAgICAgICAgICBpZiAoKDAsIHV0aWxzXzEuaXNQcm9taXNlKShzcmMpKSB7XG4gICAgICAgICAgICAgICAgc3JjLnRoZW4oZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICAgIF90aGlzODguX3NyYyA9IHM7XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzODguX2xvYWRJbWFnZShzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpczg4Ll9sb2FkSW1hZ2Uoc3JjKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczg4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSW5saW5lSW1hZ2UsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJfbG9hZEltYWdlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbG9hZEltYWdlKHNyYykge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczg5ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBpbWcgPSB0aGlzLl9pbmxpbmVJbWdQcm9taXNlID0gKDAsIGltZ3NfMS5nZXRDYWNoZU9yTG9hZCkoXCJJbmxpbmVJbWFnZVwiLCA1MCwgc3JjKTtcblxuICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKGltZykpIHtcbiAgICAgICAgICAgICAgICAgIGltZy50aGVuKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzODkuX2lubGluZUltZyA9IGk7XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXM4OS5fb25sb2FkZWQuZm9yRWFjaChmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdGhpcy5faW5saW5lSW1nID0gaW1nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwid2lkdGhcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpZHRoKF9hcmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2EsIF9iO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoIHx8ICgoX2IgPSAoX2EgPSB0aGlzLl9pbmxpbmVJbWcpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS53aWR0aCkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogMCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZvbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZvbnQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb2xvcigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FuRHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2FuRHJhdygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gISF0aGlzLl9pbmxpbmVJbWc7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uUmVhZHlcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVhZHkoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBpZiAoKDAsIHV0aWxzXzEuaXNQcm9taXNlKSh0aGlzLl9zcmMpIHx8ICgwLCB1dGlsc18xLmlzUHJvbWlzZSkodGhpcy5faW5saW5lSW1nUHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX29ubG9hZGVkLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhdyhfcmVmNjMpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gX3JlZjYzLmN0eCxcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzaGVscGVyID0gX3JlZjYzLmNhbnZhc2hlbHBlcixcbiAgICAgICAgICAgICAgICAgICAgcmVjdCA9IF9yZWY2My5yZWN0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfcmVmNjMub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRMZWZ0ID0gX3JlZjYzLm9mZnNldExlZnQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFJpZ2h0ID0gX3JlZjYzLm9mZnNldFJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3AgPSBfcmVmNjMub2Zmc2V0VG9wLFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRCb3R0b20gPSBfcmVmNjMub2Zmc2V0Qm90dG9tO1xuICAgICAgICAgICAgICAgIHZhciBpbWcgPSB0aGlzLl9pbmxpbmVJbWc7XG4gICAgICAgICAgICAgICAgY2FudmFzaGVscGVyLmRyYXdJbmxpbmVJbWFnZVJlY3QoY3R4LCBpbWcsIHRoaXMuX2ltYWdlTGVmdCB8fCAwLCB0aGlzLl9pbWFnZVRvcCB8fCAwLCB0aGlzLl9pbWFnZVdpZHRoIHx8IGltZy53aWR0aCwgdGhpcy5faW1hZ2VIZWlnaHQgfHwgaW1nLmhlaWdodCwgdGhpcy5fd2lkdGggfHwgaW1nLndpZHRoLCB0aGlzLl9oZWlnaHQgfHwgaW1nLmhlaWdodCwgcmVjdC5sZWZ0LCByZWN0LnRvcCwgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHQsIHtcbiAgICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0ICsgMSxcbiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogb2Zmc2V0TGVmdCxcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IG9mZnNldFJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICB0b3A6IG9mZnNldFRvcCxcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiBvZmZzZXRCb3R0b21cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FuQnJlYWtcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhbkJyZWFrKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidG9TdHJpbmdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbmxpbmVJbWFnZTtcbiAgICAgICAgICB9KElubGluZV8xLklubGluZSk7XG5cbiAgICAgICAgICBleHBvcnRzLklubGluZUltYWdlID0gSW5saW5lSW1hZ2U7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vZWxlbWVudC9JbmxpbmVQYXRoMkQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9lbGVtZW50L0lubGluZVBhdGgyRC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGVsZW1lbnRJbmxpbmVQYXRoMkRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLklubGluZVBhdGgyRCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBwYXRoMkRNYW5hZ2VyID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3BhdGgyRE1hbmFnZXIgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvcGF0aDJETWFuYWdlci5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgSW5saW5lXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0lubGluZSAqL1xuICAgICAgICAgIFwiLi9lbGVtZW50L0lubGluZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBjYW52YXNlc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vaW50ZXJuYWwvY2FudmFzZXMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvY2FudmFzZXMuanNcIik7XG5cbiAgICAgICAgICB2YXIgSW5saW5lUGF0aDJEID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfSW5saW5lXzEkSW5saW5lNCkge1xuICAgICAgICAgICAgX2luaGVyaXRzKElubGluZVBhdGgyRCwgX0lubGluZV8xJElubGluZTQpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNTcgPSBfY3JlYXRlU3VwZXIoSW5saW5lUGF0aDJEKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gSW5saW5lUGF0aDJEKF9yZWY2NCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM5MDtcblxuICAgICAgICAgICAgICB2YXIgcGF0aCA9IF9yZWY2NC5wYXRoLFxuICAgICAgICAgICAgICAgICAgd2lkdGggPSBfcmVmNjQud2lkdGgsXG4gICAgICAgICAgICAgICAgICBoZWlnaHQgPSBfcmVmNjQuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgY29sb3IgPSBfcmVmNjQuY29sb3I7XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElubGluZVBhdGgyRCk7XG5cbiAgICAgICAgICAgICAgX3RoaXM5MCA9IF9zdXBlcjU3LmNhbGwodGhpcyk7IC8vIOOBk+OBruOCv+OCpOODn+ODs+OCsOOBp+OBquOBhOOBqElF44GnUGF0aDJE44GucG9seWZpbGzjgYzlj43mmKDjgZXjgozjgarjgYRcblxuICAgICAgICAgICAgICB2YXIgUGF0aDJEID0gcGF0aDJETWFuYWdlci5nZXRQYXRoMkQoKTtcbiAgICAgICAgICAgICAgX3RoaXM5MC5fcGF0aCA9IG5ldyBQYXRoMkQocGF0aCk7XG4gICAgICAgICAgICAgIF90aGlzOTAuX3dpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICAgIF90aGlzOTAuX2hlaWdodCA9IGhlaWdodDtcbiAgICAgICAgICAgICAgX3RoaXM5MC5fY29sb3IgPSBjb2xvcjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOTA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhJbmxpbmVQYXRoMkQsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJ3aWR0aFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2lkdGgoX2FyZykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZm9udFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9udCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY29sb3JcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbG9yKCkge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcblxuICAgICAgICAgICAgICAgIHJldHVybiAoX2EgPSB0aGlzLl9jb2xvcikgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2FuRHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2FuRHJhdygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9uUmVhZHlcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVhZHkoX2NhbGxiYWNrKSB7fVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhdyhfcmVmNjUpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gX3JlZjY1LmN0eCxcbiAgICAgICAgICAgICAgICAgICAgcmVjdCA9IF9yZWY2NS5yZWN0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfcmVmNjUub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRMZWZ0ID0gX3JlZjY1Lm9mZnNldExlZnQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFJpZ2h0ID0gX3JlZjY1Lm9mZnNldFJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3AgPSBfcmVmNjUub2Zmc2V0VG9wLFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRCb3R0b20gPSBfcmVmNjUub2Zmc2V0Qm90dG9tO1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIHZhciBwYWRkaW5nID0ge1xuICAgICAgICAgICAgICAgICAgbGVmdDogb2Zmc2V0TGVmdCxcbiAgICAgICAgICAgICAgICAgIHJpZ2h0OiBvZmZzZXRSaWdodCxcbiAgICAgICAgICAgICAgICAgIHRvcDogb2Zmc2V0VG9wLFxuICAgICAgICAgICAgICAgICAgYm90dG9tOiBvZmZzZXRCb3R0b21cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgY3R4LnJlY3QocmVjdC5sZWZ0LCByZWN0LnRvcCwgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHQpOyAvL2NsaXBcblxuICAgICAgICAgICAgICAgICAgY3R4LmNsaXAoKTsgLy/mloflrZfmj4/nlLtcblxuICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9ICgwLCBjYW52YXNlc18xLmNhbGNTdGFydFBvc2l0aW9uKShjdHgsIHJlY3QsIHRoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHQsIHtcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwb3MueCwgcG9zLnkpO1xuICAgICAgICAgICAgICAgICAgY3R4LmZpbGwodGhpcy5fcGF0aCk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjYW5CcmVha1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2FuQnJlYWsoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ0b1N0cmluZ1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIElubGluZVBhdGgyRDtcbiAgICAgICAgICB9KElubGluZV8xLklubGluZSk7XG5cbiAgICAgICAgICBleHBvcnRzLklubGluZVBhdGgyRCA9IElubGluZVBhdGgyRDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9lbGVtZW50L0lubGluZVN2Zy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2VsZW1lbnQvSW5saW5lU3ZnLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gZWxlbWVudElubGluZVN2Z0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuSW5saW5lU3ZnID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBJbmxpbmVJbWFnZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9JbmxpbmVJbWFnZSAqL1xuICAgICAgICAgIFwiLi9lbGVtZW50L0lubGluZUltYWdlLmpzXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gYnVpbGRTdmdEYXRhVXJsKHN2Zykge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB0eXBlb2Ygc3ZnID09PSBcInN0cmluZ1wiID8gc3ZnIDogbmV3IFhNTFNlcmlhbGl6ZXIoKS5zZXJpYWxpemVUb1N0cmluZyhzdmcpO1xuICAgICAgICAgICAgdmFyIHVybCA9IFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsXCIuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChkYXRhKSk7IC8vc3Zn44OH44O844K/44KSYmFzZTY044Gr5aSJ5o+bXG5cbiAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0U3ZnRWxlbWVudChzdmcpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3ZnID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG4gICAgICAgICAgICAgIHJldHVybiBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHN2ZywgXCJpbWFnZS9zdmcreG1sXCIpLmNoaWxkcmVuWzBdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHN2ZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgSW5saW5lU3ZnID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfSW5saW5lSW1hZ2VfMSRJbmxpbmUpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhJbmxpbmVTdmcsIF9JbmxpbmVJbWFnZV8xJElubGluZSk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI1OCA9IF9jcmVhdGVTdXBlcihJbmxpbmVTdmcpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBJbmxpbmVTdmcoX3JlZjY2KSB7XG4gICAgICAgICAgICAgIHZhciBzdmcgPSBfcmVmNjYuc3ZnLFxuICAgICAgICAgICAgICAgICAgd2lkdGggPSBfcmVmNjYud2lkdGgsXG4gICAgICAgICAgICAgICAgICBoZWlnaHQgPSBfcmVmNjYuaGVpZ2h0O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmxpbmVTdmcpO1xuXG4gICAgICAgICAgICAgIHZhciBfYSwgX2I7XG5cbiAgICAgICAgICAgICAgdmFyIHN2Z0VsZW0gPSAoMCwgdXRpbHNfMS50aGVuKShzdmcsIGdldFN2Z0VsZW1lbnQpO1xuICAgICAgICAgICAgICB2YXIgZWxtV2lkdGggPSAhKDAsIHV0aWxzXzEuaXNQcm9taXNlKShzdmdFbGVtKSA/IChfYSA9IHN2Z0VsZW0uZ2V0QXR0cmlidXRlKFwid2lkdGhcIikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHVuZGVmaW5lZCA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgdmFyIGVsbUhlaWdodCA9ICEoMCwgdXRpbHNfMS5pc1Byb21pc2UpKHN2Z0VsZW0pID8gKF9iID0gc3ZnRWxlbS5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHVuZGVmaW5lZCA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgdmFyIG51bUVsbVdpZHRoID0gZWxtV2lkdGggIT0gbnVsbCA/IE51bWJlcihlbG1XaWR0aCkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIHZhciBudW1FbG1IZWlnaHQgPSBlbG1IZWlnaHQgIT0gbnVsbCA/IE51bWJlcihlbG1IZWlnaHQpIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgICByZXR1cm4gX3N1cGVyNTguY2FsbCh0aGlzLCB7XG4gICAgICAgICAgICAgICAgc3JjOiAoMCwgdXRpbHNfMS50aGVuKShzdmcsIGJ1aWxkU3ZnRGF0YVVybCksXG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoIHx8IG51bUVsbVdpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0IHx8IG51bUVsbUhlaWdodCxcbiAgICAgICAgICAgICAgICBpbWFnZVdpZHRoOiBudW1FbG1XaWR0aCxcbiAgICAgICAgICAgICAgICBpbWFnZUhlaWdodDogbnVtRWxtSGVpZ2h0XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSW5saW5lU3ZnLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiY2FuQnJlYWtcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhbkJyZWFrKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidG9TdHJpbmdcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBJbmxpbmVTdmc7XG4gICAgICAgICAgfShJbmxpbmVJbWFnZV8xLklubGluZUltYWdlKTtcblxuICAgICAgICAgIGV4cG9ydHMuSW5saW5lU3ZnID0gSW5saW5lU3ZnO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2VsZW1lbnQvaW5saW5lcy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9lbGVtZW50L2lubGluZXMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gZWxlbWVudElubGluZXNKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLnN0cmluZyA9IGV4cG9ydHMuYnVpbGRJbmxpbmVzID0gZXhwb3J0cy5vZiA9IGV4cG9ydHMuaWNvbk9mID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGljb25zID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ljb25zICovXG4gICAgICAgICAgXCIuL2ljb25zLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBwYXRoMkRNYW5hZ2VyID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3BhdGgyRE1hbmFnZXIgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvcGF0aDJETWFuYWdlci5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgSW5saW5lXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0lubGluZSAqL1xuICAgICAgICAgIFwiLi9lbGVtZW50L0lubGluZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBJbmxpbmVEcmF3ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vSW5saW5lRHJhd2VyICovXG4gICAgICAgICAgXCIuL2VsZW1lbnQvSW5saW5lRHJhd2VyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIElubGluZUljb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vSW5saW5lSWNvbiAqL1xuICAgICAgICAgIFwiLi9lbGVtZW50L0lubGluZUljb24uanNcIik7XG5cbiAgICAgICAgICB2YXIgSW5saW5lSW1hZ2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vSW5saW5lSW1hZ2UgKi9cbiAgICAgICAgICBcIi4vZWxlbWVudC9JbmxpbmVJbWFnZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBJbmxpbmVQYXRoMkRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vSW5saW5lUGF0aDJEICovXG4gICAgICAgICAgXCIuL2VsZW1lbnQvSW5saW5lUGF0aDJELmpzXCIpO1xuXG4gICAgICAgICAgdmFyIElubGluZVN2Z18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9JbmxpbmVTdmcgKi9cbiAgICAgICAgICBcIi4vZWxlbWVudC9JbmxpbmVTdmcuanNcIik7XG5cbiAgICAgICAgICB2YXIgY2FudmFzZXNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL2NhbnZhc2VzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL2NhbnZhc2VzLmpzXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZHJhd1JlZ2lzdGVyZWRJY29uKGN0eCwgaWNvbiwgZHJhd1dpZHRoLCBkcmF3SGVpZ2h0LCBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBfcmVmNjcgPSBhcmd1bWVudHMubGVuZ3RoID4gOCAmJiBhcmd1bWVudHNbOF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s4XSA6IHt9LFxuICAgICAgICAgICAgICAgIF9yZWY2NyRvZmZzZXQgPSBfcmVmNjcub2Zmc2V0LFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IF9yZWY2NyRvZmZzZXQgPT09IHZvaWQgMCA/IDIgOiBfcmVmNjckb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBfcmVmNjcucGFkZGluZztcblxuICAgICAgICAgICAgdmFyIHJlY3QgPSB7XG4gICAgICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgICAgIHRvcDogdG9wLFxuICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgICAgICAgICByaWdodDogbGVmdCArIHdpZHRoLFxuICAgICAgICAgICAgICBib3R0b206IHRvcCArIGhlaWdodFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgY3R4LnJlY3QocmVjdC5sZWZ0LCByZWN0LnRvcCwgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHQpOyAvL2NsaXBcblxuICAgICAgICAgICAgICBjdHguY2xpcCgpOyAvL+aWh+Wtl+aPj+eUu1xuXG4gICAgICAgICAgICAgIHZhciBwb3MgPSAoMCwgY2FudmFzZXNfMS5jYWxjU3RhcnRQb3NpdGlvbikoY3R4LCByZWN0LCBkcmF3V2lkdGgsIGRyYXdIZWlnaHQsIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiBwYWRkaW5nXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBwYXRoMkRNYW5hZ2VyLmZpbGwoaWNvbiwgY3R4LCBwb3MueCwgcG9zLnksIGRyYXdXaWR0aCwgZHJhd0hlaWdodCk7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGlzSWNvbkNvbnN0cnVjdG9yT3B0aW9uKGljb24pIHtcbiAgICAgICAgICAgIGlmIChpY29uLmZvbnQgJiYgaWNvbi5jb250ZW50KSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gaXNJbmxpbmVJbWFnZUNvbnN0cnVjdG9yT3B0aW9uKGljb24pIHtcbiAgICAgICAgICAgIGlmIChpY29uLnNyYykge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGlzSW5saW5lU3ZnQ29uc3RydWN0b3JPcHRpb24oaWNvbikge1xuICAgICAgICAgICAgaWYgKGljb24ucGF0aCkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGljb25PZihpY29uKSB7XG4gICAgICAgICAgICBpZiAoaWNvbiBpbnN0YW5jZW9mIElubGluZV8xLklubGluZSkge1xuICAgICAgICAgICAgICByZXR1cm4gaWNvbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFpY29uKSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaXNJY29uQ29uc3RydWN0b3JPcHRpb24oaWNvbikpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJbmxpbmVJY29uXzEuSW5saW5lSWNvbihpY29uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzSW5saW5lSW1hZ2VDb25zdHJ1Y3Rvck9wdGlvbihpY29uKSkge1xuICAgICAgICAgICAgICByZXR1cm4gbmV3IElubGluZUltYWdlXzEuSW5saW5lSW1hZ2Uoe1xuICAgICAgICAgICAgICAgIHNyYzogaWNvbi5zcmMsXG4gICAgICAgICAgICAgICAgd2lkdGg6IGljb24ud2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBpY29uLndpZHRoXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaWNvbi5zdmcpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJbmxpbmVTdmdfMS5JbmxpbmVTdmcoe1xuICAgICAgICAgICAgICAgIHN2ZzogaWNvbi5zdmcsXG4gICAgICAgICAgICAgICAgd2lkdGg6IGljb24ud2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBpY29uLndpZHRoXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaXNJbmxpbmVTdmdDb25zdHJ1Y3Rvck9wdGlvbihpY29uKSkge1xuICAgICAgICAgICAgICByZXR1cm4gbmV3IElubGluZVBhdGgyRF8xLklubGluZVBhdGgyRCh7XG4gICAgICAgICAgICAgICAgcGF0aDogaWNvbi5wYXRoLFxuICAgICAgICAgICAgICAgIHdpZHRoOiBpY29uLndpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaWNvbi53aWR0aCxcbiAgICAgICAgICAgICAgICBjb2xvcjogaWNvbi5jb2xvclxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRJY29ucyA9IGljb25zLmdldCgpO1xuXG4gICAgICAgICAgICBpZiAoaWNvbi5uYW1lICYmIHJlZ2lzdGVyZWRJY29uc1tpY29uLm5hbWVdKSB7XG4gICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkSWNvbiA9IHJlZ2lzdGVyZWRJY29uc1tpY29uLm5hbWVdO1xuICAgICAgICAgICAgICB2YXIgd2lkdGggPSBpY29uLndpZHRoIHx8IE1hdGgubWF4KHJlZ2lzdGVyZWRJY29uLndpZHRoLCByZWdpc3RlcmVkSWNvbi5oZWlnaHQpO1xuICAgICAgICAgICAgICByZXR1cm4gbmV3IElubGluZURyYXdlcl8xLklubGluZURyYXdlcih7XG4gICAgICAgICAgICAgICAgZHJhdzogZnVuY3Rpb24gZHJhdyhfcmVmNjgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjdHggPSBfcmVmNjguY3R4LFxuICAgICAgICAgICAgICAgICAgICAgIHJlY3QgPSBfcmVmNjgucmVjdCxcbiAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfcmVmNjgub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICAgIG9mZnNldExlZnQgPSBfcmVmNjgub2Zmc2V0TGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRSaWdodCA9IF9yZWY2OC5vZmZzZXRSaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3AgPSBfcmVmNjgub2Zmc2V0VG9wLFxuICAgICAgICAgICAgICAgICAgICAgIG9mZnNldEJvdHRvbSA9IF9yZWY2OC5vZmZzZXRCb3R0b207XG4gICAgICAgICAgICAgICAgICBkcmF3UmVnaXN0ZXJlZEljb24oY3R4LCByZWdpc3RlcmVkSWNvbiwgd2lkdGgsIHdpZHRoLCByZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCwge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCArIDEsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXRMZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBvZmZzZXRSaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICB0b3A6IG9mZnNldFRvcCxcbiAgICAgICAgICAgICAgICAgICAgICBib3R0b206IG9mZnNldEJvdHRvbVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHdpZHRoLFxuICAgICAgICAgICAgICAgIGNvbG9yOiBpY29uLmNvbG9yXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbmV3IElubGluZUljb25fMS5JbmxpbmVJY29uKGljb24pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuaWNvbk9mID0gaWNvbk9mO1xuXG4gICAgICAgICAgZnVuY3Rpb24gb2YoY29udGVudCkge1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbnRlbnQgaW5zdGFuY2VvZiBJbmxpbmVfMS5JbmxpbmUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgSW5saW5lXzEuSW5saW5lKGNvbnRlbnQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMub2YgPSBvZjtcblxuICAgICAgICAgIGZ1bmN0aW9uIGJ1aWxkSW5saW5lcyhpY29ucywgaW5saW5lKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XG5cbiAgICAgICAgICAgIGlmIChpY29ucykge1xuICAgICAgICAgICAgICByZXN1bHQucHVzaC5hcHBseShyZXN1bHQsIF90b0NvbnN1bWFibGVBcnJheShpY29ucy5tYXAoZnVuY3Rpb24gKGljb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWNvbk9mKGljb24pO1xuICAgICAgICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaSAhPSBudWxsO1xuICAgICAgICAgICAgICB9KSkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpbmxpbmUpIC8vICYmIGlubGluZS5maWx0ZXIoaWwgPT4gaWwgaW5zdGFuY2VvZiBJbmxpbmUpLmxlbmd0aCA8LSA/XG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaC5hcHBseShyZXN1bHQsIF90b0NvbnN1bWFibGVBcnJheShpbmxpbmUubWFwKGZ1bmN0aW9uIChpbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKGlsKTtcbiAgICAgICAgICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBpICE9IG51bGw7XG4gICAgICAgICAgICAgICAgfSkpKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIGlsID0gb2YoaW5saW5lKTtcblxuICAgICAgICAgICAgICBpZiAoaWwpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpbCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmJ1aWxkSW5saW5lcyA9IGJ1aWxkSW5saW5lcztcblxuICAgICAgICAgIGZ1bmN0aW9uIHN0cmluZyhpbmxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBidWlsZElubGluZXModW5kZWZpbmVkLCBpbmxpbmUpLmpvaW4oXCJcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5zdHJpbmcgPSBzdHJpbmc7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vZ2V0LWludGVybmFsLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2dldC1pbnRlcm5hbC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBnZXRJbnRlcm5hbEpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuZ2V0SW50ZXJuYWwgPSB2b2lkIDA7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcInVzZSBpbnRlcm5hbCEhXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgY29sb3I6IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgICAgIC8qISAuL2ludGVybmFsL2NvbG9yICovXG4gICAgICAgICAgICAgIFwiLi9pbnRlcm5hbC9jb2xvci5qc1wiKSxcbiAgICAgICAgICAgICAgc29ydDogX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgICAgLyohIC4vaW50ZXJuYWwvc29ydCAqL1xuICAgICAgICAgICAgICBcIi4vaW50ZXJuYWwvc29ydC5qc1wiKSxcbiAgICAgICAgICAgICAgY2FsYzogX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgICAgLyohIC4vaW50ZXJuYWwvY2FsYyAqL1xuICAgICAgICAgICAgICBcIi4vaW50ZXJuYWwvY2FsYy5qc1wiKSxcbiAgICAgICAgICAgICAgc3ltYm9sTWFuYWdlcjogX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgICAgLyohIC4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlciAqL1xuICAgICAgICAgICAgICBcIi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlci5qc1wiKSxcbiAgICAgICAgICAgICAgcGF0aDJETWFuYWdlcjogX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgICAgLyohIC4vaW50ZXJuYWwvcGF0aDJETWFuYWdlciAqL1xuICAgICAgICAgICAgICBcIi4vaW50ZXJuYWwvcGF0aDJETWFuYWdlci5qc1wiKSxcbiAgICAgICAgICAgICAgcGFzdGVVdGlsczogX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgICAgLyohIC4vaW50ZXJuYWwvcGFzdGUtdXRpbHMgKi9cbiAgICAgICAgICAgICAgXCIuL2ludGVybmFsL3Bhc3RlLXV0aWxzLmpzXCIpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZ2V0SW50ZXJuYWwgPSBnZXRJbnRlcm5hbDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvYWN0aW9uLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvYWN0aW9uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJBY3Rpb25Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLm9mQ2VsbCA9IGV4cG9ydHMub2YgPSBleHBvcnRzLkNoZWNrSGVhZGVyQWN0aW9uID0gZXhwb3J0cy5Tb3J0SGVhZGVyQWN0aW9uID0gZXhwb3J0cy5CYXNlQWN0aW9uID0gZXhwb3J0cy5BQ1RJT05TID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEJhc2VBY3Rpb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uL0Jhc2VBY3Rpb24gKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL2FjdGlvbi9CYXNlQWN0aW9uLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiQmFzZUFjdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBCYXNlQWN0aW9uXzEuQmFzZUFjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBDaGVja0hlYWRlckFjdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb24vQ2hlY2tIZWFkZXJBY3Rpb24gKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL2FjdGlvbi9DaGVja0hlYWRlckFjdGlvbi5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkNoZWNrSGVhZGVyQWN0aW9uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIENoZWNrSGVhZGVyQWN0aW9uXzEuQ2hlY2tIZWFkZXJBY3Rpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgU29ydEhlYWRlckFjdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb24vU29ydEhlYWRlckFjdGlvbiAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvYWN0aW9uL1NvcnRIZWFkZXJBY3Rpb24uanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTb3J0SGVhZGVyQWN0aW9uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFNvcnRIZWFkZXJBY3Rpb25fMS5Tb3J0SGVhZGVyQWN0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIEltbXV0YWJsZVNvcnRIZWFkZXJBY3Rpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Tb3J0SGVhZGVyQWN0aW9uXzEkUykge1xuICAgICAgICAgICAgX2luaGVyaXRzKEltbXV0YWJsZVNvcnRIZWFkZXJBY3Rpb24sIF9Tb3J0SGVhZGVyQWN0aW9uXzEkUyk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI1OSA9IF9jcmVhdGVTdXBlcihJbW11dGFibGVTb3J0SGVhZGVyQWN0aW9uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gSW1tdXRhYmxlU29ydEhlYWRlckFjdGlvbigpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEltbXV0YWJsZVNvcnRIZWFkZXJBY3Rpb24pO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI1OS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSW1tdXRhYmxlU29ydEhlYWRlckFjdGlvbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc2FibGVkXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kaXNhYmxlZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gSW1tdXRhYmxlU29ydEhlYWRlckFjdGlvbjtcbiAgICAgICAgICB9KFNvcnRIZWFkZXJBY3Rpb25fMS5Tb3J0SGVhZGVyQWN0aW9uKTtcblxuICAgICAgICAgIHZhciBJbW11dGFibGVDaGVja0hlYWRlckFjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NoZWNrSGVhZGVyQWN0aW9uXzEkKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoSW1tdXRhYmxlQ2hlY2tIZWFkZXJBY3Rpb24sIF9DaGVja0hlYWRlckFjdGlvbl8xJCk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI2MCA9IF9jcmVhdGVTdXBlcihJbW11dGFibGVDaGVja0hlYWRlckFjdGlvbik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEltbXV0YWJsZUNoZWNrSGVhZGVyQWN0aW9uKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW1tdXRhYmxlQ2hlY2tIZWFkZXJBY3Rpb24pO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI2MC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSW1tdXRhYmxlQ2hlY2tIZWFkZXJBY3Rpb24sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNhYmxlZFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEltbXV0YWJsZUNoZWNrSGVhZGVyQWN0aW9uO1xuICAgICAgICAgIH0oQ2hlY2tIZWFkZXJBY3Rpb25fMS5DaGVja0hlYWRlckFjdGlvbik7XG5cbiAgICAgICAgICBleHBvcnRzLkFDVElPTlMgPSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgU09SVDogbmV3IEltbXV0YWJsZVNvcnRIZWFkZXJBY3Rpb24oKSxcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICBDSEVDSzogbmV3IEltbXV0YWJsZUNoZWNrSGVhZGVyQWN0aW9uKClcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgZnVuY3Rpb24gb2YoaGVhZGVyQWN0aW9uKSB7XG4gICAgICAgICAgICBpZiAoIWhlYWRlckFjdGlvbikge1xuICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaGVhZGVyQWN0aW9uID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgIHZhciBrZXkgPSBoZWFkZXJBY3Rpb24udG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuQUNUSU9OU1trZXldIHx8IG9mKG51bGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhlYWRlckFjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm9mID0gb2Y7XG5cbiAgICAgICAgICBmdW5jdGlvbiBvZkNlbGwoaGVhZGVyQ2VsbCkge1xuICAgICAgICAgICAgaWYgKGhlYWRlckNlbGwuc29ydCkge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIGhlYWRlckNlbGwuc29ydCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvcnRNZXRob2QgPSBoZWFkZXJDZWxsLnNvcnQ7IC8vIDAuOS4wIEJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblxuICAgICAgICAgICAgICAgIHZhciBzb3J0ID0gZnVuY3Rpb24gc29ydChfcmVmNjkpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBvcmRlciA9IF9yZWY2OS5vcmRlcixcbiAgICAgICAgICAgICAgICAgICAgICBjb2wgPSBfcmVmNjkuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIGdyaWQgPSBfcmVmNjkuZ3JpZDtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBzb3J0TWV0aG9kLmNhbGwoaGVhZGVyQ2VsbCwgb3JkZXIsIGNvbCwgZ3JpZCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW1tdXRhYmxlU29ydEhlYWRlckFjdGlvbih7XG4gICAgICAgICAgICAgICAgICBzb3J0OiBzb3J0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAodHlwZW9mIGhlYWRlckNlbGwuc29ydCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW1tdXRhYmxlU29ydEhlYWRlckFjdGlvbih7XG4gICAgICAgICAgICAgICAgICBzb3J0OiBoZWFkZXJDZWxsLnNvcnRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBleHBvcnRzLkFDVElPTlMuU09SVDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG9mKGhlYWRlckNlbGwuaGVhZGVyQWN0aW9uKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm9mQ2VsbCA9IG9mQ2VsbDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvYWN0aW9uL0Jhc2VBY3Rpb24uanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL2FjdGlvbi9CYXNlQWN0aW9uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGhlYWRlckFjdGlvbkJhc2VBY3Rpb25Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkJhc2VBY3Rpb24gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgQmFzZUFjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBCYXNlQWN0aW9uKCkge1xuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZUFjdGlvbik7XG5cbiAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZWQgPSAhIW9wdGlvbi5kaXNhYmxlZCB8fCBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEJhc2VBY3Rpb24sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNhYmxlZFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGRpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZWQgPSBkaXNhYmxlZDtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlRGlzYWJsZWRJbnRlcm5hbCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCYXNlQWN0aW9uKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJiaW5kR3JpZEV2ZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kR3JpZEV2ZW50KF9ncmlkLCBfY2VsbElkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbkNoYW5nZURpc2FibGVkSW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlRGlzYWJsZWRJbnRlcm5hbCgpIHsvLyBpbXBsXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEJhc2VBY3Rpb247XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5CYXNlQWN0aW9uID0gQmFzZUFjdGlvbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvYWN0aW9uL0NoZWNrSGVhZGVyQWN0aW9uLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvYWN0aW9uL0NoZWNrSGVhZGVyQWN0aW9uLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJBY3Rpb25DaGVja0hlYWRlckFjdGlvbkpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQ2hlY2tIZWFkZXJBY3Rpb24gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgYWN0aW9uQmluZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9hY3Rpb25CaW5kICovXG4gICAgICAgICAgXCIuL2hlYWRlci9hY3Rpb24vYWN0aW9uQmluZC5qc1wiKTtcblxuICAgICAgICAgIHZhciBCYXNlQWN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VBY3Rpb24gKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL2FjdGlvbi9CYXNlQWN0aW9uLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGFuaW1hdGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL2FuaW1hdGUgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvYW5pbWF0ZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIENIRUNLX0hFQURFUl9TVEFURV9JRCA9ICgwLCBzeW1ib2xNYW5hZ2VyXzEuZ2V0Q2hlY2tIZWFkZXJTdGF0ZUlkKSgpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0U3RhdGUoZ3JpZCkge1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JpZFtDSEVDS19IRUFERVJfU1RBVEVfSURdO1xuXG4gICAgICAgICAgICBpZiAoIXN0YXRlKSB7XG4gICAgICAgICAgICAgIHN0YXRlID0ge1xuICAgICAgICAgICAgICAgIGVsYXBzZWQ6IHt9LFxuICAgICAgICAgICAgICAgIGJsb2NrOiB7fVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB1dGlsc18xLm9iai5zZXRSZWFkb25seShncmlkLCBDSEVDS19IRUFERVJfU1RBVEVfSUQsIHN0YXRlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBDaGVja0hlYWRlckFjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VBY3Rpb25fMSRCYXNlQWN0Mykge1xuICAgICAgICAgICAgX2luaGVyaXRzKENoZWNrSGVhZGVyQWN0aW9uLCBfQmFzZUFjdGlvbl8xJEJhc2VBY3QzKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjYxID0gX2NyZWF0ZVN1cGVyKENoZWNrSGVhZGVyQWN0aW9uKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gQ2hlY2tIZWFkZXJBY3Rpb24oKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaGVja0hlYWRlckFjdGlvbik7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjYxLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhDaGVja0hlYWRlckFjdGlvbiwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNsb25lXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENoZWNrSGVhZGVyQWN0aW9uKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJiaW5kR3JpZEV2ZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kR3JpZEV2ZW50KGdyaWQsIGNlbGxJZCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczkxID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdldFN0YXRlKGdyaWQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGZ1bmN0aW9uIGFjdGlvbihfcmVmNzApIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBfcmVmNzAuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IF9yZWY3MC5yb3c7XG4gICAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBncmlkLmdldENlbGxSYW5nZShjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgICB2YXIgY2VsbEtleSA9IFwiXCIuY29uY2F0KHJhbmdlLnN0YXJ0LmNvbCwgXCI6XCIpLmNvbmNhdChyYW5nZS5zdGFydC5yb3cpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoX3RoaXM5MS5kaXNhYmxlZCB8fCBzdGF0ZS5ibG9ja1tjZWxsS2V5XSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBjaGVja2VkID0gZ3JpZC5nZXRIZWFkZXJWYWx1ZShyYW5nZS5zdGFydC5jb2wsIHJhbmdlLnN0YXJ0LnJvdyk7XG4gICAgICAgICAgICAgICAgICBncmlkLnNldEhlYWRlclZhbHVlKHJhbmdlLnN0YXJ0LmNvbCwgcmFuZ2Uuc3RhcnQucm93LCAhY2hlY2tlZCk7XG5cbiAgICAgICAgICAgICAgICAgIHZhciBvbkNoYW5nZSA9IGZ1bmN0aW9uIG9uQ2hhbmdlKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVja2JveCBhbmltYXRpb25cbiAgICAgICAgICAgICAgICAgICAgKDAsIGFuaW1hdGVfMS5hbmltYXRlKSgyMDAsIGZ1bmN0aW9uIChwb2ludCkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2ludCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLmVsYXBzZWRbY2VsbEtleV07XG4gICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmVsYXBzZWRbY2VsbEtleV0gPSBwb2ludDtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGVDZWxsUmFuZ2UocmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KCgwLCBhY3Rpb25CaW5kXzEuYmluZENlbGxDbGlja0FjdGlvbikoZ3JpZCwgY2VsbElkLCB7XG4gICAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICAgIG1vdXNlT3ZlcjogZnVuY3Rpb24gbW91c2VPdmVyKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzOTEuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZUFjdGl2ZUNlbGwgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgY29sOiBlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgICByb3c6IGUucm93XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGdyaWQuZ2V0Q2VsbFJhbmdlKGUuY29sLCBlLnJvdyk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIG1vdXNlT3V0OiBmdW5jdGlvbiBtb3VzZU91dChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5tb3VzZUFjdGl2ZUNlbGw7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IGdyaWQuZ2V0Q2VsbFJhbmdlKGUuY29sLCBlLnJvdyk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWQuaW52YWxpZGF0ZUNlbGxSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpLCBfdG9Db25zdW1hYmxlQXJyYXkoKDAsIGFjdGlvbkJpbmRfMS5iaW5kQ2VsbEtleUFjdGlvbikoZ3JpZCwgY2VsbElkLCB7XG4gICAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvblxuICAgICAgICAgICAgICAgIH0pKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIENoZWNrSGVhZGVyQWN0aW9uO1xuICAgICAgICAgIH0oQmFzZUFjdGlvbl8xLkJhc2VBY3Rpb24pO1xuXG4gICAgICAgICAgZXhwb3J0cy5DaGVja0hlYWRlckFjdGlvbiA9IENoZWNrSGVhZGVyQWN0aW9uO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlci9hY3Rpb24vU29ydEhlYWRlckFjdGlvbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvYWN0aW9uL1NvcnRIZWFkZXJBY3Rpb24uanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaGVhZGVyQWN0aW9uU29ydEhlYWRlckFjdGlvbkpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuU29ydEhlYWRlckFjdGlvbiA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlQWN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VBY3Rpb24gKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL2FjdGlvbi9CYXNlQWN0aW9uLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGFjdGlvbkJpbmRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vYWN0aW9uQmluZCAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvYWN0aW9uL2FjdGlvbkJpbmQuanNcIik7XG5cbiAgICAgICAgICB2YXIgU29ydEhlYWRlckFjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VBY3Rpb25fMSRCYXNlQWN0NCkge1xuICAgICAgICAgICAgX2luaGVyaXRzKFNvcnRIZWFkZXJBY3Rpb24sIF9CYXNlQWN0aW9uXzEkQmFzZUFjdDQpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNjIgPSBfY3JlYXRlU3VwZXIoU29ydEhlYWRlckFjdGlvbik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIFNvcnRIZWFkZXJBY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczkyO1xuXG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTb3J0SGVhZGVyQWN0aW9uKTtcblxuICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgX3RoaXM5MiA9IF9zdXBlcjYyLmNhbGwodGhpcywgb3B0aW9uKTtcbiAgICAgICAgICAgICAgX3RoaXM5Mi5fc29ydCA9IChfYSA9IG9wdGlvbi5zb3J0KSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB0cnVlO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM5MjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFNvcnRIZWFkZXJBY3Rpb24sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJzb3J0XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zb3J0O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChzb3J0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc29ydCA9IHNvcnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZURpc2FibGVkSW50ZXJuYWwoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU29ydEhlYWRlckFjdGlvbih0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2V4ZWN1dGVTb3J0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZXhlY3V0ZVNvcnQobmV3U3RhdGUsIGdyaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuX3NvcnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgdGhpcy5fc29ydCh7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyOiBuZXdTdGF0ZS5vcmRlciB8fCBcImFzY1wiLFxuICAgICAgICAgICAgICAgICAgICBjb2w6IG5ld1N0YXRlLmNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiBuZXdTdGF0ZS5yb3csXG4gICAgICAgICAgICAgICAgICAgIGdyaWQ6IGdyaWRcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuX3NvcnQgPT09IFwic3RyaW5nXCIgJiYgKCAvLyB2MS42LjMgQmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICAgICAgICAgICAgICAgIHRoaXMuX3NvcnQgIT09IFwidHJ1ZVwiIHx8IGhhc1RydWVGaWVsZChncmlkKSkpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuX3NvcnQ7XG4gICAgICAgICAgICAgICAgICBncmlkLmRhdGFTb3VyY2Uuc29ydChmaWVsZCwgbmV3U3RhdGUub3JkZXIgfHwgXCJhc2NcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHZhciBmaWVsZFJvdyA9IE1hdGgubWluKGdyaWQucmVjb3JkUm93Q291bnQgLSAxLCBuZXdTdGF0ZS5yb3cpICsgZ3JpZC5mcm96ZW5Sb3dDb3VudDtcblxuICAgICAgICAgICAgICAgICAgdmFyIF9maWVsZDMgPSBncmlkLmdldEZpZWxkKG5ld1N0YXRlLmNvbCwgZmllbGRSb3cpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoX2ZpZWxkMyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgZ3JpZC5kYXRhU291cmNlLnNvcnQoX2ZpZWxkMywgbmV3U3RhdGUub3JkZXIgfHwgXCJhc2NcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJiaW5kR3JpZEV2ZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kR3JpZEV2ZW50KGdyaWQsIGNlbGxJZCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczkzID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzVGFyZ2V0KGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZ3JpZC5nZXRMYXlvdXRDZWxsSWQoY29sLCByb3cpID09PSBjZWxsSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGZ1bmN0aW9uIGFjdGlvbihjZWxsKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoX3RoaXM5My5kaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyaWQuc29ydFN0YXRlO1xuICAgICAgICAgICAgICAgICAgdmFyIG5ld1N0YXRlO1xuICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gZ3JpZC5nZXRDZWxsUmFuZ2UoY2VsbC5jb2wsIGNlbGwucm93KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKGlzVGFyZ2V0KHN0YXRlLmNvbCwgY2VsbC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1N0YXRlID0ge1xuICAgICAgICAgICAgICAgICAgICAgIGNvbDogcmFuZ2Uuc3RhcnQuY29sLFxuICAgICAgICAgICAgICAgICAgICAgIHJvdzogcmFuZ2Uuc3RhcnQucm93LFxuICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiBzdGF0ZS5vcmRlciA9PT0gXCJhc2NcIiA/IFwiZGVzY1wiIDogXCJhc2NcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgY29sOiByYW5nZS5zdGFydC5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93OiByYW5nZS5zdGFydC5yb3csXG4gICAgICAgICAgICAgICAgICAgICAgb3JkZXI6IFwiYXNjXCJcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgZ3JpZC5zb3J0U3RhdGUgPSBuZXdTdGF0ZTtcblxuICAgICAgICAgICAgICAgICAgX3RoaXM5My5fZXhlY3V0ZVNvcnQobmV3U3RhdGUsIGdyaWQpO1xuXG4gICAgICAgICAgICAgICAgICBncmlkLmludmFsaWRhdGVHcmlkUmVjdCgwLCAwLCBncmlkLmNvbENvdW50IC0gMSwgZ3JpZC5yb3dDb3VudCAtIDEpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX3RvQ29uc3VtYWJsZUFycmF5KCgwLCBhY3Rpb25CaW5kXzEuYmluZENlbGxDbGlja0FjdGlvbikoZ3JpZCwgY2VsbElkLCB7XG4gICAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICAgIG1vdXNlT3ZlcjogZnVuY3Rpb24gbW91c2VPdmVyKF9lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczkzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBTb3J0SGVhZGVyQWN0aW9uO1xuICAgICAgICAgIH0oQmFzZUFjdGlvbl8xLkJhc2VBY3Rpb24pO1xuXG4gICAgICAgICAgZXhwb3J0cy5Tb3J0SGVhZGVyQWN0aW9uID0gU29ydEhlYWRlckFjdGlvbjtcblxuICAgICAgICAgIGZ1bmN0aW9uIGhhc1RydWVGaWVsZChncmlkKSB7XG4gICAgICAgICAgICBpZiAoZ3JpZC5kYXRhU291cmNlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IGdyaWQuZGF0YVNvdXJjZS5nZXQoMCk7XG4gICAgICAgICAgICAgIHJldHVybiByZWNvcmQgIT0gbnVsbCAmJiBcInRydWVcIiBpbiByZWNvcmQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqKi9cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvYWN0aW9uL2FjdGlvbkJpbmQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL2FjdGlvbi9hY3Rpb25CaW5kLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGhlYWRlckFjdGlvbkFjdGlvbkJpbmRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLmJpbmRDZWxsS2V5QWN0aW9uID0gZXhwb3J0cy5iaW5kQ2VsbENsaWNrQWN0aW9uID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIERHX0VWRU5UX1RZUEVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2NvcmUvREdfRVZFTlRfVFlQRSAqL1xuICAgICAgICAgIFwiLi9jb3JlL0RHX0VWRU5UX1RZUEUuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEtFWV9FTlRFUiA9IDEzO1xuICAgICAgICAgIHZhciBLRVlfU1BBQ0UgPSAzMjtcblxuICAgICAgICAgIGZ1bmN0aW9uIGJpbmRDZWxsQ2xpY2tBY3Rpb24oZ3JpZCwgY2VsbElkLCBfcmVmNzEpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpb24gPSBfcmVmNzEuYWN0aW9uLFxuICAgICAgICAgICAgICAgIG1vdXNlT3ZlciA9IF9yZWY3MS5tb3VzZU92ZXIsXG4gICAgICAgICAgICAgICAgbW91c2VPdXQgPSBfcmVmNzEubW91c2VPdXQ7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzVGFyZ2V0KGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgIHJldHVybiBncmlkLmdldExheW91dENlbGxJZChjb2wsIHJvdykgPT09IGNlbGxJZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGluTW91c2U7XG4gICAgICAgICAgICByZXR1cm4gWy8vIGNsaWNrXG4gICAgICAgICAgICBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5DTElDS19DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICBpZiAoIWlzVGFyZ2V0KGUuY29sLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBhY3Rpb24oe1xuICAgICAgICAgICAgICAgIGNvbDogZS5jb2wsXG4gICAgICAgICAgICAgICAgcm93OiBlLnJvd1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pLCAvLyBtb3VzZSBtb3ZlXG4gICAgICAgICAgICBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5NT1VTRU9WRVJfQ0VMTCwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgaWYgKCFpc1RhcmdldChlLmNvbCwgZS5yb3cpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKG1vdXNlT3Zlcikge1xuICAgICAgICAgICAgICAgIGlmICghbW91c2VPdmVyKHtcbiAgICAgICAgICAgICAgICAgIGNvbDogZS5jb2wsXG4gICAgICAgICAgICAgICAgICByb3c6IGUucm93XG4gICAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBncmlkLmdldEVsZW1lbnQoKS5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcbiAgICAgICAgICAgICAgaW5Nb3VzZSA9IHRydWU7XG4gICAgICAgICAgICB9KSwgLy/mqKrjgYvjgolNT1VTRUVOVEVS44GX44Gf5aC05ZCI44CBJ2NvbC1yZXNpemUn44Gu5Yem55CG44Go56u25ZCI44GZ44KL44Gu44GnbW92ZeOCkuebo+imluOBl+OBpuWHpueQhuOBmeOCi1xuICAgICAgICAgICAgZ3JpZC5saXN0ZW4oREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUuTU9VU0VNT1ZFX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChpbk1vdXNlICYmICFncmlkLmdldEVsZW1lbnQoKS5zdHlsZS5jdXJzb3IpIHtcbiAgICAgICAgICAgICAgICBncmlkLmdldEVsZW1lbnQoKS5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSksIGdyaWQubGlzdGVuKERHX0VWRU5UX1RZUEVfMS5ER19FVkVOVF9UWVBFLk1PVVNFT1VUX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGlmICghaXNUYXJnZXQoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChtb3VzZU91dCkge1xuICAgICAgICAgICAgICAgIG1vdXNlT3V0KHtcbiAgICAgICAgICAgICAgICAgIGNvbDogZS5jb2wsXG4gICAgICAgICAgICAgICAgICByb3c6IGUucm93XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBncmlkLmdldEVsZW1lbnQoKS5zdHlsZS5jdXJzb3IgPSBcIlwiO1xuICAgICAgICAgICAgICBpbk1vdXNlID0gZmFsc2U7XG4gICAgICAgICAgICB9KV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5iaW5kQ2VsbENsaWNrQWN0aW9uID0gYmluZENlbGxDbGlja0FjdGlvbjtcblxuICAgICAgICAgIGZ1bmN0aW9uIGJpbmRDZWxsS2V5QWN0aW9uKGdyaWQsIGNlbGxJZCwgX3JlZjcyKSB7XG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gX3JlZjcyLmFjdGlvbixcbiAgICAgICAgICAgICAgICBfcmVmNzIkYWNjZXB0S2V5cyA9IF9yZWY3Mi5hY2NlcHRLZXlzLFxuICAgICAgICAgICAgICAgIGFjY2VwdEtleXMgPSBfcmVmNzIkYWNjZXB0S2V5cyA9PT0gdm9pZCAwID8gW10gOiBfcmVmNzIkYWNjZXB0S2V5cztcblxuICAgICAgICAgICAgZnVuY3Rpb24gaXNUYXJnZXQoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGdyaWQuZ2V0TGF5b3V0Q2VsbElkKGNvbCwgcm93KSA9PT0gY2VsbElkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhY2NlcHRLZXlzID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhY2NlcHRLZXlzKSwgW0tFWV9FTlRFUiwgS0VZX1NQQUNFXSk7XG4gICAgICAgICAgICByZXR1cm4gWy8vIGVudGVyIGtleSBkb3duXG4gICAgICAgICAgICBncmlkLmxpc3RlbihER19FVkVOVF9UWVBFXzEuREdfRVZFTlRfVFlQRS5LRVlET1dOLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICB2YXIgX2E7XG5cbiAgICAgICAgICAgICAgaWYgKGFjY2VwdEtleXMuaW5kZXhPZihlLmtleUNvZGUpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICgoKF9hID0gZ3JpZC5rZXlib2FyZE9wdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5tb3ZlQ2VsbE9uRW50ZXIpICYmIGUua2V5Q29kZSA9PT0gS0VZX0VOVEVSKSB7XG4gICAgICAgICAgICAgICAgLy8gV2hlbiBtb3Zpbmcgd2l0aCB0aGUgZW50ZXIga2V5LCBubyBhY3Rpb24gaXMgdGFrZW4gd2l0aCB0aGUgZW50ZXIga2V5LlxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBzZWwgPSBncmlkLnNlbGVjdGlvbi5zZWxlY3Q7XG5cbiAgICAgICAgICAgICAgaWYgKCFpc1RhcmdldChzZWwuY29sLCBzZWwucm93KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGFjdGlvbih7XG4gICAgICAgICAgICAgICAgY29sOiBzZWwuY29sLFxuICAgICAgICAgICAgICAgIHJvdzogc2VsLnJvd1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdXRpbHNfMS5ldmVudC5jYW5jZWwoZS5ldmVudCk7XG4gICAgICAgICAgICB9KV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5iaW5kQ2VsbEtleUFjdGlvbiA9IGJpbmRDZWxsS2V5QWN0aW9uO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlci9zdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvc3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaGVhZGVyU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLm9mID0gZXhwb3J0cy5NdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGUgPSBleHBvcnRzLkNoZWNrSGVhZGVyU3R5bGUgPSBleHBvcnRzLlNvcnRIZWFkZXJTdHlsZSA9IGV4cG9ydHMuU3R5bGUgPSBleHBvcnRzLkJhc2VTdHlsZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvQmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9CYXNlU3R5bGUuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJCYXNlU3R5bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gQmFzZVN0eWxlXzEuQmFzZVN0eWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIENoZWNrSGVhZGVyU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvQ2hlY2tIZWFkZXJTdHlsZSAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvQ2hlY2tIZWFkZXJTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkNoZWNrSGVhZGVyU3R5bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gQ2hlY2tIZWFkZXJTdHlsZV8xLkNoZWNrSGVhZGVyU3R5bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3N0eWxlL011bHRpbGluZVRleHRIZWFkZXJTdHlsZSAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE11bHRpbGluZVRleHRIZWFkZXJTdHlsZV8xLk11bHRpbGluZVRleHRIZWFkZXJTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBTb3J0SGVhZGVyU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUvU29ydEhlYWRlclN0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9Tb3J0SGVhZGVyU3R5bGUuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTb3J0SGVhZGVyU3R5bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gU29ydEhlYWRlclN0eWxlXzEuU29ydEhlYWRlclN0eWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIFN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3N0eWxlL1N0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9TdHlsZS5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlN0eWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFN0eWxlXzEuU3R5bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBmdW5jdGlvbiBvZihoZWFkZXJTdHlsZSwgU3R5bGVDbGFzcykge1xuICAgICAgICAgICAgaWYgKGhlYWRlclN0eWxlKSB7XG4gICAgICAgICAgICAgIGlmIChoZWFkZXJTdHlsZSBpbnN0YW5jZW9mIFN0eWxlXzEuU3R5bGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGVhZGVyU3R5bGU7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGhlYWRlclN0eWxlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YoaGVhZGVyU3R5bGUoKSwgU3R5bGVDbGFzcyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0eWxlQ2xhc3MoaGVhZGVyU3R5bGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFN0eWxlQ2xhc3MuREVGQVVMVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm9mID0gb2Y7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaGVhZGVyL3N0eWxlL0Jhc2VTdHlsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL3N0eWxlL0Jhc2VTdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaGVhZGVyU3R5bGVCYXNlU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkJhc2VTdHlsZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBFdmVudFRhcmdldF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vY29yZS9FdmVudFRhcmdldCAqL1xuICAgICAgICAgIFwiLi9jb3JlL0V2ZW50VGFyZ2V0LmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEVWRU5UX1RZUEUgPSB7XG4gICAgICAgICAgICBDSEFOR0VfU1RZTEU6IFwiY2hhbmdlX3N0eWxlXCJcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciBkZWZhdWx0U3R5bGU7XG5cbiAgICAgICAgICB2YXIgQmFzZVN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXZlbnRUYXJnZXRfMSRFdmVudFQ2KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQmFzZVN0eWxlLCBfRXZlbnRUYXJnZXRfMSRFdmVudFQ2KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjYzID0gX2NyZWF0ZVN1cGVyKEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEJhc2VTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzOTQ7XG5cbiAgICAgICAgICAgICAgdmFyIF9yZWY3MyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge30sXG4gICAgICAgICAgICAgICAgICBiZ0NvbG9yID0gX3JlZjczLmJnQ29sb3I7XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICAgICAgX3RoaXM5NCA9IF9zdXBlcjYzLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgIF90aGlzOTQuX2JnQ29sb3IgPSBiZ0NvbG9yO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM5NDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEJhc2VTdHlsZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImJnQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JnQ29sb3I7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGJnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iZ0NvbG9yID0gYmdDb2xvcjtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZG9DaGFuZ2VTdHlsZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZG9DaGFuZ2VTdHlsZSgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmVMaXN0ZW5lcnMoRVZFTlRfVFlQRS5DSEFOR0VfU1RZTEUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCYXNlU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiRVZFTlRfVFlQRVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRVZFTlRfVFlQRTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IEJhc2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCYXNlU3R5bGU7XG4gICAgICAgICAgfShFdmVudFRhcmdldF8xLkV2ZW50VGFyZ2V0KTtcblxuICAgICAgICAgIGV4cG9ydHMuQmFzZVN0eWxlID0gQmFzZVN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9DaGVja0hlYWRlclN0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL3N0eWxlL0NoZWNrSGVhZGVyU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJTdHlsZUNoZWNrSGVhZGVyU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkNoZWNrSGVhZGVyU3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgU3RkVGV4dEJhc2VTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9TdGRUZXh0QmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9TdGRUZXh0QmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIHZhciBkZWZhdWx0U3R5bGU7XG5cbiAgICAgICAgICB2YXIgQ2hlY2tIZWFkZXJTdHlsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1N0ZFRleHRCYXNlU3R5bGVfMSRTKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQ2hlY2tIZWFkZXJTdHlsZSwgX1N0ZFRleHRCYXNlU3R5bGVfMSRTKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjY0ID0gX2NyZWF0ZVN1cGVyKENoZWNrSGVhZGVyU3R5bGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBDaGVja0hlYWRlclN0eWxlKCkge1xuICAgICAgICAgICAgICB2YXIgX3RoaXM5NTtcblxuICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaGVja0hlYWRlclN0eWxlKTtcblxuICAgICAgICAgICAgICBfdGhpczk1ID0gX3N1cGVyNjQuY2FsbCh0aGlzLCAoMCwgdXRpbHNfMS5kZWZhdWx0cykoc3R5bGUsIHtcbiAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwiY2VudGVyXCJcbiAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICB2YXIgdW5jaGVja0JnQ29sb3IgPSBzdHlsZS51bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgIGNoZWNrQmdDb2xvciA9IHN0eWxlLmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yID0gc3R5bGUuYm9yZGVyQ29sb3I7XG4gICAgICAgICAgICAgIF90aGlzOTUuX3VuY2hlY2tCZ0NvbG9yID0gdW5jaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgIF90aGlzOTUuX2NoZWNrQmdDb2xvciA9IGNoZWNrQmdDb2xvcjtcbiAgICAgICAgICAgICAgX3RoaXM5NS5fYm9yZGVyQ29sb3IgPSBib3JkZXJDb2xvcjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOTU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhDaGVja0hlYWRlclN0eWxlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwidW5jaGVja0JnQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh1bmNoZWNrQmdDb2xvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VuY2hlY2tCZ0NvbG9yID0gdW5jaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNoZWNrQmdDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tCZ0NvbG9yO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjaGVja0JnQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0JnQ29sb3IgPSBjaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJvcmRlckNvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ib3JkZXJDb2xvcjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYm9yZGVyQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ib3JkZXJDb2xvciA9IGJvcmRlckNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGVja0hlYWRlclN0eWxlKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBDaGVja0hlYWRlclN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIENoZWNrSGVhZGVyU3R5bGU7XG4gICAgICAgICAgfShTdGRUZXh0QmFzZVN0eWxlXzEuU3RkVGV4dEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLkNoZWNrSGVhZGVyU3R5bGUgPSBDaGVja0hlYWRlclN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9NdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2hlYWRlci9zdHlsZS9NdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGhlYWRlclN0eWxlTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5NdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9TdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9TdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBNdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdGRNdWx0aWxpbmVUZXh0QmFzZSkge1xuICAgICAgICAgICAgX2luaGVyaXRzKE11bHRpbGluZVRleHRIZWFkZXJTdHlsZSwgX1N0ZE11bHRpbGluZVRleHRCYXNlKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjY1ID0gX2NyZWF0ZVN1cGVyKE11bHRpbGluZVRleHRIZWFkZXJTdHlsZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIE11bHRpbGluZVRleHRIZWFkZXJTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlKTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3N1cGVyNjUuY2FsbCh0aGlzLCBzdHlsZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhNdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IE11bHRpbGluZVRleHRIZWFkZXJTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBNdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGU7XG4gICAgICAgICAgfShTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlXzEuU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLk11bHRpbGluZVRleHRIZWFkZXJTdHlsZSA9IE11bHRpbGluZVRleHRIZWFkZXJTdHlsZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvU29ydEhlYWRlclN0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvc3R5bGUvU29ydEhlYWRlclN0eWxlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJTdHlsZVNvcnRIZWFkZXJTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuU29ydEhlYWRlclN0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFN0ZE11bHRpbGluZVRleHRCYXNlU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZSAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBkZWZhdWx0U3R5bGU7XG5cbiAgICAgICAgICB2YXIgU29ydEhlYWRlclN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RkTXVsdGlsaW5lVGV4dEJhc2UyKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoU29ydEhlYWRlclN0eWxlLCBfU3RkTXVsdGlsaW5lVGV4dEJhc2UyKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjY2ID0gX2NyZWF0ZVN1cGVyKFNvcnRIZWFkZXJTdHlsZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIFNvcnRIZWFkZXJTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzOTY7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU29ydEhlYWRlclN0eWxlKTtcblxuICAgICAgICAgICAgICBfdGhpczk2ID0gX3N1cGVyNjYuY2FsbCh0aGlzLCBzdHlsZSk7XG4gICAgICAgICAgICAgIF90aGlzOTYuX3NvcnRBcnJvd0NvbG9yID0gc3R5bGUuc29ydEFycm93Q29sb3I7XG4gICAgICAgICAgICAgIF90aGlzOTYuX211bHRpbGluZSA9IHN0eWxlLm11bHRpbGluZTtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOTY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhTb3J0SGVhZGVyU3R5bGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJzb3J0QXJyb3dDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc29ydEFycm93Q29sb3I7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHNvcnRBcnJvd0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc29ydEFycm93Q29sb3IgPSBzb3J0QXJyb3dDb2xvcjtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibXVsdGlsaW5lXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAhIXRoaXMuX211bHRpbGluZTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobXVsdGlsaW5lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbXVsdGlsaW5lID0gbXVsdGlsaW5lO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTb3J0SGVhZGVyU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IFNvcnRIZWFkZXJTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBTb3J0SGVhZGVyU3R5bGU7XG4gICAgICAgICAgfShTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlXzEuU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLlNvcnRIZWFkZXJTdHlsZSA9IFNvcnRIZWFkZXJTdHlsZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvU3RkQmFzZVN0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvc3R5bGUvU3RkQmFzZVN0eWxlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJTdHlsZVN0ZEJhc2VTdHlsZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuU3RkQmFzZVN0eWxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEJhc2VTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlU3R5bGUgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3N0eWxlL0Jhc2VTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBkZWZhdWx0U3R5bGU7XG5cbiAgICAgICAgICB2YXIgU3RkQmFzZVN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZVN0eWxlXzEkQmFzZVN0eWwzKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoU3RkQmFzZVN0eWxlLCBfQmFzZVN0eWxlXzEkQmFzZVN0eWwzKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjY3ID0gX2NyZWF0ZVN1cGVyKFN0ZEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIFN0ZEJhc2VTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzOTc7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RkQmFzZVN0eWxlKTtcblxuICAgICAgICAgICAgICBfdGhpczk3ID0gX3N1cGVyNjcuY2FsbCh0aGlzLCBzdHlsZSk7XG4gICAgICAgICAgICAgIF90aGlzOTcuX3RleHRBbGlnbiA9IHN0eWxlLnRleHRBbGlnbiB8fCBcImxlZnRcIjtcbiAgICAgICAgICAgICAgX3RoaXM5Ny5fdGV4dEJhc2VsaW5lID0gc3R5bGUudGV4dEJhc2VsaW5lIHx8IFwibWlkZGxlXCI7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczk3O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoU3RkQmFzZVN0eWxlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwidGV4dEFsaWduXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZXh0QWxpZ247XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHRleHRBbGlnbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RleHRBbGlnbiA9IHRleHRBbGlnbjtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidGV4dEJhc2VsaW5lXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZXh0QmFzZWxpbmU7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHRleHRCYXNlbGluZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RleHRCYXNlbGluZSA9IHRleHRCYXNlbGluZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RkQmFzZVN0eWxlKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBTdGRCYXNlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gU3RkQmFzZVN0eWxlO1xuICAgICAgICAgIH0oQmFzZVN0eWxlXzEuQmFzZVN0eWxlKTtcblxuICAgICAgICAgIGV4cG9ydHMuU3RkQmFzZVN0eWxlID0gU3RkQmFzZVN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9TdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL3N0eWxlL1N0ZE11bHRpbGluZVRleHRCYXNlU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJTdHlsZVN0ZE11bHRpbGluZVRleHRCYXNlU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlN0ZE11bHRpbGluZVRleHRCYXNlU3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgU3RkVGV4dEJhc2VTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9TdGRUZXh0QmFzZVN0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9TdGRUZXh0QmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RkVGV4dEJhc2VTdHlsZV8xJFMyKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZSwgX1N0ZFRleHRCYXNlU3R5bGVfMSRTMik7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI2OCA9IF9jcmVhdGVTdXBlcihTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzOTg7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICAgICAgX3RoaXM5OCA9IF9zdXBlcjY4LmNhbGwodGhpcywgc3R5bGUpO1xuICAgICAgICAgICAgICBfdGhpczk4Ll9saW5lSGVpZ2h0ID0gc3R5bGUubGluZUhlaWdodCB8fCBcIjFlbVwiO1xuICAgICAgICAgICAgICBfdGhpczk4Ll9hdXRvV3JhcFRleHQgPSBzdHlsZS5hdXRvV3JhcFRleHQgfHwgZmFsc2U7XG4gICAgICAgICAgICAgIF90aGlzOTguX2xpbmVDbGFtcCA9IHN0eWxlLmxpbmVDbGFtcDtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOTg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZSh0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibGluZUhlaWdodFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGluZUhlaWdodDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobGluZUhlaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xpbmVIZWlnaHQgPSBsaW5lSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJsaW5lQ2xhbXBcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpbmVDbGFtcDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobGluZUNsYW1wKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGluZUNsYW1wID0gbGluZUNsYW1wO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhdXRvV3JhcFRleHRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2F1dG9XcmFwVGV4dDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYXV0b1dyYXBUZXh0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXV0b1dyYXBUZXh0ID0gYXV0b1dyYXBUZXh0O1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIkRFRkFVTFRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZSA/IGRlZmF1bHRTdHlsZSA6IGRlZmF1bHRTdHlsZSA9IG5ldyBTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFN0ZE11bHRpbGluZVRleHRCYXNlU3R5bGU7XG4gICAgICAgICAgfShTdGRUZXh0QmFzZVN0eWxlXzEuU3RkVGV4dEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICBleHBvcnRzLlN0ZE11bHRpbGluZVRleHRCYXNlU3R5bGUgPSBTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlci9zdHlsZS9TdGRUZXh0QmFzZVN0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL3N0eWxlL1N0ZFRleHRCYXNlU3R5bGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJTdHlsZVN0ZFRleHRCYXNlU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlN0ZFRleHRCYXNlU3R5bGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgU3RkQmFzZVN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL1N0ZEJhc2VTdHlsZSAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvU3RkQmFzZVN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGRlZmF1bHRTdHlsZTtcblxuICAgICAgICAgIHZhciBTdGRUZXh0QmFzZVN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RkQmFzZVN0eWxlXzEkU3RkQmE1KSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoU3RkVGV4dEJhc2VTdHlsZSwgX1N0ZEJhc2VTdHlsZV8xJFN0ZEJhNSk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI2OSA9IF9jcmVhdGVTdXBlcihTdGRUZXh0QmFzZVN0eWxlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gU3RkVGV4dEJhc2VTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzOTk7XG5cbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RkVGV4dEJhc2VTdHlsZSk7XG5cbiAgICAgICAgICAgICAgX3RoaXM5OSA9IF9zdXBlcjY5LmNhbGwodGhpcywgc3R5bGUpO1xuICAgICAgICAgICAgICBfdGhpczk5Ll9jb2xvciA9IHN0eWxlLmNvbG9yO1xuICAgICAgICAgICAgICBfdGhpczk5Ll9mb250ID0gc3R5bGUuZm9udDtcbiAgICAgICAgICAgICAgX3RoaXM5OS5fcGFkZGluZyA9IHN0eWxlLnBhZGRpbmc7XG4gICAgICAgICAgICAgIF90aGlzOTkuX3RleHRPdmVyZmxvdyA9IHN0eWxlLnRleHRPdmVyZmxvdyB8fCBcImVsbGlwc2lzXCI7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczk5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoU3RkVGV4dEJhc2VTdHlsZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb2xvcjtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9DaGFuZ2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmb250XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mb250O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChmb250KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZm9udCA9IGZvbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5kb0NoYW5nZVN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInBhZGRpbmdcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhZGRpbmc7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHBhZGRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYWRkaW5nID0gcGFkZGluZztcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidGV4dE92ZXJmbG93XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZXh0T3ZlcmZsb3c7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHRleHRPdmVyZmxvdykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RleHRPdmVyZmxvdyA9IHRleHRPdmVyZmxvdztcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RkVGV4dEJhc2VTdHlsZSh0aGlzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJERUZBVUxUXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0U3R5bGUgPyBkZWZhdWx0U3R5bGUgOiBkZWZhdWx0U3R5bGUgPSBuZXcgU3RkVGV4dEJhc2VTdHlsZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBTdGRUZXh0QmFzZVN0eWxlO1xuICAgICAgICAgIH0oU3RkQmFzZVN0eWxlXzEuU3RkQmFzZVN0eWxlKTtcblxuICAgICAgICAgIGV4cG9ydHMuU3RkVGV4dEJhc2VTdHlsZSA9IFN0ZFRleHRCYXNlU3R5bGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaGVhZGVyL3N0eWxlL1N0eWxlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2hlYWRlci9zdHlsZS9TdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJTdHlsZVN0eWxlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5TdHlsZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBTdGRNdWx0aWxpbmVUZXh0QmFzZVN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL1N0ZE11bHRpbGluZVRleHRCYXNlU3R5bGUgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3N0eWxlL1N0ZE11bHRpbGluZVRleHRCYXNlU3R5bGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgZGVmYXVsdFN0eWxlO1xuXG4gICAgICAgICAgdmFyIFN0eWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RkTXVsdGlsaW5lVGV4dEJhc2UzKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoU3R5bGUsIF9TdGRNdWx0aWxpbmVUZXh0QmFzZTMpO1xuXG4gICAgICAgICAgICB2YXIgX3N1cGVyNzAgPSBfY3JlYXRlU3VwZXIoU3R5bGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBTdHlsZSgpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzMTAwO1xuXG4gICAgICAgICAgICAgIHZhciBzdHlsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0eWxlKTtcblxuICAgICAgICAgICAgICBfdGhpczEwMCA9IF9zdXBlcjcwLmNhbGwodGhpcywgc3R5bGUpO1xuICAgICAgICAgICAgICBfdGhpczEwMC5fbXVsdGlsaW5lID0gc3R5bGUubXVsdGlsaW5lO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhTdHlsZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIm11bHRpbGluZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gISF0aGlzLl9tdWx0aWxpbmU7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KG11bHRpbGluZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX211bHRpbGluZSA9IG11bHRpbGluZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRvQ2hhbmdlU3R5bGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3R5bGUodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiREVGQVVMVFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFN0eWxlID8gZGVmYXVsdFN0eWxlIDogZGVmYXVsdFN0eWxlID0gbmV3IFN0eWxlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFN0eWxlO1xuICAgICAgICAgIH0oU3RkTXVsdGlsaW5lVGV4dEJhc2VTdHlsZV8xLlN0ZE11bHRpbGluZVRleHRCYXNlU3R5bGUpO1xuXG4gICAgICAgICAgZXhwb3J0cy5TdHlsZSA9IFN0eWxlO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlci90eXBlLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL3R5cGUuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJUeXBlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5vZkNlbGwgPSBleHBvcnRzLm9mID0gZXhwb3J0cy5NdWx0aWxpbmVUZXh0SGVhZGVyID0gZXhwb3J0cy5DaGVja0hlYWRlciA9IGV4cG9ydHMuU29ydEhlYWRlciA9IGV4cG9ydHMuSGVhZGVyID0gZXhwb3J0cy5CYXNlSGVhZGVyID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEJhc2VIZWFkZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdHlwZS9CYXNlSGVhZGVyICovXG4gICAgICAgICAgXCIuL2hlYWRlci90eXBlL0Jhc2VIZWFkZXIuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJCYXNlSGVhZGVyXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEJhc2VIZWFkZXJfMS5CYXNlSGVhZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIENoZWNrSGVhZGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3R5cGUvQ2hlY2tIZWFkZXIgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3R5cGUvQ2hlY2tIZWFkZXIuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJDaGVja0hlYWRlclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBDaGVja0hlYWRlcl8xLkNoZWNrSGVhZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIEhlYWRlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90eXBlL0hlYWRlciAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvdHlwZS9IZWFkZXIuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJIZWFkZXJcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gSGVhZGVyXzEuSGVhZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIE11bHRpbGluZVRleHRIZWFkZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdHlwZS9NdWx0aWxpbmVUZXh0SGVhZGVyICovXG4gICAgICAgICAgXCIuL2hlYWRlci90eXBlL011bHRpbGluZVRleHRIZWFkZXIuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJNdWx0aWxpbmVUZXh0SGVhZGVyXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE11bHRpbGluZVRleHRIZWFkZXJfMS5NdWx0aWxpbmVUZXh0SGVhZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIFNvcnRIZWFkZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdHlwZS9Tb3J0SGVhZGVyICovXG4gICAgICAgICAgXCIuL2hlYWRlci90eXBlL1NvcnRIZWFkZXIuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTb3J0SGVhZGVyXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFNvcnRIZWFkZXJfMS5Tb3J0SGVhZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHZhciBUWVBFUyA9IHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICBERUZBVUxUOiBuZXcgSGVhZGVyXzEuSGVhZGVyKCksXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgU09SVDogbmV3IFNvcnRIZWFkZXJfMS5Tb3J0SGVhZGVyKCksXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgQ0hFQ0s6IG5ldyBDaGVja0hlYWRlcl8xLkNoZWNrSGVhZGVyKCksXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgTVVMVElMSU5FVEVYVDogbmV3IE11bHRpbGluZVRleHRIZWFkZXJfMS5NdWx0aWxpbmVUZXh0SGVhZGVyKClcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgZnVuY3Rpb24gb2YoaGVhZGVyVHlwZSkge1xuICAgICAgICAgICAgaWYgKCFoZWFkZXJUeXBlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBUWVBFUy5ERUZBVUxUO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaGVhZGVyVHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICB2YXIga2V5ID0gaGVhZGVyVHlwZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICByZXR1cm4gVFlQRVNba2V5XSB8fCBvZihudWxsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBoZWFkZXJUeXBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMub2YgPSBvZjtcblxuICAgICAgICAgIGZ1bmN0aW9uIG9mQ2VsbChoZWFkZXJDZWxsKSB7XG4gICAgICAgICAgICBpZiAoaGVhZGVyQ2VsbC5zb3J0KSB7XG4gICAgICAgICAgICAgIHJldHVybiBUWVBFUy5TT1JUO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb2YoaGVhZGVyQ2VsbC5oZWFkZXJUeXBlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm9mQ2VsbCA9IG9mQ2VsbDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvdHlwZS9CYXNlSGVhZGVyLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvdHlwZS9CYXNlSGVhZGVyLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJUeXBlQmFzZUhlYWRlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQmFzZUhlYWRlciA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBzdHlsZUNvbnRlbnRzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3N0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgQmFzZVN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9zdHlsZS9CYXNlU3R5bGUgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3N0eWxlL0Jhc2VTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBCYXNlSGVhZGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIEJhc2VIZWFkZXIoKSB7XG4gICAgICAgICAgICAgIHZhciBfb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VIZWFkZXIpO1xuXG4gICAgICAgICAgICAgIHRoaXMub25EcmF3Q2VsbCA9IHRoaXMub25EcmF3Q2VsbC5iaW5kKHRoaXMpOyAvL+OCueOCs+ODvOODl+OCkuWbuuWumuOBleOBm+OCi1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQmFzZUhlYWRlciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcIlN0eWxlQ2xhc3NcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEJhc2VTdHlsZV8xLkJhc2VTdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25EcmF3Q2VsbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25EcmF3Q2VsbChjZWxsVmFsdWUsIGluZm8sIGNvbnRleHQsIGdyaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBpbmZvLnN0eWxlLFxuICAgICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2UgPSBpbmZvLmRyYXdDZWxsQmFzZTtcbiAgICAgICAgICAgICAgICB2YXIgaGVscGVyID0gZ3JpZC5nZXRHcmlkQ2FudmFzSGVscGVyKCk7XG4gICAgICAgICAgICAgICAgZHJhd0NlbGxCYXNlKCk7IC8v5paH5a2X5o+P55S7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdJbnRlcm5hbCh0aGlzLmNvbnZlcnRJbnRlcm5hbChjZWxsVmFsdWUpLCBjb250ZXh0LCBzdHlsZUNvbnRlbnRzLm9mKHN0eWxlLCB0aGlzLlN0eWxlQ2xhc3MpLCBoZWxwZXIsIGdyaWQsIGluZm8pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb252ZXJ0SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnZlcnRJbnRlcm5hbCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSgpO1xuICAgICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9yZXN0cmljdC10ZW1wbGF0ZS1leHByZXNzaW9uc1xuXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCA/IFwiXCIuY29uY2F0KHZhbHVlKSA6IFwiXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImJpbmRHcmlkRXZlbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJpbmRHcmlkRXZlbnQoX2dyaWQsIF9jZWxsSWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENvcHlDZWxsVmFsdWVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvcHlDZWxsVmFsdWUodmFsdWUsIF9ncmlkLCBfY2VsbCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsID8gdmFsdWUgOiBcIlwiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCYXNlSGVhZGVyO1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuQmFzZUhlYWRlciA9IEJhc2VIZWFkZXI7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaGVhZGVyL3R5cGUvQ2hlY2tIZWFkZXIuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvdHlwZS9DaGVja0hlYWRlci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGhlYWRlclR5cGVDaGVja0hlYWRlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuQ2hlY2tIZWFkZXIgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgaW5saW5lVXRpbHMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vZWxlbWVudC9pbmxpbmVzICovXG4gICAgICAgICAgXCIuL2VsZW1lbnQvaW5saW5lcy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgdXRpbHMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vY29sdW1ucy90eXBlL2NvbHVtblV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9jb2x1bW5VdGlscy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgQmFzZUhlYWRlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlSGVhZGVyICovXG4gICAgICAgICAgXCIuL2hlYWRlci90eXBlL0Jhc2VIZWFkZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgQ2hlY2tIZWFkZXJTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vc3R5bGUvQ2hlY2tIZWFkZXJTdHlsZSAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvQ2hlY2tIZWFkZXJTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBzeW1ib2xNYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9pbnRlcm5hbC9zeW1ib2xNYW5hZ2VyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIENIRUNLX0hFQURFUl9TVEFURV9JRCA9ICgwLCBzeW1ib2xNYW5hZ2VyXzEuZ2V0Q2hlY2tIZWFkZXJTdGF0ZUlkKSgpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0U3RhdGUoZ3JpZCkge1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JpZFtDSEVDS19IRUFERVJfU1RBVEVfSURdO1xuXG4gICAgICAgICAgICBpZiAoIXN0YXRlKSB7XG4gICAgICAgICAgICAgIHN0YXRlID0ge1xuICAgICAgICAgICAgICAgIGVsYXBzZWQ6IHt9LFxuICAgICAgICAgICAgICAgIGJsb2NrOiB7fVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB1dGlsc18xLm9iai5zZXRSZWFkb25seShncmlkLCBDSEVDS19IRUFERVJfU1RBVEVfSUQsIHN0YXRlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBDaGVja0hlYWRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VIZWFkZXJfMSRCYXNlSGVhKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoQ2hlY2tIZWFkZXIsIF9CYXNlSGVhZGVyXzEkQmFzZUhlYSk7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI3MSA9IF9jcmVhdGVTdXBlcihDaGVja0hlYWRlcik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIENoZWNrSGVhZGVyKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2hlY2tIZWFkZXIpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI3MS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoQ2hlY2tIZWFkZXIsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJTdHlsZUNsYXNzXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDaGVja0hlYWRlclN0eWxlXzEuQ2hlY2tIZWFkZXJTdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2xvbmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hlY2tIZWFkZXIodGhpcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRyYXdJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0ludGVybmFsKHZhbHVlLCBjb250ZXh0LCBzdHlsZSwgaGVscGVyLCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICBncmlkLCBfcmVmNzQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZHJhd0NlbGxCYXNlID0gX3JlZjc0LmRyYXdDZWxsQmFzZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0SWNvbiA9IF9yZWY3NC5nZXRJY29uO1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0QWxpZ24gPSBzdHlsZS50ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZSA9IHN0eWxlLnRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSBzdHlsZS5ib3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yID0gc3R5bGUuY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvciA9IHN0eWxlLnVuY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yID0gc3R5bGUuYmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZyA9IHN0eWxlLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gc3R5bGUuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQgPSBzdHlsZS5mb250LFxuICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3cgPSBzdHlsZS50ZXh0T3ZlcmZsb3c7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmdDb2xvcikge1xuICAgICAgICAgICAgICAgICAgZHJhd0NlbGxCYXNlKHtcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogYmdDb2xvclxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbnRleHQuY29sLFxuICAgICAgICAgICAgICAgICAgICByb3cgPSBjb250ZXh0LnJvdztcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBncmlkLmdldENlbGxSYW5nZShjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgdmFyIGNlbGxLZXkgPSBcIlwiLmNvbmNhdChyYW5nZS5zdGFydC5jb2wsIFwiOlwiKS5jb25jYXQocmFuZ2Uuc3RhcnQucm93KTtcblxuICAgICAgICAgICAgICAgIHZhciBfZ2V0U3RhdGUgPSBnZXRTdGF0ZShncmlkKSxcbiAgICAgICAgICAgICAgICAgICAgZWxhcHNlZCA9IF9nZXRTdGF0ZS5lbGFwc2VkW2NlbGxLZXldO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSBncmlkLmdldEhlYWRlclZhbHVlKHJhbmdlLnN0YXJ0LmNvbCwgcmFuZ2Uuc3RhcnQucm93KTtcbiAgICAgICAgICAgICAgICB2YXIgb3B0ID0ge1xuICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiB0ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmU6IHRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBib3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICAgIGNoZWNrQmdDb2xvcjogY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgdW5jaGVja0JnQ29sb3I6IHVuY2hlY2tCZ0NvbG9yXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmIChlbGFwc2VkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIG9wdC5hbmltRWxhcHNlZFRpbWUgPSBlbGFwc2VkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbmxpbmVDaGVjayA9IGhlbHBlci5idWlsZENoZWNrQm94SW5saW5lKCEhY2hlY2tlZCwgY29udGV4dCwgb3B0KTtcbiAgICAgICAgICAgICAgICB1dGlscy5sb2FkSWNvbnMoZ2V0SWNvbigpLCBjb250ZXh0LCBoZWxwZXIsIGZ1bmN0aW9uIChpY29ucywgY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRzID0gW2lubGluZUNoZWNrXTtcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnRzID0gY29udGVudHMuY29uY2F0KGlubGluZVV0aWxzLmJ1aWxkSW5saW5lcyhpY29ucywgdmFsdWUgIT0gbnVsbCA/IFN0cmluZyh2YWx1ZSkgOiBcIlwiKSk7XG4gICAgICAgICAgICAgICAgICBoZWxwZXIudGV4dChjb250ZW50cywgY29udGV4dCwge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgZm9udDogZm9udCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogcGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3dcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBDaGVja0hlYWRlcjtcbiAgICAgICAgICB9KEJhc2VIZWFkZXJfMS5CYXNlSGVhZGVyKTtcblxuICAgICAgICAgIGV4cG9ydHMuQ2hlY2tIZWFkZXIgPSBDaGVja0hlYWRlcjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvdHlwZS9IZWFkZXIuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL3R5cGUvSGVhZGVyLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGhlYWRlclR5cGVIZWFkZXJKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkhlYWRlciA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlscyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9jb2x1bW5zL3R5cGUvY29sdW1uVXRpbHMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL2NvbHVtblV0aWxzLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBCYXNlSGVhZGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VIZWFkZXIgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3R5cGUvQmFzZUhlYWRlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBTdHlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vc3R5bGUvU3R5bGUgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3N0eWxlL1N0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIEhlYWRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VIZWFkZXJfMSRCYXNlSGVhMikge1xuICAgICAgICAgICAgX2luaGVyaXRzKEhlYWRlciwgX0Jhc2VIZWFkZXJfMSRCYXNlSGVhMik7XG5cbiAgICAgICAgICAgIHZhciBfc3VwZXI3MiA9IF9jcmVhdGVTdXBlcihIZWFkZXIpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBIZWFkZXIoKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBIZWFkZXIpO1xuXG4gICAgICAgICAgICAgIHJldHVybiBfc3VwZXI3Mi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoSGVhZGVyLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiU3R5bGVDbGFzc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gU3R5bGVfMS5TdHlsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZHJhd0ludGVybmFsXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3SW50ZXJuYWwodmFsdWUsIGNvbnRleHQsIHN0eWxlLCBoZWxwZXIsIF9ncmlkLCBfcmVmNzUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZHJhd0NlbGxCYXNlID0gX3JlZjc1LmRyYXdDZWxsQmFzZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0SWNvbiA9IF9yZWY3NS5nZXRJY29uO1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0QWxpZ24gPSBzdHlsZS50ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZSA9IHN0eWxlLnRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBzdHlsZS5jb2xvcixcbiAgICAgICAgICAgICAgICAgICAgZm9udCA9IHN0eWxlLmZvbnQsXG4gICAgICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBzdHlsZS5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nID0gc3R5bGUucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93ID0gc3R5bGUudGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0ID0gc3R5bGUubGluZUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgYXV0b1dyYXBUZXh0ID0gc3R5bGUuYXV0b1dyYXBUZXh0LFxuICAgICAgICAgICAgICAgICAgICBsaW5lQ2xhbXAgPSBzdHlsZS5saW5lQ2xhbXAsXG4gICAgICAgICAgICAgICAgICAgIG11bHRpbGluZSA9IHN0eWxlLm11bHRpbGluZTtcblxuICAgICAgICAgICAgICAgIGlmIChiZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2Uoe1xuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdGV4dFZhbHVlID0gdmFsdWUgIT0gbnVsbCA/IFN0cmluZyh2YWx1ZSkgOiBcIlwiO1xuICAgICAgICAgICAgICAgIHV0aWxzLmxvYWRJY29ucyhnZXRJY29uKCksIGNvbnRleHQsIGhlbHBlciwgZnVuY3Rpb24gKGljb25zLCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICBpZiAobXVsdGlsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtdWx0aWxpbmVzID0gdGV4dFZhbHVlLnJlcGxhY2UoL1xccj9cXG4vZywgXCJcXG5cIikucmVwbGFjZSgvXFxyL2csIFwiXFxuXCIpLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgICAgICAgICAgICBoZWxwZXIubXVsdGlsaW5lVGV4dChtdWx0aWxpbmVzLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiB0ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogcGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0OiBsaW5lSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgIGF1dG9XcmFwVGV4dDogYXV0b1dyYXBUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgIGxpbmVDbGFtcDogbGluZUNsYW1wLFxuICAgICAgICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdzogdGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgICAgICAgIGljb25zOiBpY29uc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci50ZXh0KHRleHRWYWx1ZSwgY29udGV4dCwge1xuICAgICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogdGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICAgIHRleHRCYXNlbGluZTogdGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICBmb250OiBmb250LFxuICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgICAgaWNvbnM6IGljb25zXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBIZWFkZXI7XG4gICAgICAgICAgfShCYXNlSGVhZGVyXzEuQmFzZUhlYWRlcik7XG5cbiAgICAgICAgICBleHBvcnRzLkhlYWRlciA9IEhlYWRlcjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9oZWFkZXIvdHlwZS9NdWx0aWxpbmVUZXh0SGVhZGVyLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9oZWFkZXIvdHlwZS9NdWx0aWxpbmVUZXh0SGVhZGVyLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBoZWFkZXJUeXBlTXVsdGlsaW5lVGV4dEhlYWRlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTXVsdGlsaW5lVGV4dEhlYWRlciA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlscyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi9jb2x1bW5zL3R5cGUvY29sdW1uVXRpbHMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy90eXBlL2NvbHVtblV0aWxzLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBCYXNlSGVhZGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0Jhc2VIZWFkZXIgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3R5cGUvQmFzZUhlYWRlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBNdWx0aWxpbmVUZXh0SGVhZGVyU3R5bGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL3N0eWxlL011bHRpbGluZVRleHRIZWFkZXJTdHlsZSAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvc3R5bGUvTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIE11bHRpbGluZVRleHRIZWFkZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlSGVhZGVyXzEkQmFzZUhlYTMpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhNdWx0aWxpbmVUZXh0SGVhZGVyLCBfQmFzZUhlYWRlcl8xJEJhc2VIZWEzKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjczID0gX2NyZWF0ZVN1cGVyKE11bHRpbGluZVRleHRIZWFkZXIpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBNdWx0aWxpbmVUZXh0SGVhZGVyKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTXVsdGlsaW5lVGV4dEhlYWRlcik7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjczLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhNdWx0aWxpbmVUZXh0SGVhZGVyLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiU3R5bGVDbGFzc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlXzEuTXVsdGlsaW5lVGV4dEhlYWRlclN0eWxlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9uZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNdWx0aWxpbmVUZXh0SGVhZGVyKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgX2dyaWQsIF9yZWY3Nikge1xuICAgICAgICAgICAgICAgIHZhciBkcmF3Q2VsbEJhc2UgPSBfcmVmNzYuZHJhd0NlbGxCYXNlLFxuICAgICAgICAgICAgICAgICAgICBnZXRJY29uID0gX3JlZjc2LmdldEljb247XG4gICAgICAgICAgICAgICAgdmFyIHRleHRBbGlnbiA9IHN0eWxlLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lID0gc3R5bGUudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHN0eWxlLmNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBmb250ID0gc3R5bGUuZm9udCxcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvciA9IHN0eWxlLmJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBzdHlsZS5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0ID0gc3R5bGUubGluZUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgYXV0b1dyYXBUZXh0ID0gc3R5bGUuYXV0b1dyYXBUZXh0LFxuICAgICAgICAgICAgICAgICAgICBsaW5lQ2xhbXAgPSBzdHlsZS5saW5lQ2xhbXAsXG4gICAgICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdyA9IHN0eWxlLnRleHRPdmVyZmxvdztcblxuICAgICAgICAgICAgICAgIGlmIChiZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2Uoe1xuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdGV4dFZhbHVlID0gdmFsdWUgIT0gbnVsbCA/IFN0cmluZyh2YWx1ZSkgOiBcIlwiO1xuICAgICAgICAgICAgICAgIHZhciBtdWx0aWxpbmVzID0gdGV4dFZhbHVlLnJlcGxhY2UoL1xccj9cXG4vZywgXCJcXG5cIikucmVwbGFjZSgvXFxyL2csIFwiXFxuXCIpLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgICAgICAgIGhlbHBlci50ZXN0Rm9udExvYWQoZm9udCwgdGV4dFZhbHVlLCBjb250ZXh0KTtcbiAgICAgICAgICAgICAgICB1dGlscy5sb2FkSWNvbnMoZ2V0SWNvbigpLCBjb250ZXh0LCBoZWxwZXIsIGZ1bmN0aW9uIChpY29ucywgY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgaGVscGVyLm11bHRpbGluZVRleHQobXVsdGlsaW5lcywgY29udGV4dCwge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgZm9udDogZm9udCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogcGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodDogbGluZUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgYXV0b1dyYXBUZXh0OiBhdXRvV3JhcFRleHQsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVDbGFtcDogbGluZUNsYW1wLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3c6IHRleHRPdmVyZmxvdyxcbiAgICAgICAgICAgICAgICAgICAgaWNvbnM6IGljb25zXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTXVsdGlsaW5lVGV4dEhlYWRlcjtcbiAgICAgICAgICB9KEJhc2VIZWFkZXJfMS5CYXNlSGVhZGVyKTtcblxuICAgICAgICAgIGV4cG9ydHMuTXVsdGlsaW5lVGV4dEhlYWRlciA9IE11bHRpbGluZVRleHRIZWFkZXI7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaGVhZGVyL3R5cGUvU29ydEhlYWRlci5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaGVhZGVyL3R5cGUvU29ydEhlYWRlci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaGVhZGVyVHlwZVNvcnRIZWFkZXJKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlNvcnRIZWFkZXIgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vY29sdW1ucy90eXBlL2NvbHVtblV0aWxzICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMvdHlwZS9jb2x1bW5VdGlscy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgQmFzZUhlYWRlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlSGVhZGVyICovXG4gICAgICAgICAgXCIuL2hlYWRlci90eXBlL0Jhc2VIZWFkZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgU29ydEhlYWRlclN0eWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9zdHlsZS9Tb3J0SGVhZGVyU3R5bGUgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3N0eWxlL1NvcnRIZWFkZXJTdHlsZS5qc1wiKTtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgY2FudmFzZXNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL2NhbnZhc2VzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL2NhbnZhc2VzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFNvcnRIZWFkZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlSGVhZGVyXzEkQmFzZUhlYTQpIHtcbiAgICAgICAgICAgIF9pbmhlcml0cyhTb3J0SGVhZGVyLCBfQmFzZUhlYWRlcl8xJEJhc2VIZWE0KTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjc0ID0gX2NyZWF0ZVN1cGVyKFNvcnRIZWFkZXIpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBTb3J0SGVhZGVyKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU29ydEhlYWRlcik7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjc0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhTb3J0SGVhZGVyLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiU3R5bGVDbGFzc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gU29ydEhlYWRlclN0eWxlXzEuU29ydEhlYWRlclN0eWxlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkcmF3SW50ZXJuYWxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgc3R5bGUsIGhlbHBlciwgZ3JpZCwgX3JlZjc3KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyYXdDZWxsQmFzZSA9IF9yZWY3Ny5kcmF3Q2VsbEJhc2UsXG4gICAgICAgICAgICAgICAgICAgIGdldEljb24gPSBfcmVmNzcuZ2V0SWNvbjtcbiAgICAgICAgICAgICAgICB2YXIgdGV4dEFsaWduID0gc3R5bGUudGV4dEFsaWduLFxuICAgICAgICAgICAgICAgICAgICBfc3R5bGUkdGV4dEJhc2VsaW5lID0gc3R5bGUudGV4dEJhc2VsaW5lLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmUgPSBfc3R5bGUkdGV4dEJhc2VsaW5lID09PSB2b2lkIDAgPyBcIm1pZGRsZVwiIDogX3N0eWxlJHRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBzdHlsZS5jb2xvcixcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvciA9IHN0eWxlLmJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGZvbnQgPSBzdHlsZS5mb250LFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nID0gc3R5bGUucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93ID0gc3R5bGUudGV4dE92ZXJmbG93LFxuICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0ID0gc3R5bGUubGluZUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgYXV0b1dyYXBUZXh0ID0gc3R5bGUuYXV0b1dyYXBUZXh0LFxuICAgICAgICAgICAgICAgICAgICBsaW5lQ2xhbXAgPSBzdHlsZS5saW5lQ2xhbXAsXG4gICAgICAgICAgICAgICAgICAgIHNvcnRBcnJvd0NvbG9yID0gc3R5bGUuc29ydEFycm93Q29sb3IsXG4gICAgICAgICAgICAgICAgICAgIG11bHRpbGluZSA9IHN0eWxlLm11bHRpbGluZTtcblxuICAgICAgICAgICAgICAgIGlmIChiZ0NvbG9yKSB7XG4gICAgICAgICAgICAgICAgICBkcmF3Q2VsbEJhc2Uoe1xuICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBiZ0NvbG9yXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdGV4dFZhbHVlID0gdmFsdWUgIT0gbnVsbCA/IFN0cmluZyh2YWx1ZSkgOiBcIlwiO1xuICAgICAgICAgICAgICAgIGhlbHBlci50ZXN0Rm9udExvYWQoZm9udCwgdGV4dFZhbHVlLCBjb250ZXh0KTtcbiAgICAgICAgICAgICAgICB1dGlscy5sb2FkSWNvbnMoZ2V0SWNvbigpLCBjb250ZXh0LCBoZWxwZXIsIGZ1bmN0aW9uIChpY29ucywgY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JpZC5zb3J0U3RhdGU7XG4gICAgICAgICAgICAgICAgICB2YXIgb3JkZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICB2YXIgY29sID0gY29udGV4dC5jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgcm93ID0gY29udGV4dC5yb3c7XG4gICAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBncmlkLmdldENlbGxSYW5nZShjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5jZWxsSW5SYW5nZSkocmFuZ2UsIHN0YXRlLmNvbCwgc3RhdGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICBvcmRlciA9IHN0YXRlLm9yZGVyO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgY3R4ID0gY29udGV4dC5nZXRDb250ZXh0KCk7XG4gICAgICAgICAgICAgICAgICB2YXIgYXJyb3dTaXplID0gKDAsIGNhbnZhc2VzXzEuZ2V0Rm9udFNpemUpKGN0eCwgZm9udCkud2lkdGggKiAxLjI7XG4gICAgICAgICAgICAgICAgICB2YXIgdHJhaWxpbmdJY29uID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBvcmRlciAhPSBudWxsID8gb3JkZXIgPT09IFwiYXNjXCIgPyBcImFycm93X2Rvd253YXJkXCIgOiBcImFycm93X3Vwd2FyZFwiIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogYXJyb3dTaXplLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogaGVscGVyLmdldENvbG9yKHNvcnRBcnJvd0NvbG9yIHx8IGhlbHBlci50aGVtZS5oZWFkZXIuc29ydEFycm93Q29sb3IsIGNvbCwgcm93LCBjdHgpIHx8IFwicmdiYSgwLCAwLCAwLCAwLjM4KVwiXG4gICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICBpZiAobXVsdGlsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5lcyA9IHRleHRWYWx1ZS5yZXBsYWNlKC9cXHI/XFxuL2csIFwiXFxuXCIpLnJlcGxhY2UoL1xcci9nLCBcIlxcblwiKS5zcGxpdChcIlxcblwiKTtcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLm11bHRpbGluZVRleHQobGluZXMsIGNvbnRleHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IHRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0QmFzZWxpbmU6IHRleHRCYXNlbGluZSxcbiAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogY29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgZm9udDogZm9udCxcbiAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6IGxpbmVIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgYXV0b1dyYXBUZXh0OiBhdXRvV3JhcFRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgbGluZUNsYW1wOiBsaW5lQ2xhbXAsXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dE92ZXJmbG93OiB0ZXh0T3ZlcmZsb3csXG4gICAgICAgICAgICAgICAgICAgICAgaWNvbnM6IGljb25zLFxuICAgICAgICAgICAgICAgICAgICAgIHRyYWlsaW5nSWNvbjogdHJhaWxpbmdJY29uXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLnRleHQodGV4dFZhbHVlLCBjb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiB0ZXh0QWxpZ24sXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dEJhc2VsaW5lOiB0ZXh0QmFzZWxpbmUsXG4gICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogcGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0T3ZlcmZsb3c6IHRleHRPdmVyZmxvdyxcbiAgICAgICAgICAgICAgICAgICAgICBpY29uczogaWNvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgdHJhaWxpbmdJY29uOiB0cmFpbGluZ0ljb25cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFNvcnRIZWFkZXI7XG4gICAgICAgICAgfShCYXNlSGVhZGVyXzEuQmFzZUhlYWRlcik7XG5cbiAgICAgICAgICBleHBvcnRzLlNvcnRIZWFkZXIgPSBTb3J0SGVhZGVyO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2hlYWRlcnMuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2hlYWRlcnMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGhlYWRlcnNKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLnN0eWxlID0gZXhwb3J0cy50eXBlID0gZXhwb3J0cy5hY3Rpb24gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgYWN0aW9uID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaGVhZGVyL2FjdGlvbiAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvYWN0aW9uLmpzXCIpKTtcblxuICAgICAgICAgIGV4cG9ydHMuYWN0aW9uID0gYWN0aW9uO1xuXG4gICAgICAgICAgdmFyIHN0eWxlID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaGVhZGVyL3N0eWxlICovXG4gICAgICAgICAgXCIuL2hlYWRlci9zdHlsZS5qc1wiKSk7XG5cbiAgICAgICAgICBleHBvcnRzLnN0eWxlID0gc3R5bGU7XG5cbiAgICAgICAgICB2YXIgdHlwZSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2hlYWRlci90eXBlICovXG4gICAgICAgICAgXCIuL2hlYWRlci90eXBlLmpzXCIpKTtcblxuICAgICAgICAgIGV4cG9ydHMudHlwZSA9IHR5cGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaWNvbnMuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9pY29ucy5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGljb25zSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICAgICAgLyplc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UqL1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuZ2V0ID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGljb25zXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3BsdWdpbnMvaWNvbnMgKi9cbiAgICAgICAgICBcIi4vcGx1Z2lucy9pY29ucy5qc1wiKTtcblxuICAgICAgICAgIHZhciBidWlsdGlucyA9IHtcbiAgICAgICAgICAgIGdldCBhcnJvd191cHdhcmQoKSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiByZXF1aXJlKFwiY2hlZXRhaC1ncmlkLWljb24tc3ZnLWxvYWRlciFtYXRlcmlhbC1kZXNpZ24taWNvbnMvbmF2aWdhdGlvbi9zdmcvcHJvZHVjdGlvbi9pY19hcnJvd191cHdhcmRfNDhweC5zdmdcIik7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZDogXCJNOCAyNGwyLjgzIDIuODNMMjIgMTUuNjZWNDBoNFYxNS42NmwxMS4xNyAxMS4xN0w0MCAyNCAyNCA4IDggMjR6XCIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDQ4LFxuICAgICAgICAgICAgICAgIGhlaWdodDogNDhcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldCBhcnJvd19kb3dud2FyZCgpIHtcbiAgICAgICAgICAgICAgLy8gcmV0dXJuIHJlcXVpcmUoXCJjaGVldGFoLWdyaWQtaWNvbi1zdmctbG9hZGVyIW1hdGVyaWFsLWRlc2lnbi1pY29ucy9uYXZpZ2F0aW9uL3N2Zy9wcm9kdWN0aW9uL2ljX2Fycm93X2Rvd253YXJkXzQ4cHguc3ZnXCIpO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGQ6IFwiTTQwIDI0bC0yLjgyLTIuODJMMjYgMzIuMzRWOGgtNHYyNC4zNEwxMC44NCAyMS4xNiA4IDI0bDE2IDE2IDE2LTE2elwiLFxuICAgICAgICAgICAgICAgIHdpZHRoOiA0OCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQ4XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBnZXQgZWRpdCgpIHtcbiAgICAgICAgICAgICAgLy8gcmV0dXJuIHJlcXVpcmUoXCJjaGVldGFoLWdyaWQtaWNvbi1zdmctbG9hZGVyIW1hdGVyaWFsLWRlc2lnbi1pY29ucy9pbWFnZS9zdmcvcHJvZHVjdGlvbi9pY19lZGl0XzQ4cHguc3ZnXCIpO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGQ6IFwiTTYgMzQuNVY0Mmg3LjVsMjIuMTMtMjIuMTMtNy41LTcuNUw2IDM0LjV6bTM1LjQxLTIwLjQxYy43OC0uNzguNzgtMi4wNSAwLTIuODNsLTQuNjctNC42N2MtLjc4LS43OC0yLjA1LS43OC0yLjgzIDBsLTMuNjYgMy42NiA3LjUgNy41IDMuNjYtMy42NnpcIixcbiAgICAgICAgICAgICAgICB3aWR0aDogNDgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA0OFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZ2V0IGFkZCgpIHtcbiAgICAgICAgICAgICAgLy8gcmV0dXJuIHJlcXVpcmUoXCJjaGVldGFoLWdyaWQtaWNvbi1zdmctbG9hZGVyIW1hdGVyaWFsLWRlc2lnbi1pY29ucy9jb250ZW50L3N2Zy9wcm9kdWN0aW9uL2ljX2FkZF80OHB4LnN2Z1wiKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkOiBcIk0zOCAyNkgyNnYxMmgtNFYyNkgxMHYtNGgxMlYxMGg0djEyaDEydjR6XCIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDQ4LFxuICAgICAgICAgICAgICAgIGhlaWdodDogNDhcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldCBzdGFyKCkge1xuICAgICAgICAgICAgICAvLyByZXR1cm4gcmVxdWlyZShcImNoZWV0YWgtZ3JpZC1pY29uLXN2Zy1sb2FkZXIhbWF0ZXJpYWwtZGVzaWduLWljb25zL3RvZ2dsZS9zdmcvcHJvZHVjdGlvbi9pY19zdGFyXzI0cHguc3ZnXCIpO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGQ6IFwiTTEyIDE3LjI3TDE4LjE4IDIxbC0xLjY0LTcuMDNMMjIgOS4yNGwtNy4xOS0uNjFMMTIgMiA5LjE5IDguNjMgMiA5LjI0bDUuNDYgNC43M0w1LjgyIDIxelwiLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAyNCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDI0XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBnZXQgc3Rhcl9ib3JkZXIoKSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiByZXF1aXJlKFwiY2hlZXRhaC1ncmlkLWljb24tc3ZnLWxvYWRlciFtYXRlcmlhbC1kZXNpZ24taWNvbnMvdG9nZ2xlL3N2Zy9wcm9kdWN0aW9uL2ljX3N0YXJfYm9yZGVyXzI0cHguc3ZnXCIpO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGQ6IFwiTTIyIDkuMjRsLTcuMTktLjYyTDEyIDIgOS4xOSA4LjYzIDIgOS4yNGw1LjQ2IDQuNzNMNS44MiAyMSAxMiAxNy4yNyAxOC4xOCAyMWwtMS42My03LjAzTDIyIDkuMjR6TTEyIDE1LjRsLTMuNzYgMi4yNyAxLTQuMjgtMy4zMi0yLjg4IDQuMzgtLjM4TDEyIDYuMWwxLjcxIDQuMDQgNC4zOC4zOC0zLjMyIDIuODggMSA0LjI4TDEyIDE1LjR6XCIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDI0LFxuICAgICAgICAgICAgICAgIGhlaWdodDogMjRcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldCBzdGFyX2hhbGYoKSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiByZXF1aXJlKFwiY2hlZXRhaC1ncmlkLWljb24tc3ZnLWxvYWRlciFtYXRlcmlhbC1kZXNpZ24taWNvbnMvdG9nZ2xlL3N2Zy9wcm9kdWN0aW9uL2ljX3N0YXJfaGFsZl8yNHB4LnN2Z1wiKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkOiBcIk0yMiA5LjI0bC03LjE5LS42MkwxMiAyIDkuMTkgOC42MyAyIDkuMjRsNS40NiA0LjczTDUuODIgMjEgMTIgMTcuMjcgMTguMTggMjFsLTEuNjMtNy4wM0wyMiA5LjI0ek0xMiAxNS40VjYuMWwxLjcxIDQuMDQgNC4zOC4zOC0zLjMyIDIuODggMSA0LjI4TDEyIDE1LjR6XCIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDI0LFxuICAgICAgICAgICAgICAgIGhlaWdodDogMjRcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldCBrZXlib2FyZF9hcnJvd19kb3duKCkge1xuICAgICAgICAgICAgICAvLyByZXR1cm4gcmVxdWlyZShcImNoZWV0YWgtZ3JpZC1pY29uLXN2Zy1sb2FkZXIhbWF0ZXJpYWwtZGVzaWduLWljb25zL2hhcmR3YXJlL3N2Zy9wcm9kdWN0aW9uL2ljX2tleWJvYXJkX2Fycm93X2Rvd25fNDhweC5zdmdcIik7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZDogXCJNMTQuODMgMTYuNDJMMjQgMjUuNTlsOS4xNy05LjE3TDM2IDE5LjI1bC0xMiAxMi0xMi0xMnpcIixcbiAgICAgICAgICAgICAgICB3aWR0aDogNDgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA0OFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZ2V0IGtleWJvYXJkX2Fycm93X2xlZnQoKSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiByZXF1aXJlKFwiY2hlZXRhaC1ncmlkLWljb24tc3ZnLWxvYWRlciFtYXRlcmlhbC1kZXNpZ24taWNvbnMvaGFyZHdhcmUvc3ZnL3Byb2R1Y3Rpb24vaWNfa2V5Ym9hcmRfYXJyb3dfbGVmdF80OHB4LnN2Z1wiKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkOiBcIk0zMC44MyAzMi42N2wtOS4xNy05LjE3IDkuMTctOS4xN0wyOCAxMS41bC0xMiAxMiAxMiAxMnpcIixcbiAgICAgICAgICAgICAgICB3aWR0aDogNDgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA0OFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZ2V0IGtleWJvYXJkX2Fycm93X3JpZ2h0KCkge1xuICAgICAgICAgICAgICAvLyByZXR1cm4gcmVxdWlyZShcImNoZWV0YWgtZ3JpZC1pY29uLXN2Zy1sb2FkZXIhbWF0ZXJpYWwtZGVzaWduLWljb25zL2hhcmR3YXJlL3N2Zy9wcm9kdWN0aW9uL2ljX2tleWJvYXJkX2Fycm93X3JpZ2h0XzQ4cHguc3ZnXCIpO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGQ6IFwiTTE3LjE3IDMyLjkybDkuMTctOS4xNy05LjE3LTkuMTdMMjAgMTEuNzVsMTIgMTItMTIgMTJ6XCIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDQ4LFxuICAgICAgICAgICAgICAgIGhlaWdodDogNDhcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldCBrZXlib2FyZF9hcnJvd191cCgpIHtcbiAgICAgICAgICAgICAgLy8gcmV0dXJuIHJlcXVpcmUoXCJjaGVldGFoLWdyaWQtaWNvbi1zdmctbG9hZGVyIW1hdGVyaWFsLWRlc2lnbi1pY29ucy9oYXJkd2FyZS9zdmcvcHJvZHVjdGlvbi9pY19rZXlib2FyZF9hcnJvd191cF80OHB4LnN2Z1wiKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkOiBcIk0xNC44MyAzMC44M0wyNCAyMS42Nmw5LjE3IDkuMTdMMzYgMjggMjQgMTYgMTIgMjh6XCIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDQ4LFxuICAgICAgICAgICAgICAgIGhlaWdodDogNDhcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldCBjaGV2cm9uX2xlZnQoKSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiByZXF1aXJlKFwiY2hlZXRhaC1ncmlkLWljb24tc3ZnLWxvYWRlciFtYXRlcmlhbC1kZXNpZ24taWNvbnMvbmF2aWdhdGlvbi9zdmcvcHJvZHVjdGlvbi9pY19jaGV2cm9uX2xlZnRfNDhweC5zdmdcIik7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZDogXCJNMTQuODMgMzAuODNMMjQgMjEuNjZsOS4xNyA5LjE3TDM2IDI4IDI0IDE2IDEyIDI4elwiLFxuICAgICAgICAgICAgICAgIHdpZHRoOiA0OCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQ4XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBnZXQgY2hldnJvbl9yaWdodCgpIHtcbiAgICAgICAgICAgICAgLy8gcmV0dXJuIHJlcXVpcmUoXCJjaGVldGFoLWdyaWQtaWNvbi1zdmctbG9hZGVyIW1hdGVyaWFsLWRlc2lnbi1pY29ucy9uYXZpZ2F0aW9uL3N2Zy9wcm9kdWN0aW9uL2ljX2NoZXZyb25fcmlnaHRfNDhweC5zdmdcIik7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZDogXCJNMjAgMTJsLTIuODMgMi44M0wyNi4zNCAyNGwtOS4xNyA5LjE3TDIwIDM2bDEyLTEyelwiLFxuICAgICAgICAgICAgICAgIHdpZHRoOiA0OCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQ4XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBnZXQgZXhwYW5kX2xlc3MoKSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiByZXF1aXJlKFwiY2hlZXRhaC1ncmlkLWljb24tc3ZnLWxvYWRlciFtYXRlcmlhbC1kZXNpZ24taWNvbnMvbmF2aWdhdGlvbi9zdmcvcHJvZHVjdGlvbi9pY19leHBhbmRfbGVzc180OHB4LnN2Z1wiKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkOiBcIk0yNCAxNkwxMiAyOGwyLjgzIDIuODNMMjQgMjEuNjZsOS4xNyA5LjE3TDM2IDI4elwiLFxuICAgICAgICAgICAgICAgIHdpZHRoOiA0OCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQ4XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBnZXQgZXhwYW5kX21vcmUoKSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiByZXF1aXJlKFwiY2hlZXRhaC1ncmlkLWljb24tc3ZnLWxvYWRlciFtYXRlcmlhbC1kZXNpZ24taWNvbnMvbmF2aWdhdGlvbi9zdmcvcHJvZHVjdGlvbi9pY19leHBhbmRfbW9yZV80OHB4LnN2Z1wiKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkOiBcIk0zMy4xNyAxNy4xN0wyNCAyNi4zNGwtOS4xNy05LjE3TDEyIDIwbDEyIDEyIDEyLTEyelwiLFxuICAgICAgICAgICAgICAgIHdpZHRoOiA0OCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQ4XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuICgwLCB1dGlsc18xLmV4dGVuZCkoYnVpbHRpbnMsIGljb25zXzEuaWNvbnMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZ2V0ID0gZ2V0O1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL0V2ZW50SGFuZGxlci5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxFdmVudEhhbmRsZXJKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLkV2ZW50SGFuZGxlciA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuXG4gICAgICAgICAgdmFyIG5leHRJZCA9IDE7XG5cbiAgICAgICAgICB2YXIgRXZlbnRIYW5kbGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIEV2ZW50SGFuZGxlcigpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV2ZW50SGFuZGxlcik7XG5cbiAgICAgICAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0ge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhFdmVudEhhbmRsZXIsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJvblwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24odGFyZ2V0LCB0eXBlLCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW43ID0gYXJndW1lbnRzLmxlbmd0aCwgb3B0aW9ucyA9IG5ldyBBcnJheShfbGVuNyA+IDMgPyBfbGVuNyAtIDMgOiAwKSwgX2tleTcgPSAzOyBfa2V5NyA8IF9sZW43OyBfa2V5NysrKSB7XG4gICAgICAgICAgICAgICAgICBvcHRpb25zW19rZXk3IC0gM10gPSBhcmd1bWVudHNbX2tleTddO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIuYXBwbHkodGFyZ2V0LCBbdHlwZSwgbGlzdGVuZXJdLmNvbmNhdChvcHRpb25zKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICAgIGxpc3RlbmVyOiBsaXN0ZW5lcixcbiAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IG5leHRJZCsrO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVyc1tpZF0gPSBvYmo7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJvbmNlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbmNlKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxMDEgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjggPSBhcmd1bWVudHMubGVuZ3RoLCBvcHRpb25zID0gbmV3IEFycmF5KF9sZW44ID4gMyA/IF9sZW44IC0gMyA6IDApLCBfa2V5OCA9IDM7IF9rZXk4IDwgX2xlbjg7IF9rZXk4KyspIHtcbiAgICAgICAgICAgICAgICAgIG9wdGlvbnNbX2tleTggLSAzXSA9IGFyZ3VtZW50c1tfa2V5OF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGlkID0gdGhpcy5vbi5hcHBseSh0aGlzLCBbdGFyZ2V0LCB0eXBlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczEwMS5vZmYoaWQpO1xuXG4gICAgICAgICAgICAgICAgICBsaXN0ZW5lci5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfV0uY29uY2F0KG9wdGlvbnMpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInRyeVdpdGhPZmZFdmVudHNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRyeVdpdGhPZmZFdmVudHModGFyZ2V0LCB0eXBlLCBjYWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBbXTtcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAoMCwgdXRpbHNfMS5lYWNoKSh0aGlzLl9saXN0ZW5lcnMsIGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai50YXJnZXQgPT09IHRhcmdldCAmJiBvYmoudHlwZSA9PT0gdHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmoudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfb2JqJHRhcmdldDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgKF9vYmokdGFyZ2V0ID0gb2JqLnRhcmdldCkucmVtb3ZlRXZlbnRMaXN0ZW5lci5hcHBseShfb2JqJHRhcmdldCwgW29iai50eXBlLCBvYmoubGlzdGVuZXJdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkob2JqLm9wdGlvbnMpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgbGlzdC5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgY2FsbCgpO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnRhcmdldC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIF9vYmokdGFyZ2V0MjtcblxuICAgICAgICAgICAgICAgICAgICAgIChfb2JqJHRhcmdldDIgPSBvYmoudGFyZ2V0KS5hZGRFdmVudExpc3RlbmVyLmFwcGx5KF9vYmokdGFyZ2V0MiwgW29iai50eXBlLCBvYmoubGlzdGVuZXJdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkob2JqLm9wdGlvbnMpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib2ZmXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoaWQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBvYmogPSB0aGlzLl9saXN0ZW5lcnNbaWRdO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFvYmopIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fbGlzdGVuZXJzW2lkXTtcblxuICAgICAgICAgICAgICAgIGlmIChvYmoudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfb2JqJHRhcmdldDM7XG5cbiAgICAgICAgICAgICAgICAgIChfb2JqJHRhcmdldDMgPSBvYmoudGFyZ2V0KS5yZW1vdmVFdmVudExpc3RlbmVyLmFwcGx5KF9vYmokdGFyZ2V0MywgW29iai50eXBlLCBvYmoubGlzdGVuZXJdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkob2JqLm9wdGlvbnMpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZpcmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpcmUodGFyZ2V0LCB0eXBlKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjkgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW45ID4gMiA/IF9sZW45IC0gMiA6IDApLCBfa2V5OSA9IDI7IF9rZXk5IDwgX2xlbjk7IF9rZXk5KyspIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTkgLSAyXSA9IGFyZ3VtZW50c1tfa2V5OV07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgKDAsIHV0aWxzXzEuZWFjaCkodGhpcy5fbGlzdGVuZXJzLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgICBpZiAob2JqLnRhcmdldCA9PT0gdGFyZ2V0ICYmIG9iai50eXBlID09PSB0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfb2JqJGxpc3RlbmVyO1xuXG4gICAgICAgICAgICAgICAgICAgIChfb2JqJGxpc3RlbmVyID0gb2JqLmxpc3RlbmVyKS5jYWxsLmFwcGx5KF9vYmokbGlzdGVuZXIsIFtvYmoudGFyZ2V0XS5jb25jYXQoYXJncykpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoYXNMaXN0ZW5lclwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFzTGlzdGVuZXIodGFyZ2V0LCB0eXBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICgwLCB1dGlsc18xLmVhY2gpKHRoaXMuX2xpc3RlbmVycywgZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgICAgaWYgKG9iai50YXJnZXQgPT09IHRhcmdldCAmJiBvYmoudHlwZSA9PT0gdHlwZSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNsZWFyXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgICAgICAgICAgICAoMCwgdXRpbHNfMS5lYWNoKSh0aGlzLl9saXN0ZW5lcnMsIGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICAgIGlmIChvYmoudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9vYmokdGFyZ2V0NDtcblxuICAgICAgICAgICAgICAgICAgICAoX29iaiR0YXJnZXQ0ID0gb2JqLnRhcmdldCkucmVtb3ZlRXZlbnRMaXN0ZW5lci5hcHBseShfb2JqJHRhcmdldDQsIFtvYmoudHlwZSwgb2JqLmxpc3RlbmVyXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG9iai5vcHRpb25zKSkpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVycyA9IHt9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVycyA9IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEV2ZW50SGFuZGxlcjtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLkV2ZW50SGFuZGxlciA9IEV2ZW50SGFuZGxlcjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9MUlVDYWNoZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL0xSVUNhY2hlLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxMUlVDYWNoZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTFJVQ2FjaGUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgTFJVQ2FjaGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gTFJVQ2FjaGUoY2FjaGVTaXplKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMUlVDYWNoZSk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgICAgICAgICAgICB0aGlzLl9tYXAgPSB7fTtcbiAgICAgICAgICAgICAgdGhpcy5fY2FjaGVTaXplID0gY2FjaGVTaXplIHx8IDUwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoTFJVQ2FjaGUsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldChrZXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gdGhpcy5fbWFwW2tleV07XG5cbiAgICAgICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2xpc3Q7XG4gICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gbGlzdC5pbmRleE9mKGtleSk7XG4gICAgICAgICAgICAgICAgICBsaXN0LnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgICAgICAgbGlzdC5wdXNoKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwicHV0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwdXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fbGlzdDtcbiAgICAgICAgICAgICAgICB2YXIgbWFwID0gdGhpcy5fbWFwO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1hcFtrZXldKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gbGlzdC5pbmRleE9mKGtleSk7XG4gICAgICAgICAgICAgICAgICBsaXN0LnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1hcFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGtleSk7XG5cbiAgICAgICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPiB0aGlzLl9jYWNoZVNpemUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciByZW1LZXkgPSBsaXN0LnNoaWZ0KCkgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtYXBbcmVtS2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIExSVUNhY2hlO1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuTFJVQ2FjaGUgPSBMUlVDYWNoZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9OdW1iZXJNYXAuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvTnVtYmVyTWFwLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGludGVybmFsTnVtYmVyTWFwSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5OdW1iZXJNYXAgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgaW5kZXhGaXJzdCA9IGZ1bmN0aW9uIGluZGV4Rmlyc3QoYXJyLCBlbG0pIHtcbiAgICAgICAgICAgIHZhciBsb3cgPSAwO1xuICAgICAgICAgICAgdmFyIGhpZ2ggPSBhcnIubGVuZ3RoIC0gMTtcblxuICAgICAgICAgICAgd2hpbGUgKGxvdyA8PSBoaWdoKSB7XG4gICAgICAgICAgICAgIHZhciBpID0gTWF0aC5mbG9vcigobG93ICsgaGlnaCkgLyAyKTtcblxuICAgICAgICAgICAgICBpZiAoYXJyW2ldID09PSBlbG0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChhcnJbaV0gPiBlbG0pIHtcbiAgICAgICAgICAgICAgICBoaWdoID0gaSAtIDE7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbG93ID0gaSArIDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGhpZ2ggPCAwID8gMCA6IGhpZ2g7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHZhciBOdW1iZXJNYXAgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gTnVtYmVyTWFwKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTnVtYmVyTWFwKTtcblxuICAgICAgICAgICAgICB0aGlzLl9rZXlzID0gW107XG4gICAgICAgICAgICAgIHRoaXMuX3ZhbHMgPSB7fTtcbiAgICAgICAgICAgICAgdGhpcy5fc29ydGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhOdW1iZXJNYXAsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJwdXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHB1dChrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoa2V5IGluIHRoaXMuX3ZhbHMpKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLl9rZXlzLnB1c2goa2V5KTtcblxuICAgICAgICAgICAgICAgICAgdGhpcy5fc29ydGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fdmFsc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJlbW92ZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKGtleSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl92YWxzW2tleV07XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9rZXlzLmluZGV4T2Yoa2V5KTtcblxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9rZXlzLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9zb3J0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHNba2V5XTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaGFzXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYXMoa2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHNba2V5XSAhPSBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJlYWNoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlYWNoKGtleUZyb20sIGtleVRvLCBmbikge1xuICAgICAgICAgICAgICAgIHZhciBrZXlzID0gdGhpcy5fa2V5cztcbiAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3NvcnRlZCkge1xuICAgICAgICAgICAgICAgICAga2V5cy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhIDwgYikge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhID4gYikge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX3NvcnRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IGluZGV4Rmlyc3Qoa2V5cywga2V5RnJvbSk7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG5cbiAgICAgICAgICAgICAgICAgIGlmIChrZXlGcm9tIDw9IGtleSAmJiBrZXkgPD0ga2V5VG8pIHtcbiAgICAgICAgICAgICAgICAgICAgZm4odGhpcy5nZXQoa2V5KSwga2V5KTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5VG8gPCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTnVtYmVyTWFwO1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuTnVtYmVyTWFwID0gTnVtYmVyTWFwO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL1JlY3QuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL1JlY3QuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGludGVybmFsUmVjdEpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuUmVjdCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBSZWN0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFJlY3QobGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZWN0KTtcblxuICAgICAgICAgICAgICB0aGlzLl9sZWZ0ID0gbGVmdDtcbiAgICAgICAgICAgICAgdGhpcy5fdG9wID0gdG9wO1xuICAgICAgICAgICAgICB0aGlzLl93aWR0aCA9IHdpZHRoO1xuICAgICAgICAgICAgICB0aGlzLl9oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhSZWN0LCBbe1xuICAgICAgICAgICAgICBrZXk6IFwibGVmdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGVmdDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobGVmdCkge1xuICAgICAgICAgICAgICAgIHZhciByaWdodCA9IHRoaXMucmlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGVmdCA9IGxlZnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodCA9IHJpZ2h0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ0b3BcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RvcDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodG9wKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvdHRvbSA9IHRoaXMuYm90dG9tO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvcCA9IHRvcDtcbiAgICAgICAgICAgICAgICB0aGlzLmJvdHRvbSA9IGJvdHRvbTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwid2lkdGhcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh3aWR0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmlnaHQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImhlaWdodFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVpZ2h0O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm90dG9tID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJyaWdodFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmlnaHQgIT09IHVuZGVmaW5lZCA/IHRoaXMuX3JpZ2h0IDogdGhpcy5fcmlnaHQgPSB0aGlzLmxlZnQgKyB0aGlzLndpZHRoO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChyaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0ID0gcmlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IHJpZ2h0IC0gdGhpcy5sZWZ0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJib3R0b21cIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JvdHRvbSAhPT0gdW5kZWZpbmVkID8gdGhpcy5fYm90dG9tIDogdGhpcy5fYm90dG9tID0gdGhpcy50b3AgKyB0aGlzLmhlaWdodDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYm90dG9tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm90dG9tID0gYm90dG9tO1xuICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gYm90dG9tIC0gdGhpcy50b3A7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9mZnNldExlZnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZnNldExlZnQob2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGVmdCArPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmlnaHQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm9mZnNldFRvcFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb2Zmc2V0VG9wKG9mZnNldCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvcCArPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm90dG9tID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb3B5XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb3B5KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjdCh0aGlzLmxlZnQsIHRoaXMudG9wLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImludGVyc2VjdGlvblwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJzZWN0aW9uKHJlY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgeDAgPSBNYXRoLm1heCh0aGlzLmxlZnQsIHJlY3QubGVmdCk7XG4gICAgICAgICAgICAgICAgdmFyIHgxID0gTWF0aC5taW4odGhpcy5sZWZ0ICsgdGhpcy53aWR0aCwgcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoeDAgPD0geDEpIHtcbiAgICAgICAgICAgICAgICAgIHZhciB5MCA9IE1hdGgubWF4KHRoaXMudG9wLCByZWN0LnRvcCk7XG4gICAgICAgICAgICAgICAgICB2YXIgeTEgPSBNYXRoLm1pbih0aGlzLnRvcCArIHRoaXMuaGVpZ2h0LCByZWN0LnRvcCArIHJlY3QuaGVpZ2h0KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKHkwIDw9IHkxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBSZWN0LmJvdW5kcyh4MCwgeTAsIHgxLCB5MSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbnRhaW5zXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb250YWlucyhhbm90aGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVmdCA8PSBhbm90aGVyLmxlZnQgJiYgdGhpcy5sZWZ0ICsgdGhpcy53aWR0aCA+PSBhbm90aGVyLmxlZnQgKyBhbm90aGVyLndpZHRoICYmIHRoaXMudG9wIDw9IGFub3RoZXIudG9wICYmIHRoaXMudG9wICsgdGhpcy5oZWlnaHQgPj0gYW5vdGhlci50b3AgKyBhbm90aGVyLmhlaWdodDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaW5Qb2ludFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5Qb2ludCh4LCB5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVmdCA8PSB4ICYmIHRoaXMubGVmdCArIHRoaXMud2lkdGggPj0geCAmJiB0aGlzLnRvcCA8PSB5ICYmIHRoaXMudG9wICsgdGhpcy5oZWlnaHQgPj0geTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJib3VuZHNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJvdW5kcyhsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlY3QobGVmdCwgdG9wLCByaWdodCAtIGxlZnQsIGJvdHRvbSAtIHRvcCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIm1heFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWF4KHJlY3QxLCByZWN0Mikge1xuICAgICAgICAgICAgICAgIHJldHVybiBSZWN0LmJvdW5kcyhNYXRoLm1pbihyZWN0MS5sZWZ0LCByZWN0Mi5sZWZ0KSwgTWF0aC5taW4ocmVjdDEudG9wLCByZWN0Mi50b3ApLCBNYXRoLm1heChyZWN0MS5yaWdodCwgcmVjdDIucmlnaHQpLCBNYXRoLm1heChyZWN0MS5ib3R0b20sIHJlY3QyLmJvdHRvbSkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBSZWN0O1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuUmVjdCA9IFJlY3Q7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaW50ZXJuYWwvU2Nyb2xsYWJsZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvU2Nyb2xsYWJsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxTY3JvbGxhYmxlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICB2YXIgX19jcmVhdGVCaW5kaW5nID0gdGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZyB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcblxuICAgICAgICAgICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgICAgICAgICAgZGVzYyA9IHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ba107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICBvW2syXSA9IG1ba107XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gdGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHtcbiAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgdmFsdWU6IHZcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgb1tcImRlZmF1bHRcIl0gPSB2O1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9faW1wb3J0U3RhciA9IHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICAgICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIHtcbiAgICAgICAgICAgICAgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5TY3JvbGxhYmxlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHN0eWxlID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vc3R5bGUgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvc3R5bGUuanNcIikpO1xuXG4gICAgICAgICAgdmFyIEV2ZW50SGFuZGxlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9FdmVudEhhbmRsZXIgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvRXZlbnRIYW5kbGVyLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIE1BWF9TQ1JPTEwgPSB1dGlsc18xLmJyb3dzZXIuaGVpZ2h0TGltaXQgLSAxMDAwO1xuXG4gICAgICAgICAgdmFyIFNjcm9sbGFibGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gU2Nyb2xsYWJsZSgpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNjcm9sbGFibGUpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX3AgPSAxO1xuICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVyID0gbmV3IEV2ZW50SGFuZGxlcl8xLkV2ZW50SGFuZGxlcigpO1xuICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxhYmxlLmNsYXNzTGlzdC5hZGQoXCJncmlkLXNjcm9sbGFibGVcIik7XG5cbiAgICAgICAgICAgICAgdGhpcy5faGVpZ2h0ID0gMDtcbiAgICAgICAgICAgICAgdGhpcy5fd2lkdGggPSAwO1xuICAgICAgICAgICAgICB0aGlzLl9lbmRQb2ludEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX2VuZFBvaW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZ3JpZC1zY3JvbGwtZW5kLXBvaW50XCIpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZSgpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX3Njcm9sbGFibGUuYXBwZW5kQ2hpbGQodGhpcy5fZW5kUG9pbnRFbGVtZW50KTsgLy8gY29uc3QgbW91c2V3aGVlbGV2dCA9ICgvRmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpID8gJ0RPTU1vdXNlU2Nyb2xsJyA6ICdtb3VzZXdoZWVsJzsgLy9GRiBkb2Vzbid0IHJlY29nbml6ZSBtb3VzZXdoZWVsIGFzIG9mIEZGMy54XG4gICAgICAgICAgICAgIC8vIHRoaXMuX2hhbmRsZXIub24odGhpcy5fc2Nyb2xsYWJsZSwgbW91c2V3aGVlbGV2dCwgKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAvLyBjb25zdCBkZWx0YSA9IGV2dC5kZXRhaWwgPyBldnQuZGV0YWlsICogKC0xMjApIDogZXZ0LndoZWVsRGVsdGE7XG4gICAgICAgICAgICAgIC8vIGNvbnN0IHBvaW50ID0gTWF0aC5taW4oTWF0aC5hYnMoZGVsdGEpIC8gMTIsIHRoaXMuc2Nyb2xsSGVpZ2h0IC8gNSk7XG4gICAgICAgICAgICAgIC8vIHRoaXMuc2Nyb2xsVG9wICs9IGRlbHRhIDwgMCA/IHBvaW50IDogLXBvaW50O1xuICAgICAgICAgICAgICAvLyB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoU2Nyb2xsYWJsZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNhbGNUb3BcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhbGNUb3AodG9wKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbGF0aXZlVG9wID0gdG9wIC0gdGhpcy5zY3JvbGxUb3A7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Njcm9sbGFibGUuc2Nyb2xsVG9wICsgcmVsYXRpdmVUb3A7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldEVsZW1lbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVsZW1lbnQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Njcm9sbGFibGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNldFNjcm9sbFNpemVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNjcm9sbFNpemUod2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNjcm9sbFdpZHRoXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQod2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93aWR0aCA9IHdpZHRoO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInNjcm9sbEhlaWdodFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVpZ2h0O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2Nyb2xsTGVmdFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoTWF0aC5jZWlsKHRoaXMuX3Njcm9sbGFibGUuc2Nyb2xsTGVmdCksIDApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChzY3JvbGxMZWZ0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsYWJsZS5zY3JvbGxMZWZ0ID0gc2Nyb2xsTGVmdDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2Nyb2xsVG9wXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChNYXRoLmNlaWwodGhpcy5fc2Nyb2xsYWJsZS5zY3JvbGxUb3AgLyB0aGlzLl9wKSwgMCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHNjcm9sbFRvcCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Njcm9sbGFibGUuc2Nyb2xsVG9wID0gc2Nyb2xsVG9wICogdGhpcy5fcDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwib25TY3JvbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uU2Nyb2xsKGZuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlci5vbih0aGlzLl9zY3JvbGxhYmxlLCBcInNjcm9sbFwiLCBmbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlci5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl91cGRhdGVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGUoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRvbUhlaWdodDtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkX3Njcm9sbGFibGUgPSB0aGlzLl9zY3JvbGxhYmxlLFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRIZWlnaHQgPSBfdGhpcyRfc2Nyb2xsYWJsZS5vZmZzZXRIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFdpZHRoID0gX3RoaXMkX3Njcm9sbGFibGUub2Zmc2V0V2lkdGg7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faGVpZ2h0ID4gTUFYX1NDUk9MTCkge1xuICAgICAgICAgICAgICAgICAgdmFyIHNiU2l6ZSA9IHN0eWxlLmdldFNjcm9sbEJhclNpemUoKTtcbiAgICAgICAgICAgICAgICAgIHZhciB2U2Nyb2xsUmFuZ2UgPSBNQVhfU0NST0xMIC0gb2Zmc2V0SGVpZ2h0ICsgc2JTaXplO1xuICAgICAgICAgICAgICAgICAgdmFyIHJTY3JvbGxSYW5nZSA9IHRoaXMuX2hlaWdodCAtIG9mZnNldEhlaWdodCArIHNiU2l6ZTtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX3AgPSB2U2Nyb2xsUmFuZ2UgLyByU2Nyb2xsUmFuZ2U7XG4gICAgICAgICAgICAgICAgICBkb21IZWlnaHQgPSBNQVhfU0NST0xMO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLl9wID0gMTtcbiAgICAgICAgICAgICAgICAgIGRvbUhlaWdodCA9IHRoaXMuX2hlaWdodDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9lbmRQb2ludEVsZW1lbnQuc3R5bGUudG9wID0gXCJcIi5jb25jYXQoZG9tSGVpZ2h0LnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbmRQb2ludEVsZW1lbnQuc3R5bGUubGVmdCA9IFwiXCIuY29uY2F0KHRoaXMuX3dpZHRoLnRvRml4ZWQoKSwgXCJweFwiKTsgLy8gU2V0cyB0aGUgbWF4aW11bSB2YWx1ZSB0byB0aGUgc2Nyb2xsIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uIGV4Y2VlZHMgdGhlIG1heGltdW0gdmFsdWUuXG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxUb3AgPiB0aGlzLnNjcm9sbEhlaWdodCAtIG9mZnNldEhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSB0aGlzLnNjcm9sbEhlaWdodCAtIG9mZnNldEhlaWdodDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxMZWZ0ID4gdGhpcy5zY3JvbGxXaWR0aCAtIG9mZnNldFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbFdpZHRoIC0gb2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBTY3JvbGxhYmxlO1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuU2Nyb2xsYWJsZSA9IFNjcm9sbGFibGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaW50ZXJuYWwvYW5pbWF0ZS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvYW5pbWF0ZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxBbmltYXRlSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5hbmltYXRlID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gY3ViaWNCZXppZXIoeDIsIHkyLCB4MywgeTMpIHtcbiAgICAgICAgICAgIHZhciBzdGVwO1xuICAgICAgICAgICAgdmFyIGVyciA9IDAuMDAwMTtcbiAgICAgICAgICAgIHgyICo9IDM7XG4gICAgICAgICAgICB5MiAqPSAzO1xuICAgICAgICAgICAgeDMgKj0gMztcbiAgICAgICAgICAgIHkzICo9IDM7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgdmFyIHAsIGEsIGIsIGMsIGQsIHgsIHM7XG5cbiAgICAgICAgICAgICAgaWYgKHQgPCAwIHx8IDEgPCB0KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiXCIuY29uY2F0KHQpKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHAgPSBzdGVwIHx8IHQ7XG5cbiAgICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGEgPSAxIC0gcDtcbiAgICAgICAgICAgICAgICBiID0gYSAqIGE7XG4gICAgICAgICAgICAgICAgYyA9IHAgKiBwO1xuICAgICAgICAgICAgICAgIGQgPSBjICogcDtcbiAgICAgICAgICAgICAgICB4ID0geDIgKiBiICogcCArIHgzICogYSAqIGMgKyBkO1xuICAgICAgICAgICAgICAgIHMgPSB0IC0geDtcbiAgICAgICAgICAgICAgICBwICs9IHMgKiAwLjU7XG4gICAgICAgICAgICAgIH0gd2hpbGUgKGVyciA8IE1hdGguYWJzKHMpKTtcblxuICAgICAgICAgICAgICBzdGVwID0gcDtcbiAgICAgICAgICAgICAgcmV0dXJuIHkyICogYiAqIHAgKyB5MyAqIGEgKiBjICsgZDtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIEVBU0lOR1MgPSB7XG4gICAgICAgICAgICBsaW5lYXI6IGZ1bmN0aW9uIGxpbmVhcihwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVhc2VJbjogY3ViaWNCZXppZXIoMC40MiwgMC4wLCAxLjAsIDEuMCksXG4gICAgICAgICAgICBlYXNlT3V0OiBjdWJpY0JlemllcigwLjAsIDAuMCwgMC41OCwgMS4wKSxcbiAgICAgICAgICAgIGVhc2VJbk91dDogY3ViaWNCZXppZXIoMC40MiwgMC4wLCAwLjU4LCAxLjApXG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgcmFmID0gdXRpbHNfMS5pc05vZGUgPyBmdW5jdGlvbiAoKSB7fSA6IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZuLCAxKTtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgZnVuY3Rpb24gbm93KCkge1xuICAgICAgICAgICAgcmV0dXJuIERhdGUubm93KCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIDxwcmU+XG4gICAgICAgICAgICogQW5pbWF0ZXMuXG4gICAgICAgICAgICogPC9wcmU+XG4gICAgICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIGFuaW1hdGlvbiB0aW1lLlxuICAgICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHN0ZXAgc3RlcFxuICAgICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb258c3RyaW5nfSBlYXNpbmcgZWFzaW5nXG4gICAgICAgICAgICogQHJldHVybnMge29iamVjdH0gRGVmZXJyZWQgb2JqZWN0LlxuICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBhbmltYXRlKGR1cmF0aW9uLCBzdGVwLCBlYXNpbmcpIHtcbiAgICAgICAgICAgIHZhciBzdGFydGVkQXQgPSBub3coKTtcbiAgICAgICAgICAgIHZhciBlYXNpbmdGbiA9IGVhc2luZyA9PSBudWxsID8gRUFTSU5HUy5lYXNlSW5PdXQgOiB0eXBlb2YgZWFzaW5nID09PSBcInN0cmluZ1wiID8gRUFTSU5HU1tlYXNpbmddIDogZWFzaW5nO1xuICAgICAgICAgICAgdmFyIGNhbmNlbGVkRmxnID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHZhciBjcmVhdGVBbmltID0gZnVuY3Rpb24gY3JlYXRlQW5pbShyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgdmFyIGFuaW0gPSBmdW5jdGlvbiBhbmltKCkge1xuICAgICAgICAgICAgICAgIHZhciBwb2ludCA9IG5vdygpIC0gc3RhcnRlZEF0O1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbmNlbGVkRmxnKSB7XG4gICAgICAgICAgICAgICAgICAvL2NhbmNlbFxuICAgICAgICAgICAgICAgICAgaWYgKHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBvaW50ID49IGR1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAvL2VuZFxuICAgICAgICAgICAgICAgICAgc3RlcCgxKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBzdGVwKGVhc2luZ0ZuKHBvaW50IC8gZHVyYXRpb24pKTtcbiAgICAgICAgICAgICAgICAgIHJhZihhbmltKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGFuaW07XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgY2FuY2VsID0gZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgICAgICAgICAgICBjYW5jZWxlZEZsZyA9IHRydWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIFByb21pc2UgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5pbSA9IGNyZWF0ZUFuaW0ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgICAgICBzdGVwKDApO1xuICAgICAgICAgICAgICAgIGFuaW0oKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJlc3VsdC5jYW5jZWwgPSBjYW5jZWw7XG4gICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgYW5pbSA9IGNyZWF0ZUFuaW0oZnVuY3Rpb24gKCkge30sIGZ1bmN0aW9uICgpIHt9KTtcbiAgICAgICAgICAgICAgc3RlcCgwKTtcbiAgICAgICAgICAgICAgYW5pbSgpO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNhbmNlbDogY2FuY2VsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5hbmltYXRlID0gYW5pbWF0ZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9jYWxjLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9pbnRlcm5hbC9jYWxjLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbENhbGNKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLnRvUHggPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgVFlQRV9QQVJFTiA9IDA7XG4gICAgICAgICAgdmFyIFRZUEVfVU5JVCA9IDE7XG4gICAgICAgICAgdmFyIFRZUEVfT1BFUkFUT1IgPSAyO1xuICAgICAgICAgIHZhciBUWVBFX05VTUJFUiA9IDM7XG4gICAgICAgICAgdmFyIE5PREVfVFlQRV9VTklUID0gMTA7XG4gICAgICAgICAgdmFyIE5PREVfVFlQRV9CSU5BUllfRVhQUkVTU0lPTiA9IDExO1xuICAgICAgICAgIHZhciBOT0RFX1RZUEVfTlVNQkVSID0gMTI7XG4gICAgICAgICAgdmFyIFRBQlVMQVRJT04gPSAweDA5O1xuICAgICAgICAgIHZhciBDQVJSSUFHRV9SRVRVUk4gPSAweDBkO1xuICAgICAgICAgIHZhciBMSU5FX0ZFRUQgPSAweDBhO1xuICAgICAgICAgIHZhciBGT1JNX0ZFRUQgPSAweDBjO1xuICAgICAgICAgIHZhciBTUEFDRSA9IDB4MjA7XG4gICAgICAgICAgdmFyIFBFUkNFTlQgPSAweDI1O1xuICAgICAgICAgIHZhciBGVUxMX1NUT1AgPSAweDJlO1xuICAgICAgICAgIHZhciBESUdJVF8wID0gMHgzMDtcbiAgICAgICAgICB2YXIgRElHSVRfOSA9IDB4Mzk7XG4gICAgICAgICAgdmFyIExBVElOX0NBUElUQUxfQSA9IDB4NDE7XG4gICAgICAgICAgdmFyIExBVElOX0NBUElUQUxfWiA9IDB4NWE7XG4gICAgICAgICAgdmFyIExBVElOX1NNQUxMX0EgPSAweDYxO1xuICAgICAgICAgIHZhciBMQVRJTl9TTUFMTF9aID0gMHg3YTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGlzVXBwZXJMZXR0ZXIoY3ApIHtcbiAgICAgICAgICAgIHJldHVybiBjcCA+PSBMQVRJTl9DQVBJVEFMX0EgJiYgY3AgPD0gTEFUSU5fQ0FQSVRBTF9aO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGlzTG93ZXJMZXR0ZXIoY3ApIHtcbiAgICAgICAgICAgIHJldHVybiBjcCA+PSBMQVRJTl9TTUFMTF9BICYmIGNwIDw9IExBVElOX1NNQUxMX1o7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gaXNMZXR0ZXIoY3ApIHtcbiAgICAgICAgICAgIHJldHVybiBpc0xvd2VyTGV0dGVyKGNwKSB8fCBpc1VwcGVyTGV0dGVyKGNwKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBpc1doaXRlc3BhY2UoY3ApIHtcbiAgICAgICAgICAgIHJldHVybiBjcCA9PT0gVEFCVUxBVElPTiB8fCBjcCA9PT0gTElORV9GRUVEIHx8IGNwID09PSBGT1JNX0ZFRUQgfHwgY3AgPT09IENBUlJJQUdFX1JFVFVSTiB8fCBjcCA9PT0gU1BBQ0U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gaXNEaWdpdChjcCkge1xuICAgICAgICAgICAgcmV0dXJuIGNwID49IERJR0lUXzAgJiYgY3AgPD0gRElHSVRfOTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBpc0RvdChjcCkge1xuICAgICAgICAgICAgcmV0dXJuIGNwID09PSBGVUxMX1NUT1A7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gaXNVbml0KGNwKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNMZXR0ZXIoY3ApIHx8IGNwID09PSBQRVJDRU5UO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUVycm9yKGNhbGMpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoXCJjYWxjIHBhcnNlIGVycm9yOiBcIi5jb25jYXQoY2FsYykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiB0b2tlbml6ZVxuICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjYWxjIGNhbGMgZXhwcmVzc2lvblxuICAgICAgICAgICAqIEByZXR1cm5zIHtBcnJheX0gdG9rZW5zXG4gICAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICAgKi9cblxuXG4gICAgICAgICAgZnVuY3Rpb24gdG9rZW5pemUoY2FsYykge1xuICAgICAgICAgICAgdmFyIGV4cCA9IGNhbGMucmVwbGFjZSgvY2FsY1xcKC9nLCBcIihcIikudHJpbSgpO1xuICAgICAgICAgICAgdmFyIHRva2VucyA9IFtdO1xuICAgICAgICAgICAgdmFyIGxlbiA9IGV4cC5sZW5ndGg7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW47IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgdmFyIGMgPSBleHBbaW5kZXhdO1xuICAgICAgICAgICAgICB2YXIgY3AgPSBjLmNoYXJDb2RlQXQoMCk7XG5cbiAgICAgICAgICAgICAgaWYgKGMgPT09IFwiKFwiIHx8IGMgPT09IFwiKVwiKSB7XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgdmFsdWU6IGMsXG4gICAgICAgICAgICAgICAgICB0eXBlOiBUWVBFX1BBUkVOXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoYyA9PT0gXCIqXCIgfHwgYyA9PT0gXCIvXCIpIHtcbiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICB2YWx1ZTogYyxcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFRZUEVfT1BFUkFUT1JcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChjID09PSBcIitcIiB8fCBjID09PSBcIi1cIikge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gcGFyc2VTaWduKGMsIGluZGV4ICsgMSkgLSAxO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzRGlnaXQoY3ApIHx8IGlzRG90KGNwKSkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gcGFyc2VOdW0oYywgaW5kZXggKyAxKSAtIDE7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNXaGl0ZXNwYWNlKGNwKSkgey8vIHNraXBcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBjcmVhdGVFcnJvcihjYWxjKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBwYXJzZVNpZ24oc2lnbiwgc3RhcnQpIHtcbiAgICAgICAgICAgICAgaWYgKHN0YXJ0IDwgbGVuKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jMyA9IGV4cFtzdGFydF07XG5cbiAgICAgICAgICAgICAgICB2YXIgX2NwID0gX2MzLmNoYXJDb2RlQXQoMCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNEaWdpdChfY3ApIHx8IGlzRG90KF9jcCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZU51bShzaWduICsgX2MzLCBzdGFydCArIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRva2Vucy5wdXNoKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogc2lnbixcbiAgICAgICAgICAgICAgICB0eXBlOiBUWVBFX09QRVJBVE9SXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gc3RhcnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHBhcnNlTnVtKG51bSwgc3RhcnQpIHtcbiAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhcnQ7XG5cbiAgICAgICAgICAgICAgZm9yICg7IGluZGV4IDwgbGVuOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jNCA9IGV4cFtpbmRleF07XG5cbiAgICAgICAgICAgICAgICB2YXIgX2NwMiA9IF9jNC5jaGFyQ29kZUF0KDApO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzRGlnaXQoX2NwMikpIHtcbiAgICAgICAgICAgICAgICAgIG51bSArPSBfYzQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfYzQgPT09IFwiLlwiKSB7XG4gICAgICAgICAgICAgICAgICBpZiAobnVtLmluZGV4T2YoXCIuXCIpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgY3JlYXRlRXJyb3IoY2FsYyk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIG51bSArPSBfYzQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc1VuaXQoX2NwMikpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZVVuaXQobnVtLCBfYzQsIGluZGV4ICsgMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChudW0gPT09IFwiLlwiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgY3JlYXRlRXJyb3IoY2FsYyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHBhcnNlRmxvYXQobnVtKSxcbiAgICAgICAgICAgICAgICB0eXBlOiBUWVBFX05VTUJFUlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBwYXJzZVVuaXQobnVtLCB1bml0LCBzdGFydCkge1xuICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGFydDtcblxuICAgICAgICAgICAgICBmb3IgKDsgaW5kZXggPCBsZW47IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICB2YXIgX2M1ID0gZXhwW2luZGV4XTtcblxuICAgICAgICAgICAgICAgIHZhciBfY3AzID0gX2M1LmNoYXJDb2RlQXQoMCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNVbml0KF9jcDMpKSB7XG4gICAgICAgICAgICAgICAgICB1bml0ICs9IF9jNTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBwYXJzZUZsb2F0KG51bSksXG4gICAgICAgICAgICAgICAgdW5pdDogdW5pdCxcbiAgICAgICAgICAgICAgICB0eXBlOiBUWVBFX1VOSVRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRva2VucztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgUFJFQ0VERU5DRSA9IHtcbiAgICAgICAgICAgIFwiKlwiOiAzLFxuICAgICAgICAgICAgXCIvXCI6IDMsXG4gICAgICAgICAgICBcIitcIjogMixcbiAgICAgICAgICAgIFwiLVwiOiAyXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGxleCh0b2tlbnMsIGNhbGMpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGJ1aWxkQmluYXJ5RXhwTm9kZShzdGFjaykge1xuICAgICAgICAgICAgICB2YXIgcmlnaHQgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgdmFyIG9wID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgIHZhciBsZWZ0ID0gc3RhY2sucG9wKCk7XG5cbiAgICAgICAgICAgICAgaWYgKCFsZWZ0IHx8ICFsZWZ0Lm5vZGVUeXBlIHx8ICFvcCB8fCBvcC50eXBlICE9PSBUWVBFX09QRVJBVE9SIHx8ICFyaWdodCB8fCAhcmlnaHQubm9kZVR5cGUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBjcmVhdGVFcnJvcihjYWxjKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbm9kZVR5cGU6IE5PREVfVFlQRV9CSU5BUllfRVhQUkVTU0lPTixcbiAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0LFxuICAgICAgICAgICAgICAgIG9wOiBvcCxcbiAgICAgICAgICAgICAgICByaWdodDogcmlnaHRcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHN0YWNrID0gW107XG5cbiAgICAgICAgICAgIHdoaWxlICh0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHZhciB0b2tlbiA9IHRva2Vucy5zaGlmdCgpO1xuXG4gICAgICAgICAgICAgIGlmICh0b2tlbi50eXBlID09PSBUWVBFX1BBUkVOICYmIHRva2VuLnZhbHVlID09PSBcIihcIikge1xuICAgICAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgZGVlcCA9IDA7XG4gICAgICAgICAgICAgICAgICB2YXIgY2xvc2VJbmRleCA9IHV0aWxzXzEuYXJyYXkuZmluZEluZGV4KHRva2VucywgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PT0gVFlQRV9QQVJFTiAmJiB0LnZhbHVlID09PSBcIihcIikge1xuICAgICAgICAgICAgICAgICAgICAgIGRlZXArKztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LnR5cGUgPT09IFRZUEVfUEFSRU4gJiYgdC52YWx1ZSA9PT0gXCIpXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRlZXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgIGRlZXAtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoY2xvc2VJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgY3JlYXRlRXJyb3IoY2FsYyk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gobGV4KHRva2Vucy5zcGxpY2UoMCwgY2xvc2VJbmRleCksIGNhbGMpKTtcbiAgICAgICAgICAgICAgICAgIHRva2Vucy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4udHlwZSA9PT0gVFlQRV9PUEVSQVRPUikge1xuICAgICAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPj0gMykge1xuICAgICAgICAgICAgICAgICAgdmFyIGJlZm9yZU9wID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMl0udmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChQUkVDRURFTkNFW3Rva2VuLnZhbHVlXSA8PSBQUkVDRURFTkNFW2JlZm9yZU9wXSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGJ1aWxkQmluYXJ5RXhwTm9kZShzdGFjaykpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN0YWNrLnB1c2godG9rZW4pO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRva2VuLnR5cGUgPT09IFRZUEVfVU5JVCkge1xuICAgICAgICAgICAgICAgIHZhciBudW0gPSB0b2tlbi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdW5pdCA9IHRva2VuLnVuaXQ7XG4gICAgICAgICAgICAgICAgc3RhY2sucHVzaCh7XG4gICAgICAgICAgICAgICAgICBub2RlVHlwZTogTk9ERV9UWVBFX1VOSVQsXG4gICAgICAgICAgICAgICAgICB2YWx1ZTogbnVtLFxuICAgICAgICAgICAgICAgICAgdW5pdDogdW5pdFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRva2VuLnR5cGUgPT09IFRZUEVfTlVNQkVSKSB7XG4gICAgICAgICAgICAgICAgc3RhY2sucHVzaCh7XG4gICAgICAgICAgICAgICAgICBub2RlVHlwZTogTk9ERV9UWVBFX05VTUJFUixcbiAgICAgICAgICAgICAgICAgIHZhbHVlOiB0b2tlbi52YWx1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgIHN0YWNrLnB1c2goYnVpbGRCaW5hcnlFeHBOb2RlKHN0YWNrKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzdGFja1swXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBwYXJzZShjYWxjU3RyKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gdG9rZW5pemUoY2FsY1N0cik7XG4gICAgICAgICAgICByZXR1cm4gbGV4KHRva2VucywgY2FsY1N0cik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY2FsY05vZGUobm9kZSwgY29udGV4dCkge1xuICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5PREVfVFlQRV9CSU5BUllfRVhQUkVTU0lPTikge1xuICAgICAgICAgICAgICB2YXIgbGVmdCA9IGNhbGNOb2RlKG5vZGUubGVmdCwgY29udGV4dCk7XG4gICAgICAgICAgICAgIHZhciByaWdodCA9IGNhbGNOb2RlKG5vZGUucmlnaHQsIGNvbnRleHQpO1xuXG4gICAgICAgICAgICAgIHN3aXRjaCAobm9kZS5vcC52YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCIrXCI6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbGVmdCArIHJpZ2h0O1xuXG4gICAgICAgICAgICAgICAgY2FzZSBcIi1cIjpcbiAgICAgICAgICAgICAgICAgIHJldHVybiBsZWZ0IC0gcmlnaHQ7XG5cbiAgICAgICAgICAgICAgICBjYXNlIFwiKlwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGxlZnQgKiByaWdodDtcblxuICAgICAgICAgICAgICAgIGNhc2UgXCIvXCI6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbGVmdCAvIHJpZ2h0O1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvcmVzdHJpY3QtdGVtcGxhdGUtZXhwcmVzc2lvbnNcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbGMgZXJyb3IuIHVua25vd24gb3BlcmF0b3I6IFwiLmNvbmNhdChub2RlLm9wLnZhbHVlKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTk9ERV9UWVBFX1VOSVQpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChub2RlLnVuaXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiJVwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUudmFsdWUgKiBjb250ZXh0LmZ1bGwgLyAxMDA7XG5cbiAgICAgICAgICAgICAgICBjYXNlIFwiZW1cIjpcbiAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlLnZhbHVlICogY29udGV4dC5lbTtcblxuICAgICAgICAgICAgICAgIGNhc2UgXCJweFwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUudmFsdWU7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2FsYyBlcnJvci4gdW5rbm93biB1bml0OiBcIi5jb25jYXQobm9kZS51bml0KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTk9ERV9UWVBFX05VTUJFUikge1xuICAgICAgICAgICAgICByZXR1cm4gbm9kZS52YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2FsYyBlcnJvci5cIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdG9QeEludGVybmFsKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgYXN0ID0gcGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIGNhbGNOb2RlKGFzdCwgY29udGV4dCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdG9QeCh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICByZXR1cm4gdG9QeEludGVybmFsKHZhbHVlLnRyaW0oKSwgY29udGV4dCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAtIDA7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy50b1B4ID0gdG9QeDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9jYW52YXNlcy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL2NhbnZhc2VzLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxDYW52YXNlc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuY2FsY1N0YXJ0UG9zaXRpb24gPSBleHBvcnRzLmNhbGNCYXNlUG9zaXRpb24gPSBleHBvcnRzLmdldEZvbnRTaXplID0gdm9pZCAwO1xuICAgICAgICAgIHZhciBmb250U2l6ZUNhY2hlID0ge307XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRGb250U2l6ZShjdHgsIGZvbnQpIHtcbiAgICAgICAgICAgIHZhciBmb250TmFtZSA9IGZvbnQgfHwgY3R4LmZvbnQ7XG5cbiAgICAgICAgICAgIGlmIChmb250U2l6ZUNhY2hlW2ZvbnROYW1lXSkge1xuICAgICAgICAgICAgICByZXR1cm4gZm9udFNpemVDYWNoZVtmb250TmFtZV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBiayA9IGN0eC5mb250O1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjdHguZm9udCA9IGZvbnROYW1lO1xuICAgICAgICAgICAgICB2YXIgZW0gPSBjdHgubWVhc3VyZVRleHQoXCLjgYJcIikud2lkdGg7XG4gICAgICAgICAgICAgIHJldHVybiBmb250U2l6ZUNhY2hlW2ZvbnROYW1lXSA9IHtcbiAgICAgICAgICAgICAgICB3aWR0aDogZW0sXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBlbVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgY3R4LmZvbnQgPSBiaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmdldEZvbnRTaXplID0gZ2V0Rm9udFNpemU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBjYWxjQmFzZVBvc2l0aW9uKGN0eCwgcmVjdCkge1xuICAgICAgICAgICAgdmFyIF9yZWY3OCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge30sXG4gICAgICAgICAgICAgICAgX3JlZjc4JG9mZnNldCA9IF9yZWY3OC5vZmZzZXQsXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gX3JlZjc4JG9mZnNldCA9PT0gdm9pZCAwID8gMCA6IF9yZWY3OCRvZmZzZXQsXG4gICAgICAgICAgICAgICAgX3JlZjc4JHBhZGRpbmcgPSBfcmVmNzgucGFkZGluZztcblxuICAgICAgICAgICAgX3JlZjc4JHBhZGRpbmcgPSBfcmVmNzgkcGFkZGluZyA9PT0gdm9pZCAwID8ge30gOiBfcmVmNzgkcGFkZGluZztcbiAgICAgICAgICAgIHZhciBfcmVmNzgkcGFkZGluZyRsZWZ0ID0gX3JlZjc4JHBhZGRpbmcubGVmdCxcbiAgICAgICAgICAgICAgICBwYWRkaW5nTGVmdCA9IF9yZWY3OCRwYWRkaW5nJGxlZnQgPT09IHZvaWQgMCA/IDAgOiBfcmVmNzgkcGFkZGluZyRsZWZ0LFxuICAgICAgICAgICAgICAgIF9yZWY3OCRwYWRkaW5nJHJpZ2h0ID0gX3JlZjc4JHBhZGRpbmcucmlnaHQsXG4gICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0ID0gX3JlZjc4JHBhZGRpbmckcmlnaHQgPT09IHZvaWQgMCA/IDAgOiBfcmVmNzgkcGFkZGluZyRyaWdodCxcbiAgICAgICAgICAgICAgICBfcmVmNzgkcGFkZGluZyR0b3AgPSBfcmVmNzgkcGFkZGluZy50b3AsXG4gICAgICAgICAgICAgICAgcGFkZGluZ1RvcCA9IF9yZWY3OCRwYWRkaW5nJHRvcCA9PT0gdm9pZCAwID8gMCA6IF9yZWY3OCRwYWRkaW5nJHRvcCxcbiAgICAgICAgICAgICAgICBfcmVmNzgkcGFkZGluZyRib3R0b20gPSBfcmVmNzgkcGFkZGluZy5ib3R0b20sXG4gICAgICAgICAgICAgICAgcGFkZGluZ0JvdHRvbSA9IF9yZWY3OCRwYWRkaW5nJGJvdHRvbSA9PT0gdm9pZCAwID8gMCA6IF9yZWY3OCRwYWRkaW5nJGJvdHRvbTtcbiAgICAgICAgICAgIHJldHVybiBjYWxjU3RhcnRQb3NpdGlvbihjdHgsIHJlY3QsIDAsIDAsIHtcbiAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQsXG4gICAgICAgICAgICAgIHBhZGRpbmc6IHtcbiAgICAgICAgICAgICAgICBsZWZ0OiBwYWRkaW5nTGVmdCxcbiAgICAgICAgICAgICAgICByaWdodDogcGFkZGluZ1JpZ2h0LFxuICAgICAgICAgICAgICAgIHRvcDogcGFkZGluZ1RvcCxcbiAgICAgICAgICAgICAgICBib3R0b206IHBhZGRpbmdCb3R0b21cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5jYWxjQmFzZVBvc2l0aW9uID0gY2FsY0Jhc2VQb3NpdGlvbjtcblxuICAgICAgICAgIGZ1bmN0aW9uIGNhbGNTdGFydFBvc2l0aW9uKGN0eCwgcmVjdCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIF9yZWY3OSA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDoge30sXG4gICAgICAgICAgICAgICAgX3JlZjc5JG9mZnNldCA9IF9yZWY3OS5vZmZzZXQsXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gX3JlZjc5JG9mZnNldCA9PT0gdm9pZCAwID8gMCA6IF9yZWY3OSRvZmZzZXQsXG4gICAgICAgICAgICAgICAgX3JlZjc5JHBhZGRpbmcgPSBfcmVmNzkucGFkZGluZztcblxuICAgICAgICAgICAgX3JlZjc5JHBhZGRpbmcgPSBfcmVmNzkkcGFkZGluZyA9PT0gdm9pZCAwID8ge30gOiBfcmVmNzkkcGFkZGluZztcbiAgICAgICAgICAgIHZhciBfcmVmNzkkcGFkZGluZyRsZWZ0ID0gX3JlZjc5JHBhZGRpbmcubGVmdCxcbiAgICAgICAgICAgICAgICBwYWRkaW5nTGVmdCA9IF9yZWY3OSRwYWRkaW5nJGxlZnQgPT09IHZvaWQgMCA/IDAgOiBfcmVmNzkkcGFkZGluZyRsZWZ0LFxuICAgICAgICAgICAgICAgIF9yZWY3OSRwYWRkaW5nJHJpZ2h0ID0gX3JlZjc5JHBhZGRpbmcucmlnaHQsXG4gICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0ID0gX3JlZjc5JHBhZGRpbmckcmlnaHQgPT09IHZvaWQgMCA/IDAgOiBfcmVmNzkkcGFkZGluZyRyaWdodCxcbiAgICAgICAgICAgICAgICBfcmVmNzkkcGFkZGluZyR0b3AgPSBfcmVmNzkkcGFkZGluZy50b3AsXG4gICAgICAgICAgICAgICAgcGFkZGluZ1RvcCA9IF9yZWY3OSRwYWRkaW5nJHRvcCA9PT0gdm9pZCAwID8gMCA6IF9yZWY3OSRwYWRkaW5nJHRvcCxcbiAgICAgICAgICAgICAgICBfcmVmNzkkcGFkZGluZyRib3R0b20gPSBfcmVmNzkkcGFkZGluZy5ib3R0b20sXG4gICAgICAgICAgICAgICAgcGFkZGluZ0JvdHRvbSA9IF9yZWY3OSRwYWRkaW5nJGJvdHRvbSA9PT0gdm9pZCAwID8gMCA6IF9yZWY3OSRwYWRkaW5nJGJvdHRvbTtcbiAgICAgICAgICAgIHZhciB0ZXh0QWxpZ24gPSBjdHgudGV4dEFsaWduIHx8IFwibGVmdFwiO1xuICAgICAgICAgICAgdmFyIHRleHRCYXNlbGluZSA9IGN0eC50ZXh0QmFzZWxpbmUgfHwgXCJtaWRkbGVcIjtcbiAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSB0ZXh0QWxpZ247XG4gICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gdGV4dEJhc2VsaW5lO1xuICAgICAgICAgICAgdmFyIHggPSByZWN0LmxlZnQgKyBvZmZzZXQgKyBwYWRkaW5nTGVmdDtcblxuICAgICAgICAgICAgaWYgKHRleHRBbGlnbiA9PT0gXCJyaWdodFwiIHx8IHRleHRBbGlnbiA9PT0gXCJlbmRcIikge1xuICAgICAgICAgICAgICB4ID0gcmVjdC5yaWdodCAtIHdpZHRoIC0gb2Zmc2V0IC0gcGFkZGluZ1JpZ2h0O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0ZXh0QWxpZ24gPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgICAgeCA9IHJlY3QubGVmdCArIChyZWN0LndpZHRoIC0gd2lkdGggKyBwYWRkaW5nTGVmdCAtIHBhZGRpbmdSaWdodCkgLyAyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgeSA9IHJlY3QudG9wICsgb2Zmc2V0ICsgcGFkZGluZ1RvcDtcblxuICAgICAgICAgICAgaWYgKHRleHRCYXNlbGluZSA9PT0gXCJib3R0b21cIiB8fCB0ZXh0QmFzZWxpbmUgPT09IFwiYWxwaGFiZXRpY1wiIHx8IHRleHRCYXNlbGluZSA9PT0gXCJpZGVvZ3JhcGhpY1wiKSB7XG4gICAgICAgICAgICAgIHkgPSByZWN0LmJvdHRvbSAtIGhlaWdodCAtIG9mZnNldCAtIHBhZGRpbmdCb3R0b207XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRleHRCYXNlbGluZSA9PT0gXCJtaWRkbGVcIikge1xuICAgICAgICAgICAgICB5ID0gcmVjdC50b3AgKyAocmVjdC5oZWlnaHQgLSBoZWlnaHQgKyBwYWRkaW5nVG9wIC0gcGFkZGluZ0JvdHRvbSkgLyAyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgICB5OiB5XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuY2FsY1N0YXJ0UG9zaXRpb24gPSBjYWxjU3RhcnRQb3NpdGlvbjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9jb2xvci5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL2NvbG9yLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxDb2xvckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuY29sb3JUb1JHQiA9IHZvaWQgMDtcbiAgICAgICAgICB2YXIgcmdiTWFwID0ge307XG5cbiAgICAgICAgICBmdW5jdGlvbiBzdHlsZUNvbG9yVG9SR0IoY29sb3IpIHtcbiAgICAgICAgICAgIHZhciBkdW1teSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICB2YXIgc3R5bGUgPSBkdW1teS5zdHlsZTtcbiAgICAgICAgICAgIHN0eWxlLmNvbG9yID0gY29sb3I7XG4gICAgICAgICAgICBzdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcbiAgICAgICAgICAgIHN0eWxlLmhlaWdodCA9IFwiMXB4XCI7XG4gICAgICAgICAgICBzdHlsZS53aWR0aCA9IFwiMXB4XCI7XG4gICAgICAgICAgICBzdHlsZS5vcGFjaXR5ID0gXCIwXCI7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGR1bW15KTtcblxuICAgICAgICAgICAgdmFyIF9nZXRDb21wdXRlZFN0eWxlID0gKGRvY3VtZW50LmRlZmF1bHRWaWV3IHx8IHdpbmRvdykuZ2V0Q29tcHV0ZWRTdHlsZShkdW1teSwgXCJcIiksXG4gICAgICAgICAgICAgICAgc3R5bGVDb2xvciA9IF9nZXRDb21wdXRlZFN0eWxlLmNvbG9yO1xuXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGR1bW15KTtcbiAgICAgICAgICAgIHJldHVybiBjb2xvclRvUkdCMChzdHlsZUNvbG9yIHx8IFwiXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGhleFRvTnVtKGhleCkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGhleCwgMTYpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVJHQihyLCBnLCBiKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogMTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHI6IHIsXG4gICAgICAgICAgICAgIGc6IGcsXG4gICAgICAgICAgICAgIGI6IGIsXG4gICAgICAgICAgICAgIGE6IGFcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdHJpcGxlSGV4VG9SR0IoX3JlZjgwKSB7XG4gICAgICAgICAgICB2YXIgciA9IF9yZWY4MFsxXSxcbiAgICAgICAgICAgICAgICBnID0gX3JlZjgwWzJdLFxuICAgICAgICAgICAgICAgIGIgPSBfcmVmODBbM107XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlUkdCKGhleFRvTnVtKHIgKyByKSwgaGV4VG9OdW0oZyArIGcpLCBoZXhUb051bShiICsgYikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIHNleHR1cGxlSGV4VG9SR0IoX3JlZjgxKSB7XG4gICAgICAgICAgICB2YXIgcjEgPSBfcmVmODFbMV0sXG4gICAgICAgICAgICAgICAgcjIgPSBfcmVmODFbMl0sXG4gICAgICAgICAgICAgICAgZzEgPSBfcmVmODFbM10sXG4gICAgICAgICAgICAgICAgZzIgPSBfcmVmODFbNF0sXG4gICAgICAgICAgICAgICAgYjEgPSBfcmVmODFbNV0sXG4gICAgICAgICAgICAgICAgYjIgPSBfcmVmODFbNl07XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlUkdCKGhleFRvTnVtKHIxICsgcjIpLCBoZXhUb051bShnMSArIGcyKSwgaGV4VG9OdW0oYjEgKyBiMikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIHRlc3RSR0IoX3JlZjgyKSB7XG4gICAgICAgICAgICB2YXIgciA9IF9yZWY4Mi5yLFxuICAgICAgICAgICAgICAgIGcgPSBfcmVmODIuZyxcbiAgICAgICAgICAgICAgICBiID0gX3JlZjgyLmIsXG4gICAgICAgICAgICAgICAgYSA9IF9yZWY4Mi5hO1xuICAgICAgICAgICAgcmV0dXJuIDAgPD0gciAmJiByIDw9IDI1NSAmJiAwIDw9IGcgJiYgZyA8PSAyNTUgJiYgMCA8PSBiICYmIGIgPD0gMjU1ICYmIDAgPD0gYSAmJiBhIDw9IDE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gcmF0ZVRvQnl0ZShyKSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHIgKiAyNTUgLyAxMDApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBudW1iZXJQYXR0ZXJuID0gLygoPzpcXCt8LSk/KD86XFxkKyg/OlxcLlxcZCspP3xcXC5cXGQrKSkvLnNvdXJjZTtcbiAgICAgICAgICB2YXIgcGVyY2VudFBhdHRlcm4gPSBcIlwiLmNvbmNhdChudW1iZXJQYXR0ZXJuLCBcIiVcIik7XG4gICAgICAgICAgdmFyIG1heWJlUGVyY2VudFBhdHRlcm4gPSBcIlwiLmNvbmNhdChudW1iZXJQYXR0ZXJuLCBcIiglPylcIik7XG5cbiAgICAgICAgICBmdW5jdGlvbiBidWlsZFJnYldpdGhDb21tYVJlZ0V4cChieXRlUGF0dGVybikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoXCJecmdiYT9cXFxcKFxcXFxzKlwiLmNvbmNhdChieXRlUGF0dGVybiwgXCJcXFxccyosXFxcXHMqXCIpLmNvbmNhdChieXRlUGF0dGVybiwgXCJcXFxccyosXFxcXHMqXCIpLmNvbmNhdChieXRlUGF0dGVybiwgXCJcXFxccypcXFxcKSRcIiksIFwiaVwiKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBidWlsZFJnYkx2NFJlZ0V4cChieXRlUGF0dGVybikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoXCJecmdiYT9cXFxcKFxcXFxzKlwiLmNvbmNhdChieXRlUGF0dGVybiwgXCJcXFxccytcIikuY29uY2F0KGJ5dGVQYXR0ZXJuLCBcIlxcXFxzK1wiKS5jb25jYXQoYnl0ZVBhdHRlcm4sIFwiXFxcXHMqXFxcXCkkXCIpLCBcImlcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gYnVpbGRSZ2JhV2l0aENvbW1hUmVnRXhwKGJ5dGVQYXR0ZXJuLCBhbHBoYVBhdHRlcm4pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKFwiXnJnYmE/XFxcXChcXFxccypcIi5jb25jYXQoYnl0ZVBhdHRlcm4sIFwiXFxcXHMqLFxcXFxzKlwiKS5jb25jYXQoYnl0ZVBhdHRlcm4sIFwiXFxcXHMqLFxcXFxzKlwiKS5jb25jYXQoYnl0ZVBhdHRlcm4sIFwiXFxcXHMqLFxcXFxzKlwiKS5jb25jYXQoYWxwaGFQYXR0ZXJuLCBcIlxcXFxzKlxcXFwpJFwiKSwgXCJpXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGJ1aWxkUmdiYUx2NFJlZ0V4cChieXRlUGF0dGVybiwgYWxwaGFQYXR0ZXJuKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlZ0V4cChcIl5yZ2JhP1xcXFwoXFxcXHMqXCIuY29uY2F0KGJ5dGVQYXR0ZXJuLCBcIlxcXFxzK1wiKS5jb25jYXQoYnl0ZVBhdHRlcm4sIFwiXFxcXHMrXCIpLmNvbmNhdChieXRlUGF0dGVybiwgXCJcXFxccyovXFxcXHMqXCIpLmNvbmNhdChhbHBoYVBhdHRlcm4sIFwiXFxcXHMqXFxcXCkkXCIpLCBcImlcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY29sb3JUb1JHQjAoY29sb3IpIHtcbiAgICAgICAgICAgIGlmICgvXiNbMC05YS1mXXszfSQvaS5leGVjKGNvbG9yKSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJpcGxlSGV4VG9SR0IoY29sb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoL14jWzAtOWEtZl17Nn0kL2kuZXhlYyhjb2xvcikpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHNleHR1cGxlSGV4VG9SR0IoY29sb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmV0ID0gYnVpbGRSZ2JXaXRoQ29tbWFSZWdFeHAobnVtYmVyUGF0dGVybikuZXhlYyhjb2xvcikgfHwgYnVpbGRSZ2JMdjRSZWdFeHAobnVtYmVyUGF0dGVybikuZXhlYyhjb2xvcik7XG5cbiAgICAgICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICAgICAgdmFyIHJnYiA9IGNyZWF0ZVJHQihOdW1iZXIocmV0WzFdKSwgTnVtYmVyKHJldFsyXSksIE51bWJlcihyZXRbM10pKTtcblxuICAgICAgICAgICAgICBpZiAodGVzdFJHQihyZ2IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJnYjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXQgPSBidWlsZFJnYldpdGhDb21tYVJlZ0V4cChwZXJjZW50UGF0dGVybikuZXhlYyhjb2xvcikgfHwgYnVpbGRSZ2JMdjRSZWdFeHAocGVyY2VudFBhdHRlcm4pLmV4ZWMoY29sb3IpO1xuXG4gICAgICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICAgIHZhciBfcmdiID0gY3JlYXRlUkdCKHJhdGVUb0J5dGUoTnVtYmVyKHJldFsxXSkpLCByYXRlVG9CeXRlKE51bWJlcihyZXRbMl0pKSwgcmF0ZVRvQnl0ZShOdW1iZXIocmV0WzNdKSkpO1xuXG4gICAgICAgICAgICAgIGlmICh0ZXN0UkdCKF9yZ2IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9yZ2I7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0ID0gYnVpbGRSZ2JhV2l0aENvbW1hUmVnRXhwKG51bWJlclBhdHRlcm4sIG1heWJlUGVyY2VudFBhdHRlcm4pLmV4ZWMoY29sb3IpIHx8IGJ1aWxkUmdiYUx2NFJlZ0V4cChudW1iZXJQYXR0ZXJuLCBtYXliZVBlcmNlbnRQYXR0ZXJuKS5leGVjKGNvbG9yKTtcblxuICAgICAgICAgICAgaWYgKHJldCkge1xuICAgICAgICAgICAgICB2YXIgX3JnYjIgPSBjcmVhdGVSR0IoTnVtYmVyKHJldFsxXSksIE51bWJlcihyZXRbMl0pLCBOdW1iZXIocmV0WzNdKSwgTnVtYmVyKHJldFs0XSkgLyAocmV0WzVdXG4gICAgICAgICAgICAgIC8qICUgKi9cbiAgICAgICAgICAgICAgPyAxMDAgOiAxKSk7XG5cbiAgICAgICAgICAgICAgaWYgKHRlc3RSR0IoX3JnYjIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9yZ2IyO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldCA9IGJ1aWxkUmdiYVdpdGhDb21tYVJlZ0V4cChwZXJjZW50UGF0dGVybiwgbWF5YmVQZXJjZW50UGF0dGVybikuZXhlYyhjb2xvcikgfHwgYnVpbGRSZ2JhTHY0UmVnRXhwKHBlcmNlbnRQYXR0ZXJuLCBtYXliZVBlcmNlbnRQYXR0ZXJuKS5leGVjKGNvbG9yKTtcblxuICAgICAgICAgICAgaWYgKHJldCkge1xuICAgICAgICAgICAgICB2YXIgX3JnYjMgPSBjcmVhdGVSR0IocmF0ZVRvQnl0ZShOdW1iZXIocmV0WzFdKSksIHJhdGVUb0J5dGUoTnVtYmVyKHJldFsyXSkpLCByYXRlVG9CeXRlKE51bWJlcihyZXRbM10pKSwgTnVtYmVyKHJldFs0XSkgLyAocmV0WzVdXG4gICAgICAgICAgICAgIC8qICUgKi9cbiAgICAgICAgICAgICAgPyAxMDAgOiAxKSk7XG5cbiAgICAgICAgICAgICAgaWYgKHRlc3RSR0IoX3JnYjMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9yZ2IzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNvbG9yVG9SR0IoY29sb3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29sb3IgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVJHQigwLCAwLCAwLCAwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29sb3IgPSBjb2xvci50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcblxuICAgICAgICAgICAgaWYgKHJnYk1hcFtjb2xvcl0pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJnYk1hcFtjb2xvcl07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjb2xvclRvUkdCMChjb2xvcikgfHwgKHJnYk1hcFtjb2xvcl0gPSBzdHlsZUNvbG9yVG9SR0IoY29sb3IpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmNvbG9yVG9SR0IgPSBjb2xvclRvUkdCO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL2RvbS5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9pbnRlcm5hbC9kb20uanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxEb21Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLmZpbmROZXh0U2libGluZ0ZvY3VzYWJsZSA9IGV4cG9ydHMuZmluZFByZXZTaWJsaW5nRm9jdXNhYmxlID0gZXhwb3J0cy5pc0ZvY3VzYWJsZSA9IGV4cG9ydHMuZW5hYmxlRm9jdXMgPSBleHBvcnRzLmRpc2FibGVGb2N1cyA9IGV4cG9ydHMuYXBwZW5kSHRtbCA9IGV4cG9ydHMudG9Ob2RlTGlzdCA9IGV4cG9ydHMuZW1wdHkgPSBleHBvcnRzLmNyZWF0ZUVsZW1lbnQgPSB2b2lkIDA7XG5cbiAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KHRhZ05hbWUpIHtcbiAgICAgICAgICAgIHZhciBfcmVmODMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9LFxuICAgICAgICAgICAgICAgIGNsYXNzTGlzdCA9IF9yZWY4My5jbGFzc0xpc3QsXG4gICAgICAgICAgICAgICAgdGV4dCA9IF9yZWY4My50ZXh0LFxuICAgICAgICAgICAgICAgIGh0bWwgPSBfcmVmODMuaHRtbDtcblxuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuXG4gICAgICAgICAgICBpZiAoY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNsYXNzTGlzdCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2VsZW1lbnQkY2xhc3NMaXN0O1xuXG4gICAgICAgICAgICAgICAgKF9lbGVtZW50JGNsYXNzTGlzdCA9IGVsZW1lbnQuY2xhc3NMaXN0KS5hZGQuYXBwbHkoX2VsZW1lbnQkY2xhc3NMaXN0LCBfdG9Db25zdW1hYmxlQXJyYXkoY2xhc3NMaXN0KSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTGlzdCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRleHQpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGh0bWwpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmNyZWF0ZUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50O1xuXG4gICAgICAgICAgZnVuY3Rpb24gZW1wdHkoZG9tKSB7XG4gICAgICAgICAgICB2YXIgYztcblxuICAgICAgICAgICAgd2hpbGUgKGMgPSBkb20uZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICBkb20ucmVtb3ZlQ2hpbGQoYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5lbXB0eSA9IGVtcHR5O1xuXG4gICAgICAgICAgZnVuY3Rpb24gaXNOb2RlKGFyZykge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIHJldHVybiAhIShhcmcubm9kZVR5cGUgJiYgYXJnLm5vZGVOYW1lKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiB0b05vZGUoYXJnKSB7XG4gICAgICAgICAgICBpZiAoaXNOb2RlKGFyZykpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGFyZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGRvbSA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICAgICAgICBodG1sOiBhcmdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiB0b05vZGVMaXN0KGFyZykge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJnKSkge1xuICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgICAgICAgIGFyZy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2guYXBwbHkocmVzdWx0LCBfdG9Db25zdW1hYmxlQXJyYXkodG9Ob2RlTGlzdChlKSkpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG5vZGUgPSB0b05vZGUoYXJnKTtcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KG5vZGUpID8gbm9kZSA6IFtub2RlXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLnRvTm9kZUxpc3QgPSB0b05vZGVMaXN0O1xuXG4gICAgICAgICAgZnVuY3Rpb24gYXBwZW5kSHRtbChkb20sIGlubmVyKSB7XG4gICAgICAgICAgICB0b05vZGVMaXN0KGlubmVyKS5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgIGRvbS5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuYXBwZW5kSHRtbCA9IGFwcGVuZEh0bWw7XG5cbiAgICAgICAgICBmdW5jdGlvbiBkaXNhYmxlRm9jdXMoZWwpIHtcbiAgICAgICAgICAgIGVsLmRhdGFzZXQuZGlzYWJsZUJlZm9yZVRhYkluZGV4ID0gXCJcIi5jb25jYXQoZWwudGFiSW5kZXgpO1xuICAgICAgICAgICAgZWwudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGVsLmNoaWxkcmVuLCAwKS5mb3JFYWNoKGRpc2FibGVGb2N1cyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5kaXNhYmxlRm9jdXMgPSBkaXNhYmxlRm9jdXM7XG5cbiAgICAgICAgICBmdW5jdGlvbiBlbmFibGVGb2N1cyhlbCkge1xuICAgICAgICAgICAgaWYgKFwiZGlzYWJsZUJlZm9yZVRhYkluZGV4XCIgaW4gZWwuZGF0YXNldCkge1xuICAgICAgICAgICAgICBlbC50YWJJbmRleCA9IE51bWJlcihlbC5kYXRhc2V0LmRpc2FibGVCZWZvcmVUYWJJbmRleCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGVsLmNoaWxkcmVuLCAwKS5mb3JFYWNoKGVuYWJsZUZvY3VzKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmVuYWJsZUZvY3VzID0gZW5hYmxlRm9jdXM7XG5cbiAgICAgICAgICBmdW5jdGlvbiBpc0ZvY3VzYWJsZShlbCkge1xuICAgICAgICAgICAgcmV0dXJuIGVsLnRhYkluZGV4ICE9IG51bGwgJiYgZWwudGFiSW5kZXggPiAtMTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmlzRm9jdXNhYmxlID0gaXNGb2N1c2FibGU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBmaW5kUHJldlNpYmxpbmdGb2N1c2FibGUoZWwpIHtcbiAgICAgICAgICAgIHZhciBuID0gZWwucHJldmlvdXNTaWJsaW5nO1xuXG4gICAgICAgICAgICB3aGlsZSAobiAmJiAhaXNGb2N1c2FibGUobikpIHtcbiAgICAgICAgICAgICAgbiA9IG4ucHJldmlvdXNTaWJsaW5nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmZpbmRQcmV2U2libGluZ0ZvY3VzYWJsZSA9IGZpbmRQcmV2U2libGluZ0ZvY3VzYWJsZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGZpbmROZXh0U2libGluZ0ZvY3VzYWJsZShlbCkge1xuICAgICAgICAgICAgdmFyIG4gPSBlbC5uZXh0U2libGluZztcblxuICAgICAgICAgICAgd2hpbGUgKG4gJiYgIWlzRm9jdXNhYmxlKG4pKSB7XG4gICAgICAgICAgICAgIG4gPSBuLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmZpbmROZXh0U2libGluZ0ZvY3VzYWJsZSA9IGZpbmROZXh0U2libGluZ0ZvY3VzYWJsZTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9mb250cy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL2ZvbnRzLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxGb250c0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMubG9hZCA9IGV4cG9ydHMuY2hlY2sgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgbG9hZHMgPSB7fTtcbiAgICAgICAgICB2YXIgbG9hZDtcbiAgICAgICAgICBleHBvcnRzLmxvYWQgPSBsb2FkO1xuICAgICAgICAgIHZhciBjaGVjaztcbiAgICAgICAgICBleHBvcnRzLmNoZWNrID0gY2hlY2s7XG5cbiAgICAgICAgICBpZiAodXRpbHNfMS5pc05vZGUpIHtcbiAgICAgICAgICAgIGV4cG9ydHMubG9hZCA9IGxvYWQgPSBmdW5jdGlvbiBsb2FkKF9mb250LCBfdGVzdFN0ciwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGV4cG9ydHMuY2hlY2sgPSBjaGVjayA9IGZ1bmN0aW9uIGNoZWNrKCkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgdmFyIGZvbnRGYWNlU2V0ID0gZG9jdW1lbnQuZm9udHM7XG4gICAgICAgICAgICB2YXIgbGVnYWN5ID0gIWZvbnRGYWNlU2V0O1xuICAgICAgICAgICAgZXhwb3J0cy5sb2FkID0gbG9hZCA9IGxlZ2FjeSA/IGZ1bmN0aW9uIChmb250LCB0ZXN0U3RyLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICAvL2ZvciBsZWdhY3koSUUpXG4gICAgICAgICAgICAgIGlmIChsb2Fkc1tcIlwiLmNvbmNhdChmb250LCBcIiBAIFwiKS5jb25jYXQodGVzdFN0cildKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby12YXItcmVxdWlyZXNcblxuXG4gICAgICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgICAgIC8qISAuL2xlZ2FjeS9mb250d2F0Y2gvRm9udFdhdGNoUnVubmVyICovXG4gICAgICAgICAgICAgIFwiLi9pbnRlcm5hbC9sZWdhY3kvZm9udHdhdGNoL0ZvbnRXYXRjaFJ1bm5lci5qc1wiKS5sb2FkKGZvbnQsIHRlc3RTdHIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsb2Fkc1tcIlwiLmNvbmNhdChmb250LCBcIiBAIFwiKS5jb25jYXQodGVzdFN0cildID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbG9hZHNbXCJcIi5jb25jYXQoZm9udCwgXCIgQCBcIikuY29uY2F0KHRlc3RTdHIpXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IDogZnVuY3Rpb24gKGZvbnQsIF90ZXN0U3RyLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICBpZiAobG9hZHMuYWxsIHx8IGxvYWRzW2ZvbnRdKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBmb250RmFjZVNldC5yZWFkeS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsb2Fkcy5hbGwgPSB0cnVlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgZm9udEZhY2VTZXQubG9hZChmb250KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsb2Fkc1tmb250XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwb3J0cy5jaGVjayA9IGNoZWNrID0gbGVnYWN5ID8gZnVuY3Rpb24gKGZvbnQsIHRlc3RTdHIpIHtcbiAgICAgICAgICAgICAgLy9mb3IgbGVnYWN5KElFKVxuICAgICAgICAgICAgICBpZiAobG9hZHNbXCJcIi5jb25jYXQoZm9udCwgXCIgQCBcIikuY29uY2F0KHRlc3RTdHIpXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgbG9hZChmb250LCB0ZXN0U3RyLCBmdW5jdGlvbiAoKSB7fSk7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0gOiBmdW5jdGlvbiAoZm9udCwgdGVzdFN0cikge1xuICAgICAgICAgICAgICBpZiAobG9hZHMuYWxsIHx8IGxvYWRzW2ZvbnRdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoIWZvbnRGYWNlU2V0LmNoZWNrKGZvbnQpKSB7XG4gICAgICAgICAgICAgICAgbG9hZChmb250LCB0ZXN0U3RyLCBmdW5jdGlvbiAoKSB7fSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKioqL1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL2hpRFBJLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvaGlEUEkuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbEhpRFBJSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy50cmFuc2Zvcm0gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgRXZlbnRIYW5kbGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0V2ZW50SGFuZGxlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9FdmVudEhhbmRsZXIuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgaGFuZGxlciA9IG5ldyBFdmVudEhhbmRsZXJfMS5FdmVudEhhbmRsZXIoKTtcbiAgICAgICAgICB2YXIgcmF0aW8gPSAxO1xuXG4gICAgICAgICAgZnVuY3Rpb24gc2V0UmF0aW8oKSB7XG4gICAgICAgICAgICBpZiAodXRpbHNfMS5pc05vZGUpIHtcbiAgICAgICAgICAgICAgcmF0aW8gPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmF0aW8gPSBNYXRoLmNlaWwod2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMSk7XG5cbiAgICAgICAgICAgICAgaWYgKHJhdGlvID4gMSAmJiByYXRpbyAlIDIgIT09IDApIHtcbiAgICAgICAgICAgICAgICByYXRpbyArPSAxO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc2V0UmF0aW8oKTtcblxuICAgICAgICAgIGlmICghdXRpbHNfMS5pc05vZGUpIHtcbiAgICAgICAgICAgIGhhbmRsZXIub24od2luZG93LCBcInJlc2l6ZVwiLCBzZXRSYXRpbyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdHJhbnNmb3JtKGNhbnZhcykge1xuICAgICAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICAgICAgICB2YXIgZ2V0QXR0cmlidXRlID0gY2FudmFzLmdldEF0dHJpYnV0ZSxcbiAgICAgICAgICAgICAgICBzZXRBdHRyaWJ1dGUgPSBjYW52YXMuc2V0QXR0cmlidXRlO1xuXG4gICAgICAgICAgICBjYW52YXMuZ2V0QXR0cmlidXRlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGdldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpO1xuXG4gICAgICAgICAgICAgIGlmIChuYW1lID09PSBcIndpZHRoXCIgfHwgbmFtZSA9PT0gXCJoZWlnaHRcIikge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiXCIuY29uY2F0KE51bWJlcihyZXN1bHQpIC8gcmF0aW8pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobmFtZSwgdmFsKSB7XG4gICAgICAgICAgICAgIHZhciB3aCA9IG5hbWUgPT09IFwid2lkdGhcIiB8fCBuYW1lID09PSBcImhlaWdodFwiO1xuXG4gICAgICAgICAgICAgIGlmICh3aCkge1xuICAgICAgICAgICAgICAgIHZhbCA9IFwiXCIuY29uY2F0KE51bWJlcih2YWwpICogcmF0aW8pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUsIHZhbCk7XG5cbiAgICAgICAgICAgICAgaWYgKHdoKSB7XG4gICAgICAgICAgICAgICAgY3R4LnNjYWxlKHJhdGlvLCByYXRpbyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNhbnZhcywgXCJ3aWR0aFwiLCB7XG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBOdW1iZXIoY2FudmFzLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsKSB7XG4gICAgICAgICAgICAgICAgY2FudmFzLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIFwiXCIuY29uY2F0KE1hdGguZmxvb3IodmFsKSkpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNhbnZhcywgXCJoZWlnaHRcIiwge1xuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKGNhbnZhcy5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWwpIHtcbiAgICAgICAgICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsIFwiXCIuY29uY2F0KE1hdGguZmxvb3IodmFsKSkpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGRyYXdJbWFnZSA9IGN0eC5kcmF3SW1hZ2U7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UgPSBmdW5jdGlvbiAoaW1nKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIF9sZW4xMCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjEwID4gMSA/IF9sZW4xMCAtIDEgOiAwKSwgX2tleTEwID0gMTsgX2tleTEwIDwgX2xlbjEwOyBfa2V5MTArKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2tleTEwIC0gMV0gPSBhcmd1bWVudHNbX2tleTEwXTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChpbWcgIT09IGNhbnZhcyB8fCByYXRpbyA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkcmF3SW1hZ2UuY2FsbC5hcHBseShkcmF3SW1hZ2UsIFt0aGlzLCBpbWddLmNvbmNhdChhcmdzKSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0aGlzLnNhdmUoKTtcblxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2NhbGUoMSAvIHJhdGlvLCAxIC8gcmF0aW8pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gNCkge1xuICAgICAgICAgICAgICAgICAgYXJnc1s0XSAqPSByYXRpbztcbiAgICAgICAgICAgICAgICAgIGFyZ3NbNV0gKj0gcmF0aW87XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbMF0gKj0gcmF0aW87XG4gICAgICAgICAgICAgICAgICBhcmdzWzFdICo9IHJhdGlvO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBkcmF3SW1hZ2UuY2FsbC5hcHBseShkcmF3SW1hZ2UsIFt0aGlzLCBpbWddLmNvbmNhdChhcmdzKSk7XG4gICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiBjYW52YXM7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaW50ZXJuYWwvaWNvbnMuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9pbnRlcm5hbC9pY29ucy5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGludGVybmFsSWNvbnNKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLmljb25Qcm9wS2V5cyA9IGV4cG9ydHMudG9Ob3JtYWxpemVBcnJheSA9IGV4cG9ydHMuZ2V0SWNvblByb3BzID0gdm9pZCAwO1xuICAgICAgICAgIHZhciBJQ09OX1BST1BfS0VZUyA9IFtcImNvbnRlbnRcIiwgXCJmb250XCIsIFwiY29sb3JcIiwgXCJjbGFzc05hbWVcIiwgXCJ0YWdOYW1lXCIsIFwiaXNMaWdhXCIsIFwid2lkdGhcIiwgXCJzcmNcIiwgXCJzdmdcIiwgXCJuYW1lXCIsIFwicGF0aFwiLCBcIm9mZnNldFRvcFwiLCBcIm9mZnNldExlZnRcIl07XG5cbiAgICAgICAgICBmdW5jdGlvbiBxdW90ZShuYW1lKSB7XG4gICAgICAgICAgICB2YXIgcXVvdGVkID0gW107XG4gICAgICAgICAgICB2YXIgc3BsaXQgPSBuYW1lLnNwbGl0KC8sXFxzKi8pO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwbGl0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBwYXJ0ID0gc3BsaXRbaV0ucmVwbGFjZSgvWydcIl0vZywgXCJcIik7XG5cbiAgICAgICAgICAgICAgaWYgKHBhcnQuaW5kZXhPZihcIiBcIikgPT09IC0xICYmICEvXlxcZC8udGVzdChwYXJ0KSkge1xuICAgICAgICAgICAgICAgIHF1b3RlZC5wdXNoKHBhcnQpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHF1b3RlZC5wdXNoKFwiJ1wiLmNvbmNhdChwYXJ0LCBcIidcIikpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBxdW90ZWQuam9pbihcIixcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGRvbXMgPSB7fTtcbiAgICAgICAgICB2YXIgcHJvcHMgPSB7fTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldEljb25Qcm9wcyh0YWdOYW1lLCBjbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHZhciB0YWdQcm9wcyA9IHByb3BzW3RhZ05hbWVdIHx8IChwcm9wc1t0YWdOYW1lXSA9IHt9KTtcblxuICAgICAgICAgICAgaWYgKHRhZ1Byb3BzW2NsYXNzTmFtZV0pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRhZ1Byb3BzW2NsYXNzTmFtZV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkb20gPSBkb21zW3RhZ05hbWVdIHx8IChkb21zW3RhZ05hbWVdID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKSk7IC8vIGBjbGFzc0xpc3QuYWRkKClgIGNhbm5vdCBiZSB1c2VkIGJlY2F1c2UgaXQgbWF5IGJlIHNlcGFyYXRlZCBieSBzcGFjZXMuXG5cbiAgICAgICAgICAgIGRvbS5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgICAgICAgICBkb20uY2xhc3NMaXN0LmFkZChcImNoZWV0YWgtZ3JpZC1pY29uXCIpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkb20pO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICB2YXIgYmVmb3JlU3R5bGUgPSAoZG9jdW1lbnQuZGVmYXVsdFZpZXcgfHwgd2luZG93KS5nZXRDb21wdXRlZFN0eWxlKGRvbSwgXCI6OmJlZm9yZVwiKTtcbiAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBiZWZvcmVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwiY29udGVudFwiKTtcblxuICAgICAgICAgICAgICBpZiAoY29udGVudC5sZW5ndGggPj0gMyAmJiAoY29udGVudFswXSA9PT0gJ1wiJyB8fCBjb250ZW50WzBdID09PSBcIidcIikpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudFswXSA9PT0gY29udGVudFtjb250ZW50Lmxlbmd0aCAtIDFdKSB7XG4gICAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5zbGljZSgxLCAtMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIGZvbnQgPSBiZWZvcmVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwiZm9udFwiKTtcblxuICAgICAgICAgICAgICBpZiAoIWZvbnQpIHtcbiAgICAgICAgICAgICAgICBmb250ID0gXCJcIi5jb25jYXQoYmVmb3JlU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcImZvbnQtc3R5bGVcIiksIFwiIFwiKS5jb25jYXQoYmVmb3JlU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcImZvbnQtdmFyaWFudFwiKSwgXCIgXCIpLmNvbmNhdChiZWZvcmVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwiZm9udC13ZWlnaHRcIiksIFwiIFwiKS5jb25jYXQoYmVmb3JlU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcImZvbnQtc2l6ZVwiKSwgXCIvXCIpLmNvbmNhdChiZWZvcmVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwibGluZS1oZWlnaHRcIiksIFwiIFwiKS5jb25jYXQocXVvdGUoYmVmb3JlU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcImZvbnQtZmFtaWx5XCIpKSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgY29sb3IgPSBiZWZvcmVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwiY29sb3JcIik7XG4gICAgICAgICAgICAgIHZhciB3aWR0aCA9IGRvbS5jbGllbnRXaWR0aDtcbiAgICAgICAgICAgICAgdmFyIGlzTGlnYSA9IChiZWZvcmVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwiZm9udC1mZWF0dXJlLXNldHRpbmdzXCIpIHx8IFwiXCIpLmluZGV4T2YoXCJsaWdhXCIpID4gLTE7XG4gICAgICAgICAgICAgIHJldHVybiB0YWdQcm9wc1tjbGFzc05hbWVdID0ge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZm9udDogZm9udCxcbiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3IsXG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgICAgIGlzTGlnYTogaXNMaWdhXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGRvbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5nZXRJY29uUHJvcHMgPSBnZXRJY29uUHJvcHM7XG5cbiAgICAgICAgICBmdW5jdGlvbiB0b1Byb3BBcnJheShwcm9wLCBjb3VudCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wKSkge1xuICAgICAgICAgICAgICByZXN1bHQucHVzaC5hcHBseShyZXN1bHQsIF90b0NvbnN1bWFibGVBcnJheShwcm9wKSk7XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHByb3AubGVuZ3RoOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG51bGwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBmb3IgKHZhciBfaTMgPSAwOyBfaTMgPCBjb3VudDsgX2kzKyspIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChwcm9wKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIHRvU2ltcGxlQXJyYXkoaWNvblByb3BzKSB7XG4gICAgICAgICAgICBpZiAoIWljb25Qcm9wcykge1xuICAgICAgICAgICAgICByZXR1cm4gaWNvblByb3BzO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGljb25Qcm9wcykpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGljb25Qcm9wcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHdvcmtEYXRhID0ge307XG4gICAgICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICAgICAgSUNPTl9QUk9QX0tFWVMuZm9yRWFjaChmdW5jdGlvbiAoaykge1xuICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICB2YXIgcHJvcCA9IGljb25Qcm9wc1trXTtcblxuICAgICAgICAgICAgICBpZiAocHJvcCkge1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHByb3ApKSB7XG4gICAgICAgICAgICAgICAgICBjb3VudCA9IE1hdGgubWF4KGNvdW50LCBwcm9wLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGNvdW50ID0gTWF0aC5tYXgoY291bnQsIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBJQ09OX1BST1BfS0VZUy5mb3JFYWNoKGZ1bmN0aW9uIChrKSB7XG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHZhciBhcnIgPSB0b1Byb3BBcnJheShpY29uUHJvcHNba10sIGNvdW50KTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgICB3b3JrRGF0YVtrXSA9IGFycjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgICAgICAgICB2YXIgX2xvb3A2ID0gZnVuY3Rpb24gX2xvb3A2KGkpIHtcbiAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgSUNPTl9QUk9QX0tFWVMuZm9yRWFjaChmdW5jdGlvbiAoaykge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgdmFyIHZhbCA9IHdvcmtEYXRhW2tdW2ldOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gICAgICAgICAgICAgICAgZGF0YVtrXSA9IHZhbDtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgIF9sb29wNihpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemUoaWNvblByb3BzKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIGljb25Qcm9wcykge1xuICAgICAgICAgICAgICBpZiAoayA9PT0gXCJjbGFzc05hbWVcIikge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGlzSWNvbktleShrKSkge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgZGF0YVtrXSA9IGljb25Qcm9wc1trXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaWNvblByb3BzLmNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICB2YXIgcHJvcCA9IGdldEljb25Qcm9wcyhpY29uUHJvcHMudGFnTmFtZSB8fCBcImlcIiwgaWNvblByb3BzLmNsYXNzTmFtZSk7XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgX2syIGluIHByb3ApIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNJY29uS2V5KF9rMikpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChpY29uUHJvcHNbX2syXSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbX2syXSA9IHByb3BbX2syXTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdG9Ob3JtYWxpemVBcnJheShpY29uUHJvcHMpIHtcbiAgICAgICAgICAgIHZhciBpY29ucyA9IHRvU2ltcGxlQXJyYXkoaWNvblByb3BzKTtcblxuICAgICAgICAgICAgaWYgKCFpY29ucykge1xuICAgICAgICAgICAgICByZXR1cm4gaWNvbnM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBpY29ucy5tYXAoZnVuY3Rpb24gKGljb24pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZShpY29uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMudG9Ob3JtYWxpemVBcnJheSA9IHRvTm9ybWFsaXplQXJyYXk7XG4gICAgICAgICAgZXhwb3J0cy5pY29uUHJvcEtleXMgPSBJQ09OX1BST1BfS0VZUztcblxuICAgICAgICAgIGZ1bmN0aW9uIGlzSWNvbktleShrKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgcmV0dXJuIElDT05fUFJPUF9LRVlTLmluZGV4T2YoaykgPj0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqKi9cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9pbWdzLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9pbnRlcm5hbC9pbWdzLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbEltZ3NKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLmdldENhY2hlT3JMb2FkID0gZXhwb3J0cy5sb2FkSW1hZ2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgTFJVQ2FjaGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vTFJVQ2FjaGUgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvTFJVQ2FjaGUuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgYWxsQ2FjaGUgPSB7fTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGxvYWRJbWFnZShzcmMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgUHJvbWlzZSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUHJvbWlzZSBpcyBub3QgbG9hZGVkLiBsb2FkIFByb21pc2UgYmVmb3JlIHRoaXMgcHJvY2Vzcy5cIik7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGhlbjogZnVuY3Rpb24gdGhlbigpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGltZyk7XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaW1nLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHZhciB1cmwgPSBzcmMubGVuZ3RoID4gMjAwID8gXCJcIi5jb25jYXQoc3JjLnNsaWNlKDAsIDIwMCksIFwiLi4uXCIpIDogc3JjO1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJjYW5ub3QgbG9hZDogXCIuY29uY2F0KHVybCkpO1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJTUFHRSBMT0FEIEVSUk9SOiBcIi5jb25jYXQodXJsKSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpbWcuc3JjID0gc3JjO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmxvYWRJbWFnZSA9IGxvYWRJbWFnZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldENhY2hlT3JMb2FkMChjYWNoZSwgc3JjKSB7XG4gICAgICAgICAgICByZXR1cm4gKDAsIHV0aWxzXzEudGhlbikoc3JjLCBmdW5jdGlvbiAoc3JjKSB7XG4gICAgICAgICAgICAgIHZhciBjID0gY2FjaGUuZ2V0KHNyYyk7XG5cbiAgICAgICAgICAgICAgaWYgKGMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciByZXN1bHQgPSBsb2FkSW1hZ2Uoc3JjKS50aGVuKGZ1bmN0aW9uIChpbWcpIHtcbiAgICAgICAgICAgICAgICBjYWNoZS5wdXQoc3JjLCBpbWcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpbWc7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBjYWNoZS5wdXQoc3JjLCByZXN1bHQpO1xuICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0Q2FjaGVPckxvYWQoY2FjaGVOYW1lLCBjYWNoZVNpemUsIHNyYykge1xuICAgICAgICAgICAgdmFyIGNhY2hlID0gYWxsQ2FjaGVbY2FjaGVOYW1lXSB8fCAoYWxsQ2FjaGVbY2FjaGVOYW1lXSA9IG5ldyBMUlVDYWNoZV8xLkxSVUNhY2hlKGNhY2hlU2l6ZSkpO1xuICAgICAgICAgICAgcmV0dXJuIGdldENhY2hlT3JMb2FkMChjYWNoZSwgc3JjKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmdldENhY2hlT3JMb2FkID0gZ2V0Q2FjaGVPckxvYWQ7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaW50ZXJuYWwvbGVnYWN5L2NhbnZhcy9QYXRoMkRTaGltLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL2xlZ2FjeS9jYW52YXMvUGF0aDJEU2hpbS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbExlZ2FjeUNhbnZhc1BhdGgyRFNoaW1Kcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlBhdGgyRFNoaW0gPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgUGF0aENvbW1hbmRzUGFyc2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL1BhdGhDb21tYW5kc1BhcnNlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9sZWdhY3kvY2FudmFzL1BhdGhDb21tYW5kc1BhcnNlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgUGF0aENvbW1hbmRzUGFyc2VyXzEuUGF0aENvbW1hbmRzUGFyc2VyKCk7XG5cbiAgICAgICAgICB2YXIgUGF0aDJEU2hpbSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBQYXRoMkRTaGltKGFyZykge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGF0aDJEU2hpbSk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fb3BzID0gW107XG5cbiAgICAgICAgICAgICAgaWYgKGFyZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAvLyB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wcyA9IHBhcnNlci5wYXJzZShhcmcpOyAvLyB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gXHR0aHJvdyBlO1xuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChhcmcuaGFzT3duUHJvcGVydHkoXCJfb3BzXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb3BzID0gX3RvQ29uc3VtYWJsZUFycmF5KGFyZy5fb3BzKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFcnJvcjogXCIuY29uY2F0KF90eXBlb2YoYXJnKSwgXCIgaXMgbm90IGEgdmFsaWQgYXJndW1lbnQgdG8gUGF0aFwiKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFBhdGgyRFNoaW0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJhcmNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFyYygpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfbGVuMTEgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4xMSksIF9rZXkxMSA9IDA7IF9rZXkxMSA8IF9sZW4xMTsgX2tleTExKyspIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTExXSA9IGFyZ3VtZW50c1tfa2V5MTFdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX29wcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIG9wOiBcImFyY1wiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhcmNUb1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXJjVG8oKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjEyID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMTIpLCBfa2V5MTIgPSAwOyBfa2V5MTIgPCBfbGVuMTI7IF9rZXkxMisrKSB7XG4gICAgICAgICAgICAgICAgICBhcmdzW19rZXkxMl0gPSBhcmd1bWVudHNbX2tleTEyXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9vcHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICBvcDogXCJhcmNUb1wiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJiZXppZXJDdXJ2ZVRvXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiZXppZXJDdXJ2ZVRvKCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW4xMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjEzKSwgX2tleTEzID0gMDsgX2tleTEzIDwgX2xlbjEzOyBfa2V5MTMrKykge1xuICAgICAgICAgICAgICAgICAgYXJnc1tfa2V5MTNdID0gYXJndW1lbnRzW19rZXkxM107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgb3A6IFwiYmV6aWVyQ3VydmVUb1wiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjbG9zZVBhdGhcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlUGF0aCgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfbGVuMTQgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4xNCksIF9rZXkxNCA9IDA7IF9rZXkxNCA8IF9sZW4xNDsgX2tleTE0KyspIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTE0XSA9IGFyZ3VtZW50c1tfa2V5MTRdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX29wcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIG9wOiBcImNsb3NlUGF0aFwiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJlbGxpcHNlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbGxpcHNlKCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW4xNSA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjE1KSwgX2tleTE1ID0gMDsgX2tleTE1IDwgX2xlbjE1OyBfa2V5MTUrKykge1xuICAgICAgICAgICAgICAgICAgYXJnc1tfa2V5MTVdID0gYXJndW1lbnRzW19rZXkxNV07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgb3A6IFwiZWxsaXBzZVwiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJsaW5lVG9cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxpbmVUbygpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfbGVuMTYgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4xNiksIF9rZXkxNiA9IDA7IF9rZXkxNiA8IF9sZW4xNjsgX2tleTE2KyspIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTE2XSA9IGFyZ3VtZW50c1tfa2V5MTZdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX29wcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIG9wOiBcImxpbmVUb1wiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJtb3ZlVG9cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVUbygpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfbGVuMTcgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4xNyksIF9rZXkxNyA9IDA7IF9rZXkxNyA8IF9sZW4xNzsgX2tleTE3KyspIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTE3XSA9IGFyZ3VtZW50c1tfa2V5MTddO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX29wcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIG9wOiBcIm1vdmVUb1wiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJxdWFkcmF0aWNDdXJ2ZVRvXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBxdWFkcmF0aWNDdXJ2ZVRvKCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW4xOCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjE4KSwgX2tleTE4ID0gMDsgX2tleTE4IDwgX2xlbjE4OyBfa2V5MTgrKykge1xuICAgICAgICAgICAgICAgICAgYXJnc1tfa2V5MThdID0gYXJndW1lbnRzW19rZXkxOF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgb3A6IFwicXVhZHJhdGljQ3VydmVUb1wiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJyZWN0XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWN0KCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW4xOSA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjE5KSwgX2tleTE5ID0gMDsgX2tleTE5IDwgX2xlbjE5OyBfa2V5MTkrKykge1xuICAgICAgICAgICAgICAgICAgYXJnc1tfa2V5MTldID0gYXJndW1lbnRzW19rZXkxOV07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgb3A6IFwicmVjdFwiLFxuICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJyb3VuZFJlY3RcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJvdW5kUmVjdChfeCwgX3ksIF93LCBfaCwgX3JhZGlpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC5cIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFBhdGgyRFNoaW07XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5QYXRoMkRTaGltID0gUGF0aDJEU2hpbTtcbiAgICAgICAgICB2YXIgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gd2luZG93LkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcbiAgICAgICAgICB2YXIgb3JpZ2luYWxGaWxsID0gQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELnByb3RvdHlwZS5maWxsOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gICAgICAgICAgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMTAyID0gdGhpcztcblxuICAgICAgICAgICAgZm9yICh2YXIgX2xlbjIwID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMjApLCBfa2V5MjAgPSAwOyBfa2V5MjAgPCBfbGVuMjA7IF9rZXkyMCsrKSB7XG4gICAgICAgICAgICAgIGFyZ3NbX2tleTIwXSA9IGFyZ3VtZW50c1tfa2V5MjBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYXJnc1swXSBpbnN0YW5jZW9mIFBhdGgyRFNoaW0pIHtcbiAgICAgICAgICAgICAgdmFyIHBhdGggPSBhcmdzWzBdO1xuICAgICAgICAgICAgICB0aGlzLmJlZ2luUGF0aCgpO1xuXG4gICAgICAgICAgICAgIHBhdGguX29wcy5mb3JFYWNoKGZ1bmN0aW9uIChvcCkge1xuICAgICAgICAgICAgICAgIHZhciBmbiA9IF90aGlzMTAyW29wLm9wXTtcbiAgICAgICAgICAgICAgICBmbi5hcHBseShfdGhpczEwMiwgb3AuYXJncyk7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIG9yaWdpbmFsRmlsbC5hcHBseSh0aGlzLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmdzLCAxKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBvcmlnaW5hbEZpbGwuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICAvKioqL1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL2xlZ2FjeS9jYW52YXMvUGF0aENvbW1hbmRzLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvbGVnYWN5L2NhbnZhcy9QYXRoQ29tbWFuZHMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbExlZ2FjeUNhbnZhc1BhdGhDb21tYW5kc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuUGF0aENvbW1hbmRzID0gdm9pZCAwO1xuICAgICAgICAgIC8qZXNsaW50IG5ldy1jYXA6IFwib2ZmXCIqL1xuXG4gICAgICAgICAgZnVuY3Rpb24gbWFnKHYpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3codlswXSwgMikgKyBNYXRoLnBvdyh2WzFdLCAyKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZG90KHUsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiB1WzBdICogdlswXSArIHVbMV0gKiB2WzFdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIHJhdGlvKHUsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiBkb3QodSwgdikgLyAobWFnKHUpICogbWFnKHYpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBjbGFtcCh2YWx1ZSwgbWluLCBtYXgpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heCh2YWx1ZSwgbWluKSwgbWF4KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBhbmdsZSh1LCB2KSB7XG4gICAgICAgICAgICB2YXIgc2lnbiA9IDEuMDtcblxuICAgICAgICAgICAgaWYgKHVbMF0gKiB2WzFdIC0gdVsxXSAqIHZbMF0gPCAwKSB7XG4gICAgICAgICAgICAgIHNpZ24gPSAtMS4wO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc2lnbiAqIE1hdGguYWNvcyhjbGFtcChyYXRpbyh1LCB2KSwgLTEsIDEpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiByb3RDbG9ja3dpc2UodiwgYW5nbGUpIHtcbiAgICAgICAgICAgIHZhciBjb3N0ID0gTWF0aC5jb3MoYW5nbGUpO1xuICAgICAgICAgICAgdmFyIHNpbnQgPSBNYXRoLnNpbihhbmdsZSk7XG4gICAgICAgICAgICByZXR1cm4gW2Nvc3QgKiB2WzBdICsgc2ludCAqIHZbMV0sIC0xICogc2ludCAqIHZbMF0gKyBjb3N0ICogdlsxXV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gcm90Q291bnRlckNsb2Nrd2lzZSh2LCBhbmdsZSkge1xuICAgICAgICAgICAgdmFyIGNvc3QgPSBNYXRoLmNvcyhhbmdsZSk7XG4gICAgICAgICAgICB2YXIgc2ludCA9IE1hdGguc2luKGFuZ2xlKTtcbiAgICAgICAgICAgIHJldHVybiBbY29zdCAqIHZbMF0gLSBzaW50ICogdlsxXSwgc2ludCAqIHZbMF0gKyBjb3N0ICogdlsxXV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gbWlkUG9pbnQodSwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFsodVswXSAtIHZbMF0pIC8gMi4wLCAodVsxXSAtIHZbMV0pIC8gMi4wXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBtZWFuVmVjKHUsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiBbKHVbMF0gKyB2WzBdKSAvIDIuMCwgKHVbMV0gKyB2WzFdKSAvIDIuMF07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gcG9pbnRNdWwodSwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt1WzBdICogdlswXSwgdVsxXSAqIHZbMV1dO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIHNjYWxlKGMsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiBbYyAqIHZbMF0sIGMgKiB2WzFdXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBzdW0odSwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt1WzBdICsgdlswXSwgdVsxXSArIHZbMV1dO1xuICAgICAgICAgIH0gLy8gQ29udmVydCBhbiBTVkcgZWxsaXB0aWNhbCBhcmMgdG8gYSBzZXJpZXMgb2YgY2FudmFzIGNvbW1hbmRzLlxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8geDEsIHkxLCB4MiwgeTI6IHN0YXJ0IGFuZCBzdG9wIGNvb3JkaW5hdGVzIG9mIHRoZSBlbGxpcHNlLlxuICAgICAgICAgIC8vIHJ4LCByeTogcmFkaWkgb2YgdGhlIGVsbGlwc2UuXG4gICAgICAgICAgLy8gcGhpOiByb3RhdGlvbiBvZiB0aGUgZWxsaXBzZS5cbiAgICAgICAgICAvLyBmQTogbGFyZ2UgYXJjIGZsYWcuXG4gICAgICAgICAgLy8gZlM6IHN3ZWVwIGZsYWcuXG5cblxuICAgICAgICAgIGZ1bmN0aW9uIGVsbGlwc2VGcm9tRWxsaXB0aWNhbEFyYyhjdHgsIHgxLCB5MSwgcngsIHJ5LCBwaGksIGZBLCBmUywgeDIsIHkyKSB7XG4gICAgICAgICAgICAvLyBDb252ZXJ0IGZyb20gZW5kcG9pbnQgdG8gY2VudGVyIHBhcmFtZXRyaXphdGlvbiwgYXMgZGV0YWlsZWQgaW46XG4gICAgICAgICAgICAvLyAgIGh0dHA6Ly93d3cudzMub3JnL1RSL1NWRy9pbXBsbm90ZS5odG1sI0FyY0ltcGxlbWVudGF0aW9uTm90ZXNcbiAgICAgICAgICAgIGlmIChyeCA9PT0gMCB8fCByeSA9PT0gMCkge1xuICAgICAgICAgICAgICBjdHgubGluZVRvKHgyLCB4MSk7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGhpICo9IE1hdGguUEkgLyAxODAuMDtcbiAgICAgICAgICAgIHJ4ID0gTWF0aC5hYnMocngpO1xuICAgICAgICAgICAgcnkgPSBNYXRoLmFicyhyeSk7XG4gICAgICAgICAgICB2YXIgeFByaW1lID0gcm90Q2xvY2t3aXNlKG1pZFBvaW50KFt4MSwgeTFdLCBbeDIsIHkyXSksIHBoaSk7IC8vIEYuNi41LjFcblxuICAgICAgICAgICAgdmFyIHhQcmltZTIgPSBwb2ludE11bCh4UHJpbWUsIHhQcmltZSk7XG4gICAgICAgICAgICB2YXIgcngyID0gTWF0aC5wb3cocngsIDIpO1xuICAgICAgICAgICAgdmFyIHJ5MiA9IE1hdGgucG93KHJ5LCAyKTtcbiAgICAgICAgICAgIHZhciBsYW1iZGEgPSBNYXRoLnNxcnQoeFByaW1lMlswXSAvIHJ4MiArIHhQcmltZTJbMV0gLyByeTIpO1xuXG4gICAgICAgICAgICBpZiAobGFtYmRhID4gMSkge1xuICAgICAgICAgICAgICByeCAqPSBsYW1iZGE7XG4gICAgICAgICAgICAgIHJ5ICo9IGxhbWJkYTtcbiAgICAgICAgICAgICAgcngyID0gTWF0aC5wb3cocngsIDIpO1xuICAgICAgICAgICAgICByeTIgPSBNYXRoLnBvdyhyeSwgMik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBmYWN0b3IgPSBNYXRoLnNxcnQoTWF0aC5hYnMocngyICogcnkyIC0gcngyICogeFByaW1lMlsxXSAtIHJ5MiAqIHhQcmltZTJbMF0pIC8gKHJ4MiAqIHhQcmltZTJbMV0gKyByeTIgKiB4UHJpbWUyWzBdKSk7XG5cbiAgICAgICAgICAgIGlmIChmQSA9PT0gZlMpIHtcbiAgICAgICAgICAgICAgZmFjdG9yICo9IC0xLjA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjUHJpbWUgPSBzY2FsZShmYWN0b3IsIFtyeCAqIHhQcmltZVsxXSAvIHJ5LCAtcnkgKiB4UHJpbWVbMF0gLyByeF0pOyAvLyBGLjYuNS4yXG5cbiAgICAgICAgICAgIHZhciBjID0gc3VtKHJvdENvdW50ZXJDbG9ja3dpc2UoY1ByaW1lLCBwaGkpLCBtZWFuVmVjKFt4MSwgeTFdLCBbeDIsIHkyXSkpOyAvLyBGLjYuNS4zXG5cbiAgICAgICAgICAgIHZhciB4MVVuaXRWZWN0b3IgPSBbKHhQcmltZVswXSAtIGNQcmltZVswXSkgLyByeCwgKHhQcmltZVsxXSAtIGNQcmltZVsxXSkgLyByeV07XG4gICAgICAgICAgICB2YXIgeDJVbml0VmVjdG9yID0gWygtMS4wICogeFByaW1lWzBdIC0gY1ByaW1lWzBdKSAvIHJ4LCAoLTEuMCAqIHhQcmltZVsxXSAtIGNQcmltZVsxXSkgLyByeV07XG4gICAgICAgICAgICB2YXIgdGhldGEgPSBhbmdsZShbMSwgMF0sIHgxVW5pdFZlY3Rvcik7IC8vIEYuNi41LjVcblxuICAgICAgICAgICAgdmFyIGRlbHRhVGhldGEgPSBhbmdsZSh4MVVuaXRWZWN0b3IsIHgyVW5pdFZlY3Rvcik7IC8vIEYuNi41LjZcblxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gdGhldGE7XG4gICAgICAgICAgICB2YXIgZW5kID0gdGhldGEgKyBkZWx0YVRoZXRhO1xuICAgICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoY1swXSwgY1sxXSk7XG4gICAgICAgICAgICBjdHgucm90YXRlKHBoaSk7XG4gICAgICAgICAgICBjdHguc2NhbGUocngsIHJ5KTtcbiAgICAgICAgICAgIGN0eC5hcmMoMCwgMCwgMSwgc3RhcnQsIGVuZCwgIWZTKTtcbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIFBhdGhDb21tYW5kcyA9IGZ1bmN0aW9uIFBhdGhDb21tYW5kcyhjdHgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczEwMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQYXRoQ29tbWFuZHMpO1xuXG4gICAgICAgICAgICB2YXIgbE14O1xuICAgICAgICAgICAgdmFyIGxNeTtcbiAgICAgICAgICAgIHZhciBseCA9IDA7XG4gICAgICAgICAgICB2YXIgbHkgPSAwO1xuICAgICAgICAgICAgdmFyIHJlZmxlY3RlZDtcbiAgICAgICAgICAgIHZhciBsYXN0Q29tbWFuZCA9IFwiXCI7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1ha2VSZWZsZWN0ZWQoKSB7XG4gICAgICAgICAgICAgIGlmIChcIkNjU3NRcVR0XCIuaW5kZXhPZihsYXN0Q29tbWFuZCkgPCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIHg6IGx4LFxuICAgICAgICAgICAgICAgICAgeTogbHlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHJlZmxlY3RlZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5NID0gZnVuY3Rpb24gKHB4LCBweSkge1xuICAgICAgICAgICAgICBjdHgubW92ZVRvKHB4LCBweSk7XG4gICAgICAgICAgICAgIGxNeCA9IHB4O1xuICAgICAgICAgICAgICBsTXkgPSBweTtcbiAgICAgICAgICAgICAgbHggPSBweDtcbiAgICAgICAgICAgICAgbHkgPSBweTtcbiAgICAgICAgICAgICAgbGFzdENvbW1hbmQgPSBcIk1cIjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5tID0gZnVuY3Rpb24gKHB4LCBweSkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDMuTShweCArIGx4LCBweSArIGx5KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuTCA9IGZ1bmN0aW9uIChweCwgcHkpIHtcbiAgICAgICAgICAgICAgY3R4LmxpbmVUbyhweCwgcHkpO1xuICAgICAgICAgICAgICBseCA9IHB4O1xuICAgICAgICAgICAgICBseSA9IHB5O1xuICAgICAgICAgICAgICBsYXN0Q29tbWFuZCA9IFwiTFwiO1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDM7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmwgPSBmdW5jdGlvbiAocHgsIHB5KSB7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczEwMy5MKHB4ICsgbHgsIHB5ICsgbHkpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5IID0gZnVuY3Rpb24gKHB4KSB7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczEwMy5MKHB4LCBseSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmggPSBmdW5jdGlvbiAocHgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzLkgocHggKyBseCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLlYgPSBmdW5jdGlvbiAocHkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzLkwobHgsIHB5KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMudiA9IGZ1bmN0aW9uIChweSkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDMuVihweSArIGx5KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuWiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgICBseCA9IGxNeDtcbiAgICAgICAgICAgICAgbHkgPSBsTXk7XG4gICAgICAgICAgICAgIGxhc3RDb21tYW5kID0gXCJaXCI7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczEwMztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMueiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzLlooKTtcbiAgICAgICAgICAgIH07IC8vQyB4MSB5MSwgeDIgeTIsIHggeSAob3IgYyBkeDEgZHkxLCBkeDIgZHkyLCBkeCBkeSlcblxuXG4gICAgICAgICAgICB0aGlzLkMgPSBmdW5jdGlvbiAoY3AxeCwgY3AxeSwgY3AyeCwgY3AyeSwgcHgsIHB5KSB7XG4gICAgICAgICAgICAgIGN0eC5iZXppZXJDdXJ2ZVRvKGNwMXgsIGNwMXksIGNwMngsIGNwMnksIHB4LCBweSk7XG4gICAgICAgICAgICAgIGx4ID0gcHg7XG4gICAgICAgICAgICAgIGx5ID0gcHk7XG4gICAgICAgICAgICAgIHJlZmxlY3RlZCA9IHtcbiAgICAgICAgICAgICAgICB4OiAyICogcHggLSBjcDJ4LFxuICAgICAgICAgICAgICAgIHk6IDIgKiBweSAtIGNwMnlcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgbGFzdENvbW1hbmQgPSBcIkNcIjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5jID0gZnVuY3Rpb24gKGNwMXgsIGNwMXksIGNwMngsIGNwMnksIHB4LCBweSkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDMuQyhjcDF4ICsgbHgsIGNwMXkgKyBseSwgY3AyeCArIGx4LCBjcDJ5ICsgbHksIHB4ICsgbHgsIHB5ICsgbHkpO1xuICAgICAgICAgICAgfTsgLy9TIHgyIHkyLCB4IHkgKG9yIHMgZHgyIGR5MiwgZHggZHkpXG5cblxuICAgICAgICAgICAgdGhpcy5TID0gZnVuY3Rpb24gKGNweCwgY3B5LCBweCwgcHkpIHtcbiAgICAgICAgICAgICAgdmFyIF9tYWtlUmVmbGVjdGVkID0gbWFrZVJlZmxlY3RlZCgpLFxuICAgICAgICAgICAgICAgICAgY3AxeCA9IF9tYWtlUmVmbGVjdGVkLngsXG4gICAgICAgICAgICAgICAgICBjcDF5ID0gX21ha2VSZWZsZWN0ZWQueTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDMuQyhjcDF4LCBjcDF5LCBjcHgsIGNweSwgcHgsIHB5KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMucyA9IGZ1bmN0aW9uIChjcHgsIGNweSwgcHgsIHB5KSB7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpczEwMy5TKGNweCArIGx4LCBjcHkgKyBseSwgcHggKyBseCwgcHkgKyBseSk7XG4gICAgICAgICAgICB9OyAvL1EgeDEgeTEsIHggeSAob3IgcSBkeDEgZHkxLCBkeCBkeSlcblxuXG4gICAgICAgICAgICB0aGlzLlEgPSBmdW5jdGlvbiAoY3B4LCBjcHksIHB4LCBweSkge1xuICAgICAgICAgICAgICBjdHgucXVhZHJhdGljQ3VydmVUbyhjcHgsIGNweSwgcHgsIHB5KTtcbiAgICAgICAgICAgICAgbHggPSBweDtcbiAgICAgICAgICAgICAgbHkgPSBweTtcbiAgICAgICAgICAgICAgcmVmbGVjdGVkID0ge1xuICAgICAgICAgICAgICAgIHg6IDIgKiBweCAtIGNweCxcbiAgICAgICAgICAgICAgICB5OiAyICogcHkgLSBjcHlcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgbGFzdENvbW1hbmQgPSBcIlFcIjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5xID0gZnVuY3Rpb24gKGNweCwgY3B5LCBweCwgcHkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzLlEoY3B4ICsgbHgsIGNweSArIGx5LCBweCArIGx4LCBweSArIGx5KTtcbiAgICAgICAgICAgIH07IC8vVCB4IHkgKG9yIHQgZHggZHkpXG5cblxuICAgICAgICAgICAgdGhpcy5UID0gZnVuY3Rpb24gKHB4LCBweSkge1xuICAgICAgICAgICAgICB2YXIgX21ha2VSZWZsZWN0ZWQyID0gbWFrZVJlZmxlY3RlZCgpLFxuICAgICAgICAgICAgICAgICAgY3B4ID0gX21ha2VSZWZsZWN0ZWQyLngsXG4gICAgICAgICAgICAgICAgICBjcHkgPSBfbWFrZVJlZmxlY3RlZDIueTtcblxuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDMuUShjcHgsIGNweSwgcHgsIHB5KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMudCA9IGZ1bmN0aW9uIChweCwgcHkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzLlQocHggKyBseCwgcHkgKyBseSk7XG4gICAgICAgICAgICB9OyAvL0EgcnggcnkgeC1heGlzLXJvdGF0aW9uIGxhcmdlLWFyYy1mbGFnIHN3ZWVwLWZsYWcgeCB5XG5cblxuICAgICAgICAgICAgdGhpcy5BID0gZnVuY3Rpb24gKHJ4LCByeSwgeEF4aXNSb3RhdGlvbiwgbGFyZ2VBcmNGbGFnLCBzd2VlcEZsYWcsIHB4LCBweSkge1xuICAgICAgICAgICAgICB2YXIgeDEgPSBseDtcbiAgICAgICAgICAgICAgdmFyIHkxID0gbHk7XG4gICAgICAgICAgICAgIGVsbGlwc2VGcm9tRWxsaXB0aWNhbEFyYyhjdHgsIHgxLCB5MSwgcngsIHJ5LCB4QXhpc1JvdGF0aW9uLCBsYXJnZUFyY0ZsYWcsIHN3ZWVwRmxhZywgcHgsIHB5KTtcbiAgICAgICAgICAgICAgbHggPSBweDtcbiAgICAgICAgICAgICAgbHkgPSBweTtcbiAgICAgICAgICAgICAgbGFzdENvbW1hbmQgPSBcIkFcIjtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAzO1xuICAgICAgICAgICAgfTsgLy9hIHJ4IHJ5IHgtYXhpcy1yb3RhdGlvbiBsYXJnZS1hcmMtZmxhZyBzd2VlcC1mbGFnIGR4IGR5XG5cblxuICAgICAgICAgICAgdGhpcy5hID0gZnVuY3Rpb24gKHJ4LCByeSwgeEF4aXNSb3RhdGlvbiwgbGFyZ2VBcmNGbGFnLCBzd2VlcEZsYWcsIHB4LCBweSkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMDMuQShyeCwgcnksIHhBeGlzUm90YXRpb24sIGxhcmdlQXJjRmxhZywgc3dlZXBGbGFnLCBweCArIGx4LCBweSArIGx5KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGV4cG9ydHMuUGF0aENvbW1hbmRzID0gUGF0aENvbW1hbmRzO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL2xlZ2FjeS9jYW52YXMvUGF0aENvbW1hbmRzUGFyc2VyLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvbGVnYWN5L2NhbnZhcy9QYXRoQ29tbWFuZHNQYXJzZXIuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbExlZ2FjeUNhbnZhc1BhdGhDb21tYW5kc1BhcnNlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuUGF0aENvbW1hbmRzUGFyc2VyID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIFBhdGhDb21tYW5kc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9QYXRoQ29tbWFuZHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvbGVnYWN5L2NhbnZhcy9QYXRoQ29tbWFuZHMuanNcIik7XG5cbiAgICAgICAgICBmdW5jdGlvbiBwYXRoVG9rZW5zKGQpIHtcbiAgICAgICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAoZC5sZW5ndGggPiBpZHgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBjID0gZFtpZHhdO1xuICAgICAgICAgICAgICAgICAgaWR4Kys7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChcIiAsXFxuXFxyXFx0XCIuaW5kZXhPZihjKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gXCIuKy0xMjM0NTY3ODkwXCIuaW5kZXhPZihjKSA+IC0xID8gXCJudW1cIiA6IFwic3RyXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwic3RyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAocykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWR4LS07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChcIi0rXCIuaW5kZXhPZihjKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkeC0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGMgPT09IFwiLlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHMuaW5kZXhPZihcIi5cIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWR4LS07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzICs9IGM7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHMgfHwgbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBjb21tYW5kKGJ1aWxkZXIsIGNtZCwgYXJnc1Byb3ZpZGVyKSB7XG4gICAgICAgICAgICBpZiAoY21kLnRvVXBwZXJDYXNlKCkgPT09IFwiTVwiIHx8IGNtZC50b1VwcGVyQ2FzZSgpID09PSBcIkxcIiB8fCBjbWQudG9VcHBlckNhc2UoKSA9PT0gXCJUXCIpIHtcbiAgICAgICAgICAgICAgYnVpbGRlci5jb21tYW5kKGNtZCwgYXJnc1Byb3ZpZGVyLm5leHQoKSwgYXJnc1Byb3ZpZGVyLm5leHQoKSk7XG4gICAgICAgICAgICAgIHJldHVybiBjbWQgPT09IFwiTVwiID8gXCJMXCIgOiBjbWQgPT09IFwibVwiID8gXCJsXCIgOiBjbWQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNtZC50b1VwcGVyQ2FzZSgpID09PSBcIkhcIiB8fCBjbWQudG9VcHBlckNhc2UoKSA9PT0gXCJWXCIpIHtcbiAgICAgICAgICAgICAgYnVpbGRlci5jb21tYW5kKGNtZCwgYXJnc1Byb3ZpZGVyLm5leHQoKSk7XG4gICAgICAgICAgICAgIHJldHVybiBjbWQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNtZC50b1VwcGVyQ2FzZSgpID09PSBcIlpcIikge1xuICAgICAgICAgICAgICBidWlsZGVyLmNvbW1hbmQoY21kKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGNtZDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY21kLnRvVXBwZXJDYXNlKCkgPT09IFwiQ1wiKSB7XG4gICAgICAgICAgICAgIGJ1aWxkZXIuY29tbWFuZChjbWQsIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCkpO1xuICAgICAgICAgICAgICByZXR1cm4gY21kO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjbWQudG9VcHBlckNhc2UoKSA9PT0gXCJTXCIgfHwgY21kLnRvVXBwZXJDYXNlKCkgPT09IFwiUVwiKSB7XG4gICAgICAgICAgICAgIGJ1aWxkZXIuY29tbWFuZChjbWQsIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCksIGFyZ3NQcm92aWRlci5uZXh0KCkpO1xuICAgICAgICAgICAgICByZXR1cm4gY21kO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjbWQudG9VcHBlckNhc2UoKSA9PT0gXCJBXCIpIHtcbiAgICAgICAgICAgICAgYnVpbGRlci5jb21tYW5kKGNtZCwgYXJnc1Byb3ZpZGVyLm5leHQoKSwgYXJnc1Byb3ZpZGVyLm5leHQoKSwgYXJnc1Byb3ZpZGVyLm5leHQoKSwgYXJnc1Byb3ZpZGVyLm5leHQoKSwgYXJnc1Byb3ZpZGVyLm5leHQoKSwgYXJnc1Byb3ZpZGVyLm5leHQoKSwgYXJnc1Byb3ZpZGVyLm5leHQoKSk7XG4gICAgICAgICAgICAgIHJldHVybiBjbWQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9qYS9kb2NzL1dlYi9TVkcvVHV0b3JpYWwvUGF0aHNcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwidW5zdXBwb3J0ZWQ6XCIuY29uY2F0KGNtZCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgUGF0aENvbW1hbmRzUGFyc2VyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFBhdGhDb21tYW5kc1BhcnNlcigpIHtcbiAgICAgICAgICAgICAgdmFyIF90aGlzMTA0ID0gdGhpcztcblxuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGF0aENvbW1hbmRzUGFyc2VyKTtcblxuICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICB0aGlzLl9vcHMgPSBbXTtcbiAgICAgICAgICAgICAgdGhpcy5fY29tbWFuZHMgPSBuZXcgUGF0aENvbW1hbmRzXzEuUGF0aENvbW1hbmRzKHRoaXMpO1xuXG4gICAgICAgICAgICAgIHZhciBidWlsZFB1c2ggPSBmdW5jdGlvbiBidWlsZFB1c2gob3ApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9sZW4yMSA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjIxKSwgX2tleTIxID0gMDsgX2tleTIxIDwgX2xlbjIxOyBfa2V5MjErKykge1xuICAgICAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTIxXSA9IGFyZ3VtZW50c1tfa2V5MjFdO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMDQuX29wcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICBvcDogb3AsXG4gICAgICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIHRoaXMubW92ZVRvID0gYnVpbGRQdXNoKFwibW92ZVRvXCIpO1xuICAgICAgICAgICAgICB0aGlzLmxpbmVUbyA9IGJ1aWxkUHVzaChcImxpbmVUb1wiKTtcbiAgICAgICAgICAgICAgdGhpcy5jbG9zZVBhdGggPSBidWlsZFB1c2goXCJjbG9zZVBhdGhcIik7XG4gICAgICAgICAgICAgIHRoaXMuYmV6aWVyQ3VydmVUbyA9IGJ1aWxkUHVzaChcImJlemllckN1cnZlVG9cIik7XG4gICAgICAgICAgICAgIHRoaXMucXVhZHJhdGljQ3VydmVUbyA9IGJ1aWxkUHVzaChcInF1YWRyYXRpY0N1cnZlVG9cIik7XG4gICAgICAgICAgICAgIHRoaXMuc2F2ZSA9IGJ1aWxkUHVzaChcInNhdmVcIik7XG4gICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlID0gYnVpbGRQdXNoKFwidHJhbnNsYXRlXCIpO1xuICAgICAgICAgICAgICB0aGlzLnJvdGF0ZSA9IGJ1aWxkUHVzaChcInJvdGF0ZVwiKTtcbiAgICAgICAgICAgICAgdGhpcy5zY2FsZSA9IGJ1aWxkUHVzaChcInNjYWxlXCIpO1xuICAgICAgICAgICAgICB0aGlzLmFyYyA9IGJ1aWxkUHVzaChcImFyY1wiKTtcbiAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlID0gYnVpbGRQdXNoKFwicmVzdG9yZVwiKTtcbiAgICAgICAgICAgICAgdGhpcy5hcmNUbyA9IGJ1aWxkUHVzaChcImFyY1RvXCIpO1xuICAgICAgICAgICAgICB0aGlzLmVsbGlwc2UgPSBidWlsZFB1c2goXCJlbGxpcHNlXCIpO1xuICAgICAgICAgICAgICB0aGlzLnJlY3QgPSBidWlsZFB1c2goXCJyZWN0XCIpO1xuICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhQYXRoQ29tbWFuZHNQYXJzZXIsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJjb21tYW5kXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21tYW5kKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfbGVuMjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yMiA+IDEgPyBfbGVuMjIgLSAxIDogMCksIF9rZXkyMiA9IDE7IF9rZXkyMiA8IF9sZW4yMjsgX2tleTIyKyspIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbX2tleTIyIC0gMV0gPSBhcmd1bWVudHNbX2tleTIyXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIHZhciBudW1BcmdzID0gYXJncyB8fCBbXTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgbnVtQXJnc1tpXSAtPSAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjb21tYW5kID0gdGhpcy5fY29tbWFuZHNbbmFtZV07IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgICAgICBjb21tYW5kLmFwcGx5KHRoaXMsIG51bUFyZ3MpO1xuICAgICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInBhcnNlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZShkKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMTA1ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBvcHMgPSB0aGlzLl9vcHMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgdG9rZW5zID0gcGF0aFRva2VucyhkKTtcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY21kO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3Vic2VxdWVudENvbW1hbmQgPSBcIlpcIjtcblxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoY21kID0gdG9rZW5zLm5leHQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4oTnVtYmVyKGNtZCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3NQcm92aWRlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNtZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRva2Vucy5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzZXF1ZW50Q29tbWFuZCA9IGNvbW1hbmQoX3RoaXMxMDUsIHN1YnNlcXVlbnRDb21tYW5kLCBhcmdzUHJvdmlkZXIpIHx8IFwiWlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2VxdWVudENvbW1hbmQgPSBjb21tYW5kKF90aGlzMTA1LCBjbWQsIHRva2VucykgfHwgXCJaXCI7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IFwiLmNvbmNhdChkKSk7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBvcHM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIFBhdGhDb21tYW5kc1BhcnNlcjtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLlBhdGhDb21tYW5kc1BhcnNlciA9IFBhdGhDb21tYW5kc1BhcnNlcjtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9pbnRlcm5hbC9sZWdhY3kvZm9udHdhdGNoL0ZvbnRSdWxlci5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL2xlZ2FjeS9mb250d2F0Y2gvRm9udFJ1bGVyLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxMZWdhY3lGb250d2F0Y2hGb250UnVsZXJKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjsgLy9zZWUgaHR0cHM6Ly9naXRodWIuY29tL3R5cGVraXQvd2ViZm9udGxvYWRlclxuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuRm9udFJ1bGVyID0gdm9pZCAwO1xuXG4gICAgICAgICAgZnVuY3Rpb24gY29tcHV0ZVN0eWxlKGZvbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBbe1xuICAgICAgICAgICAgICBkaXNwbGF5OiBcImJsb2NrXCIsXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgICAgICAgICAgIHRvcDogXCItOTk5OXB4XCIsXG4gICAgICAgICAgICAgIGxlZnQ6IFwiLTk5OTlweFwiLFxuICAgICAgICAgICAgICB3aWR0aDogXCJhdXRvXCIsXG4gICAgICAgICAgICAgIGhlaWdodDogXCJhdXRvXCIsXG4gICAgICAgICAgICAgIG1hcmdpbjogXCIwXCIsXG4gICAgICAgICAgICAgIHBhZGRpbmc6IFwiMFwiLFxuICAgICAgICAgICAgICBcIndoaXRlLXNwYWNlXCI6IFwibm93cmFwXCIsXG4gICAgICAgICAgICAgIGZvbnQ6IGZvbnRcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgXCJmb250LXZhcmlhbnRcIjogXCJub3JtYWxcIixcbiAgICAgICAgICAgICAgXCJmb250LXNpemVcIjogXCIzMDBweFwiLFxuICAgICAgICAgICAgICBcImZvbnQtc3R5bGVcIjogXCJub3JtYWxcIixcbiAgICAgICAgICAgICAgXCJmb250LXdlaWdodFwiOiBcIjQwMFwiLFxuICAgICAgICAgICAgICBcImxpbmUtaGVpZ2h0XCI6IFwibm9ybWFsXCJcbiAgICAgICAgICAgIH1dO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBGb250UnVsZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRm9udFJ1bGVyKGZvbnQsIHRlc3RTdHIpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZvbnRSdWxlcik7XG5cbiAgICAgICAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gICAgICAgICAgICAgIGUudGV4dENvbnRlbnQgPSB0ZXN0U3RyIHx8IFwiQkVTYnN3eVwiO1xuICAgICAgICAgICAgICBjb21wdXRlU3R5bGUoZm9udCkuZm9yRWFjaChmdW5jdGlvbiAoc3R5bGUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIHN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIga2V5ID0gazsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgICAgICAgICAgZS5zdHlsZVtrZXldID0gc3R5bGVba2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGUpO1xuICAgICAgICAgICAgICB0aGlzLmVsXyA9IGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhGb250UnVsZXIsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRXaWR0aFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0V2lkdGgoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxfLm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJyZW1vdmVcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMuZWxfKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gRm9udFJ1bGVyO1xuICAgICAgICAgIH0oKTtcblxuICAgICAgICAgIGV4cG9ydHMuRm9udFJ1bGVyID0gRm9udFJ1bGVyO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL2xlZ2FjeS9mb250d2F0Y2gvRm9udFdhdGNoUnVubmVyLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvbGVnYWN5L2ZvbnR3YXRjaC9Gb250V2F0Y2hSdW5uZXIuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbExlZ2FjeUZvbnR3YXRjaEZvbnRXYXRjaFJ1bm5lckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiOyAvL3NlZSBodHRwczovL2dpdGh1Yi5jb20vdHlwZWtpdC93ZWJmb250bG9hZGVyXG4gICAgICAgICAgLy9odHRwOi8vZGVmZ2hpMTk3Ny5odG1sLnhkb21haW4uanAvdGVjaC9jYW52YXNNZW1vL2NhbnZhc01lbW8uaHRtXG5cbiAgICAgICAgICB2YXIgRm9udFJ1bGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0ZvbnRSdWxlciAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9sZWdhY3kvZm9udHdhdGNoL0ZvbnRSdWxlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBMYXN0UmVzb3J0Rm9udHMgPSB7XG4gICAgICAgICAgICBTRVJJRjogXCJzZXJpZlwiLFxuICAgICAgICAgICAgU0FOU19TRVJJRjogXCJzYW5zLXNlcmlmXCJcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciB3YXRjaFJ1bm5lcnMgPSB7fTtcblxuICAgICAgICAgIHZhciBGb250V2F0Y2hSdW5uZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRm9udFdhdGNoUnVubmVyKGZvbnQsIHRlc3RTdHIpIHtcbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZvbnRXYXRjaFJ1bm5lcik7XG5cbiAgICAgICAgICAgICAgdGhpcy5hY3RpdmVDYWxsYmFja3MgPSBbXTtcbiAgICAgICAgICAgICAgdGhpcy5pbmFjdGl2ZUNhbGxiYWNrcyA9IFtdO1xuICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMubGFzdFJlc29ydFdpZHRoc18gPSB7fTtcbiAgICAgICAgICAgICAgdGhpcy5mb250UnVsZXJBXyA9IG5ldyBGb250UnVsZXJfMS5Gb250UnVsZXIoXCJcIi5jb25jYXQoZm9udCwgXCIsXCIpLmNvbmNhdChMYXN0UmVzb3J0Rm9udHMuU0VSSUYpLCB0ZXN0U3RyKTtcbiAgICAgICAgICAgICAgdGhpcy5mb250UnVsZXJCXyA9IG5ldyBGb250UnVsZXJfMS5Gb250UnVsZXIoXCJcIi5jb25jYXQoZm9udCwgXCIsXCIpLmNvbmNhdChMYXN0UmVzb3J0Rm9udHMuU0FOU19TRVJJRiksIHRlc3RTdHIpO1xuICAgICAgICAgICAgICB2YXIgbGFzdFJlc29ydFJ1bGVyQSA9IG5ldyBGb250UnVsZXJfMS5Gb250UnVsZXIoXCI0cHggXCIuY29uY2F0KExhc3RSZXNvcnRGb250cy5TRVJJRiksIHRlc3RTdHIpO1xuICAgICAgICAgICAgICB2YXIgbGFzdFJlc29ydFJ1bGVyQiA9IG5ldyBGb250UnVsZXJfMS5Gb250UnVsZXIoXCI0cHggXCIuY29uY2F0KExhc3RSZXNvcnRGb250cy5TQU5TX1NFUklGKSwgdGVzdFN0cik7IC8vc3RhcnRcblxuICAgICAgICAgICAgICB0aGlzLmxhc3RSZXNvcnRXaWR0aHNfW0xhc3RSZXNvcnRGb250cy5TRVJJRl0gPSBsYXN0UmVzb3J0UnVsZXJBLmdldFdpZHRoKCk7XG4gICAgICAgICAgICAgIHRoaXMubGFzdFJlc29ydFdpZHRoc19bTGFzdFJlc29ydEZvbnRzLlNBTlNfU0VSSUZdID0gbGFzdFJlc29ydFJ1bGVyQi5nZXRXaWR0aCgpO1xuICAgICAgICAgICAgICBsYXN0UmVzb3J0UnVsZXJBLnJlbW92ZSgpO1xuICAgICAgICAgICAgICBsYXN0UmVzb3J0UnVsZXJCLnJlbW92ZSgpO1xuICAgICAgICAgICAgICB0aGlzLnN0YXJ0ZWRfID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgICAgdGhpcy5jaGVja18oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKEZvbnRXYXRjaFJ1bm5lciwgW3tcbiAgICAgICAgICAgICAga2V5OiBcInRoZW5cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRoZW4oYWN0aXZlQ2FsbGJhY2ssIGluYWN0aXZlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gXCJuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbmFjdGl2ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2FsbGJhY2tzLnB1c2goYWN0aXZlQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgdGhpcy5pbmFjdGl2ZUNhbGxiYWNrcy5wdXNoKGluYWN0aXZlQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2hlY2tfXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja18oKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMTA2ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aEEgPSB0aGlzLmZvbnRSdWxlckFfLmdldFdpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoQiA9IHRoaXMuZm9udFJ1bGVyQl8uZ2V0V2lkdGgoKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRmFsbGJhY2tGb250Xyh3aWR0aEEsIHdpZHRoQikgfHwgdGhpcy5pc0xhc3RSZXNvcnRGb250Xyh3aWR0aEEsIHdpZHRoQikpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGhpcy5zdGFydGVkXyA+PSAzMDAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRpbWVvdXRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNMYXN0UmVzb3J0Rm9udF8od2lkdGhBLCB3aWR0aEIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5maW5pc2hfKHRoaXMuYWN0aXZlQ2FsbGJhY2tzKTtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwib2tcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaF8odGhpcy5pbmFjdGl2ZUNhbGxiYWNrcyk7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBcIm5nXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTA2LmNoZWNrXygpO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuZmluaXNoXyh0aGlzLmFjdGl2ZUNhbGxiYWNrcyk7XG4gICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwib2tcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImlzRmFsbGJhY2tGb250X1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNGYWxsYmFja0ZvbnRfKGEsIGIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53aWR0aE1hdGNoZXNfKGEsIExhc3RSZXNvcnRGb250cy5TRVJJRikgJiYgdGhpcy53aWR0aE1hdGNoZXNfKGIsIExhc3RSZXNvcnRGb250cy5TQU5TX1NFUklGKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwid2lkdGhzTWF0Y2hMYXN0UmVzb3J0V2lkdGhzX1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2lkdGhzTWF0Y2hMYXN0UmVzb3J0V2lkdGhzXyhhLCBiKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZm9udCBpbiBMYXN0UmVzb3J0Rm9udHMpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChMYXN0UmVzb3J0Rm9udHMuaGFzT3duUHJvcGVydHkoZm9udCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud2lkdGhNYXRjaGVzXyhhLCBMYXN0UmVzb3J0Rm9udHNbZm9udF0pICYmIHRoaXMud2lkdGhNYXRjaGVzXyhiLCBMYXN0UmVzb3J0Rm9udHNbZm9udF0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIndpZHRoTWF0Y2hlc19cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpZHRoTWF0Y2hlc18od2lkdGgsIGxhc3RSZXNvcnRGb250KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdpZHRoID09PSB0aGlzLmxhc3RSZXNvcnRXaWR0aHNfW2xhc3RSZXNvcnRGb250XTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaXNMYXN0UmVzb3J0Rm9udF9cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzTGFzdFJlc29ydEZvbnRfKGEsIGIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzV2ViS2l0RmFsbGJhY2tCdWcoKSAmJiB0aGlzLndpZHRoc01hdGNoTGFzdFJlc29ydFdpZHRoc18oYSwgYik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZpbmlzaF9cIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmlzaF8oY2FsbGJhY2tzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMTA3ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgX3RoaXMxMDcuZm9udFJ1bGVyQV8ucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzMTA3LmZvbnRSdWxlckJfLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgICBjYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNiKCk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0sIFt7XG4gICAgICAgICAgICAgIGtleTogXCJsb2FkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKGZvbnQsIHRlc3RTdHIsIGFjdGl2ZUNhbGxiYWNrLCBpbmFjdGl2ZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSB3YXRjaFJ1bm5lcnNbZm9udF0gfHwgKHdhdGNoUnVubmVyc1tmb250XSA9IHt9KTtcbiAgICAgICAgICAgICAgICB0ZXN0U3RyICs9IFwiXCI7XG4gICAgICAgICAgICAgICAgdmFyIHJ1bm5lcjtcblxuICAgICAgICAgICAgICAgIGlmIChjW3Rlc3RTdHJdKSB7XG4gICAgICAgICAgICAgICAgICBydW5uZXIgPSBjW3Rlc3RTdHJdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBydW5uZXIgPSBjW3Rlc3RTdHJdID0gbmV3IEZvbnRXYXRjaFJ1bm5lcihmb250LCB0ZXN0U3RyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBydW5uZXIudGhlbihhY3RpdmVDYWxsYmFjaywgaW5hY3RpdmVDYWxsYmFjayk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKTtcblxuICAgICAgICAgICAgcmV0dXJuIEZvbnRXYXRjaFJ1bm5lcjtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICB2YXIgSEFTX1dFQktJVF9GQUxMQkFDS19CVUcgPSBudWxsO1xuXG4gICAgICAgICAgZnVuY3Rpb24gaGFzV2ViS2l0RmFsbGJhY2tCdWcoKSB7XG4gICAgICAgICAgICBpZiAoSEFTX1dFQktJVF9GQUxMQkFDS19CVUcgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgdmFyIG1hdGNoID0gL0FwcGxlV2ViS2l0XFwvKFswLTldKykoPzpcXC4oWzAtOV0rKSkvLmV4ZWMod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAgICAgICAgICAgICBIQVNfV0VCS0lUX0ZBTExCQUNLX0JVRyA9ICEhbWF0Y2ggJiYgKHBhcnNlSW50KG1hdGNoWzFdLCAxMCkgPCA1MzYgfHwgcGFyc2VJbnQobWF0Y2hbMV0sIDEwKSA9PT0gNTM2ICYmIHBhcnNlSW50KG1hdGNoWzJdLCAxMCkgPD0gMTEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gSEFTX1dFQktJVF9GQUxMQkFDS19CVUc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBGb250V2F0Y2hSdW5uZXI7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaW50ZXJuYWwvbWVudS1pdGVtcy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvbWVudS1pdGVtcy5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxNZW51SXRlbXNKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLm5vcm1hbGl6ZVRvRm4gPSBleHBvcnRzLm5vcm1hbGl6ZSA9IHZvaWQgMDtcbiAgICAgICAgICAvKiogQHByaXZhdGUgKi9cblxuICAgICAgICAgIGZ1bmN0aW9uIGV4dGVuZChhLCBiKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgdmFyIG8gPSB7fTtcblxuICAgICAgICAgICAgZm9yICh2YXIgayBpbiBhKSB7XG4gICAgICAgICAgICAgIG9ba10gPSBhW2tdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBfazMgaW4gYikge1xuICAgICAgICAgICAgICBvW19rM10gPSBiW19rM107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBOb3JtYWxpemUgdGhlIGdpdmVuIG1lbnUgb3B0aW9ucy5cbiAgICAgICAgICAgKiBAcGFyYW0geyp9IG9wdGlvbnMgbWVudSBvcHRpb25zIHRvIGdpdmVuXG4gICAgICAgICAgICogQHJldHVybnMge0FycmF5fSBOb3JtYWxpemVkIG9wdGlvbnNcbiAgICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemUob3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkob3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMubWFwKCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBleHRlbmQoZSwge1xuICAgICAgICAgICAgICAgICAgbGFiZWw6IGUuY2FwdGlvbiB8fCBlLmxhYmVsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZShKU09OLnBhcnNlKG9wdGlvbnMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBrLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBvcHRpb25zW2tdXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMubm9ybWFsaXplID0gbm9ybWFsaXplO1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIE5vcm1hbGl6ZSB0aGUgZ2l2ZW4gbWVudSBvcHRpb25zLlxuICAgICAgICAgICAqIEBwYXJhbSB7Kn0gb3B0aW9ucyBtZW51IG9wdGlvbnMgdG8gZ2l2ZW5cbiAgICAgICAgICAgKiBAcmV0dXJucyB7QXJyYXl9IE5vcm1hbGl6ZWQgb3B0aW9uc1xuICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICovXG5cbiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVUb0ZuKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAocmVjb3JkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZShvcHRpb25zKHJlY29yZCkpO1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gbm9ybWFsaXplKG9wdGlvbnMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm5vcm1hbGl6ZVRvRm4gPSBub3JtYWxpemVUb0ZuO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL3Bhc3RlLXV0aWxzLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvcGFzdGUtdXRpbHMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbFBhc3RlVXRpbHNKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLnBhcnNlUGFzdGVSYW5nZUJveFZhbHVlcyA9IGV4cG9ydHMubm9ybWFsaXplUGFzdGVWYWx1ZSA9IHZvaWQgMDtcblxuICAgICAgICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZVBhc3RlVmFsdWUodGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHRleHRbdGV4dC5sZW5ndGggLSAxXSAhPT0gXCJcXG5cIiA/IHRleHQgOiB0ZXh0W3RleHQubGVuZ3RoIC0gMl0gPT09IFwiXFxyXCIgPyB0ZXh0LnNsaWNlKDAsIC0yKSA6IHRleHQuc2xpY2UoMCwgLTEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMubm9ybWFsaXplUGFzdGVWYWx1ZSA9IG5vcm1hbGl6ZVBhc3RlVmFsdWU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBwYXJzZVBhc3RlUmFuZ2VCb3hWYWx1ZXModmFsdWUsIG9wdGlvbikge1xuICAgICAgICAgICAgdmFyIG5vcm1hbGl6ZWRWYWx1ZSA9IG5vcm1hbGl6ZVBhc3RlVmFsdWUodmFsdWUpO1xuXG4gICAgICAgICAgICB2YXIgX3BhcnNlVmFsdWVzID0gcGFyc2VWYWx1ZXMobm9ybWFsaXplZFZhbHVlLCBvcHRpb24pLFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IF9wYXJzZVZhbHVlcy52YWx1ZXMsXG4gICAgICAgICAgICAgICAgY29sQ291bnQgPSBfcGFyc2VWYWx1ZXMuY29sQ291bnQ7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGNvbENvdW50OiBjb2xDb3VudCxcbiAgICAgICAgICAgICAgcm93Q291bnQ6IHZhbHVlcy5sZW5ndGgsXG4gICAgICAgICAgICAgIGdldENlbGxWYWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbFZhbHVlKG9mZnNldENvbCwgb2Zmc2V0Um93KSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hLCBfYjtcblxuICAgICAgICAgICAgICAgIHJldHVybiAoX2IgPSAoX2EgPSB2YWx1ZXNbb2Zmc2V0Um93XSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hW29mZnNldENvbF0pICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IFwiXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5wYXJzZVBhc3RlUmFuZ2VCb3hWYWx1ZXMgPSBwYXJzZVBhc3RlUmFuZ2VCb3hWYWx1ZXM7XG5cbiAgICAgICAgICBmdW5jdGlvbiBwYXJzZVZhbHVlcyh0ZXh0LCBfcmVmODQpIHtcbiAgICAgICAgICAgIHZhciB0cmltT25QYXN0ZSA9IF9yZWY4NC50cmltT25QYXN0ZTtcbiAgICAgICAgICAgIHZhciBsZW4gPSB0ZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBhZGp1c3RDZWxsID0gdHJpbU9uUGFzdGUgPyBmdW5jdGlvbiAoY2VsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gY2VsbC50cmltKCk7XG4gICAgICAgICAgICB9IDogZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNlbGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGNvbENvdW50ID0gMTtcbiAgICAgICAgICAgIHZhciBsaW5lID0gW107XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gW2xpbmVdO1xuICAgICAgICAgICAgdmFyIGNlbGwgPSBcIlwiO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgIHZhciBjaGFyID0gdGV4dFtpbmRleF07XG5cbiAgICAgICAgICAgICAgaWYgKGNoYXIgPT09IFwiXFx0XCIpIHtcbiAgICAgICAgICAgICAgICBsaW5lLnB1c2goYWRqdXN0Q2VsbChjZWxsKSk7XG4gICAgICAgICAgICAgICAgY2VsbCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gXCJcXG5cIikge1xuICAgICAgICAgICAgICAgIC8vIEVuZCBvZiBsaW5lXG4gICAgICAgICAgICAgICAgY2VsbCA9IGFkanVzdENlbGwoY2VsbCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2VsbFtjZWxsLmxlbmd0aCAtIDFdID09PSBcIlxcclwiKSB7XG4gICAgICAgICAgICAgICAgICBjZWxsID0gY2VsbC5zbGljZSgwLCAtMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbGluZS5wdXNoKGNlbGwpO1xuICAgICAgICAgICAgICAgIGNvbENvdW50ID0gTWF0aC5tYXgoY29sQ291bnQsIGxpbmUubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBsaW5lID0gW107XG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gobGluZSk7XG4gICAgICAgICAgICAgICAgY2VsbCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1wiJyAmJiAhY2VsbC50cmltKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcXVvdGVkID0gcHJvY2Vzc1F1b3RlZENlbGwoaW5kZXggKyAxKTtcblxuICAgICAgICAgICAgICAgIGlmIChxdW90ZWQpIHtcbiAgICAgICAgICAgICAgICAgIGNlbGwgPSBxdW90ZWQuY2VsbDtcbiAgICAgICAgICAgICAgICAgIGluZGV4ID0gcXVvdGVkLm5leHQgLSAxO1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY2VsbCArPSBjaGFyO1xuICAgICAgICAgICAgfSAvLyBFbmQgb2YgdGV4dFxuXG5cbiAgICAgICAgICAgIGxpbmUucHVzaChhZGp1c3RDZWxsKGNlbGwpKTtcbiAgICAgICAgICAgIGNvbENvdW50ID0gTWF0aC5tYXgoY29sQ291bnQsIGxpbmUubGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHZhbHVlczogdmFsdWVzLFxuICAgICAgICAgICAgICBjb2xDb3VudDogY29sQ291bnRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHByb2Nlc3NRdW90ZWRDZWxsKHN0YXJ0KSB7XG4gICAgICAgICAgICAgIHZhciBjZWxsID0gXCJcIjtcbiAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhcnQ7XG5cbiAgICAgICAgICAgICAgd2hpbGUgKGluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jaGFyID0gdGV4dFtpbmRleF07XG5cbiAgICAgICAgICAgICAgICBpZiAoX2NoYXIgIT09ICdcIicpIHtcbiAgICAgICAgICAgICAgICAgIGNlbGwgKz0gX2NoYXI7XG4gICAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRleHRbaW5kZXggKyAxXSA9PT0gJ1wiJykge1xuICAgICAgICAgICAgICAgICAgLy8gRXNjYXBlXG4gICAgICAgICAgICAgICAgICBjZWxsICs9ICdcIic7XG4gICAgICAgICAgICAgICAgICBpbmRleCArPSAyO1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfSAvLyBNYXliZSBlbmQgcXVvdGVcblxuXG4gICAgICAgICAgICAgICAgdmFyIG5leHQgPSBpbmRleCArIDE7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAobmV4dCA8IGxlbikge1xuICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0ZXh0W25leHRdO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoYy50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm90IHF1b3RlZC4gZS5nLiBcIkFcIkJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChjID09PSBcIlxcdFwiIHx8IGMgPT09IFwiXFxuXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9IC8vIEFsbG93IHNwYWNlc1xuXG5cbiAgICAgICAgICAgICAgICAgIG5leHQrKztcbiAgICAgICAgICAgICAgICB9IC8vIEVuZCBxdW90ZVxuXG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgY2VsbDogY2VsbCxcbiAgICAgICAgICAgICAgICAgIG5leHQ6IG5leHRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKiovXG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaW50ZXJuYWwvcGF0aDJETWFuYWdlci5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvcGF0aDJETWFuYWdlci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxQYXRoMkRNYW5hZ2VySnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5maWxsID0gZXhwb3J0cy5nZXRQYXRoMkQgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRQYXRoMkQoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIFBhdGgyRCAhPT0gXCJ1bmRlZmluZWRcIiAmJiAhdXRpbHNfMS5icm93c2VyLkVkZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFBhdGgyRDtcbiAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby12YXItcmVxdWlyZXNcblxuXG4gICAgICAgICAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAgIC8qISAuL2xlZ2FjeS9jYW52YXMvUGF0aDJEU2hpbSAqL1xuICAgICAgICAgICAgXCIuL2ludGVybmFsL2xlZ2FjeS9jYW52YXMvUGF0aDJEU2hpbS5qc1wiKS5QYXRoMkRTaGltO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZ2V0UGF0aDJEID0gZ2V0UGF0aDJEO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZmlsbChwYXRoTW9kdWxlLCBjdHgsIHgsIHksIHcsIGgpIHtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHZhciB3aWR0aCA9IHBhdGhNb2R1bGUud2lkdGgsXG4gICAgICAgICAgICAgICAgICBoZWlnaHQgPSBwYXRoTW9kdWxlLmhlaWdodDtcbiAgICAgICAgICAgICAgdmFyIHVwc2lkZURvd24gPSBwYXRoTW9kdWxlLnVkLFxuICAgICAgICAgICAgICAgICAgX3BhdGhNb2R1bGUkeCA9IHBhdGhNb2R1bGUueCxcbiAgICAgICAgICAgICAgICAgIG9mZnNldFggPSBfcGF0aE1vZHVsZSR4ID09PSB2b2lkIDAgPyAwIDogX3BhdGhNb2R1bGUkeCxcbiAgICAgICAgICAgICAgICAgIF9wYXRoTW9kdWxlJHkgPSBwYXRoTW9kdWxlLnksXG4gICAgICAgICAgICAgICAgICBvZmZzZXRZID0gX3BhdGhNb2R1bGUkeSA9PT0gdm9pZCAwID8gMCA6IF9wYXRoTW9kdWxlJHk7XG4gICAgICAgICAgICAgIHcgPSB3IHx8IHdpZHRoO1xuICAgICAgICAgICAgICBoID0gaCB8fCBoZWlnaHQ7XG4gICAgICAgICAgICAgIHZhciB4cmF0ZSA9IHcgLyB3aWR0aDtcbiAgICAgICAgICAgICAgdmFyIHlyYXRlID0gaCAvICh1cHNpZGVEb3duID8gLWhlaWdodCA6IGhlaWdodCk7XG4gICAgICAgICAgICAgIHggPSB4IHx8IDA7XG4gICAgICAgICAgICAgIHkgPSB1cHNpZGVEb3duID8gKHkgfHwgMCkgKyAtaGVpZ2h0ICogeXJhdGUgOiB5IHx8IDA7XG4gICAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoeCwgeSk7XG4gICAgICAgICAgICAgIGN0eC5zY2FsZSh4cmF0ZSwgeXJhdGUpO1xuXG4gICAgICAgICAgICAgIGlmIChvZmZzZXRYICE9PSAwIHx8IG9mZnNldFkgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjdHgudHJhbnNsYXRlKG9mZnNldFgsIG9mZnNldFkpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIF9QYXRoMkQgPSBnZXRQYXRoMkQoKTtcblxuICAgICAgICAgICAgICB2YXIgcGF0aDJkID0gcGF0aE1vZHVsZS5wYXRoMmQgPSBwYXRoTW9kdWxlLnBhdGgyZCB8fCBuZXcgX1BhdGgyRChwYXRoTW9kdWxlLmQpO1xuICAgICAgICAgICAgICBjdHguZmlsbChwYXRoMmQpO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmZpbGwgPSBmaWxsO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL3NvcnQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL3NvcnQuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGludGVybmFsU29ydEpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuc29ydFByb21pc2UgPSBleHBvcnRzLnNvcnQgPSBleHBvcnRzLnNvcnRBcnJheSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciB1dGlsc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFycmF5KGdldCwgbGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBuZXcgQXJyYXkobGVuZ3RoKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBhcnJheVtpXSA9IGdldChpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGFycmF5O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFycmF5UHJvbWlzZShnZXQsIGdldEZpZWxkLCBsZW5ndGggLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICB2YXIgcGxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgdmFyIGFycmF5ID0gbmV3IEFycmF5KGxlbmd0aCk7XG5cbiAgICAgICAgICAgICAgdmFyIF9sb29wNyA9IGZ1bmN0aW9uIF9sb29wNyhpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBnZXQoaSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHtcbiAgICAgICAgICAgICAgICAgIHY6IGRhdGEsXG4gICAgICAgICAgICAgICAgICBmOiBkYXRhXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBhcnJheVtpXSA9IHJlY29yZDtcblxuICAgICAgICAgICAgICAgIGlmICgoMCwgdXRpbHNfMS5pc1Byb21pc2UpKGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICBwbGlzdC5wdXNoKGRhdGEudGhlbihmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgICAgICByZWNvcmQudiA9IHY7XG4gICAgICAgICAgICAgICAgICAgIHJlY29yZC5mID0gdjtcbiAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIF9sb29wNyhpKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIFByb21pc2UuYWxsKHBsaXN0KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RmllbGQgPT0gbnVsbCA/IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgYXJyYXkgOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIHNldEFycmF5RmllbGQoYXJyYXksIGdldEZpZWxkKTtcbiAgICAgICAgICAgICAgfSkudGhlbihyZXNvbHZlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIHNldEFycmF5RmllbGQoYXJyYXksIGdldEZpZWxkKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgICAgICAgICAgICAgdmFyIHBsaXN0ID0gW107XG5cbiAgICAgICAgICAgICAgdmFyIF9sb29wOCA9IGZ1bmN0aW9uIF9sb29wOChpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IGFycmF5W2ldO1xuICAgICAgICAgICAgICAgIHZhciBmID0gZ2V0RmllbGQocmVjb3JkLnYpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCgwLCB1dGlsc18xLmlzUHJvbWlzZSkoZikpIHtcbiAgICAgICAgICAgICAgICAgIHBsaXN0LnB1c2goZi50aGVuKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlY29yZC5mID0gdjtcbiAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmVjb3JkLmYgPSBmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgX2xvb3A4KGkpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgUHJvbWlzZS5hbGwocGxpc3QpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGFycmF5KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBzb3J0QXJyYXkoYXJyYXksIGNvbXBhcmUpIHtcbiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zb3J0LmNhbGwoYXJyYXksIGNvbXBhcmUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuc29ydEFycmF5ID0gc29ydEFycmF5O1xuXG4gICAgICAgICAgZnVuY3Rpb24gc29ydChnZXQsIHNldCwgbGVuZ3RoLCBjb21wYXJlLCBnZXRGaWVsZCkge1xuICAgICAgICAgICAgdmFyIG9sZCA9IGNyZWF0ZUFycmF5KGdldCwgbGVuZ3RoKTtcblxuICAgICAgICAgICAgaWYgKGdldEZpZWxkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgb2xkLnNvcnQoZnVuY3Rpb24gKHIxLCByMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJlKGdldEZpZWxkKHIxKSwgZ2V0RmllbGQocjIpKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBvbGQuc29ydChjb21wYXJlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBzZXQoaSwgb2xkW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLnNvcnQgPSBzb3J0O1xuXG4gICAgICAgICAgZnVuY3Rpb24gc29ydFByb21pc2UoZ2V0LCBzZXQsIGxlbmd0aCwgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICBjb21wYXJlLCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgIGdldEZpZWxkKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIFByb21pc2UgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUFycmF5UHJvbWlzZShnZXQsIGdldEZpZWxkLCBsZW5ndGgpLnRoZW4oZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICAgICAgYXJyYXkuc29ydChmdW5jdGlvbiAocjEsIHIyKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZShyMS5mLCByMi5mKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgIHNldChpLCBhcnJheVtpXS52KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc29ydChnZXQsIHNldCwgbGVuZ3RoLCBjb21wYXJlLCBnZXRGaWVsZCk7XG4gICAgICAgICAgICAgIHZhciBkdW1teVByb21pc2UgPSB7XG4gICAgICAgICAgICAgICAgdGhlbjogZnVuY3Rpb24gdGhlbihmbikge1xuICAgICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBkdW1teVByb21pc2U7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjYXRjaDogZnVuY3Rpb24gX2NhdGNoKCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGR1bW15UHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcmV0dXJuIGR1bW15UHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLnNvcnRQcm9taXNlID0gc29ydFByb21pc2U7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vaW50ZXJuYWwvc3R5bGUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9pbnRlcm5hbC9zdHlsZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGludGVybmFsU3R5bGVKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLmdldFNjcm9sbEJhclNpemUgPSBleHBvcnRzLmluaXREb2N1bWVudCA9IHZvaWQgMDtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldFNjcm9sbEJhcldpZHRoKCkge1xuICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgdmFyIGlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgIHZhciB3cmFwcGVyU3R5bGUgPSB3cmFwcGVyLnN0eWxlO1xuICAgICAgICAgICAgd3JhcHBlclN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xuICAgICAgICAgICAgd3JhcHBlclN0eWxlLmhlaWdodCA9IFwiNTBweFwiO1xuICAgICAgICAgICAgd3JhcHBlclN0eWxlLndpZHRoID0gXCI1MHB4XCI7XG4gICAgICAgICAgICB3cmFwcGVyU3R5bGUub3ZlcmZsb3cgPSBcInNjcm9sbFwiO1xuICAgICAgICAgICAgd3JhcHBlclN0eWxlLm9wYWNpdHkgPSBcIjBcIjtcbiAgICAgICAgICAgIHdyYXBwZXJTdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgICAgICAgICB2YXIgc3R5bGUgPSBpbm5lci5zdHlsZTtcbiAgICAgICAgICAgIHN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuICAgICAgICAgICAgc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcbiAgICAgICAgICAgIGlubmVyLnRleHRDb250ZW50ID0gXCJ4XCI7XG4gICAgICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGlubmVyKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQod3JhcHBlcik7XG4gICAgICAgICAgICB2YXIgd3JhcHBlcldpZHRoID0gd3JhcHBlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcbiAgICAgICAgICAgIHZhciBpbm5lcldpZHRoID0gaW5uZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHdyYXBwZXIpO1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh3cmFwcGVyV2lkdGggLSBpbm5lcldpZHRoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgU0NST0xMQkFSX1NJWkU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBpbml0RG9jdW1lbnRJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgICAvKiEgQC9pbnRlcm5hbC9zdHlsZS5jc3MgKi9cbiAgICAgICAgICAgIFwiLi4vc3JjL2pzL2ludGVybmFsL3N0eWxlLmNzc1wiKTtcblxuICAgICAgICAgICAgU0NST0xMQkFSX1NJWkUgPSBnZXRTY3JvbGxCYXJXaWR0aCgpIHx8IDEwO1xuICAgICAgICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgICAgICAgICAgc3R5bGUuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInRleHQvY3NzXCIpO1xuICAgICAgICAgICAgc3R5bGUuc2V0QXR0cmlidXRlKFwiZGF0YS1uYW1lXCIsIFwiY2hlZXRhaC1ncmlkXCIpO1xuICAgICAgICAgICAgc3R5bGUuaW5uZXJIVE1MID0gXCJcXG4uY2hlZXRhaC1ncmlkIC5ncmlkLXNjcm9sbC1lbmQtcG9pbnQge1xcblxcdHdpZHRoOiBcIi5jb25jYXQoU0NST0xMQkFSX1NJWkUsIFwicHg7XFxuXFx0aGVpZ2h0OiBcIikuY29uY2F0KFNDUk9MTEJBUl9TSVpFLCBcInB4O1xcbn1cXG4uY2hlZXRhaC1ncmlkID4gY2FudmFzIHtcXG5cXHR3aWR0aDogLXdlYmtpdC1jYWxjKDEwMCUgLSBcIikuY29uY2F0KFNDUk9MTEJBUl9TSVpFLCBcInB4KTtcXG5cXHR3aWR0aDogY2FsYygxMDAlIC0gXCIpLmNvbmNhdChTQ1JPTExCQVJfU0laRSwgXCJweCk7XFxuXFx0aGVpZ2h0OiAtd2Via2l0LWNhbGMoMTAwJSAtIFwiKS5jb25jYXQoU0NST0xMQkFSX1NJWkUsIFwicHgpO1xcblxcdGhlaWdodDogY2FsYygxMDAlIC0gXCIpLmNvbmNhdChTQ1JPTExCQVJfU0laRSwgXCJweCk7XFxufVxcblxcdFxcdFwiKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBpbml0RG9jdW1lbnRWYXIgPSBpbml0RG9jdW1lbnRJbnRlcm5hbDtcblxuICAgICAgICAgIGZ1bmN0aW9uIGluaXREb2N1bWVudCgpIHtcbiAgICAgICAgICAgIGluaXREb2N1bWVudFZhcigpO1xuICAgICAgICAgICAgaW5pdERvY3VtZW50VmFyID0gRnVuY3Rpb24ucHJvdG90eXBlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuaW5pdERvY3VtZW50ID0gaW5pdERvY3VtZW50O1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0U2Nyb2xsQmFyU2l6ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBTQ1JPTExCQVJfU0laRTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmdldFNjcm9sbEJhclNpemUgPSBnZXRTY3JvbGxCYXJTaXplO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL2ludGVybmFsL3N5bWJvbE1hbmFnZXIuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGludGVybmFsU3ltYm9sTWFuYWdlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICAgIC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL1xuXG4gICAgICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBleHBvcnRzLmdldENoZWNrSGVhZGVyU3RhdGVJZCA9IGV4cG9ydHMuZ2V0SW5saW5lTWVudUVkaXRvclN0YXRlSWQgPSBleHBvcnRzLmdldElubGluZUlucHV0RWRpdG9yU3RhdGVJZCA9IGV4cG9ydHMuZ2V0U21hbGxEaWFsb2dJbnB1dEVkaXRvclN0YXRlSWQgPSBleHBvcnRzLmdldFRyZWVDb2x1bW5TdGF0ZUlkID0gZXhwb3J0cy5nZXRCcmFuY2hHcmFwaENvbHVtblN0YXRlSWQgPSBleHBvcnRzLmdldENvbHVtbkZhZGVpblN0YXRlSWQgPSBleHBvcnRzLmdldEJ1dHRvbkNvbHVtblN0YXRlSWQgPSBleHBvcnRzLmdldFJhZGlvQ29sdW1uU3RhdGVJZCA9IGV4cG9ydHMuZ2V0Q2hlY2tDb2x1bW5TdGF0ZUlkID0gZXhwb3J0cy5nZXRQcm90ZWN0ZWRTeW1ib2wgPSBleHBvcnRzLmdldCA9IHZvaWQgMDtcbiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cblxuICAgICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgICAgLyohIC4vdXRpbHMgKi9cbiAgICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgICAgdmFyIF9TeW1ib2wgPSB1dGlsc18xLmlzTm9kZSA/IGdsb2JhbC5TeW1ib2wgOiB3aW5kb3cuU3ltYm9sID8gd2luZG93LlN5bWJvbCA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZnVuY3Rpb24gcmFuZG9tKCkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gXCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlcIjtcbiAgICAgICAgICAgICAgICB2YXIgY2wgPSBjLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgciA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgIHIgKz0gY1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjbCldO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBcIiNcIi5jb25jYXQobmFtZSwgXCJfXCIpLmNvbmNhdChyYW5kb20oKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBcIiNfXCIuY29uY2F0KHJhbmRvbSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICAgIHZhciBtZW0gPSB7fTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0KG5hbWUpIHtcbiAgICAgICAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtW25hbWVdID8gbWVtW25hbWVdIDogbWVtW25hbWVdID0gX1N5bWJvbChuYW1lKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX1N5bWJvbCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydHMuZ2V0ID0gZ2V0O1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRQcm90ZWN0ZWRTeW1ib2woKSB7XG4gICAgICAgICAgICAgIHJldHVybiBnZXQoXCJwcm90ZWN0ZWRcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydHMuZ2V0UHJvdGVjdGVkU3ltYm9sID0gZ2V0UHJvdGVjdGVkU3ltYm9sO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRDaGVja0NvbHVtblN0YXRlSWQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBnZXQoXCJjaGtjb2wuc3RhdGVJRFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhwb3J0cy5nZXRDaGVja0NvbHVtblN0YXRlSWQgPSBnZXRDaGVja0NvbHVtblN0YXRlSWQ7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJhZGlvQ29sdW1uU3RhdGVJZCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGdldChcInJkY29sLnN0YXRlSURcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydHMuZ2V0UmFkaW9Db2x1bW5TdGF0ZUlkID0gZ2V0UmFkaW9Db2x1bW5TdGF0ZUlkO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRCdXR0b25Db2x1bW5TdGF0ZUlkKCkge1xuICAgICAgICAgICAgICByZXR1cm4gZ2V0KFwiYnRuY29sLnN0YXRlSURcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydHMuZ2V0QnV0dG9uQ29sdW1uU3RhdGVJZCA9IGdldEJ1dHRvbkNvbHVtblN0YXRlSWQ7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldENvbHVtbkZhZGVpblN0YXRlSWQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBnZXQoXCJjb2wuZmFkZWluX3N0YXRlSURcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydHMuZ2V0Q29sdW1uRmFkZWluU3RhdGVJZCA9IGdldENvbHVtbkZhZGVpblN0YXRlSWQ7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEJyYW5jaEdyYXBoQ29sdW1uU3RhdGVJZCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGdldChcImJyYW5jaF9ncmFwaF9jb2wuc3RhdGVJRFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhwb3J0cy5nZXRCcmFuY2hHcmFwaENvbHVtblN0YXRlSWQgPSBnZXRCcmFuY2hHcmFwaENvbHVtblN0YXRlSWQ7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFRyZWVDb2x1bW5TdGF0ZUlkKCkge1xuICAgICAgICAgICAgICByZXR1cm4gZ2V0KFwidHJlZV9jb2wuc3RhdGVJRFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhwb3J0cy5nZXRUcmVlQ29sdW1uU3RhdGVJZCA9IGdldFRyZWVDb2x1bW5TdGF0ZUlkO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRTbWFsbERpYWxvZ0lucHV0RWRpdG9yU3RhdGVJZCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGdldChcInNtYWxsX2RpYWxvZ19pbnB1dF9lZGl0b3Iuc3RhdGVJRFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhwb3J0cy5nZXRTbWFsbERpYWxvZ0lucHV0RWRpdG9yU3RhdGVJZCA9IGdldFNtYWxsRGlhbG9nSW5wdXRFZGl0b3JTdGF0ZUlkO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRJbmxpbmVJbnB1dEVkaXRvclN0YXRlSWQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBnZXQoXCJpbmxpbmVfaW5wdXRfZWRpdG9yLnN0YXRlSURcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydHMuZ2V0SW5saW5lSW5wdXRFZGl0b3JTdGF0ZUlkID0gZ2V0SW5saW5lSW5wdXRFZGl0b3JTdGF0ZUlkO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRJbmxpbmVNZW51RWRpdG9yU3RhdGVJZCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGdldChcImlubGluZV9tZW51X2VkaXRvci5zdGF0ZUlEXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBleHBvcnRzLmdldElubGluZU1lbnVFZGl0b3JTdGF0ZUlkID0gZ2V0SW5saW5lTWVudUVkaXRvclN0YXRlSWQ7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldENoZWNrSGVhZGVyU3RhdGVJZCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGdldChcImNoZWNrX2hlYWRlci5zdGF0ZUlEXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBleHBvcnRzLmdldENoZWNrSGVhZGVyU3RhdGVJZCA9IGdldENoZWNrSGVhZGVyU3RhdGVJZDtcbiAgICAgICAgICAgIC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL1xuICAgICAgICAgIH0pLmNhbGwodGhpcywgX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi8uLi8uLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL2dsb2JhbC5qcyAqL1xuICAgICAgICAgIFwiLi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9nbG9iYWwuanNcIikpO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vaW50ZXJuYWwvdXRpbHMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbFV0aWxzSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5lbXB0eUZuID0gZXhwb3J0cy5zdHlsZSA9IGV4cG9ydHMuZXZlbnQgPSBleHBvcnRzLnN0ciA9IGV4cG9ydHMub2JqID0gZXhwb3J0cy5icm93c2VyID0gZXhwb3J0cy5jZWxsSW5SYW5nZSA9IGV4cG9ydHMuY2VsbEVxdWFscyA9IGV4cG9ydHMuYXJyYXkgPSBleHBvcnRzLnRoZW4gPSBleHBvcnRzLmdldElnbm9yZUNhc2UgPSBleHBvcnRzLmdldE9yQXBwbHkgPSBleHBvcnRzLmFwcGx5Q2hhaW5TYWZlID0gZXhwb3J0cy5nZXRDaGFpblNhZmUgPSBleHBvcnRzLmlzRGVzY2VuZGFudEVsZW1lbnQgPSBleHBvcnRzLmlzTm9kZSA9IGV4cG9ydHMuaXNQcm9taXNlID0gZXhwb3J0cy5leHRlbmQgPSBleHBvcnRzLmRlZmF1bHRzID0gZXhwb3J0cy5vbWl0ID0gZXhwb3J0cy5lYWNoID0gdm9pZCAwO1xuICAgICAgICAgIHZhciBpc05vZGUgPSB0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiB3aW5kb3cud2luZG93ID09PSBcInVuZGVmaW5lZFwiO1xuICAgICAgICAgIGV4cG9ydHMuaXNOb2RlID0gaXNOb2RlO1xuICAgICAgICAgIHZhciBhcnJheUZpbmQ7XG4gICAgICAgICAgdmFyIGFycmF5RmluZEluZGV4O1xuICAgICAgICAgIHZhciBhcnJheSA9IHtcbiAgICAgICAgICAgIGdldCBmaW5kKCkge1xuICAgICAgICAgICAgICBpZiAoYXJyYXlGaW5kKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5RmluZDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChBcnJheS5wcm90b3R5cGUuZmluZCkge1xuICAgICAgICAgICAgICAgIGFycmF5RmluZCA9IGZ1bmN0aW9uIGFycmF5RmluZChhcnIsIHByZWRpY2F0ZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5maW5kLmNhbGwoYXJyLCBwcmVkaWNhdGUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXJyYXlGaW5kID0gZnVuY3Rpb24gYXJyYXlGaW5kKGFyciwgcHJlZGljYXRlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBhcnJheS5maW5kSW5kZXgoYXJyLCBwcmVkaWNhdGUpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4ID49IDAgPyBhcnJbaW5kZXhdIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gYXJyYXlGaW5kO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZ2V0IGZpbmRJbmRleCgpIHtcbiAgICAgICAgICAgICAgaWYgKGFycmF5RmluZEluZGV4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5RmluZEluZGV4O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpIHtcbiAgICAgICAgICAgICAgICBhcnJheUZpbmRJbmRleCA9IGZ1bmN0aW9uIGFycmF5RmluZEluZGV4KGFyciwgcHJlZGljYXRlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleC5jYWxsKGFyciwgcHJlZGljYXRlKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFycmF5RmluZEluZGV4ID0gZnVuY3Rpb24gYXJyYXlGaW5kSW5kZXgoYXJyLCBwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBhcnIubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFycltpXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocHJlZGljYXRlKHZhbHVlLCBpLCBhcnIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gYXJyYXlGaW5kSW5kZXg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9O1xuICAgICAgICAgIGV4cG9ydHMuYXJyYXkgPSBhcnJheTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGFuYWx5emVVc2VyQWdlbnQoKSB7XG4gICAgICAgICAgICBpZiAoaXNOb2RlKSB7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgSUU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIEVkZ2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIENocm9tZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgRmlyZWZveDogZmFsc2UsXG4gICAgICAgICAgICAgICAgU2FmYXJpOiBmYWxzZVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBJRTogISEvKG1zaWV8dHJpZGVudCkvLmV4ZWModWEpLFxuICAgICAgICAgICAgICAgIEVkZ2U6IHVhLmluZGV4T2YoXCJlZGdlXCIpID4gLTEsXG4gICAgICAgICAgICAgICAgQ2hyb21lOiB1YS5pbmRleE9mKFwiY2hyb21lXCIpID4gLTEgJiYgdWEuaW5kZXhPZihcImVkZ2VcIikgPT09IC0xLFxuICAgICAgICAgICAgICAgIEZpcmVmb3g6IHVhLmluZGV4T2YoXCJmaXJlZm94XCIpID4gLTEsXG4gICAgICAgICAgICAgICAgU2FmYXJpOiB1YS5pbmRleE9mKFwic2FmYXJpXCIpID4gLTEgJiYgdWEuaW5kZXhPZihcImVkZ2VcIikgPT09IC0xXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIF9hbmFseXplVXNlckFnZW50ID0gYW5hbHl6ZVVzZXJBZ2VudCgpLFxuICAgICAgICAgICAgICBJRSA9IF9hbmFseXplVXNlckFnZW50LklFLFxuICAgICAgICAgICAgICBDaHJvbWUgPSBfYW5hbHl6ZVVzZXJBZ2VudC5DaHJvbWUsXG4gICAgICAgICAgICAgIEZpcmVmb3ggPSBfYW5hbHl6ZVVzZXJBZ2VudC5GaXJlZm94LFxuICAgICAgICAgICAgICBFZGdlID0gX2FuYWx5emVVc2VyQWdlbnQuRWRnZSxcbiAgICAgICAgICAgICAgU2FmYXJpID0gX2FuYWx5emVVc2VyQWdlbnQuU2FmYXJpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gc2V0UmVhZG9ubHkob2JqLCBuYW1lLCB2YWx1ZSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgbmFtZSwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuXG4gICAgICAgICAgZnVuY3Rpb24gZWFjaChvYmosIGZuKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgIGZuKG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5lYWNoID0gZWFjaDsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgIGZ1bmN0aW9uIGlzT2JqZWN0KG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gb21pdChzb3VyY2UsIG9taXRzKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG5cbiAgICAgICAgICAgIHZhciBfbG9vcDkgPSBmdW5jdGlvbiBfbG9vcDkoa2V5KSB7XG4gICAgICAgICAgICAgIGlmIChvbWl0cy5pbmRleE9mKGtleSkgPj0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVzdWx0LCBrZXksIHtcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2Vba2V5XTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbCkge1xuICAgICAgICAgICAgICAgICAgc291cmNlW2tleV0gPSB2YWw7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgICAgICAgdmFyIF9yZXQyID0gX2xvb3A5KGtleSk7XG5cbiAgICAgICAgICAgICAgaWYgKF9yZXQyID09PSBcImNvbnRpbnVlXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMub21pdCA9IG9taXQ7XG5cbiAgICAgICAgICBmdW5jdGlvbiBkZWZhdWx0cyhzb3VyY2UsIGRlZnMpIHtcbiAgICAgICAgICAgIHZhciBrZXlzID0gW107XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG5cbiAgICAgICAgICAgIHZhciBfbG9vcDEwID0gZnVuY3Rpb24gX2xvb3AxMChrZXkpIHtcbiAgICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXN1bHQsIGtleSwge1xuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9IHNvdXJjZVtrZXldO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbCA9PT0gdW5kZWZpbmVkID8gZGVmc1trZXldIDogdmFsO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsKSB7XG4gICAgICAgICAgICAgICAgICBzb3VyY2Vba2V5XSA9IHZhbDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICAgICAgICBfbG9vcDEwKGtleSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBfbG9vcDExID0gZnVuY3Rpb24gX2xvb3AxMShfa2V5MjMpIHtcbiAgICAgICAgICAgICAgaWYgKGtleXMuaW5kZXhPZihfa2V5MjMpID49IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlc3VsdCwgX2tleTIzLCB7XG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgdmFsID0gc291cmNlW19rZXkyM107XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdmFsID09PSB1bmRlZmluZWQgPyBkZWZzW19rZXkyM10gOiB2YWw7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWwpIHtcbiAgICAgICAgICAgICAgICAgIHNvdXJjZVtfa2V5MjNdID0gdmFsO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBfa2V5MjMgaW4gZGVmcykge1xuICAgICAgICAgICAgICB2YXIgX3JldDMgPSBfbG9vcDExKF9rZXkyMyk7XG5cbiAgICAgICAgICAgICAgaWYgKF9yZXQzID09PSBcImNvbnRpbnVlXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZGVmYXVsdHMgPSBkZWZhdWx0cztcblxuICAgICAgICAgIGZ1bmN0aW9uIGV4dGVuZCgpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcblxuICAgICAgICAgICAgZm9yICh2YXIgX2xlbjIzID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMjMpLCBfa2V5MjQgPSAwOyBfa2V5MjQgPCBfbGVuMjM7IF9rZXkyNCsrKSB7XG4gICAgICAgICAgICAgIGFyZ3NbX2tleTI0XSA9IGFyZ3VtZW50c1tfa2V5MjRdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhcmdzLmZvckVhY2goZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICAgICAgICB2YXIgX2xvb3AxMiA9IGZ1bmN0aW9uIF9sb29wMTIoa2V5KSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlc3VsdCwga2V5LCB7XG4gICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZVtrZXldO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbCkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2Vba2V5XSA9IHZhbDtcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICAgICAgICAgIF9sb29wMTIoa2V5KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZXh0ZW5kID0gZXh0ZW5kO1xuXG4gICAgICAgICAgZnVuY3Rpb24gaXNEZXNjZW5kYW50RWxlbWVudChyb290LCB0YXJnZXQpIHtcbiAgICAgICAgICAgIHdoaWxlICh0YXJnZXQucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICB2YXIgcCA9IHRhcmdldC5wYXJlbnRFbGVtZW50O1xuXG4gICAgICAgICAgICAgIGlmIChyb290ID09PSBwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0YXJnZXQgPSBwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5pc0Rlc2NlbmRhbnRFbGVtZW50ID0gaXNEZXNjZW5kYW50RWxlbWVudDtcbiAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG5cbiAgICAgICAgICBmdW5jdGlvbiBhcHBseUNoYWluU2FmZShvYmosIGZuKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBvYmo7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgKGFyZ3VtZW50cy5sZW5ndGggPD0gMiA/IDAgOiBhcmd1bWVudHMubGVuZ3RoIC0gMikgJiYgdmFsdWUgIT0gbnVsbDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhbHVlID0gZm4odmFsdWUsIGkgKyAyIDwgMiB8fCBhcmd1bWVudHMubGVuZ3RoIDw9IGkgKyAyID8gdW5kZWZpbmVkIDogYXJndW1lbnRzW2kgKyAyXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmFwcGx5Q2hhaW5TYWZlID0gYXBwbHlDaGFpblNhZmU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRDaGFpblNhZmUob2JqKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfbGVuMjQgPSBhcmd1bWVudHMubGVuZ3RoLCBuYW1lcyA9IG5ldyBBcnJheShfbGVuMjQgPiAxID8gX2xlbjI0IC0gMSA6IDApLCBfa2V5MjUgPSAxOyBfa2V5MjUgPCBfbGVuMjQ7IF9rZXkyNSsrKSB7XG4gICAgICAgICAgICAgIG5hbWVzW19rZXkyNSAtIDFdID0gYXJndW1lbnRzW19rZXkyNV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBhcHBseUNoYWluU2FmZS5hcHBseSh2b2lkIDAsIFtvYmosIGZ1bmN0aW9uICh2YWwsIG5hbWUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbFtuYW1lXTtcbiAgICAgICAgICAgIH1dLmNvbmNhdChuYW1lcykpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZ2V0Q2hhaW5TYWZlID0gZ2V0Q2hhaW5TYWZlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0T3JBcHBseSh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIF9sZW4yNSA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjI1ID4gMSA/IF9sZW4yNSAtIDEgOiAwKSwgX2tleTI2ID0gMTsgX2tleTI2IDwgX2xlbjI1OyBfa2V5MjYrKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2tleTI2IC0gMV0gPSBhcmd1bWVudHNbX2tleTI2XTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5hcHBseSh2b2lkIDAsIGFyZ3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZ2V0T3JBcHBseSA9IGdldE9yQXBwbHk7XG4gICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG5cbiAgICAgICAgICBmdW5jdGlvbiBlbmRzV2l0aChzdHIsIHNlYXJjaFN0cmluZywgcG9zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBzdWJqZWN0U3RyaW5nID0gc3RyLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgcG9zaXRpb24gIT09IFwibnVtYmVyXCIgfHwgIWlzRmluaXRlKHBvc2l0aW9uKSB8fCBNYXRoLmZsb29yKHBvc2l0aW9uKSAhPT0gcG9zaXRpb24gfHwgcG9zaXRpb24gPiBzdWJqZWN0U3RyaW5nLmxlbmd0aCkge1xuICAgICAgICAgICAgICBwb3NpdGlvbiA9IHN1YmplY3RTdHJpbmcubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwb3NpdGlvbiAtPSBzZWFyY2hTdHJpbmcubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGxhc3RJbmRleCA9IHN1YmplY3RTdHJpbmcubGFzdEluZGV4T2Yoc2VhcmNoU3RyaW5nLCBwb3NpdGlvbik7XG4gICAgICAgICAgICByZXR1cm4gbGFzdEluZGV4ICE9PSAtMSAmJiBsYXN0SW5kZXggPT09IHBvc2l0aW9uO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGdlbkNoYXJzKHMpIHtcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBDb2RlIFBvaW50XG4gICAgICAgICAgICAvLyBbXFx1RDgwMC1cXHVEQkZGXVxuICAgICAgICAgICAgLy8gVmFyaWF0aW9uIFNlbGVjdG9yc1xuICAgICAgICAgICAgLy8gRlZTIFtcXHUxODBCLVxcdTE4MERdXG4gICAgICAgICAgICAvLyBWUzHvvZ5WUzE2IFtcXHVGRTAwLVxcdUZFMEZdXG4gICAgICAgICAgICAvLyBWUzE3772eVlMyNTYgXFx1REI0MFtcXHVERDAwLVxcdURERUZdXG4gICAgICAgICAgICB2YXIgcmUgPSAvKFtcXHVEODAwLVxcdURCRkZdW1xcdURDMDAtXFx1REZGRl18XFxyXFxufFteXFx1RDgwMC1cXHVERkZGXSkoW1xcdTE4MEItXFx1MTgwRF18W1xcdUZFMDAtXFx1RkUwRl18XFx1REI0MFtcXHVERDAwLVxcdURERUZdKT8vZztcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlLmV4ZWMocyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcyAhPT0gbnVsbCA/IHJlc1swXSA6IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2VuV29yZHMocykge1xuICAgICAgICAgICAgdmFyIHJlID0gL1shLX5dK3xbXiEtflxcc10rfFxccysvZztcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlLmV4ZWMocyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcyAhPT0gbnVsbCA/IHJlc1swXSA6IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gaXNQcm9taXNlKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuKGRhdGEgJiYgdHlwZW9mIGRhdGEudGhlbiA9PT0gXCJmdW5jdGlvblwiKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmlzUHJvbWlzZSA9IGlzUHJvbWlzZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIHRoZW4ocmVzdWx0LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgcmV0dXJuIGlzUHJvbWlzZShyZXN1bHQpID8gcmVzdWx0LnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKHIpO1xuICAgICAgICAgICAgfSkgOiBjYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMudGhlbiA9IHRoZW47XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRNb3VzZUJ1dHRvbnMoZSkge1xuICAgICAgICAgICAgaWYgKGUuYnV0dG9ucyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlLmJ1dHRvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKmZvciBsZWdhY3kqL1xuXG5cbiAgICAgICAgICAgIGlmIChlLndoaWNoICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgaWYgKGUud2hpY2ggPT09IDMpIHtcbiAgICAgICAgICAgICAgICAvL3JpZ2h0P1xuICAgICAgICAgICAgICAgIHJldHVybiA0O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGUud2hpY2ggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAvL21pZGRsZT9cbiAgICAgICAgICAgICAgICByZXR1cm4gNDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBlLndoaWNoOyAvL2xlZnQgb3Igbm9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGUuYnV0dG9uID09PSAwIHx8IGUuYnV0dG9uID09PSAxKSB7XG4gICAgICAgICAgICAgIHJldHVybiAxOyAvL2NhbmRpZGF0ZSBsZWZ0XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChlLmJ1dHRvbiA9PT0gMikge1xuICAgICAgICAgICAgICByZXR1cm4gMjsgLy8gcmlnaHRcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIDA7IC8vbm8gb3IgbWlkZGxlP1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGdldEtleUNvZGUoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGUua2V5Q29kZSB8fCBlLndoaWNoO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGlzVG91Y2hFdmVudChlKSB7XG4gICAgICAgICAgICByZXR1cm4gISFlLmNoYW5nZWRUb3VjaGVzO1xuICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0SWdub3JlQ2FzZShvYmosIG5hbWUpIHtcbiAgICAgICAgICAgIGlmIChvYmpbbmFtZV0pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9ialtuYW1lXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGwgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgIGlmIChvYmpbbF0pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9ialtsXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgIGlmIChvYmpbdV0pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9ialt1XTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIgayBpbiBvYmopIHtcbiAgICAgICAgICAgICAgaWYgKGsudG9Mb3dlckNhc2UoKSA9PT0gbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmpba107XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmdldElnbm9yZUNhc2UgPSBnZXRJZ25vcmVDYXNlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gY2FuY2VsKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdG9Cb3hBcnJheShvYmopIHtcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgICAgICAgICAgIHJldHVybiBbb2JqXG4gICAgICAgICAgICAgIC8qdG9wKi9cbiAgICAgICAgICAgICAgLCBvYmpcbiAgICAgICAgICAgICAgLypyaWdodCovXG4gICAgICAgICAgICAgICwgb2JqXG4gICAgICAgICAgICAgIC8qYm90dG9tKi9cbiAgICAgICAgICAgICAgLCBvYmpcbiAgICAgICAgICAgICAgLypsZWZ0Ki9cbiAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9iai5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFtvYmpbMF1cbiAgICAgICAgICAgICAgLyp0b3AqL1xuICAgICAgICAgICAgICAsIG9ialsxXVxuICAgICAgICAgICAgICAvKnJpZ2h0Ki9cbiAgICAgICAgICAgICAgLCBvYmpbMl1cbiAgICAgICAgICAgICAgLypib3R0b20qL1xuICAgICAgICAgICAgICAsIG9ialsxXVxuICAgICAgICAgICAgICAvKmxlZnQqL1xuICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob2JqLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICByZXR1cm4gW29ialswXVxuICAgICAgICAgICAgICAvKnRvcCovXG4gICAgICAgICAgICAgICwgb2JqWzFdXG4gICAgICAgICAgICAgIC8qcmlnaHQqL1xuICAgICAgICAgICAgICAsIG9ialswXVxuICAgICAgICAgICAgICAvKmJvdHRvbSovXG4gICAgICAgICAgICAgICwgb2JqWzFdXG4gICAgICAgICAgICAgIC8qbGVmdCovXG4gICAgICAgICAgICAgIF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvYmoubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgIHJldHVybiBbb2JqWzBdXG4gICAgICAgICAgICAgIC8qdG9wKi9cbiAgICAgICAgICAgICAgLCBvYmpbMF1cbiAgICAgICAgICAgICAgLypyaWdodCovXG4gICAgICAgICAgICAgICwgb2JqWzBdXG4gICAgICAgICAgICAgIC8qYm90dG9tKi9cbiAgICAgICAgICAgICAgLCBvYmpbMF1cbiAgICAgICAgICAgICAgLypsZWZ0Ki9cbiAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBjZWxsRXF1YWxzKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBhLmNvbCA9PT0gYi5jb2wgJiYgYS5yb3cgPT09IGIucm93O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuY2VsbEVxdWFscyA9IGNlbGxFcXVhbHM7XG5cbiAgICAgICAgICBmdW5jdGlvbiBjZWxsSW5SYW5nZShyYW5nZSwgY29sLCByb3cpIHtcbiAgICAgICAgICAgIHJldHVybiByYW5nZS5zdGFydC5jb2wgPD0gY29sICYmIGNvbCA8PSByYW5nZS5lbmQuY29sICYmIHJhbmdlLnN0YXJ0LnJvdyA8PSByb3cgJiYgcm93IDw9IHJhbmdlLmVuZC5yb3c7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5jZWxsSW5SYW5nZSA9IGNlbGxJblJhbmdlO1xuICAgICAgICAgIGV4cG9ydHMuYnJvd3NlciA9IHtcbiAgICAgICAgICAgIElFOiBJRSxcbiAgICAgICAgICAgIEVkZ2U6IEVkZ2UsXG4gICAgICAgICAgICBDaHJvbWU6IENocm9tZSxcbiAgICAgICAgICAgIEZpcmVmb3g6IEZpcmVmb3gsXG4gICAgICAgICAgICBTYWZhcmk6IFNhZmFyaSxcbiAgICAgICAgICAgIC8vIENocm9tZSAxNjc3NzIxNiAob25sIENocm9tZSAzMzU1NDQzMSlcbiAgICAgICAgICAgIC8vIEZpcmVGb3ggMTc4OTU1ODhcbiAgICAgICAgICAgIC8vIElFIDEwNzM3NDMzXG4gICAgICAgICAgICBoZWlnaHRMaW1pdDogQ2hyb21lID8gMTY3NzcyMTYgOiBGaXJlZm94ID8gMTc4OTU1ODggOiAxMDczNzQzMyAvLyBkZWZhdWx0IElFIGxpbWl0XG5cbiAgICAgICAgICB9O1xuICAgICAgICAgIGV4cG9ydHMub2JqID0ge1xuICAgICAgICAgICAgc2V0UmVhZG9ubHk6IHNldFJlYWRvbmx5LFxuICAgICAgICAgICAgaXNPYmplY3Q6IGlzT2JqZWN0XG4gICAgICAgICAgfTtcbiAgICAgICAgICBleHBvcnRzLnN0ciA9IHtcbiAgICAgICAgICAgIGVuZHNXaXRoOiBlbmRzV2l0aCxcbiAgICAgICAgICAgIGdlbkNoYXJzOiBnZW5DaGFycyxcbiAgICAgICAgICAgIGdlbldvcmRzOiBnZW5Xb3Jkc1xuICAgICAgICAgIH07XG4gICAgICAgICAgZXhwb3J0cy5ldmVudCA9IHtcbiAgICAgICAgICAgIGdldE1vdXNlQnV0dG9uczogZ2V0TW91c2VCdXR0b25zLFxuICAgICAgICAgICAgZ2V0S2V5Q29kZTogZ2V0S2V5Q29kZSxcbiAgICAgICAgICAgIGlzVG91Y2hFdmVudDogaXNUb3VjaEV2ZW50LFxuICAgICAgICAgICAgY2FuY2VsOiBjYW5jZWxcbiAgICAgICAgICB9O1xuICAgICAgICAgIGV4cG9ydHMuc3R5bGUgPSB7XG4gICAgICAgICAgICB0b0JveEFycmF5OiB0b0JveEFycmF5XG4gICAgICAgICAgfTtcbiAgICAgICAgICBleHBvcnRzLmVtcHR5Rm4gPSBGdW5jdGlvbi5wcm90b3R5cGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vbGlzdC1ncmlkL0xHX0VWRU5UX1RZUEUuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9saXN0LWdyaWQvTEdfRVZFTlRfVFlQRS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RHcmlkTEdfRVZFTlRfVFlQRUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTEdfRVZFTlRfVFlQRSA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBER19FVkVOVF9UWVBFXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9jb3JlL0RHX0VWRU5UX1RZUEUgKi9cbiAgICAgICAgICBcIi4vY29yZS9ER19FVkVOVF9UWVBFLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9pbnRlcm5hbC91dGlscyAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC91dGlscy5qc1wiKTtcblxuICAgICAgICAgIGV4cG9ydHMuTEdfRVZFTlRfVFlQRSA9ICgwLCB1dGlsc18xLmV4dGVuZCkoREdfRVZFTlRfVFlQRV8xLkRHX0VWRU5UX1RZUEUsIHtcbiAgICAgICAgICAgIEJFRk9SRV9DSEFOR0VfVkFMVUU6IFwiYmVmb3JlX2NoYW5nZV92YWx1ZVwiLFxuICAgICAgICAgICAgQ0hBTkdFRF9WQUxVRTogXCJjaGFuZ2VkX3ZhbHVlXCIsXG4gICAgICAgICAgICBDSEFOR0VEX0hFQURFUl9WQUxVRTogXCJjaGFuZ2VkX2hlYWRlcl92YWx1ZVwiLFxuICAgICAgICAgICAgUkVKRUNURURfUEFTVEVfVkFMVUVTOiBcInJlamVjdGVkX3Bhc3RlX3ZhbHVlc1wiXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vbGlzdC1ncmlkL2xheW91dC1tYXAvaW5kZXguanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9saXN0LWdyaWQvbGF5b3V0LW1hcC9pbmRleC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RHcmlkTGF5b3V0TWFwSW5kZXhKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLk11bHRpTGF5b3V0TWFwID0gZXhwb3J0cy5TaW1wbGVIZWFkZXJMYXlvdXRNYXAgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgc2ltcGxlX2hlYWRlcl9sYXlvdXRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaW50ZXJuYWwvc2ltcGxlLWhlYWRlci1sYXlvdXQgKi9cbiAgICAgICAgICBcIi4vbGlzdC1ncmlkL2xheW91dC1tYXAvaW50ZXJuYWwvc2ltcGxlLWhlYWRlci1sYXlvdXQuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTaW1wbGVIZWFkZXJMYXlvdXRNYXBcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gc2ltcGxlX2hlYWRlcl9sYXlvdXRfMS5TaW1wbGVIZWFkZXJMYXlvdXRNYXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgbXVsdGlfbGF5b3V0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL211bHRpLWxheW91dCAqL1xuICAgICAgICAgIFwiLi9saXN0LWdyaWQvbGF5b3V0LW1hcC9pbnRlcm5hbC9tdWx0aS1sYXlvdXQuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJNdWx0aUxheW91dE1hcFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtdWx0aV9sYXlvdXRfMS5NdWx0aUxheW91dE1hcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9saXN0LWdyaWQvbGF5b3V0LW1hcC9pbnRlcm5hbC9tdWx0aS1sYXlvdXQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vbGlzdC1ncmlkL2xheW91dC1tYXAvaW50ZXJuYWwvbXVsdGktbGF5b3V0LmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RHcmlkTGF5b3V0TWFwSW50ZXJuYWxNdWx0aUxheW91dEpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuTXVsdGlMYXlvdXRNYXAgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgY29sdW1ucyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9jb2x1bW5zICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMuanNcIikpO1xuXG4gICAgICAgICAgdmFyIGhlYWRlckFjdGlvbiA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9oZWFkZXIvYWN0aW9uICovXG4gICAgICAgICAgXCIuL2hlYWRlci9hY3Rpb24uanNcIikpO1xuXG4gICAgICAgICAgdmFyIGhlYWRlclR5cGUgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vLi4vaGVhZGVyL3R5cGUgKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL3R5cGUuanNcIikpO1xuXG4gICAgICAgICAgdmFyIHV0aWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3V0aWxzICovXG4gICAgICAgICAgXCIuL2xpc3QtZ3JpZC9sYXlvdXQtbWFwL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gbm9ybWFsaXplTGF5b3V0KGxheW91dCkge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobGF5b3V0KSkge1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGhlYWRlcjogbGF5b3V0LFxuICAgICAgICAgICAgICAgIGJvZHk6IGxheW91dFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbGF5b3V0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBzZXFJZCA9IDA7XG5cbiAgICAgICAgICB2YXIgTGF5b3V0T2JqZWN0R3JpZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBMYXlvdXRPYmplY3RHcmlkKGxheW91dCwgdHJhbnNmb3JtKSB7XG4gICAgICAgICAgICAgIHZhciBfdGhpczEwOCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExheW91dE9iamVjdEdyaWQpO1xuXG4gICAgICAgICAgICAgIHRoaXMub2JqZWN0cyA9IFtdO1xuICAgICAgICAgICAgICB0aGlzLm9iamVjdEdyaWQgPSBbXTtcbiAgICAgICAgICAgICAgdGhpcy5vYmplY3RNYXAgPSB7fTtcbiAgICAgICAgICAgICAgdGhpcy5jb2x1bW5Db3VudCA9IDA7XG4gICAgICAgICAgICAgIHRoaXMuY29sdW1uV2lkdGhzID0gW107XG4gICAgICAgICAgICAgIGxheW91dC5mb3JFYWNoKGZ1bmN0aW9uIChyb3dMYXlvdXQsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBjb2wgPSAwO1xuICAgICAgICAgICAgICAgIHJvd0xheW91dC5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX2EsIF9iO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgaWQgPSBzZXFJZCsrO1xuICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHRyYW5zZm9ybShjZWxsLCBpZCk7XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzMTA4Lm9iamVjdHMucHVzaChvYmopO1xuXG4gICAgICAgICAgICAgICAgICBfdGhpczEwOC5vYmplY3RNYXBbaWRdID0gb2JqO1xuICAgICAgICAgICAgICAgICAgY29sID0gX3RoaXMxMDguX2ZpbmRTdGFydENlbGwoY29sLCByb3cpO1xuICAgICAgICAgICAgICAgICAgdmFyIHJvd1NwYW4gPSBOdW1iZXIoKF9hID0gY2VsbC5yb3dTcGFuKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAxKTtcbiAgICAgICAgICAgICAgICAgIHZhciBjb2xTcGFuID0gTnVtYmVyKChfYiA9IGNlbGwuY29sU3BhbikgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogMSk7XG4gICAgICAgICAgICAgICAgICB2YXIgZW5kUm93ID0gcm93ICsgcm93U3BhbjtcbiAgICAgICAgICAgICAgICAgIHZhciBlbmRDb2wgPSBjb2wgKyBjb2xTcGFuO1xuXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciByb3dJbmRleCA9IHJvdzsgcm93SW5kZXggPCBlbmRSb3c7IHJvd0luZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdEdyaWRSb3cgPSBfdGhpczEwOC5fZ2V0T2JqZWN0R3JpZFJvdyhyb3dJbmRleCk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgY29sSW5kZXggPSBjb2w7IGNvbEluZGV4IDwgZW5kQ29sOyBjb2xJbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgb2JqZWN0R3JpZFJvd1tjb2xJbmRleF0gPSBvYmo7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWYgKGNvbFNwYW4gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMDguX3NldFdpZHRoRGF0YUlmQWJzZW50KGNvbCwgY2VsbCk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzMTA4Ll91c2VDb2x1bW5JbmRleChlbmRDb2wgLSAxKTtcblxuICAgICAgICAgICAgICAgICAgY29sID0gZW5kQ29sO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKExheW91dE9iamVjdEdyaWQsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJyb3dDb3VudFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vYmplY3RHcmlkLmxlbmd0aDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2ZpbmRTdGFydENlbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9maW5kU3RhcnRDZWxsKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdEdyaWRSb3cgPSB0aGlzLl9nZXRPYmplY3RHcmlkUm93KHJvdyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IGNvbDsgaW5kZXggPCBvYmplY3RHcmlkUm93Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgaWYgKCFvYmplY3RHcmlkUm93W2luZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdEdyaWRSb3cubGVuZ3RoO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfZ2V0T2JqZWN0R3JpZFJvd1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2dldE9iamVjdEdyaWRSb3cocm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub2JqZWN0R3JpZFtyb3ddIHx8ICh0aGlzLm9iamVjdEdyaWRbcm93XSA9IFtdKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX3VzZUNvbHVtbkluZGV4XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfdXNlQ29sdW1uSW5kZXgoY29sKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29sdW1uQ291bnQgPiBjb2wpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbkNvdW50ID0gY29sICsgMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX3NldFdpZHRoRGF0YUlmQWJzZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0V2lkdGhEYXRhSWZBYnNlbnQoY29sLCBjZWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNvbHVtbldpZHRoc1tjb2xdKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoY2VsbC53aWR0aCAhPSBudWxsIHx8IGNlbGwubWF4V2lkdGggIT0gbnVsbCB8fCBjZWxsLm1pbldpZHRoICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5XaWR0aHNbY29sXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogY2VsbC53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aDogY2VsbC5tYXhXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICBtaW5XaWR0aDogY2VsbC5taW5XaWR0aFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTGF5b3V0T2JqZWN0R3JpZDtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICB2YXIgTXVsdGlMYXlvdXRNYXAgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gTXVsdGlMYXlvdXRNYXAobGF5b3V0KSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNdWx0aUxheW91dE1hcCk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fY29sdW1uV2lkdGhzID0gW107XG4gICAgICAgICAgICAgIHRoaXMuX2VtcHR5RGF0YUNhY2hlID0gbmV3IHV0aWxzXzEuRW1wdHlEYXRhQ2FjaGUoKTtcbiAgICAgICAgICAgICAgdmFyIGhiTGF5b3V1dCA9IG5vcm1hbGl6ZUxheW91dChsYXlvdXQpO1xuICAgICAgICAgICAgICB2YXIgaGVhZGVyID0gdGhpcy5faGVhZGVyID0gbmV3IExheW91dE9iamVjdEdyaWQoaGJMYXlvdXV0LmhlYWRlciwgZnVuY3Rpb24gKGhkLCBpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICBjYXB0aW9uOiBoZC5jYXB0aW9uLFxuICAgICAgICAgICAgICAgICAgZmllbGQ6IGhkLmhlYWRlckZpZWxkIHx8IGhkLmZpZWxkLFxuICAgICAgICAgICAgICAgICAgaGVhZGVySWNvbjogaGQuaGVhZGVySWNvbixcbiAgICAgICAgICAgICAgICAgIHN0eWxlOiBoZC5oZWFkZXJTdHlsZSxcbiAgICAgICAgICAgICAgICAgIGhlYWRlclR5cGU6IGhlYWRlclR5cGUub2ZDZWxsKGhkKSxcbiAgICAgICAgICAgICAgICAgIGFjdGlvbjogaGVhZGVyQWN0aW9uLm9mQ2VsbChoZCksXG4gICAgICAgICAgICAgICAgICBkZWZpbmU6IGhkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5fYm9keSA9IG5ldyBMYXlvdXRPYmplY3RHcmlkKGhiTGF5b3V1dC5ib2R5LCBmdW5jdGlvbiAoY29sRGVmLCBpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICBmaWVsZDogY29sRGVmLmZpZWxkLFxuICAgICAgICAgICAgICAgICAgd2lkdGg6IGNvbERlZi53aWR0aCxcbiAgICAgICAgICAgICAgICAgIG1pbldpZHRoOiBjb2xEZWYubWluV2lkdGgsXG4gICAgICAgICAgICAgICAgICBtYXhXaWR0aDogY29sRGVmLm1heFdpZHRoLFxuICAgICAgICAgICAgICAgICAgaWNvbjogY29sRGVmLmljb24sXG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiBjb2xEZWYubWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgIGNvbHVtblR5cGU6IGNvbHVtbnMudHlwZS5vZihjb2xEZWYuY29sdW1uVHlwZSksXG4gICAgICAgICAgICAgICAgICBhY3Rpb246IGNvbHVtbnMuYWN0aW9uLm9mKGNvbERlZi5hY3Rpb24pLFxuICAgICAgICAgICAgICAgICAgc3R5bGU6IGNvbERlZi5zdHlsZSxcbiAgICAgICAgICAgICAgICAgIGRlZmluZTogY29sRGVmXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHZhciBjb2x1bW5Db3VudCA9IHRoaXMuX2NvbHVtbkNvdW50ID0gTWF0aC5tYXgoaGVhZGVyLmNvbHVtbkNvdW50LCBib2R5LmNvbHVtbkNvdW50KTtcblxuICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCBjb2x1bW5Db3VudDsgY29sKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGhEZWYgPSBoZWFkZXIuY29sdW1uV2lkdGhzW2NvbF0gfHwgYm9keS5jb2x1bW5XaWR0aHNbY29sXSB8fCB7fTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb2x1bW5XaWR0aHNbY29sXSA9IHdpZHRoRGVmO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhNdWx0aUxheW91dE1hcCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNvbHVtbldpZHRoc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29sdW1uV2lkdGhzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoZWFkZXJSb3dDb3VudFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVhZGVyLnJvd0NvdW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJib2R5Um93Q291bnRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JvZHkucm93Q291bnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbENvdW50XCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb2x1bW5Db3VudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaGVhZGVyT2JqZWN0c1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVhZGVyLm9iamVjdHM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbHVtbk9iamVjdHNcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JvZHkub2JqZWN0cztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Q2VsbElkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDZWxsSWQoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWFkZXJSb3dDb3VudCA8PSByb3cpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBib2R5Um93ID0gcm93IC0gdGhpcy5oZWFkZXJSb3dDb3VudDtcbiAgICAgICAgICAgICAgICAgIHZhciBib2R5TGF5b3V0Um93ID0gYm9keVJvdyAlIHRoaXMuYm9keVJvd0NvdW50O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIChfYiA9IChfYSA9IHRoaXMuX2JvZHkub2JqZWN0R3JpZFtib2R5TGF5b3V0Um93XSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hW2NvbF0pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5pZDtcbiAgICAgICAgICAgICAgICB9IC8vaW4gaGVhZGVyXG5cblxuICAgICAgICAgICAgICAgIHJldHVybiAoX2QgPSAoX2MgPSB0aGlzLl9oZWFkZXIub2JqZWN0R3JpZFtyb3ddKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NbY29sXSkgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmlkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRIZWFkZXJcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEhlYWRlcihjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IHRoaXMuZ2V0Q2VsbElkKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVhZGVyLm9iamVjdE1hcFtpZF0gfHwgdGhpcy5fZW1wdHlEYXRhQ2FjaGUuZ2V0SGVhZGVyKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZ2V0Qm9keVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Qm9keShjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IHRoaXMuZ2V0Q2VsbElkKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYm9keS5vYmplY3RNYXBbaWRdIHx8IHRoaXMuX2VtcHR5RGF0YUNhY2hlLmdldEJvZHkoY29sLCByb3cpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRCb2R5TGF5b3V0UmFuZ2VCeUlkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb2R5TGF5b3V0UmFuZ2VCeUlkKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5ib2R5Um93Q291bnQ7IHJvdysrKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0R3JpZFJvdyA9IHRoaXMuX2JvZHkub2JqZWN0R3JpZFtyb3ddO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIW9iamVjdEdyaWRSb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY29sQ291bnQ7IGNvbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gKChfYSA9IG9iamVjdEdyaWRSb3dbY29sXSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRDZWxsUmFuZ2UodGhpcy5fYm9keSwgY29sLCByb3csIDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2FuIG5vdCBmb3VuZCBib2R5IGxheW91dCBAaWQ9XCIuY29uY2F0KGlkKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENlbGxSYW5nZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbFJhbmdlKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVhZGVyUm93Q291bnQgPD0gcm93KSB7XG4gICAgICAgICAgICAgICAgICB2YXIgcmVjb3JkSW5kZXggPSB0aGlzLmdldFJlY29yZEluZGV4QnlSb3cocm93KTtcbiAgICAgICAgICAgICAgICAgIHZhciBzdGFydFJvdyA9IHRoaXMuZ2V0UmVjb3JkU3RhcnRSb3dCeVJlY29yZEluZGV4KHJlY29yZEluZGV4KTtcbiAgICAgICAgICAgICAgICAgIHZhciBib2R5Um93ID0gcm93IC0gdGhpcy5oZWFkZXJSb3dDb3VudDtcbiAgICAgICAgICAgICAgICAgIHZhciBib2R5TGF5b3V0Um93ID0gYm9keVJvdyAlIHRoaXMuYm9keVJvd0NvdW50O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENlbGxSYW5nZSh0aGlzLl9ib2R5LCBjb2wsIGJvZHlMYXlvdXRSb3csIHN0YXJ0Um93KTtcbiAgICAgICAgICAgICAgICB9IC8vaW4gaGVhZGVyXG5cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRDZWxsUmFuZ2UodGhpcy5faGVhZGVyLCBjb2wsIHJvdywgMCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldFJlY29yZEluZGV4QnlSb3dcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJlY29yZEluZGV4QnlSb3cocm93KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJvdyA8IHRoaXMuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdmFyIGJvZHlSb3cgPSByb3cgLSB0aGlzLmhlYWRlclJvd0NvdW50O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoYm9keVJvdyAvIHRoaXMuYm9keVJvd0NvdW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldFJlY29yZFN0YXJ0Um93QnlSZWNvcmRJbmRleFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVjb3JkU3RhcnRSb3dCeVJlY29yZEluZGV4KGluZGV4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyUm93Q291bnQgKyBpbmRleCAqIHRoaXMuYm9keVJvd0NvdW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfZ2V0Q2VsbFJhbmdlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0Q2VsbFJhbmdlKCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICBsYXlvdXQsIGNvbCwgbGF5b3V0Um93LCBvZmZzZXRSb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2csIF9oLCBfaiwgX2s7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgc3RhcnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogbGF5b3V0Um93ICsgb2Zmc2V0Um93XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgZW5kOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICByb3c6IGxheW91dFJvdyArIG9mZnNldFJvd1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdEdyaWQgPSBsYXlvdXQub2JqZWN0R3JpZDtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSAoX2IgPSAoX2EgPSBvYmplY3RHcmlkW2xheW91dFJvd10pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVtjb2xdKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuaWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoaWQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gY29sIC0gMTsgYyA+PSAwOyBjLS0pIHtcbiAgICAgICAgICAgICAgICAgIGlmIChpZCAhPT0gKChfZCA9IChfYyA9IG9iamVjdEdyaWRbbGF5b3V0Um93XSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jW2NdKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXN1bHQuc3RhcnQuY29sID0gYztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYzYgPSBjb2wgKyAxOyBfYzYgPCBsYXlvdXQuY29sdW1uQ291bnQ7IF9jNisrKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoaWQgIT09ICgoX2YgPSAoX2UgPSBvYmplY3RHcmlkW2xheW91dFJvd10pID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZVtfYzZdKSA9PT0gbnVsbCB8fCBfZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2YuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXN1bHQuZW5kLmNvbCA9IF9jNjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciByID0gbGF5b3V0Um93IC0gMTsgciA+PSAwOyByLS0pIHtcbiAgICAgICAgICAgICAgICAgIGlmIChpZCAhPT0gKChfaCA9IChfZyA9IG9iamVjdEdyaWRbcl0pID09PSBudWxsIHx8IF9nID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZ1tjb2xdKSA9PT0gbnVsbCB8fCBfaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2guaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXN1bHQuc3RhcnQucm93ID0gciArIG9mZnNldFJvdztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfcjIgPSBsYXlvdXRSb3cgKyAxOyBfcjIgPCBsYXlvdXQucm93Q291bnQ7IF9yMisrKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoaWQgIT09ICgoX2sgPSAoX2ogPSBvYmplY3RHcmlkW19yMl0pID09PSBudWxsIHx8IF9qID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaltjb2xdKSA9PT0gbnVsbCB8fCBfayA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2suaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXN1bHQuZW5kLnJvdyA9IF9yMiArIG9mZnNldFJvdztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBNdWx0aUxheW91dE1hcDtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLk11bHRpTGF5b3V0TWFwID0gTXVsdGlMYXlvdXRNYXA7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vbGlzdC1ncmlkL2xheW91dC1tYXAvaW50ZXJuYWwvc2ltcGxlLWhlYWRlci1sYXlvdXQuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9saXN0LWdyaWQvbGF5b3V0LW1hcC9pbnRlcm5hbC9zaW1wbGUtaGVhZGVyLWxheW91dC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RHcmlkTGF5b3V0TWFwSW50ZXJuYWxTaW1wbGVIZWFkZXJMYXlvdXRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSB0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuXG4gICAgICAgICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICAgICAgICBkZXNjID0ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgICAgICAgICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICAgICAgICAgIG9bazJdID0gbVtrXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX3NldE1vZHVsZURlZmF1bHQgPSB0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0IHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwge1xuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB2YWx1ZTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSA6IGZ1bmN0aW9uIChvLCB2KSB7XG4gICAgICAgICAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnRTdGFyID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhciB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkge1xuICAgICAgICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlNpbXBsZUhlYWRlckxheW91dE1hcCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBjb2x1bW5zID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2NvbHVtbnMgKi9cbiAgICAgICAgICBcIi4vY29sdW1ucy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgaGVhZGVyQWN0aW9uID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2hlYWRlci9hY3Rpb24gKi9cbiAgICAgICAgICBcIi4vaGVhZGVyL2FjdGlvbi5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgaGVhZGVyVHlwZSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi8uLi8uLi9oZWFkZXIvdHlwZSAqL1xuICAgICAgICAgIFwiLi9oZWFkZXIvdHlwZS5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdXRpbHMgKi9cbiAgICAgICAgICBcIi4vbGlzdC1ncmlkL2xheW91dC1tYXAvaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgc2VxSWQgPSAwO1xuXG4gICAgICAgICAgdmFyIFNpbXBsZUhlYWRlckxheW91dE1hcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaW1wbGVIZWFkZXJMYXlvdXRNYXAoaGVhZGVyKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTaW1wbGVIZWFkZXJMYXlvdXRNYXApO1xuXG4gICAgICAgICAgICAgIHRoaXMuYm9keVJvd0NvdW50ID0gMTtcbiAgICAgICAgICAgICAgdGhpcy5fZW1wdHlEYXRhQ2FjaGUgPSBuZXcgdXRpbHNfMS5FbXB0eURhdGFDYWNoZSgpO1xuICAgICAgICAgICAgICB0aGlzLl9jb2x1bW5zID0gW107XG4gICAgICAgICAgICAgIHRoaXMuX2hlYWRlckNlbGxJZHMgPSBbXTtcbiAgICAgICAgICAgICAgdGhpcy5faGVhZGVyT2JqZWN0cyA9IHRoaXMuX2FkZEhlYWRlcnMoMCwgaGVhZGVyLCBbXSk7XG4gICAgICAgICAgICAgIHRoaXMuX2hlYWRlck9iamVjdE1hcCA9IHRoaXMuX2hlYWRlck9iamVjdHMucmVkdWNlKGZ1bmN0aW9uIChvLCBlKSB7XG4gICAgICAgICAgICAgICAgb1tlLmlkXSA9IGU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgICAgIH0sIHt9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFNpbXBsZUhlYWRlckxheW91dE1hcCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImNvbHVtbldpZHRoc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29sdW1ucztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaGVhZGVyUm93Q291bnRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlYWRlckNlbGxJZHMubGVuZ3RoO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJjb2xDb3VudFwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29sdW1ucy5sZW5ndGg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImhlYWRlck9iamVjdHNcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlYWRlck9iamVjdHM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbHVtbk9iamVjdHNcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbHVtbnM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldENlbGxJZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbElkKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVhZGVyUm93Q291bnQgPD0gcm93KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29sdW1uc1tjb2xdLmlkO1xuICAgICAgICAgICAgICAgIH0gLy9pbiBoZWFkZXJcblxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlYWRlckNlbGxJZHNbcm93XVtjb2xdO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRIZWFkZXJcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEhlYWRlcihjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IHRoaXMuZ2V0Q2VsbElkKGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVhZGVyT2JqZWN0TWFwW2lkXSB8fCB0aGlzLl9lbXB0eURhdGFDYWNoZS5nZXRIZWFkZXIoY29sLCByb3cpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRCb2R5XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb2R5KGNvbCwgX3Jvdykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb2x1bW5zW2NvbF0gfHwgdGhpcy5fZW1wdHlEYXRhQ2FjaGUuZ2V0Qm9keShjb2wsIDApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRCb2R5TGF5b3V0UmFuZ2VCeUlkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb2R5TGF5b3V0UmFuZ2VCeUlkKGlkKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgdGhpcy5jb2xDb3VudDsgY29sKyspIHtcbiAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gdGhpcy5fY29sdW1uc1tjb2xdLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgcm93OiAwXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBlbmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbDogY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgcm93OiAwXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbiBub3QgZm91bmQgYm9keSBsYXlvdXQgQGlkPVwiLmNvbmNhdChpZCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRDZWxsUmFuZ2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENlbGxSYW5nZShjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgICAgICBjb2w6IGNvbCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiByb3dcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBlbmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhlYWRlclJvd0NvdW50IDw9IHJvdykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9IC8vaW4gaGVhZGVyXG5cblxuICAgICAgICAgICAgICAgIHZhciBpZCA9IHRoaXMuZ2V0Q2VsbElkKGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSBjb2wgLSAxOyBjID49IDA7IGMtLSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGlkICE9PSB0aGlzLmdldENlbGxJZChjLCByb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXN1bHQuc3RhcnQuY29sID0gYztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYzcgPSBjb2wgKyAxOyBfYzcgPCB0aGlzLmNvbENvdW50OyBfYzcrKykge1xuICAgICAgICAgICAgICAgICAgaWYgKGlkICE9PSB0aGlzLmdldENlbGxJZChfYzcsIHJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJlc3VsdC5lbmQuY29sID0gX2M3O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAodmFyIHIgPSByb3cgLSAxOyByID49IDA7IHItLSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGlkICE9PSB0aGlzLmdldENlbGxJZChjb2wsIHIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICByZXN1bHQuc3RhcnQucm93ID0gcjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfcjMgPSByb3cgKyAxOyBfcjMgPCB0aGlzLmhlYWRlclJvd0NvdW50OyBfcjMrKykge1xuICAgICAgICAgICAgICAgICAgaWYgKGlkICE9PSB0aGlzLmdldENlbGxJZChjb2wsIF9yMykpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJlc3VsdC5lbmQucm93ID0gX3IzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImdldFJlY29yZEluZGV4QnlSb3dcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJlY29yZEluZGV4QnlSb3cocm93KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJvdyA8IHRoaXMuaGVhZGVyUm93Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvdyAtIHRoaXMuaGVhZGVyUm93Q291bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRSZWNvcmRTdGFydFJvd0J5UmVjb3JkSW5kZXhcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJlY29yZFN0YXJ0Um93QnlSZWNvcmRJbmRleChpbmRleCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmhlYWRlclJvd0NvdW50ICsgaW5kZXg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9hZGRIZWFkZXJzXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYWRkSGVhZGVycyhyb3csIGhlYWRlciwgcm9vdHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxMDkgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcblxuICAgICAgICAgICAgICAgIHZhciByb3dDZWxscyA9IHRoaXMuX2hlYWRlckNlbGxJZHNbcm93XSB8fCB0aGlzLl9uZXdSb3cocm93KTtcblxuICAgICAgICAgICAgICAgIGhlYWRlci5mb3JFYWNoKGZ1bmN0aW9uIChoZCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IF90aGlzMTA5Ll9jb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgIHZhciBpZCA9IHNlcUlkKys7XG4gICAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICBjYXB0aW9uOiBoZC5jYXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICBmaWVsZDogaGQuaGVhZGVyRmllbGQgfHwgaGQuZmllbGQsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlckljb246IGhkLmhlYWRlckljb24sXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiBoZC5oZWFkZXJTdHlsZSxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyVHlwZTogaGVhZGVyVHlwZS5vZkNlbGwoaGQpLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IGhlYWRlckFjdGlvbi5vZkNlbGwoaGQpLFxuICAgICAgICAgICAgICAgICAgICBkZWZpbmU6IGhkXG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgcmVzdWx0c1tpZF0gPSBjZWxsO1xuICAgICAgICAgICAgICAgICAgcm93Q2VsbHNbY29sXSA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciByID0gcm93IC0gMTsgciA+PSAwOyByLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMDkuX2hlYWRlckNlbGxJZHNbcl1bY29sXSA9IHJvb3RzW3JdO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpZiAoaGQuY29sdW1ucykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczEwOS5fYWRkSGVhZGVycyhyb3cgKyAxLCBoZC5jb2x1bW5zLCBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHJvb3RzKSwgW2lkXSkpLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cy5wdXNoKGMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xEZWYgPSBoZDtcblxuICAgICAgICAgICAgICAgICAgICBfdGhpczEwOS5fY29sdW1ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICBpZDogc2VxSWQrKyxcbiAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogY29sRGVmLmZpZWxkLFxuICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBjb2xEZWYud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgbWluV2lkdGg6IGNvbERlZi5taW5XaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aDogY29sRGVmLm1heFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgIGljb246IGNvbERlZi5pY29uLFxuICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGNvbERlZi5tZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbHVtblR5cGU6IGNvbHVtbnMudHlwZS5vZihjb2xEZWYuY29sdW1uVHlwZSksXG4gICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBjb2x1bW5zLmFjdGlvbi5vZihjb2xEZWYuYWN0aW9uKSxcbiAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogY29sRGVmLnN0eWxlLFxuICAgICAgICAgICAgICAgICAgICAgIGRlZmluZTogY29sRGVmXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9yNCA9IHJvdyArIDE7IF9yNCA8IF90aGlzMTA5Ll9oZWFkZXJDZWxsSWRzLmxlbmd0aDsgX3I0KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICBfdGhpczEwOS5faGVhZGVyQ2VsbElkc1tfcjRdW2NvbF0gPSBpZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJfbmV3Um93XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbmV3Um93KHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdSb3cgPSB0aGlzLl9oZWFkZXJDZWxsSWRzW3Jvd10gPSBbXTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdSb3c7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHByZXYgPSB0aGlzLl9oZWFkZXJDZWxsSWRzW3JvdyAtIDFdO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgcHJldi5sZW5ndGg7IGNvbCsrKSB7XG4gICAgICAgICAgICAgICAgICBuZXdSb3dbY29sXSA9IHByZXZbY29sXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Um93O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBTaW1wbGVIZWFkZXJMYXlvdXRNYXA7XG4gICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgZXhwb3J0cy5TaW1wbGVIZWFkZXJMYXlvdXRNYXAgPSBTaW1wbGVIZWFkZXJMYXlvdXRNYXA7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vbGlzdC1ncmlkL2xheW91dC1tYXAvaW50ZXJuYWwvdXRpbHMuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9saXN0LWdyaWQvbGF5b3V0LW1hcC9pbnRlcm5hbC91dGlscy5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RHcmlkTGF5b3V0TWFwSW50ZXJuYWxVdGlsc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuRW1wdHlEYXRhQ2FjaGUgPSBleHBvcnRzLm5ld0VtcHR5Q29sdW1uRGF0YSA9IGV4cG9ydHMubmV3RW1wdHlIZWFkZXJEYXRhID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGNvbHVtbnMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vLi4vY29sdW1ucyAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBoZWFkZXJUeXBlID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uLy4uL2hlYWRlci90eXBlICovXG4gICAgICAgICAgXCIuL2hlYWRlci90eXBlLmpzXCIpKTtcblxuICAgICAgICAgIHZhciBzZXFJZCA9IC0xOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gICAgICAgICAgZnVuY3Rpb24gbmV3RW1wdHlIZWFkZXJEYXRhKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgaWQ6IHNlcUlkLS0sXG4gICAgICAgICAgICAgIGRlZmluZToge30sXG4gICAgICAgICAgICAgIGhlYWRlclR5cGU6IGhlYWRlclR5cGUub2YobnVsbCkgLy8gZGVmYXVsdFxuXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMubmV3RW1wdHlIZWFkZXJEYXRhID0gbmV3RW1wdHlIZWFkZXJEYXRhOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gICAgICAgICAgZnVuY3Rpb24gbmV3RW1wdHlDb2x1bW5EYXRhKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgaWQ6IHNlcUlkLS0sXG4gICAgICAgICAgICAgIGRlZmluZToge30sXG4gICAgICAgICAgICAgIGNvbHVtblR5cGU6IGNvbHVtbnMudHlwZS5vZihudWxsKSxcbiAgICAgICAgICAgICAgc3R5bGU6IG51bGxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5uZXdFbXB0eUNvbHVtbkRhdGEgPSBuZXdFbXB0eUNvbHVtbkRhdGE7XG5cbiAgICAgICAgICB2YXIgRW1wdHlEYXRhQ2FjaGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRW1wdHlEYXRhQ2FjaGUoKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFbXB0eURhdGFDYWNoZSk7XG5cbiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgdGhpcy5oZWFkZXJzID0gW107IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgICAgdGhpcy5jb2x1bW5zID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhFbXB0eURhdGFDYWNoZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImdldEhlYWRlclwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SGVhZGVyKGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmhlYWRlcnNbcm93XSB8fCAodGhpcy5oZWFkZXJzW3Jvd10gPSBbXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvd3NbY29sXSB8fCAocm93c1tjb2xdID0gbmV3RW1wdHlIZWFkZXJEYXRhKCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJnZXRCb2R5XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb2R5KGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmNvbHVtbnNbcm93XSB8fCAodGhpcy5jb2x1bW5zW3Jvd10gPSBbXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvd3NbY29sXSB8fCAocm93c1tjb2xdID0gbmV3RW1wdHlDb2x1bW5EYXRhKCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBFbXB0eURhdGFDYWNoZTtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLkVtcHR5RGF0YUNhY2hlID0gRW1wdHlEYXRhQ2FjaGU7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vbWFpbi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vbWFpbi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gbWFpbkpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMucmVnaXN0ZXIgPSBleHBvcnRzLmdldEljb25zID0gZXhwb3J0cy5HcmlkQ2FudmFzSGVscGVyID0gZXhwb3J0cy5kYXRhID0gZXhwb3J0cy50aGVtZXMgPSBleHBvcnRzLmhlYWRlcnMgPSBleHBvcnRzLmNvbHVtbnMgPSBleHBvcnRzLkxpc3RHcmlkID0gZXhwb3J0cy50b29scyA9IGV4cG9ydHMuY29yZSA9IGV4cG9ydHMuX2dldEludGVybmFsID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGNvbHVtbnMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9jb2x1bW5zICovXG4gICAgICAgICAgXCIuL2NvbHVtbnMuanNcIikpO1xuXG4gICAgICAgICAgZXhwb3J0cy5jb2x1bW5zID0gY29sdW1ucztcblxuICAgICAgICAgIHZhciBjb3JlID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vY29yZSAqL1xuICAgICAgICAgIFwiLi9jb3JlLmpzXCIpKTtcblxuICAgICAgICAgIGV4cG9ydHMuY29yZSA9IGNvcmU7XG5cbiAgICAgICAgICB2YXIgZGF0YSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2RhdGEgKi9cbiAgICAgICAgICBcIi4vZGF0YS5qc1wiKSk7XG5cbiAgICAgICAgICBleHBvcnRzLmRhdGEgPSBkYXRhO1xuXG4gICAgICAgICAgdmFyIGhlYWRlcnMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9oZWFkZXJzICovXG4gICAgICAgICAgXCIuL2hlYWRlcnMuanNcIikpO1xuXG4gICAgICAgICAgZXhwb3J0cy5oZWFkZXJzID0gaGVhZGVycztcblxuICAgICAgICAgIHZhciBpY29ucyA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ljb25zICovXG4gICAgICAgICAgXCIuL2ljb25zLmpzXCIpKTtcblxuICAgICAgICAgIHZhciByZWdpc3RlciA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3JlZ2lzdGVyICovXG4gICAgICAgICAgXCIuL3JlZ2lzdGVyLmpzXCIpKTtcblxuICAgICAgICAgIGV4cG9ydHMucmVnaXN0ZXIgPSByZWdpc3RlcjtcblxuICAgICAgICAgIHZhciB0aGVtZXMgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90aGVtZXMgKi9cbiAgICAgICAgICBcIi4vdGhlbWVzLmpzXCIpKTtcblxuICAgICAgICAgIGV4cG9ydHMudGhlbWVzID0gdGhlbWVzO1xuXG4gICAgICAgICAgdmFyIHRvb2xzID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdG9vbHMgKi9cbiAgICAgICAgICBcIi4vdG9vbHMuanNcIikpO1xuXG4gICAgICAgICAgZXhwb3J0cy50b29scyA9IHRvb2xzO1xuXG4gICAgICAgICAgdmFyIExpc3RHcmlkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0xpc3RHcmlkICovXG4gICAgICAgICAgXCIuL0xpc3RHcmlkLmpzXCIpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTGlzdEdyaWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gTGlzdEdyaWRfMS5MaXN0R3JpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBHcmlkQ2FudmFzSGVscGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL0dyaWRDYW52YXNIZWxwZXIgKi9cbiAgICAgICAgICBcIi4vR3JpZENhbnZhc0hlbHBlci5qc1wiKTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkdyaWRDYW52YXNIZWxwZXJcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gR3JpZENhbnZhc0hlbHBlcl8xLkdyaWRDYW52YXNIZWxwZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgZ2V0X2ludGVybmFsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2dldC1pbnRlcm5hbCAqL1xuICAgICAgICAgIFwiLi9nZXQtaW50ZXJuYWwuanNcIik7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfZ2V0SW50ZXJuYWxcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gZ2V0X2ludGVybmFsXzEuZ2V0SW50ZXJuYWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLyoqIEBwcml2YXRlICovXG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRJY29ucygpIHtcbiAgICAgICAgICAgIHJldHVybiBpY29ucy5nZXQoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmdldEljb25zID0gZ2V0SWNvbnM7IC8vIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblxuICAgICAgICAgIGV4cG9ydHMuZGVmYXVsdCA9IHtcbiAgICAgICAgICAgIGNvcmU6IGNvcmUsXG4gICAgICAgICAgICB0b29sczogdG9vbHMsXG4gICAgICAgICAgICAvLyBpbXBsIEdyaWRzXG4gICAgICAgICAgICBMaXN0R3JpZDogTGlzdEdyaWRfMS5MaXN0R3JpZCxcbiAgICAgICAgICAgIC8vIG9iamVjdHNcbiAgICAgICAgICAgIGNvbHVtbnM6IGNvbHVtbnMsXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgICAgICAgICAgdGhlbWVzOiB0aGVtZXMsXG4gICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgLy8gaGVscGVyXG4gICAgICAgICAgICBHcmlkQ2FudmFzSGVscGVyOiBHcmlkQ2FudmFzSGVscGVyXzEuR3JpZENhbnZhc0hlbHBlcixcbiAgICAgICAgICAgIC8vcGx1Z2luIHJlZ2lzdGVyc1xuICAgICAgICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyLFxuXG4gICAgICAgICAgICBnZXQgaWNvbnMoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBnZXRJY29ucygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGVtZXMsIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhlbWVzLmdldERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChkZWZhdWx0VGhlbWUpIHtcbiAgICAgICAgICAgICAgdGhlbWVzLnNldERlZmF1bHQoZGVmYXVsdFRoZW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGVtZXMsIFwiY2hvaWNlc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhlbWVzLmdldENob2ljZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9wbHVnaW5zL2ljb25zLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9wbHVnaW5zL2ljb25zLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiBwbHVnaW5zSWNvbnNKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLmljb25zID0gdm9pZCAwO1xuICAgICAgICAgIGV4cG9ydHMuaWNvbnMgPSB7fTtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi9wbHVnaW5zL3RoZW1lcy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL3BsdWdpbnMvdGhlbWVzLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gcGx1Z2luc1RoZW1lc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMudGhlbWVzID0gdm9pZCAwO1xuICAgICAgICAgIGV4cG9ydHMudGhlbWVzID0ge307XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vcmVnaXN0ZXIuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi9yZWdpc3Rlci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVySnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5pY29ucyA9IGV4cG9ydHMuaWNvbiA9IGV4cG9ydHMudGhlbWUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgaWNvbnNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vcGx1Z2lucy9pY29ucyAqL1xuICAgICAgICAgIFwiLi9wbHVnaW5zL2ljb25zLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHRoZW1lc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9wbHVnaW5zL3RoZW1lcyAqL1xuICAgICAgICAgIFwiLi9wbHVnaW5zL3RoZW1lcy5qc1wiKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKG9iaiwgbmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBvbGQgPSBvYmpbbmFtZV07XG4gICAgICAgICAgICBvYmpbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiBvbGQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJzKG9iaiwgdmFsdWVzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIHZhbHVlcykge1xuICAgICAgICAgICAgICBvYmpba10gPSB2YWx1ZXNba107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdGhlbWUobmFtZSwgdGhlbWUpIHtcbiAgICAgICAgICAgIGlmICh0aGVtZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiByZWdpc3Rlcih0aGVtZXNfMS50aGVtZXMsIG5hbWUsIHRoZW1lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGVtZXNfMS50aGVtZXNbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy50aGVtZSA9IHRoZW1lO1xuXG4gICAgICAgICAgZnVuY3Rpb24gaWNvbihuYW1lLCBpY29uKSB7XG4gICAgICAgICAgICBpZiAoaWNvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiByZWdpc3RlcihpY29uc18xLmljb25zLCBuYW1lLCBpY29uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBpY29uc18xLmljb25zW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuaWNvbiA9IGljb247XG5cbiAgICAgICAgICBmdW5jdGlvbiBpY29ucyhpY29ucykge1xuICAgICAgICAgICAgcmV0dXJuIHJlZ2lzdGVycyhpY29uc18xLmljb25zLCBpY29ucyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5pY29ucyA9IGljb25zO1xuICAgICAgICAgIC8qKiovXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL3RoZW1lcy5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi90aGVtZXMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gdGhlbWVzSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICB2YXIgX19pbXBvcnREZWZhdWx0ID0gdGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kICYmIG1vZC5fX2VzTW9kdWxlID8gbW9kIDoge1xuICAgICAgICAgICAgICBcImRlZmF1bHRcIjogbW9kXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5nZXRDaG9pY2VzID0gZXhwb3J0cy5zZXREZWZhdWx0ID0gZXhwb3J0cy5nZXREZWZhdWx0ID0gZXhwb3J0cy5vZiA9IGV4cG9ydHMudGhlbWUgPSBleHBvcnRzLk1BVEVSSUFMX0RFU0lHTiA9IGV4cG9ydHMuQkFTSUMgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vaW50ZXJuYWwvdXRpbHMgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvdXRpbHMuanNcIik7XG5cbiAgICAgICAgICB2YXIgdGhlbWVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdGhlbWVzL3RoZW1lICovXG4gICAgICAgICAgXCIuL3RoZW1lcy90aGVtZS5qc1wiKTtcblxuICAgICAgICAgIHZhciBCQVNJQ18xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vdGhlbWVzL0JBU0lDICovXG4gICAgICAgICAgXCIuL3RoZW1lcy9CQVNJQy5qc1wiKSk7XG5cbiAgICAgICAgICB2YXIgTUFURVJJQUxfREVTSUdOXzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi90aGVtZXMvTUFURVJJQUxfREVTSUdOICovXG4gICAgICAgICAgXCIuL3RoZW1lcy9NQVRFUklBTF9ERVNJR04uanNcIikpO1xuXG4gICAgICAgICAgdmFyIHRoZW1lc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9wbHVnaW5zL3RoZW1lcyAqL1xuICAgICAgICAgIFwiLi9wbHVnaW5zL3RoZW1lcy5qc1wiKTtcblxuICAgICAgICAgIGV4cG9ydHMuQkFTSUMgPSBuZXcgdGhlbWVfMS5UaGVtZShCQVNJQ18xLmRlZmF1bHQpO1xuICAgICAgICAgIGV4cG9ydHMuTUFURVJJQUxfREVTSUdOID0gbmV3IHRoZW1lXzEuVGhlbWUoTUFURVJJQUxfREVTSUdOXzEuZGVmYXVsdCk7XG4gICAgICAgICAgdmFyIGJ1aWx0aW4gPSB7XG4gICAgICAgICAgICBCQVNJQzogZXhwb3J0cy5CQVNJQyxcbiAgICAgICAgICAgIE1BVEVSSUFMX0RFU0lHTjogZXhwb3J0cy5NQVRFUklBTF9ERVNJR05cbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciBkZWZUaGVtZSA9IGV4cG9ydHMuTUFURVJJQUxfREVTSUdOO1xuICAgICAgICAgIGV4cG9ydHMudGhlbWUgPSB7XG4gICAgICAgICAgICBUaGVtZTogdGhlbWVfMS5UaGVtZVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBmdW5jdGlvbiBvZih2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICB2YXIgdCA9ICgwLCB1dGlsc18xLmdldElnbm9yZUNhc2UpKGdldENob2ljZXMoKSwgdmFsdWUpO1xuXG4gICAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgdGhlbWVfMS5UaGVtZSkge1xuICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgdGhlbWVfMS5UaGVtZSh2YWx1ZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5vZiA9IG9mO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWZUaGVtZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmdldERlZmF1bHQgPSBnZXREZWZhdWx0O1xuXG4gICAgICAgICAgZnVuY3Rpb24gc2V0RGVmYXVsdChkZWZhdWx0VGhlbWUpIHtcbiAgICAgICAgICAgIGRlZlRoZW1lID0gb2YoZGVmYXVsdFRoZW1lKSB8fCBkZWZUaGVtZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLnNldERlZmF1bHQgPSBzZXREZWZhdWx0O1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0Q2hvaWNlcygpIHtcbiAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS5leHRlbmQpKGJ1aWx0aW4sIHRoZW1lc18xLnRoZW1lcyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5nZXRDaG9pY2VzID0gZ2V0Q2hvaWNlcztcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi90aGVtZXMvQkFTSUMuanNcIjpcbiAgICAgICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vdGhlbWVzL0JBU0lDLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyohIG5vIHN0YXRpYyBleHBvcnRzIGZvdW5kICovXG5cbiAgICAgICAgLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSAqL1xuXG4gICAgICAgIC8qKiovXG4gICAgICAgIGZ1bmN0aW9uIHRoZW1lc0JBU0lDSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICAgICAgLyplc2xpbnQgbm8tYml0d2lzZTowKi9cblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZ1bmN0aW9uIERFRkFVTFRfQkdfQ09MT1IoYXJncykge1xuICAgICAgICAgICAgdmFyIHJvdyA9IGFyZ3Mucm93LFxuICAgICAgICAgICAgICAgIGdyaWQgPSBhcmdzLmdyaWQ7XG5cbiAgICAgICAgICAgIGlmIChyb3cgPCBncmlkLmZyb3plblJvd0NvdW50KSB7XG4gICAgICAgICAgICAgIHJldHVybiBcIiNGRkZcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGluZGV4ID0gZ3JpZC5nZXRSZWNvcmRJbmRleEJ5Um93KHJvdyk7XG5cbiAgICAgICAgICAgIGlmICghKGluZGV4ICYgMSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFwiI0ZGRlwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFwiI0Y2RjZGNlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBjYWNoZUxpbmVhckdyYWRpZW50ID0ge307XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRMaW5lYXJHcmFkaWVudChjb250ZXh0LCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIGNvbG9yU3RvcHMpIHtcbiAgICAgICAgICAgIHZhciBzdG9wO1xuICAgICAgICAgICAgdmFyIHN0b3BzS2V5ID0gW107XG5cbiAgICAgICAgICAgIGZvciAoc3RvcCBpbiBjb2xvclN0b3BzKSB7XG4gICAgICAgICAgICAgIHN0b3BzS2V5LnB1c2goXCJcIi5jb25jYXQoc3RvcCwgXCJAXCIpLmNvbmNhdChjb2xvclN0b3BzW3N0b3BdKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBrZXkgPSBcIlwiLmNvbmNhdChsZWZ0LCBcIi9cIikuY29uY2F0KHRvcCwgXCIvXCIpLmNvbmNhdChyaWdodCwgXCIvXCIpLmNvbmNhdChib3R0b20sIFwiL1wiKS5jb25jYXQoc3RvcHNLZXkuam9pbihcIixcIikpO1xuICAgICAgICAgICAgdmFyIHJldCA9IGNhY2hlTGluZWFyR3JhZGllbnRba2V5XTtcblxuICAgICAgICAgICAgaWYgKHJldCkge1xuICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZ3JhZCA9IGNvbnRleHQuY3JlYXRlTGluZWFyR3JhZGllbnQobGVmdCwgdG9wLCBsZWZ0LCBib3R0b20pO1xuXG4gICAgICAgICAgICBmb3IgKHN0b3AgaW4gY29sb3JTdG9wcykge1xuICAgICAgICAgICAgICBncmFkLmFkZENvbG9yU3RvcChOdW1iZXIoc3RvcCksIGNvbG9yU3RvcHNbc3RvcF0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVMaW5lYXJHcmFkaWVudFtrZXldID0gZ3JhZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBGUk9aRU5fUk9XU19CR19DT0xPUihhcmdzKSB7XG4gICAgICAgICAgICB2YXIgY29sID0gYXJncy5jb2wsXG4gICAgICAgICAgICAgICAgZ3JpZCA9IGFyZ3MuZ3JpZCxcbiAgICAgICAgICAgICAgICBmcm96ZW5Sb3dDb3VudCA9IGFyZ3MuZ3JpZC5mcm96ZW5Sb3dDb3VudCxcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gYXJncy5jb250ZXh0O1xuXG4gICAgICAgICAgICB2YXIgX2dyaWQkZ2V0Q2VsbFJlbGF0aXZlID0gZ3JpZC5nZXRDZWxsUmVsYXRpdmVSZWN0KGNvbCwgMCksXG4gICAgICAgICAgICAgICAgbGVmdCA9IF9ncmlkJGdldENlbGxSZWxhdGl2ZS5sZWZ0LFxuICAgICAgICAgICAgICAgIHRvcCA9IF9ncmlkJGdldENlbGxSZWxhdGl2ZS50b3A7XG5cbiAgICAgICAgICAgIHZhciBfZ3JpZCRnZXRDZWxsUmVsYXRpdmUyID0gZ3JpZC5nZXRDZWxsUmVsYXRpdmVSZWN0KGNvbCwgZnJvemVuUm93Q291bnQgLSAxKSxcbiAgICAgICAgICAgICAgICBib3R0b20gPSBfZ3JpZCRnZXRDZWxsUmVsYXRpdmUyLmJvdHRvbTtcblxuICAgICAgICAgICAgcmV0dXJuIGdldExpbmVhckdyYWRpZW50KGNvbnRleHQsIGxlZnQsIHRvcCwgbGVmdCwgYm90dG9tLCB7XG4gICAgICAgICAgICAgIDA6IFwiI0ZGRlwiLFxuICAgICAgICAgICAgICAxOiBcIiNEM0QzRDNcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIGJhc2ljIHRoZW1lXG4gICAgICAgICAgICogQG5hbWUgQkFTSUNcbiAgICAgICAgICAgKiBAbWVtYmVyb2YgY2hlZXRhaEdyaWQudGhlbWVzLmNob2ljZXNcbiAgICAgICAgICAgKi9cblxuXG4gICAgICAgICAgZXhwb3J0cy5kZWZhdWx0ID0ge1xuICAgICAgICAgICAgY29sb3I6IFwiIzAwMFwiLFxuICAgICAgICAgICAgLy8gZnJvemVuUm93c0NvbG9yOiAnIzAwMCcsXG4gICAgICAgICAgICBkZWZhdWx0QmdDb2xvcjogREVGQVVMVF9CR19DT0xPUixcbiAgICAgICAgICAgIGZyb3plblJvd3NCZ0NvbG9yOiBGUk9aRU5fUk9XU19CR19DT0xPUixcbiAgICAgICAgICAgIHNlbGVjdGlvbkJnQ29sb3I6IFwiI0NDRTBGRlwiLFxuICAgICAgICAgICAgYm9yZGVyQ29sb3I6IFwiIzAwMFwiLFxuICAgICAgICAgICAgLy8gZnJvemVuUm93c0JvcmRlckNvbG9yOiAnIzAwMCcsXG4gICAgICAgICAgICBoaWdobGlnaHRCb3JkZXJDb2xvcjogXCIjNUU5RUQ2XCIsXG4gICAgICAgICAgICBjaGVja2JveDoge1xuICAgICAgICAgICAgICB1bmNoZWNrQmdDb2xvcjogXCIjRkZGXCIsXG4gICAgICAgICAgICAgIGNoZWNrQmdDb2xvcjogXCJyZ2IoNzYsIDczLCA3MilcIixcbiAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IFwiIzAwMFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmFkaW9CdXR0b246IHtcbiAgICAgICAgICAgICAgY2hlY2tDb2xvcjogXCJyZ2IoNzYsIDczLCA3MilcIixcbiAgICAgICAgICAgICAgY2hlY2tCb3JkZXJDb2xvcjogXCIjMDAwXCIsXG4gICAgICAgICAgICAgIHVuY2hlY2tCb3JkZXJDb2xvcjogXCIjMDAwXCIsXG4gICAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yOiBcIiNGRkZcIixcbiAgICAgICAgICAgICAgY2hlY2tCZ0NvbG9yOiBcIiNGRkZcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJ1dHRvbjoge1xuICAgICAgICAgICAgICBjb2xvcjogXCIjRkZGXCIsXG4gICAgICAgICAgICAgIGJnQ29sb3I6IFwiIzIxOTZGM1wiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGVhZGVyOiB7XG4gICAgICAgICAgICAgIHNvcnRBcnJvd0NvbG9yOiBcInJnYmEoMCwgMCwgMCwgMC4zOClcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluZGljYXRvcnM6IHtcbiAgICAgICAgICAgICAgdG9wTGVmdENvbG9yOiBcIiMwMDBcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVuZGVybGF5QmFja2dyb3VuZENvbG9yOiBcIiNGNkY2RjZcIlxuICAgICAgICAgIH07XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vdGhlbWVzL01BVEVSSUFMX0RFU0lHTi5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vdGhlbWVzL01BVEVSSUFMX0RFU0lHTi5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gdGhlbWVzTUFURVJJQUxfREVTSUdOSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICAgICAgLyplc2xpbnQgbm8tYml0d2lzZTowKi9cblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZ1bmN0aW9uIEZST1pFTl9ST1dTX0JPUkRFUl9DT0xPUihhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcm93ID0gYXJncy5yb3csXG4gICAgICAgICAgICAgICAgZnJvemVuUm93Q291bnQgPSBhcmdzLmdyaWQuZnJvemVuUm93Q291bnQ7XG5cbiAgICAgICAgICAgIGlmIChmcm96ZW5Sb3dDb3VudCAtIDEgPT09IHJvdykge1xuICAgICAgICAgICAgICByZXR1cm4gW1wiI2YyZjJmMlwiLCBcIiNmMmYyZjJcIiwgXCIjY2NjN2M3XCIsIFwiI2YyZjJmMlwiXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBbXCIjZjJmMmYyXCJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIEJPUkRFUl9DT0xPUihhcmdzKSB7XG4gICAgICAgICAgICB2YXIgY29sID0gYXJncy5jb2wsXG4gICAgICAgICAgICAgICAgcm93ID0gYXJncy5yb3csXG4gICAgICAgICAgICAgICAgZ3JpZCA9IGFyZ3MuZ3JpZDtcbiAgICAgICAgICAgIHZhciBjb2xDb3VudCA9IGdyaWQuY29sQ291bnQsXG4gICAgICAgICAgICAgICAgZnJvemVuQ29sQ291bnQgPSBncmlkLmZyb3plbkNvbENvdW50LFxuICAgICAgICAgICAgICAgIHJlY29yZFJvd0NvdW50ID0gZ3JpZC5yZWNvcmRSb3dDb3VudDtcbiAgICAgICAgICAgIHZhciB0b3AgPSBcIiNjY2M3YzdcIjtcbiAgICAgICAgICAgIHZhciBib3R0b20gPSBcIiNjY2M3YzdcIjtcblxuICAgICAgICAgICAgaWYgKHJlY29yZFJvd0NvdW50ID4gMSkge1xuICAgICAgICAgICAgICB2YXIgc3RhcnRSb3cgPSBncmlkLmdldFJlY29yZFN0YXJ0Um93QnlSZWNvcmRJbmRleChncmlkLmdldFJlY29yZEluZGV4QnlSb3cocm93KSk7XG4gICAgICAgICAgICAgIHZhciBlbmRSb3cgPSBzdGFydFJvdyArIHJlY29yZFJvd0NvdW50IC0gMTtcblxuICAgICAgICAgICAgICBpZiAoc3RhcnRSb3cgIT09IHJvdykge1xuICAgICAgICAgICAgICAgIHRvcCA9IG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoZW5kUm93ICE9PSByb3cpIHtcbiAgICAgICAgICAgICAgICBib3R0b20gPSBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmcm96ZW5Db2xDb3VudCAtIDEgPT09IGNvbCkge1xuICAgICAgICAgICAgICByZXR1cm4gW3RvcCwgXCIjZjJmMmYyXCIsIGJvdHRvbSwgbnVsbF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjb2xDb3VudCAtIDEgPT09IGNvbCkge1xuICAgICAgICAgICAgICByZXR1cm4gW3RvcCwgXCIjZjJmMmYyXCIsIGJvdHRvbSwgbnVsbF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBbdG9wLCBudWxsLCBib3R0b20sIG51bGxdO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBtYXRlcmlhbCBkZXNpZ24gdGhlbWVcbiAgICAgICAgICAgKiBAbmFtZSBNQVRFUklBTF9ERVNJR05cbiAgICAgICAgICAgKiBAbWVtYmVyb2YgY2hlZXRhaEdyaWQudGhlbWVzLmNob2ljZXNcbiAgICAgICAgICAgKi9cblxuXG4gICAgICAgICAgZXhwb3J0cy5kZWZhdWx0ID0ge1xuICAgICAgICAgICAgY29sb3I6IFwicmdiYSgwLCAwLCAwLCAwLjg3KVwiLFxuICAgICAgICAgICAgZnJvemVuUm93c0NvbG9yOiBcInJnYmEoMCwgMCwgMCwgMC41NClcIixcbiAgICAgICAgICAgIGRlZmF1bHRCZ0NvbG9yOiBcIiNGRkZcIixcbiAgICAgICAgICAgIC8vIGZyb3plblJvd3NCZ0NvbG9yOiAnI0ZGRicsXG4gICAgICAgICAgICBzZWxlY3Rpb25CZ0NvbG9yOiBcIiNDQ0UwRkZcIixcbiAgICAgICAgICAgIGJvcmRlckNvbG9yOiBCT1JERVJfQ09MT1IsXG4gICAgICAgICAgICBmcm96ZW5Sb3dzQm9yZGVyQ29sb3I6IEZST1pFTl9ST1dTX0JPUkRFUl9DT0xPUixcbiAgICAgICAgICAgIGhpZ2hsaWdodEJvcmRlckNvbG9yOiBcIiM1RTlFRDZcIixcbiAgICAgICAgICAgIGNoZWNrYm94OiB7XG4gICAgICAgICAgICAgIC8vIHVuY2hlY2tCZ0NvbG9yOiAnI0ZGRicsXG4gICAgICAgICAgICAgIGNoZWNrQmdDb2xvcjogXCJyZ2IoNzYsIDczLCA3MilcIixcbiAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IFwicmdiYSgwLCAwLCAwLCAwLjI2KVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmFkaW9CdXR0b246IHtcbiAgICAgICAgICAgICAgY2hlY2tDb2xvcjogXCJyZ2IoNzYsIDczLCA3MilcIixcbiAgICAgICAgICAgICAgY2hlY2tCb3JkZXJDb2xvcjogXCJyZ2IoNzYsIDczLCA3MilcIixcbiAgICAgICAgICAgICAgdW5jaGVja0JvcmRlckNvbG9yOiBcInJnYigxODksIDE4OSwgMTg5KVwiIC8vIHVuY2hlY2tCZ0NvbG9yOiBcIiNGRkZcIixcbiAgICAgICAgICAgICAgLy8gY2hlY2tCZ0NvbG9yOiBcIiNGRkZcIixcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJ1dHRvbjoge1xuICAgICAgICAgICAgICBjb2xvcjogXCIjRkZGXCIsXG4gICAgICAgICAgICAgIGJnQ29sb3I6IFwiIzIxOTZGM1wiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGVhZGVyOiB7XG4gICAgICAgICAgICAgIHNvcnRBcnJvd0NvbG9yOiBcInJnYmEoMCwgMCwgMCwgMC4zOClcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluZGljYXRvcnM6IHtcbiAgICAgICAgICAgICAgdG9wTGVmdENvbG9yOiBcIiNjY2M3YzdcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVuZGVybGF5QmFja2dyb3VuZENvbG9yOiBcIiNGRkZcIlxuICAgICAgICAgIH07XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vdGhlbWVzL3RoZW1lLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL3RoZW1lcy90aGVtZS5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiB0aGVtZXNUaGVtZUpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuVGhlbWUgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIHN5bWJvbE1hbmFnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3N5bWJvbE1hbmFnZXIgKi9cbiAgICAgICAgICBcIi4vaW50ZXJuYWwvc3ltYm9sTWFuYWdlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBUcmVlQ29sdW1uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuLi9jb2x1bW5zL3R5cGUvVHJlZUNvbHVtbiAqL1xuICAgICAgICAgIFwiLi9jb2x1bW5zL3R5cGUvVHJlZUNvbHVtbi5qc1wiKTsgLy9wcml2YXRlIHN5bWJvbFxuXG5cbiAgICAgICAgICB2YXIgXyA9ICgwLCBzeW1ib2xNYW5hZ2VyXzEuZ2V0KSgpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0UHJvcChvYmosIHN1cGVyT2JqLCBuYW1lcywgZGVmTmFtZXMsIGNvbnZlcnRGb3JTdXBlciwgZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAoMCwgdXRpbHNfMS5nZXRDaGFpblNhZmUpLmFwcGx5KHZvaWQgMCwgW29ial0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShuYW1lcykpKSB8fCAoMCwgdXRpbHNfMS5nZXRDaGFpblNhZmUpLmFwcGx5KHZvaWQgMCwgW3N1cGVyT2JqXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG5hbWVzKSkpO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWRlZk5hbWVzKSB7XG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZSB8fCBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBnZXRDaGFpblNhZmVXaXRoQ29udmVydCA9IGNvbnZlcnRGb3JTdXBlciA/IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjI2ID0gYXJndW1lbnRzLmxlbmd0aCwgbmFtZXMgPSBuZXcgQXJyYXkoX2xlbjI2ID4gMSA/IF9sZW4yNiAtIDEgOiAwKSwgX2tleTI3ID0gMTsgX2tleTI3IDwgX2xlbjI2OyBfa2V5MjcrKykge1xuICAgICAgICAgICAgICAgIG5hbWVzW19rZXkyNyAtIDFdID0gYXJndW1lbnRzW19rZXkyN107XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgdmFsdWUgPSAoMCwgdXRpbHNfMS5nZXRDaGFpblNhZmUpLmFwcGx5KHZvaWQgMCwgW29ial0uY29uY2F0KG5hbWVzKSk7XG5cbiAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBjb252ZXJ0Rm9yU3VwZXIodmFsdWUpO1xuICAgICAgICAgICAgfSA6IHV0aWxzXzEuZ2V0Q2hhaW5TYWZlO1xuICAgICAgICAgICAgcmV0dXJuIGdldENoYWluU2FmZVdpdGhDb252ZXJ0LmFwcGx5KHZvaWQgMCwgW29ial0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShkZWZOYW1lcykpKSB8fCBnZXRDaGFpblNhZmVXaXRoQ29udmVydC5hcHBseSh2b2lkIDAsIFtzdXBlck9ial0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShkZWZOYW1lcykpKSB8fCBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIFRoZW1lID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFRoZW1lKG9iaiwgc3VwZXJUaGVtZSkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGhlbWUpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX2NoZWNrYm94ID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5fcmFkaW9CdXR0b24gPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9idXR0b24gPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl90cmVlID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5faGVhZGVyID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5fbWVzc2FnZXMgPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9pbmRpY2F0b3JzID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpc1tfXSA9IHtcbiAgICAgICAgICAgICAgICBvYmo6IG9iaixcbiAgICAgICAgICAgICAgICBzdXBlclRoZW1lOiBzdXBlclRoZW1lXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhUaGVtZSwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImZvbnRcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF8zID0gdGhpc1tfXSxcbiAgICAgICAgICAgICAgICAgICAgb2JqID0gX3RoaXMkXzMub2JqLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclRoZW1lID0gX3RoaXMkXzMuc3VwZXJUaGVtZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJvcChvYmosIHN1cGVyVGhlbWUsIFtcImZvbnRcIl0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJ1bmRlcmxheUJhY2tncm91bmRDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzQgPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfNC5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfNC5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1widW5kZXJsYXlCYWNrZ3JvdW5kQ29sb3JcIl0pO1xuICAgICAgICAgICAgICB9IC8vIGNvbG9yXG5cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImNvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfNSA9IHRoaXNbX10sXG4gICAgICAgICAgICAgICAgICAgIG9iaiA9IF90aGlzJF81Lm9iaixcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJUaGVtZSA9IF90aGlzJF81LnN1cGVyVGhlbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFByb3Aob2JqLCBzdXBlclRoZW1lLCBbXCJjb2xvclwiXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImZyb3plblJvd3NDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzYgPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfNi5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfNi5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1wiZnJvemVuUm93c0NvbG9yXCJdLCBbXCJjb2xvclwiXSk7XG4gICAgICAgICAgICAgIH0gLy8gYmFja2dyb3VuZFxuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJkZWZhdWx0QmdDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzcgPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfNy5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfNy5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1wiZGVmYXVsdEJnQ29sb3JcIl0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmcm96ZW5Sb3dzQmdDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzggPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfOC5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfOC5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1wiZnJvemVuUm93c0JnQ29sb3JcIl0sIFtcImRlZmF1bHRCZ0NvbG9yXCJdKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwic2VsZWN0aW9uQmdDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzkgPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfOS5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfOS5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1wic2VsZWN0aW9uQmdDb2xvclwiXSwgW1wiZGVmYXVsdEJnQ29sb3JcIl0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoaWdobGlnaHRCZ0NvbG9yXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczExMCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNQcm9wZXJ0eShbXCJoaWdobGlnaHRCZ0NvbG9yXCJdKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIF90aGlzJF8xMCA9IHRoaXNbX10sXG4gICAgICAgICAgICAgICAgICAgICAgb2JqID0gX3RoaXMkXzEwLm9iaixcbiAgICAgICAgICAgICAgICAgICAgICBzdXBlclRoZW1lID0gX3RoaXMkXzEwLnN1cGVyVGhlbWU7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJvcChvYmosIHN1cGVyVGhlbWUsIFtcImhpZ2hsaWdodEJnQ29sb3JcIl0pO1xuICAgICAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSBhcmdzLnJvdyA8IGFyZ3MuZ3JpZC5mcm96ZW5Sb3dDb3VudCA/IF90aGlzMTEwLmZyb3plblJvd3NCZ0NvbG9yIDogX3RoaXMxMTAuZGVmYXVsdEJnQ29sb3I7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3IoYXJncyk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9IC8vIGJvcmRlclxuXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJib3JkZXJDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzExID0gdGhpc1tfXSxcbiAgICAgICAgICAgICAgICAgICAgb2JqID0gX3RoaXMkXzExLm9iaixcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJUaGVtZSA9IF90aGlzJF8xMS5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1wiYm9yZGVyQ29sb3JcIl0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJmcm96ZW5Sb3dzQm9yZGVyQ29sb3JcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF8xMiA9IHRoaXNbX10sXG4gICAgICAgICAgICAgICAgICAgIG9iaiA9IF90aGlzJF8xMi5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfMTIuc3VwZXJUaGVtZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJvcChvYmosIHN1cGVyVGhlbWUsIFtcImZyb3plblJvd3NCb3JkZXJDb2xvclwiXSwgW1wiYm9yZGVyQ29sb3JcIl0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJoaWdobGlnaHRCb3JkZXJDb2xvclwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzEzID0gdGhpc1tfXSxcbiAgICAgICAgICAgICAgICAgICAgb2JqID0gX3RoaXMkXzEzLm9iaixcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJUaGVtZSA9IF90aGlzJF8xMy5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1wiaGlnaGxpZ2h0Qm9yZGVyQ29sb3JcIl0sIFtcImJvcmRlckNvbG9yXCJdKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiY2hlY2tib3hcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF8xNCA9IHRoaXNbX10sXG4gICAgICAgICAgICAgICAgICAgIG9iaiA9IF90aGlzJF8xNC5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfMTQuc3VwZXJUaGVtZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tib3ggfHwgKHRoaXMuX2NoZWNrYm94ID0ge1xuICAgICAgICAgICAgICAgICAgZ2V0IHVuY2hlY2tCZ0NvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2hlY2tib3hQcm9wKFwidW5jaGVja0JnQ29sb3JcIiwgW1wiZGVmYXVsdEJnQ29sb3JcIl0pO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGNoZWNrQmdDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENoZWNrYm94UHJvcChcImNoZWNrQmdDb2xvclwiLCBbXCJib3JkZXJDb2xvclwiXSwgY29sb3JzVG9Db2xvciwgXCIjMDAwXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGJvcmRlckNvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2hlY2tib3hQcm9wKFwiYm9yZGVyQ29sb3JcIiwgW1wiYm9yZGVyQ29sb3JcIl0sIGNvbG9yc1RvQ29sb3IsIFwiIzAwMFwiKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2hlY2tib3hQcm9wKHByb3AsIGRlZk5hbWVzLCBjb252ZXJ0Rm9yU3VwZXIsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFByb3Aob2JqLCBzdXBlclRoZW1lLCBbXCJjaGVja2JveFwiLCBwcm9wXSwgZGVmTmFtZXMsIGNvbnZlcnRGb3JTdXBlciwgZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcInJhZGlvQnV0dG9uXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfMTUgPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfMTUub2JqLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclRoZW1lID0gX3RoaXMkXzE1LnN1cGVyVGhlbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JhZGlvQnV0dG9uIHx8ICh0aGlzLl9yYWRpb0J1dHRvbiA9IHtcbiAgICAgICAgICAgICAgICAgIGdldCBjaGVja0NvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UmFkaW9CdXR0b25Qcm9wKFwiY2hlY2tDb2xvclwiLCBbXCJjb2xvclwiXSk7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgdW5jaGVja0JvcmRlckNvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UmFkaW9CdXR0b25Qcm9wKFwidW5jaGVja0JvcmRlckNvbG9yXCIsIFtcImJvcmRlckNvbG9yXCJdLCBjb2xvcnNUb0NvbG9yLCBcIiMwMDBcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgY2hlY2tCb3JkZXJDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFJhZGlvQnV0dG9uUHJvcChcImNoZWNrQm9yZGVyQ29sb3JcIiwgW1wiYm9yZGVyQ29sb3JcIl0sIGNvbG9yc1RvQ29sb3IsIFwiIzAwMFwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB1bmNoZWNrQmdDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFJhZGlvQnV0dG9uUHJvcChcInVuY2hlY2tCZ0NvbG9yXCIsIFtcImRlZmF1bHRCZ0NvbG9yXCJdKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBjaGVja0JnQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRSYWRpb0J1dHRvblByb3AoXCJjaGVja0JnQ29sb3JcIiwgW1wiZGVmYXVsdEJnQ29sb3JcIl0pO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRSYWRpb0J1dHRvblByb3AocHJvcCwgZGVmTmFtZXMsIGNvbnZlcnRGb3JTdXBlciwgZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJvcChvYmosIHN1cGVyVGhlbWUsIFtcInJhZGlvQnV0dG9uXCIsIHByb3BdLCBkZWZOYW1lcywgY29udmVydEZvclN1cGVyLCBkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYnV0dG9uXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfMTYgPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfMTYub2JqLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclRoZW1lID0gX3RoaXMkXzE2LnN1cGVyVGhlbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2J1dHRvbiB8fCAodGhpcy5fYnV0dG9uID0ge1xuICAgICAgICAgICAgICAgICAgZ2V0IGNvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0QnV0dG9uUHJvcChcImNvbG9yXCIsIFtcImNvbG9yXCJdKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBiZ0NvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0QnV0dG9uUHJvcChcImJnQ29sb3JcIiwgW1wiZGVmYXVsdEJnQ29sb3JcIl0pO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRCdXR0b25Qcm9wKHByb3AsIGRlZk5hbWVzKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJvcChvYmosIHN1cGVyVGhlbWUsIFtcImJ1dHRvblwiLCBwcm9wXSwgZGVmTmFtZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwidHJlZVwiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzE3ID0gdGhpc1tfXSxcbiAgICAgICAgICAgICAgICAgICAgb2JqID0gX3RoaXMkXzE3Lm9iaixcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJUaGVtZSA9IF90aGlzJF8xNy5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90cmVlIHx8ICh0aGlzLl90cmVlID0ge1xuICAgICAgICAgICAgICAgICAgZ2V0IGxpbmVTdHlsZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFRyZWVQcm9wKFwibGluZVN0eWxlXCIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBcInNvbGlkXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGxpbmVDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFRyZWVQcm9wKFwibGluZUNvbG9yXCIsIFtcImJvcmRlckNvbG9yXCJdLCBjb2xvcnNUb0NvbG9yLCBcIiMwMDAwXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IGxpbmVXaWR0aCgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFRyZWVQcm9wKFwibGluZVdpZHRoXCIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCAxKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB0cmVlSWNvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFRyZWVQcm9wKFwidHJlZUljb25cIiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWY4NSA9ICgwLCBUcmVlQ29sdW1uXzEuZ2V0VHJlZU5vZGVJbmZvQXQpKGFyZ3MpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNDaGlsZHJlbiA9IF9yZWY4NS5oYXNDaGlsZHJlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVR5cGUgPSBfcmVmODUubm9kZVR5cGU7XG5cbiAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzQ2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImV4cGFuZF9tb3JlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVUeXBlID09PSBcImJyYW5jaFwiID8gXCJjaGV2cm9uX3JpZ2h0XCIgOiBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFRyZWVQcm9wKHByb3AsIGRlZk5hbWVzLCBjb252ZXJ0Rm9yU3VwZXIsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFByb3Aob2JqLCBzdXBlclRoZW1lLCBbXCJ0cmVlXCIsIHByb3BdLCBkZWZOYW1lcywgY29udmVydEZvclN1cGVyLCBkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaGVhZGVyXCIsXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyRfMTggPSB0aGlzW19dLFxuICAgICAgICAgICAgICAgICAgICBvYmogPSBfdGhpcyRfMTgub2JqLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclRoZW1lID0gX3RoaXMkXzE4LnN1cGVyVGhlbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlYWRlciB8fCAodGhpcy5faGVhZGVyID0ge1xuICAgICAgICAgICAgICAgICAgZ2V0IHNvcnRBcnJvd0NvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJvcChvYmosIHN1cGVyVGhlbWUsIFtcImhlYWRlclwiLCBcInNvcnRBcnJvd0NvbG9yXCJdLCBbXCJjb2xvclwiXSk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibWVzc2FnZXNcIixcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF8xOSA9IHRoaXNbX10sXG4gICAgICAgICAgICAgICAgICAgIG9iaiA9IF90aGlzJF8xOS5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfMTkuc3VwZXJUaGVtZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVzc2FnZXMgfHwgKHRoaXMuX21lc3NhZ2VzID0ge1xuICAgICAgICAgICAgICAgICAgZ2V0IGluZm9CZ0NvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0TWVzc2FnZVByb3AoXCJpbmZvQmdDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBlcnJvckJnQ29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRNZXNzYWdlUHJvcChcImVycm9yQmdDb2xvclwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB3YXJuQmdDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldE1lc3NhZ2VQcm9wKFwid2FybkJnQ29sb3JcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgYm94V2lkdGgoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRNZXNzYWdlUHJvcChcImJveFdpZHRoXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IG1hcmtIZWlnaHQoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRNZXNzYWdlUHJvcChcIm1hcmtIZWlnaHRcIik7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldE1lc3NhZ2VQcm9wKHByb3ApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9wKG9iaiwgc3VwZXJUaGVtZSwgW1wibWVzc2FnZXNcIiwgcHJvcF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaW5kaWNhdG9yc1wiLFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMkXzIwID0gdGhpc1tfXSxcbiAgICAgICAgICAgICAgICAgICAgb2JqID0gX3RoaXMkXzIwLm9iaixcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJUaGVtZSA9IF90aGlzJF8yMC5zdXBlclRoZW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmRpY2F0b3JzIHx8ICh0aGlzLl9pbmRpY2F0b3JzID0ge1xuICAgICAgICAgICAgICAgICAgZ2V0IHRvcExlZnRDb2xvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEluZGljYXRvcnNQcm9wKFwidG9wTGVmdENvbG9yXCIsIFtcImJvcmRlckNvbG9yXCJdLCBjb2xvcnNUb0NvbG9yLCBcIiMwMDBcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgdG9wTGVmdFNpemUoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRJbmRpY2F0b3JzUHJvcChcInRvcExlZnRTaXplXCIpO1xuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgZ2V0IHRvcFJpZ2h0Q29sb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRJbmRpY2F0b3JzUHJvcChcInRvcFJpZ2h0Q29sb3JcIiwgW1wiYm9yZGVyQ29sb3JcIl0sIGNvbG9yc1RvQ29sb3IsIFwiIzAwMFwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCB0b3BSaWdodFNpemUoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRJbmRpY2F0b3JzUHJvcChcInRvcFJpZ2h0U2l6ZVwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBib3R0b21SaWdodENvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SW5kaWNhdG9yc1Byb3AoXCJib3R0b21SaWdodENvbG9yXCIsIFtcImJvcmRlckNvbG9yXCJdLCBjb2xvcnNUb0NvbG9yLCBcIiMwMDBcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgYm90dG9tUmlnaHRTaXplKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SW5kaWNhdG9yc1Byb3AoXCJib3R0b21SaWdodFNpemVcIik7XG4gICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICBnZXQgYm90dG9tTGVmdENvbG9yKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SW5kaWNhdG9yc1Byb3AoXCJib3R0b21MZWZ0Q29sb3JcIiwgW1wiYm9yZGVyQ29sb3JcIl0sIGNvbG9yc1RvQ29sb3IsIFwiIzAwMFwiKTtcbiAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgIGdldCBib3R0b21MZWZ0U2l6ZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEluZGljYXRvcnNQcm9wKFwiYm90dG9tTGVmdFNpemVcIik7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldEluZGljYXRvcnNQcm9wKHByb3AsIGRlZk5hbWVzLCBjb252ZXJ0Rm9yU3VwZXIsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFByb3Aob2JqLCBzdXBlclRoZW1lLCBbXCJpbmRpY2F0b3JzXCIsIHByb3BdLCBkZWZOYW1lcywgY29udmVydEZvclN1cGVyLCBkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiaGFzUHJvcGVydHlcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhc1Byb3BlcnR5KG5hbWVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzJF8yMSA9IHRoaXNbX10sXG4gICAgICAgICAgICAgICAgICAgIG9iaiA9IF90aGlzJF8yMS5vYmosXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyVGhlbWUgPSBfdGhpcyRfMjEuc3VwZXJUaGVtZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzVGhlbWVQcm9wZXJ0eShvYmosIG5hbWVzKSB8fCBoYXNUaGVtZVByb3BlcnR5KHN1cGVyVGhlbWUsIG5hbWVzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZXh0ZW5kc1wiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2V4dGVuZHMob2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUaGVtZShvYmosIHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBUaGVtZTtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLlRoZW1lID0gVGhlbWU7XG5cbiAgICAgICAgICBmdW5jdGlvbiBoYXNUaGVtZVByb3BlcnR5KG9iaiwgbmFtZXMpIHtcbiAgICAgICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBUaGVtZSkge1xuICAgICAgICAgICAgICByZXR1cm4gb2JqLmhhc1Byb3BlcnR5KG5hbWVzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHZhciBvID0gb2JqO1xuXG4gICAgICAgICAgICAgIGlmICghbykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBuYW1lcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5hbWVzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBvID0gb1tuYW1lXTtcblxuICAgICAgICAgICAgICAgIGlmICghbykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiAhIW87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY29sb3JzVG9Db2xvcihjb2xvcnMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29sb3JzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gY29sb3JzKGFyZyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbCA/IGNvbG9yc0FycmF5VG9Db2xvcih2YWwpIDogdmFsO1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gY29sb3JzQXJyYXlUb0NvbG9yKGNvbG9ycyk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbG9yc0FycmF5VG9Db2xvciggLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbiAgICAgICAgICAgIGNvbG9ycykge1xuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoY29sb3JzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcnM7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gY29sb3JzLmZpbmQoQm9vbGVhbikgfHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvKioqL1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgXCIuL3Rvb2xzLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vdG9vbHMuanMgKioqIVxuICAgICAgICAgIFxcKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiB0b29sc0pzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICAgICAgICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG5cbiAgICAgICAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgICAgICAgIGRlc2MgPSB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIG0sIGssIGsyKSB7XG4gICAgICAgICAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgICAgICAgICAgb1trMl0gPSBtW2tdO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbiAobywgdikge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7XG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgIHZhbHVlOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24gKG8sIHYpIHtcbiAgICAgICAgICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBfX2ltcG9ydFN0YXIgPSB0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSB7XG4gICAgICAgICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuY2FudmFzaGVscGVyID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIGNhbnZhc2hlbHBlciA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL3Rvb2xzL2NhbnZhc2hlbHBlciAqL1xuICAgICAgICAgIFwiLi90b29scy9jYW52YXNoZWxwZXIuanNcIikpO1xuXG4gICAgICAgICAgZXhwb3J0cy5jYW52YXNoZWxwZXIgPSBjYW52YXNoZWxwZXI7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vdG9vbHMvY2FudmFzaGVscGVyLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL3Rvb2xzL2NhbnZhc2hlbHBlci5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiB0b29sc0NhbnZhc2hlbHBlckpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuZHJhd0J1dHRvbiA9IGV4cG9ydHMuZHJhd1JhZGlvQnV0dG9uID0gZXhwb3J0cy5kcmF3Q2hlY2tib3ggPSBleHBvcnRzLm1lYXN1cmVSYWRpb0J1dHRvbiA9IGV4cG9ydHMubWVhc3VyZUNoZWNrYm94ID0gZXhwb3J0cy5kcmF3SW5saW5lSW1hZ2VSZWN0ID0gZXhwb3J0cy5maWxsVGV4dFJlY3QgPSBleHBvcnRzLnN0cm9rZUNpcmNsZSA9IGV4cG9ydHMuZmlsbENpcmNsZSA9IGV4cG9ydHMuc3Ryb2tlUm91bmRSZWN0ID0gZXhwb3J0cy5maWxsUm91bmRSZWN0ID0gZXhwb3J0cy5yb3VuZFJlY3QgPSBleHBvcnRzLnN0cm9rZUNvbG9yc1JlY3QgPSB2b2lkIDA7XG5cbiAgICAgICAgICB2YXIgY2FudmFzZXNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL2NhbnZhc2VzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL2NhbnZhc2VzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIGNlaWwgPSBNYXRoLmNlaWwsXG4gICAgICAgICAgICAgIFBJID0gTWF0aC5QSTtcblxuICAgICAgICAgIGZ1bmN0aW9uIHN0cm9rZUNvbG9yc1JlY3QoY3R4LCBib3JkZXJDb2xvcnMsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gc3Ryb2tlUmVjdExpbmVzKHBvc2l0aW9ucykge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvcmRlckNvbG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IGJvcmRlckNvbG9yc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgX3ByZUNvbG9yID0gYm9yZGVyQ29sb3JzW2kgLSAxXTtcblxuICAgICAgICAgICAgICAgIGlmIChjb2xvcikge1xuICAgICAgICAgICAgICAgICAgaWYgKF9wcmVDb2xvciAhPT0gY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9wcmVDb2xvcikge1xuICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IF9wcmVDb2xvcjtcbiAgICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zMSA9IHBvc2l0aW9uc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHBvczEueCwgcG9zMS55KTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdmFyIHBvczIgPSBwb3NpdGlvbnNbaSArIDFdO1xuICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhwb3MyLngsIHBvczIueSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmIChfcHJlQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gX3ByZUNvbG9yO1xuICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIHByZUNvbG9yID0gYm9yZGVyQ29sb3JzW2JvcmRlckNvbG9ycy5sZW5ndGggLSAxXTtcblxuICAgICAgICAgICAgICBpZiAocHJlQ29sb3IpIHtcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBwcmVDb2xvcjtcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGJvcmRlckNvbG9yc1swXSA9PT0gYm9yZGVyQ29sb3JzWzFdICYmIGJvcmRlckNvbG9yc1swXSA9PT0gYm9yZGVyQ29sb3JzWzJdICYmIGJvcmRlckNvbG9yc1swXSA9PT0gYm9yZGVyQ29sb3JzWzNdKSB7XG4gICAgICAgICAgICAgIGlmIChib3JkZXJDb2xvcnNbMF0pIHtcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBib3JkZXJDb2xvcnNbMF07XG4gICAgICAgICAgICAgICAgY3R4LnN0cm9rZVJlY3QobGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc3Ryb2tlUmVjdExpbmVzKFt7XG4gICAgICAgICAgICAgICAgeDogbGVmdCxcbiAgICAgICAgICAgICAgICB5OiB0b3BcbiAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHg6IGxlZnQgKyB3aWR0aCxcbiAgICAgICAgICAgICAgICB5OiB0b3BcbiAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHg6IGxlZnQgKyB3aWR0aCxcbiAgICAgICAgICAgICAgICB5OiB0b3AgKyBoZWlnaHRcbiAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHg6IGxlZnQsXG4gICAgICAgICAgICAgICAgeTogdG9wICsgaGVpZ2h0XG4gICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB4OiBsZWZ0LFxuICAgICAgICAgICAgICAgIHk6IHRvcFxuICAgICAgICAgICAgICB9XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5zdHJva2VDb2xvcnNSZWN0ID0gc3Ryb2tlQ29sb3JzUmVjdDtcblxuICAgICAgICAgIGZ1bmN0aW9uIHJvdW5kUmVjdChjdHgsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCwgcmFkaXVzKSB7XG4gICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjdHguYXJjKGxlZnQgKyByYWRpdXMsIHRvcCArIHJhZGl1cywgcmFkaXVzLCAtUEksIC0wLjUgKiBQSSwgZmFsc2UpO1xuICAgICAgICAgICAgY3R4LmFyYyhsZWZ0ICsgd2lkdGggLSByYWRpdXMsIHRvcCArIHJhZGl1cywgcmFkaXVzLCAtMC41ICogUEksIDAsIGZhbHNlKTtcbiAgICAgICAgICAgIGN0eC5hcmMobGVmdCArIHdpZHRoIC0gcmFkaXVzLCB0b3AgKyBoZWlnaHQgLSByYWRpdXMsIHJhZGl1cywgMCwgMC41ICogUEksIGZhbHNlKTtcbiAgICAgICAgICAgIGN0eC5hcmMobGVmdCArIHJhZGl1cywgdG9wICsgaGVpZ2h0IC0gcmFkaXVzLCByYWRpdXMsIDAuNSAqIFBJLCBQSSwgZmFsc2UpO1xuICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMucm91bmRSZWN0ID0gcm91bmRSZWN0O1xuXG4gICAgICAgICAgZnVuY3Rpb24gZmlsbFJvdW5kUmVjdChjdHgsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCwgcmFkaXVzKSB7XG4gICAgICAgICAgICByb3VuZFJlY3QoY3R4LCBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQsIHJhZGl1cyk7XG4gICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZmlsbFJvdW5kUmVjdCA9IGZpbGxSb3VuZFJlY3Q7XG5cbiAgICAgICAgICBmdW5jdGlvbiBzdHJva2VSb3VuZFJlY3QoY3R4LCBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQsIHJhZGl1cykge1xuICAgICAgICAgICAgcm91bmRSZWN0KGN0eCwgbGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0LCByYWRpdXMpO1xuICAgICAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuc3Ryb2tlUm91bmRSZWN0ID0gc3Ryb2tlUm91bmRSZWN0O1xuXG4gICAgICAgICAgZnVuY3Rpb24gZmlsbENpcmNsZShjdHgsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIG1pbiA9IE1hdGgubWluKHdpZHRoLCBoZWlnaHQpIC8gMjtcbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5hcmMobGVmdCArIG1pbiwgdG9wICsgbWluLCBtaW4sIDAsIDIgKiBNYXRoLlBJKTtcbiAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXhwb3J0cy5maWxsQ2lyY2xlID0gZmlsbENpcmNsZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIHN0cm9rZUNpcmNsZShjdHgsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIG1pbiA9IE1hdGgubWluKHdpZHRoLCBoZWlnaHQpIC8gMjtcbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5hcmMobGVmdCArIG1pbiwgdG9wICsgbWluLCBtaW4sIDAsIDIgKiBNYXRoLlBJKTtcbiAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLnN0cm9rZUNpcmNsZSA9IHN0cm9rZUNpcmNsZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGZpbGxUZXh0UmVjdChjdHgsIHRleHQsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIF9yZWY4NiA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDoge30sXG4gICAgICAgICAgICAgICAgX3JlZjg2JG9mZnNldCA9IF9yZWY4Ni5vZmZzZXQsXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gX3JlZjg2JG9mZnNldCA9PT0gdm9pZCAwID8gMiA6IF9yZWY4NiRvZmZzZXQsXG4gICAgICAgICAgICAgICAgcGFkZGluZyA9IF9yZWY4Ni5wYWRkaW5nO1xuXG4gICAgICAgICAgICB2YXIgcmVjdCA9IHtcbiAgICAgICAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgICAgICAgdG9wOiB0b3AsXG4gICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgICAgICAgIHJpZ2h0OiBsZWZ0ICsgd2lkdGgsXG4gICAgICAgICAgICAgIGJvdHRvbTogdG9wICsgaGVpZ2h0XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3R4LnNhdmUoKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICBjdHgucmVjdChyZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7IC8vY2xpcFxuXG4gICAgICAgICAgICAgIGN0eC5jbGlwKCk7IC8v5paH5a2X5o+P55S7XG5cbiAgICAgICAgICAgICAgdmFyIHBvcyA9ICgwLCBjYW52YXNlc18xLmNhbGNCYXNlUG9zaXRpb24pKGN0eCwgcmVjdCwge1xuICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGN0eC5maWxsVGV4dCh0ZXh0LCBwb3MueCwgcG9zLnkpO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmZpbGxUZXh0UmVjdCA9IGZpbGxUZXh0UmVjdDtcblxuICAgICAgICAgIGZ1bmN0aW9uIGRyYXdJbmxpbmVJbWFnZVJlY3QoY3R4LCBpbWFnZSwgc3JjTGVmdCwgc3JjVG9wLCBzcmNXaWR0aCwgc3JjSGVpZ2h0LCBkZXN0V2lkdGgsIGRlc3RIZWlnaHQsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIF9yZWY4NyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxMiAmJiBhcmd1bWVudHNbMTJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMTJdIDoge30sXG4gICAgICAgICAgICAgICAgX3JlZjg3JG9mZnNldCA9IF9yZWY4Ny5vZmZzZXQsXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gX3JlZjg3JG9mZnNldCA9PT0gdm9pZCAwID8gMiA6IF9yZWY4NyRvZmZzZXQsXG4gICAgICAgICAgICAgICAgcGFkZGluZyA9IF9yZWY4Ny5wYWRkaW5nO1xuXG4gICAgICAgICAgICB2YXIgcmVjdCA9IHtcbiAgICAgICAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgICAgICAgdG9wOiB0b3AsXG4gICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgICAgICAgIHJpZ2h0OiBsZWZ0ICsgd2lkdGgsXG4gICAgICAgICAgICAgIGJvdHRvbTogdG9wICsgaGVpZ2h0XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3R4LnNhdmUoKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICBjdHgucmVjdChyZWN0LmxlZnQsIHJlY3QudG9wLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7IC8vY2xpcFxuXG4gICAgICAgICAgICAgIGN0eC5jbGlwKCk7IC8v5paH5a2X5o+P55S7XG5cbiAgICAgICAgICAgICAgdmFyIHBvcyA9ICgwLCBjYW52YXNlc18xLmNhbGNTdGFydFBvc2l0aW9uKShjdHgsIHJlY3QsIGRlc3RXaWR0aCwgZGVzdEhlaWdodCwge1xuICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1hZ2UsIHNyY0xlZnQsIHNyY1RvcCwgc3JjV2lkdGgsIHNyY0hlaWdodCwgcG9zLngsIHBvcy55LCBkZXN0V2lkdGgsIGRlc3RIZWlnaHQpO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmRyYXdJbmxpbmVJbWFnZVJlY3QgPSBkcmF3SW5saW5lSW1hZ2VSZWN0O1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFJldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIHdpZHRoIG9mIHRoZSBjaGVja2JveC5cbiAgICAgICAgICAgKiBAcGFyYW0gIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9IGN0eCBjYW52YXMgY29udGV4dFxuICAgICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gT2JqZWN0IGNvbnRhaW5pbmcgdGhlIHdpZHRoIG9mIHRoZSBjaGVja2JveFxuICAgICAgICAgICAqIEBtZW1iZXJvZiBjaGVldGFoR3JpZC50b29scy5jYW52YXNoZWxwZXJcbiAgICAgICAgICAgKi9cblxuICAgICAgICAgIGZ1bmN0aW9uIG1lYXN1cmVDaGVja2JveChjdHgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHdpZHRoOiAoMCwgY2FudmFzZXNfMS5nZXRGb250U2l6ZSkoY3R4LCBudWxsKS53aWR0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm1lYXN1cmVDaGVja2JveCA9IG1lYXN1cmVDaGVja2JveDtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBSZXR1cm5zIGFuIG9iamVjdCBjb250YWluaW5nIHRoZSB3aWR0aCBvZiB0aGUgcmFkaW8gYnV0dG9uLlxuICAgICAgICAgICAqIEBwYXJhbSAge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gY3R4IGNhbnZhcyBjb250ZXh0XG4gICAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBPYmplY3QgY29udGFpbmluZyB0aGUgd2lkdGggb2YgdGhlIHJhZGlvIGJ1dHRvblxuICAgICAgICAgICAqIEBtZW1iZXJvZiBjaGVldGFoR3JpZC50b29scy5jYW52YXNoZWxwZXJcbiAgICAgICAgICAgKi9cblxuICAgICAgICAgIGZ1bmN0aW9uIG1lYXN1cmVSYWRpb0J1dHRvbihjdHgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHdpZHRoOiAoMCwgY2FudmFzZXNfMS5nZXRGb250U2l6ZSkoY3R4LCBudWxsKS53aWR0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLm1lYXN1cmVSYWRpb0J1dHRvbiA9IG1lYXN1cmVSYWRpb0J1dHRvbjtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBkcmF3IENoZWNrYm94XG4gICAgICAgICAgICogQHBhcmFtICB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSBjdHggY2FudmFzIGNvbnRleHRcbiAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHggVGhlIHggY29vcmRpbmF0ZSB3aGVyZSB0byBzdGFydCBkcmF3aW5nIHRoZSBjaGVja2JveCAocmVsYXRpdmUgdG8gdGhlIGNhbnZhcylcbiAgICAgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHkgVGhlIHkgY29vcmRpbmF0ZSB3aGVyZSB0byBzdGFydCBkcmF3aW5nIHRoZSBjaGVja2JveCAocmVsYXRpdmUgdG8gdGhlIGNhbnZhcylcbiAgICAgICAgICAgKiBAcGFyYW0gIHtib29sZWFufG51bWJlcn0gY2hlY2sgY2hlY2tib3ggY2hlY2sgc3RhdHVzXG4gICAgICAgICAgICogQHBhcmFtICB7b2JqZWN0fSBvcHRpb24gb3B0aW9uXG4gICAgICAgICAgICogQHJldHVybiB7dm9pZH1cbiAgICAgICAgICAgKiBAbWVtYmVyb2YgY2hlZXRhaEdyaWQudG9vbHMuY2FudmFzaGVscGVyXG4gICAgICAgICAgICovXG5cbiAgICAgICAgICBmdW5jdGlvbiBkcmF3Q2hlY2tib3goY3R4LCB4LCB5LCBjaGVjaykge1xuICAgICAgICAgICAgdmFyIF9yZWY4OCA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDoge30sXG4gICAgICAgICAgICAgICAgX3JlZjg4JHVuY2hlY2tCZ0NvbG9yID0gX3JlZjg4LnVuY2hlY2tCZ0NvbG9yLFxuICAgICAgICAgICAgICAgIHVuY2hlY2tCZ0NvbG9yID0gX3JlZjg4JHVuY2hlY2tCZ0NvbG9yID09PSB2b2lkIDAgPyBcIiNGRkZcIiA6IF9yZWY4OCR1bmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICBfcmVmODgkY2hlY2tCZ0NvbG9yID0gX3JlZjg4LmNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICBjaGVja0JnQ29sb3IgPSBfcmVmODgkY2hlY2tCZ0NvbG9yID09PSB2b2lkIDAgPyBcInJnYig3NiwgNzMsIDcyKVwiIDogX3JlZjg4JGNoZWNrQmdDb2xvcixcbiAgICAgICAgICAgICAgICBfcmVmODgkYm9yZGVyQ29sb3IgPSBfcmVmODguYm9yZGVyQ29sb3IsXG4gICAgICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSBfcmVmODgkYm9yZGVyQ29sb3IgPT09IHZvaWQgMCA/IFwiIzAwMFwiIDogX3JlZjg4JGJvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgIF9yZWY4OCRib3hTaXplID0gX3JlZjg4LmJveFNpemUsXG4gICAgICAgICAgICAgICAgYm94U2l6ZSA9IF9yZWY4OCRib3hTaXplID09PSB2b2lkIDAgPyBtZWFzdXJlQ2hlY2tib3goY3R4KS53aWR0aCA6IF9yZWY4OCRib3hTaXplO1xuXG4gICAgICAgICAgICB2YXIgY2hlY2tQb2ludCA9IHR5cGVvZiBjaGVjayA9PT0gXCJudW1iZXJcIiA/IGNoZWNrID4gMSA/IDEgOiBjaGVjayA6IDE7XG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gY2hlY2sgPyBjaGVja0JnQ29sb3IgOiB1bmNoZWNrQmdDb2xvcjtcbiAgICAgICAgICAgICAgdmFyIGxlZnRYID0gY2VpbCh4KTtcbiAgICAgICAgICAgICAgdmFyIHRvcFkgPSBjZWlsKHkpO1xuICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlaWwoYm94U2l6ZSk7XG4gICAgICAgICAgICAgIGZpbGxSb3VuZFJlY3QoY3R4LCBsZWZ0WCAtIDEsIHRvcFkgLSAxLCBzaXplICsgMSwgc2l6ZSArIDEsIGJveFNpemUgLyA1KTtcbiAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7XG4gICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGJvcmRlckNvbG9yO1xuICAgICAgICAgICAgICBzdHJva2VSb3VuZFJlY3QoY3R4LCBsZWZ0WCAtIDAuNSwgdG9wWSAtIDAuNSwgc2l6ZSwgc2l6ZSwgYm94U2l6ZSAvIDUpO1xuXG4gICAgICAgICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSBjZWlsKGJveFNpemUgLyAxMCk7XG4gICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdW5jaGVja0JnQ29sb3I7XG4gICAgICAgICAgICAgICAgdmFyIGxlZnRXaWR0aCA9IGJveFNpemUgLyA0O1xuICAgICAgICAgICAgICAgIHZhciByaWdodFdpZHRoID0gYm94U2l6ZSAvIDIgKiAwLjk7XG4gICAgICAgICAgICAgICAgdmFyIGxlZnRMZWZ0UG9zID0geCArIGJveFNpemUgKiAwLjI7XG4gICAgICAgICAgICAgICAgdmFyIGxlZnRUb3BQb3MgPSB5ICsgYm94U2l6ZSAvIDI7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2hlY2tQb2ludCA8IDAuNSkge1xuICAgICAgICAgICAgICAgICAgbGVmdFdpZHRoICo9IGNoZWNrUG9pbnQgKiAyO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBjdHgubW92ZVRvKGxlZnRMZWZ0UG9zLCBsZWZ0VG9wUG9zKTtcbiAgICAgICAgICAgICAgICBjdHgubGluZVRvKGxlZnRMZWZ0UG9zICsgbGVmdFdpZHRoLCBsZWZ0VG9wUG9zICsgbGVmdFdpZHRoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjaGVja1BvaW50ID4gMC41KSB7XG4gICAgICAgICAgICAgICAgICBpZiAoY2hlY2tQb2ludCA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRXaWR0aCAqPSAoY2hlY2tQb2ludCAtIDAuNSkgKiAyO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBjdHgubGluZVRvKGxlZnRMZWZ0UG9zICsgbGVmdFdpZHRoICsgcmlnaHRXaWR0aCwgbGVmdFRvcFBvcyArIGxlZnRXaWR0aCAtIHJpZ2h0V2lkdGgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmRyYXdDaGVja2JveCA9IGRyYXdDaGVja2JveDtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBkcmF3IFJhZGlvIGJ1dHRvblxuICAgICAgICAgICAqIEBwYXJhbSAge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gY3R4IGNhbnZhcyBjb250ZXh0XG4gICAgICAgICAgICogQHBhcmFtICB7bnVtYmVyfSB4IFRoZSB4IGNvb3JkaW5hdGUgd2hlcmUgdG8gc3RhcnQgZHJhd2luZyB0aGUgcmFkaW8gYnV0dG9uIChyZWxhdGl2ZSB0byB0aGUgY2FudmFzKVxuICAgICAgICAgICAqIEBwYXJhbSAge251bWJlcn0geSBUaGUgeSBjb29yZGluYXRlIHdoZXJlIHRvIHN0YXJ0IGRyYXdpbmcgdGhlIHJhZGlvIGJ1dHRvbiAocmVsYXRpdmUgdG8gdGhlIGNhbnZhcylcbiAgICAgICAgICAgKiBAcGFyYW0gIHtib29sZWFufG51bWJlcn0gY2hlY2sgcmFkaW8gYnV0dG9uIGNoZWNrIHN0YXR1c1xuICAgICAgICAgICAqIEBwYXJhbSAge29iamVjdH0gb3B0aW9uIG9wdGlvblxuICAgICAgICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICAgICAgICogQG1lbWJlcm9mIGNoZWV0YWhHcmlkLnRvb2xzLmNhbnZhc2hlbHBlclxuICAgICAgICAgICAqL1xuXG4gICAgICAgICAgZnVuY3Rpb24gZHJhd1JhZGlvQnV0dG9uKGN0eCwgeCwgeSwgY2hlY2spIHtcbiAgICAgICAgICAgIHZhciBfcmVmODkgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IHt9LFxuICAgICAgICAgICAgICAgIF9yZWY4OSRjaGVja0NvbG9yID0gX3JlZjg5LmNoZWNrQ29sb3IsXG4gICAgICAgICAgICAgICAgY2hlY2tDb2xvciA9IF9yZWY4OSRjaGVja0NvbG9yID09PSB2b2lkIDAgPyBcInJnYig3NiwgNzMsIDcyKVwiIDogX3JlZjg5JGNoZWNrQ29sb3IsXG4gICAgICAgICAgICAgICAgX3JlZjg5JGJvcmRlckNvbG9yID0gX3JlZjg5LmJvcmRlckNvbG9yLFxuICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yID0gX3JlZjg5JGJvcmRlckNvbG9yID09PSB2b2lkIDAgPyBcIiMwMDBcIiA6IF9yZWY4OSRib3JkZXJDb2xvcixcbiAgICAgICAgICAgICAgICBfcmVmODkkYmdDb2xvciA9IF9yZWY4OS5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBfcmVmODkkYmdDb2xvciA9PT0gdm9pZCAwID8gXCIjRkZGXCIgOiBfcmVmODkkYmdDb2xvcixcbiAgICAgICAgICAgICAgICBfcmVmODkkYm94U2l6ZSA9IF9yZWY4OS5ib3hTaXplLFxuICAgICAgICAgICAgICAgIGJveFNpemUgPSBfcmVmODkkYm94U2l6ZSA9PT0gdm9pZCAwID8gbWVhc3VyZVJhZGlvQnV0dG9uKGN0eCkud2lkdGggOiBfcmVmODkkYm94U2l6ZTtcblxuICAgICAgICAgICAgdmFyIHJhdGlvID0gdHlwZW9mIGNoZWNrID09PSBcIm51bWJlclwiID8gY2hlY2sgPiAxID8gMSA6IGNoZWNrIDogMTtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBiZ0NvbG9yO1xuICAgICAgICAgICAgICB2YXIgbGVmdFggPSBjZWlsKHgpO1xuICAgICAgICAgICAgICB2YXIgdG9wWSA9IGNlaWwoeSk7XG4gICAgICAgICAgICAgIHZhciBzaXplID0gY2VpbChib3hTaXplKTtcbiAgICAgICAgICAgICAgZmlsbENpcmNsZShjdHgsIGxlZnRYIC0gMSwgdG9wWSAtIDEsIHNpemUgKyAxLCBzaXplICsgMSk7XG4gICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxO1xuICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBib3JkZXJDb2xvcjtcbiAgICAgICAgICAgICAgc3Ryb2tlQ2lyY2xlKGN0eCwgbGVmdFggLSAwLjUsIHRvcFkgLSAwLjUsIHNpemUsIHNpemUpO1xuXG4gICAgICAgICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja1NpemUgPSBzaXplICogcmF0aW8gLyAyO1xuICAgICAgICAgICAgICAgIHZhciBwYWRkaW5nID0gKHNpemUgLSBjaGVja1NpemUpIC8gMjtcbiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gY2hlY2tDb2xvcjtcbiAgICAgICAgICAgICAgICBmaWxsQ2lyY2xlKGN0eCwgY2VpbCgobGVmdFggLSAwLjUgKyBwYWRkaW5nKSAqIDEwMCkgLyAxMDAsIGNlaWwoKHRvcFkgLSAwLjUgKyBwYWRkaW5nKSAqIDEwMCkgLyAxMDAsIGNlaWwoY2hlY2tTaXplICogMTAwKSAvIDEwMCwgY2VpbChjaGVja1NpemUgKiAxMDApIC8gMTAwKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBleHBvcnRzLmRyYXdSYWRpb0J1dHRvbiA9IGRyYXdSYWRpb0J1dHRvbjtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBkcmF3IEJ1dHRvblxuICAgICAgICAgICAqL1xuXG4gICAgICAgICAgZnVuY3Rpb24gZHJhd0J1dHRvbihjdHgsIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiA1ICYmIGFyZ3VtZW50c1s1XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzVdIDoge307XG4gICAgICAgICAgICB2YXIgX29wdGlvbiRiYWNrZ3JvdW5kQ29sID0gb3B0aW9uLmJhY2tncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3IgPSBfb3B0aW9uJGJhY2tncm91bmRDb2wgPT09IHZvaWQgMCA/IFwiI0ZGRlwiIDogX29wdGlvbiRiYWNrZ3JvdW5kQ29sLFxuICAgICAgICAgICAgICAgIF9vcHRpb24kYmdDb2xvciA9IG9wdGlvbi5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgIGJnQ29sb3IgPSBfb3B0aW9uJGJnQ29sb3IgPT09IHZvaWQgMCA/IGJhY2tncm91bmRDb2xvciA6IF9vcHRpb24kYmdDb2xvcixcbiAgICAgICAgICAgICAgICBfb3B0aW9uJHJhZGl1cyA9IG9wdGlvbi5yYWRpdXMsXG4gICAgICAgICAgICAgICAgcmFkaXVzID0gX29wdGlvbiRyYWRpdXMgPT09IHZvaWQgMCA/IDQgOiBfb3B0aW9uJHJhZGl1cyxcbiAgICAgICAgICAgICAgICBfb3B0aW9uJHNoYWRvdyA9IG9wdGlvbi5zaGFkb3csXG4gICAgICAgICAgICAgICAgc2hhZG93ID0gX29wdGlvbiRzaGFkb3cgPT09IHZvaWQgMCA/IHt9IDogX29wdGlvbiRzaGFkb3c7XG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYmdDb2xvcjtcblxuICAgICAgICAgICAgICBpZiAoc2hhZG93KSB7XG4gICAgICAgICAgICAgICAgdmFyIF9zaGFkb3ckY29sb3IgPSBzaGFkb3cuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gX3NoYWRvdyRjb2xvciA9PT0gdm9pZCAwID8gXCJyZ2JhKDAsIDAsIDAsIDAuMjQpXCIgOiBfc2hhZG93JGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICBfc2hhZG93JGJsdXIgPSBzaGFkb3cuYmx1cixcbiAgICAgICAgICAgICAgICAgICAgYmx1ciA9IF9zaGFkb3ckYmx1ciA9PT0gdm9pZCAwID8gMSA6IF9zaGFkb3ckYmx1cixcbiAgICAgICAgICAgICAgICAgICAgX3NoYWRvdyRvZmZzZXRYID0gc2hhZG93Lm9mZnNldFgsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFggPSBfc2hhZG93JG9mZnNldFggPT09IHZvaWQgMCA/IDAgOiBfc2hhZG93JG9mZnNldFgsXG4gICAgICAgICAgICAgICAgICAgIF9zaGFkb3ckb2Zmc2V0WSA9IHNoYWRvdy5vZmZzZXRZLFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRZID0gX3NoYWRvdyRvZmZzZXRZID09PSB2b2lkIDAgPyAyIDogX3NoYWRvdyRvZmZzZXRZLFxuICAgICAgICAgICAgICAgICAgICBfc2hhZG93JG9mZnNldCA9IHNoYWRvdy5vZmZzZXQ7XG4gICAgICAgICAgICAgICAgX3NoYWRvdyRvZmZzZXQgPSBfc2hhZG93JG9mZnNldCA9PT0gdm9pZCAwID8ge30gOiBfc2hhZG93JG9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgX3NoYWRvdyRvZmZzZXQkeCA9IF9zaGFkb3ckb2Zmc2V0LngsXG4gICAgICAgICAgICAgICAgICAgIG94ID0gX3NoYWRvdyRvZmZzZXQkeCA9PT0gdm9pZCAwID8gb2Zmc2V0WCA6IF9zaGFkb3ckb2Zmc2V0JHgsXG4gICAgICAgICAgICAgICAgICAgIF9zaGFkb3ckb2Zmc2V0JHkgPSBfc2hhZG93JG9mZnNldC55LFxuICAgICAgICAgICAgICAgICAgICBveSA9IF9zaGFkb3ckb2Zmc2V0JHkgPT09IHZvaWQgMCA/IG9mZnNldFkgOiBfc2hhZG93JG9mZnNldCR5O1xuICAgICAgICAgICAgICAgIGN0eC5zaGFkb3dDb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgICAgIGN0eC5zaGFkb3dCbHVyID0gYmx1cjsgLy/jgbzjgYvjgZdcblxuICAgICAgICAgICAgICAgIGN0eC5zaGFkb3dPZmZzZXRYID0gb3g7XG4gICAgICAgICAgICAgICAgY3R4LnNoYWRvd09mZnNldFkgPSBveTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGZpbGxSb3VuZFJlY3QoY3R4LCBjZWlsKGxlZnQpLCBjZWlsKHRvcCksIGNlaWwod2lkdGgpLCBjZWlsKGhlaWdodCksIHJhZGl1cyk7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGV4cG9ydHMuZHJhd0J1dHRvbiA9IGRyYXdCdXR0b247XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vdG9vbHRpcC9CYXNlVG9vbHRpcC5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vdG9vbHRpcC9CYXNlVG9vbHRpcC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gdG9vbHRpcEJhc2VUb29sdGlwSnMobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4gICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZXhwb3J0cy5CYXNlVG9vbHRpcCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlVG9vbHRpcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBCYXNlVG9vbHRpcChncmlkKSB7XG4gICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlVG9vbHRpcCk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fZ3JpZCA9IGdyaWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhCYXNlVG9vbHRpcCwgW3tcbiAgICAgICAgICAgICAga2V5OiBcImRpc3Bvc2VcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hUb29sdGlwRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rvb2x0aXBFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLl90b29sdGlwRWxlbWVudC5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9vbHRpcEVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9nZXRUb29sdGlwRWxlbWVudFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2dldFRvb2x0aXBFbGVtZW50KCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl90b29sdGlwRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Rvb2x0aXBFbGVtZW50O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90b29sdGlwRWxlbWVudCA9IHRoaXMuY3JlYXRlVG9vbHRpcEVsZW1lbnRJbnRlcm5hbCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJhdHRhY2hUb29sdGlwRWxlbWVudFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoVG9vbHRpcEVsZW1lbnQoY29sLCByb3csIGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcEVsZW1lbnQgPSB0aGlzLl9nZXRUb29sdGlwRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgdG9vbHRpcEVsZW1lbnQuYXR0YWNoKHRoaXMuX2dyaWQsIGNvbCwgcm93LCBjb250ZW50KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwibW92ZVRvb2x0aXBFbGVtZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlVG9vbHRpcEVsZW1lbnQoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcEVsZW1lbnQgPSB0aGlzLl9nZXRUb29sdGlwRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgdG9vbHRpcEVsZW1lbnQubW92ZSh0aGlzLl9ncmlkLCBjb2wsIHJvdyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcImRldGFjaFRvb2x0aXBFbGVtZW50XCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRhY2hUb29sdGlwRWxlbWVudCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcEVsZW1lbnQgPSB0aGlzLl9nZXRUb29sdGlwRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgdG9vbHRpcEVsZW1lbnQuX2RldGFjaCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBCYXNlVG9vbHRpcDtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLkJhc2VUb29sdGlwID0gQmFzZVRvb2x0aXA7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vdG9vbHRpcC9Ub29sdGlwLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICAgICAgICAgISoqKiAuL3Rvb2x0aXAvVG9vbHRpcC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiB0b29sdGlwVG9vbHRpcEpzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGV4cG9ydHMuVG9vbHRpcCA9IHZvaWQgMDtcblxuICAgICAgICAgIHZhciBCYXNlVG9vbHRpcF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi9CYXNlVG9vbHRpcCAqL1xuICAgICAgICAgIFwiLi90b29sdGlwL0Jhc2VUb29sdGlwLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFRvb2x0aXBFbGVtZW50XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgIC8qISAuL2ludGVybmFsL1Rvb2x0aXBFbGVtZW50ICovXG4gICAgICAgICAgXCIuL3Rvb2x0aXAvaW50ZXJuYWwvVG9vbHRpcEVsZW1lbnQuanNcIik7XG5cbiAgICAgICAgICB2YXIgVG9vbHRpcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VUb29sdGlwXzEkQmFzZVRvKSB7XG4gICAgICAgICAgICBfaW5oZXJpdHMoVG9vbHRpcCwgX0Jhc2VUb29sdGlwXzEkQmFzZVRvKTtcblxuICAgICAgICAgICAgdmFyIF9zdXBlcjc1ID0gX2NyZWF0ZVN1cGVyKFRvb2x0aXApO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBUb29sdGlwKCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVG9vbHRpcCk7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlcjc1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jcmVhdGVDbGFzcyhUb29sdGlwLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiY3JlYXRlVG9vbHRpcEVsZW1lbnRJbnRlcm5hbFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlVG9vbHRpcEVsZW1lbnRJbnRlcm5hbCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRvb2x0aXBFbGVtZW50XzEuVG9vbHRpcEVsZW1lbnQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gVG9vbHRpcDtcbiAgICAgICAgICB9KEJhc2VUb29sdGlwXzEuQmFzZVRvb2x0aXApO1xuXG4gICAgICAgICAgZXhwb3J0cy5Ub29sdGlwID0gVG9vbHRpcDtcbiAgICAgICAgICAvKioqL1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiovXG4gICAgICAgIFwiLi90b29sdGlwL1Rvb2x0aXBIYW5kbGVyLmpzXCI6XG4gICAgICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAgICAgICAgICEqKiogLi90b29sdGlwL1Rvb2x0aXBIYW5kbGVyLmpzICoqKiFcbiAgICAgICAgICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qISBubyBzdGF0aWMgZXhwb3J0cyBmb3VuZCAqL1xuXG4gICAgICAgIC8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cblxuICAgICAgICAvKioqL1xuICAgICAgICBmdW5jdGlvbiB0b29sdGlwVG9vbHRpcEhhbmRsZXJKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlRvb2x0aXBIYW5kbGVyID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIExHX0VWRU5UX1RZUEVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2xpc3QtZ3JpZC9MR19FVkVOVF9UWVBFICovXG4gICAgICAgICAgXCIuL2xpc3QtZ3JpZC9MR19FVkVOVF9UWVBFLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFRvb2x0aXBfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4vVG9vbHRpcCAqL1xuICAgICAgICAgIFwiLi90b29sdGlwL1Rvb2x0aXAuanNcIik7XG5cbiAgICAgICAgICB2YXIgdXRpbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uL2ludGVybmFsL3V0aWxzICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL3V0aWxzLmpzXCIpO1xuXG4gICAgICAgICAgdmFyIFRPT0xUSVBfSU5TVEFOQ0VfRkFDVE9SWSA9IHtcbiAgICAgICAgICAgIFwib3ZlcmZsb3ctdGV4dFwiOiBmdW5jdGlvbiBvdmVyZmxvd1RleHQoZ3JpZCkge1xuICAgICAgICAgICAgICByZXR1cm4gbmV3IFRvb2x0aXBfMS5Ub29sdGlwKGdyaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRUb29sdGlwSW5zdGFuY2VJbmZvKCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgIGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gb3ZlcmZsb3cgdGV4dCB0b29sdGlwXG4gICAgICAgICAgICB2YXIgb3ZlcmZsb3dUZXh0ID0gZ3JpZC5nZXRDZWxsT3ZlcmZsb3dUZXh0KGNvbCwgcm93KTtcblxuICAgICAgICAgICAgaWYgKG92ZXJmbG93VGV4dCkge1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib3ZlcmZsb3ctdGV4dFwiLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IG92ZXJmbG93VGV4dFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgVG9vbHRpcEhhbmRsZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gVG9vbHRpcEhhbmRsZXIoZ3JpZCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVG9vbHRpcEhhbmRsZXIpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX2dyaWQgPSBncmlkO1xuICAgICAgICAgICAgICB0aGlzLl90b29sdGlwSW5zdGFuY2VzID0ge307XG5cbiAgICAgICAgICAgICAgdGhpcy5fYmluZEdyaWRFdmVudChncmlkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NyZWF0ZUNsYXNzKFRvb2x0aXBIYW5kbGVyLCBbe1xuICAgICAgICAgICAgICBrZXk6IFwiZGlzcG9zZVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcEluc3RhbmNlcyA9IHRoaXMuX3Rvb2x0aXBJbnN0YW5jZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIHRvb2x0aXBJbnN0YW5jZXMpIHtcbiAgICAgICAgICAgICAgICAgIHRvb2x0aXBJbnN0YW5jZXNba10uZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIH0gLy8gQHRzLWV4cGVjdC1lcnJvciAtLSBpZ25vcmVcblxuXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3Rvb2x0aXBJbnN0YW5jZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoSW5mbyA9IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9hdHRhY2hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hdHRhY2goY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHRoaXMuX2F0dGFjaEluZm87XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2VJbmZvID0gdGhpcy5fZ2V0VG9vbHRpcEluc3RhbmNlSW5mbyhjb2wsIHJvdyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5mbyAmJiAoIWluc3RhbmNlSW5mbyB8fCBpbmZvLmluc3RhbmNlICE9PSBpbnN0YW5jZUluZm8uaW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICBpbmZvLmluc3RhbmNlLmRldGFjaFRvb2x0aXBFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgICB0aGlzLl9hdHRhY2hJbmZvID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWluc3RhbmNlSW5mbykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGluc3RhbmNlSW5mby5pbnN0YW5jZTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5hdHRhY2hUb29sdGlwRWxlbWVudChjb2wsIHJvdywgaW5zdGFuY2VJbmZvLmNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5fZ3JpZC5nZXRDZWxsUmFuZ2UoY29sLCByb3cpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoSW5mbyA9IHtcbiAgICAgICAgICAgICAgICAgIHJhbmdlOiByYW5nZSxcbiAgICAgICAgICAgICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9tb3ZlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbW92ZShjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBpbmZvID0gdGhpcy5fYXR0YWNoSW5mbztcblxuICAgICAgICAgICAgICAgIGlmICghaW5mbyB8fCAhKDAsIHV0aWxzXzEuY2VsbEluUmFuZ2UpKGluZm8ucmFuZ2UsIGNvbCwgcm93KSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGluZm8uaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UubW92ZVRvb2x0aXBFbGVtZW50KGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2RldGFjaFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2RldGFjaCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHRoaXMuX2F0dGFjaEluZm87XG5cbiAgICAgICAgICAgICAgICBpZiAoIWluZm8pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBpbmZvLmluc3RhbmNlO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlLmRldGFjaFRvb2x0aXBFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoSW5mbyA9IG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9pc0F0dGFjaENlbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pc0F0dGFjaENlbGwoY29sLCByb3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHRoaXMuX2F0dGFjaEluZm87XG5cbiAgICAgICAgICAgICAgICBpZiAoIWluZm8pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIHV0aWxzXzEuY2VsbEluUmFuZ2UpKGluZm8ucmFuZ2UsIGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2JpbmRHcmlkRXZlbnRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9iaW5kR3JpZEV2ZW50KGdyaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxMTEgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuTU9VU0VPVkVSX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZS5yZWxhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczExMS5faXNBdHRhY2hDZWxsKGUuY29sLCBlLnJvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX3RoaXMxMTEuX2F0dGFjaChlLmNvbCwgZS5yb3cpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdyaWQubGlzdGVuKExHX0VWRU5UX1RZUEVfMS5MR19FVkVOVF9UWVBFLk1PVVNFT1VUX0NFTEwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZS5yZWxhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczExMS5faXNBdHRhY2hDZWxsKGUucmVsYXRlZC5jb2wsIGUucmVsYXRlZC5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzMTExLl9kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBncmlkLmxpc3RlbihMR19FVkVOVF9UWVBFXzEuTEdfRVZFTlRfVFlQRS5TRUxFQ1RFRF9DRUxMLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMTExLl9pc0F0dGFjaENlbGwoZS5jb2wsIGUucm93KSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczExMS5fZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ3JpZC5saXN0ZW4oTEdfRVZFTlRfVFlQRV8xLkxHX0VWRU5UX1RZUEUuU0NST0xMLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IF90aGlzMTExLl9hdHRhY2hJbmZvO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIWluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBfdGhpczExMS5fbW92ZShpbmZvLnJhbmdlLnN0YXJ0LmNvbCwgaW5mby5yYW5nZS5zdGFydC5yb3cpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdyaWQubGlzdGVuKExHX0VWRU5UX1RZUEVfMS5MR19FVkVOVF9UWVBFLkNIQU5HRURfVkFMVUUsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMTEuX2lzQXR0YWNoQ2VsbChlLmNvbCwgZS5yb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMTExLl9kZXRhY2goKTtcblxuICAgICAgICAgICAgICAgICAgICBfdGhpczExMS5fYXR0YWNoKGUuY29sLCBlLnJvdyk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9nZXRUb29sdGlwSW5zdGFuY2VJbmZvXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0VG9vbHRpcEluc3RhbmNlSW5mbyhjb2wsIHJvdykge1xuICAgICAgICAgICAgICAgIHZhciBncmlkID0gdGhpcy5fZ3JpZDtcbiAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcEluc3RhbmNlcyA9IHRoaXMuX3Rvb2x0aXBJbnN0YW5jZXM7XG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSBnZXRUb29sdGlwSW5zdGFuY2VJbmZvKGdyaWQsIGNvbCwgcm93KTtcblxuICAgICAgICAgICAgICAgIGlmICghaW5mbykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBpbmZvLnR5cGU7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gdG9vbHRpcEluc3RhbmNlc1t0eXBlXSB8fCAodG9vbHRpcEluc3RhbmNlc1t0eXBlXSA9IFRPT0xUSVBfSU5TVEFOQ0VfRkFDVE9SWVt0eXBlXShncmlkKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZSxcbiAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiBpbmZvLmNvbnRlbnRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBUb29sdGlwSGFuZGxlcjtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLlRvb2x0aXBIYW5kbGVyID0gVG9vbHRpcEhhbmRsZXI7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfSxcblxuICAgICAgICAvKioqL1xuICAgICAgICBcIi4vdG9vbHRpcC9pbnRlcm5hbC9Ub29sdGlwRWxlbWVudC5qc1wiOlxuICAgICAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgICAgICAgICAhKioqIC4vdG9vbHRpcC9pbnRlcm5hbC9Ub29sdGlwRWxlbWVudC5qcyAqKiohXG4gICAgICAgICAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cblxuICAgICAgICAvKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlICovXG5cbiAgICAgICAgLyoqKi9cbiAgICAgICAgZnVuY3Rpb24gdG9vbHRpcEludGVybmFsVG9vbHRpcEVsZW1lbnRKcyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbiAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBleHBvcnRzLlRvb2x0aXBFbGVtZW50ID0gdm9pZCAwO1xuXG4gICAgICAgICAgdmFyIEV2ZW50SGFuZGxlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcbiAgICAgICAgICAvKiEgLi4vLi4vaW50ZXJuYWwvRXZlbnRIYW5kbGVyICovXG4gICAgICAgICAgXCIuL2ludGVybmFsL0V2ZW50SGFuZGxlci5qc1wiKTtcblxuICAgICAgICAgIHZhciBkb21fMSA9IF9fd2VicGFja19yZXF1aXJlX18oXG4gICAgICAgICAgLyohIC4uLy4uL2ludGVybmFsL2RvbSAqL1xuICAgICAgICAgIFwiLi9pbnRlcm5hbC9kb20uanNcIik7XG5cbiAgICAgICAgICB2YXIgQ0xBU1NOQU1FID0gXCJjaGVldGFoLWdyaWRfX3Rvb2x0aXAtZWxlbWVudFwiO1xuICAgICAgICAgIHZhciBDT05URU5UX0NMQVNTTkFNRSA9IFwiXCIuY29uY2F0KENMQVNTTkFNRSwgXCJfX2NvbnRlbnRcIik7XG4gICAgICAgICAgdmFyIEhJRERFTl9DTEFTU05BTUUgPSBcIlwiLmNvbmNhdChDTEFTU05BTUUsIFwiLS1oaWRkZW5cIik7XG4gICAgICAgICAgdmFyIFNIT1dOX0NMQVNTTkFNRSA9IFwiXCIuY29uY2F0KENMQVNTTkFNRSwgXCItLXNob3duXCIpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gY3JlYXRlVG9vbHRpcERvbUVsZW1lbnQoKSB7XG4gICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgICAgLyohIEAvdG9vbHRpcC9pbnRlcm5hbC9Ub29sdGlwRWxlbWVudC5jc3MgKi9cbiAgICAgICAgICAgIFwiLi4vc3JjL2pzL3Rvb2x0aXAvaW50ZXJuYWwvVG9vbHRpcEVsZW1lbnQuY3NzXCIpO1xuXG4gICAgICAgICAgICB2YXIgcm9vdEVsZW1lbnQgPSAoMCwgZG9tXzEuY3JlYXRlRWxlbWVudCkoXCJkaXZcIiwge1xuICAgICAgICAgICAgICBjbGFzc0xpc3Q6IFtDTEFTU05BTUUsIEhJRERFTl9DTEFTU05BTUVdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlRWxlbWVudCA9ICgwLCBkb21fMS5jcmVhdGVFbGVtZW50KShcInByZVwiLCB7XG4gICAgICAgICAgICAgIGNsYXNzTGlzdDogW0NPTlRFTlRfQ0xBU1NOQU1FXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByb290RWxlbWVudC5hcHBlbmRDaGlsZChtZXNzYWdlRWxlbWVudCk7XG4gICAgICAgICAgICByZXR1cm4gcm9vdEVsZW1lbnQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIFRvb2x0aXBFbGVtZW50ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFRvb2x0aXBFbGVtZW50KCkge1xuICAgICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVG9vbHRpcEVsZW1lbnQpO1xuXG4gICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIgPSBuZXcgRXZlbnRIYW5kbGVyXzEuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgICAgICAgIHZhciByb290RWxlbWVudCA9IHRoaXMuX3Jvb3RFbGVtZW50ID0gY3JlYXRlVG9vbHRpcERvbUVsZW1lbnQoKTtcbiAgICAgICAgICAgICAgdGhpcy5fbWVzc2FnZUVsZW1lbnQgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLlwiLmNvbmNhdChDT05URU5UX0NMQVNTTkFNRSkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3JlYXRlQ2xhc3MoVG9vbHRpcEVsZW1lbnQsIFt7XG4gICAgICAgICAgICAgIGtleTogXCJkaXNwb3NlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHJvb3RFbGVtZW50ID0gdGhpcy5fcm9vdEVsZW1lbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAocm9vdEVsZW1lbnQucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb290RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlci5kaXNwb3NlKCk7IC8vIEB0cy1leHBlY3QtZXJyb3IgLS0gaWdub3JlXG5cblxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9yb290RWxlbWVudDsgLy8gQHRzLWV4cGVjdC1lcnJvciAtLSBpZ25vcmVcblxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9tZXNzYWdlRWxlbWVudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiYXR0YWNoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdHRhY2goZ3JpZCwgY29sLCByb3csIGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm9vdEVsZW1lbnQgPSB0aGlzLl9yb290RWxlbWVudDtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9tZXNzYWdlRWxlbWVudDtcbiAgICAgICAgICAgICAgICByb290RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFNIT1dOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQuY2xhc3NMaXN0LmFkZChISURERU5fQ0xBU1NOQU1FKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdHRhY2hDZWxsKGdyaWQsIGNvbCwgcm93KSkge1xuICAgICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQuY2xhc3NMaXN0LmFkZChTSE9XTl9DTEFTU05BTUUpO1xuICAgICAgICAgICAgICAgICAgcm9vdEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShISURERU5fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gY29udGVudDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGtleTogXCJtb3ZlXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlKGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvb3RFbGVtZW50ID0gdGhpcy5fcm9vdEVsZW1lbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYXR0YWNoQ2VsbChncmlkLCBjb2wsIHJvdykpIHtcbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoU0hPV05fQ0xBU1NOQU1FKTtcbiAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoSElEREVOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX2RldGFjaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiZGV0YWNoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRhY2goKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAga2V5OiBcIl9kZXRhY2hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZXRhY2goKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvb3RFbGVtZW50ID0gdGhpcy5fcm9vdEVsZW1lbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAocm9vdEVsZW1lbnQucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgLy8gcm9vdEVsZW1lbnQucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb290RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICByb290RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFNIT1dOX0NMQVNTTkFNRSk7XG4gICAgICAgICAgICAgICAgICByb290RWxlbWVudC5jbGFzc0xpc3QuYWRkKEhJRERFTl9DTEFTU05BTUUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBrZXk6IFwiX2F0dGFjaENlbGxcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hdHRhY2hDZWxsKGdyaWQsIGNvbCwgcm93KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvb3RFbGVtZW50ID0gdGhpcy5fcm9vdEVsZW1lbnQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2dyaWQkZ2V0QXR0YWNoQ2VsbHNBOCA9IGdyaWQuZ2V0QXR0YWNoQ2VsbHNBcmVhKGdyaWQuZ2V0Q2VsbFJhbmdlKGNvbCwgcm93KSksXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBfZ3JpZCRnZXRBdHRhY2hDZWxsc0E4LmVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIHJlY3QgPSBfZ3JpZCRnZXRBdHRhY2hDZWxsc0E4LnJlY3Q7XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9wID0gcmVjdC5ib3R0b20sXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgPSByZWN0LmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gcmVjdC53aWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgZnJvemVuUm93Q291bnQgPSBncmlkLmZyb3plblJvd0NvdW50LFxuICAgICAgICAgICAgICAgICAgICBmcm96ZW5Db2xDb3VudCA9IGdyaWQuZnJvemVuQ29sQ291bnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAocm93ID49IGZyb3plblJvd0NvdW50ICYmIGZyb3plblJvd0NvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgdmFyIF9ncmlkJGdldEF0dGFjaENlbGxzQTkgPSBncmlkLmdldEF0dGFjaENlbGxzQXJlYShncmlkLmdldENlbGxSYW5nZShjb2wsIGZyb3plblJvd0NvdW50IC0gMSkpLFxuICAgICAgICAgICAgICAgICAgICAgIGZyb3plblJlY3QgPSBfZ3JpZCRnZXRBdHRhY2hDZWxsc0E5LnJlY3Q7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh0b3AgPCBmcm96ZW5SZWN0LmJvdHRvbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8v56+E5Zuy5aSWXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmICh0b3AgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy/nr4Tlm7LlpJZcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoY29sID49IGZyb3plbkNvbENvdW50ICYmIGZyb3plbkNvbENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgdmFyIF9ncmlkJGdldEF0dGFjaENlbGxzQTEwID0gZ3JpZC5nZXRBdHRhY2hDZWxsc0FyZWEoZ3JpZC5nZXRDZWxsUmFuZ2UoZnJvemVuQ29sQ291bnQgLSAxLCByb3cpKSxcbiAgICAgICAgICAgICAgICAgICAgICBfZnJvemVuUmVjdDUgPSBfZ3JpZCRnZXRBdHRhY2hDZWxsc0ExMC5yZWN0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAobGVmdCA8IF9mcm96ZW5SZWN0NS5yaWdodCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8v56+E5Zuy5aSWXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmIChsZWZ0IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8v56+E5Zuy5aSWXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIF9lbGVtZW50JGdldEJvdW5kaW5nQyA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldEhlaWdodCA9IF9lbGVtZW50JGdldEJvdW5kaW5nQy5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFdpZHRoID0gX2VsZW1lbnQkZ2V0Qm91bmRpbmdDLndpZHRoLFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50TGVmdCA9IF9lbGVtZW50JGdldEJvdW5kaW5nQy5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50UmlnaHQgPSBfZWxlbWVudCRnZXRCb3VuZGluZ0MucmlnaHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0SGVpZ2h0IDwgdG9wKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8v56+E5Zuy5aSWXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG9mZnNldFdpZHRoIDwgbGVmdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvL+evhOWbsuWkllxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjZWxsQ2VudGVyID0gbGVmdCArIHdpZHRoIC8gMjtcbiAgICAgICAgICAgICAgICByb290RWxlbWVudC5zdHlsZS50b3AgPSBcIlwiLmNvbmNhdCh0b3AudG9GaXhlZCgpLCBcInB4XCIpO1xuICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LnN0eWxlLmxlZnQgPSBcIlwiLmNvbmNhdChjZWxsQ2VudGVyLnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICByb290RWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IFwiXCIuY29uY2F0KHdpZHRoLnRvRml4ZWQoKSwgXCJweFwiKTtcbiAgICAgICAgICAgICAgICB2YXIgbWF4V2lkdGhGb3JMZWZ0ID0gKGVsZW1lbnRMZWZ0ICsgY2VsbENlbnRlcikgKiAyO1xuICAgICAgICAgICAgICAgIHZhciB3aW5XaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBtYXhXaWR0aEZvclJpZ2h0ID0gKG9mZnNldFdpZHRoIC0gY2VsbENlbnRlciArICh3aW5XaWR0aCAtIGVsZW1lbnRSaWdodCkpICogMjtcbiAgICAgICAgICAgICAgICB2YXIgbWF4V2lkdGggPSBNYXRoLm1pbihtYXhXaWR0aEZvckxlZnQsIG1heFdpZHRoRm9yUmlnaHQpO1xuICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LnN0eWxlLm1heFdpZHRoID0gXCJcIi5jb25jYXQobWF4V2lkdGgudG9GaXhlZCgpLCBcInB4XCIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJvb3RFbGVtZW50LnBhcmVudEVsZW1lbnQgIT09IGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQocm9vdEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHJldHVybiBUb29sdGlwRWxlbWVudDtcbiAgICAgICAgICB9KCk7XG5cbiAgICAgICAgICBleHBvcnRzLlRvb2x0aXBFbGVtZW50ID0gVG9vbHRpcEVsZW1lbnQ7XG4gICAgICAgICAgLyoqKi9cbiAgICAgICAgfVxuICAgICAgICAvKioqKioqL1xuXG4gICAgICB9KVxuICAgICk7XG4gIH0pO1xufSkuY2FsbCh0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogd2luZG93LCB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogd2luZG93KTtcbn0pKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jaGVldGFoR3JpZC5lczUuanMubWFwIiwiY29uc3QgYXNIZWFkZXIgPSAoeCkgPT4ge1xuICByZXR1cm4gJzxoMT4nICsgeC5tZXNzYWdlICsgJzwvaDE+Jztcbn1cblxuZXhwb3J0IHsgYXNIZWFkZXIgfTtcbiIsIm1vZHVsZS5leHBvcnRzID0gSFRNTFdpZGdldHM7IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHRpZDogbW9kdWxlSWQsXG5cdFx0bG9hZGVkOiBmYWxzZSxcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG5cdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm5tZCA9IChtb2R1bGUpID0+IHtcblx0bW9kdWxlLnBhdGhzID0gW107XG5cdGlmICghbW9kdWxlLmNoaWxkcmVuKSBtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0cmV0dXJuIG1vZHVsZTtcbn07IiwiaW1wb3J0ICd3aWRnZXRzJztcbmltcG9ydCB7IGFzSGVhZGVyIH0gZnJvbSAnLi4vbW9kdWxlcy9oZWFkZXIuanMnO1xuaW1wb3J0ICogYXMgY2hlZXRhaEdyaWQgZnJvbSBcImNoZWV0YWgtZ3JpZFwiO1xuXG5IVE1MV2lkZ2V0cy53aWRnZXQoe1xuXG4gIG5hbWU6ICdjaGVldGFoJyxcblxuICB0eXBlOiAnb3V0cHV0JyxcblxuICBmYWN0b3J5OiBmdW5jdGlvbiAoZWwsIHdpZHRoLCBoZWlnaHQpIHtcblxuICAgIGxldCBpZCA9IGVsLmlkO1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgcmVuZGVyVmFsdWU6IGZ1bmN0aW9uICh4LCBpZCA9IGVsLmlkKSB7XG4gICAgICAgIGxldCBjb2x1bW5zO1xuICAgICAgICBjb25zdCBoZWFkZXIgPSBPYmplY3Qua2V5cyh4LmRhdGFbMF0pXG4gICAgICAgIGNvbnN0IGRlZmF1bHRDb2wgPSBoZWFkZXIubWFwKChrZXkpID0+IHtcbiAgICAgICAgICByZXR1cm4gKHsgZmllbGQ6IGtleSwgY2FwdGlvbjoga2V5LCB3aWR0aDogJ2F1dG8nIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoeC5jb2x1bW5zICE9PSBudWxsKSB7XG4gICAgICAgICAgLy8gQ3JlYXRlIGEgbG9va3VwIG1hcCBmcm9tIHVzZXIgaW5wdXRcbiAgICAgICAgICBjb25zdCB1c2VyTWFwID0gT2JqZWN0LmZyb21FbnRyaWVzKHguY29sdW1ucy5tYXAoaXRlbSA9PiBbaXRlbS5maWVsZCwgaXRlbV0pKTtcblxuICAgICAgICAgIC8vIE1lcmdlIHVzZXIgaW5wdXQgdmFsdWVzIGludG8gZGVmYXVsdENvbFxuICAgICAgICAgIGNvbHVtbnMgPSBkZWZhdWx0Q29sLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgICAgLi4uKHVzZXJNYXBbaXRlbS5maWVsZF0gfHwge30pXG4gICAgICAgICAgfSkpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29sdW1ucyA9IGRlZmF1bHRDb2xcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGdyaWQgPSBuZXcgY2hlZXRhaEdyaWQuTGlzdEdyaWQoe1xuICAgICAgICAgIHBhcmVudEVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSxcbiAgICAgICAgICBoZWFkZXI6IGNvbHVtbnMsXG4gICAgICAgICAgLy8gQXJyYXkgZGF0YSB0byBiZSBkaXNwbGF5ZWQgb24gdGhlIGdyaWRcbiAgICAgICAgICByZWNvcmRzOiB4LmRhdGEsXG4gICAgICAgICAgLy8gQ29sdW1uIGZpeGVkIHBvc2l0aW9uXG4gICAgICAgICAgLy8gZnJvemVuQ29sQ291bnQ6IDEsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBDTElDS19DRUxMLFxuICAgICAgICAgIENIQU5HRURfVkFMVUUsXG4gICAgICAgIH0gPSBjaGVldGFoR3JpZC5MaXN0R3JpZC5FVkVOVF9UWVBFO1xuXG4gICAgICAgIGdyaWQubGlzdGVuKFxuICAgICAgICAgIENMSUNLX0NFTEwsICguLi5hcmdzKSA9PiB7XG4gICAgICAgICAgICBTaGlueS5zZXRJbnB1dFZhbHVlKGAke2lkfV9jbGlja19jZWxsYCwgYXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIGdyaWQubGlzdGVuKFxuICAgICAgICAgIENIQU5HRURfVkFMVUUsICguLi5hcmdzKSA9PiB7XG4gICAgICAgICAgICBTaGlueS5zZXRJbnB1dFZhbHVlKGAke2lkfV9jaGFuZ2VkX3ZhbHVlYCwgYXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgfSxcblxuICAgICAgcmVzaXplOiBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCkge1xuXG4gICAgICAgIC8vIFRPRE86IGNvZGUgdG8gcmUtcmVuZGVyIHRoZSB3aWRnZXQgd2l0aCBhIG5ldyBzaXplXG5cbiAgICAgIH1cblxuICAgIH07XG4gIH1cbn0pO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9